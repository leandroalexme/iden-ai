import {
    a as F1,
    b as D1,
    c as qH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-44YWYOGZ.js";
import {
    a as c1,
    b as zH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-I6IYVTVO.js";
import {
    a as P1,
    b as YH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-X6TMIQVQ.js";
import {
    a as S1,
    b as UH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-AEBJSX3E.js";
import {
    a as C1,
    b as VH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-J2GD7AJO.js";
import {
    a as A1,
    b as QH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-NWRXLRXO.js";
import {
    a as k1,
    b as GH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-IHO7BQ4B.js";
import {
    a as E1,
    b as KH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-VPVP3KVS.js";
import {
    a as qv,
    b as B1,
    c as ZH,
    d as M1,
    e as Rp,
    f as Gr,
    g as Ep,
    h as R1,
    i as XH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-4S74OOYW.js";
import {
    a as eg,
    b as I1
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-BGFFIEWK.js";
import {
    a as og,
    b as JH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-RQLD3MG7.js";
import {
    a as w1,
    b as HH,
    c as _1,
    d as NH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ZHSJP3FZ.js";
import {
    a as tg,
    b as T1
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-TNPKOGW7.js";
import {
    a as Jo,
    c as Xs,
    d as vi,
    e as id,
    h as Gf,
    i as WI,
    k as OI,
    l as s1,
    m as AH,
    n as a1,
    o as LH,
    p as z1,
    q as tN
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-RQQWYHRA.js";
import {
    a as L1,
    b as eN
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-Y7G475Z7.js";
import {
    a as jI,
    b as HI,
    c as NI,
    d as UI,
    f as VI,
    h as GI,
    i as YI,
    j as ZI,
    k as Pp,
    l as Zf,
    m as ad
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-OXCFVNGZ.js";
import {
    a as DH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-XAQYPO3V.js";
import {
    A as MI,
    B as fe,
    C as zt,
    D as Sa,
    E as RI,
    F as Sh,
    H as Mp,
    I as f1,
    J as g1,
    n as so,
    o as Nr,
    p as h0,
    q as Rj,
    s as Ti,
    t as Qi,
    u as Ps,
    x as Gv,
    y as BH,
    z as Of
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-PSAHE2JB.js";
import {
    a as u0,
    c as Tj,
    d as f0,
    e as Ej
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-JGOWKC3G.js";
import {
    a as _o,
    b as Bs
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-M2KJKF46.js";
import {
    a as oi,
    b as kh
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-F6QRHN3G.js";
import {
    a as Qn,
    b as Oc
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-IPP7RN7C.js";
import {
    H as a0,
    I as xf,
    K as Ev,
    N as $l,
    O as cp,
    P as Wl,
    U as st,
    X as mn,
    Y as Fv,
    Z as pi,
    a as Oo,
    b as fi,
    c as pj,
    e as jr
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-Q55XPCPQ.js";
import {
    a as GC,
    b as cj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-UE75HU6Z.js";
import {
    a as Ai,
    b as Dv,
    c as p0,
    d as Pj,
    e as BI,
    f as TH,
    h as $1
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-Q5KVLU6N.js";
import {
    d as ft,
    e as wa
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-PJEQGESF.js";
import {
    a as NC,
    b as G,
    e as yr
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-6XMPDTIY.js";
import {
    a as Ln,
    b as bh
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-VBQ72NC4.js";
import {
    a as Ae,
    b as no
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-RDXN3NMA.js";
import {
    a as Aj,
    c as Lj,
    d as _0,
    e as xo,
    f as or,
    g as kr,
    h as FI
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-GRN2NMC3.js";
import {
    E as Dj,
    F as MH,
    G as Zv,
    H as RH,
    I as $I,
    K as Uf,
    L as Vf,
    O as Gl,
    P as sd,
    Q as Yf,
    R as Jv,
    S as Bp,
    T as ew,
    U as qf,
    V as m1,
    W as $H,
    y as b0,
    z as y0
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-XWERTDGT.js";
import {
    p as y1,
    q as OH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-53SUDWFZ.js";
import {
    a as b1,
    b as WH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LSRG6T4H.js";
import {
    a as l1,
    b as v1,
    c as jH
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-5R7RBNIB.js";
import {
    g as Qf,
    h as x1
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-KYTWZIYP.js";
import {
    a as tw
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-CKEDNR4Z.js";
import {
    a as Yl,
    c as Jf
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-O6KGWW5U.js";
import {
    b as Tp,
    d as JI,
    e as qI,
    f as QI,
    i as e1,
    j as t1,
    k as o1,
    l as i1,
    m as n1,
    o as Kf,
    p as r1,
    r as Ih
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-XXM23K5I.js";
import {
    a as xh,
    b as x0
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-5RBXWDXS.js";
import {
    a as Av,
    d as Bj,
    g as wh,
    i as Mj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-2ELE44LB.js";
import {
    f as up,
    g as Xc,
    h as hp,
    i as mp
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-K7XG3VRN.js";
import {
    b as $f,
    c as PI,
    e as xp,
    f as _p,
    g as et,
    h as ir
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-6RC47BAR.js";
import {
    a as Wf,
    b as TI
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-PSONLBXL.js";
import {
    a as kp,
    b as Kv
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-WRMAYY7H.js";
import {
    w as Sf
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-C5J7M4I6.js";
import {
    a as nr,
    b as od
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-UWOMRJ34.js";
import {
    e as d1,
    f as p1,
    g as u1,
    h as h1
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-4J24HRYA.js";
import {
    a as _f,
    b as dp,
    c as d0,
    e as vo,
    f as Ya,
    h as g0,
    i as Fj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-2LHX2XWY.js";
import {
    a as rr,
    b as Qv
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LVYVYHLB.js";
import {
    d as KI
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-PTAQN7XC.js";
import {
    a as ii,
    b as Ip
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ULPVFJY2.js";
import {
    a as vh,
    b as c0
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-UT22G6CJ.js";
import {
    a as Xf,
    b as XI
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-3UDZKVR2.js";
import {
    a as Ka,
    b as _a,
    c as Yv,
    d as nd,
    e as Ul,
    f as DI,
    g as rd,
    h as Vl,
    i as AI,
    j as Hf,
    k as EH,
    o as LI,
    p as FH,
    q as Nf,
    u as zI
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LOCADTYW.js";
import {
    a as zn,
    b as Ol
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-CNQMWROU.js";
import {
    a as Cp,
    b as EI,
    c as Xv,
    d as jf
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LNRZGIXR.js";
import {
    a as s0,
    k as kj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-GFHV2AWM.js";
import {
    j as lp,
    p as Ij
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-BH74MBTK.js";
import {
    a as qk,
    b as Mv,
    d as ap,
    e as Rv,
    f as Qk,
    g as e0,
    h as wf,
    i as t0,
    j as o0,
    k as i0,
    l as n0,
    m as zl,
    n as r0,
    o as Zc
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-KSXA7H77.js";
import {
    $a as wr,
    $b as gh,
    Aa as Is,
    Ab as Hk,
    B as sk,
    Ba as Cv,
    C as ak,
    Ca as kv,
    D as lk,
    Da as Iv,
    Db as ip,
    E as ck,
    Eb as tr,
    F as gj,
    Fa as vr,
    G as Ii,
    Ha as af,
    Hb as np,
    I as xv,
    Ia as Bk,
    J as Kd,
    Ja as lf,
    Jb as bi,
    Ka as Mk,
    Kb as yi,
    L as gk,
    La as Rk,
    Lb as ff,
    M as El,
    Ma as Ek,
    Na as Fk,
    Nb as Pi,
    O as bk,
    Oa as cf,
    Ob as Nk,
    P as yk,
    Q as vk,
    Qa as Pv,
    Qb as Uk,
    R as qi,
    Ra as _j,
    Rb as Vk,
    Sa as Dk,
    T as wk,
    Ta as Sj,
    Tb as Gk,
    Ua as Tv,
    Ub as Yk,
    Va as Cj,
    Vb as Zk,
    W as ks,
    Wa as At,
    Wb as Al,
    X as _v,
    Xa as pf,
    Ya as tp,
    Za as uf,
    _a as Gc,
    ac as gf,
    ba as xk,
    bb as hf,
    ca as Fl,
    d as uj,
    da as Jd,
    db as mh,
    dc as Xk,
    e as hj,
    ea as ah,
    eb as fh,
    f as yv,
    fc as Zs,
    g as Vc,
    ga as of ,
    gc as Ll,
    ha as Ga,
    hb as op,
    hc as Kk,
    i as ih,
    ia as qd,
    ic as bf,
    j as St,
    ja as lh,
    jb as Yc,
    jc as rp,
    kb as Lk,
    kc as Bv,
    la as ch,
    lc as yf,
    m as _s,
    ma as dh,
    mc as xr,
    nc as vf,
    oa as nf,
    oc as sp,
    pa as Qd,
    pc as Ko,
    q as tk,
    qa as Dl,
    qc as Jk,
    ra as uh,
    s as ok,
    sa as hh,
    sb as zk,
    sc as Yt,
    t as vv,
    tb as $k,
    u as ik,
    ua as rf,
    v as wv,
    va as _k,
    w as nk,
    wa as Sk,
    wb as Wk,
    x as Ss,
    xb as mf,
    y as rk,
    ya as yj,
    yb as Ok,
    z as fj,
    za as Xo,
    zb as jk
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-VFUQL75R.js";
import {
    a as fk,
    c as bj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-N2N7GOUG.js";
import {
    h as ph,
    i as Dn,
    j as df,
    u as Ak
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-7TFJVZMD.js";
import {
    a as qm,
    b as mj,
    d as XC,
    g as nh,
    h as Qm,
    i as ro,
    j as KC,
    k as JC,
    l as Yo,
    m as yt,
    n as qC,
    p as ct,
    q as QC,
    r as Zo,
    w as ek,
    x as ko
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-2M3GYHUW.js";
import {
    a as er,
    b as Nc
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ZJMKULCD.js";
import {
    a as ef,
    b as dk
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-3HBNHCFR.js";
import {
    a as ge,
    d as va,
    e as An,
    f as xj,
    g as Le
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-HQUF2BFY.js";
import {
    a as Rt,
    b as Yd
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-MWTOBXCT.js";
import {
    a as bv,
    b as lj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-K4MSOFN3.js";
import {
    d as CI,
    g as xa,
    h as kI,
    i as II,
    j as wp
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LDOT7PRX.js";
import {
    a as Vr,
    b as Ch
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-HM4MRZSY.js";
import {
    $ as O0,
    $b as _H,
    A as T0,
    Aa as Z0,
    Ab as lI,
    B as Uj,
    Ba as nH,
    Bb as Ff,
    C as B0,
    Ca as X0,
    Cb as cI,
    D as Vj,
    Da as rH,
    E as M0,
    F as Gj,
    Fb as dI,
    G as If,
    Ga as K0,
    Gb as bH,
    H as R0,
    Ha as sH,
    Hb as pI,
    I as E0,
    Ia as J0,
    Ib as yH,
    J as F0,
    Ja as aH,
    K as Yj,
    Ka as q0,
    L as D0,
    La as lH,
    Lb as Df,
    M as Zj,
    Ma as Sr,
    Mb as Af,
    N as A0,
    Na as Qc,
    Nb as uI,
    O as Xj,
    Ob as hI,
    Pb as vH,
    Q as yp,
    Qb as mI,
    R as L0,
    Rb as wH,
    S as vp,
    Sa as Q0,
    Sb as fI,
    T as z0,
    Ta as cH,
    Tb as xH,
    U as $0,
    Ua as eI,
    Ub as Lt,
    V as Kj,
    Va as dH,
    Vb as en,
    W as W0,
    Wa as tI,
    Wb as Xa,
    X as Jj,
    Xa as pH,
    Xb as Lf,
    Y as Nt,
    Ya as Bi,
    Z as Ts,
    Za as Nl,
    _ as Pf,
    _b as gI,
    a as w0,
    aa as j0,
    ab as oI,
    ac as _h,
    b as $j,
    ba as qj,
    bb as iI,
    bc as bI,
    c as S0,
    ca as H0,
    cb as uH,
    cc as zf,
    d as Oj,
    da as Qj,
    dc as yI,
    e as Cf,
    ea as Tf,
    ec as vI,
    f as C0,
    fa as N0,
    fb as Qt,
    fc as SH,
    g as zv,
    ga as Nv,
    gb as Cr,
    gc as wI,
    h as jj,
    ha as eH,
    hc as CH,
    i as $v,
    j as Hj,
    k as Kc,
    ka as Hl,
    l as k0,
    la as Bf,
    lb as ed,
    m as fp,
    mb as Uv,
    n as Wv,
    nb as nI,
    o as gp,
    ob as hH,
    p as Ov,
    q as Jc,
    qa as U0,
    qc as xI,
    r as jv,
    ra as tH,
    rb as rI,
    rc as kH,
    s as bp,
    sa as V0,
    sb as mH,
    sc as _I,
    t as Hv,
    ta as oH,
    tb as sI,
    tc as IH,
    u as I0,
    ub as fH,
    uc as SI,
    v as Nj,
    vb as aI,
    vc as PH,
    w as _r,
    wa as G0,
    wb as gH,
    wc as td,
    x as qc,
    xa as iH,
    xb as Za,
    y as kf,
    ya as Mf,
    yb as Rf,
    z as P0,
    za as Y0,
    zb as Ef
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-MRJVT6FR.js";
import {
    a as Je,
    b as qo
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R63XNKES.js";
import {
    a as Sp,
    b as Vv
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-6YHY2F3B.js";
import {
    a as wt,
    b as wo,
    c as Lv,
    k as Li
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-75O7CIXD.js";
import {
    a as Ur
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-3VK3EVUM.js";
import {
    a as jl,
    b as K,
    c as je
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-4B5HOWSN.js";
import {
    a as Mo
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-D2RAFUDH.js";
import {
    a as v0,
    b as zj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-FP2QQPAP.js";
import {
    a as Wj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-HRRCPT3U.js";
import {
    d as yh,
    g as l0
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-OQWTLMV5.js";
import {
    a as b,
    b as pp,
    c as m0,
    d as ie
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-P5VDGSEO.js";
import {
    d as Fe,
    g as De,
    l as qt,
    m as bt,
    n as Or,
    o as jc,
    p as mv,
    q as be,
    r as Wt
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-YZMXGORB.js";
import {
    a as jC,
    b as HC,
    g as aj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-VCWMZ4MQ.js";
import {
    a as To
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-TCPTYTUX.js";
import {
    b as Va,
    c as hk,
    d as sh,
    e as Cs,
    g as mk
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-BVZRGHXD.js";
import {
    a as tf,
    c as pk,
    d as uk,
    g as Hr,
    h as rh
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LFUSN6Y5.js";
import {
    b as Zm,
    e as WC,
    f as OC,
    h as fv
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-XGXYOKTY.js";
import {
    a as Bo,
    b as $,
    c as xs,
    e as Be
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-Z4HHCED6.js";
import {
    e as ZC,
    f as dj,
    k as Fn,
    l as Uc,
    m as di,
    p as Jm,
    r as ue,
    s as Zd,
    v as ve
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ZCYSW665.js";
import {
    a as Tk
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LY4A4ZCW.js";
import {
    a as gi,
    b as ce,
    c as Ck,
    d as sf,
    e as kk,
    i as ut,
    l as Pk,
    n as wj
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-QXKVEKVP.js";
import {
    c as ep,
    d as vj,
    h as Ik,
    j as Sv
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-OQTCXMQ2.js";
import {
    c as Z,
    d as ws,
    e as Km
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-YNQJOZVU.js";
import {
    C as Q,
    D as r,
    E as x,
    F as B,
    f as oh,
    g as YC
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-6YK6Y3LS.js";
import {
    a as N
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-X2AVVSDG.js";
import {
    a as Gt,
    b as Xd
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ESPTCIFT.js";
import {
    n as th,
    o as FC,
    q as Bt,
    r as Ml
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-GYU6G37N.js";
import {
    A as Ym,
    C as hv,
    D as oo,
    f as DC,
    h as rt,
    j as Vd,
    l as AC,
    p as Gd,
    q as LC,
    s as Rl,
    u as zC,
    w as $C
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-FX3USXD4.js";
import {
    b as de,
    c as Mt
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LURZCKUX.js";
import {
    d as Xm,
    f as UC,
    g as gv,
    h as Hc,
    i as VC,
    k as Oe,
    l as Wo
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-UHXY36KN.js";
import {
    b as Ht,
    c as pt,
    e as En
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ISPIXJKU.js";
import {
    a as Ze
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-JIE3ALW5.js";
import {
    b as ze
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-33VGZGAT.js";
import {
    a as hn
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-ILD4NFNU.js";
import {
    a as k,
    b as un,
    c as EC,
    d as E,
    e as uv,
    f as _e
} from "https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-64BUEHBL.js";
var Ph, W1, ld, oN, it, $n = k(() => {
    "use strict";
    Ph = E(Ze()), W1 = E(To()), ld = E(ze());
    oo();
    Wt();
    Or();
    yr();
    Nr();
    oN = W1.default.View.extend({
        saveOnDeselect: !1,
        saveOnDestroy: !1,
        disabled: !1,
        rolePermission: null,
        initialize: function(e) {
            this.initControl(e)
        },
        initControl: function(e) {
            ld.default.extend(this, e), ld.default.bindAll(this), this.blocks && (this.block = this.blocks[0])
        },
        render: function() {
            if (!this.rendered) {
                if (this.rendered = !0, this.$container.append(this.$el), this.appearanceAnimation && be.vueTransitionsShow(this.$el, "control"), this.$el.css("top", this.y), this.fromY !== this.y && (this.$el.css({
                        top: this.fromY
                    }), window.requestAnimationFrame(ld.default.bind(function() {
                        this.$el.css({
                            top: this.y
                        })
                    }, this))), this.template) {
                    let e = this.template({
                        options: this.options,
                        imgPublicPath: NC
                    });
                    if (this.rolePermission) {
                        let t = so.isPermissionAllowed(this.rolePermission);
                        this.$el.addClass("permission-controller"), this.$el.attr("disabled", !t)
                    }
                    this.$el.append(e), this.$icon = this.$(".icon"), this.$panel = this.$(".panel"), this.$icon.on("click", this.onClick.bind(this))
                }
                return this.bindLogic(), (0, Ph.default)(window).on("keyup", this.onWindowKeyUp), this.setControlsStatusByBlockData(), this.block && this.block.on("disabledControls:changed", this.onDisabledControlsChanged.bind(this)), this
            }
        },
        moveToNewPos: function(e) {
            this.$el.css("top", e)
        },
        bindLogic: function() {},
        unBindLogic: function() {},
        onClick: function() {
            this.isOnClickDisabled() || (this.selected ? this.master.deselect() : this.$el.hasClass("disabled") || this.master.select(this))
        },
        makeModelSnapshot: function() {
            this._oldAttrs && this._oldAttrs._id === this.model.attributes._id || (this._oldAttrs = this.model && rt(this.model.attributes))
        },
        clearModelSnapshot: function(e) {
            this.saveOnDeselect && e && this.canSave() && this.save(), delete this._oldAttrs
        },
        select: function() {
            this.selected || (this.makeModelSnapshot(),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls")
                }), this.selected = !0, this.faded = !1, this.$el.removeClass("fade"), this.$el.addClass("checked"), this.showPanel(), this.$icon.addClass("rmalttext-disable"))
        },
        showPanel: function() {
            be.vueTransitionsShow(this.$panel, "panel"), bt.trigger("panel:showed", this.name)
        },
        hidePanel: function() {
            return be.vueTransitionsHide(this.$panel, "panel").then(() => {
                bt.trigger("panel:hidden", this.name)
            })
        },
        setEnabled: function() {
            this.$el.removeClass("disabled"), this.disabled = !1
        },
        setDisabled: function() {
            this.$el.addClass("disabled"), this.disabled = !0, this.selected && this.master.deselect()
        },
        onDisabledControlsChanged: function() {
            this.setControlsStatusByBlockData()
        },
        setControlsStatusByBlockData: function() {
            this.block && this.block.disabledControls && (this.block.disabledControls.indexOf(this.name) !== -1 ? this.setDisabled() : this.setEnabled())
        },
        isOnClickDisabled: function() {
            return this.disabled
        },
        fade: function() {
            this.deselect(), this.faded = !0, this.$el.addClass("fade")
        },
        removeFade: function() {
            this.faded = !1, this.$el.removeClass("fade")
        },
        deselect: function() {
            let e = this.selected;
            this.selected = !1, this.faded = !1, this.$el.removeClass("fade"), this.$panel && (this.hidePanel().then(function() {
                this.$el.removeClass("checked")
            }.bind(this)), this.$icon.removeClass("rmalttext-disable"), this.clearModelSnapshot(e))
        },
        canSave: function() {
            return this.model && this._oldAttrs && !ld.default.isEqual(this.model.attributes, this._oldAttrs) && this.block && (this.model.isGlobal() || !this.block.destroyed)
        },
        onEscKey: function() {},
        onEnterKey: function() {},
        onWindowKeyUp: function(e) {
            e.keyCode === Ph.default.keycodes.esc && this.onEscKey(), e.keyCode === Ph.default.keycodes.enter && this.onEnterKey()
        },
        destroy: function(e) {
            this.saveOnDestroy && this.canSave() && this.save(), this.unBindLogic(), (0, Ph.default)(window).off("keyup", this.onWindowKeyUp), this.block && this.block.off("disabledControls:changed", this.onDisabledControlsChanged), this.$panel && this.$panel.remove(), e ? be.vueTransitionsHide(this.$el, "control").then(function() {
                this.$el.remove()
            }.bind(this)) : this.$el.remove(), this.destroyed = !0
        },
        canControlBeClosed: function(e = {}) {
            return this.selected ? (this.master.deselect(), !e.closeSelected) : !1
        },
        getControlParam: function(e) {
            let t = RM.constructorRouter.mag.edit_params.get("controls");
            if (t) return t[this.name] && t[this.name][e]
        },
        saveControlParam: function(e) {
            let t = RM.constructorRouter.mag.edit_params.get("controls"),
                o = {};
            o[this.name] = e, !(t && ld.default.isEqual(t[this.name], e)) && (this.paramsSaveXHR = RM.constructorRouter.mag.edit_params.save("controls", ld.default.extend({}, t, o)))
        },
        updatePanelVerticalPosition: function() {
            if (!this.$panel && this.$panel.length) return;
            let e = this.master.getControlsHeight(),
                t = this.$panel.height(),
                o = this.master.getControlRelativePosition(this),
                i = this.$el.height(),
                n = "";
            t >= e ? n = -Math.ceil((t - e) / 2) - o : t / 2 > o ? n = -o : t / 2 > e - o + i / 2 && (n = e - o - t), this.$panel.css("top", n)
        },
        save: function() {}
    }), it = oN
});
var ng, O1, ig, Y, iN, Ms, Ce, ae = k(() => {
    "use strict";
    ng = E(N()), O1 = E(To()), ig = E(Ze());
    oo();
    $n();
    Le();
    Ps();
    B();
    Y = (0, ng.createContext)({}), iN = it.extend({
        name: null,
        component: null,
        alt: null,
        rolePermission: null,
        saveOnDeselect: !0,
        saveOnDestroy: !0,
        initialize: function(e = {}) {
            it.prototype.initialize.apply(this, arguments), this.block = this.blocks[0], this.model = e.models && e.models.length && e.models[0], this.multipleSelectedModels = e.models && e.models.length > 1 ? e.models : void 0, this.multipleSelectedBlocks = this.blocks ? .length > 1 ? this.blocks : void 0, this.workspace = e.master && e.master.workspace || {}, this.page = this.workspace.page, this.project = this.workspace.mag, this.user = this.project.user, this.y = e.y || e.fromY, this.propsModel = new O1.default.Model({
                controlName: this.name,
                block: this.block,
                blocks: this.blocks,
                multipleSelectedBlocks: this.multipleSelectedBlocks,
                model: this.model,
                multipleSelectedModels: this.multipleSelectedModels,
                faded: this.faded || !1,
                selected: this.selected || !1,
                disabled: this.disabled || !1,
                visible: this.visible || !0,
                y: this.y,
                alt: this.alt,
                select: this.setSelected,
                deselectControls: this.setDeselect,
                deselect: this.deselect,
                removeFade: this.removeFade,
                appearanceAnimation: this.appearanceAnimation,
                page: this.page,
                project: this.project,
                user: this.user,
                injectedRefs: {},
                workspace: this.workspace,
                controlsManager: this.workspace.controls,
                useSharedState: this.block.useSharedState,
                doesUserHaveAccess: this.project.get("doesUserHaveAccess"),
                groupSave: this.groupSave,
                groupSet: this.groupSet,
                groupSetAndSave: this.groupSetAndSave,
                forceUpdateToggle: !1,
                hasParentBlock: this.block.has_parent_block,
                parentBlock: this.getParentBlock(),
                isMixed: this.isMixed
            }), this.propsModel.on("change", this.onPropsModelChanged)
        },
        isMixed: function(e) {
            if (e.length === 1) return !1;
            let t = !1;
            for (let o = 0; o < e.length - 1; o += 1) {
                let i = e[o],
                    n = e[o + 1];
                if (!Rl(i, n)) {
                    t = !0;
                    break
                }
            }
            return t
        },
        render: function() {
            let e = document.querySelector(`[data-control-type="${this.name}"]`);
            if (e && (this.reactRoot ? .unmount(), e.remove()), this.$container.append(`<div data-control-type="${this.name}">`), this.domElement = document.querySelector(`[data-control-type="${this.name}"]`), !this.domElement) return;
            this.updateContainerPosition();
            let t = r(this.component, {
                    useSharedState: this.block.useSharedState
                }),
                o = () => r(va, {
                    context: Y,
                    model: this.propsModel,
                    children: this.rolePermission ? r(Ti, {
                        permission: this.rolePermission,
                        children: t
                    }) : t
                });
            this.reactRoot = An({
                useReact18: !0,
                component: o,
                domElement: this.domElement,
                model: this.multipleSelectedModels ? this.multipleSelectedModels[this.multipleSelectedModels.length - 1] : this.model,
                onRenderComplete: () => {
                    this.$el = (0, ig.default)(this.domElement).find(":first")
                },
                onDestroy: () => {
                    this.reactRoot.unmount();
                    let i = this.domElement;
                    i && i.parentNode && i.parentNode.removeChild(i)
                }
            }), this.reactRoot.render(), this.setControlsStatusByBlockData(), this.block.on("disabledControls:changed", this.onDisabledControlsChanged.bind(this)), this.bindLogic(), document.addEventListener("keyup", this.onWindowKeyUp)
        },
        updatePropsModel: function(e) {
            this.propsModel && this.propsModel.set(e)
        },
        forceUpdate: function() {
            this.propsModel && this.propsModel.set({
                forceUpdateToggle: !this.propsModel.get("forceUpdateToggle")
            })
        },
        destroy: function(e) {
            this.propsModel.get("selected") && this.deselect(), e ? this.hide() : setTimeout(() => {
                this.destroyReact()
            }, 0), this.block.off("disabledControls:changed", this.onDisabledControlsChanged), this.unBindLogic(), this.stopListening(this.model, "change"), document.removeEventListener("keyup", this.onWindowKeyUp), this.destroyed = !0
        },
        destroyReact: function() {
            let e = this.$el.parent();
            !e || !e[0] || (this.reactRoot.unmount(), e.remove())
        },
        hide: function() {
            this.updatePropsModel({
                visible: !1
            })
        },
        show: function() {
            this.updatePropsModel({
                visible: !0
            })
        },
        updateContainerPosition: function(e) {
            this.domElement.style.top = `${typeof e=="number"?e:this.y}px`, this.domElement.style.position = "absolute"
        },
        moveToNewPos: function(e) {
            this.y = e, this.domElement && (this.updateContainerPosition(), this.updatePropsModel({
                y: e
            }))
        },
        bindShortcuts: function() {
            this.shortcutHandler = this.master.select.bind(this.master, this), this.keyboardShortcut && window.RM.constructorRouter.bindGlobalKeyPress([{
                key: this.keyboardShortcut,
                handler: this.shortcutHandler
            }]), this.onWindowKeyUpBound = this.onWindowKeyUp.bind(this), (0, ig.default)(window).on("keyup", this.onWindowKeyUpBound)
        },
        unbindShortcuts: function() {
            this.keyboardShortcut && window.RM.constructorRouter.unbindGlobalKeyPress(this.keyboardShortcut, this.shortcutHandler), (0, ig.default)(window).off("keyup", this.onWindowKeyUpBound)
        },
        setDeselect: function() {
            this.makeModelSnapshot(), this.master.deselect()
        },
        select: function() {
            this.makeModelSnapshot(), this.updatePropsModel({
                selected: !0,
                faded: !1
            })
        },
        setSelected: function() {
            this.isOnClickDisabled() || (!this.selected && !this.disabled ? this.master.select(this) : this.master.deselect())
        },
        deselect: function() {
            let e = !!this.selected;
            this.updatePropsModel({
                selected: !1,
                faded: !1
            }), this.clearModelSnapshot(e)
        },
        fade: function() {
            this.deselect(), this.updatePropsModel({
                faded: !0
            })
        },
        removeFade: function() {
            this.updatePropsModel({
                faded: !1
            })
        },
        setEnabled: function() {
            this.updatePropsModel({
                disabled: !1
            })
        },
        setDisabled: function() {
            this.updatePropsModel({
                selected: !1,
                disabled: !0
            })
        },
        save: function() {
            this.model.save({})
        },
        canControlBeClosed: function(e = {}) {
            if (this.propsModel && this.propsModel.get("preventClose")) return !0;
            if (this.selected) {
                let t = this.propsModel.get("injectedRefs");
                return t.canControlBeClosed && t.canControlBeClosed() ? !0 : (this.master.deselect(), !e.closeSelected)
            }
            return !1
        },
        onEscKey: function() {
            this.selected && this.master.deselect()
        },
        onPropsModelChanged: function() {
            this.selected = this.propsModel.get("selected"), this.disabled = this.propsModel.get("disabled"), this.faded = this.propsModel.get("faded"), this.visible = this.propsModel.get("visible")
        },
        groupSave: function(e) {
            this.workspace.save_group(e || this.multipleSelectedModels, {
                viewport: this.workspace.viewport
            }), this.forceUpdate()
        },
        groupSet: function(e) {
            this.multipleSelectedModels && this.multipleSelectedModels.map(t => t.set(e))
        },
        groupSetAndSave: function(e, t = {}) {
            let o = {
                    debounced: !0,
                    save: !0,
                    ...t
                },
                i = this.blocks,
                n = this.workspace[o.debounced ? "saveGroupDebounced" : "save_group"].bind(this.workspace);
            for (let s of i) s.model.set(typeof e == "function" ? e(s) : e);
            n(i.map(s => s.model), {
                viewport: this.workspace.viewport,
                skipHistory: o.skipHistory
            }), this.forceUpdate()
        },
        getParentBlock: function() {
            if (this.block.has_parent_block) {
                let e = this.block.attributes.parent_wid;
                if (e) return this.page.widgets.get(e)
            }
            return null
        }
    }), Ms = () => (0, ng.useContext)(Y), Ce = iN
});
var Zt, ow, Rs, nN, j1, gne, Fp = k(() => {
    "use strict";
    Zt = E(ze());
    oo();
    ow = E(Ze());
    bh();
    Rs = {
        n1: "Thin",
        n2: "ExtraLight",
        n3: "Light",
        n4: "Regular",
        n5: "Medium",
        n6: "SemiBold",
        n7: "Bold",
        n8: "ExtraBold",
        n9: "Black",
        i1: "Thin Italic",
        i2: "ExtraLight Italic",
        i3: "Light Italic",
        i4: "Italic",
        i5: "Medium Italic",
        i6: "SemiBold Italic",
        i7: "Bold Italic",
        i8: "ExtraBold Italic",
        i9: "Black Italic",
        v: "Variable"
    }, nN = {
        system: {
            title: "System Fonts",
            url: ""
        },
        google: {
            title: "Google Fonts",
            url: "http://www.google.com/fonts"
        },
        typekit: {
            title: "Typekit",
            url: "http://www.typekit.com/"
        },
        webtype: {
            title: "<Webtype>",
            url: "http://www.webtype.com/"
        },
        typetoday: {
            title: "Type.today",
            url: "https://type.today/"
        },
        custom: {
            title: "Custom web font",
            url: ""
        }
    }, j1 = function(e) {
        this.edit_params = e, this.proxyMethods(["set", "get", "fetch", "on", "off", "save"]), this.updateTypetodayVariations()
    };
    j1.prototype = {
        id: "_fonts",
        MAX_VISIBLE_TYPEKIT_FONTS: 5,
        FVD_NAMES: Rs,
        PROVIDERS: nN,
        proxyMethods: function(e) {
            let t = this,
                o = this.edit_params;
            Zt.default.each(e, function(i) {
                t[i] = function() {
                    return o[i].apply(o, arguments)
                }
            })
        },
        updateTypetodayVariations: function() {
            let e = !1,
                t = Zt.default.map(this.get("fonts"), function(o) {
                    if (o.provider === "typetoday") {
                        let i = Zt.default.find(Ln.fontsShortList.typetoday, {
                                name: o.css_name
                            }),
                            n = !!(i && Zt.default.difference(i.variations, o.variations).length);
                        return e = e || n, n ? Zt.default.extend({}, o, {
                            variations: Zt.default.union(o.variations, i && i.variations)
                        }) : o
                    } else return o
                });
            e && this.save({
                fonts: t
            }, {
                silent: !0
            })
        },
        appendFontsCssToDocument: function(e, t) {
            return Ln.appendFontsCssToDocument(Zt.default.extend({
                fonts: this.get("fonts")
            }, e), t)
        },
        findFontByCSSName: function(e) {
            return Zt.default.find(this.get("fonts"), function(t) {
                return t.css_name.toLowerCase() === e.toLowerCase()
            }) || {
                css_name: e,
                name: e
            }
        },
        getProviderData: function(e) {
            let t = this.PROVIDERS[e] || {};
            return Zt.default.defaults(t, {
                title: "",
                url: ""
            }), t
        },
        getStyleName: function(e, t, o) {
            let i = (t.toLowerCase() === "italic" ? "i" : "n") + e / 100,
                n;
            return o && (n = Ln.getCustomVariationNameByFVD(o, i)), n || this.FVD_NAMES[i]
        },
        getVisualRenderedFontStyles: function(e, t, o) {
            let i = {
                "font-weight": t
            };
            i["font-style"] = o;
            let n = this.findFontByCSSName(e),
                s = 9999,
                a;
            return n && (i["font-family"] = e, Zt.default.each(n.variations, function(l) {
                let c = (l.substr(1, 1) - 0) * 100,
                    d = Math.abs(c - t);
                d < s && (i["font-weight"] = c, s = d)
            }), a = Math.abs(700 - t), a < s && (i["font-weight"] = 700)), i
        },
        findCommonFontsStylesAvailable: function(e) {
            let t = [];
            return Zt.default.each(e, Zt.default.bind(function(o) {
                let i = this.findFontByCSSName(o);
                if (i) {
                    let n = [];
                    Zt.default.each(i.variations, function(s) {
                        let a = (s.substr(1, 1) - 0) * 100,
                            l = s.substr(0, 1) === "n" ? "normal" : "italic";
                        n.push(a + "-" + l)
                    }), t.push(n)
                }
            }, this)), t.length > 0 && (t = Zt.default.intersection.apply(this, t)), t
        },
        typekitFontsCount: function(e) {
            let t = Zt.default.where(e, {
                    provider: "typekit"
                }).length,
                o = Zt.default.where(e, {
                    provider: "typekit",
                    hidden: !0
                }).length;
            return {
                visible: t - o,
                hidden: o
            }
        },
        changeFontsHidden: function(e = [], t, o, i) {
            let n = rt(this.get("fonts"));
            return e.forEach(s => {
                let a = Zt.default.find(n, l => l.css_name.toLowerCase() === s.toLowerCase()) || {};
                a.hidden = t, a._id && a.is_personal && ow.default.ajax({
                    url: "/api/customfonts",
                    method: "PATCH",
                    dataType: "json",
                    contentTypeType: "application/json",
                    data: {
                        _id: a._id,
                        hidden: a.hidden,
                        mag_user: o,
                        mag_num_id: i
                    }
                })
            }), this.typekitFontsCount(n).visible > this.MAX_VISIBLE_TYPEKIT_FONTS ? {
                error: "typekit-full-house"
            } : (this.save("fonts", n), {})
        },
        changeFontHidden: function(e, t, o, i) {
            let n = rt(this.get("fonts")),
                s = Zt.default.find(n, function(a) {
                    return a.css_name.toLowerCase() === e.toLowerCase()
                }) || {};
            return s.hidden = t, s._id && s.is_personal && ow.default.ajax({
                url: "/api/customfonts",
                method: "PATCH",
                dataType: "json",
                contentTypeType: "application/json",
                data: {
                    _id: s._id,
                    hidden: s.hidden,
                    mag_user: o,
                    mag_num_id: i
                }
            }), this.typekitFontsCount(n).visible > this.MAX_VISIBLE_TYPEKIT_FONTS ? {
                error: "typekit-full-house"
            } : (this.save("fonts", n), {})
        },
        getUsedFontsCache: function() {
            let e = {};
            return Zt.default.each(this.get("fonts"), function(t) {
                e[t.css_name] = {
                    temporary: t.temporary,
                    hidden: t.hidden
                }
            }), e
        },
        addFonts: function(e, t) {
            let o = rt(this.get("fonts")),
                i;
            return Zt.default.each(e, Zt.default.bind(function(n) {
                Zt.default.contains(["template", "paste"], t) && delete n.used_variations, i = Zt.default.find(o, function(s) {
                    return s.css_name.toLowerCase() === n.css_name.toLowerCase()
                }), Zt.default.contains(["font-explorer", "manual"], t) && (i ? i.hidden = !1 : o.push(n)), t === "font-upload" && (i ? Zt.default.extend(i, e[0]) : o.push(n)), Zt.default.contains(["template", "paste"], t) && (i || (n.hidden = !0, o.push(n)))
            }, this)), t === "font-explorer" && this.typekitFontsCount(o).visible > this.MAX_VISIBLE_TYPEKIT_FONTS ? {
                error: "typekit-full-house"
            } : (this.save({
                fonts: o
            }, {
                silent: Zt.default.contains(["template", "paste", "manual"], t)
            }), this.appendFontsCssToDocument({
                version: "edit"
            }, () => {
                window.RM.constructorRouter.trigger("font-added")
            }), {})
        },
        removeFonts: function(e) {
            let t = rt(this.get("fonts"));
            Zt.default.each(t, function(o) {
                Zt.default.each(e, function(i) {
                    o.css_name.toLowerCase() === i.toLowerCase() && (o.hidden = !0)
                })
            }), this.save("fonts", t)
        },
        clearTempFonts: function() {
            if (Zt.default.findWhere(this.get("fonts"), {
                    temporary: !0
                })) {
                let t = rt(this.get("fonts"));
                t = Zt.default.filter(t, function(o) {
                    let i = !(o.temporary && o.hidden);
                    return delete o.temporary, i
                }), this.save("fonts", t)
            }
        }
    };
    gne = j1
});
var iw, Th, rN, cd, rg = k(() => {
    "use strict";
    iw = E(To()), Th = E(ze()), rN = iw.default.Model.extend({
        tracked: !0,
        parse: function(e, t) {
            return t && t.xhr && !this.isNew() && (!t || !t.noSocketUpdate) && (Th.default.isEmpty(e) && (e = this.toJSON(Th.default.pick(t, "viewport", "fixViewports"))), this.triggerSocketUpdate(e, t)), iw.default.Model.prototype.parse.apply(this, arguments)
        },
        triggerSocketUpdate: function(e, t) {
            let o = e,
                i = this.getViewport && this.getViewport() || t ? .viewport;
            if (t && t.patch && (o = Th.default.extend({}, t.attrs, this.pick("_id", "pid"))), o = this.getChangedAttributes ? this.getChangedAttributes() : o, Th.default.isEmpty(o) && (o = this.toJSON()), !o.pid && this.getPageId && this.name !== "Page" && (o.pid = this.getPageId()), i && i !== "default") {
                let n = o.pid || this.getPageId && this.getPageId();
                return this.triggerMobileViewportUpdate(n)
            }
            RM.constructorRouter.trigger("update_from_server", this.name, o, i)
        },
        triggerMobileViewportUpdate: function(e) {
            RM.constructorRouter.trigger("update_from_server", "UpdateInMobileViewport", e)
        }
    }), cd = rN
});
var H1, Yr, sg, N1, U1, Xt, Zr = k(() => {
    "use strict";
    H1 = E(To()), Yr = E(ze());
    oo();
    rg();
    Or();
    sg = cd.prototype, N1 = {
        save() {
            return this.set.apply(this, arguments), !1
        },
        sync() {}
    }, U1 = cd.extend({
        save: function(e, t, o) {
            let i, n = this;
            if (Yr.default.isObject(e) || e == null ? (i = e, o = t) : (i = {}, i[e] = t), o && o.skipMagChanging && this.urlRoot && (o.url = this.url() + (this.url().indexOf("?") > -1 ? "&" : "?") + "skip_changed=true"), o = o ? Yr.default.clone(o) : {}, !o.skipPersist) var s = sg.save.apply(this, arguments);
            if (s) return s.error(function(a, l) {
                l != "abort" && (a.status && a.status < 500 || (n.wasNotSaved = !0, RM.constructorRouter.raiseConnectionError()))
            }), s.success(function() {
                n.wasNotSaved && n.trigger("re-saved"), n.wasNotSaved = !1
            }), this.skipResponse && (s.skipResponse = !0), bt.trigger("save:model", {
                model: this,
                setAttrs: i,
                options: o
            }), !this.skipMagChanging && !o.skipMagChanging && RM.constructorRouter.mag && RM.constructorRouter.mag.set("changed", !0), s
        },
        sync: function(e, t, o) {
            if (e.toLowerCase() == "patch" && t.collection && t.collection.page) {
                let i = t.collection.page.getCurrentViewport();
                if (i != "default" && !(o && o.forceDefaultViewport) && !this.isNested) {
                    let n = t.toJSON(),
                        s = {};
                    s["viewport_" + i] = Yr.default.pick(n["viewport_" + i], Yr.default.keys(o.attrs)), Yr.default.isEmpty(s["viewport_" + i]) && delete s["viewport_" + i];
                    let a = Yr.default.difference(Yr.default.keys(o.attrs), Yr.default.keys(s["viewport_" + i]));
                    Yr.default.extend(s, Yr.default.pick(t.attributes, a)), o.attrs = s
                }
            }
            return sg.sync.apply(this, arguments)
        },
        parse: function(e, t) {
            return t && t.xhr && t.xhr.skipResponse ? (sg.parse.apply(this, arguments), this.isNew() ? e : void 0) : sg.parse.apply(this, arguments)
        },
        set: function(e, t, o) {
            let i, n;
            Yr.default.isObject(e) || e == null ? (i = e, n = t) : (i = {}, i[e] = t, n = o), n = n || {};
            let s = this.cloneJSON(),
                a = H1.default.Model.prototype.set.apply(this, arguments);
            return bt.trigger("set:model", {
                model: this,
                prevAttrs: s,
                setAttrs: i,
                options: n
            }), a
        },
        cloneJSON: function() {
            let e = this.toJSON();
            return Yr.default.each(e, function(t, o) {
                e[o] = rt(t)
            }), e
        }
    });
    U1.isIncomingUpdate = (e = {}) => e && (e.socketUpdate || e.resetPage);
    Xt = U1
});
var V1, G1 = k(() => {
    "use strict";
    no();
    V1 = {
        "template-constructor-block": Ae `
	<div class="block <%=block.hidden ? 'invisible' : ''%> <%=hardwareAcceleration ? 'hardware-acceleration' : ''%>" aria-label="<%=block.type%> block" data-id="<%=block._id%>">
		<div class="content"></div>
		<%= templates['template-block-frame']({ has_parent_block, hide_rotate_controls }) %>
	</div>
`
    }
});
var Dp, ag = k(() => {
    "use strict";
    no();
    Dp = {
        "template-block-frame": Ae `
	<div class="frameborder">
		<% if (!has_parent_block && !hide_rotate_controls) { %>
			<div class="rotation-control" data-dragdirection="lt" draggable="true" />
			<div class="rotation-control" data-dragdirection="rt" draggable="true" />
			<div class="rotation-control" data-dragdirection="rb" draggable="true" />
			<div class="rotation-control" data-dragdirection="lb" draggable="true" />
		<% } %>
		<div class="dot lt" data-ind="0"></div>
		<div class="dot t" data-ind="1"></div>
		<div class="dot rt" data-ind="2"></div>
		<div class="dot r" data-ind="3"></div>
		<div class="dot rb" data-ind="4"></div>
		<div class="dot b" data-ind="5"></div>
		<div class="dot lb" data-ind="6"></div>
		<div class="dot l" data-ind="7"></div>
		<div class="triangle lt" data-ind="0">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle t" data-ind="1">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle rt" data-ind="2">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle r" data-ind="3">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle rb" data-ind="4">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle b" data-ind="5">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle lb" data-ind="6">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
		<div class="triangle l" data-ind="7">
			<svg width="10" height="7" viewBox="0 0 10 7" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M8.11814 0C9.25023 4.08161e-07 9.90029 1.2923 9.22758 2.20555L6.10944 6.43861C5.55808 7.18713 4.44192 7.18713 3.89056 6.43861L0.772421 2.20555C0.0997103 1.2923 0.749766 4.6647e-07 1.88186 0H8.11814Z" fill="#0078FF"/>
			</svg>
		</div>
	</div>
`
    }
});
var Y1, Z1 = k(() => {
    "use strict";
    no();
    Y1 = {
        "template-pack": Ae `
		<div class="pack" id="pack_<%= id %>">
			<div class="content"></div>
			<% if (id === 'selected') { %>
				<div class="rotation-control" data-dragdirection="lt" draggable="true" />
				<div class="rotation-control" data-dragdirection="rt" draggable="true" />
				<div class="rotation-control" data-dragdirection="rb" draggable="true" />
				<div class="rotation-control" data-dragdirection="lb" draggable="true" />
			<% } %>
			<%= templates['template-block-frame']({ has_parent_block: true }) %>
		</div>
`
    }
});
var X1, Ir, sN, K1, J1, q1 = k(() => {
    "use strict";
    X1 = E(Ze()), Ir = E(ze());
    On();
    Yd();
    Nr();
    Ml();
    Ya();
    En();
    sN = {
        show: function(...e) {
            K1.prototype.show.apply(this, e), this.$el.addClass("no-resize")
        },
        onResizeStart: function() {},
        onResizeEnd: function() {},
        doResize: function() {
            return this.block.latestPosAngle
        },
        resizeBlock: function(e) {
            return e
        }
    }, K1 = $t.extend({
        baseDimension: "width",
        initialize: function() {
            $t.prototype.initialize.apply(this, arguments), so.isPermissionAllowed("BaseWidgetChangeSize") || (Ir.default.extend(this, {}, nw), Ir.default.extend(this, {}, sN), Ir.default.bindAll(this)), this.setSizeConstraints()
        },
        setSizeConstraints: function() {
            let e = this.getLimits();
            this.minwidth = Math.max(15, e.minwidth || 0), this.minheight = Math.max(15, e.minheight || 0), this.maxwidth = Math.min(1 / 0, e.maxwidth || 1 / 0), this.maxheight = Math.min(1 / 0, e.maxheight || 1 / 0)
        },
        getWidgets() {
            return this.block.blocks.map(e => e.model)
        },
        _setRotationAngle(e) {
            let t = this.block.workspace.getParameters();
            this.coordinatesAndAttrs.forEach((o, i) => {
                let n = vo.coordinatesToClientBox([o], t),
                    s = Bt.getCenter(n),
                    a = Bt.rotate(s, this.rotateStartedAtOrigin, e),
                    l = {
                        left: a.left - n.width / 2,
                        top: a.top - n.height / 2,
                        width: n.width,
                        height: n.height
                    },
                    {
                        x: c,
                        y: d
                    } = vo.mapWidgetToWorkspace(l, o.fixed_position, t);
                this.block.blocks[i].model.set({
                    x: c,
                    y: d,
                    angle: Math.round(e + o.angle)
                })
            })
        },
        _updateRotationCursor: function({
            clientX: e,
            clientY: t,
            angle: o
        }, i = !1) {
            let n = {
                left: e,
                top: t,
                transform: `rotate(${o}deg)`
            };
            return i && (n.zIndex = 9999), (0, X1.default)(this.rotationCursor).css(n)
        },
        _storePosition: function() {
            this.block.blocks.forEach(e => e.storeFixedPosition())
        },
        _restorePosition: function() {
            this.block.blocks.forEach(e => e.restoreFixedPosition())
        },
        _save() {
            RM.constructorRouter.workspace.save_group(this.block.blocks.map(({
                model: e
            }) => e), pt("widget.putNotPatch") ? {
                patch: !0
            } : void 0)
        },
        getLimits: function() {
            let e = this.block.getModelBox(),
                t = this.block.isFullWidth() ? "height" : this.baseDimension,
                o = Ir.default.reduce(this.block.blocks, function(i, n) {
                    let s = n.getModelBox(),
                        a = {
                            minwidth: n.frame && n.frame.minwidth,
                            minheight: n.frame && n.frame.minheight,
                            maxwidth: n.frame && n.frame.maxwidth,
                            maxheight: n.frame && n.frame.maxheight
                        };
                    if (n.proportional && (a = Rt.getBoxLimits(s, a)), n.frame && n.frame.applyExtraConstraints) {
                        let p = n.frame.applyExtraConstraints({
                            width: a.minwidth,
                            height: a.minheight
                        });
                        a.minwidth = p.width, a.minheight = p.height
                    }
                    let l = s.angle ? Rt.calcBoundingBox(s, !1, !0) : s,
                        c = (s.angle ? l[t] : s[t]) / a["min" + t],
                        d = (s.angle ? l[t] : s[t]) / a["max" + t];
                    return {
                        min: Math.min(c, i.min),
                        max: Math.max(d, i.max)
                    }
                }, {
                    min: 1 / 0,
                    max: 0
                });
            return {
                minwidth: e.width / o.min,
                minheight: e.height / o.min,
                maxwidth: e.width / o.max,
                maxheight: e.height / o.max
            }
        },
        show: function(...e) {
            Ir.default.each(this.block.blocks, function(t) {
                t.isSelected() && !t.isAllBlocksInMyPackSelected() ? (t.frame.setRotationState(), t.frame.show({
                    mode: Wn.NormalNoResize
                })) : (t.frame.removeRotationState(), t.frame.hide())
            }), $t.prototype.show.apply(this, e)
        },
        isAllBlocksInPackSelected: function() {
            return this.block.blocks.every(e => e.isSelected())
        },
        onResizeStart: function(e, t) {
            $t.prototype.onResizeStart.apply(this, arguments), Ir.default.each(this.block.blocks, function(o) {
                o.frame.onResizeStart(e, t, {
                    isGroupResize: !0
                })
            })
        },
        onResizeEnd: function(e, t) {
            $t.prototype.onResizeEnd.apply(this, arguments), Ir.default.each(this.block.blocks, function(o) {
                o.frame.onResizeEnd(e, t, {
                    skipHistory: !0,
                    skipPersist: !0,
                    isGroupResize: !0
                })
            }), this.redrawCurrentPackFrame()
        },
        doResize: function(e, t = !1, o, i) {
            this.block.line && this.block.line.update(e, this.block.isVisible(), this.block.model.get("fixed_position"), this.block.model.getViewport());
            let n = this.block.getModelBox(),
                s = this.resizeBlock.bind(this, n, e, o, i, t),
                a = this.getIncludedWholePacks(),
                l;
            l = a.reduce((h, u) => [...h, ...u.blocks], []);
            let c = Ir.default.difference(this.block.blocks, l),
                d = Ir.default.map(c, s);
            a.forEach(h => {
                let u = Ir.default.map(h.blocks, s),
                    m = Rt.getBoundingBoxOfBoxes(u);
                this.applyBoundingBoxToBlock(m, h, !t), d = d.concat(u)
            });
            let p = Rt.getBoundingBoxOfBoxes(d);
            return this.block.css(Ir.default.extend({}, p, {
                doNotRedrawPacksFrames: !0
            }), this.currentResizePoint), p
        },
        getIncludedWholePacks: function() {
            return [...this.block.blocks.map(t => t.model.get("pack_id")).filter(t => t && t !== this.block.id).reduce((t, o) => {
                let i = this.block.workspace.packs[o];
                return i && i.blocks.length === this.block.blocks.filter(n => n.model.get("pack_id") === o).length ? t.add(i) : t
            }, new Set)]
        },
        resizeBlock: function(e, t, o, i, n, s) {
            let a = s.getModelBox(),
                {
                    angle: l,
                    sinAngle: c,
                    cosAngle: d
                } = a,
                p = l ? Rt.calcBoundingBox(a, !1, !0) : a,
                h = Rt.getResizedBoxNested(p, e, t, this.block.isFullWidth() ? "height" : null),
                u = !n;
            u && typeof s.scaleContent == "function" && s.scaleContent(h, p), h = s.frame.applyConstraints(h, {
                direction: o,
                fromCenter: i,
                packBox: t,
                ratio: l ? p[this.baseDimension] / p[this.baseDimension === "width" ? "height" : "width"] : s.ratio,
                baseDimension: this.baseDimension
            });
            let m = l ? Rt.getResizedBoxByBB(a, p, h, {
                sin: c,
                cos: d
            }) : h;
            if (this.applyBoundingBoxToBlock(m, s, u), u && s.model.attributes.type === "text") {
                let f = s.getRealContentHeight(!0, m.width);
                f !== Math.round(m.height) && (m.height = f, this.applyBoundingBoxToBlock(m, s))
            }
            return s.recalcFixedLine(), s.recalcStickedLine(), h
        },
        redrawCurrentPackFrame: function() {
            let o = this.block.blocks.map(n => Rt.calcBoundingBox(n.getModelBox(), !1, !0)),
                i = Rt.getBoundingBoxOfBoxes(o);
            this.block.css(i, this.currentResizePoint)
        },
        applyBoundingBoxToBlock: function(e, t, o = !1) {
            t.css(Ir.default.extend({}, {
                left: Math.round(e.left),
                top: Math.round(e.top),
                width: Math.round(e.width),
                height: Math.round(e.height)
            }, {
                doNotRedrawPacksFrames: !0,
                isGroupResize: !0,
                groupedIds: t.model.get("type") === "hotspot" ? Ir.default.map(this.block.blocks, "id") : [],
                resizeContent: o
            }))
        }
    }), J1 = K1
});
var tP = {};
EC(tP, {
    WidgetPack: () => aN,
    WidgetPackModel: () => eP
});
var rw, Q1, zi, eP, aN, oP = k(() => {
    "use strict";
    rw = E(Ze()), Q1 = E(To()), zi = E(ze());
    Ro();
    Z1();
    ag();
    q1();
    On();
    Yd();
    eP = Q1.default.Model.extend({
        defaults: {
            type: "pack",
            visible: !1,
            x: Number.POSITIVE_INFINITY,
            y: Number.POSITIVE_INFINITY,
            r: Number.NEGATIVE_INFINITY,
            b: Number.NEGATIVE_INFINITY,
            w: 0,
            h: 0,
            aspect: null,
            angle: 0,
            fixed_position: null,
            is_full_width: !1,
            is_full_height: !1,
            flip_v: !1,
            flip_h: !1,
            sinAngle: 0,
            cosAngle: 1,
            viewport: "default"
        },
        getViewport: function() {
            return this.get("viewport")
        },
        reset: function() {
            this.set(this.defaults)
        }
    }), aN = me.extend({
        id: null,
        blocks: null,
        workspace: null,
        latestPosSizeAngle: null,
        frame: null,
        line: null,
        proportional: !1,
        initialize: function(e) {
            zi.default.bindAll(this), this.blocks = [], this.latestPosSizeAngle = {}, this.model = new eP, this.workspace = e.workspace
        },
        render: function() {
            let e = Y1["template-pack"]({
                id: this.id,
                templates: { ...Dp
                }
            });
            return this.setElement((0, rw.default)(e)), this.bindHandlers(), this.frame = new J1({
                packId: this.id,
                block: this,
                blocks: this.blocks
            }), this.rendered = !0, this.$el
        },
        getCss: function(e, t) {
            let o = this.model.attributes;
            return {
                left: o.x + (o.fixed_position ? e : 0),
                top: o.y + (o.fixed_position ? t : 0),
                width: o.w,
                height: o.h,
                position: o.fixed_position ? "fixed" : "absolute",
                "z-index": o.fixed_position ? 9999 : void 0
            }
        },
        update: function({
            isInSelectionWithOthers: e
        } = {}) {
            let t = this.getCss(this.workspace.position.left, this.workspace.position.top);
            this.$el.css(t), this.isVisible() ? this.frame.show({
                mode: e ? Wn.NormalNoResize : Wn.Normal
            }) : this.frame.hide(), this.$el.toggleClass("fixed-frame", this.isFixed()), this.$el.toggleClass("full-width", this.isFullWidth()), this.$el.toggleClass("full-height", this.isFullHeight()), this.recalcFixedLine()
        },
        recalcFixedLine: function(e) {
            let t = this.model.get("fixed_position") || this.restoreFixed,
                o = this.isVisible() || e;
            t && o && !this.isSelection() ? this.updateFixedLine(t) : this.removeFixedLine()
        },
        destroy: function() {
            this.removeFixedLine(), me.prototype.destroy.apply(this, arguments), this.$el.off()
        },
        bindHandlers: function() {
            let e = (0, rw.default)(this.$el);
            e.drag("start", this.onDragStart, {
                not: ".no-drag"
            }), e.drag(this.onDragMove, {
                delay: 100
            }), e.drag("end", this.onDragEnd), e.on("click", this.onPackClick)
        },
        addBlock: function(e, t = {}) {
            if (this.blocks.push(e), !e.isPackFrameHidden) {
                let o = e.getBoxData({
                        includeBoundingBox: !0,
                        checkFixedPosition: !0
                    }),
                    i = Math.min(this.model.get("x"), o.bb_x),
                    n = Math.min(this.model.get("y"), o.bb_y),
                    s = Math.max(this.model.get("b"), o.bb_y + o.bb_h),
                    a = Math.max(this.model.get("r"), o.bb_x + o.bb_w),
                    l = e.model.get("fixed_position"),
                    c = e.model.get("is_full_width"),
                    d = e.model.get("is_full_height");
                this.model.set({
                    y: n,
                    x: i,
                    b: s,
                    r: a,
                    w: a - i,
                    h: s - n,
                    visible: zi.default.every(this.blocks, "selected"),
                    fixed_position: l || this.model.get("fixed_position"),
                    is_full_width: c || this.model.get("is_full_width"),
                    is_full_height: d || this.model.get("is_full_height"),
                    viewport: e.model.getViewport()
                }), this.proportional = !1, e.recalcFixedLine(), t.noSizeConstraints || this.frame && this.frame.setSizeConstraints()
            }
            this.latestPosSizeAngle = this.getModelBox()
        },
        reset: function() {
            this.blocks = [], this.model.reset()
        },
        isFixed: function() {
            return !!this.model.get("fixed_position")
        },
        isSelection: function() {
            return this.id === "selected"
        },
        isVisible: function() {
            return !!this.model.get("visible")
        },
        export: function() {
            return zi.default.extend({}, this.model.attributes, {
                id: this.id
            })
        },
        onDragStart: function(e, t) {
            this.anyBlockInPackForDragging = zi.default.first(this.blocks), me.prototype.onDragStart.call(this.anyBlockInPackForDragging, e, t)
        },
        onDragMove: function(e, t) {
            this.anyBlockInPackForDragging && me.prototype.onDragMove.call(this.anyBlockInPackForDragging, e, t)
        },
        onDragEnd: function(e, t) {
            this.anyBlockInPackForDragging && me.prototype.onDragEnd.call(this.anyBlockInPackForDragging, e, t)
        },
        onPackClick: function(e) {
            window.suppressClick && window.suppressClick > +new Date || this.trigger("click", e)
        },
        onMouseEnter: function() {
            this.hasSelectedBlocks() || this.frame.show({
                mode: Wn.Highlight
            })
        },
        onMouseLeave: function() {
            this.hasSelectedBlocks() || this.frame.hide()
        },
        isSelected: function() {
            return this.isVisible()
        },
        hasSelectedBlocks: function() {
            return this.blocks.some(e => e.isSelected())
        },
        restoreFixedPosition: function() {
            me.prototype.restoreFixedPosition.apply(this, arguments), zi.default.each(this.blocks, function(e) {
                e.restoreFixedPosition()
            })
        },
        getBoxData: function(...e) {
            (e[0] || {}).includeBoundingBox && zi.default.extend(this.latestPosSizeAngle, Rt.calcBoundingBox(this.latestPosSizeAngle));
            let o = me.prototype.getBoxData.apply(this, e);
            return o.b = o.y + o.h, o.r = o.x + o.w, o
        },
        getHotspotExternalPeerIds: function() {
            let e = zi.default.map(this.blocks, "id");
            return zi.default.reduce(this.blocks, function(t, o) {
                let i = o.model.get("type") === "hotspot" && zi.default.difference(o.getPeerIds(), e);
                return zi.default.each(i, function(n) {
                    t.indexOf(n) === -1 && t.push(n)
                }), t
            }, [])
        },
        getHotspotPeerData: function() {
            let e = this.getHotspotExternalPeerIds();
            return zi.default.map(e, function(t) {
                let o = this.workspace.findBlock(t);
                return zi.default.extend({}, o.getSaveBoxData(), {
                    _id: t
                })
            }.bind(this), {})
        },
        saveBox: function(e, t) {
            let o = zi.default.pick(this.getBoxData(), ["w", "h", "x", "y"]);
            this.model.set(o);
            let i = zi.default.map(this.blocks, function(n) {
                return zi.default.extend({}, n.getSaveBoxData(), {
                    _id: n.id
                })
            }.bind(this));
            i = zi.default.uniq([].concat(i, this.getHotspotPeerData(), t || []), function(n) {
                return n._id
            }), this._saveXHR && this._saveXHR.abort(), this.workspace.set_group(i, zi.default.extend({
                isGroupResize: !0
            }, e)), this.workspace.save_group(i, zi.default.extend({
                isGroupResize: !0
            }, e))
        }
    })
});
var ho, iP, at, Ap, Wn, nw, Ks, $t, On = k(() => {
    "use strict";
    ho = E(Ze()), iP = E(To()), at = E(ze());
    Yd();
    Wt();
    Or();
    Ro();
    Nr();
    Ya();
    Ml();
    En();
    Wn = {
        Normal: "normal",
        NormalNoResize: "normalNoResize",
        Highlight: "highlight"
    }, nw = {
        show: function(...e) {
            Ks.prototype.show.apply(this, e), this.$el.addClass("no-resize")
        },
        bindDrag: function() {},
        bindMouseMove: function() {},
        showSizes: function() {},
        setResizeBottomPlus: function() {},
        setRotationState: function() {},
        recalcDotsSizes: function() {},
        onDotDrag: function() {},
        onTriangleMouseEnter: function() {},
        onTriangleMouseLeave: function() {},
        onTriangleDragStart: function() {},
        onTriangleDrag: function() {},
        onResizeStart: function() {},
        onRotateStart: function() {},
        onRotate: function() {},
        onRotateEnd: function() {},
        onResize: function() {
            return this.block.latestPosAngle
        }
    }, Ks = iP.default.View.extend({
        minwidth: 1,
        minheight: 1,
        maxwidth: 9999,
        maxheight: 9999,
        frameBorderClassNames: ["orange-border", "black-border"],
        defaultBorderClassName: void 0,
        activeBorderClassName: void 0,
        _canShowFrameBorder: !0,
        FLIP_H: {
            ne: "nw",
            n: "n",
            nw: "ne",
            w: "e",
            sw: "se",
            s: "s",
            se: "sw",
            e: "w"
        },
        FLIP_V: {
            sw: "nw",
            s: "n",
            se: "ne",
            e: "e",
            ne: "se",
            n: "s",
            nw: "sw",
            w: "w"
        },
        DOTS: ["nw", "n", "ne", "e", "se", "s", "sw", "w"],
        DOTS_POS_X: [0, .5, 1, 1, 1, .5, 0, 0],
        DOTS_POS_Y: [0, 0, 0, .5, 1, 1, 1, .5],
        FIXED_DOTS: {
            nw: "se",
            n: "sw",
            ne: "sw",
            e: "nw",
            se: "nw",
            s: "nw",
            sw: "ne",
            w: "ne"
        },
        rotationOverlay: (0, ho.default)('<div id="rotation-overlay"/>'),
        rotationControls: [],
        rotationCursor: null,
        rotating: !1,
        coordinatesAndAttrs: [],
        rotateStartedAtAngle: 0,
        rotateStartedAtOrigin: 0,
        prevAngle: null,
        initialize: function(e) {
            so.isPermissionAllowed("BaseWidgetChangeSize") || at.default.extend(this, {}, nw), so.isPermissionAllowed("BaseWidgetCanSeeDefaultFrameBorder") || (this.defaultBorderClassName = "black-border"), at.default.bindAll(this), Ap = (oP(), uv(tP)).WidgetPack, this.block = e.block, this.isStandaloneMode = e.standalone, this.setElement(this.block.$el), this.$dots = this.$(".dot"), this.$triangles = this.$(".triangle"), this.$rotationControls = this.$(".rotation-control"), this.recalcDotsSizes({
                pageX: 0,
                pageY: 0
            }), this.mouseProceeding = !0, this.isStandaloneMode || (this.listenTo(this.block, "textWidgetMouseSelectionStart", this.disableMouseProceeding), this.listenTo(this.block, "textWidgetMouseSelectionEnd", this.enableMouseProceeding), this.listenTo(this.block, "textWidgetMarginDragStart", this.disableMouseProceeding), this.listenTo(this.block, "textWidgetMarginDragEnd", this.enableMouseProceeding)), this.onSizeInputChangeStart.__debounced = at.default.debounce(this.onSizeInputChangeStart, 200, !0), this.onSizeInputChangeEnd.__debounced = at.default.debounce(this.onSizeInputChangeEnd, 200), this.bindRotationDragHandlers(), this.bindRotationControlsHandlers(), this.prevAngle = this.isStandaloneMode ? 0 : this.block.model.get("angle")
        },
        bindRotationDragHandlers: function() {
            this.$rotationControls.length > 0 && this.$rotationControls.drag("start", this.onRotateStart).drag(this.onRotate).drag("end", this.onRotateEnd)
        },
        unbindRotationDragHandlers: function() {
            this.$rotationControls.length > 0 && this.$rotationControls.off("dragstart", this.onRotateStart).off("drag", this.onRotate).off("dragend", this.onRotateEnd)
        },
        bindRotationControlsHandlers: function() {
            this.$rotationControls.length > 0 && this.$rotationControls.on("mouseenter", this.onRotateControlEnter).on("mousemove", this.onRotateControlHover).on("mouseleave", this.onRotateControlLeave)
        },
        unbindRotationControlsHandlers: function() {
            this.$rotationControls.length > 0 && this.$rotationControls.off("mouseenter", this.onRotateControlEnter).off("mousemove", this.onRotateControlHover).off("mouseleave", this.onRotateControlLeave)
        },
        getWidgets() {
            return [this.block.model]
        },
        _storePosition: function() {
            this.block.storeFixedPosition()
        },
        _restorePosition: function() {
            this.block.restoreFixedPosition()
        },
        onRotateStart: function(e) {
            if (this.unbindRotationControlsHandlers(), this.isStandaloneMode) return;
            this.$dots.addClass("no-cursor"), this.$triangles.addClass("hidden"), this._storePosition();
            let {
                currentTarget: t
            } = e, {
                dragdirection: o
            } = t.dataset;
            ["rt", "rb"].includes(o) ? this.initialDirection = "counterclockwise" : ["lt", "lb"].includes(o) && (this.initialDirection = "clockwise");
            let i = this.getWidgets().map(d => {
                    let {
                        x: p,
                        y: h,
                        w: u,
                        h: m,
                        fixed_position: f,
                        angle: g = 0
                    } = d.attributes;
                    return {
                        x: p,
                        y: h,
                        w: u,
                        h: m,
                        fixed_position: f,
                        angle: g
                    }
                }),
                n = this.block.workspace.getParameters(),
                s = vo.coordinatesToClientBoundingBox(i, n),
                a = Bt.getCenter(s),
                l = Bt.absoluteToRelative({
                    left: e.clientX,
                    top: e.clientY
                }, a),
                {
                    degrees: c
                } = Bt.cartesianToPolar(l);
            this.rotateStartedAtOrigin = a, this.rotateStartedAtAngle = c, this.coordinatesAndAttrs = i, this.rotating = !0, this.toggleRotationOverlay(), this.hideDefaultCursor(), this.createRotationCursor()
        },
        _setRotationAngle(e) {
            let [{
                angle: t
            }] = this.coordinatesAndAttrs;
            this.block.model.set({
                angle: this.adjustAngle(e + t)
            })
        },
        adjustAngle: function(e) {
            let t;
            return t = e >= 360 ? e - 360 : e, t = t <= -360 ? t + 360 : t, t
        },
        onRotate: function({
            clientX: e,
            clientY: t,
            shiftKey: o
        }) {
            let n = Bt.absoluteToRelative({
                    left: e,
                    top: t
                }, this.rotateStartedAtOrigin),
                {
                    degrees: s
                } = Bt.cartesianToPolar(n),
                a = this.adjustAngle(Math.round(s - this.rotateStartedAtAngle));
            o && (a = this.adjustAngle(Math.floor(a / 15) * 15)), a !== this.prevAngle && (this.prevAngle = a, this._setRotationAngle(a), this.rotationCursor !== null && this._updateRotationCursor({
                clientX: e,
                clientY: t,
                angle: a
            }, !0))
        },
        _updateRotationCursor: function({
            clientX: e,
            clientY: t
        }, o = !1) {
            let i = this.isStandaloneMode ? 0 : this.block.model.get("angle"),
                n = {
                    left: e,
                    top: t,
                    transform: `rotate(${i}deg)`
                };
            return o && (n.zIndex = 9999), (0, ho.default)(this.rotationCursor).css(n)
        },
        onRotateEnd: function() {
            this.bindRotationControlsHandlers(), this.$dots.removeClass("no-cursor"), this.$triangles.removeClass("hidden"), this._restorePosition(), this._save(), this.initialDirection = null, this.rotating = !1, this.toggleRotationOverlay(), this.showDefaultCursor(), this.removeRotationCursor()
        },
        _save: function() {
            this.block.model.save()
        },
        onRotateControlEnter: function({
            clientX: e,
            clientY: t,
            currentTarget: o
        }) {
            this.hideDefaultCursor(), this.createRotationCursor();
            let i = this._updateRotationCursor({
                clientX: e,
                clientY: t
            });
            if (this.rotating) return;
            let {
                dragdirection: n
            } = o.dataset;
            i.removeAttr("class").addClass(n)
        },
        onRotateControlHover: function({
            clientX: e,
            clientY: t
        }) {
            this.rotating || this._updateRotationCursor({
                clientX: e,
                clientY: t
            })
        },
        onRotateControlLeave: function() {
            this.rotating || (this.showDefaultCursor(), this.removeRotationCursor())
        },
        createRotationCursor: function() {
            if (this.isCustomCursorExisted()) return;
            let e = document.createElement("div");
            e.setAttribute("id", "rotation-cursor"), this.rotationCursor = e, document.body.appendChild(this.rotationCursor)
        },
        removeRotationCursor: function() {
            this.isCustomCursorExisted() && this.rotationCursor && typeof this.rotationCursor.remove == "function" && this.rotationCursor.remove()
        },
        toggleRotationOverlay: function() {
            this.rotating ? (0, ho.default)("body").append(this.rotationOverlay) : (0, ho.default)(this.rotationOverlay).remove()
        },
        hideDefaultCursor: function() {
            document.body.classList.add("no-cursor")
        },
        showDefaultCursor: function() {
            this.rotating || document.body.classList.remove("no-cursor")
        },
        isCustomCursorExisted: function() {
            return document.getElementById("rotation-cursor") !== null
        },
        disableMouseProceeding: function() {
            this.$dots.animate({
                width: 0,
                height: 0,
                margin: 0
            }, "fast"), this.mouseProceeding = !1
        },
        enableMouseProceeding: function() {
            this.mouseProceeding = !0
        },
        show: function({
            fromWidgetbar: e,
            mode: t = Wn.Normal,
            force: o
        } = {}) {
            !this._canShowFrameBorder || (!this.activeBorderClassName && this.defaultBorderClassName && this.toggleFrameColor(this.defaultBorderClassName, !0), this.$el.addClass("frame"), (e || o) && this.$el.addClass("frameWB"), this.$el.toggleClass("hover-highlight", t === Wn.Highlight), this.$el.toggleClass("no-resize", t === Wn.NormalNoResize), this.getFrameShowMode() === t) || (this.mouseProceeding = !0, this.frameVisible = !0, t === Wn.Normal ? (this.bindMouseMove(), this.isDragBound || this.bindDrag(), this.recalcPointsDirections(), this.showSizes()) : (this.unbindMouseMove(), this.hideSizes(), !this.isStandaloneMode && this.block.isFixed() && this.block.recalcFixedLine(!0)), this.isRedBorderNeeded() && this.checkHeightOfTextWidget(), this.frameShowMode = t)
        },
        hide: function() {
            this.$el.removeClass("frame frameWB hover-highlight"), this.unbindMouseMove(), this.hideSizes(), !this.isStandaloneMode && this.block.isFixed() && this.getFrameShowMode() === Wn.Highlight && this.block.recalcFixedLine(!1), this.isStandaloneMode && this.$dots.attr("style", ""), this.frameVisible = !1, this.frameShowMode = void 0
        },
        isFrameVisible: function() {
            return this.frameVisible
        },
        getFrameShowMode: function() {
            return this.frameShowMode
        },
        bindDrag: function() {
            this.isDragBound || (this.$dots.drag("start", this.onDotDragStart).drag(this.onDotDrag).drag("end", this.onDotDragEnd), this.$triangles.on("mouseenter", this.onTriangleMouseEnter).drag("start", this.onTriangleDragStart).drag(this.onTriangleDrag).on("mouseleave", this.onTriangleMouseLeave).drag("end", this.onTriangleDragEnd), this.isDragBound = !0)
        },
        bindMouseMove: function() {
            (0, ho.default)(window).on("mousemove", this.recalcDotsSizes)
        },
        unbindMouseMove: function() {
            (0, ho.default)(window).off("mousemove", this.recalcDotsSizes)
        },
        showSizes: function() {
            !this.areSizesShown && (this.canChangeDimension("width") || this.canChangeDimension("height")) && !this.block.has_parent_block && (this.$el.children(".frameborder").after('<div id="sizes_input">'), this.sizes = new RM.vue.Sizes({
                el: "#sizes_input",
                propsData: {
                    block: this.block,
                    frame: this,
                    zoom: RM.constructorRouter.zoom.getZoom()
                }
            }), this.sizes.$on("beforeChange", this.onSizeInputChangeStart.__debounced), this.sizes.$on("afterChange", this.onSizeInputChangeEnd.__debounced), this.sizes.$on("change", this.onSizeInputChange), this.areSizesShown = !0, bt.trigger("sizes:shown"))
        },
        hideSizes: function() {
            !this.sizes || !this.areSizesShown || (this.sizes.$destroy(), this.sizes.$el.remove(), this.areSizesShown = !1, bt.trigger("sizes:hidden"))
        },
        onSizeInputChangeStart: function() {
            this.onResizeStart()
        },
        onSizeInputChangeEnd: function() {
            this.block.saveBox(), this.onResizeEnd()
        },
        onSizeInputChange: function(e, t) {
            this.isStandaloneMode || (this.block.recalcFixedLine(), this.block.recalcStickedLine()), this.doResize(e, !1, t)
        },
        setResizeBottomPlus: function(e) {
            this.$el.toggleClass("resize-bottom-plus", e), !this.isStandaloneMode && this.block.model.get("column_count") === 1 && !this.block.$el.hasClass("text-autosize") && this.checkHeightOfTextWidget()
        },
        setEditorState: function() {
            this.isStandaloneMode || (this.block.workspace.disableDragging = !0, this.$el.addClass("editor-state"), this.resetRotation())
        },
        removeEditorState: function() {
            this.isStandaloneMode || (this.$el.removeClass("editor-state"), this.block.workspace.disableDragging = !1, this.restoreRotation(), this.block.css())
        },
        setRotationState: function() {
            if (!(this.isStandaloneMode || this.$rotationControls === void 0)) {
                for (let e of this.$rotationControls)(0, ho.default)(e).addClass("hidden");
                this.block.workspace.redrawBottomShiftLine({
                    tp: "rotation"
                })
            }
        },
        removeRotationState: function() {
            if (!(this.isStandaloneMode || this.$rotationControls === void 0)) {
                for (let e of this.$rotationControls)(0, ho.default)(e).removeClass("hidden");
                this.block.workspace.redrawBottomShiftLine({
                    tp: "rotation"
                })
            }
        },
        resetRotation: function() {
            if (this.isStandaloneMode) return;
            let e = at.default.pick(this.block.latestPosSizeAngle, "angle", "flip_h", "flip_v");
            (e.angle || e.flip_h || e.flip_v) && (this.block.$el.flashClass("transitions", 500), this.block.forbidVisualRotation = !0, this.block.css(), this.recalcPointsDirections())
        },
        restoreRotation: function() {
            this.isStandaloneMode || this.block.forbidVisualRotation && (this.block.$el.flashClass("transitions", 500), this.block.forbidVisualRotation = !1, this.block.css(), this.recalcPointsDirections())
        },
        recalcDotsSizes: function(e) {
            if (!this.mouseProceeding || this.rotating) return;
            this.$rotationControls.each(function(Ue, Te) {
                (0, ho.default)(Te).removeClass("shifted")
            });
            let t = this.block.getBoxData({
                    includeRotationData: !0,
                    checkFixedPosition: !0
                }),
                o = e.pageX / RM.constructorRouter.zoom.getZoom(),
                i = e.pageY / RM.constructorRouter.zoom.getZoom(),
                n = 99999,
                s = 0,
                a = 3,
                l = 0,
                c = this.isStandaloneMode ? this.block.$parentElement.offset() : this.$el.parent().offset(),
                d = t.x + c.left,
                p = t.y + c.top,
                h = t.w,
                u = t.h,
                m = this.$el.hasClass("editor-state"),
                f = [-13, 0, 14, 14, 14, 0, -13, -13],
                g = [-13, -13, -13, 0, 14, 14, 14, 0],
                y = ["left", "left", "right", "right", "right", "left", "left", "left"],
                S = ["top", "top", "top", "top", "bottom", "bottom", "bottom", "top"],
                w = 1,
                v = 9,
                C = 70,
                I = this.isStandaloneMode ? 0 : this.block.latestPosSizeAngle.sinAngle,
                T = this.isStandaloneMode ? 1 : this.block.latestPosSizeAngle.cosAngle,
                P = this,
                M = {},
                F = 0,
                R = 0,
                A = 0,
                D = 0,
                O = -1,
                L = 99999999,
                W = 0,
                z = -1;
            if (this.isStandaloneMode ? this.block.isFixed() : this.block.model.get("fixed_position")) {
                let Ue = this.$el.offset();
                d = Ue.left, p = Ue.top
            }
            let V = h <= this.block.SUPER_SMALL_TRESHOLD && u <= this.block.SUPER_SMALL_TRESHOLD;
            if (V ? (s = this.lastResizePointIndex || 4, F = [-1, -1, 1, 1, 1, 0, -1, -1][s], R = [-1, -1, -1, -1, 1, 1, 1, -1][s]) : (this.$dots.each(function() {
                    let Ue = d + h * P.DOTS_POS_X[l] + (m ? f[l] : 0),
                        Te = p + u * P.DOTS_POS_Y[l] + (m ? g[l] : 0);
                    if ((t.angle || t.flip_v || t.flip_h) && !P.block.forbidVisualRotation) {
                        let Tt = d + h / 2,
                            Ee = p + u / 2,
                            Qe = Ue - Tt,
                            _t = Ee - Te,
                            Ge = t.flip_h ? -Qe : Qe,
                            br = t.flip_v ? -_t : _t;
                        Ue = Tt + T * Ge + I * br, Te = Ee + I * Ge - T * br
                    }
                    let Re = Math.sqrt(Math.pow(Ue - o, 2) + Math.pow(Te - i, 2)) - v;
                    Re < n && (n = Re, s = l), (Te > D && Math.abs(Te - D) > .5 || Math.abs(Te - D) < .5 && l % 2 == 1) && (D = Te, O = l, A = Ue), (Te < L && Math.abs(Te - L) > .5 || Math.abs(Te - L) < .5 && l % 2 == 1) && (L = Te, z = l, W = Ue), l++
                }), F = [-1, 0, 0, 0, 0, 0, -1, -1][s], R = [-1, -1, -1, 0, 0, 0, 0, 0][s]), O === s || z === s) {
                L -= 20, D += 20;
                let Ue = z === s ? W : A,
                    Te = z === s ? L : D,
                    Re = Math.sqrt(Math.pow(Ue - o, 2) + Math.pow(Te - i, 2)) - v;
                Re < n && (n = Re)
            }
            a = V ? v : (C - n) / C * (v - w) + w, a < 3 ? a = 3 : a > v ? a = v : a = 2 * Math.floor(a / 2) + 1, this.denyRecalcDotSize || (this.$dots.attr("style", ""), this.$triangles.attr("style", "")), M.width = a, M.height = a, M["margin-" + y[s]] = V ? -(v - 3) : -Math.floor(a / 2) + F, M["margin-" + S[s]] = V ? -(v - 3) : -Math.floor(a / 2) + R;
            let X = this.isStandaloneMode ? 0 : this.block.latestPosSizeAngle.angle,
                q = ["left", "", "right", "right", "right", "", "left", "left"],
                ne = ["top", "top", "top", "", "bottom", "bottom", "bottom", ""],
                re = 10,
                te = 11,
                ee = Math.min(1, Math.max(C - n, 0) / C),
                j = Math.floor(ee * re / 2) * 2 + 1,
                se = Math.floor(ee * te / 2) * 2 + 1,
                oe = {
                    transform: "scale(" + ee + ") rotateZ(" + -X + "deg)"
                };
            this.block.frameColor && (M["background-color"] = this.block.frameColor, oe["border-top-color"] = this.block.frameColor, oe["border-color"] = this.block.frameColor);
            let U = X > 0 ? X : 360 + X;
            U > 90 && U < 180 && (U = 180 - U), U > 270 && U < 360 && (U = 360 - U);
            let he = Math.sin(U % 180 / 180 * Math.PI),
                xe = Math.cos(U % 180 / 180 * Math.PI),
                pe = this.$dots.eq(s),
                J = (te - se) / 2 + se / 2,
                le = (re - j) / 2 + j / 2,
                ye = O === s ? 6 : 10;
            if (ne[s] || (oe[q[s]] = -le, oe.bottom = "calc(50% - " + (le - 1) + "px)"), q[s] || (oe[ne[s]] = -le, oe.right = "calc(50% - " + J + "px)"), ne[s] && q[s] && (oe[ne[s]] = -J, oe[q[s]] = -le - 2), oe["margin-" + y[s]] = -Math.floor((ye + a) * he), oe["margin-" + S[s]] = -Math.floor((ye + a) * xe), !this.denyRecalcDotSize && (pe.css(M), !this.isStandaloneMode && (O === s || z === s) && !this.block.model.get("fixed_position") && this.block.workspace && this.block.workspace.page.get("type") !== "basic" && (O === s && this.$el.hasClass("bundle-allow-bottom") || z === s && this.$el.hasClass("bundle-allow-top")))) {
                let Ue = this.$triangles[s].classList[1],
                    [Te] = this.$rotationControls.filter(`[data-dragdirection="${Ue}"]`);
                Te && !(0, ho.default)(Te).hasClass("shifted") && (0, ho.default)(Te).addClass("shifted"), this.$triangles.eq(s).css(oe).data("bundle-align", O === s ? "bottom" : "top")
            }
        },
        recalcPointsDirections: function() {
            let e = this.block.getBoxData({
                    includeRotationData: !0
                }),
                t = this.block.forbidVisualRotation ? 0 : -e.angle,
                o = Math.floor((t + 360 + 45 / 2) / 45) % 8;
            this.$dots.each(at.default.bind(function(i, n) {
                let s = this.DOTS[i];
                e.flip_v && !this.block.forbidVisualRotation && (s = this.FLIP_V[s]), e.flip_h && !this.block.forbidVisualRotation && (s = this.FLIP_H[s]), s = this.DOTS[(at.default.indexOf(this.DOTS, s) - o + 8) % 8], (0, ho.default)(n).attr("data-visual-direction", s)
            }, this))
        },
        onDotDragStart: function() {
            this.onResizeStart.apply(this, arguments)
        },
        onDotDrag: function() {
            this.onResize.apply(this, arguments), this.isStandaloneMode || this.block.workspace.distance.update([this.block])
        },
        onDotDragEnd: function() {
            this.isStandaloneMode || this.block.workspace.checkBundleDragAbility(), this.onResizeEnd.apply(this, arguments), this.isStandaloneMode || this.block.workspace.distance.hide()
        },
        onTriangleMouseEnter: function(e) {
            if (this.isStandaloneMode) return;
            let t = (0, ho.default)(e.currentTarget);
            !this.block.workspace._inTriangleBundleDrag && !this.denyRecalcDotSize && this.block.workspace.checkBundleDragMode(e, t.data("bundle-align"))
        },
        onTriangleMouseLeave: function(e) {
            this.isStandaloneMode || !this.block.workspace._inTriangleBundleDrag && !this.denyRecalcDotSize && this.block.workspace.checkBundleDragMode(e, !0)
        },
        onTriangleDragStart: function(e) {
            if (this.isStandaloneMode) return;
            let t = (0, ho.default)(e.currentTarget);
            this.denyRecalcDotSize = !0, t.addClass("moved"), this.block.workspace._inTriangleBundleDrag = !0, this.block.workspace.checkBundleDragMode(e, t.data("bundle-align")), this.block.workspace.$el.addClass("bundle-drag-cursor"), this.block.onDragStart.apply(this.block, arguments)
        },
        onTriangleDrag: function() {
            this.isStandaloneMode || this.block.onDragMove.apply(this.block, arguments)
        },
        onTriangleDragEnd: function(e) {
            if (this.isStandaloneMode) return;
            this.block.workspace._inTriangleBundleDrag = !1, (0, ho.default)(e.currentTarget).removeClass("moved"), this.denyRecalcDotSize = !1, this.block.workspace.checkBundleDragMode(e, !0), this.block.workspace.$el.removeClass("bundle-drag-cursor"), this.block.onDragEnd.apply(this.block, arguments)
        },
        onResizeStart: function(e, t, o) {
            o = o || {}, this.block.storeFixedPosition && this.block.storeFixedPosition(), (0, ho.default)("html").addClass("blocks-is-resizing"), this.denyRecalcDotSize = !0, this.$el.find(".frameborder").css("outline", "1px solid transparent"), (0, ho.default)("html").removeClass("alt-key-pressed"), this._dragEvent = e, this.isStandaloneMode || (this.block.workspace.on("specialKeydown specialKeyup", this.onSpecialKey), RM.constructorRouter.gg.snap && !this.block.model.get("fixed_position") && !o.isGroupResize && RM.constructorRouter.gg.handleMoveStart(this.block instanceof Ap ? this.block.blocks : [this.block])), this.block.onResizeStart && this.block.onResizeStart(e, t), e && (this.currentResizePoint = ["nw", "n", "ne", "e", "se", "s", "sw", "w"][(0, ho.default)(e.currentTarget).attr("data-ind")]), this.isStandaloneMode || (this.block.workspace.widgetResizingOrRotating = !0), e && (this.lastResizePointIndex = parseInt((0, ho.default)(e.currentTarget).attr("data-ind")) || 0), t && (t.scrollTop = this.isStandaloneMode ? this.block.$workspaceContainer.scrollTop() : this.block.workspace.$container.scrollTop())
        },
        customResizeHandler: function(e) {
            return e
        },
        applyExtraConstraints: function(e) {
            if (this.isStandaloneMode) return e;
            let t = this.block.model;
            if (t.get("is_full_width")) {
                let o = this.block.getFullWidthDims();
                at.default.extend(e, {
                    left: o.x,
                    width: o.w
                })
            }
            if (t.get("is_full_height")) {
                let o = this.block.getFullHeightDims();
                at.default.extend(e, {
                    top: o.y,
                    height: o.h
                })
            }
            return e
        },
        applyConstraints: function(e, t) {
            return t = at.default.extend({
                direction: "se",
                fromCenter: !1,
                isSidePointProportional: !1,
                currentResizePoint: this.currentResizePoint,
                isProportional: this.block.proportional,
                initialBox: this.block.getModelBox(),
                constraints: this.constraints,
                minwidth: this.minwidth,
                minheight: this.minheight,
                maxwidth: this.maxwidth,
                maxheight: this.maxheight,
                ratio: this.block.ratio,
                aspect: this.isStandaloneMode ? 1 : this.block.model.get("aspect")
            }, t), Ks.applyConstraintsAbstract.apply(this, [e, t, this.applyExtraConstraints.bind(this)])
        },
        checkHeightOfTextWidget: function(e) {
            if (this.isStandaloneMode) return;
            let t = this.block.getAllowableHeight(),
                o = e ? e.height : this.block.getModelBox().height;
            e && at.default.contains(["sw", "se", "s"], this.currentResizePoint) && this.stickBtmBorderOfText(t, e), this.$el.find(".frameborder").toggleClass("red-border", o < t)
        },
        stickBtmBorderOfText: function(e, t) {
            if (this.isStandaloneMode) return;
            let o = Ks.ceilObject({
                    width: t.width,
                    top: t.top,
                    left: t.left
                }),
                i = 8,
                n, s;
            n = Math.abs(t.height - e), n < i && (o.height = e, s = this.customResizeHandler(ho.default.extend(s, o), this.currentResizePoint), this.block.css(s, this.currentResizePoint))
        },
        onResize: function(e, t) {
            t.deltaX = t.deltaX / RM.constructorRouter.zoom.getZoom(), this.block._saveXHR && (this.block._saveXHR.abort && this.block._saveXHR.abort(), delete this.block._saveXHR);
            let o = this.block.workspace,
                i = this.block instanceof Ap ? this.block.blocks : [this.block];
            o && !(this.block instanceof Ap) && me.prototype.collectBottomBlo\ u0441ks(o, i, e);
            let n = this.block.resizeFromCenter || e.altKey,
                s = !this.block.has_parent_block && e.shiftKey;
            if (this._dragEvent = e, (0, ho.default)("html").hasClass("blocks-is-moving")) return;
            let a = this.isStandaloneMode ? this.block.$workspaceContainer.scrollTop() : this.block.workspace.$container.scrollTop(),
                l = t.startY + t.scrollTop,
                c = e.pageY + a;
            t.deltaY = (c - l) / RM.constructorRouter.zoom.getZoom(), be.autoWindowScroll(e, this.isStandaloneMode ? this.block.$workspaceContainer : this.block.workspace.$container, at.default.bind(function() {
                this.onResize(e, t)
            }, this));
            let d = this.block.getModelBox(),
                p = at.default.clone(d),
                h = this.isStandaloneMode ? 0 : this.block.latestPosSizeAngle.sinAngle,
                u = this.isStandaloneMode ? 1 : this.block.latestPosSizeAngle.cosAngle,
                m = this.block.getBoxData({
                    includeRotationData: !0
                }),
                f = t.deltaX,
                g = t.deltaY;
            if (m.angle && !this.block.forbidVisualRotation) {
                let I = u * t.deltaX + h * t.deltaY,
                    T = -h * t.deltaX + u * t.deltaY;
                t.deltaY = T, t.deltaX = I
            }
            let y = this.DOTS[(0, ho.default)(e.currentTarget).attr("data-ind")];
            m.flip_v && !this.block.forbidVisualRotation && (y = this.FLIP_V[y]), m.flip_h && !this.block.forbidVisualRotation && (y = this.FLIP_H[y]);
            let S = at.default.contains(["w", "e", "n", "s", "nw", "ne", "sw", "se"], y) && !!(s || this.block.proportional);
            if (y = this.modifyOnShift(e, t, d, {
                    direction: y,
                    isSidePointProportional: S
                }), n) {
                switch (y) {
                    case "nw":
                    case "ne":
                    case "n":
                        d.top += t.deltaY, d.height -= 2 * t.deltaY;
                        break;
                    case "sw":
                    case "se":
                    case "s":
                        d.top -= t.deltaY, d.height += 2 * t.deltaY;
                        break
                }
                switch (y) {
                    case "nw":
                    case "sw":
                    case "w":
                        d.left += t.deltaX, d.width -= 2 * t.deltaX;
                        break;
                    case "se":
                    case "ne":
                    case "e":
                        d.left -= t.deltaX, d.width += 2 * t.deltaX;
                        break
                }
            } else {
                switch (y) {
                    case "nw":
                    case "ne":
                    case "n":
                        d.top += t.deltaY, d.height -= t.deltaY;
                        break;
                    case "sw":
                    case "se":
                    case "s":
                        d.height += t.deltaY;
                        break
                }
                switch (y) {
                    case "nw":
                    case "sw":
                    case "w":
                        d.left += t.deltaX, d.width -= t.deltaX;
                        break;
                    case "se":
                    case "ne":
                    case "e":
                        d.width += t.deltaX;
                        break
                }
                if (S) switch (y) {
                    case "e":
                        d.top -= t.deltaY / 2, d.height += t.deltaY;
                        break;
                    case "w":
                        d.top += t.deltaY / 2, d.height -= t.deltaY;
                        break;
                    case "n":
                        d.left += t.deltaX / 2, d.width -= t.deltaX;
                        break;
                    case "s":
                        d.left -= t.deltaX / 2, d.width += t.deltaX
                }
            }
            if (RM.constructorRouter.gg.snap && !e.ctrlKey && (!m.angle && !m.flip_v && !m.flip_h || this.block.forbidVisualRotation)) {
                let I = RM.constructorRouter.gg.handleSnapResize({
                    originalBox: {
                        left: p.left,
                        top: p.top,
                        height: p.height,
                        width: p.width
                    },
                    correctedBox: {
                        left: d.left,
                        top: d.top,
                        height: d.height,
                        width: d.width
                    },
                    widget: this.block.model,
                    direction: y,
                    isSidePointProportional: S,
                    fromCenter: n
                });
                d = { ...d,
                    ...I
                }
            }
            let w = this.FIXED_DOTS[y],
                v = at.default.indexOf(this.DOTS, w);
            if (d = this.applyConstraints(d, {
                    boxOrig: p,
                    direction: y,
                    fromCenter: n,
                    isSidePointProportional: S,
                    isProportional: s || this.block.proportional,
                    fixedDot: w,
                    fixedDotInd: v,
                    DOTS_POS_Y: this.DOTS_POS_Y[v],
                    DOTS_POS_X: this.DOTS_POS_X[v],
                    sinAngle: h,
                    cosAngle: u
                }), m.angle && !n && !this.block.forbidVisualRotation) {
                let I = Ks.getRotatedBoxDelta(p, d, m.angle, y);
                d.left += I.left, d.top += I.top
            }
            if (RM.constructorRouter.gg.snap && !e.ctrlKey && !t.disableSnap && (m.angle || m.flip_v || m.flip_h) && !this.block.forbidVisualRotation) {
                let I = at.default.extend({
                        sinAngle: this.isStandaloneMode ? 0 : this.block.latestPosSizeAngle.sinAngle,
                        cosAngle: this.isStandaloneMode ? 1 : this.block.latestPosSizeAngle.cosAngle
                    }, d),
                    T = Rt.calcBoundingBox(I);
                T.left = T.bb_left, T.top = T.bb_top, T.width = T.bb_width, T.height = T.bb_height;
                let P = (0, ho.default)(e.currentTarget).attr("data-visual-direction"),
                    M = at.default.indexOf(this.DOTS, P),
                    F = T.left + T.width * this.DOTS_POS_X[M],
                    R = T.top + T.height * this.DOTS_POS_Y[M],
                    A = RM.constructorRouter.gg.handleSnapResize({
                        originalBox: T,
                        correctedBox: T,
                        widget: this.block.model,
                        direction: P,
                        isSidePointProportional: S,
                        fromCenter: n
                    }),
                    D = A.left + A.width * this.DOTS_POS_X[M],
                    O = A.top + A.height * this.DOTS_POS_Y[M],
                    L = D - F,
                    W = O - R;
                if (L || W) {
                    t.deltaX = f + L, t.deltaY = g + W, t.disableSnap = !0, this.onResize(e, t);
                    return
                }
            }
            t.disableSnap = !1, this.isStandaloneMode || (this.block.recalcFixedLine(), this.block.recalcStickedLine());
            let C = this.doResize(d, !0, y, n);
            if (o && !(this.block instanceof Ap)) {
                let I = o.bottomBlocksToMove,
                    T = Rt.calcBoundingBox(at.default.extend({
                        sinAngle: this.isStandaloneMode ? 0 : this.block.latestPosSizeAngle.sinAngle,
                        cosAngle: this.isStandaloneMode ? 1 : this.block.latestPosSizeAngle.cosAngle
                    }, p)),
                    P = Rt.calcBoundingBox(at.default.extend({
                        sinAngle: this.isStandaloneMode ? 0 : this.block.latestPosSizeAngle.sinAngle,
                        cosAngle: this.isStandaloneMode ? 1 : this.block.latestPosSizeAngle.cosAngle
                    }, d)),
                    M = P.bb_top - T.bb_top;
                I && I.vPressed && (M += P.bb_height - T.bb_height), me.prototype.moveBottomBlocks(o, M, !1, {
                    y: 0
                })
            }
            return this.isRedBorderNeeded() && this.checkHeightOfTextWidget(C), e.preventDefault(), C
        },
        doResize: function(e, t, o, i = !0) {
            let n = i ? Ks.ceilObject({
                    height: e.height,
                    width: e.width,
                    top: e.top,
                    left: e.left
                }) : e,
                s = this.customResizeHandler(ho.default.extend(e, n), this.currentResizePoint, t);
            return typeof this.minwidth < "u" && (s.width = Math.max(s.width, this.minwidth)), typeof this.maxwidth < "u" && (s.width = Math.min(s.width, this.maxwidth)), typeof this.minheight < "u" && (s.height = Math.max(s.height, this.minheight)), typeof this.maxheight < "u" && (s.height = Math.min(s.height, this.maxheight)), this.isStandaloneMode ? this.block.onFrameResize && this.block.onFrameResize(s) : (this.block.css(s, this.currentResizePoint), this.block.trigger("resize", s)), e
        },
        isRedBorderNeeded: function() {
            if (!this.isStandaloneMode && this.block.model.get("type") === "text")
                if (this.block.model.get("version") === 3) {
                    let e = this.block.model.get("columns"),
                        t = this.block.model.get("autosize");
                    return (!e || e.count === 1) && !t
                } else return !!(this.block.$el.hasClass("block-text") && this.block.model.get("column_count") === 1 && !this.block.$el.hasClass("text-autosize"))
        },
        modifyOnShift: function(e, t, o, i) {
            let n = e.shiftKey,
                s = i.direction;
            if (!this.block.has_parent_block && (n && !this.block.proportional || i.isSidePointProportional)) {
                let l = this.block.model.get("aspect") || o.width / o.height,
                    c = 1 / l;
                if (at.default.contains(["w", "e"], s)) return t.deltaY = t.deltaX * c, s;
                if (at.default.contains(["n", "s"], s)) return t.deltaX = t.deltaY * l, s;
                if (at.default.contains(["nw", "se"], s)) var a = c;
                at.default.contains(["sw", "ne"], s) && (a = -c);
                let d = t.deltaY + t.deltaX / a;
                return t.deltaX = d / (a + 1 / a), t.deltaY = t.deltaX * a, s
            } else return s
        },
        onResizeEnd: function(e, t, o) {
            if (o = o || {}, be.autoWindowScrollClear(), t && (t.deltaX = t.deltaX / RM.constructorRouter.zoom.getZoom()), this.block.restoreFixedPosition && this.block.restoreFixedPosition(), this.isStandaloneMode || (this.block.recalcFixedLine(), this.block.recalcStickedLine()), this.$el.find(".frameborder").css("outline", ""), !this.isStandaloneMode && !this.block.dontSaveOnResize) {
                let i = this.block instanceof Ap,
                    n = this.block.workspace.bottomBlocksToMove,
                    s = this.block.workspace.spacesController && this.block.workspace.spacesController.getBlocksToSave() || [],
                    a = at.default.extend({
                        resizePoint: this.currentResizePoint
                    }, o),
                    l = i ? this.block.blocks : [this.block],
                    c = at.default.map([].concat(l, n && n.tosave || [], s), function(d) {
                        return at.default.extend({
                            _id: d.id
                        }, d.getSaveBoxData(a))
                    });
                n && n.initPageHeight != this.block.workspace.page.getViewportParam(this.block.workspace.viewport, "height") && n.tosave && n.tosave.length && this.block.workspace.page.saveHeight(), i ? this.block.saveBox(at.default.extend({
                    resizePoint: this.currentResizePoint
                }, o), c) : this.block.workspace.save_group(c, pt("widget.putNotPatch") ? {
                    patch: !0
                } : void 0), this.block.workspace.clearBottomBlocksToMove()
            }
            this.currentResizePoint = void 0, this.denyRecalcDotSize = !1, (0, ho.default)("html").removeClass("blocks-is-resizing"), RM.constructorRouter.gg.snap && RM.constructorRouter.gg.handleMoveEnd(), this.block.onResizeEnd && this.block.onResizeEnd(e, t, o), this.isStandaloneMode || (this.block.workspace.off("specialKeydown specialKeyup", this.onSpecialKey), this.block.workspace.widgetResizingOrRotating = !1, this.block.workspace.checkBundleDragAbility()), this.block.model.get("type") === "text" && this.block.redraw(this.block.model)
        },
        onSpecialKey: function(e) {
            e.keyCode == ho.default.keycodes.shift && this.block.proportional || (e.type == "keydown" && (this._dragEvent.altKey = e.altKey, this._dragEvent.shiftKey = e.shiftKey), e.type == "keyup" && (e.keyCode == ho.default.keycodes.shift && (this._dragEvent.shiftKey = !1), e.keyCode == ho.default.keycodes.alt && (this._dragEvent.altKey = !1)), this.$dots.trigger(this._dragEvent))
        },
        canChangeDimension: function(e) {
            if (this.block.canChangeDimension && typeof this.block.canChangeDimension == "function") return this.block.canChangeDimension(e);
            switch (e) {
                case "width":
                    return this.isStandaloneMode ? !0 : !this.block.isFullWidth() && (at.default.isUndefined(this.minwidth) || this.minwidth !== this.maxwidth);
                case "height":
                    return this.isStandaloneMode ? !0 : !this.block.isFullHeight() && (at.default.isUndefined(this.minheight) || this.minheight !== this.maxheight);
                default:
                    return !0
            }
        },
        toggleFrameColor: function(e, t) {
            let o = this.$el.find(".frameborder");
            if (!o) return;
            let i = this.frameBorderClassNames.filter(s => s !== e),
                n = t ? ? o.hasClass(e);
            i.forEach(s => o.removeClass(s)), n ? (o.addClass(e), this.activeBorderClassName = e) : (o.removeClass(e), this.activeBorderClassName = void 0)
        },
        canShowFrameBorder: function() {
            return this._canShowFrameBorder
        },
        setFrameBorderVisible: function(e = !0) {
            this._canShowFrameBorder = !!e
        },
        destroy: function() {
            this.hide(), this.showDefaultCursor(), this.removeRotationCursor(), this.unbindRotationDragHandlers(), this.unbindRotationControlsHandlers(), this.retargetScroll && this.retargetScroll.restore && this.retargetScroll.restore(), this.isStandaloneMode || (this.stopListening(this.block, "textWidgetMouseSelectionStart", this.disableMouseProceeding), this.stopListening(this.block, "textWidgetMouseSelectionEnd", this.enableMouseProceeding), this.stopListening(this.block, "textWidgetMarginDragStart", this.disableMouseProceeding), this.stopListening(this.block, "textWidgetMarginDragEnd", this.enableMouseProceeding), this.block.workspace.off(null, null, this))
        }
    }, {
        applyConstraintsAbstract: function(e, t, o) {
            t = t || {};
            let i = t.direction,
                n = t.fromCenter;
            t.isProportional && (t = at.default.extend({}, t, Rt.getBoxLimits(t.initialBox, {
                minwidth: t.minwidth,
                maxwidth: t.maxwidth,
                minheight: t.minheight,
                maxheight: t.maxheight
            })));
            let s = t.isSidePointProportional && (i === "n" || i === "s"),
                a = t.isSidePointProportional && (i === "e" || i === "w");
            if (e.width < t.minwidth) {
                if (at.default.contains(["nw", "sw", "w"], i) || s) {
                    var l = e.width - t.minwidth;
                    e.left += n || s ? l / 2 : l
                }
                at.default.contains(["se", "ne", "e"], i) && n && (e.left += (e.width - t.minwidth) / 2), e.width = t.minwidth
            }
            if (e.height < t.minheight && ((at.default.contains(["nw", "ne", "n"], i) || a) && (l = e.height - t.minheight, e.top += n || a ? l / 2 : l), at.default.contains(["sw", "se", "s"], i) && n && (e.top += (e.height - t.minheight) / 2), e.height = t.minheight), t.maxwidth && e.width > t.maxwidth && ((at.default.contains(["nw", "sw", "w"], i) || s) && (l = t.maxwidth - e.width, e.left -= n || s ? l / 2 : l), at.default.contains(["ne", "se", "e"], i) && n && (e.left -= (t.maxwidth - e.width) / 2), e.width = t.maxwidth), t.maxheight && e.height > t.maxheight && ((at.default.contains(["nw", "ne", "n"], i) || a) && (l = t.maxheight - e.height, e.top -= n || a ? l / 2 : l), at.default.contains(["sw", "se", "s"], i) && n && (e.top -= (t.maxheight - e.height) / 2), e.height = t.maxheight), t.isProportional && (e = Ks.makeProportional(e, t)), o && at.default.isFunction(o) && (e = o(e, t.currentResizePoint)), t.constraints && (e.left < t.constraints.left && (e.width += e.left - t.constraints.left, e.left = t.constraints.left), e.top < t.constraints.top && (e.height += e.top - t.constraints.top, e.top = t.constraints.top), e.left + e.width > t.constraints.left + t.constraints.width && (e.width = t.constraints.left + t.constraints.width - e.left), e.top + e.height > t.constraints.top + t.constraints.height && (e.height = t.constraints.top + t.constraints.height - e.top)), t.packBox) {
                let c = Math.min(t.packBox.width, e.width),
                    d = Math.min(t.packBox.height, e.height);
                e = {
                    width: c,
                    height: d,
                    top: Math.min(t.packBox.top + t.packBox.height - d, Math.max(e.top, t.packBox.top)),
                    left: Math.min(t.packBox.left + t.packBox.width - c, Math.max(e.left, t.packBox.left))
                }
            }
            return !this.isStandaloneMode && this.block.workspace.spacesController && !t.isSizes && (e = this.block.workspace.spacesController.recalcBoxOnResize(e, t, this.block.model)), e
        },
        makeProportional: function(e, t) {
            let o = t.initialBox || {},
                i = t.direction,
                n = t.fromCenter,
                s, a;
            switch (i) {
                case "n":
                case "s":
                    s = "height", a = "width";
                    break;
                case "e":
                case "w":
                    s = "width", a = "height";
                    break;
                default:
                    e.width / o.width > e.height / o.height ? (s = "width", a = "height") : (s = "height", a = "width");
                    break
            }
            t.baseDimension && (s = t.baseDimension, a = t.baseDimension === "width" ? "height" : "width");
            let l = o[a] / o[s];
            t.ratio && (l = a == "width" ? t.ratio : 1 / t.ratio), t.aspect && (l = a == "width" ? t.aspect : 1 / t.aspect);
            let c = Math.round(e[s] * l);
            if (at.default.contains(["nw", "sw", "w"], i) && a == "width") {
                var d = c - e[a];
                e.left -= n ? d / 2 : d
            }
            return at.default.contains(["ne", "se", "e"], i) && a == "width" && n && (e.left -= (c - e[a]) / 2), at.default.contains(["nw", "ne", "n"], i) && a == "height" && (d = c - e[a], e.top -= n ? d / 2 : d), at.default.contains(["sw", "se", "s"], i) && a == "height" && n && (e.top -= (c - e[a]) / 2), at.default.contains(["n", "s"], i) && n && (d = c - e[a], e.left -= d / 2), at.default.contains(["w", "e"], i) && n && (d = c - e[a], e.top -= d / 2), e[a] = c, e
        },
        getRotatedBoxDelta: function(e, t, o, i) {
            let n = Ks.prototype.DOTS_POS_X,
                s = Ks.prototype.DOTS_POS_Y,
                a = Ks.prototype.FIXED_DOTS,
                l = Ks.prototype.DOTS,
                c = Math.sin((o || 0) * Math.PI / 180),
                d = Math.cos((o || 0) * Math.PI / 180),
                p = at.default.indexOf(l, a[i]),
                h = e.left + e.width * n[p],
                u = e.top + e.height * s[p],
                m = e.left + e.width / 2,
                f = e.top + e.height / 2,
                g = h - m,
                y = f - u,
                S = m + d * g + c * y,
                w = f + c * g - d * y,
                v = t.left + t.width * n[p],
                C = t.top + t.height * s[p],
                I = t.left + t.width / 2,
                T = t.top + t.height / 2,
                P = v - I,
                M = T - C,
                F = I + d * P + c * M,
                R = T + c * P - d * M;
            return {
                left: S - F,
                top: w - R
            }
        },
        ceilObject(e) {
            for (let t in e) e.hasOwnProperty(t) && (e[t] = Math.ceil(e[t]));
            return e
        }
    }), $t = Ks
});
var nP = k(() => {});

function fN(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "numeric-input.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var lg, sw, lN, cN, dN, pN, uN, hN, mN, gN, Es, dd = k(() => {
    "use strict";
    lg = E(Ze()), sw = E(ze());
    Oc();
    Wt();
    nP();
    lN = {
        model: {
            event: "change"
        },
        props: {
            value: Number,
            autofocus: {
                type: Boolean,
                default: !1
            },
            autosize: {
                type: Boolean,
                default: !1
            },
            wait: {
                type: Number,
                default: null
            },
            min: {
                type: Number,
                default: Number.NEGATIVE_INFINITY
            },
            max: {
                type: Number,
                default: Number.POSITIVE_INFINITY
            },
            dir: {
                type: String,
                default: "v"
            },
            speed: {
                type: Number,
                default: 3
            },
            step: {
                type: Number,
                default: 1
            },
            labelSelector: {
                type: String,
                default: ""
            },
            shiftStep: {
                type: Number,
                default: 10
            },
            useFloat: {
                type: Boolean,
                default: !1
            },
            mouseOnly: {
                type: Boolean,
                default: !1
            },
            mouseUse: {
                type: Boolean,
                default: !0
            },
            readonly: {
                type: Boolean,
                default: !1
            },
            disabled: {
                type: Boolean,
                default: !1
            },
            thousandDelimiter: {
                type: String,
                default: ""
            },
            debounceKeyboard: {
                type: Number,
                default: void 0
            },
            getLabel: {
                type: Function
            }
        },
        computed: {
            computedValue: {
                get: function() {
                    let e;
                    return this.$$el ? e = this.$$el.data("formatValue")(this.value) : e = this.value, e
                }
            }
        },
        watch: {
            mouseUse: function() {
                Qn.nextTick(() => {
                    let e = this.$$el.data("destroy");
                    sw.default.isFunction(e) && e(), (0, lg.default)(this.$$el).RMNumericInput({
                        onChange: this.onChange,
                        labelSelector: this.labelSelector,
                        useFloat: this.useFloat
                    })
                })
            },
            min: function(e) {
                this.$$el.data("changeMinMax")(e)
            },
            max: function(e) {
                this.$$el.data("changeMinMax")(void 0, e)
            },
            step(e) {
                this.$$el.data("changeStep")(e)
            },
            value(e, t) {
                e !== t && this.autosize && this.$nextTick().then(this.updateSize.throttled)
            }
        },
        created() {
            this.updateSize.throttled = sw.default.throttle(this.updateSize, 100)
        },
        mounted: function() {
            this.$$el = (0, lg.default)(this.$el), this.autosize && this.updateSize();
            let e = function() {
                (0, lg.default)(this.$$el).RMNumericInput({
                    onChange: this.onChange,
                    labelSelector: this.labelSelector,
                    useFloat: this.useFloat,
                    getLabel: this.getLabel
                }), this.$$el.data("formatValue")(this.value)
            }.bind(this);
            this.autosize && this.$nextTick().then(this.updateSize), this.wait ? be.waitForTransitionEnd(this.$$el, this.wait, "opacity", function() {
                e()
            }.bind(this)) : e()
        },
        methods: {
            onChange: function(e, t) {
                this.disabled || this.$emit("change", t)
            },
            updateSize: function() {
                be.setInputSize(this.$$el, 150, this.$$el.val())
            }
        }
    }, cN = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("input", {
            staticClass: "param-input",
            attrs: {
                type: "text",
                spellcheck: "false",
                "data-useFloat": e.useFloat,
                "data-step": e.step,
                "data-min": e.min,
                "data-max": e.max,
                "data-mouseDir": e.dir,
                "data-mouseSpeed": e.speed,
                "data-shiftStep": e.shiftStep,
                "data-autofocus": e.autofocus,
                "data-autoSize": e.autosize,
                wait: e.wait,
                "data-mouseOnly": e.mouseOnly,
                readonly: e.readonly || e.mouseOnly,
                disabled: e.disabled,
                "data-mouseUse": e.mouseUse + "",
                "data-thousandDelimiter": e.thousandDelimiter,
                "data-debounceKeyboard": e.debounceKeyboard
            },
            domProps: {
                value: e.computedValue
            }
        })
    }, dN = [], pN = void 0, uN = void 0, hN = void 0, mN = !1;
    gN = fN({
        render: cN,
        staticRenderFns: dN
    }, pN, lN, uN, mN, hN, !1, void 0, void 0, void 0), Es = gN
});
var rP = k(() => {});

function CN(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "sizes.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var sP, bN, yN, vN, wN, xN, _N, SN, kN, aP, lP = k(() => {
    "use strict";
    sP = E(ze());
    On();
    dd();
    lj();
    Wo();
    rP();
    bN = {
        components: {
            NumericInput: Es
        },
        props: {
            block: Object,
            frame: Object,
            zoom: Number
        },
        data: function() {
            return {
                minwidth: this.frame.minwidth,
                maxwidth: this.frame.maxwidth,
                minheight: this.frame.minheight,
                maxheight: this.frame.maxheight,
                scaleRatio: this.getScaleRatio()
            }
        },
        computed: {
            w: function() {
                return parseInt(this.block.latestPosSizeAngle.width)
            },
            h: function() {
                return parseInt(this.block.latestPosSizeAngle.height)
            },
            x: function() {
                return parseInt(this.block.latestPosSizeAngle.left)
            },
            y: function() {
                return parseInt(this.block.latestPosSizeAngle.top)
            },
            angle: function() {
                return this.block.latestPosSizeAngle.angle
            },
            sin: function() {
                return this.block.latestPosSizeAngle.sinAngle
            },
            cos: function() {
                return this.block.latestPosSizeAngle.cosAngle
            },
            fixed_position: function() {
                return this.block.model.get("fixed_position")
            },
            is_visible: function() {
                return !this.block.forbidVisualRotation && this.block.workspace.mag.edit_params.get("sizes")
            },
            is_width_disabled: function() {
                return !this.frame.canChangeDimension("width")
            },
            is_height_disabled: function() {
                return !this.frame.canChangeDimension("height")
            },
            isScaleLayout: function() {
                let e = this.block.workspace.viewport === "default";
                return bv.isScaleLayout(this.block.workspace.mag.get("opts")) && e
            }
        },
        watch: {
            angle: "applyPosition",
            x: "applyPosition",
            y: "applyPosition",
            w: "applyPosition",
            h: "applyPosition",
            fixed_position: "applyPosition",
            is_visible: function(e) {
                e && sP.default.delay(function() {
                    this.$refs.widthInput.updateSize(), this.$refs.heightInput.updateSize()
                }.bind(this))
            }
        },
        mounted: function() {
            let e = t => this.$children.find(o => o.$el.classList.contains(t));
            this.$w = e("width"), this.$h = e("height"), this.applyPosition(), window.addEventListener("resize", this.onWindowResize)
        },
        destroyed: function() {
            window.removeEventListener("resize", this.onWindowResize)
        },
        methods: {
            resize: function(e, t) {
                let o = e === "width",
                    i = o ? t : parseInt(this.$w.$el.value),
                    n = o ? parseInt(this.$h.$el.value) : t,
                    s = o ? "e" : "s",
                    a = "se";
                this.$emit("beforeChange");
                let l = this.frame.applyConstraints({
                    left: this.angle ? this.block.latestPosSizeAngle.left : this.block.model.attributes.x,
                    top: this.angle ? this.block.latestPosSizeAngle.top : this.block.model.attributes.y,
                    width: i,
                    height: n
                }, {
                    direction: s,
                    isSidePointProportional: !1,
                    isSizes: !0
                });
                if (this.angle) {
                    let d = $t.getRotatedBoxDelta({
                        left: this.block.latestPosSizeAngle.left,
                        top: this.block.latestPosSizeAngle.top,
                        width: this.block.latestPosSizeAngle.width,
                        height: this.block.latestPosSizeAngle.height
                    }, l, this.angle, s);
                    l.left += d.left, l.top += d.top
                }
                l.width = Math.round(l.width), l.height = Math.round(l.height), this.minwidth = o && i < l.width ? l.width : this.frame.minwidth, this.maxwidth = o && i > l.width ? l.width : this.frame.maxwidth, this.minheight = !o && n < l.height ? l.height : this.frame.minheight, this.maxheight = !o && n > l.height ? l.height : this.frame.maxheight, (o && l.width !== this.w || !o && l.height !== this.h) && this.$emit("change", l, a), this.$emit("afterChange")
            },
            getScaleRatio: function() {
                return Math.round(bv.getLimitedRatio(this.block.workspace.mag.getViewportWidth(this.block.workspace.viewport), this.block.workspace.mag.get("opts").scalewidth, Oe.dictionary.default.min_scale_width, !1) * 100)
            },
            onWindowResize: function() {
                this.scaleRatio = this.getScaleRatio()
            },
            applyPosition: function() {
                let e = 8,
                    t = this.h + e,
                    o = this.w + e,
                    i = this.w / 2,
                    n = this.h / 2,
                    s, a, l = e * (this.zoom - 1);
                o -= i, t -= n;
                let c = o * this.cos - t * this.sin,
                    d = o * this.sin + t * this.cos;
                o = c + i, t = d + n, this.$el.style.left = Math.round(o * this.zoom) + "px", this.$el.style.top = Math.round(t * this.zoom) + "px";
                let p = this.$el.getBoundingClientRect(),
                    h = this.angle >= 0 ? this.angle : 360 + this.angle;
                s = 0, a = 0, h > 0 && h <= 90 ? s = h / 90 * -p.width : h > 90 && h <= 180 ? (s = -p.width, a = (h - 90) / 90 * -p.height) : h > 180 && h <= 270 ? (s = (270 - h) / 90 * -p.width, a = -p.height) : h > 270 && h <= 360 && (a = (360 - h) / 90 * -p.height), this.$el.style.transform = "translateX(" + (s - l) + "px) translateY(" + (a - l) + "px)", p = this.$el.getBoundingClientRect();
                let u = this.block.workspace.$container.width() - this.block.workspace.$container[0].clientWidth,
                    m = window.innerWidth - u,
                    f = window.innerHeight;
                p.left < e ? s = s - p.left + e : p.left + p.width + e > m && (s = s + (m - p.left - p.width - e)), p.top < e ? a = a - p.top + e : p.top + p.height + e > f && (a = a + (f - p.top - p.height - e)), this.$el.style.transform = "translateX(" + (s - l) + "px) translateY(" + (a - l) + "px)"
            }
        }
    }, yN = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.is_visible,
                expression: "is_visible"
            }],
            staticClass: "size-tool skip-rotate",
            attrs: {
                "data-testid": "size-panel"
            },
            on: {
                click: function(i) {
                    return i.stopPropagation()
                },
                dblclick: function(i) {
                    return i.stopPropagation()
                }
            }
        }, [o("numeric-input", {
            ref: "widthInput",
            staticClass: "input width",
            attrs: {
                value: e.w,
                autosize: !0,
                disabled: e.is_width_disabled,
                "mouse-use": !e.is_width_disabled,
                "debounce-keyboard": 500,
                min: e.minwidth,
                max: e.maxwidth,
                "data-testid": "size-panel-width"
            },
            on: {
                change: function(i) {
                    return e.resize("width", i)
                }
            }
        }), e._v(" "), o("span", [e._v("\xD7")]), e._v(" "), o("numeric-input", {
            ref: "heightInput",
            staticClass: "input height",
            attrs: {
                value: e.h,
                autosize: !0,
                disabled: e.is_height_disabled,
                "mouse-use": !e.is_height_disabled,
                "debounce-keyboard": 500,
                min: e.minheight,
                max: e.maxheight,
                "data-testid": "size-panel-height"
            },
            on: {
                change: function(i) {
                    return e.resize("height", i)
                }
            }
        }), e._v(" "), e.isScaleLayout ? o("span", {
            staticClass: "scale-ratio"
        }, [e._v("*" + e._s(e.scaleRatio) + "%")]) : e._e()], 1)
    }, vN = [], wN = void 0, xN = void 0, _N = void 0, SN = !1;
    kN = CN({
        render: yN,
        staticRenderFns: vN
    }, wN, bN, xN, SN, _N, !1, void 0, void 0, void 0), aP = kN
});
var cP, $i, dP, jo, Bh = k(() => {
    "use strict";
    cP = E(To()), $i = E(ze());
    Wo();
    dP = $i.default.extend({}, cP.default.Events, {
        initialize: function(e) {
            return this.undoStacks = {}, this.redoStacks = {}, this.pendingTransactions = {}, this.syncManager = e, this
        },
        add: function(e, t) {
            if (t = t || {}, $i.default.defaults(t, {
                    redo: !1,
                    undo: !1
                }), !t.page) {
                let n = $i.default.groupBy(e, function(s) {
                    return s.model.getPageId()
                });
                if ($i.default.keys(n).length > 1) {
                    $i.default.each(n, function(s) {
                        this.add(s, t)
                    }, this);
                    return
                }
            }
            if (t.replace) return;
            let o = t.page || e[0].model.getPageId();
            if (!o) return console.error("cannot save history without pageId", e);
            this.redoStacks[o] = this.redoStacks[o] || [], this.undoStacks[o] = this.undoStacks[o] || [];
            let i = {
                widgetsOrder: RM.constructorRouter.indexController.snapshot(o),
                actions: e
            };
            t.undo ? this.redoStacks[o].push(i) : (this.undoStacks[o].push(i), t.redo || (this.redoStacks[o] = [])), this.triggerChange(o)
        },
        undo: function(e) {
            if (!e) return console.error("cannot undo without pageId parameter");
            if ($i.default.isEmpty(this.undoStacks[e])) return this.triggerChange(e);
            let t = this.undoStacks[e].pop(),
                o = t.actions,
                i = {
                    undo: !0,
                    page: e,
                    applySnapshot: () => {
                        RM.constructorRouter.indexController.applySnapshot(t.widgetsOrder, e)
                    }
                };
            this.fillUndoKeys(o), this.syncManager.saveGroup($i.default.pluck(o, "attrs"), i), this.triggerUndo(e)
        },
        redo: function(e) {
            if (!e) return console.error("cannot redo without pageId parameter");
            if ($i.default.isEmpty(this.redoStacks[e])) return this.triggerChange(e);
            let t = this.redoStacks[e].pop(),
                o = t.actions,
                i = {
                    redo: !0,
                    page: e,
                    applySnapshot: () => {
                        RM.constructorRouter.indexController.applySnapshot(t.widgetsOrder, e)
                    }
                };
            this.fillUndoKeys(o), this.syncManager.saveGroup($i.default.pluck(o, "attrs"), i), this.triggerRedo(e)
        },
        fillUndoKeys: function(e) {
            $i.default.each(e, function(t) {
                var o = t.model.toJSON();
                if ($i.default.each(t.model.nonUndoKeys, function(i) {
                        if (t.attrs[i] = o[i], t.model.name == "Widget") {
                            let n = Oe.widgetViewportFields(t.model.get("type"));
                            $i.default.each(Oe.viewport_list, function(s) {
                                !o[s] || n.indexOf(i) == -1 || (t.attrs[s] = t.attrs[s] || {}, t.attrs[s][i] = o[s][i])
                            })
                        }
                    }), !$i.default.isEmpty(t.model.undoKeys)) {
                    var o = t.model.toJSON();
                    o = $i.default.extend(o, t.attrs), t.attrs = o
                }
            })
        },
        clearHistory: function(e) {
            this.redoStacks[e] = [], this.undoStacks[e] = [], this.triggerChange(e)
        },
        triggerChange: function(e) {
            this.trigger("change", this.getLength(e))
        },
        triggerUndo: function(e) {
            this.trigger("undo", e)
        },
        triggerRedo: function(e) {
            this.trigger("redo", e)
        },
        getLength: function(e) {
            return {
                undo: (this.undoStacks[e] || []).length,
                redo: (this.redoStacks[e] || []).length,
                page: e
            }
        },
        setCustomHandlers: function(e) {
            if (this.saved) return;
            let t = RM.constructorRouter.workspace.page.id;
            return this.saved = {
                undo: this.undo,
                redo: this.redo,
                getLength: this.getLength
            }, this.undo = e.undo, this.redo = e.redo, this.getLength = e.getLength, this.triggerChange(t), {
                triggerChange: $i.default.bind(this.triggerChange, this),
                triggerUndo: $i.default.bind(this.triggerUndo, this),
                triggerRedo: $i.default.bind(this.triggerRedo, this)
            }
        },
        removeCustomHandlers: function() {
            if (!this.saved) return;
            $i.default.extend(this, this.saved), this.saved = void 0;
            let e = RM.constructorRouter.workspace.page.id;
            this.triggerChange(e)
        },
        setEmptyHandlers: function() {
            this.setCustomHandlers({
                undo: function() {},
                redo: function() {},
                getLength: function(e) {
                    return {
                        undo: 0,
                        redo: 0,
                        page: e
                    }
                }
            })
        }
    });
    RM.HistoryModel = dP;
    jo = dP
});
var mre, fre, gre, pP, uP = k(() => {
    "use strict";
    Xd();
    mre = e => Gt.get(`/api/mag/${e}/trash`), fre = (e, t) => Gt.patch(`/api/mag/${e}/pages/trash`, {
        pids: t
    }), gre = (e, t) => Gt.delete(`/api/mag/${e}/pages/trash`, {
        pids: t
    }), pP = async (e, t, o) => Gt.get(`/api/screenshot/renew/${e}/${t}?viewport=${o}`).then(({
        screenshot: i
    }) => i).catch(i => console.error("Error renewing screenshot: ", i))
});
var Mh, IN, PN, TN, hP, BN, Rh, aw = k(() => {
    "use strict";
    Mh = [], IN = e => {
        let t = [];
        if (!e) return t;
        let o = e.getAttribute("aria-label"),
            i = e.getAttribute("data-id");
        o && t.push(i ? `${o} ${i}` : o);
        let n = a => a.parentElement ? .closest("[aria-label]"),
            s = n(e);
        for (; s;) {
            let a = s.getAttribute("aria-label"),
                l = s.getAttribute("data-id");
            a && t.push(l ? `${a} ${l}` : a), s = n(s)
        }
        return t.reverse()
    }, PN = e => {
        try {
            let t = e.target,
                o = IN(t);
            t ? .nodeName === "BUTTON" && t.innerText && o.push(t.innerText), o.length && hP({
                action: "Click",
                path: o.join(" > ")
            })
        } catch {}
    }, TN = e => {
        hP({
            action: e,
            path: ""
        })
    }, hP = e => {
        Mh.push(e), Mh.length > 100 && Mh.splice(0, Mh.length - 100)
    }, BN = {
        onClick: PN,
        onAction: TN,
        toString: () => Mh.map(({
            action: e,
            path: t
        }) => t ? `${e} on ${t}` : e).join(", ")
    }, Rh = BN
});
var mP, Lp, MN, Eh, cg, RN, EN, FN, DN, AN, sr, pd = k(() => {
    "use strict";
    mP = E(ze());
    Wt();
    TH();
    aw();
    Lp = (n => (n.setInMismatchedViewport = "setInMismatchedViewport", n.rootOnlyFieldsInViewport = "rootOnlyFieldsInViewport", n.widgetIsBothFixedAndSticked = "widgetIsBothFixedAndSticked", n.pictureWidgetHasDifferentImagesOnViewports = "pictureWidgetHasDifferentImagesOnViewports", n))(Lp || {}), MN = {
        setInMismatchedViewport: "Set in mismatched viewport",
        rootOnlyFieldsInViewport: "Root-only fields in viewport",
        widgetIsBothFixedAndSticked: "Widget is both fixed and sticked",
        pictureWidgetHasDifferentImagesOnViewports: "Picture widget has different picture urls on the viewports"
    }, Eh = {}, cg = [], RN = e => {
        Object.assign(Eh, e)
    }, EN = e => {
        let t = cg.filter(n => n.type === e);
        if (t.length === 0) return;
        let o = t[0];
        if (!o) return;
        let i = t.reduce((n, s) => {
            let a = s.payload ? JSON.stringify(s.payload) : s.payload;
            return { ...n,
                "widget.ids": n["widget.ids"] ? n["widget.ids"] + "," + s.id : s.id,
                "widget.pid": n["widget.pid"] === s.pid ? s.pid : "mixed",
                "widget.type": n["widget.type"] === s.widgetType ? s.widgetType : "mixed",
                "widget.is_global": n["widget.is_global"] === s.is_global ? s.is_global : "mixed",
                "widget.count": n["widget.count"] + 1,
                "widget.payload": n["widget.payload"] === a ? a : "mixed"
            }
        }, {
            name: MN[e],
            service_name: "frontend",
            "project.num_id": Eh.projectNumId,
            "page.num_id": Eh.pageNumId,
            viewport: Eh.viewport,
            "widget.ids": "",
            "widget.pid": o.pid,
            "widget.type": o.widgetType,
            "widget.is_global": o.is_global,
            "widget.count": 0,
            "widget.payload": o.payload ? JSON.stringify(o.payload) : void 0,
            "trace.trace_id": Eh.sessionId,
            "trace.span_id": be.generateUUID(),
            breadcrumbs: Rh.toString()
        });
        cg = cg.filter(n => n.type !== e), BI("frontend-anomalies", i)
    }, FN = Object.values(Lp).reduce((e, t) => (e[t] = mP.default.debounce(EN.bind(null, t), 300), e), {}), DN = ({
        type: e,
        widget: t,
        payload: o
    }) => {
        let i = {
            type: e,
            id: t._id,
            pid: t.pid,
            widgetType: t.type,
            is_global: !!t.is_global,
            payload: o
        };
        cg.push(i), FN[e] ? .()
    }, AN = {
        setContext: RN,
        sendEvent: DN
    }, sr = AN
});
var ud, lw, Kt, LN, Fh, Are, Lre, hg, fP = k(() => {
    "use strict";
    ud = E(Ze()), lw = E(To()), Kt = E(ze());
    Zr();
    Or();
    rg();
    ug();
    Wo();
    bh();
    Bh();
    pg();
    qt();
    uP();
    pd();
    dk();
    LN = Xt.extend({
        sync: function() {
            return {
                error: ud.default.noop,
                success: ud.default.noop
            }
        },
        idAttribute: "_id",
        skipMagChanging: !0,
        fakeSave: !0,
        isNew: function() {
            return !1
        },
        getPageId: function() {
            return this.page.id
        },
        parse: function(e) {
            return e.page && (this.page = e.page, delete e.page), e
        }
    }), Fh = Xt.extend({
        idAttribute: "_id",
        urlRoot: "/api/page/",
        undoKeys: ["wids", "order"],
        mergeUndoSteps: !1,
        name: "Page",
        whenScreenshotReady: {
            default: Promise.resolve(),
            phone_portrait: Promise.resolve(),
            tablet_portrait: Promise.resolve()
        },
        brokenScreenshotRenewRequested: !1,
        defaults: {
            master: "default"
        },
        initialize: function() {
            Kt.default.bindAll(this), this.loaded = !0, this._saveQueue = [], this._saveInProgress = !1, this.trigger("loaded"), this.on("change:wids", this.onChange), this.widgets = this.widgets || new dg([], {
                page: this
            }), this.widgets.on("change", this.setEdited, this), this.on("change:wids", this.setEdited, this), this.viewportStub = new LN({
                viewport: "default",
                page: this,
                _id: this.id + "_viewport"
            }, {
                parse: !0
            }), this.viewportStub.tracked = this.tracked, this.viewportStub.on("change:viewport", function(e, t, o) {
                !o || !o.undo && !o.redo || ((!this.get("viewport_" + t) || !this.get("viewport_" + t).enabled) && this.save("viewport_" + t, {
                    enabled: !0
                }, {
                    patch: !0
                }), this.workspace.setViewport(t, o))
            }, this), this.on("change:viewport", function(e, t, o) {
                o && (o.undo || o.redo) || this.viewportStub.save({
                    viewport: this.get("viewport")
                })
            }, this), bt.trigger("ready:model", this.viewportStub), bt.trigger("ready:model", this)
        },
        sync: function(e, t, o) {
            o = o || {};
            let i = o.success;
            return o.success = function(n) {
                t.changed.wids && (n.wids = Kt.default.union(t.get("wids"), n.wids)), i && i.apply(this, arguments)
            }, cd.prototype.sync.apply(this, arguments)
        },
        set(e, t) {
            let o = Xt.prototype.set.apply(this, arguments);
            if (t ? .socketUpdate && "order" in this.changed) {
                let {
                    order: i,
                    ...n
                } = this.changed;
                this.changed = n
            }
            return o
        },
        save: function(e, t, o) {
            let i;
            if (e == null || typeof e == "object" ? (i = e, o = t) : (i = {})[e] = t, i == null || typeof i == "object" && Kt.default.isEmpty(i) || !o ? .patch) throw "Please save specific page attributes and set patch option to true. Overwriting an entire page is not allowed.";
            let s;
            if (this._saveInProgress) {
                this.set(i, o);
                let a = {
                    attrs: i,
                    options: o,
                    fakeXhr: {
                        abort: () => {
                            let l = this._saveQueue.indexOf(a);
                            l !== -1 && this._saveQueue.splice(l, 1)
                        }
                    }
                };
                return this._saveQueue.push(a), a.fakeXhr
            } else {
                this._saveInProgress = !0;
                try {
                    s = Xt.prototype.save.call(this, i, o)
                } catch {}
                let a = () => {
                    if (this._saveInProgress = !1, this._saveQueue.length) {
                        let l = this._saveQueue.shift(),
                            c = this.save(l.attrs, l.options);
                        l.fakeXhr.abort = () => c.abort()
                    }
                };
                s ? s.always(() => {
                    a()
                }) : a()
            }
            return s
        },
        parse: function(e, t) {
            t && (t.undo || t.redo) && (e.num = this.get("num"));
            let o = Kt.default.clone(e),
                i = o.widgets || o.wids || [];
            return t = t || {}, i = this.sanitizeWidgets(i), Kt.default.isEmpty(i) || (sr.setContext({
                pageNumId: e.num_id,
                viewport: this.getCurrentViewport()
            }), this.widgets = this.widgets || new dg([], {
                page: this
            }), this.widgets.reset(i, {
                page: this,
                parse: t.parse
            }), o.wids = Kt.default.pluck(i, "_id"), this.checkEmpty()), delete o.widgets, Xt.prototype.parse.call(this, o, t)
        },
        triggerSocketUpdate(e, t) {
            let o = t ? .patch ? Kt.default.extend({}, t.attrs, this.pick("_id")) : Kt.default.isEmpty(e) ? this.toJSON() : e;
            RM.constructorRouter.trigger("update_from_server", "Page", o, this.getViewport())
        },
        setEdited: function() {
            this.isEmptyPage = !1
        },
        checkEmpty: function() {
            return this.widgets.length > 1 || !this.widgets.length || this.widgets.at(0).get("type") !== "background" ? !1 : this.widgets.at(0).get("color") === "ffffff" && this.widgets.at(0).get("selectedType") === void 0 ? (this.isEmptyPage = !0, !0) : !1
        },
        toJSON: function() {
            let e = Xt.prototype.toJSON.apply(this, arguments);
            return delete e.viewport, e
        },
        addWidget: function(e, t) {
            t = t || {};
            let o;
            if (e instanceof zp) o = e, this.widgets.add(o);
            else {
                if (!e || !e.type) {
                    console.error("Adding widget with no type");
                    return
                }
                if (!Ca[e.type]) {
                    console.error("Adding unknown widget");
                    return
                }
                if (e.pid = this.id, !t.disableHideWidgets) {
                    let i = this.getCurrentViewport();
                    i !== "default" && (e.hidden = !0), Kt.default.each(Oe.viewport_list, function(n) {
                        e[n] && n.indexOf(i) === -1 && i !== "default" && (e[n].hidden = !0)
                    })
                }
                if (e.type === "gmaps") {
                    let i = this.workspace && this.workspace.mag && this.workspace.mag.get("opts");
                    i && i.gmaps_key && (e.api_key = i.gmaps_key)
                }
                o = this.widgets.add(e, t)
            }
            if (t.socketUpdate) return this.onAdd(o, t), o;
            if (o.id) t.nosave ? this.getAddCallback(t)(o) : o.fetch({
                success: this.getAddCallback(t),
                error: t.error
            });
            else {
                o.created = !t.copy && !t.clone;
                let i = this.getCurrentViewport(),
                    n = i !== "default" ? `viewport_${i}` : void 0;
                i !== "default" && (o.initViewport(t), o[n].hidden = !1, o.attributes ? .[n] && (o.attributes[n].hidden = !!(e[n] ? .hidden && t.copy)), o[n].x = e.x !== void 0 ? e.x : o[n].x), o.save({}, {
                    success: this.getAddCallback(t),
                    error: t.error,
                    clone: t.clone
                })
            }
        },
        hasGlobalWidgets: function() {
            return this.widgets.some(e => e.isGlobal())
        },
        onAdd: function(e, t) {
            if (!e.get("type")) return !1;
            [!0, void 0].includes(t.updateIndex) && RM.constructorRouter.indexController.updateIndex(this, [e], !t.copy);
            let o, i = this;
            o = Kt.default.clone(this.get("wids")), o.push(e.id), o = (0, Kt.default)(o).chain().uniq().compact().value();
            let n;
            !t || !t.group && !t.nosave ? n = new Promise(function(c, d) {
                i.save({
                    wids: o
                }, {
                    success: c,
                    error: d,
                    patch: !0
                })
            }) : this.set({
                wids: o
            }, {
                copy: t.copy,
                silent: !!t.silent,
                isMultiple: t.isMultiple,
                invisible: t.invisible
            }), !t.silent && e.is_global && e.triggerGlobalAppear();
            let s = e.get("type"),
                a = ["text", "picture", "shape"],
                l = ["shots", "form", "iframe", "addtocart", "ecommercecart", "hotspot", "lottie"];
            return a.includes(s) || l.includes(s) && De(Fe.WidgetAdd, {
                widgetType: this.getAmplitudeWType(s)
            }), n
        },
        getAddCallback: function(e) {
            e = e || {};
            let t = this;
            return function(o) {
                let i = t.onAdd(o, e);
                i instanceof Promise ? (i.then(() => RM.constructorRouter.indexController.saveAffectedPages()), i.finally(() => {
                    e.success && e.success(o, e)
                })) : e.success && e.success(o, e)
            }
        },
        onChange: function(e, t, o) {
            if (o.skip) return;
            let i = e.changedAttributes().wids,
                n = e.previous("wids") || [];
            if (i) {
                let s = Kt.default.difference(i, n),
                    a = Kt.default.difference(n, i),
                    l = !1;
                Kt.default.each(s, function(c) {
                    let d = e.widgets.get(c);
                    o.is_new_global = d && d.isGlobal(), o.isMultiple = s.length > 1 || o.isMultiple, d && this.trigger("widget:create", d, o), d && d.isGlobal() && (d.get("pid") === this.id && Kt.default.defer(() => d.triggerGlobalAppear()), l = !0)
                }, this), Kt.default.each(a, function(c) {
                    let d = e.widgets.get(c);
                    d && this.trigger("widget:remove", d, o), d && d.isGlobal() && (d.get("pid") === this.id && Kt.default.defer(() => d.triggerGlobalDisappear()), l = !0)
                }.bind(this)), l && RM.constructorRouter.workspace.trigger("redraw", {
                    is_global: !0
                })
            }
        },
        duplicate: function(e, t) {
            let o = this,
                i = [];
            RM.constructorRouter.mag.globalWidgets.each(n => {
                i.push(n.get("_id"))
            }), ud.default.ajax({
                url: this.urlRoot + "duplicate/",
                type: "POST",
                dataType: "json",
                data: {
                    _id: this.get("_id"),
                    num: t && t.num ? t.num : parseInt(this.get("num"), 10) + 1,
                    mid: this.get("mid"),
                    globalWidgets: i
                },
                success: function(n) {
                    let s = n.page;
                    n.widgets && n.widgets.forEach(a => {
                        RM.constructorRouter.mag.globalWidgets.find({
                            _id: a._id
                        }) ? .set(a, {
                            normalized: !0
                        })
                    }), ud.default.get("/api/pageFullById/" + s._id, function(a) {
                        let l = new Fh(a, {
                            parse: !0
                        });
                        l.set("screenshot", o.get("screenshot")), ud.default.ajax({
                            method: "get",
                            url: "/api/packs/" + RM.constructorRouter.mag.get("_id"),
                            success: c => {
                                RM.constructorRouter.mag.set("packs", c), e && e(l)
                            },
                            error: () => {
                                e && e(l)
                            }
                        })
                    }.bind(this)).fail(function(a, l) {
                        alert(l.responseText), e(new Error("\u0421ould not get page data"))
                    })
                },
                error: function(n) {
                    try {
                        let s = JSON.parse(n.responseText);
                        e(new Error(`Server error: ${s&&s.err?s.err:"unknown"}`))
                    } catch {
                        e(new Error("Server error: could not parse it")), alert(n.responseText)
                    }
                },
                context: this
            })
        },
        getAmplitudeWType: e => {
            switch (e) {
                case "form":
                case "shots":
                case "lottie":
                case "video":
                    return e;
                case "addtocart":
                case "ecommercecart":
                    return "ecommerce";
                case "iframe":
                    return "code";
                case "hotspot":
                    return "hotspot";
                default:
                    return ""
            }
        },
        removeWidgets: function(e, t) {
            if (t = t || {}, Kt.default.isEmpty(e)) return;
            if ((t.viewport || this.getCurrentViewport()) !== "default" && !t.forceRemove) {
                this.trigger("toggleWidgets", {
                    wids: e,
                    hidden: !0
                });
                return
            }
            this.trigger("widgets:remove", e, t);
            let o = Kt.default.difference(this.get("wids"), e);
            t.nosave ? this.set({
                wids: o
            }, {
                silent: !!t.silent
            }) : this.save({
                wids: o
            }, {
                patch: !0
            })
        },
        validate: function(e) {
            if (Kt.default.isArray(e.tags) && (e.tags = Kt.default.uniq(e.tags)), e.uri) {
                if (/(^\-)|(\-$)/.test(e.uri)) return {
                    hyphen: !0
                };
                if (/^[0-9]+$/.test(e.uri)) return {
                    onlyNumbers: !0
                };
                if (e.uri.length > 128) return {
                    uriLength: !0
                };
                let t = this;
                if (this.collection && this.collection.any(function(o) {
                        if (o != t) return (o.get("uri") || "").toLowerCase() === e.uri.toLowerCase() && o.get("parentPage") === e.parentPage
                    })) return {
                    used: !0
                }
            }
        },
        groupSaveWids: function(e, t) {
            let o = Kt.default.pluck(e, "id"),
                i = Kt.default.clone(this.get("wids"));
            t = t || {}, this.set("wids", o, {
                silent: !0
            }), this.save({
                wids: i
            }, { ...t,
                patch: !0
            })
        },
        sanitizeWidgets: function(e) {
            return e.filter(o => !!Ca[o.type])
        },
        getPageId: function() {
            return this.id
        },
        renewScreenshot: function() {
            return delete this.specialScreenshot, this
        },
        saveHeight(e = {}) {
            let {
                height: t,
                type: o,
                viewport_phone_portrait: i,
                viewport_tablet_portrait: n
            } = this.attributes, s = this.workspace.viewport === "phone_portrait" ? {
                viewport_phone_portrait: i
            } : this.workspace.viewport === "tablet_portrait" ? {
                viewport_tablet_portrait: n
            } : {
                height: t,
                type: o
            };
            this.save(s, { ...e,
                patch: !0
            })
        },
        async updateScreenshots(e) {
            if (!e) return;
            let t = i => new Promise(n => {
                    ef(async () => {
                        n(await i())
                    })
                }),
                o = await Promise.all(Object.keys(Oe.dictionary).map(i => {
                    let n = this.get("viewport_" + i);
                    return i === "default" || n ? .enabled ? (this.whenScreenshotReady[i] = this.whenScreenshotReady[i].then(() => pP(e, this.id, i)).then(a => ({
                        viewport: i,
                        screenshot: a
                    })), this.whenScreenshotReady[i]) : {
                        viewport: i,
                        screenshot: void 0
                    }
                }));
            await Promise.all(o.map(({
                viewport: i,
                screenshot: n
            }) => {
                if (!n) return;
                let s = i === "default" ? {
                    screenshot: n
                } : {
                    [`viewport_${i}`]: { ...this.attributes[`viewport_${i}`] || {},
                        screenshot: n
                    }
                };
                return t(() => this.save(s, {
                    patch: !0,
                    skipMagChanging: !0,
                    skipHistory: !0
                }))
            }))
        },
        async updateBrokenScreenshot(e) {
            this.brokenScreenshotRenewRequested || (this.brokenScreenshotRenewRequested = !0, await this.updateScreenshots(e))
        },
        getViewportParam: function(e, t) {
            let o = this.get("viewport_" + e) || {};
            return typeof o[t] < "u" ? o[t] : this.get(t)
        },
        setViewportParam: function(e, t, o, i) {
            let n = Kt.default.clone(this.get("viewport_" + e) || {}),
                s = {};
            n[t] = o, e === "default" ? s[t] = o : s["viewport_" + e] = n, this.set(s, i || {}), this.trigger(`change:${e}:${t}`, o)
        },
        getViewport: function() {
            return this.getCurrentViewport()
        },
        getCurrentViewport: function() {
            return this.get("viewport") || "default"
        },
        getPreviousViewport: function() {
            return this.previous("viewport") || "default"
        },
        getUsedFonts: function(e) {
            e = e || {};
            let t = [];
            return Kt.default.each(this.widgets.models, function(o) {
                t.push(o)
            }), Ln.getUsedFontsFromWidgetsModels(Kt.default.extend(e, {
                models: t
            }), Ln.fontsShortList)
        },
        getOwnGlobalWidgets: function() {
            let e = RM.constructorRouter.indexController.getWidsOrder(this);
            return this.widgets.filter(function(t) {
                return t.isGlobal() && t.get("pid") === this.id && e.includes(t.get("_id"))
            }.bind(this))
        },
        hasChildren() {
            return RM.constructorRouter.mag.pages.some(e => e.get("parentPage") === this.attributes._id)
        },
        isChild() {
            return !!this.attributes.parentPage
        }
    }, {
        getViewportSetting: function(e, t) {
            return (Kt.default.findWhere(Oe.viewports, {
                name: t
            }) || {})[e]
        }
    }), Are = lw.default.Collection.extend({
        model: Fh,
        comparator: function(e) {
            return e.get("num")
        },
        fetchFullPage: function(e, t) {
            t = t || {}, !this.fetchingPageXHR && (this.fetchingPageXHR = ud.default.get("/api/pageFullById/" + e, Kt.default.bind(function(o) {
                let i = this.get(e);
                i || (i = new Fh(o, {
                    parse: !0
                }), RM.constructorRouter.mag.onAdd(i, t)), delete i.needUpdate, jo.clearHistory(i.get("_id")), i.widgets.set(o.wids, {
                    parse: !0,
                    resetPage: !0
                });
                let n = Kt.default.pluck(o.wids, "_id");
                i.set(Kt.default.extend({}, o, {
                    wids: n
                }), {
                    resetPage: !0
                }), t.success && t.success(), delete this.fetchingPageXHR
            }, this)).fail(Kt.default.bind(function() {
                delete this.fetchingPageXHR, alert("failed to load page, please, refresh the page"), t.success && t.success()
            }, this)))
        }
    }), Lre = lw.default.Collection.extend({
        model: Fh,
        name: "TrashPages",
        initialize() {
            this.on("add", this.onAdd.bind(this)), this.on("remove", this.onRemove.bind(this))
        },
        onAdd(e, t, o) {
            o ? .socketUpdate || RM.constructorRouter.trigger("update_from_server", "TrashPages", {
                added: e.id
            })
        },
        onRemove(e, t, o) {
            o ? .socketUpdate || RM.constructorRouter.trigger("update_from_server", "TrashPages", {
                removed: e.id
            })
        },
        triggerSocketEmptyTrash() {
            RM.constructorRouter.trigger("update_from_server", "TrashPages", {
                emptyTrash: !0
            })
        }
    }), hg = Fh
});

function Dh() {
    return gP[Math.floor(Math.random() * gP.length)]
}

function bP({
    lineHeight: e,
    width: t,
    fontStyle: o
}) {
    let i = window.innerHeight / 1.5,
        n = gh({
            text: "M",
            style: o
        });
    if (n ? .width) {
        let s = Math.floor(i / e),
            a = Math.floor(t / n.width),
            l = s * a,
            c = Dh();
        if (c.length > l) {
            let d = c.slice(0, l - 3).trim();
            return d[d.length - 1] === "." ? d : `${d}\u2026`
        } else return c
    }
}
var gP, cw = k(() => {
    "use strict";
    Yt();
    gP = ["\u201CBegin anywhere.\u201D\u2014Bruce Mau", "\u201CWhen creativity melds together with global issues, I believe you can bring the world together.\u201D\u2014Virgil Abloh", "\u201CTo design is to communicate clearly by whatever means you can control or master.\u201D\u2014Milton Glaser", "\u201CIt\u2019s important to know what your values are and to take care of them.\u201D\u2014Peter Saville", "\u201CComplaining is silly. Either act or forget.\u201D\u2014Stefan Sagmeister", "\u201CIndependent graphic design is often short-lived, whereas integrated graphic design is more permanent, both varying according to time and place.\u201D\u2014Pierre Bernard", "\u201CThe prerequisites for growth: the openness to experience events and the willingness to be changed by them.\u201D\u2014Bruce Mau", "\u201CThe printed surface transcends space and time. The printed surface, the infinity of books, must be transcended.\u201D\u2014EL Lissitzky", "\u201CCollaborations have no meaning if 1+1 does not equal much more than 2.\u201D\u2014Rei Kawakubo", "\u201CAll good design should have a sense of wit.\u201D\u2014Emily Oberman", "\u201CCommercial art tries to make you buy things. Graphic design gives you ideas.\u201D\u2014Chip Kidd", "\u201CDesign creates culture. Culture shapes values. Values determine the future.\u201D\u2014Robert L. Peters", "\u201CDesign is not what we make. Design is what we make possible.\u201D\u2014Brian Collins", "\u201CGood design is obvious. Great design is transparent.\u201D\u2014Joe Sparano", "\u201CDesign adds value faster than it adds costs.\u201D\u2014Joel Spolsky", "\u201CDesign is the intermediary between information and understanding.\u201D\u2014Hans Hofmann", "\u201CIt\u2019s through mistakes that you actually can grow. You have to get bad in order to get good.\u201D\u2014Paula Scher", "\u201CEngineers and designers simultaneously know too much and too little. They know too much about the technology and too little about how other people live their lives and do their activities.\u201D\u2014Donald Norman", "\u201CThe truth is that style and taste are all relative. It is not a question whether or not someone has good taste. It is how something feels to the individual.\u201D\u2014Kelly Hoppen", "\u201CThere are 360 degrees, so why stick to one?\u201D\u2014Zaha Hadid", "\u201CEffective, meaningful design requires intellectual, rational rigor along with the ability to elicit emotions and beliefs.\u201D\u2014Debbie Millman", "\u201CYou can have an art experience in front of a Rembrandt ... or in front of a piece of graphic design.\u201D\u2014Stefan Sagmeister", "\u201CGraphic design will save the world right after rock and roll does.\u201D\u2014David Carson", "\u201CGood design is all about making other designers feel like idiots because that idea wasn\u2019t theirs.\u201D\u2014Frank Chimero", "\u201CIf no one hates it, no one really loves it.\u201D\u2014Jessica Walsh", "\u201CGood design\u2019s not about what medium you\u2019re working in, it\u2019s about thinking hard about what you want to do and what you have to work with before you start.\u201D\u2014Susan Kare", "\u201CStyles come and go. Good design is a language, not a style.\u201D\u2014Massimo Vignelli", "\u201CI think time is a constraint to destroy and then reinvent. If you give me a constraint, I\u2019ll accept it. But I always try to move it around, or to readapt it.\u201D\u2014Patricia Urquiola", "\u201CSimplicity is not the absence of clutter, that\u2019s a consequence of simplicity.\u201D\u2014Jonathan Ive", "\u201CInformed clients are better clients, and they make for better design.\u201D\u2014Kelly Wearstler", "\u201CWe don\u2019t have to be artists or architects ourselves to get inspiration from those disciplines.\u201D\u2014Hella Jongerius", "\u201CMinimalism is about creating complete harmony and not about making simple.\u201D\u2014Naoto Fukasawa"]
});
var yP, vP, zN, mg, Ah, dw, $p = k(() => {
    "use strict";
    Tj();
    yP = E(gi()), vP = E(yv());
    Le();
    Yt();
    Sj();
    cw();
    Rj();
    Ej();
    B();
    zN = u0({
        styleToHTML: () => r("span", {}),
        blockToHTML: () => r("p", {}),
        entityToHTML: (e, t) => e.type === Dk ? r("br", {}) : t
    }), mg = e => {
        if (e.get("version") === 3) {
            let t = Gc(e.attributes),
                o = zN(t);
            if (o) {
                let i = document.createElement("span");
                return i.innerHTML = o, i.textContent || i.innerText
            }
        }
        return ""
    }, Ah = ({
        text: e,
        html: t
    } = {}) => {
        let o = t ? h0(t) : vP.ContentState.createFromText(e || Dh());
        return wr(o)
    }, dw = ({
        editorState: e,
        width: t,
        model: o
    }) => {
        let i = () => r(f0, {
                editorState: e
            }),
            n = document.createElement("div");
        n.style.position = "absolute", n.style.left = "-9999px", n.style.opacity = "0", n.style.visibility = "hidden", n.style.width = `${t}px`, An({
            component: i,
            model: o,
            domElement: n,
            onDestroy: () => {
                yP.default.unmountComponentAtNode(n), n && n.parentNode && n.parentNode.removeChild(n)
            }
        }), document.body.appendChild(n);
        let s = n.clientHeight;
        return document.body.removeChild(n), s
    }
});
var wP, xP = k(() => {
    "use strict";
    mk();
    Aj();
    Dj();
    wP = (e, t) => {
        let [, o] = y0(), [i, n] = b0(), s = a => {
            e.current && e.current.contentWindow ? .postMessage(JSON.stringify(a))
        };
        Cs("toggleEcommerceSidebar", function({
            visible: l
        }) {
            o(l)
        }, [t], e.current ? .contentDocument ? ? null), Cs("addToCart", function({
            key: l,
            item: c
        }) {
            n({ ...i,
                [l]: c
            })
        }, [t, i, n], e.current ? .contentDocument ? ? null), Cs("increaseCartQuantity", function({
            key: l
        }) {
            let c = i[l];
            c && n({ ...i,
                [l]: { ...c,
                    cartQuantity: c.cartQuantity + 1
                }
            })
        }, [t, i, n], e.current ? .contentDocument ? ? null), Cs("toggleEcommerceSidebar", function({
            visible: l
        }) {
            s({
                type: "toggleSidebar",
                visible: l
            })
        }, [t, s]), Cs("increaseCartQuantity", function({
            key: l
        }) {
            s({
                type: "increaseCartQuantity",
                key: l
            })
        }, [t, s]), Cs("decreaseCartQuantity", function({
            key: l
        }) {
            s({
                type: "decreaseCartQuantity",
                key: l
            })
        }, [t, s]), Cs("removeFromCart", function({
            key: l
        }) {
            s({
                type: "removeFromCart",
                key: l
            })
        }, [t, s])
    }
});

function mse({
    viewport: e,
    project: t,
    constructorProject: o,
    initialPageId: i,
    initialScrollTop: n,
    children: s
}) {
    let [a, l] = (0, Et.useState)(() => t), [c, d] = (0, Et.useState)(() => i), [p, h] = (0, Et.useState)(e), [u, m] = uw(), f = (0, Et.useRef)(n), g = (0, Et.useRef)(null), [y, S] = (0, Et.useState)(void 0), [w, v] = (0, Et.useState)(!1), [C, I] = (0, Et.useState)(!1), [, T] = (0, Et.useState)(!0), [P, M] = (0, Et.useState)(() => a ? fn(a, "default") : {}), [F, R] = (0, Et.useState)(() => a ? fn(a, "phone_portrait") : {}), [A, D] = (0, Et.useState)(() => a ? fn(a, "tablet_portrait") : {}), [O, L] = (0, Et.useState)(() => a ? fg(a, "phone_portrait") : {}), [W, z] = (0, Et.useState)(() => a ? fg(a, "tablet_portrait") : {}), V = a ? .pages.findIndex(J => J._id === c) ? ? -1, X = V !== -1 ? a ? .pages[V] : void 0, q = V === 0, ne = a ? V === a.pages.length - 1 : !1, re = q ? void 0 : a ? .pages[V - 1] ? ._id, te = ne ? void 0 : a ? .pages[V + 1] ? ._id, ee = J => {
        !w || !g.current || g.current.contentWindow ? .postMessage(JSON.stringify(J))
    }, j = J => {
        J && ee({
            type: "goToPage",
            pageId: J
        })
    }, se = (0, Et.useCallback)(() => {
        let J = X ? .num,
            le = f.current,
            ye = o.hasCodeInjection();
        window.RM.constructorRouter.togglePreview({
            pageNumber: J,
            scrollTop: le,
            reload: ye
        })
    }, [X ? .num]), oe = (0, Et.useCallback)(async (J, le = "default") => {
        let ye = pw.default.intersection(Object.keys(J), gv).length > 0,
            Ue = le === "phone_portrait" || le === "tablet_portrait",
            Te = a ? .num_id;
        if (Te)
            if (ye && Ue) {
                let Re = le === "tablet_portrait",
                    Tt = `viewport_${le}`,
                    Ee = Re ? { ...W,
                        ...J
                    } : { ...O,
                        ...J
                    },
                    Qe = { ...P,
                        ...Ee
                    },
                    _t = Re ? z : L,
                    Ge = Re ? D : R;
                _t(Ee), Ge(Qe), o ? .set(Tt, {
                    opts: Ee
                }), ee({
                    type: "setOption",
                    options: J
                }), await lp(Te, Ee, le)
            } else {
                let Re = { ...P,
                    ...J
                };
                M(Re), ee({
                    type: "setOption",
                    options: J
                }), o ? .set("opts", Re), await lp(Te, Re, le)
            }
    }, [ee, a, P, F, A, O, W, D, R, z, L, M]), U = (0, Et.useCallback)(J => {
        let le = `viewport_${J}`,
            ye = X ? .[le];
        return !!(J === "default" || ye ? .enabled)
    }, [X]), he = J => {
        window.sessionStorage.setItem("constructorViewport", J), h(J), u && dp[u] !== J && m(_f[J])
    }, xe = J => {
        g.current = J, S(zn()), v(!0)
    };
    Cs("afterPageChange", function({
        pageNumber: le,
        pageId: ye
    }) {
        if (!a || ye === c) return;
        let Ue = a.pages.find(Tt => Tt._id === ye),
            Te = le === 1 ? "" : Ue ? .pagePath ? ? le,
            Re = new URL(window.location.href);
        Re.pathname = `/edit/${a.num_id}/preview/${Te?Te+"/":""}`, window.history.replaceState(null, "", Re.toString()), d(ye)
    }, [a ? .num_id, y, C, c], g.current ? .contentDocument ? ? null), Cs("afterPageScroll", function({
        scrollTop: le
    }) {
        f.current = le
    }, [y, C], g.current ? .contentDocument ? ? null), Cs("pageBoxReady", function({
        pageId: le
    }) {
        le === i && n !== void 0 && ee({
            type: "scrollPage",
            scrollTop: n
        })
    }, [y, C], g.current ? .contentDocument ? ? null), wP(g, y), (0, Et.useEffect)(function() {
        let le = g.current ? .contentWindow;
        if (!le) return;
        let ye = () => {
            I(!0)
        };
        return le.addEventListener("load", ye), () => {
            le.removeEventListener("load", ye), I(!1)
        }
    }, [y]), (0, Et.useEffect)(function() {
        let le = u ? dp[u] : void 0;
        le && le !== p && h(le)
    }, [u, p, h]), (0, Et.useEffect)(() => {
        a && (M(fn(a, "default")), R(fn(a, "phone_portrait")), D(fn(a, "tablet_portrait")), L(fg(a, "phone_portrait")), z(fg(a, "tablet_portrait")))
    }, [a]);
    let pe = {
        project: a,
        constructorProject: o,
        page: X,
        desktopOptions: P,
        phoneOptions: F,
        tabletOptions: A,
        options: p === "tablet_portrait" ? A : p === "phone_portrait" ? F : P,
        viewport: p,
        currentPageId: c,
        isFirstPage: q,
        isLastPage: ne,
        goToNextPage: () => j(te),
        goToPreviousPage: () => j(re),
        switchToConstructor: se,
        setProject: l,
        setProjectOptions: oe,
        setViewport: he,
        setIframe: xe,
        toggleToolbarVisibility: T,
        isViewportEnabled: U,
        postViewerAction: ee,
        iframeElement: g.current
    };
    return fk("previewContext", {
        project: a,
        page: pe.page,
        desktopOptions: P,
        phoneOptions: F,
        tabletOptions: A,
        options: pe.options,
        viewport: p,
        currentPageId: c,
        isFirstPage: q,
        isLastPage: ne
    }), r(gg.Provider, {
        value: pe,
        children: s
    })
}

function _P({
    children: e,
    router: t,
    constructorMagModel: o
}) {
    let [i, n] = (0, Et.useState)(() => t.mag.viewport), [s, a] = (0, Et.useState)(() => fn(t.mag.model.attributes, "default")), [l, c] = (0, Et.useState)(() => fn(t.mag.model.attributes, "phone_portrait")), [d, p] = (0, Et.useState)(() => fn(t.mag.model.attributes, "tablet_portrait")), [h, u] = (0, Et.useState)(() => t.mag.currentPage ? ._id), m = o.pages.models.find(F => F.id === h), f = o.pages.models.findIndex(F => F.id === h) ? ? -1, g = m ? .get("num") ? ? 1, y = f === 0, S = f === o.pages.models.length - 1, w = y ? void 0 : o.pages.models[f - 1] ? .id, v = S ? void 0 : o.pages.models[f + 1] ? .id;
    (0, Et.useEffect)(() => {
        let F = async (z, V) => {
                let X = t.mag.model;
                o.set("opts", V), a(fn(X.attributes, "default")), c(fn(X.attributes, "phone_portrait")), p(fn(X.attributes, "tablet_portrait")), await lp(z.get("num_id"), V)
            },
            R = async (z, V) => {
                let X = Object.keys(z.changed)[0],
                    q = t.mag.model;
                o.set(X, V), X === "viewport_phone_portrait" ? (c(fn(q.attributes, "phone_portrait")), await lp(z.get("num_id"), V.opts, X === "viewport_phone_portrait" ? "phone_portrait" : "tablet_portrait")) : (p(fn(q.attributes, "tablet_portrait")), await lp(z.get("num_id"), V.opts, X === "viewport_phone_portrait" ? "phone_portrait" : "tablet_portrait"))
            },
            A = ({
                viewport: z
            }) => {
                n(z)
            },
            D = z => {
                u(z._id)
            },
            O = () => {
                let z = t.mag,
                    V = t.mag.model;
                V.on("change:opts", F), V.on("change:viewport_phone_portrait", R), V.on("change:viewport_tablet_portrait", R), z.on("change:viewport", A), z.on("destroyed", L), z.on("pageChanged", D)
            },
            L = () => {
                let z = t.mag,
                    V = t.mag.model;
                V.off("change:opts", F), V.off("change:viewport_phone_portrait", R), V.off("change:viewport_tablet_portrait", R), z.off("change:viewport", A), z.off("destroyed", L), z.off("pageChanged", D)
            },
            W = () => {
                let z = t.mag.model,
                    V = t.mag;
                O(), a(fn(z.attributes, "default")), c(fn(z.attributes, "phone_portrait")), p(fn(z.attributes, "tablet_portrait")), n(V.viewport)
            };
        return O(), bt.on("preview:mag:restart", W), () => {
            L(), bt.off("preview:mag:restart", W)
        }
    }, []);
    let C = (0, Et.useCallback)((F, R) => {
            let A = t.mag.model,
                D = pw.default.intersection(Object.keys(F), gv).length > 0,
                O = R === "phone_portrait" || R === "tablet_portrait";
            if (D && O) {
                let L = `viewport_${R}`,
                    W = { ...A.get(L) ? .opts || {},
                        ...F
                    };
                A.set(L, { ...A.get(L) || {},
                    opts: W
                })
            } else A.set("opts", { ...A.get("opts"),
                ...F
            })
        }, []),
        I = (0, Et.useCallback)(F => {
            t.mag.switchToViewport(F)
        }, []),
        T = (0, Et.useCallback)(F => t.mag.toggleToolbarVisibility(F), []),
        P = (0, Et.useCallback)(F => {
            let R = t.mag ? .currentPage ? .["viewport_" + F];
            return F === "default" || R ? .enabled
        }, [h]),
        M = (0, Et.useCallback)(() => {
            window.RM.constructorRouter.togglePreview({
                pageNumber: g
            })
        }, [g]);
    return r(gg.Provider, {
        value: {
            project: t.mag.model.attributes,
            constructorProject: o,
            page: m ? .attributes,
            desktopOptions: s,
            phoneOptions: l,
            tabletOptions: d,
            options: i === "tablet_portrait" ? d : i === "phone_portrait" ? l : s,
            viewport: i,
            currentPageId: h,
            isFirstPage: y,
            isLastPage: S,
            goToNextPage: () => {
                v && u(v)
            },
            goToPreviousPage: () => {
                w && u(w)
            },
            switchToConstructor: M,
            setProjectOptions: C,
            setProject: F => {},
            setViewport: I,
            setIframe: F => {},
            toggleToolbarVisibility: T,
            isViewportEnabled: P,
            postViewerAction: F => {},
            iframeElement: null
        },
        children: e
    })
}
var Et, pw, gg, fn, fg, SP = k(() => {
    "use strict";
    Et = E(N()), pw = E(hn());
    Ol();
    Ij();
    Wo();
    Or();
    bj();
    Lj();
    mk();
    bg();
    d0();
    xP();
    B();
    gg = (0, Et.createContext)({
        project: {},
        constructorProject: {},
        page: void 0,
        desktopOptions: {},
        phoneOptions: {},
        tabletOptions: {},
        options: {},
        viewport: "default",
        isFirstPage: !1,
        isLastPage: !1,
        goToNextPage: () => {},
        goToPreviousPage: () => {},
        switchToConstructor: () => {},
        setProjectOptions: () => {},
        setProject: e => {},
        setViewport: e => {},
        setIframe: e => {},
        toggleToolbarVisibility: () => {},
        isViewportEnabled: e => !1,
        postViewerAction: e => {},
        iframeElement: null
    }), fn = (e, t = "default") => {
        let o = t !== "default" ? `viewport_${t}` : void 0;
        return { ...e.opts,
            ...o ? e[o] ? .opts || {} : {}
        }
    }, fg = (e, t = "default") => {
        let o = t !== "default" ? `viewport_${t}` : void 0;
        return o ? e[o] ? .opts || {} : {}
    }
});
var yg, hw, WN, uw, Bse, vg, ON, CP, jN, Mse, Rse, bg = k(() => {
    "use strict";
    yg = E(N()), hw = E(gi());
    wj();
    ie();
    Be();
    ve();
    Nc();
    Or();
    Wo();
    SP();
    Ht();
    d0();
    B();
    WN = ["iPhone SE", "iPhone 14 & 15 Pro Max", "iPhone 14 & 15 Pro", "iPhone 13 & 14", "iPhone SE horizontal", "Tablet"], [uw, Bse, vg] = er(void 0), ON = ue("select")
    `
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  appearance: none;
  border: none;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  letter-spacing: inherit;
  background: none;
  color: inherit;
  opacity: 0;
`, CP = (e, t) => e === "Tablet" && !t("tablet_portrait") ? `${e} (Desktop layout is used)` : e === "iPhone SE horizontal" ? `${e} ${t("tablet_portrait")?"(Tablet layout is used)":"(Desktop layout is used)"}` : e, jN = ({
        defaultDevice: e,
        viewport: t
    }) => {
        let [o, i] = uw(), n = t && o && dp[o] === t ? o : t ? _f[t] : o || e || "Desktop", {
            isViewportEnabled: s
        } = (0, yg.useContext)(gg), a = n ? UC.includes(dp[n]) : !1;
        return (0, yg.useEffect)(() => {
            bt.trigger("change:device", n)
        }, [n]), r(b, {
            "aria-label": "Device switch",
            position: "fixed",
            top: "16px",
            left: "50%",
            zIndex: 550,
            minWidth: "50px",
            height: "24px",
            margin: "0 auto",
            borderRadius: "12px",
            textAlign: "center",
            whiteSpace: "nowrap",
            backgroundColor: "lightGray",
            color: "blue",
            display: n && a ? "block" : "none",
            transform: "translateX(-50%)",
            children: x(Bo, {
                textStyle: "small",
                lineHeight: "24px",
                display: "block",
                padding: "0 12px",
                children: [CP(n, s), r(ON, {
                    value: n,
                    onChange: l => {
                        let c = l.target.value;
                        i(c)
                    },
                    children: WN.map(l => r("option", {
                        value: l,
                        children: CP(l, s)
                    }, l))
                })]
            })
        })
    }, Mse = (e, {
        defaultDevice: t,
        router: o,
        project: i
    }) => {
        hw.default.render(r(Pk, {
            withGlobalStyles: !1,
            children: r(_P, {
                constructorMagModel: i,
                router: o,
                children: r(jN, {
                    defaultDevice: t
                })
            })
        }), e)
    }, Rse = e => {
        hw.default.unmountComponentAtNode(e)
    }
});

function BP() {
    try {
        return window.sessionStorage.getItem(PP) === "true"
    } catch {
        return !1
    }
}

function MP(e) {
    try {
        window.sessionStorage.setItem(PP, String(e))
    } catch (t) {
        console.log(t)
    }
}

function RP() {
    try {
        let e = window.sessionStorage.getItem(TP);
        return e ? JSON.parse(e) : null
    } catch {
        return null
    }
}

function EP(e) {
    try {
        window.sessionStorage.setItem(TP, JSON.stringify(e))
    } catch (t) {
        console.log(t)
    }
}

function hd(e, t) {
    let o = t === "default",
        i = [{
            label: "Load",
            name: "load"
        }, {
            label: "Scroll",
            name: "scroll"
        }, {
            label: o ? "Hover" : "Hold",
            name: "hover"
        }, {
            label: o ? "Click" : "Tap",
            name: "click"
        }, {
            label: "None",
            name: "none"
        }];
    return e ? i : i.filter(n => n.name !== "none")
}

function FP(e) {
    return rt(UN[e])
}

function VN(e) {
    return {
        UUID: be.generateUUID(),
        type: e,
        steps: [],
        loop: !1,
        playOnce: !1,
        resetWhenOutOfView: !1,
        trigger: [],
        selected: 0
    }
}

function GN(e) {
    let t = rt(e),
        o = t.steps ? ? [],
        i = t.selected ? ? 0,
        n = { ...wg
        };
    return n.use_bezier = o[i] ? .use_bezier, o.splice(i + 1, 0, n), t.selected = o[i + 1] ? i + 1 : i, t
}

function YN(e, t, o) {
    let i = rt(e),
        n = i.selected ? ? 0,
        s = i.steps,
        a = {};
    return a[o] = !0, o === "use_move" && s[n].dx === void 0 && (a.dx = t.steps[n].dx, a.dy = (t.steps[n].dy ? ? 0) + 10), o === "use_opacity" && s[n].opacity === void 0 && (a.opacity = Math.round(t.steps[n].opacity ? ? 0)), o === "use_rotate" && s[n].rotate === void 0 && (a.rotate = (t.steps[n].rotate ? ? 0) + 45), o === "use_scale" && s[n].scale === void 0 && (a.scale = Math.round((t.steps[n].scale ? ? 0) * .7)), s[n] = { ...s[n],
        ...a
    }, i
}

function ZN(e, t, o = {}) {
    let i = o.stepIndex ? ? e.selected ? ? 0,
        n = e.steps,
        s = n.map((a, l) => l === i ? { ...a,
            ...t
        } : a);
    if (t.dx !== void 0 || t.dy !== void 0) {
        let a = n[i],
            l = s[i],
            c = (l.dx ? ? 0) - (a.dx ? ? 0),
            d = (l.dy ? ? 0) - (a.dy ? ? 0),
            p = s[i + 1];
        s[i] ? .curve ? .c2 && (s[i].curve.c2.x += c, s[i].curve.c2.y += d), a ? .use_move && p ? .curve ? .c1 && (p.curve.c1.x += c, p.curve.c1.y += d)
    }
    return { ...e,
        steps: s
    }
}

function XN(e, t, o) {
    let i = rt(e),
        n = i.steps;
    if ((o === 0 || o === "initial") && n.length === 1) return i.selected = void 0, i.steps = [], i;
    if (o === "initial") return i;
    if (o === 0 && n.length > 1) {
        let s = {};
        s.from_opacity = n[0].from_opacity, s.from_rotate = n[0].from_rotate, s.from_scale = n[0].from_scale, n[0].use_opacity && (s.opacity = t.steps[1].opacity, s.use_opacity = !0), n[0].use_rotate && (s.rotate = t.steps[1].rotate, s.use_rotate = !0), n[0].use_scale && (s.scale = t.steps[1].scale, s.use_scale = !0), n[1] = { ...n[1],
            ...s
        }
    }
    return n.splice(o, 1), i.selected = o === n.length ? o - 1 : o, i
}

function kP(e, t, o = .3) {
    return {
        x: e.x + o * (t.x - e.x),
        y: e.y + o * (t.y - e.y)
    }
}

function KN(e) {
    let t = e.selected ? ? 0,
        o = rt(e.steps[t]),
        i = o.curve.c1,
        n = o.curve.c2;
    return o.curve.c1 = kP(i, n), o.curve.c2 = kP(n, i), o
}
var Wp, PP, TP, wg, mw, fw, md, gw, UN, DP, fd, AP, Zl, Xl, jn = k(() => {
    "use strict";
    Wp = E(N());
    Ht();
    oo();
    Mt();
    Wt();
    PP = "rm_copied-interaction-settings", TP = "rm_selected-interaction";
    wg = {
        duration: .5,
        delay: 0,
        speed: 1,
        delay_px: 0,
        acceleration: "ease-both",
        start_point: "bottom",
        start_offset: 0,
        from_opacity: 0,
        from_rotate: 0,
        from_scale: 100,
        use_move: !1,
        use_opacity: !1,
        use_rotate: !1,
        use_scale: !1,
        use_bezier: !1
    }, mw = [{
        label: "Top",
        name: "top"
    }, {
        label: "Center",
        name: "center"
    }, {
        label: "Bottom",
        name: "bottom"
    }], fw = [{
        label: "Linear",
        name: "none"
    }, {
        label: "Ease in",
        name: "ease-in"
    }, {
        label: "Ease out",
        name: "ease-out"
    }, {
        label: "Ease in and out",
        name: "ease-both"
    }, {
        label: "Ease in back",
        name: "ease-in-back"
    }, {
        label: "Ease out back",
        name: "ease-out-back"
    }, {
        label: "Ease in and out back",
        name: "ease-both-back"
    }];
    md = [{
        label: "Move",
        name: "use_move"
    }, {
        label: "Opacity",
        name: "use_opacity"
    }, {
        label: "Rotate",
        name: "use_rotate"
    }, {
        label: "Scale",
        name: "use_scale"
    }], gw = [{
        name: "fade-and-scale",
        label: "Fade&Scale"
    }, {
        name: "fade-in",
        label: "Fade In"
    }, {
        name: "scale-big",
        label: "Scale Big"
    }, {
        name: "move-and-fade",
        label: "Move&Fade"
    }, {
        name: "pulse",
        label: "Pulse"
    }, {
        name: "rotate",
        label: "Rotate"
    }], UN = {
        "fade-and-scale": {
            loop: !1,
            selected: 0,
            steps: [{
                duration: 1.2,
                delay: 0,
                speed: 1,
                delay_px: 0,
                opacity: 100,
                scale: 100,
                acceleration: "ease-out",
                start_point: "bottom",
                start_offset: 0,
                from_opacity: 0,
                from_rotate: 0,
                from_scale: 80,
                use_move: !1,
                use_opacity: !0,
                use_rotate: !1,
                use_scale: !0
            }]
        },
        "fade-in": {
            loop: !1,
            selected: 0,
            steps: [{
                duration: 1.6,
                delay: 0,
                speed: 1,
                delay_px: 0,
                opacity: 100,
                scale: 100,
                acceleration: "ease-out",
                start_point: "bottom",
                start_offset: 0,
                from_opacity: 0,
                from_rotate: 0,
                from_scale: 80,
                use_move: !1,
                use_opacity: !0,
                use_rotate: !1,
                use_scale: !1
            }]
        },
        "scale-big": {
            loop: !1,
            selected: 0,
            steps: [{
                duration: .8,
                delay: 0,
                speed: 1,
                delay_px: 0,
                opacity: 100,
                scale: 100,
                acceleration: "ease-out",
                start_point: "bottom",
                start_offset: 0,
                from_opacity: 0,
                from_rotate: 0,
                from_scale: 256,
                use_move: !1,
                use_opacity: !0,
                use_rotate: !1,
                use_scale: !0
            }]
        },
        "move-and-fade": {
            loop: !1,
            selected: 0,
            steps: [{
                duration: .8,
                delay: 0,
                speed: 1,
                delay_px: 0,
                dx: 0,
                dy: -32,
                opacity: 100,
                acceleration: "ease-both",
                start_point: "bottom",
                start_offset: 0,
                from_opacity: 0,
                from_rotate: 0,
                from_scale: 100,
                use_move: !0,
                use_opacity: !0,
                use_rotate: !1,
                use_scale: !1
            }]
        },
        pulse: {
            loop: !1,
            selected: 0,
            steps: [{
                loop: "swing",
                duration: 1.2,
                delay: 0,
                speed: 1,
                delay_px: 0,
                dx: 142,
                dy: 0,
                scale: 90,
                acceleration: "ease-both",
                start_point: "bottom",
                start_offset: 0,
                from_opacity: 100,
                from_rotate: 0,
                from_scale: 100,
                use_move: !1,
                use_opacity: !1,
                use_rotate: !1,
                use_scale: !0
            }]
        },
        rotate: {
            loop: !1,
            selected: 0,
            steps: [{
                loop: "repeat",
                duration: 1.8,
                delay: 0,
                speed: 1,
                delay_px: 0,
                dx: 0,
                dy: 0,
                rotate: 360,
                acceleration: "none",
                start_point: "bottom",
                start_offset: 0,
                from_opacity: 100,
                from_rotate: 0,
                from_scale: 100,
                use_move: !1,
                use_opacity: !1,
                use_rotate: !0,
                use_scale: !1
            }]
        }
    };
    DP = de.TRIGGER_COUNT_LIMIT, fd = ["click", "hover"], AP = [...fd, "load"];
    Zl = {
        createInteraction: VN,
        createInteractionStep: GN,
        updateInteractionStep: ZN,
        addInteractionStepEffect: YN,
        removeInteractionStep: XN,
        setDefaultCurveAfterEnable: KN
    }, Xl = e => {
        let t = (0, Wp.useRef)(e);
        return (0, Wp.useLayoutEffect)(() => {
            t.current = e
        }), (0, Wp.useCallback)((...o) => {
            let i = t.current;
            return i ? .(...o)
        }, [])
    }
});

function _g(e, t) {
    let o = Array.isArray(t) ? t : [t];
    xg.get(e) || xg.set(e, {
        phone_portrait: !1,
        tablet_portrait: !1
    });
    let i = xg.get(e);
    for (let n of o) i[n] = !0
}

function Nse() {
    return Array.from(xg.entries()).reduce((e, [t, o]) => (e.push({
        pageId: t,
        ...o
    }), e), [])
}
var xg, LP = k(() => {
    "use strict";
    xg = new Map
});

function JN(e) {
    Ja && zP(), Ja = e, zP = qN()
}

function qN() {
    let e = () => {
            Sg() && Cg()
        },
        t = o => {
            Sg(o.model.toJSON()) && Cg()
        };
    return Ja.on("block:remove", e), Ja.on("block:create", t), () => {
        Ja.off("block:remove", e), Ja.off("block:create", t)
    }
}

function QN(e) {
    Sg(e) && Cg(e)
}

function eU(e, t) {
    let o = e.toJSON();
    if (!Sg(o)) return;
    let i = e.previousAttributes(),
        n = e.changedAttributes(),
        s = pf(t).getKey(),
        a = o.blocks.findIndex(d => d.key === s),
        l = d => {
            if (!n) return !1;
            if (Gd(Object.keys(n), [d]).length > 0) {
                let p = i[d][a];
                return p ? !Rl(p, n[d][a]) : !0
            }
            return !1
        },
        c = d => {
            let p = d.find(h => h.key === s);
            return p ? p.text.trim() : null
        };
    if (l("blocks") && n) {
        let d = c(i.blocks),
            p = c(n.blocks);
        p !== "" && d !== p && Cg()
    }
    l("blocksMeta") && WP(o, "blocksMeta"), l("styles") && WP(o, "styles")
}

function Sg(e) {
    if (!Ja || Ja.viewport !== "default") return !1;
    let {
        isTabletEnabled: t,
        isPhoneEnabled: o
    } = bw();
    return e ? o && t ? !e.viewport_phone_portrait ? .hidden || !e.viewport_tablet_portrait ? .hidden : o ? !e.viewport_phone_portrait ? .hidden : t ? !e.viewport_tablet_portrait ? .hidden : !1 : o || t
}

function Cg(e) {
    let {
        isTabletEnabled: t,
        isPhoneEnabled: o,
        id: i
    } = bw(), n = [];
    if (!e) {
        o && n.push("phone_portrait"), t && n.push("tablet_portrait"), _g(i, n);
        return
    }
    o && !$P(e.viewport_phone_portrait) && n.push("phone_portrait"), t && !$P(e.viewport_tablet_portrait) && n.push("tablet_portrait"), n.length > 0 && _g(i, n)
}

function WP(e, t) {
    let {
        isTabletEnabled: o,
        isPhoneEnabled: i,
        id: n
    } = bw(), s = [];
    i && e.viewport_phone_portrait ? .[t] === void 0 && s.push("phone_portrait"), o && e.viewport_tablet_portrait ? .[t] === void 0 && s.push("tablet_portrait"), s.length > 0 && _g(n, s)
}

function bw() {
    let e = Ja.page,
        t = e.getViewportParam("phone_portrait", "enabled"),
        o = e.getViewportParam("tablet_portrait", "enabled");
    return {
        isPhoneEnabled: t,
        isTabletEnabled: o,
        id: e.id
    }
}
var Ja, zP, $P, tU, kg, yw = k(() => {
    "use strict";
    oo();
    LP();
    Yt();
    $P = e => e ? Object.keys(e).length > 0 : !1;
    tU = {
        setWorkspace: JN,
        onMoveBlock: Vd(QN, 100),
        onTextModelChange: eU
    }, kg = tU
});
var OP, jP = k(() => {
    "use strict";
    no();
    OP = {
        "template-constructor-control-common_layer": Ae `
	<div class="icon" aria-label="Order" data-alt="Order" data-alt-pos="left" data-alt-offset="9"></div>


	<div class="panel">
		<div class="backward-all" title="Send to Back"></div>
		<div class="backward" title="Send Backward"></div>
		<div class="forward" title="Bring Forward"></div>
		<div class="forward-all" title="Send to Front"></div>
	</div>
`
    }
});
var HP, oU, NP, UP = k(() => {
    "use strict";
    HP = E(ze());
    $n();
    jP();
    qt();
    oU = it.extend({
        name: "common_layer",
        className: "control common_layer",
        rolePermission: "BaseWidgetCanChangeZindex",
        BASE_ZINDEX: 100,
        initialize: function(e) {
            this.template = OP["template-constructor-control-common_layer"], this.initControl(e), this.blocks && Array.isArray(this.blocks) && (this.block = this.blocks[0], this.model = this.block.model), e.noInit || (this.selectedModels = HP.default.pluck(this.blocks, "model"))
        },
        restrictions: function(e) {
            return e.getSelectableBlocks().length > 1
        },
        select: function() {
            it.prototype.select.apply(this, arguments),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls-common_layer")
                })
        },
        bindLogic: function() {
            this.$panel.on("click", ".forward", this.forward), this.$panel.on("click", ".backward", this.backward), this.$panel.on("click", ".forward-all", this.forwardAll), this.$panel.on("click", ".backward-all", this.backwardAll), RM.constructorRouter.bindGlobalKeyPress([{
                key: "[",
                handler: this.backward,
                optionKeys: Modernizr.mac ? "meta" : "ctrl"
            }, {
                key: "]",
                handler: this.forward,
                optionKeys: Modernizr.mac ? "meta" : "ctrl"
            }, {
                key: "[",
                handler: this.backwardAll,
                optionKeys: Modernizr.mac ? ["alt", "meta"] : ["alt", "ctrl"]
            }, {
                key: "]",
                handler: this.forwardAll,
                optionKeys: Modernizr.mac ? ["alt", "meta"] : ["alt", "ctrl"]
            }])
        },
        unBindLogic: function() {
            this.$panel.off("click", ".forward", this.forward), this.$panel.off("click", ".backward", this.backward), this.$panel.off("click", ".forward-all", this.forwardAll), this.$panel.off("click", ".backward-all", this.backwardAll), RM.constructorRouter.unbindGlobalKeyPress("[", this.backward), RM.constructorRouter.unbindGlobalKeyPress("]", this.forward), RM.constructorRouter.unbindGlobalKeyPress("[", this.backwardAll), RM.constructorRouter.unbindGlobalKeyPress("]", this.forwardAll)
        },
        sendAnalyticEvent: function(e) {
            let t = window.RM.constructorRouter.indexController.getPagesToSave();
            this.master.workspace.syncManager.getChangedModelsData(t).length !== 0 && (e === "click" ? De(Fe.EditorActions, {
                action: "change order",
                changeOrderMethod: "order control"
            }) : e === "keydown" && De(Fe.EditorActions, {
                action: "change order",
                changeOrderMethod: "shortcut"
            }))
        },
        forward: function(e) {
            window.RM.constructorRouter.indexController.moveWidget(this.master.workspace.page, this.selectedModels, 1), this.sendAnalyticEvent(e ? .type), this.save()
        },
        backward: function(e) {
            window.RM.constructorRouter.indexController.moveWidget(this.master.workspace.page, this.selectedModels, -1), this.sendAnalyticEvent(e ? .type), this.save()
        },
        forwardAll: function(e) {
            window.RM.constructorRouter.indexController.moveWidget(this.master.workspace.page, this.selectedModels, 999), this.sendAnalyticEvent(e ? .type), this.save()
        },
        backwardAll: function(e) {
            window.RM.constructorRouter.indexController.moveWidget(this.master.workspace.page, this.selectedModels, -999), this.sendAnalyticEvent(e ? .type), this.save()
        },
        save: function(e) {
            e = e || {};
            let t = window.RM.constructorRouter.indexController.getPagesToSave();
            this.master.workspace.syncManager.saveGroup(t, { ...e,
                patch: !0
            }), this.master.workspace.trigger("redraw")
        }
    }), NP = oU
});
var VP, GP = k(() => {
    "use strict";
    no();
    VP = {
        "template-constructor-control-common_pack": Ae `
	<div class="icon noarrow" aria-label="Group" data-alt="Group" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
	</div>
`
    }
});
var Kr, iU, YP, ZP = k(() => {
    "use strict";
    Oc();
    Kr = E(ze());
    $n();
    Wt();
    GP();
    Wo();
    iU = it.extend({
        name: "common_pack",
        className: "control common_pack",
        rolePermission: "BaseWidgetCanChangeGroup",
        initialize: function(e) {
            this.template = VP["template-constructor-control-common_pack"], this.initControl(e)
        },
        bindLogic: function() {
            RM.constructorRouter.bindGlobalKeyPress([{
                key: "g",
                handler: this.onClick,
                optionKeys: Modernizr.mac ? "meta" : "ctrl"
            }])
        },
        unBindLogic: function() {
            RM.constructorRouter.unbindGlobalKeyPress("g", this.onClick)
        },
        restrictions: function(e) {
            let t = {},
                o = Kr.default.reduce(e.getSelectedBlocks(), function(a, l) {
                    let c = l.model.get("pack_id"),
                        d = c && t[c] ? 0 : 1;
                    return t[c] = 1, a + d
                }, 0) > 1,
                i = Kr.default.uniq(Kr.default.map(e.getSelectedBlocks(), function(a) {
                    let l = !!a.model.get("fixed_position");
                    return l = l || !1, l
                })).length <= 1,
                n = Kr.default.uniq(Kr.default.map(e.getSelectedBlocks(), function(a) {
                    return !!a.model.get("is_global")
                })).length <= 1,
                s = Kr.default.uniq(Kr.default.map(e.getSelectedBlocks(), function(a) {
                    return !!a.model.get("is_above")
                })).length <= 1;
            return o && i && n && s
        },
        onClick: function() {
            let e = be.generateUUID();
            Qn.nextTick(function() {
                let t = this.master.workspace.viewport === "default",
                    o = {};
                t && Kr.default.each(Oe.viewport_list, n => {
                    let s = this.master.workspace.page.get(n) || {};
                    o[n] = Kr.default.all(this.models, a => s.enabled && a[n] ? a[n].fixed_position === void 0 || !!a[n].fixed_position == !!a.get("fixed_position") : !0)
                });
                let i = Kr.default.map(this.models, function(n) {
                    let s = {
                        _id: n.id,
                        pack_id: e
                    };
                    return n.get("is_locked") && (n.set("is_locked", !1), Kr.default.extend(s, {
                        is_locked: !1
                    })), be.canUseMinimalViewport() && t && Kr.default.each(Oe.viewport_list, a => {
                        n[a] && (n[a].pack_id = o[a] ? e : null)
                    }), s
                });
                this.master.workspace.set_group(i), RM.constructorRouter.indexController.doPack(this.models, this.master.workspace.page, this.master.workspace.viewport, e), this.master.workspace.save_group(this.models), RM.constructorRouter.indexController.saveAffectedPages(), this.master.deselect()
            }.bind(this))
        }
    }), YP = iU
});
var XP, KP = k(() => {
    "use strict";
    no();
    XP = {
        "template-constructor-control-common_unpack": Ae `
	<div class="icon noarrow" aria-label="Ungroup" data-alt="Ungroup" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
	</div>
`
    }
});
var Ig, nU, JP, qP = k(() => {
    "use strict";
    Ig = E(ze());
    $n();
    KP();
    nU = it.extend({
        name: "common_unpack",
        className: "control common_unpack",
        rolePermission: "BaseWidgetCanChangeGroup",
        initialize: function(e) {
            this.template = XP["template-constructor-control-common_unpack"], this.initControl(e)
        },
        bindLogic: function() {
            RM.constructorRouter.bindGlobalKeyPress([{
                key: "g",
                handler: this.onClick,
                optionKeys: Modernizr.mac ? ["meta", "shift"] : ["ctrl", "shift"]
            }])
        },
        unBindLogic: function() {
            RM.constructorRouter.unbindGlobalKeyPress("g", this.onClick)
        },
        restrictions: function(e) {
            return Ig.default.reduce(e.getSelectedBlocks(), function(t, o) {
                return t + (o.model.get("pack_id") ? 1 : 0)
            }, 0) > 0
        },
        onClick: function() {
            let e = Ig.default.map(this.models, function(t) {
                let o = {
                    _id: t.id,
                    pack_id: null
                };
                return t.get("is_locked") && (t.set("is_locked", !1), Ig.default.extend(o, {
                    is_locked: !1
                })), o
            });
            this.master.workspace.set_group(e), RM.constructorRouter.indexController.doUnpack(this.models, this.master.workspace.page, this.master.workspace.viewport), this.master.workspace.save_group(this.models), RM.constructorRouter.indexController.saveAffectedPages(), this.master.deselect()
        }
    }), JP = nU
});
var Lh, Pg, QP, eT, tT, Op = k(() => {
    "use strict";
    Lh = "data-focus-lock", Pg = "data-focus-lock-disabled", QP = "data-no-focus-lock", eT = "data-autofocus-inside", tT = "data-no-autofocus"
});

function Tg(e, t) {
    return typeof e == "function" ? e(t) : e && (e.current = t), e
}
var oT = k(() => {
    "use strict"
});

function nT(e, t) {
    var o = (0, iT.useState)(function() {
        return {
            value: e,
            callback: t,
            facade: {
                get current() {
                    return o.value
                },
                set current(i) {
                    var n = o.value;
                    n !== i && (o.value = i, o.callback(i, n))
                }
            }
        }
    })[0];
    return o.callback = t, o.facade
}
var iT, rT = k(() => {
    "use strict";
    iT = E(N())
});

function vw(e, t) {
    var o = nT(t || null, function(i) {
        return e.forEach(function(n) {
            return Tg(n, i)
        })
    });
    return aT.useLayoutEffect(function() {
        var i = sT.get(o);
        if (i) {
            var n = new Set(i),
                s = new Set(e),
                a = o.current;
            n.forEach(function(l) {
                s.has(l) || Tg(l, null)
            }), s.forEach(function(l) {
                n.has(l) || Tg(l, a)
            })
        }
        sT.set(o, e)
    }, [e]), o
}
var aT, sT, lT = k(() => {
    "use strict";
    aT = E(N());
    oT();
    rT();
    sT = new WeakMap
});
var cT = k(() => {
    "use strict";
    lT()
});
var jp, Hp, sU, dT = k(() => {
    "use strict";
    jp = E(N()), Hp = {
        width: "1px",
        height: "0px",
        padding: 0,
        overflow: "hidden",
        position: "fixed",
        top: "1px",
        left: "1px"
    }, sU = function(t) {
        var o = t.children,
            i = o === void 0 ? null : o;
        return jp.createElement(jp.Fragment, null, jp.createElement("div", {
            key: "guard-first",
            "data-focus-guard": !0,
            "data-focus-auto-guard": !0,
            style: Hp
        }), i, i && jp.createElement("div", {
            key: "guard-last",
            "data-focus-guard": !0,
            "data-focus-auto-guard": !0,
            style: Hp
        }))
    };
    sU.propTypes = {}
});
var Bg, pT = k(() => {
    "use strict";
    Bg = function() {
        return Bg = Object.assign || function(t) {
            for (var o, i = 1, n = arguments.length; i < n; i++) {
                o = arguments[i];
                for (var s in o) Object.prototype.hasOwnProperty.call(o, s) && (t[s] = o[s])
            }
            return t
        }, Bg.apply(this, arguments)
    }
});

function uT(e) {
    return e
}

function hT(e, t) {
    t === void 0 && (t = uT);
    var o = [],
        i = !1,
        n = {
            read: function() {
                if (i) throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");
                return o.length ? o[o.length - 1] : e
            },
            useMedium: function(s) {
                var a = t(s, i);
                return o.push(a),
                    function() {
                        o = o.filter(function(l) {
                            return l !== a
                        })
                    }
            },
            assignSyncMedium: function(s) {
                for (i = !0; o.length;) {
                    var a = o;
                    o = [], a.forEach(s)
                }
                o = {
                    push: function(l) {
                        return s(l)
                    },
                    filter: function() {
                        return o
                    }
                }
            },
            assignMedium: function(s) {
                i = !0;
                var a = [];
                if (o.length) {
                    var l = o;
                    o = [], l.forEach(s), a = o
                }
                var c = function() {
                        var p = a;
                        a = [], p.forEach(s)
                    },
                    d = function() {
                        return Promise.resolve().then(c)
                    };
                d(), o = {
                    push: function(p) {
                        a.push(p), d()
                    },
                    filter: function(p) {
                        return a = a.filter(p), o
                    }
                }
            }
        };
    return n
}

function zh(e, t) {
    return t === void 0 && (t = uT), hT(e, t)
}

function ww(e) {
    e === void 0 && (e = {});
    var t = hT(null);
    return t.options = Bg({
        async: !0,
        ssr: !1
    }, e), t
}
var mT = k(() => {
    "use strict";
    pT()
});
var fT = k(() => {
    "use strict";
    mT()
});
var Mg, Rg, gT, bT, xw = k(() => {
    "use strict";
    fT();
    Mg = zh({}, function(e) {
        var t = e.target,
            o = e.currentTarget;
        return {
            target: t,
            currentTarget: o
        }
    }), Rg = zh(), gT = zh(), bT = ww({
        async: !0,
        ssr: typeof document < "u"
    })
});
var yT, vT, wT = k(() => {
    "use strict";
    yT = E(N()), vT = (0, yT.createContext)(void 0)
});
var fo, aU, xT, _w, _T = k(() => {
    "use strict";
    YC();
    fo = E(N());
    Op();
    cT();
    dT();
    xw();
    wT();
    aU = [], xT = fo.forwardRef(function(t, o) {
        var i, n = fo.useState(),
            s = n[0],
            a = n[1],
            l = fo.useRef(),
            c = fo.useRef(!1),
            d = fo.useRef(null),
            p = fo.useState({}),
            h = p[1],
            u = t.children,
            m = t.disabled,
            f = m === void 0 ? !1 : m,
            g = t.noFocusGuards,
            y = g === void 0 ? !1 : g,
            S = t.persistentFocus,
            w = S === void 0 ? !1 : S,
            v = t.crossFrame,
            C = v === void 0 ? !0 : v,
            I = t.autoFocus,
            T = I === void 0 ? !0 : I,
            P = t.allowTextSelection,
            M = t.group,
            F = t.className,
            R = t.whiteList,
            A = t.hasPositiveIndices,
            D = t.shards,
            O = D === void 0 ? aU : D,
            L = t.as,
            W = L === void 0 ? "div" : L,
            z = t.lockProps,
            V = z === void 0 ? {} : z,
            X = t.sideCar,
            q = t.returnFocus,
            ne = q === void 0 ? !1 : q,
            re = t.focusOptions,
            te = t.onActivation,
            ee = t.onDeactivation,
            j = fo.useState({}),
            se = j[0],
            oe = fo.useCallback(function(Tt) {
                var Ee = Tt.captureFocusRestore;
                if (!d.current) {
                    var Qe, _t = (Qe = document) == null ? void 0 : Qe.activeElement;
                    d.current = _t, _t !== document.body && (d.current = Ee(_t))
                }
                l.current && te && te(l.current), c.current = !0, h()
            }, [te]),
            U = fo.useCallback(function() {
                c.current = !1, ee && ee(l.current), h()
            }, [ee]),
            he = fo.useCallback(function(Tt) {
                var Ee = d.current;
                if (Ee) {
                    var Qe = (typeof Ee == "function" ? Ee() : Ee) || document.body,
                        _t = typeof ne == "function" ? ne(Qe) : ne;
                    if (_t) {
                        var Ge = typeof _t == "object" ? _t : void 0;
                        d.current = null, Tt ? Promise.resolve().then(function() {
                            return Qe.focus(Ge)
                        }) : Qe.focus(Ge)
                    }
                }
            }, [ne]),
            xe = fo.useCallback(function(Tt) {
                c.current && Mg.useMedium(Tt)
            }, []),
            pe = Rg.useMedium,
            J = fo.useCallback(function(Tt) {
                l.current !== Tt && (l.current = Tt, a(Tt))
            }, []),
            le = oh((i = {}, i[Pg] = f && "disabled", i[Lh] = M, i), V),
            ye = y !== !0,
            Ue = ye && y !== "tail",
            Te = vw([o, J]),
            Re = fo.useMemo(function() {
                return {
                    observed: l,
                    shards: O,
                    enabled: !f,
                    active: c.current
                }
            }, [f, c.current, O, s]);
        return fo.createElement(fo.Fragment, null, ye && [fo.createElement("div", {
            key: "guard-first",
            "data-focus-guard": !0,
            tabIndex: f ? -1 : 0,
            style: Hp
        }), A ? fo.createElement("div", {
            key: "guard-nearest",
            "data-focus-guard": !0,
            tabIndex: f ? -1 : 1,
            style: Hp
        }) : null], !f && fo.createElement(X, {
            id: se,
            sideCar: bT,
            observed: s,
            disabled: f,
            persistentFocus: w,
            crossFrame: C,
            autoFocus: T,
            whiteList: R,
            shards: O,
            onActivation: oe,
            onDeactivation: U,
            returnFocus: he,
            focusOptions: re
        }), fo.createElement(W, oh({
            ref: Te
        }, le, {
            className: F,
            onBlur: pe,
            onFocus: xe
        }), fo.createElement(vT.Provider, {
            value: Re
        }, u)), Ue && fo.createElement("div", {
            "data-focus-guard": !0,
            tabIndex: f ? -1 : 0,
            style: Hp
        }))
    });
    xT.propTypes = {};
    _w = xT
});

function lU(e, t) {
    function o(i) {
        return i.displayName || i.name || "Component"
    }
    return function(n) {
        var s = [],
            a;

        function l() {
            a = e(s.map(function(d) {
                return d.props
            })), t(a)
        }
        var c = function(d) {
            ZC(p, d);

            function p() {
                return d.apply(this, arguments) || this
            }
            p.peek = function() {
                return a
            };
            var h = p.prototype;
            return h.componentDidMount = function() {
                s.push(this), l()
            }, h.componentDidUpdate = function() {
                l()
            }, h.componentWillUnmount = function() {
                var m = s.indexOf(this);
                s.splice(m, 1), l()
            }, h.render = function() {
                return Eg.default.createElement(n, this.props)
            }, p
        }(Eg.PureComponent);
        return w0(c, "displayName", "SideEffect(" + o(n) + ")"), c
    }
}
var Eg, ST, CT = k(() => {
    "use strict";
    dj();
    $j();
    Eg = E(N());
    ST = lU
});
var Hn, Js, Fg, ka = k(() => {
    "use strict";
    Hn = function(e) {
        for (var t = Array(e.length), o = 0; o < e.length; ++o) t[o] = e[o];
        return t
    }, Js = function(e) {
        return Array.isArray(e) ? e : [e]
    }, Fg = function(e) {
        return Array.isArray(e) ? e[0] : e
    }
});
var cU, kT, IT, dU, pU, Sw, uU, Cw, kw, hU, PT, Iw, TT, mU, $h, Wh, BT, gd = k(() => {
    "use strict";
    Op();
    cU = function(e) {
        if (e.nodeType !== Node.ELEMENT_NODE) return !1;
        var t = window.getComputedStyle(e, null);
        return !t || !t.getPropertyValue ? !1 : t.getPropertyValue("display") === "none" || t.getPropertyValue("visibility") === "hidden"
    }, kT = function(e) {
        return e.parentNode && e.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE ? e.parentNode.host : e.parentNode
    }, IT = function(e) {
        return e === document || e && e.nodeType === Node.DOCUMENT_NODE
    }, dU = function(e) {
        return e.hasAttribute("inert")
    }, pU = function(e, t) {
        return !e || IT(e) || !cU(e) && !dU(e) && t(kT(e))
    }, Sw = function(e, t) {
        var o = e.get(t);
        if (o !== void 0) return o;
        var i = pU(t, Sw.bind(void 0, e));
        return e.set(t, i), i
    }, uU = function(e, t) {
        return e && !IT(e) ? mU(e) ? t(kT(e)) : !1 : !0
    }, Cw = function(e, t) {
        var o = e.get(t);
        if (o !== void 0) return o;
        var i = uU(t, Cw.bind(void 0, e));
        return e.set(t, i), i
    }, kw = function(e) {
        return e.dataset
    }, hU = function(e) {
        return e.tagName === "BUTTON"
    }, PT = function(e) {
        return e.tagName === "INPUT"
    }, Iw = function(e) {
        return PT(e) && e.type === "radio"
    }, TT = function(e) {
        return !((PT(e) || hU(e)) && (e.type === "hidden" || e.disabled))
    }, mU = function(e) {
        var t = e.getAttribute(tT);
        return ![!0, "true", ""].includes(t)
    }, $h = function(e) {
        var t;
        return !!(e && (!((t = kw(e)) === null || t === void 0) && t.focusGuard))
    }, Wh = function(e) {
        return !$h(e)
    }, BT = function(e) {
        return !!e
    }
});
var fU, gU, Oh, Pw = k(() => {
    "use strict";
    ka();
    fU = function(e, t) {
        var o = Math.max(0, e.tabIndex),
            i = Math.max(0, t.tabIndex),
            n = o - i,
            s = e.index - t.index;
        if (n) {
            if (!o) return 1;
            if (!i) return -1
        }
        return n || s
    }, gU = function(e) {
        return e.tabIndex < 0 && !e.hasAttribute("tabindex") ? 0 : e.tabIndex
    }, Oh = function(e, t, o) {
        return Hn(e).map(function(i, n) {
            var s = gU(i);
            return {
                node: i,
                index: n,
                tabIndex: o && s === -1 ? (i.dataset || {}).focusGuard ? 0 : -1 : s
            }
        }).filter(function(i) {
            return !t || i.tabIndex >= 0
        }).sort(fU)
    }
});
var MT, RT = k(() => {
    "use strict";
    MT = ["button:enabled", "select:enabled", "textarea:enabled", "input:enabled", "a[href]", "area[href]", "summary", "iframe", "object", "embed", "audio[controls]", "video[controls]", "[tabindex]", "[contenteditable]", "[autofocus]"]
});
var Tw, bU, ET, yU, Kl, FT, Bw = k(() => {
    "use strict";
    Op();
    ka();
    RT();
    Tw = MT.join(","), bU = "".concat(Tw, ", [data-focus-guard]"), ET = function(e, t) {
        return Hn((e.shadowRoot || e).children).reduce(function(o, i) {
            return o.concat(i.matches(t ? bU : Tw) ? [i] : [], ET(i))
        }, [])
    }, yU = function(e, t) {
        var o;
        return e instanceof HTMLIFrameElement && (!((o = e.contentDocument) === null || o === void 0) && o.body) ? Kl([e.contentDocument.body], t) : [e]
    }, Kl = function(e, t) {
        return e.reduce(function(o, i) {
            var n, s = ET(i, t),
                a = (n = []).concat.apply(n, s.map(function(l) {
                    return yU(l, t)
                }));
            return o.concat(a, i.parentNode ? Hn(i.parentNode.querySelectorAll(Tw)).filter(function(l) {
                return l === i
            }) : [])
        }, [])
    }, FT = function(e) {
        var t = e.querySelectorAll("[".concat(eT, "]"));
        return Hn(t).map(function(o) {
            return Kl([o])
        }).reduce(function(o, i) {
            return o.concat(i)
        }, [])
    }
});
var Mw, Rw, jh, Np, DT, qs, qa = k(() => {
    "use strict";
    ka();
    gd();
    Pw();
    Bw();
    Mw = function(e, t) {
        return Hn(e).filter(function(o) {
            return Sw(t, o)
        }).filter(function(o) {
            return TT(o)
        })
    }, Rw = function(e, t) {
        return t === void 0 && (t = new Map), Hn(e).filter(function(o) {
            return Cw(t, o)
        })
    }, jh = function(e, t, o) {
        return Oh(Mw(Kl(e, o), t), !0, o)
    }, Np = function(e, t) {
        return Oh(Mw(Kl(e), t), !1)
    }, DT = function(e, t) {
        return Mw(FT(e), t)
    }, qs = function(e, t) {
        return e.shadowRoot ? qs(e.shadowRoot, t) : Object.getPrototypeOf(e).contains !== void 0 && Object.getPrototypeOf(e).contains.call(e, t) ? !0 : Hn(e.children).some(function(o) {
            var i;
            if (o instanceof HTMLIFrameElement) {
                var n = (i = o.contentDocument) === null || i === void 0 ? void 0 : i.body;
                return n ? qs(n, t) : !1
            }
            return qs(o, t)
        })
    }
});
var vU, AT, Up, Dg = k(() => {
    "use strict";
    Op();
    ka();
    vU = function(e) {
        for (var t = new Set, o = e.length, i = 0; i < o; i += 1)
            for (var n = i + 1; n < o; n += 1) {
                var s = e[i].compareDocumentPosition(e[n]);
                (s & Node.DOCUMENT_POSITION_CONTAINED_BY) > 0 && t.add(n), (s & Node.DOCUMENT_POSITION_CONTAINS) > 0 && t.add(i)
            }
        return e.filter(function(a, l) {
            return !t.has(l)
        })
    }, AT = function(e) {
        return e.parentNode ? AT(e.parentNode) : e
    }, Up = function(e) {
        var t = Js(e);
        return t.filter(Boolean).reduce(function(o, i) {
            var n = i.getAttribute(Lh);
            return o.push.apply(o, n ? vU(Hn(AT(i).querySelectorAll("[".concat(Lh, '="').concat(n, '"]:not([').concat(Pg, '="disabled"])')))) : [i]), o
        }, [])
    }
});
var LT, zT = k(() => {
    "use strict";
    LT = function(e) {
        try {
            return e()
        } catch {
            return
        }
    }
});
var Jl, Ag = k(() => {
    "use strict";
    zT();
    Jl = function(e) {
        if (e === void 0 && (e = document), !(!e || !e.activeElement)) {
            var t = e.activeElement;
            return t.shadowRoot ? Jl(t.shadowRoot) : t instanceof HTMLIFrameElement && LT(function() {
                return t.contentWindow.document
            }) ? Jl(t.contentWindow.document) : t
        }
    }
});
var wU, xU, Lg, $T = k(() => {
    "use strict";
    qa();
    Dg();
    ka();
    Ag();
    wU = function(e, t) {
        return e === t
    }, xU = function(e, t) {
        return !!Hn(e.querySelectorAll("iframe")).some(function(o) {
            return wU(o, t)
        })
    }, Lg = function(e, t) {
        return t === void 0 && (t = Jl(Fg(e).ownerDocument)), !t || t.dataset && t.dataset.focusGuard ? !1 : Up(e).some(function(o) {
            return qs(o, t) || xU(o, t)
        })
    }
});
var Ew, WT = k(() => {
    "use strict";
    Op();
    qa();
    ka();
    Ag();
    Ew = function(e) {
        e === void 0 && (e = document);
        var t = Jl(e);
        return t ? Hn(e.querySelectorAll("[".concat(QP, "]"))).some(function(o) {
            return qs(o, t)
        }) : !1
    }
});
var _U, zg, OT, Fw = k(() => {
    "use strict";
    gd();
    _U = function(e, t) {
        return t.filter(Iw).filter(function(o) {
            return o.name === e.name
        }).filter(function(o) {
            return o.checked
        })[0] || e
    }, zg = function(e, t) {
        return Iw(e) && e.name ? _U(e, t) : e
    }, OT = function(e) {
        var t = new Set;
        return e.forEach(function(o) {
            return t.add(zg(o, e))
        }), e.filter(function(o) {
            return t.has(o)
        })
    }
});
var Dw, Aw, Lw = k(() => {
    "use strict";
    Fw();
    Dw = function(e) {
        return e[0] && e.length > 1 ? zg(e[0], e) : e[0]
    }, Aw = function(e, t) {
        return e.indexOf(zg(t, e))
    }
});
var $g, jT, HT = k(() => {
    "use strict";
    Fw();
    Lw();
    gd();
    $g = "NEW_FOCUS", jT = function(e, t, o, i, n) {
        var s = e.length,
            a = e[0],
            l = e[s - 1],
            c = $h(i);
        if (!(i && e.indexOf(i) >= 0)) {
            var d = i !== void 0 ? o.indexOf(i) : -1,
                p = n ? o.indexOf(n) : d,
                h = n ? e.indexOf(n) : -1;
            if (d === -1) return h !== -1 ? h : $g;
            if (h === -1) return $g;
            var u = d - p,
                m = o.indexOf(a),
                f = o.indexOf(l),
                g = OT(o),
                y = i !== void 0 ? g.indexOf(i) : -1,
                S = y - (n ? g.indexOf(n) : d);
            if (!u && h >= 0 || t.length === 0) return h;
            var w = Aw(e, t[0]),
                v = Aw(e, t[t.length - 1]);
            if (d <= m && c && Math.abs(u) > 1) return v;
            if (d >= f && c && Math.abs(u) > 1) return w;
            if (u && Math.abs(S) > 1) return h;
            if (d <= m) return v;
            if (d > f) return w;
            if (u) return Math.abs(u) > 1 ? h : (s + h + u) % s
        }
    }
});
var SU, zw, NT = k(() => {
    "use strict";
    qa();
    Lw();
    gd();
    SU = function(e) {
        return function(t) {
            var o, i = (o = kw(t)) === null || o === void 0 ? void 0 : o.autofocus;
            return t.autofocus || i !== void 0 && i !== "false" || e.indexOf(t) >= 0
        }
    }, zw = function(e, t, o) {
        var i = e.map(function(s) {
                var a = s.node;
                return a
            }),
            n = Rw(i.filter(SU(o)));
        return n && n.length ? Dw(n) : Dw(Rw(t))
    }
});
var Ww, $w, Wg, Ow, jw = k(() => {
    "use strict";
    qa();
    qa();
    ka();
    Ww = function(e, t) {
        return t === void 0 && (t = []), t.push(e), e.parentNode && Ww(e.parentNode.host || e.parentNode, t), t
    }, $w = function(e, t) {
        for (var o = Ww(e), i = Ww(t), n = 0; n < o.length; n += 1) {
            var s = o[n];
            if (i.indexOf(s) >= 0) return s
        }
        return !1
    }, Wg = function(e, t, o) {
        var i = Js(e),
            n = Js(t),
            s = i[0],
            a = !1;
        return n.filter(Boolean).forEach(function(l) {
            a = $w(a || l, l) || a, o.filter(Boolean).forEach(function(c) {
                var d = $w(s, c);
                d && (!a || qs(d, a) ? a = d : a = $w(d, a))
            })
        }), a
    }, Ow = function(e, t) {
        return e.reduce(function(o, i) {
            return o.concat(DT(i, t))
        }, [])
    }
});
var CU, UT, VT = k(() => {
    "use strict";
    HT();
    qa();
    Dg();
    ka();
    NT();
    Ag();
    gd();
    jw();
    CU = function(e, t) {
        var o = new Map;
        return t.forEach(function(i) {
            return o.set(i.node, i)
        }), e.map(function(i) {
            return o.get(i)
        }).filter(BT)
    }, UT = function(e, t) {
        var o = Jl(Js(e).length > 0 ? document : Fg(e).ownerDocument),
            i = Up(e).filter(Wh),
            n = Wg(o || e, e, i),
            s = new Map,
            a = Np(i, s),
            l = a.filter(function(f) {
                var g = f.node;
                return Wh(g)
            });
        if (l[0]) {
            var c = Np([n], s).map(function(f) {
                    var g = f.node;
                    return g
                }),
                d = CU(c, l),
                p = d.map(function(f) {
                    var g = f.node;
                    return g
                }),
                h = d.filter(function(f) {
                    var g = f.tabIndex;
                    return g >= 0
                }).map(function(f) {
                    var g = f.node;
                    return g
                }),
                u = jT(p, h, c, o, t);
            if (u === $g) {
                var m = zw(a, h, Ow(i, s)) || zw(a, p, Ow(i, s));
                if (m) return {
                    node: m
                };
                console.warn("focus-lock: cannot find any node to move focus into");
                return
            }
            return u === void 0 ? u : d[u]
        }
    }
});
var Hw, GT = k(() => {
    "use strict";
    Dg();
    gd();
    jw();
    Pw();
    Bw();
    Hw = function(e) {
        var t = Up(e).filter(Wh),
            o = Wg(e, e, t),
            i = Oh(Kl([o], !0), !0, !0),
            n = Kl(t, !1);
        return i.map(function(s) {
            var a = s.node,
                l = s.index;
            return {
                node: a,
                index: l,
                lockItem: n.indexOf(a) >= 0,
                guard: $h(a)
            }
        })
    }
});
var Hh, Nw = k(() => {
    "use strict";
    Hh = function(e, t) {
        e && ("focus" in e && e.focus(t), "contentWindow" in e && e.contentWindow && e.contentWindow.focus())
    }
});
var Uw, Vw, Og, YT = k(() => {
    "use strict";
    Nw();
    VT();
    Uw = 0, Vw = !1, Og = function(e, t, o) {
        o === void 0 && (o = {});
        var i = UT(e, t);
        if (!Vw && i) {
            if (Uw > 2) {
                console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"), Vw = !0, setTimeout(function() {
                    Vw = !1
                }, 1);
                return
            }
            Uw++, Hh(i.node, o.focusOptions), Uw--
        }
    }
});

function Nh(e) {
    if (!e) return null;
    var t = e ? new WeakRef(e) : null;
    return function() {
        return t ? .deref() || null
    }
}
var kU, IU, Gw, ZT = k(() => {
    "use strict";
    qa();
    kU = function(e) {
        if (!e) return null;
        for (var t = [], o = e; o && o !== document.body;) t.push({
            current: Nh(o),
            parent: Nh(o.parentElement),
            left: Nh(o.previousElementSibling),
            right: Nh(o.nextElementSibling)
        }), o = o.parentElement;
        return {
            element: Nh(e),
            stack: t,
            ownerDocument: e.ownerDocument
        }
    }, IU = function(e) {
        var t, o, i, n, s;
        if (e)
            for (var a = e.stack, l = e.ownerDocument, c = new Map, d = 0, p = a; d < p.length; d++) {
                var h = p[d],
                    u = (t = h.parent) === null || t === void 0 ? void 0 : t.call(h);
                if (u && l.contains(u)) {
                    for (var m = (o = h.left) === null || o === void 0 ? void 0 : o.call(h), f = (i = h.right) === null || i === void 0 ? void 0 : i.call(h), g = jh([u], c), y = (s = (n = m ? .nextElementSibling) !== null && n !== void 0 ? n : f) !== null && s !== void 0 ? s : m; y;) {
                        for (var S = 0, w = g; S < w.length; S++) {
                            var v = w[S];
                            if (y ? .contains(v.node)) return v.node
                        }
                        y = y.nextElementSibling
                    }
                    if (g.length) return g[0].node
                }
            }
    }, Gw = function(e) {
        var t = kU(e);
        return function() {
            return IU(t)
        }
    }
});
var XT, PU, TU, KT, Yw, Zw, JT, Xw, Kw, qT = k(() => {
    "use strict";
    Nw();
    qa();
    ka();
    XT = function(e, t, o) {
        if (!e || !t) return console.error("no element or scope given"), {};
        var i = Js(t);
        if (i.every(function(a) {
                return !qs(a, e)
            })) return console.error("Active element is not contained in the scope"), {};
        var n = o ? jh(i, new Map) : Np(i, new Map),
            s = n.findIndex(function(a) {
                var l = a.node;
                return l === e
            });
        if (s !== -1) return {
            prev: n[s - 1],
            next: n[s + 1],
            first: n[0],
            last: n[n.length - 1]
        }
    }, PU = function(e, t) {
        var o = t ? jh(Js(e), new Map) : Np(Js(e), new Map);
        return {
            first: o[0],
            last: o[o.length - 1]
        }
    }, TU = function(e) {
        return Object.assign({
            scope: document.body,
            cycle: !0,
            onlyTabbable: !0
        }, e)
    }, KT = function(e, t, o) {
        t === void 0 && (t = {});
        var i = TU(t),
            n = XT(e, i.scope, i.onlyTabbable);
        if (n) {
            var s = o(n, i.cycle);
            s && Hh(s.node, i.focusOptions)
        }
    }, Yw = function(e, t) {
        t === void 0 && (t = {}), KT(e, t, function(o, i) {
            var n = o.next,
                s = o.first;
            return n || i && s
        })
    }, Zw = function(e, t) {
        t === void 0 && (t = {}), KT(e, t, function(o, i) {
            var n = o.prev,
                s = o.last;
            return n || i && s
        })
    }, JT = function(e, t, o) {
        var i, n = PU(e, (i = t.onlyTabbable) !== null && i !== void 0 ? i : !0),
            s = n[o];
        s && Hh(s.node, t.focusOptions)
    }, Xw = function(e, t) {
        t === void 0 && (t = {}), JT(e, t, "first")
    }, Kw = function(e, t) {
        t === void 0 && (t = {}), JT(e, t, "last")
    }
});
var QT = k(() => {
    "use strict";
    $T();
    WT();
    GT();
    YT();
    ZT();
    qT()
});

function jg(e) {
    setTimeout(e, 1)
}
var e2, t2 = k(() => {
    "use strict";
    e2 = function(t) {
        return t && "current" in t ? t.current : t
    }
});

function o2(e, t, o, i) {
    var n = null,
        s = e;
    do {
        var a = i[s];
        if (a.guard) a.node.dataset.focusAutoGuard && (n = a);
        else if (a.lockItem) {
            if (s !== e) return;
            n = null
        } else break
    } while ((s += o) !== t);
    n && (n.node.tabIndex = 0)
}

function HU(e) {
    return e.filter(function(t) {
        var o = t.disabled;
        return !o
    })
}

function NU(e) {
    var t = e.slice(-1)[0];
    t && !Gp && OU();
    var o = Gp,
        i = o && t && t.id === o.id;
    Gp = t, o && !i && (o.onDeactivation(), e.filter(function(n) {
        var s = n.id;
        return s === o.id
    }).length || o.returnFocus(!t)), t ? (Vp = null, (!i || o.observed !== t.observed) && t.onActivation(a2), Hg(!0), jg(Hg)) : (jU(), Vp = null)
}
var i2, BU, MU, Gp, Vp, Yp, Uh, RU, EU, FU, DU, AU, LU, zU, Hg, n2, Ng, r2, $U, WU, s2, OU, jU, a2, l2, c2 = k(() => {
    "use strict";
    i2 = E(N());
    CT();
    QT();
    t2();
    xw();
    BU = function() {
        return document && document.activeElement === document.body
    }, MU = function() {
        return BU() || Ew()
    }, Gp = null, Vp = null, Yp = null, Uh = !1, RU = function() {
        return !0
    }, EU = function(t) {
        return (Gp.whiteList || RU)(t)
    }, FU = function(t, o) {
        Yp = {
            observerNode: t,
            portaledElement: o
        }
    }, DU = function(t) {
        return Yp && Yp.portaledElement === t
    };
    AU = function(t) {
        return t ? !!Uh : Uh === "meanwhile"
    }, LU = function e(t, o, i) {
        return o && (o.host === t && (!o.activeElement || i.contains(o.activeElement)) || o.parentNode && e(t, o.parentNode, i))
    }, zU = function(t, o) {
        return o.some(function(i) {
            return LU(t, i, i)
        })
    }, Hg = function() {
        var t = !1;
        if (Gp) {
            var o = Gp,
                i = o.observed,
                n = o.persistentFocus,
                s = o.autoFocus,
                a = o.shards,
                l = o.crossFrame,
                c = o.focusOptions,
                d = i || Yp && Yp.portaledElement,
                p = document && document.activeElement;
            if (d) {
                var h = [d].concat(a.map(e2).filter(Boolean));
                if ((!p || EU(p)) && (n || AU(l) || !MU() || !Vp && s) && (d && !(Lg(h) || p && zU(p, h) || DU(p, d)) && (document && !Vp && p && !s ? (p.blur && p.blur(), document.body.focus()) : (t = Og(h, Vp, {
                        focusOptions: c
                    }), Yp = {})), Uh = !1, Vp = document && document.activeElement), document && p !== document.activeElement && document.querySelector("[data-focus-auto-guard]")) {
                    var u = document && document.activeElement,
                        m = Hw(h),
                        f = m.map(function(g) {
                            var y = g.node;
                            return y
                        }).indexOf(u);
                    f > -1 && (m.filter(function(g) {
                        var y = g.guard,
                            S = g.node;
                        return y && S.dataset.focusAutoGuard
                    }).forEach(function(g) {
                        var y = g.node;
                        return y.removeAttribute("tabIndex")
                    }), o2(f, m.length, 1, m), o2(f, -1, -1, m))
                }
            }
        }
        return t
    }, n2 = function(t) {
        Hg() && t && (t.stopPropagation(), t.preventDefault())
    }, Ng = function() {
        return jg(Hg)
    }, r2 = function(t) {
        var o = t.target,
            i = t.currentTarget;
        i.contains(o) || FU(i, o)
    }, $U = function() {
        return null
    }, WU = function(t) {
        var o = t.children;
        return i2.createElement("div", {
            onBlur: Ng,
            onFocus: r2
        }, o)
    };
    WU.propTypes = {};
    s2 = function() {
        Uh = "just", jg(function() {
            Uh = "meanwhile"
        })
    }, OU = function() {
        document.addEventListener("focusin", n2), document.addEventListener("focusout", Ng), window.addEventListener("blur", s2)
    }, jU = function() {
        document.removeEventListener("focusin", n2), document.removeEventListener("focusout", Ng), window.removeEventListener("blur", s2)
    };
    a2 = {
        moveFocusInside: Og,
        focusInside: Lg,
        focusNextElement: Yw,
        focusPrevElement: Zw,
        focusFirstElement: Xw,
        focusLastElement: Kw,
        captureFocusRestore: Gw
    };
    Mg.assignSyncMedium(r2);
    Rg.assignMedium(Ng);
    gT.assignMedium(function(e) {
        return e(a2)
    });
    l2 = ST(HU, NU)($U)
});
var Ug, d2, p2, wce, xce, u2, h2 = k(() => {
    "use strict";
    zj();
    YC();
    Ug = E(N());
    _T();
    c2();
    d2 = Ug.forwardRef(function(t, o) {
        return Ug.createElement(_w, oh({
            sideCar: l2,
            ref: o
        }, t))
    }), p2 = _w.propTypes || {}, wce = p2.sideCar, xce = v0(p2, ["sideCar"]);
    d2.propTypes = {};
    u2 = d2
});
var m2 = k(() => {
    "use strict"
});
var f2, g2 = k(() => {
    "use strict";
    h2();
    m2();
    f2 = u2
});
var ql, UU, b2, y2 = k(() => {
    "use strict";
    ql = E(N()), UU = (e => (e.forward = "forward", e.reverse = "reverse", e))(UU || {}), b2 = ({
        ref: e,
        min: t,
        max: o,
        direction: i = "forward",
        onResizeComplete: n,
        initialHeight: s
    }) => {
        let [a, l] = (0, ql.useState)(0), [c, d] = (0, ql.useState)(0), [p, h] = (0, ql.useState)(!1), u = S => {
            if (e.current) {
                let w = e.current.getBoundingClientRect();
                l(w.height), h(!0), d(S.pageY)
            }
        }, m = S => {
            let w = S;
            return typeof t < "u" && (w = Math.max(typeof t == "number" ? t : t(), w)), typeof o < "u" && (w = Math.min(typeof o == "number" ? o : o(), w)), w
        }, f = S => {
            let w = S.pageY - c,
                v = m(i === "forward" ? a + w : a - w);
            e.current && (e.current.style.height = `${v}px`)
        }, g = S => {
            let w = S.pageY - c,
                v = m(i === "forward" ? a + w : a - w);
            e.current && e.current.style.removeProperty("height"), n && n(v), h(!1), l(v)
        }, y = () => {
            if (typeof o < "u") {
                let S = typeof o == "function" ? o() : o;
                a > S && (n && n(S), l(S))
            }
        };
        return (0, ql.useEffect)(() => {
            typeof s == "number" && s !== a && l(s)
        }, [s]), (0, ql.useEffect)(() => {
            if (typeof o < "u") return y(), window.addEventListener("resize", y), () => {
                window.removeEventListener("resize", y)
            }
        }, [a]), (0, ql.useEffect)(() => (p ? (window.addEventListener("mousemove", f), window.addEventListener("mouseup", g)) : (window.removeEventListener("mousemove", f), window.removeEventListener("mouseup", g)), () => {
            window.removeEventListener("mousemove", f), window.removeEventListener("mouseup", g)
        }), [p]), {
            isResizable: p,
            onMouseDown: u
        }
    }
});
var v2, VU, Ql, Vh = k(() => {
    "use strict";
    v2 = E(N());
    ie();
    or();
    B();
    VU = (0, v2.forwardRef)(({
        children: e,
        className: t,
        resizable: o,
        height: i = 300,
        maxContainerHeight: n,
        scrollable: s,
        clean: a,
        gradientBackground: l,
        dark: c = !1,
        disableBorders: d = !1
    }, p) => r(b, {
        maxHeight: s ? `calc(${n})` || "100vh" : void 0,
        children: r(b, {
            ref: p,
            className: t,
            boxSizing: "content-box",
            height: o ? i : void 0,
            maxHeight: s ? `calc(${n||"100vh"} - 16px - 16px)` : void 0,
            backgroundColor: a ? void 0 : c ? "black" : "lightGray",
            borderRadius: 8,
            border: d ? void 0 : "1px solid",
            borderColor: a || d ? "transparent" : "rgba(64, 64, 64, 0.08)",
            position: "relative",
            background: l ? "linear-gradient(to right, #e2e2e2, #f4f4f4);" : "",
            color: c ? "white" : void 0,
            children: s && !o ? r(xo, {
                children: ({
                    ref: h
                }) => r(b, {
                    ref: h,
                    children: e
                })
            }) : e
        })
    })), Ql = VU
});
var Qs, w2, Ot, GU, Me, nt = k(() => {
    "use strict";
    Qs = E(N());
    ie();
    w2 = E(gi());
    Li();
    g2();
    y2();
    Vh();
    ve();
    B();
    Ot = (0, Qs.createContext)({}), GU = (0, Qs.forwardRef)(({
        children: e,
        style: t = {},
        className: o,
        resizable: i,
        onResizeComplete: n,
        height: s = 300,
        minHeight: a = 240,
        maxHeight: l,
        scrollable: c,
        portalElement: d,
        isShowed: p,
        clean: h,
        gradientBackground: u,
        onResizeToggle: m,
        dark: f = !1,
        disableBorders: g = !1,
        enableFocusLock: y = !1
    }, S) => {
        let w = d || typeof document < "u" && document.getElementById("controls-portal"),
            v = (0, Qs.createRef)(),
            {
                isResizable: C,
                onMouseDown: I
            } = b2({
                ref: v,
                min: a,
                max: () => window.innerHeight - 16 - 16,
                onResizeComplete: typeof n == "function" ? n : void 0,
                initialHeight: s
            });
        (0, Qs.useEffect)(() => {
            m && m(C)
        }, [C]);
        let T = (0, Qs.useRef)(null),
            P = (0, Qs.useRef)(null),
            M = 170,
            F = p ? r("div", {
                ref: S,
                style: {
                    width: M,
                    ...t
                },
                children: x(wt.div, {
                    style: {
                        width: M
                    },
                    initial: {
                        opacity: 0,
                        x: 8
                    },
                    animate: p ? {
                        opacity: 1,
                        x: 0
                    } : {
                        opacity: 0,
                        x: 8
                    },
                    transition: {
                        duration: .2
                    },
                    children: [x(b, {
                        position: "relative",
                        css: Z `
              ${C?`
                  pointer-events: none;
                  user-select: none;

                  * {
                    pointer-events: none !important;
                  }
                  `:""}
            `,
                        children: [r(f2, {
                            disabled: !y,
                            autoFocus: !1,
                            children: r(Ql, {
                                ref: v,
                                className: o,
                                resizable: i,
                                scrollable: c,
                                maxContainerHeight: l,
                                height: s,
                                clean: h,
                                gradientBackground: u,
                                dark: f,
                                disableBorders: g,
                                children: e
                            })
                        }), i && !c ? r(b, {
                            className: o,
                            position: "absolute",
                            bottom: 0,
                            left: 0,
                            width: "100%",
                            height: 4,
                            onMouseDown: I,
                            cursor: "row-resize"
                        }) : null]
                    }), r(b, {
                        ref: T
                    }), r(b, {
                        ref: P
                    })]
                })
            }) : null;
        return r(Ot.Provider, {
            value: {
                tooltipContainer: T.current || void 0,
                dropdownContainer: P.current || void 0
            },
            children: w ? (0, w2.createPortal)(F, w) : F
        })
    }), Me = GU
});

function YU({
    leftSlot: e,
    centerSlot: t,
    rightSlot: o,
    showBorder: i = !0
}) {
    return r(b, {
        height: 40,
        paddingLeft: 16,
        paddingRight: 16,
        borderRadius: "8px 8px 0 0",
        children: x(b, {
            height: 40,
            display: "flex",
            justifyContent: "space-between",
            alignItems: "center",
            borderBottom: i ? "2px solid rgba(184,184,184,0.24)" : void 0,
            children: [r(b, {
                width: "20%",
                display: "flex",
                alignItems: "center",
                height: "100%",
                children: e
            }), r(b, {
                width: "100%",
                display: "flex",
                alignItems: "center",
                justifyContent: "center",
                height: "100%",
                children: t
            }), r(b, {
                width: "20%",
                display: "flex",
                alignItems: "center",
                justifyContent: "flex-end",
                height: "100%",
                children: o
            })]
        })
    })
}
var Ut, gn = k(() => {
    "use strict";
    ie();
    B();
    Ut = YU
});
var x2, Jw, _2 = k(() => {
    "use strict";
    ve();
    ut();
    Be();
    x2 = $.withComponent(ue("select")
        `
  display: block;
  width: 100%;
  background: transparent;
  outline: none;
  resize: none;
  border-radius: 0;
  appearance: none;

  ${Jm({regular:{padding:"0 0 10px 0",height:40,color:ce.black,"&:focus":{borderBottom:`2px solid ${ce.black}`}}})}
`);
    x2.defaultProps = {
        variant: "regular",
        textStyle: "regular",
        border: "none"
    };
    Jw = x2
});
var S2 = k(() => {
    "use strict";
    _2()
});
var C2, k2, I2, P2, qw, T2, B2, Vg = k(() => {
    "use strict";
    Xd();
    C2 = e => Gt.post("/api/presets", {
        preset: e
    }), k2 = e => Gt.get("/api/presets", void 0, e && {
        signal: e
    }), I2 = (e, {
        ownerId: t,
        projectId: o
    }) => Gt.post("/api/presets/mypresets", {
        preset: e,
        projectId: o,
        ownerId: t
    }), P2 = ({
        projectId: e,
        ownerId: t
    }) => Gt.get("/api/presets/mypresets", {
        projectId: e,
        ownerId: t
    }), qw = (e, t) => Gt.put(`/api/presets/mypresets/${e}`, t), T2 = (e, t) => Gt.delete(`/api/presets/mypresets/${e}`, t), B2 = (e, t, o) => Gt.put("/api/presets/mypresets/rename-folder", {
        projectId: o,
        ids: e,
        name: t
    })
});
var Jce, Zp, ec, M2, XU, KU, R2, Gg, qce, Qce, ede, tde, Qw = k(() => {
    "use strict";
    Nc();
    Vg();
    [Jce, Zp, ec] = er({
        global: [],
        project: [],
        readymag: []
    }), [M2, XU, KU] = er([]), R2 = async ({
        signal: e,
        projectId: t,
        ownerId: o
    }) => {
        let i = ec(),
            n = KU();
        if (i && n.length) return;
        let [{
            presets: s,
            categories: a
        }, {
            global: l,
            project: c
        }] = await Promise.all([k2(e), P2({
            projectId: t,
            ownerId: o
        })]);
        XU(a), Zp({
            readymag: s,
            global: l,
            project: c
        })
    }, Gg = (e, t) => {
        let o = ec(),
            i = [...t, ...o[e]];
        Zp({ ...o,
            [e]: i
        })
    }, qce = ({
        type: e,
        id: t
    }, o) => {
        let i = ec(),
            s = i[e].map(a => a._id === t ? { ...a,
                ...o
            } : a);
        Zp({ ...i,
            [e]: s
        }), qw(t, { ...o,
            projectId: window.RM.constructorRouter.mag.get("_id")
        })
    }, Qce = ({
        type: e,
        id: t
    }) => {
        let o = ec(),
            n = o[e].filter(s => s._id !== t);
        Zp({ ...o,
            [e]: n
        }), T2(t, {
            projectId: window.RM.constructorRouter.mag.get("_id")
        })
    }, ede = (e, t, o) => {
        let i = ec(),
            n = i[t].find(l => l._id === e),
            s = i[o].map(l => l.position),
            a = s.length > 0 ? Math.min(...s) - 1 : 1;
        Zp({ ...i,
            [t]: i[t].filter(l => l._id !== e),
            [o]: [{ ...n,
                type: o,
                position: a
            }, ...i[o]]
        }), qw(e, {
            type: o,
            position: a,
            projectId: window.RM.constructorRouter.mag.get("_id")
        })
    }, tde = (e, t, o) => {
        let i = ec(),
            n = i[e].map(s => {
                if (t.includes(s._id) && s.name.includes("/")) {
                    let a = s.name.split("/")[1];
                    return { ...s,
                        name: `${o}/${a}`
                    }
                }
                return s
            });
        Zp({ ...i,
            [e]: n
        }), B2(t, o, window.RM.constructorRouter.mag.get("_id"))
    }
});
var Xp, E2, F2 = k(() => {
    "use strict";
    Xp = E(N());
    Li();
    ie();
    Be();
    ut();
    pi();
    B();
    E2 = ({
        targetSteps: e
    }) => {
        let [{
            step: t,
            showNotice: o
        }] = Wl(), [i, n] = (0, Xp.useState)(""), s = (0, Xp.useMemo)(() => t && e.includes(t.name), [e, t]), a = s || o;
        return (0, Xp.useEffect)(() => {
            if ((s || o) && t) {
                let {
                    fallbackText: l,
                    text: c
                } = t;
                n(l || (typeof c == "function" ? c() : c))
            }
        }, [s, o, t]), r(wo, {
            children: a ? r(wt.div, {
                style: {
                    position: "fixed",
                    left: "50%",
                    top: "16px",
                    transform: "translateX(-50%)",
                    zIndex: 3e3,
                    width: "fit-content"
                },
                initial: {
                    opacity: 0
                },
                animate: {
                    opacity: 1
                },
                exit: {
                    opacity: 0
                },
                children: r(b, {
                    display: "flex",
                    alignItems: "center",
                    height: 56,
                    borderRadius: 4,
                    padding: "8px 22px",
                    backgroundColor: ce.blue,
                    children: r($, {
                        color: ce.white,
                        fontSize: 12,
                        children: i
                    })
                })
            }) : null
        })
    }
});

function e7({
    children: e
}) {
    let t = Lv(ex),
        o = Lv(tx),
        i = t.get() / o.get(),
        n = (0, A2.useCallback)((s, a) => {
            let l = t.get() + a.delta.x;
            t.set(l), o.set(l / i)
        }, []);
    return r(wt.div, {
        drag: !0,
        dragMomentum: !1,
        whileTap: {
            cursor: "grabbing"
        },
        onClick: s => s.stopPropagation(),
        style: { ...qU,
            height: o,
            width: t
        },
        children: r(b, {
            width: "100%",
            height: "100%",
            paddingTop: "2rm",
            paddingLeft: "4rm",
            paddingRight: "4rm",
            paddingBottom: "4rm",
            borderRadius: "1rm",
            backgroundColor: "#0080FF",
            userSelect: "none",
            children: x(b, {
                display: "flex",
                gap: "2rm",
                flexDirection: "column",
                height: "100%",
                children: [r(wt.div, {
                    drag: !0,
                    dragMomentum: !1,
                    dragElastic: 0,
                    onDrag: n,
                    dragConstraints: JU,
                    style: QU,
                    children: r(b, {
                        height: "3rm",
                        width: "3rm",
                        backgroundColor: "#0080FF",
                        borderRadius: "50%"
                    })
                }), e]
            })
        })
    })
}

function t7() {
    return x(b, {
        display: "flex",
        justifyContent: "space-between",
        alignItems: "center",
        userSelect: "none",
        children: [r(Bo, {
            color: "white",
            children: "Getting started"
        }), x(b, {
            display: "flex",
            alignItems: "center",
            gap: "4rm",
            marginRight: "2rm",
            children: [r(b, {
                as: "a",
                href: "https://www.youtube.com/watch?v=YSxO3Lc2LKU",
                target: "_blank",
                children: r(oI, {
                    color: "white",
                    height: "5rm",
                    width: "5rm"
                })
            }), r(b, {
                cursor: "pointer",
                onClick: () => st("GettingStartedVideo"),
                children: r(Nt, {
                    color: "white",
                    height: "3rm",
                    width: "3rm"
                })
            })]
        })]
    })
}

function o7() {
    return x(Bo, {
        color: "white",
        weight: 500,
        fontSize: "3rm",
        userSelect: "none",
        children: ["In this video, you\u2019ll go through the basics of designing", r("br", {}), "a website in Readymag \u2014 watch, learn and repeat"]
    })
}

function i7() {
    return r(b, {
        display: "flex",
        flex: 1,
        userSelect: "none",
        children: r("iframe", {
            width: "100%",
            height: "100%",
            allowFullScreen: !0,
            src: "https://www.youtube.com/embed/YSxO3Lc2LKU?si=rOhUJWb92LjY3efJ&amp",
            title: "Readymag Getting Started Video",
            allow: "autoplay; clipboard-write; encrypted-media;",
            referrerPolicy: "strict-origin-when-cross-origin"
        })
    })
}

function n7() {
    return x(e7, {
        children: [r(t7, {}), r(o7, {}), r(i7, {})]
    })
}

function L2() {
    let [{
        step: e
    }] = Wl();
    return e ? .name !== "GettingStartedVideo" ? null : r(n7, {})
}
var A2, ex, tx, D2, JU, qU, QU, z2 = k(() => {
    "use strict";
    A2 = E(N());
    Li();
    ie();
    Be();
    td();
    pi();
    B();
    [ex, tx, D2] = [392, 344, 2], JU = {
        left: 0,
        right: 0,
        top: 0,
        bottom: 0
    }, qU = {
        zIndex: 1e5,
        position: "absolute",
        bottom: "16px",
        left: "calc(50% - 196px)",
        cursor: "grab",
        minHeight: tx,
        minWidth: ex,
        maxWidth: ex * D2,
        maxHeight: tx * D2
    }, QU = {
        position: "absolute",
        cursor: "ne-resize",
        right: -20,
        top: -20,
        padding: 16
    }
});
var Yg = un((vde, $2) => {
    "use strict";

    function r7(e) {
        var t = typeof e;
        return e != null && (t == "object" || t == "function")
    }
    $2.exports = r7
});
var O2 = un((wde, W2) => {
    "use strict";
    var s7 = typeof window == "object" && window && window.Object === Object && window;
    W2.exports = s7
});
var ox = un((xde, j2) => {
    "use strict";
    var a7 = O2(),
        l7 = typeof self == "object" && self && self.Object === Object && self,
        c7 = a7 || l7 || Function("return this")();
    j2.exports = c7
});
var N2 = un((_de, H2) => {
    "use strict";
    var d7 = ox(),
        p7 = function() {
            return d7.Date.now()
        };
    H2.exports = p7
});
var V2 = un((Sde, U2) => {
    "use strict";
    var u7 = /\s/;

    function h7(e) {
        for (var t = e.length; t-- && u7.test(e.charAt(t)););
        return t
    }
    U2.exports = h7
});
var Y2 = un((Cde, G2) => {
    "use strict";
    var m7 = V2(),
        f7 = /^\s+/;

    function g7(e) {
        return e && e.slice(0, m7(e) + 1).replace(f7, "")
    }
    G2.exports = g7
});
var ix = un((kde, Z2) => {
    "use strict";
    var b7 = ox(),
        y7 = b7.Symbol;
    Z2.exports = y7
});
var q2 = un((Ide, J2) => {
    "use strict";
    var X2 = ix(),
        K2 = Object.prototype,
        v7 = K2.hasOwnProperty,
        w7 = K2.toString,
        Gh = X2 ? X2.toStringTag : void 0;

    function x7(e) {
        var t = v7.call(e, Gh),
            o = e[Gh];
        try {
            e[Gh] = void 0;
            var i = !0
        } catch {}
        var n = w7.call(e);
        return i && (t ? e[Gh] = o : delete e[Gh]), n
    }
    J2.exports = x7
});
var eB = un((Pde, Q2) => {
    "use strict";
    var _7 = Object.prototype,
        S7 = _7.toString;

    function C7(e) {
        return S7.call(e)
    }
    Q2.exports = C7
});
var nB = un((Tde, iB) => {
    "use strict";
    var tB = ix(),
        k7 = q2(),
        I7 = eB(),
        P7 = "[object Null]",
        T7 = "[object Undefined]",
        oB = tB ? tB.toStringTag : void 0;

    function B7(e) {
        return e == null ? e === void 0 ? T7 : P7 : oB && oB in Object(e) ? k7(e) : I7(e)
    }
    iB.exports = B7
});
var sB = un((Bde, rB) => {
    "use strict";

    function M7(e) {
        return e != null && typeof e == "object"
    }
    rB.exports = M7
});
var lB = un((Mde, aB) => {
    "use strict";
    var R7 = nB(),
        E7 = sB(),
        F7 = "[object Symbol]";

    function D7(e) {
        return typeof e == "symbol" || E7(e) && R7(e) == F7
    }
    aB.exports = D7
});
var uB = un((Rde, pB) => {
    "use strict";
    var A7 = Y2(),
        cB = Yg(),
        L7 = lB(),
        dB = NaN,
        z7 = /^[-+]0x[0-9a-f]+$/i,
        $7 = /^0b[01]+$/i,
        W7 = /^0o[0-7]+$/i,
        O7 = parseInt;

    function j7(e) {
        if (typeof e == "number") return e;
        if (L7(e)) return dB;
        if (cB(e)) {
            var t = typeof e.valueOf == "function" ? e.valueOf() : e;
            e = cB(t) ? t + "" : t
        }
        if (typeof e != "string") return e === 0 ? e : +e;
        e = A7(e);
        var o = $7.test(e);
        return o || W7.test(e) ? O7(e.slice(2), o ? 2 : 8) : z7.test(e) ? dB : +e
    }
    pB.exports = j7
});
var fB = un((Ede, mB) => {
    "use strict";
    var H7 = Yg(),
        nx = N2(),
        hB = uB(),
        N7 = "Expected a function",
        U7 = Math.max,
        V7 = Math.min;

    function G7(e, t, o) {
        var i, n, s, a, l, c, d = 0,
            p = !1,
            h = !1,
            u = !0;
        if (typeof e != "function") throw new TypeError(N7);
        t = hB(t) || 0, H7(o) && (p = !!o.leading, h = "maxWait" in o, s = h ? U7(hB(o.maxWait) || 0, t) : s, u = "trailing" in o ? !!o.trailing : u);

        function m(T) {
            var P = i,
                M = n;
            return i = n = void 0, d = T, a = e.apply(M, P), a
        }

        function f(T) {
            return d = T, l = setTimeout(S, t), p ? m(T) : a
        }

        function g(T) {
            var P = T - c,
                M = T - d,
                F = t - P;
            return h ? V7(F, s - M) : F
        }

        function y(T) {
            var P = T - c,
                M = T - d;
            return c === void 0 || P >= t || P < 0 || h && M >= s
        }

        function S() {
            var T = nx();
            if (y(T)) return w(T);
            l = setTimeout(S, g(T))
        }

        function w(T) {
            return l = void 0, u && i ? m(T) : (i = n = void 0, a)
        }

        function v() {
            l !== void 0 && clearTimeout(l), d = 0, i = c = n = l = void 0
        }

        function C() {
            return l === void 0 ? a : w(nx())
        }

        function I() {
            var T = nx(),
                P = y(T);
            if (i = arguments, n = this, c = T, P) {
                if (l === void 0) return f(c);
                if (h) return clearTimeout(l), l = setTimeout(S, t), m(c)
            }
            return l === void 0 && (l = setTimeout(S, t)), a
        }
        return I.cancel = v, I.flush = C, I
    }
    mB.exports = G7
});
var bB = un((Fde, gB) => {
    "use strict";
    var Y7 = fB(),
        Z7 = Yg(),
        X7 = "Expected a function";

    function K7(e, t, o) {
        var i = !0,
            n = !0;
        if (typeof e != "function") throw new TypeError(X7);
        return Z7(o) && (i = "leading" in o ? !!o.leading : i, n = "trailing" in o ? !!o.trailing : n), Y7(e, t, {
            leading: i,
            maxWait: t,
            trailing: n
        })
    }
    gB.exports = K7
});

function vB({
    message: e,
    closeBtn: t = !1,
    helpBtn: o = !0,
    withLoader: i = !1,
    isTip: n = !0,
    visible: s,
    variant: a = "lightGray",
    onClose: l,
    onSettingsClick: c,
    ...d
}) {
    let [p, h] = (0, yB.useState)(!1);
    return r(Q, {
        children: n && s ? r(wo, {
            children: e ? x(wt.div, {
                style: {
                    display: "flex"
                },
                initial: {
                    y: "100%"
                },
                animate: {
                    y: "0%"
                },
                exit: {
                    opacity: 0,
                    position: "absolute"
                },
                transition: {
                    duration: .2
                },
                children: [r(b, {
                    display: "flex",
                    lineHeight: "1.5",
                    backgroundColor: "orange",
                    padding: "0 72px 0 20px",
                    alignItems: "center",
                    opacity: .9,
                    zIndex: -1,
                    ...d,
                    borderRadius: "8px",
                    position: "relative",
                    left: "56px",
                    whiteSpace: "nowrap",
                    backdropFilter: "blur(3px)",
                    children: r($, {
                        color: "black",
                        textStyle: "small",
                        children: e
                    })
                }), t && r(K, {
                    onClick: l,
                    width: 56,
                    height: 56,
                    borderRadius: "8px",
                    backgroundColor: "black",
                    boxSizing: "content-box",
                    css: Z `
                    &:hover {
                      background: rgba(40, 40, 40, 0.4);
                    }
                  `,
                    children: r($, {
                        textStyle: "small",
                        color: "white",
                        textAlign: "center",
                        children: "OK"
                    })
                }), o && r(b, {
                    display: "flex",
                    onClick: c,
                    width: 56,
                    height: 56,
                    borderRadius: "8px",
                    backgroundColor: "lightGray",
                    alignItems: "center",
                    opacity: .9,
                    justifyContent: "center",
                    cursor: "pointer",
                    onMouseEnter: () => h(!0),
                    onMouseLeave: () => h(!1),
                    backdropFilter: "blur(3px)",
                    children: r(Za, {
                        color: p ? "black" : "darkGray"
                    })
                })]
            }) : null
        }) : r(Q, {
            children: s && x(J7, {
                variant: a,
                withLoader: i,
                message: e,
                ...d,
                children: [o && x(K, {
                    display: "flex",
                    onClick: c,
                    width: 16,
                    height: 16,
                    margin: "auto 0 auto 20px",
                    alignSelf: "center",
                    children: ["\u200E", r(Za, {
                        color: "gray"
                    })]
                }), t && r(K, {
                    variant: "unstyled",
                    background: "gray",
                    onClick: l,
                    width: 12,
                    height: 12,
                    padding: "6px",
                    margin: "auto 0 auto 12px",
                    borderRadius: "12px",
                    color: "white",
                    boxSizing: "content-box",
                    css: Z `
                    &:hover {
                      background: #ec520b;
                    }
                  `,
                    children: r(Nt, {
                        color: "white"
                    })
                })]
            })
        })
    })
}

function J7(e) {
    let {
        children: t,
        variant: o,
        withLoader: i,
        message: n,
        ...s
    } = e, a = typeof n == "string";
    return r(Q, {
        children: o === "lightGray" ? x(b, {
            lineHeight: "1.5",
            backgroundColor: "lightGray",
            color: "tomato",
            padding: "16px 24px",
            borderRadius: "8px",
            ...s,
            whiteSpace: "nowrap",
            display: "flex",
            children: [r(Q, {
                children: n
            }), t]
        }) : ["bluePill", "redPill"].includes(o) ? x(b, {
            height: "56px",
            backgroundColor: o === "redPill" ? ce.red : ce.blue,
            borderRadius: "36px",
            padding: "0px 16px",
            alignItems: "center",
            display: "flex",
            children: [i && r(b, {
                marginLeft: "-16px",
                padding: "0 16px",
                children: r(_o, {
                    bgColor: "blue",
                    color: "white",
                    size: 26
                })
            }), a ? r($, {
                color: "white",
                fontSize: "16px",
                fontWeight: "500",
                children: n
            }) : r(Q, {
                children: n
            }), t]
        }) : r(b, {})
    })
}
var yB, wB = k(() => {
    "use strict";
    yB = E(N());
    Li();
    ie();
    Be();
    je();
    Rf();
    Ts();
    Bs();
    ve();
    ut();
    B()
});
var Zde, xB, Xde, _B = k(() => {
    "use strict";
    Nc();
    [Zde, xB, Xde] = er(!1)
});
var bd, q7, Q7, rx, sx, ipe, ax = k(() => {
    "use strict";
    bd = E(N());
    Nc();
    _B();
    qt();
    pi();
    aj();
    B();
    q7 = () => jC("_rm_start_with_preset_demo") ? (HC("_rm_start_with_preset_demo"), {
        name: "widget-selector",
        payload: {
            showPresetDemoTooltip: !0
        }
    }) : {
        name: void 0
    }, [Q7, rx] = er(q7()), sx = (0, bd.createContext)({
        isVisible: !1,
        currentPanel: void 0,
        togglePanel: e => {},
        openPanel: e => {},
        closePanels: () => {},
        setPayload: () => {}
    }), ipe = ({
        router: e,
        widgetbar: t,
        children: o
    }) => {
        let [i, n] = (0, bd.useState)(() => t ? .get("isVisible")), [s, a] = Q7(), l = cp(), c = () => {
            switch (s.name) {
                case "stackpanel":
                    mn(["OpenBackgroundLayer", "MobileMenuVisible"], {
                        show: !0
                    });
                    break;
                case "guides":
                    mn(["ClickOnSizesButton", "ClickOnSnapButton"], {
                        show: !0
                    });
                    break;
                case "modes":
                    mn("TurnOnTheBlocksMode", {
                        show: !0
                    });
                    break;
                case "viewports":
                    mn("SwitchToMobileLayout", {
                        show: !0
                    });
                    break;
                case "viewer-settings":
                    mn(["SwitchToDesktop", "UseCustomCursor", "PointerCursorUpload"], {
                        show: !0
                    });
                    break
            }
            a({ ...s,
                name: void 0,
                payload: void 0
            })
        }, d = (u, m) => {
            switch (u) {
                case "stackpanel":
                    st(["OpenLayersPanel", "FindVisibleMobileMenu"]), l.step ? .name === "OpenBackgroundLayer" && mn("OpenBackgroundLayer", {
                        show: !1
                    }), mn("MobileMenuVisible", {
                        show: !1
                    });
                    break;
                case "viewer-settings":
                    st(["ViewerSettings"]), mn(["SwitchToDesktop", "UseCustomCursor", "PointerCursorUpload"], {
                        show: !1
                    });
                    break;
                case "guides":
                    s.name || st(["SelectGrids"]), l.step ? .name === "ClickOnSnapButton" && mn("ClickOnSnapButton", {
                        show: !1
                    }), l.step ? .name === "ClickOnSizesButton" && mn("ClickOnSizesButton", {
                        show: !1
                    });
                    break;
                case "modes":
                    mn(["TurnOnTheBlocksMode"], {
                        show: !1
                    });
                    break;
                case "viewports":
                    mn("SwitchToMobileLayout", {
                        show: !1
                    });
                    break;
                case "help":
                    De(Fe.EditorHelp, {
                        action: "help panel open"
                    });
                    break
            }
            a({ ...s,
                name: u,
                payload: m
            })
        }, p = (u, m = !0) => {
            s.name === u ? c() : (d(u), u === "stackpanel" && st(["OpenLayersPanel"])), m && e.popupPanels.togglePanel(u)
        }, h = u => {
            let m = s.payload,
                f = m ? { ...m,
                    ...u
                } : u;
            a({
                name: s.name,
                payload: f
            })
        };
        return (0, bd.useEffect)(() => {
            function u(m, f) {
                n(f)
            }
            return t ? .on("change:isVisible", u), () => {
                t ? .off("change:isVisible", u)
            }
        }, [t]), r(sx.Provider, {
            value: {
                currentPanel: s.name,
                panelPayload: s.payload,
                openPanel: d,
                closePanels: c,
                togglePanel: p,
                setPayload: h,
                isVisible: i
            },
            children: o
        })
    };
    window.addEventListener("start_presets_demo", () => {
        xB(!1), window.RM.constructorRouter.whatsNewPopupsRoot ? .unmount(), rx({
            name: "widget-selector",
            payload: {
                showPresetDemoTooltip: !0
            }
        })
    })
});

function lx({
    isActive: e,
    withTransition: t,
    width: o = 46,
    height: i = 46
}) {
    let {
        isHovered: n,
        ...s
    } = nr();
    return x("svg", {
        width: o,
        height: i,
        viewBox: "0 0 46 46",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        style: {
            position: "relative",
            top: -1
        },
        ...t ? s : {},
        children: [x("g", {
            style: {
                transition: "0.3s ease",
                transformOrigin: "center",
                transform: `rotate(${n?16:0}deg)`
            },
            children: [r("path", {
                d: "M11.4976 16.9335C10.812 14.6457 12.9447 12.513 15.2325 13.1986L29.5697 17.4949C31.7445 18.1467 32.4353 20.8846 30.8298 22.49L20.789 32.5308C19.1835 34.1363 16.4456 33.4455 15.7939 31.2707L11.4976 16.9335Z",
                stroke: "white",
                strokeWidth: "2"
            }), r("path", {
                d: "M26.1631 27.864L33.527 35.228",
                stroke: "white",
                strokeWidth: "2",
                strokeLinecap: "round"
            })]
        }), e ? r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M38 5H40H42V4C42 2.89543 41.1046 2 40 2C38.8954 2 38 2.89543 38 4V5ZM44 5C45.1046 5 46 5.89543 46 7V12C46 13.1046 45.1046 14 44 14H36C34.8954 14 34 13.1046 34 12V7C34 5.89543 34.8954 5 36 5V4C36 1.79086 37.7909 0 40 0C42.2091 0 44 1.79086 44 4V5Z",
            fill: "white"
        }) : null]
    })
}
var SB = k(() => {
    "use strict";
    od();
    B()
});

function CB({
    withTransition: e,
    isActive: t,
    width: o,
    height: i
}) {
    let {
        isHovered: n,
        ...s
    } = nr();
    return x("svg", {
        width: o || "26",
        height: i || "24",
        viewBox: "0 0 26 24",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        display: "block",
        ...e ? s : {},
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M-4.37114e-08 23C-1.95702e-08 23.5523 0.447716 24 1 24L25 24C25.5523 24 26 23.5523 26 23C26 22.4477 25.5523 22 25 22L0.999999 22C0.447715 22 -6.78525e-08 22.4477 -4.37114e-08 23ZM-1.00536e-06 1C-9.81221e-07 1.55228 0.447716 2 1 2L25 2C25.5523 2 26 1.55228 26 0.999999C26 0.447715 25.5523 7.90423e-07 25 8.14564e-07L1 1.86364e-06C0.447715 1.88778e-06 -1.0295e-06 0.447716 -1.00536e-06 1Z",
            fill: "white"
        }), r("rect", {
            opacity: t || n ? "0" : "0.32",
            y: "24",
            width: "24",
            height: "26",
            rx: "1",
            transform: "rotate(-90 0 24)",
            fill: "white",
            style: {
                transition: ".3s ease"
            }
        })]
    })
}
var kB = k(() => {
    "use strict";
    od();
    B()
});
var IB, PB = k(() => {
    "use strict";
    IB = (e, t, o) => o ? `${(o.height-parseInt(t,10))/2}px ${(o.width-parseInt(e,10))/2}px` : void 0
});
var TB, BB = k(() => {
    "use strict";
    PB();
    B();
    TB = ({
        id: e = "settingsIcon",
        width: t,
        height: o,
        hoverBox: i
    }) => {
        let n = IB(t, o, i);
        return x("svg", {
            id: e,
            viewBox: "0 0 24 24",
            fill: "none",
            xmlns: "http://www.w3.org/2000/svg",
            width: t,
            height: o,
            style: {
                padding: n
            },
            children: [r("rect", {
                x: "1",
                y: "1",
                width: "22",
                height: "8",
                rx: "4",
                stroke: "currentColor",
                strokeWidth: "2"
            }), x("circle", {
                cx: "5",
                cy: "5",
                r: "2",
                fill: "currentColor",
                children: [r("animate", {
                    attributeName: "cx",
                    to: "19",
                    dur: "0.2s",
                    repeatCount: "1",
                    fill: "freeze",
                    begin: `${e}.mouseenter`,
                    calcMode: "spline",
                    keySplines: "0.42 0 1 1"
                }), r("animate", {
                    attributeName: "cx",
                    to: "5",
                    dur: "0.2s",
                    repeatCount: "1",
                    fill: "freeze",
                    begin: `${e}.mouseleave`,
                    calcMode: "spline",
                    keySplines: "0.42 0 1 1"
                })]
            }), r("rect", {
                x: "1",
                y: "15",
                width: "22",
                height: "8",
                rx: "4",
                stroke: "currentColor",
                strokeWidth: "2"
            }), x("circle", {
                cx: "19",
                cy: "19",
                r: "2",
                fill: "currentColor",
                children: [r("animate", {
                    attributeName: "cx",
                    to: "5",
                    dur: "0.2s",
                    repeatCount: "1",
                    fill: "freeze",
                    begin: `${e}.mouseenter`,
                    calcMode: "spline",
                    keySplines: "0.42 0 1 1"
                }), r("animate", {
                    attributeName: "cx",
                    to: "19",
                    dur: "0.2s",
                    repeatCount: "1",
                    fill: "freeze",
                    begin: `${e}.mouseleave`,
                    calcMode: "spline",
                    keySplines: "0.42 0 1 1"
                })]
            })]
        })
    }
});
var MB, RB, EB = k(() => {
    "use strict";
    MB = E(N());
    B();
    RB = (0, MB.forwardRef)((e, t) => x("svg", {
        width: "12",
        height: "12",
        viewBox: "0 0 12 12",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ref: t,
        ...e,
        children: [r("circle", {
            opacity: "0.96",
            cx: "6",
            cy: "6",
            r: "6",
            fill: "white"
        }), r("path", {
            d: "M8.14258 2.57129L8.14258 8.57129H7.71433L7.71433 2.57129H8.14258Z",
            fill: "#0080FF"
        }), r("path", {
            d: "M4.89927 8.6469C5.50195 8.6469 5.97907 8.38742 6.24693 7.92704H6.31808V8.57157H7.21791V5.46191C7.21791 4.50767 6.57338 3.93848 5.4308 3.93848C4.39704 3.93848 3.68136 4.43652 3.57254 5.1815L3.56836 5.2108H4.44308L4.44727 5.19406C4.55608 4.87179 4.88672 4.68764 5.38895 4.68764C6.00419 4.68764 6.31808 4.96387 6.31808 5.46191V5.8637L5.08761 5.93485C4.00363 6.00181 3.39258 6.47475 3.39258 7.28669V7.29506C3.39258 8.11956 4.03292 8.6469 4.89927 8.6469ZM4.2966 7.25739V7.24902C4.2966 6.83887 4.58119 6.61286 5.20898 6.5752L6.31808 6.50405V6.89328C6.31808 7.47921 5.82003 7.92285 5.14202 7.92285C4.65234 7.92285 4.2966 7.67592 4.2966 7.25739Z",
            fill: "#0080FF"
        })]
    }))
});
var FB, DB, AB = k(() => {
    "use strict";
    FB = E(N());
    B();
    DB = (0, FB.forwardRef)((e, t) => x("svg", {
        width: "17",
        height: "16",
        viewBox: "0 0 17 16",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ref: t,
        ...e,
        children: [r("rect", {
            x: "0.5",
            width: "16",
            height: "16",
            rx: "8",
            fill: "white"
        }), x("g", {
            clipPath: "url(#clip0_175_8480)",
            children: [r("path", {
                fillRule: "evenodd",
                clipRule: "evenodd",
                d: "M9.3505 5.02691L10.6495 5.77691L9.44705 9.70146L6.56549 8.03779L9.3505 5.02691Z",
                fill: "#0080FF"
            }), r("path", {
                fillRule: "evenodd",
                clipRule: "evenodd",
                d: "M8.43303 9.11602L6.49444 12.0068C6.41622 12.1237 6.26073 12.1599 6.13891 12.0896C6.01709 12.0192 5.9707 11.8665 6.03284 11.7403L7.56701 8.61602L8.43303 9.11602Z",
                fill: "#0080FF"
            }), r("path", {
                d: "M8.51797 3.9689C8.65604 3.72976 8.96184 3.64782 9.20098 3.78589L11.7991 5.28589C12.0382 5.42396 12.1201 5.72976 11.9821 5.9689C11.844 6.20805 11.5382 6.28999 11.2991 6.15191L8.70098 4.65191C8.46184 4.51384 8.3799 4.20805 8.51797 3.9689Z",
                fill: "#0080FF"
            }), r("path", {
                d: "M5.21893 6.683C5.357 6.44386 5.6628 6.36192 5.90195 6.49999L11.0981 9.49999C11.3372 9.63806 11.4192 9.94386 11.2811 10.183C11.143 10.4221 10.8372 10.5041 10.5981 10.366L5.40195 7.36602C5.1628 7.22794 5.08086 6.92215 5.21893 6.683Z",
                fill: "#0080FF"
            })]
        }), r("defs", {
            children: r("clipPath", {
                id: "clip0_175_8480",
                children: r("rect", {
                    width: "7",
                    height: "9",
                    fill: "white",
                    transform: "translate(7.46893 2.78589) rotate(30)"
                })
            })
        })]
    }))
});

function rM() {
    return r(Oo, {
        children: "You can choose a new template here"
    })
}
var LB, zB, $B, WB, OB, jB, HB, NB, UB, VB, GB, YB, ZB, XB, KB, JB, qB, QB, eM, tM, oM, iM, nM, sM = k(() => {
    "use strict";
    ie();
    Be();
    ve();
    fH();
    bI();
    SB();
    kB();
    BB();
    pj();
    Mt();
    EB();
    AB();
    B();
    LB = () => x(Oo, {
        children: ["Tap on the ", r(fi, {
            children: "plus"
        }), " icon to add your first widget"]
    }), zB = () => x(b, {
        display: "flex",
        position: "relative",
        children: [x(Oo, {
            children: ["To adjust gaps between widgets", r("br", {}), "or copy parts as blocks tap"]
        }), r(b, {
            position: "absolute",
            top: 18,
            right: 10,
            children: r(CB, {
                width: "14px",
                height: "13px"
            })
        })]
    }), $B = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["To stack pages vertically press ", r(fi, {
                children: "P"
            }), " and then", " ", r(fi, {
                children: "Viewer settings"
            }), r(b, {
                display: "inline-flex",
                alignItems: "center",
                position: "relative",
                width: "17px",
                children: r(b, {
                    position: "absolute",
                    top: "-16px",
                    left: "-1px",
                    children: r(sI, {
                        color: "white",
                        width: "22px",
                        height: "24px"
                    })
                })
            })]
        })
    }), WB = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["To apply ", r(fi, {
                children: "Text styles"
            }), " open ", r(fi, {
                children: "Text settings"
            }), ",", r("br", {}), "tap ", r(fi, {
                children: "Typography"
            }), " ", r(b, {
                display: "inline-flex",
                alignItems: "center",
                alignSelf: "center",
                justifyContent: "center",
                width: 12,
                height: 12,
                backgroundColor: "white",
                borderRadius: "100%",
                position: "relative",
                top: "-2px",
                children: r(_h, {
                    color: "blue",
                    width: "6px",
                    height: "6px"
                })
            })]
        })
    }), OB = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["To apply ", r(fi, {
                children: "Text styles"
            }), " open", " ", x(fi, {
                children: ["Text", r("br", {}), "settings"]
            }), ", press ", r(fi, {
                children: "Edit"
            }), " control", r(b, {
                display: "inline-flex",
                alignItems: "center",
                position: "relative",
                left: "5px",
                top: "1px",
                children: r(RB, {})
            }), r("br", {}), "and then ", r(fi, {
                children: "Typography"
            }), " ", r(b, {
                display: "inline-flex",
                alignItems: "center",
                alignSelf: "center",
                justifyContent: "center",
                width: 12,
                height: 12,
                backgroundColor: "white",
                borderRadius: "100%",
                position: "relative",
                top: "-2px",
                children: r(_h, {
                    color: "blue",
                    width: "6px",
                    height: "6px"
                })
            })]
        })
    }), jB = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["Discuss issues, assign tasks or leave feedback using ", r(fi, {
                children: "Comments"
            }), ".", r("br", {}), "Click on ", r(fi, {
                children: "Modes"
            }), r(b, {
                display: "inline-flex",
                alignItems: "center",
                position: "relative",
                left: "-2px",
                top: "6px",
                children: r(lx, {
                    width: 20,
                    height: 20
                })
            }), "and enter the ", r(fi, {
                children: "Comments"
            }), " mode"]
        })
    }), HB = () => x(Oo, {
        children: ["Press ", r(fi, {
            children: "Cmd + Z"
        }), " keys to undo changes"]
    }), NB = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["Add HTML, JavaScript, and CSS code to customize your", r("br", {}), "project. Click on ", r(fi, {
                children: "Project settings"
            }), r(b, {
                display: "inline-flex",
                alignItems: "center",
                position: "relative",
                margin: "0 7.5px 0 3.5px",
                top: "2px",
                children: r(TB, {
                    width: "12px",
                    height: "12px"
                })
            }), "and go to ", r(fi, {
                children: "Code"
            }), " panel"]
        })
    }), UB = () => x(Oo, {
        children: ["Click on icons to tune the selected", r("br", {}), "widget to your needs"]
    }), VB = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["Drag", r(b, {
                display: "inline-block",
                width: "9.8px",
                height: "9.8px",
                background: "#fff",
                borderRadius: "2px",
                transform: "rotate(45deg)",
                margin: "0 5px"
            }), "at the bottom of the page to increase page height"]
        })
    }), GB = () => x(Oo, {
        children: ["Click on ", r(fi, {
            children: "Color"
        }), " control to tune", r("br", {}), "or add colors to the palette"]
    }), YB = () => x(Oo, {
        children: ["Check", " ", r($, {
            as: "a",
            textStyle: "small",
            textDecoration: "underline",
            color: "white",
            href: `${de.readymag_auth_host}/?guidance-kit=true`,
            target: "_blank",
            css: Z `
        &:hover {
          text-decoration: none;
        }
      `,
            children: "the R/m onboarding kit"
        }), " ", "to get hold of the essentials"]
    }), ZB = () => x(Oo, {
        children: ["Please note that the widget still exists in the desktop version of your project", r("br", {}), "since the desktop version is the source one.", " ", r($, {
            as: "a",
            textStyle: "small",
            textDecoration: "underline",
            color: "white",
            href: "https://help.readymag.com/hc/en-us/articles/360017434772",
            target: "_blank",
            css: Z `
        &:hover {
          text-decoration: none;
        }
      `,
            children: "Learn more about layouts"
        })]
    }), XB = () => x(Oo, {
        children: ["Did you know that we have a vast base of educationals", r("br", {}), "from articles on features to training sessions?", " ", r($, {
            as: "a",
            textStyle: "small",
            textDecoration: "underline",
            color: "white",
            href: "https://readymag.com/learn",
            target: "_blank",
            css: Z `
        &:hover {
          text-decoration: none;
        }
      `,
            children: "Hop on!"
        })]
    }), KB = () => x(Oo, {
        children: ["Animate widgets, change their opacity, scale ", r("br", {}), "or position.", " ", r($, {
            as: "a",
            textStyle: "small",
            textDecoration: "underline",
            color: "white",
            href: "https://www.youtube.com/watch?v=Z21sbyccFPk",
            target: "_blank",
            css: Z `
        &:hover {
          text-decoration: none;
        }
      `,
            children: "Check the tutorial"
        }), " ", "for details"]
    }), JB = () => x(Oo, {
        children: ["Drag a widget and everything below it as a group:", r("br", {}), "click on the widget and press F + Shift + \u2191/\u2193 or F + drag"]
    }), qB = () => x(Oo, {
        children: ["\u2018Fix\u2019 any widget to the edge of your page, corners or its center:", r("br", {}), "go to widget settings and click on ", r(fi, {
            children: "Position"
        }), " control", " ", r(b, {
            display: "inline-flex",
            alignItems: "center",
            position: "relative",
            left: "3px",
            top: "4px",
            children: r(DB, {})
        })]
    }), QB = () => r(Oo, {
        children: "Arrange layout of selected widgets"
    }), eM = () => x(Oo, {
        children: ["Enable the ", r(fi, {
            children: "Above Pages"
        }), " toggle to make", r("br", {}), "your fixed widgets float over all pages"]
    }), tM = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["Use ", r(fi, {
                children: "Grids"
            }), " to align your design.", r("br", {}), "Learn more", " ", r($, {
                as: "a",
                textStyle: "small",
                textDecoration: "underline",
                color: "white",
                href: `${de.readymag_auth_host}/start-with-template/3982583`,
                target: "_blank",
                css: Z `
          &:hover {
            text-decoration: none;
          }
        `,
                children: "in the tutorial"
            })]
        })
    }), oM = () => r(b, {
        display: "flex",
        pointerEvents: "all",
        children: x(Oo, {
            children: ["Save time and edit the properties of these", r("br", {}), "widgets at once.", " ", r($, {
                as: "a",
                textStyle: "small",
                textDecoration: "underline",
                color: "white",
                href: "https://help.readymag.com/hc/en-us/articles/16915363150619-Group-editing-of-widgets",
                target: "_blank",
                css: Z `
          &:hover {
            text-decoration: none;
          }
        `,
                children: "Learn how it works"
            })]
        })
    }), iM = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["Save your time with Presets\u2014ready-made animations,", r("br", {}), "popups, navigation elements and more"]
        })
    }), nM = () => r(b, {
        display: "flex",
        children: x(Oo, {
            children: ["You can hide a widget in the Editor so that", r("br", {}), "it won't clutter the layout while you design"]
        })
    })
});

function px({
    message: e,
    closeButton: t = !1
}) {
    let {
        triggerEduTipClose: o
    } = Ev();
    return x(Q, {
        children: [r(b, {
            display: "flex",
            alignItems: "center",
            onClick: i => {
                if (i.target && i.target instanceof HTMLElement && i.target.closest("a")) {
                    let s = a0(e);
                    s && De(Fe.EditorTips2, {
                        tip: s,
                        action: "click"
                    })
                }
                o()
            },
            cursor: "pointer",
            children: r($, {
                color: "white",
                textStyle: "small",
                children: oV(e)
            })
        }), t && r(K, {
            paddingLeft: "16px",
            onClick: () => {
                o()
            },
            children: r(b, {
                display: "flex",
                justifyContent: "center",
                alignItems: "center",
                width: "16px",
                height: "16px",
                borderRadius: "100%",
                backgroundColor: "#FFFBFB",
                children: r(Nt, {
                    widths: "10px",
                    height: "10px",
                    color: "blue"
                })
            })
        })]
    })
}

function Xpe() {
    let {
        openPanel: e
    } = (0, tc.useContext)(sx), [{
        message: t,
        visible: o,
        canBeClosed: i,
        needShowHelpIcon: n,
        isTipType: s,
        standAlone: a,
        router: l,
        variant: c,
        withLoader: d,
        placement: p
    }] = xf(), {
        triggerEduTip: h,
        triggerEduTipClose: u,
        hideNotice: m
    } = Ev(), f = l ? .me ? .get("edu_tips_state") || {}, g = !f.hasOwnProperty("eduTipUseOnboarding"), y = !f.hasOwnProperty("eduTipUseBlueDiamond"), [S, w] = (0, tc.useState)(null), v = () => {
        w(setTimeout(() => {
            I()
        }, 6e4))
    }, C = () => {
        S && clearTimeout(S), v()
    }, I = () => {
        h("eduTipUseOnboarding", {
            standAlone: !0
        })
    };
    return (0, tc.useEffect)(() => {
        if (g) return window.addEventListener("click", C), window.addEventListener("keydown", C), S || v(), () => {
            window.removeEventListener("click", C), window.removeEventListener("keydown", C), S && clearTimeout(S)
        }
    }, [S, g]), (0, tc.useEffect)(() => {
        let P = document.getElementById("main"),
            M = (0, lM.default)(() => {
                if (!P || !y) return;
                P.scrollHeight - P.scrollTop - P.clientHeight < 10 && h("eduTipUseBlueDiamond", {
                    standAlone: !0
                })
            }, 200);
        return P ? .addEventListener("scroll", M), () => {
            P ? .removeEventListener("scroll", M)
        }
    }, [y]), r(wo, {
        children: s ? a ? r(iV, {
            message: t,
            visible: o
        }) : null : nV({
            message: t,
            canBeClosed: i,
            visible: o,
            variant: c,
            withLoader: d,
            placement: p,
            needShowHelpIcon: n,
            isTipType: s,
            onClose: s ? u : m,
            openHelp: () => {
                e("help")
            }
        })
    })
}
var tc, aM, lM, cx, tV, oV, iV, nV, cM = k(() => {
    "use strict";
    tc = E(N()), aM = E(Tk());
    qt();
    lM = E(bB());
    Li();
    ut();
    je();
    td();
    Be();
    ie();
    ve();
    jr();
    wB();
    $l();
    ax();
    sM();
    B();
    cx = new Map, tV = e => {
        switch (e) {
            case "upgradeAccountToUse":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Upgrade your account"
                    }), " ", "to make the widget visible after the publication."]
                });
            case "unpauseSubscriptionToUse":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Unpause your subscription"
                    }), " ", "to make the widget visible after the publication."]
                });
            case "unpauseSubscriptionToCreatePage":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Unpause your subscription"
                    }), " ", "to create more pages."]
                });
            case "unpauseSubscriptionToUploadFonts":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Unpause your subscription"
                    }), " ", "to upload your own fonts."]
                });
            case "unpauseSubscriptionToCustomizeSeo":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Unpause your subscription"
                    }), " ", "to customize SEO parameters."]
                });
            case "unpauseSubscriptionToCustomizeSharing":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Unpause your subscription"
                    }), " ", "to customize social sharing info."]
                });
            case "unpauseSubscriptionToSearchNounIcons":
                return x($, {
                    color: "black",
                    children: [r(xs, {
                        as: "a",
                        color: "tomato",
                        href: "/settings#change-plan",
                        target: "_blank",
                        css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                        children: "Unpause your subscription"
                    }), " ", "to choose from all shapes."]
                });
            case "ecommHasInvalidAddToCartWidget":
                return "Some of the Add to cart buttons don't have attached products.";
            default:
                return e ? ? "Ooops! Something went wrong."
        }
    }, oV = e => {
        switch (e) {
            case "eduTipUsePlusIcon":
                return r(LB, {});
            case "eduTipUseBlocks":
                return r(zB, {});
            case "eduTipUseNavigation":
                return r($B, {});
            case "eduTipUseTextTypographyControl":
                return r(WB, {});
            case "eduTipUseTextEditControl":
                return r(OB, {});
            case "eduTipUseComments":
                return r(jB, {});
            case "eduTipUseUndo":
                return r(HB, {});
            case "eduTipUseCodePanel":
                return r(NB, {});
            case "eduTipUseWidgetSettings":
                return r(UB, {});
            case "eduTipUseBlueDiamond":
                return r(VB, {});
            case "eduTipUseColorPalette":
                return r(GB, {});
            case "eduTipUseOnboarding":
                return r(YB, {});
            case "eduTipOnDeleteMobileWidget":
                return r(ZB, {});
            case "eduTipUseLearn":
                return r(XB, {});
            case "eduTipUseAnimation":
                return r(KB, {});
            case "eduTipDragGroup":
                return r(JB, {});
            case "eduTipUseFix":
                return r(qB, {});
            case "eduTipUseArrangeControl":
                return r(QB, {});
            case "eduTipUseAbovePages":
                return r(eM, {});
            case "eduTipUseGrids":
                return r(tM, {});
            case "eduTipUseGroupEditing":
                return r(oM, {});
            case "eduTipUsePresets":
                return r(iM, {});
            case "eduTipUseHideWidget":
                return r(nM, {});
            case "eduTipNewTemplate":
                return r(rM, {});
            default:
                return e ? ? "Ooops! Something went wrong."
        }
    };
    iV = ({
        visible: e,
        message: t
    }) => ((0, tc.useEffect)(() => {
        let o = document.querySelector("#help-tour-notice");
        if (!o) return;
        let i = cx.get(o) || (0, aM.createRoot)(o);
        cx.has(o) || cx.set(o, i);
        let n = () => r(wo, {
            children: e ? r(wt.div, {
                initial: {
                    x: "-50%",
                    y: -100,
                    opacity: 0
                },
                animate: {
                    y: 0,
                    opacity: 1
                },
                exit: {
                    opacity: 0
                },
                transition: {
                    duration: .2
                },
                style: {
                    position: "fixed",
                    left: "50%",
                    top: "16px",
                    zIndex: 3e3,
                    width: "fit-content"
                },
                children: r(b, {
                    display: "flex",
                    borderRadius: 4,
                    backgroundColor: ce.blue,
                    padding: "8px 16px",
                    marginTop: 16,
                    justifyContent: "space-between",
                    textAlign: "center",
                    children: r(px, {
                        message: t
                    })
                })
            }) : null
        });
        i.render(n())
    }, [e, t]), null), nV = ({
        message: e,
        canBeClosed: t,
        visible: o,
        variant: i,
        placement: n,
        needShowHelpIcon: s,
        withLoader: a,
        isTipType: l,
        onClose: c,
        openHelp: d
    }) => r(wt.div, {
        style: {
            display: "flex",
            ...n === "center" ? {
                position: "fixed",
                left: 0,
                right: 0,
                justifyContent: "center"
            } : void 0
        },
        exit: {
            opacity: 0
        },
        children: e && r(vB, {
            message: tV(e),
            closeBtn: t,
            visible: o,
            variant: i,
            helpBtn: s,
            withLoader: a,
            isTip: l,
            onClose: c,
            onSettingsClick: d
        })
    })
});

function sue(e) {
    let t = e ? .name === "PictureWidgetSelect" || e ? .name === "ButtonWidgetSelect" ? [{
            name: "preventOverflow",
            options: {
                padding: {
                    left: 16
                }
            }
        }] : [{
            name: "preventOverflow",
            options: {
                padding: {
                    left: 16
                }
            }
        }, {
            name: "arrow",
            options: {
                padding: {
                    right: 357
                }
            }
        }],
        o = {};
    return e ? .name === "ButtonWidgetSelect" && (o = {
        tooltip: {
            top: 236
        }
    }), {
        modifiers: t,
        componentProps: o
    }
}

function ao({
    targetSteps: e,
    defaultText: t,
    defaultBg: o,
    position: i,
    indent: n,
    disabled: s,
    show: a,
    p: l = "8px 16px",
    children: c,
    delay: d,
    instance: p,
    leaveDelay: h,
    preventOverflow: u = 16,
    modifiers: m,
    closeOnTargetClick: f,
    skidding: g,
    eduTips: y,
    listenReferenceResize: S,
    popperRef: w,
    componentsProps: v = {},
    stepContext: C = {}
}) {
    let [{
        step: I,
        waiting: T
    }] = Wl(), P = (0, ar.useMemo)(() => Array.isArray(e) ? e : [e], [e]), M = (0, ar.useMemo)(() => !T && I && P ? .includes(I.name), [T, P, I]), [{
        visible: F,
        message: R
    }] = xf(), A = (0, ar.useMemo)(() => Array.isArray(y) ? y : [y], [y]), D = (0, ar.useMemo)(() => F && R && typeof R == "string" && A ? .includes(R), [F, R, A]), [O, L] = (0, ar.useState)(o), [W, z] = (0, ar.useState)(t), [V, X] = (0, ar.useState)(0), [q, ne] = (0, ar.useState)(l);
    (0, ar.useEffect)(() => {
        t !== W && z(t)
    }, [t]);
    let re = () => {
            window.RM.constructorRouter.trigger("notice:triggerEduTipClose")
        },
        te = () => r(b, {
            display: "flex",
            padding: "8px 0",
            justifyContent: "space-between",
            children: r(px, {
                message: R
            })
        }),
        ee = (0, ar.useMemo)(() => {
            if (a === !1) return !1;
            if (M || a || D) return !0;
            if (!t) return !1
        }, [M, a, D]);
    (0, ar.useEffect)(() => {
        if (M) {
            if (!I) {
                j();
                return
            }
            let {
                name: oe,
                text: U
            } = I;
            if (!P ? .find(xe => xe === oe)) {
                j();
                return
            }
            z(xe => {
                let pe = typeof U == "function" ? U(C) : U;
                return pe !== xe ? pe : xe
            }), L(xe => xe !== ce.blue ? ce.blue : xe), X(8)
        }
    }, [M, I, C, P]), (0, ar.useEffect)(() => {
        D ? (L(oe => oe !== ce.blue ? ce.blue : oe), z(oe => {
            let U = te();
            return U !== oe ? U : oe
        }), ne("0px 16px"), X(4)) : j()
    }, [D, R]);
    let j = () => {
            t && (z(t), L(o), ne(l))
        },
        se = 0;
    switch (I ? .name) {
        case "ButtonWidgetSelect":
            se = 2;
            break;
        case "ChangeGrids":
            se = -2;
            break
    }
    return r(et, {
        text: W,
        indent: n,
        placement: i,
        preventOverflow: u,
        enterDelay: d,
        leaveDelay: h,
        disabled: s && !M,
        open: ee,
        componentsProps: {
            tooltip: {
                top: 0,
                whiteSpace: "pre",
                backgroundColor: O,
                padding: q,
                ...v.tooltip,
                ...D && {
                    borderRadius: V
                }
            },
            arrow: { ...v.arrow,
                color: O,
                marginLeft: se
            }
        },
        instance: p,
        popperOptions: {
            modifiers: m
        },
        closeOnTargetClick: f && !M,
        skidding: g,
        disableHoverListeners: !!D,
        interactive: !!D,
        listenReferenceResize: S,
        popperRef: w,
        onClose: D ? re : void 0,
        children: c
    })
}
var ar, ux = k(() => {
    "use strict";
    ar = E(N());
    ie();
    ir();
    ut();
    $l();
    cM();
    pi();
    B()
});
var dM, rV, pM = k(() => {
    "use strict";
    dM = E(N());
    ux();
    Le();
    B();
    rV = () => {
        let {
            model: {
                position: e,
                steps: t,
                modifiers: o,
                indent: i,
                styles: n,
                skidding: s,
                eduTips: a,
                componentsProps: l
            }
        } = (0, dM.useContext)(ge);
        return r(ao, {
            targetSteps: t,
            indent: i,
            position: e,
            modifiers: o,
            skidding: s,
            eduTips: a,
            componentsProps: l,
            children: r("div", {
                style: n
            })
        })
    }
});
var Zg, sV, uM = k(() => {
    "use strict";
    Zg = E(N());
    Uc();
    ut();
    ie();
    je();
    td();
    pi();
    B();
    sV = ({
        onStop: e
    }) => {
        let [{
            step: t,
            started: o,
            totalSteps: i,
            config: n
        }] = Wl(), [s, a] = (0, Zg.useState)(!1), l = () => a(d => !d), c = (0, Zg.useMemo)(() => Fn(.08, s ? ce.black : ce.blue), [s]);
        return !o || n.headlessMode ? null : x(b, {
            display: "flex",
            alignItems: "center",
            height: 56,
            padding: "0 22px",
            margin: "0 12px",
            borderRadius: 8,
            backgroundColor: c,
            children: [r(b, {
                children: [...Array(i)].map((d, p) => r(b, {
                    display: "inline-block",
                    width: 2,
                    height: 24,
                    marginRight: 4,
                    borderRadius: 2,
                    opacity: t && t.num < p + 1 ? .2 : 1,
                    backgroundColor: "white",
                    transition: "opacity 0.1s ease 0s"
                }, p))
            }), r(K, {
                variant: "clean",
                marginLeft: 20,
                onClick: e,
                onMouseEnter: l,
                onMouseLeave: l,
                children: r(Nt, {
                    color: ce.white
                })
            })]
        })
    }
});

function Tue(e, t) {
    (0, hx.createRoot)(e).render(r(E2, {
        targetSteps: t
    }))
}

function Bue(e) {
    (0, hx.createRoot)(e).render(r(L2, {}))
}
var hx, Fs = k(() => {
    "use strict";
    hx = E(Tk());
    F2();
    z2();
    ux();
    pM();
    uM();
    B()
});
var lr, hM, aV, lV, ke, mM = k(() => {
    "use strict";
    lr = E(N());
    ie();
    Li();
    hM = E(Wj());
    ae();
    Le();
    Fs();
    B();
    aV = (0, lr.forwardRef)(({
        children: e,
        onClick: t,
        onMouseEnter: o,
        onMouseLeave: i,
        label: n,
        helpTourSteps: s,
        figure: a = "circle",
        disableHover: l = !1,
        isActive: c = !1,
        isMixed: d,
        customBackground: p,
        size: h,
        withButton: u = !0
    }, m) => {
        let {
            destroy: f
        } = (0, lr.useContext)(ge), {
            model: g
        } = (0, lr.useContext)(Y), [y, S] = (0, lr.useState)(!1), w = (0, lr.useCallback)(T => {
            t && t(T)
        }, [t]), v = (0, lr.useCallback)(T => {
            l || S(!1), i && i(T)
        }, [i]), C = (0, lr.useCallback)(T => {
            l || S(!0), o && o(T)
        }, [o]), I = (0, lr.useMemo)(() => g.disabled ? "rgba(68, 68, 76, 0.95)" : p || (!y && !c ? "rgba(68, 68, 76, 0.95)" : d ? "linear-gradient(90deg, rgba(0, 128, 255,1) 50%, rgba(68, 68, 76, 0.95) 50%)" : "rgba(0, 128, 255, 1)"), [g.disabled, c, y, d, p]);
        return r(b, {
            ref: m,
            width: h || 30,
            height: h || 30,
            onMouseEnter: C,
            onMouseLeave: v,
            children: r(wo, {
                onExitComplete: () => f(),
                children: g.visible && r(wt.div, {
                    transition: {
                        duration: .2
                    },
                    initial: {
                        opacity: 0,
                        x: 7
                    },
                    animate: {
                        opacity: 1,
                        x: 0
                    },
                    exit: {
                        opacity: 0,
                        x: -7
                    },
                    children: r(ao, {
                        indent: 8,
                        position: "left",
                        closeOnTargetClick: !0,
                        defaultText: n,
                        disabled: g.selected,
                        targetSteps: s,
                        componentsProps: {
                            tooltip: {
                                maxWidth: 175,
                                whiteSpace: "initial"
                            }
                        },
                        children: u ? r(b, {
                            display: "flex",
                            as: "button",
                            width: 30,
                            height: 30,
                            borderRadius: a === "circle" ? "50%" : a === "square" ? "4px" : void 0,
                            disabled: g.disabled,
                            onClick: w,
                            justifyContent: "center",
                            alignItems: "center",
                            border: "none",
                            padding: "0",
                            color: "white",
                            opacity: g.disabled ? .3 : g.faded ? .4 : 1,
                            cursor: g.disabled || g.faded ? "default" : "pointer",
                            background: I,
                            transition: "background 0.2s ease",
                            children: e
                        }) : r(b, {
                            display: "flex",
                            onClick: w,
                            children: e
                        })
                    })
                })
            })
        })
    }), lV = (0, lr.memo)(aV, (e, t) => (0, hM.default)(e, t)), ke = lV
});

function dV({
    control: e,
    panel: t,
    centerPanel: o,
    offset: i = [0, 16],
    placement: n = "left"
}) {
    let s = (0, Xg.useMemo)(() => {
            let l = [{
                name: "offset",
                options: {
                    offset: i
                }
            }, {
                name: "preventOverflow",
                options: {
                    padding: 16
                }
            }];
            return o && l.push({
                name: "computeStyles",
                enabled: !0,
                fn({
                    state: c
                }) {
                    let d = c.rects.reference.x - (i[1] ? ? 0);
                    return c.styles.popper = { ...c.styles.popper,
                        top: "50vh",
                        left: "auto",
                        bottom: "auto",
                        right: "0",
                        position: "absolute",
                        transform: `translate3d(${Math.round(d)}px, ${-(fM/2)}px, 0) translateY(-50%)`
                    }, c
                }
            }), l
        }, [o, i]),
        a = (0, Xg.useCallback)((l = {}) => ({
            maxHeight: o ? `100vh - ${cV}px` : `100vh - ${fM}px`,
            scrollable: !0,
            ...l
        }), [o]);
    return x(CI, {
        children: [r(II, {
            children: e
        }), r(kI, {
            placement: n,
            modifiers: s,
            children: l => t ? t({ ...l,
                getScrollablePanelProps: a
            }) : null
        })]
    })
}
var Xg, fM, cV, Ie, gM = k(() => {
    "use strict";
    Xg = E(N());
    wp();
    B();
    fM = 72, cV = 128;
    Ie = dV
});
var ht = k(() => {
    "use strict";
    mM();
    gM()
});
var pV, uV, bM, yM = k(() => {
    "use strict";
    ve();
    ie();
    B();
    pV = e => r("svg", {
        viewBox: "0 0 64 64",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M20.5 0C18.0147 0 16 2.01472 16 4.5V15L4.5 15C2.01472 15 0 17.0147 0 19.5C0 21.9853 2.01472 24 4.5 24H16V39H4.5C2.01472 39 0 41.0147 0 43.5C0 45.9853 2.01472 48 4.5 48H16V59.5C16 61.9853 18.0147 64 20.5 64C22.9853 64 25 61.9853 25 59.5V48L40 48V59.5C40 61.9853 42.0147 64 44.5 64C46.9853 64 49 61.9853 49 59.5V48H59.5C61.9853 48 64 45.9853 64 43.5C64 41.0147 61.9853 39 59.5 39H49V24H59.5C61.9853 24 64 21.9853 64 19.5C64 17.0147 61.9853 15 59.5 15L49 15V4.5C49 2.01472 46.9853 0 44.5 0C42.0147 0 40 2.01472 40 4.5V15L25 15V4.5C25 2.01472 22.9853 0 20.5 0ZM40 39V24H25V39L40 39Z",
            fill: "currentColor"
        })
    }), uV = b.withComponent(ue(pV)
        `
      display: block;
    `), bM = uV
});

function PV({
    styles: e
}) {
    let t = e ? .[0] ? .inlineStyles ? .keys || [];
    if (t.includes("FONT_FAMILY")) return "font";
    if (t.includes("COLOR")) return "color";
    if (t.includes("FONT_SIZE")) return "font-size"
}
var Kg, hV, mV, fV, gV, bV, yV, vV, wV, xV, _V, SV, CV, kV, mx, IV, TV, BV, MV, Jg, fx = k(() => {
    "use strict";
    qt();
    Ht();
    Kg = E(hn());
    oo();
    hV = ["border_radius", "border_radius_bl", "border_radius_br", "border_radius_tl", "border_radius_tr"], mV = ["radius", "radius_rect_tl", "radius_rect_tr", "radius_rect_bl", "radius_rect_br"], fV = ["border-radius", "hover-border-radius"], gV = [...hV, ...mV, ...fV], bV = ["background-color", "hover-background-color", "current-background-color", "color", "hover-color", "current-hover-color", "border-color", "hover-border-color", "current-border-color"], yV = ["bg_color", "border_color"], vV = ["pic_color"], wV = [...bV, ...yV, ...vV], xV = ["border-width", "hover-border-width", "font-weight", "letter-spacing", "transitionTime"], _V = ["border_size", "border_color", "opacity"], SV = ["tp", "sides", "borders"], CV = [...xV, ..._V, ...SV], kV = ["button", "picture", "shape", "text"], mx = {}, IV = ({
        widget: e,
        action: t
    }) => Object.assign(mx, {
        widget: e,
        action: t
    });
    TV = e => {
        if (typeof e == "string" && e === "styles_panel_interaction") return "styles";
        let t = Object.keys(e);
        if (t.includes("styles")) return PV(e);
        if ((0, Kg.intersection)(t, gV).length > 0) return "radius";
        if ((0, Kg.intersection)(t, wV).length > 0) return "color";
        if ((0, Kg.intersection)(t, CV).length > 0) return "properties";
        if (t.includes("font-family")) return "font";
        if (t.includes("font-size")) return "font-size"
    }, BV = ({
        widget: e,
        changes: t
    }) => {
        if (!kV.includes(e) || !((window ? .RM ? .constructorRouter ? .workspace ? .getSelectedBlocks() || []).filter(s => s.model.get("type") === e).length > 1)) return;
        let n = TV(t);
        n && (n === mx.action && e === mx.widget || (De(Fe.GroupEdit, {
            widget: e,
            action: n
        }), IV({
            widget: e,
            action: n
        })))
    }, MV = {
        sendEvent: Ym(BV, 100, {
            trailing: !1
        })
    }, Jg = MV
});
var kt, RV, gx, xM, vM, bx, _M, Yh, qg = k(() => {
    "use strict";
    kt = E(ze());
    Ht();
    Ro();
    oo();
    Wo();
    Or();
    pg();
    Dv();
    En();
    pd();
    fx();
    Fj();
    RV = (e, t, o = !0) => {
        let i = Hc(e, t);
        return o ? [...Oe.primitiveFields, ...Oe.primitiveFieldsByWidgetType[e] || []] : i
    }, gx = (e, t, o, i) => !i && e === "default" && t !== e && !o ? .parent_wid, xM = ({
        target: e,
        viewport: t,
        pageId: o,
        disposable: i = !0,
        minimalViewports: n = !0
    }) => {
        let s = e.getWidget ? e.getWidget() : e,
            a = Hc(s.attributes.type, s.attributes.version),
            l = RV(s.attributes.type, s.attributes.version, n),
            c = a.reduce((v, C) => (v[C] = void 0, v), {}),
            d = Oe.cascadingFields[s.attributes.type] || [],
            p = Ai.GLOBAL_UNIQUE_KEYS,
            h = {
                viewport_phone_portrait: void 0,
                viewport_tablet_portrait: void 0
            },
            u = Ca[s.attributes.type] || me,
            m = !n && g0(s.attributes),
            f = t;
        kt.default.defaults(s.attributes, c);
        let g = !1,
            y = {},
            S = Object.create(s, {
                attributes: {
                    value: new Proxy(s.attributes, {
                        get(v, C) {
                            let I = !!v.is_global,
                                T = f !== "default" ? `viewport_${f}` : void 0;
                            if (!(C === "viewport_phone_portrait" || C === "viewport_tablet_portrait"))
                                if (I && p.includes(C)) {
                                    let P = Ai.GLOBAL_UNIQUE_KEY_PREFIX + C,
                                        M = T && v[T] ? .[P] ? v[T] : v;
                                    return Ai.getUniqueValue(C, M, o)
                                } else if (T && a.includes(C)) {
                                if (!h[T]) {
                                    let M = kt.default.pick(v, a),
                                        F = u.getViewportDefaults(s, f),
                                        R = kt.default.isEmpty(v[T]);
                                    h[T] = n ? { ...F
                                    } : R ? kt.default.defaults({}, F, M, c) : kt.default.defaults({}, v[T], F, c)
                                }
                                let P = n || m ? h[T][C] !== void 0 : C in h[T];
                                return l.includes(C) && !P && (h[T][C] = v[C]), v[T] && v[T][C] !== void 0 ? v[T][C] : P ? h[T][C] : v[C]
                            } else return v[C]
                        },
                        set(v, C, I) {
                            if (pt("widget.anomalyMonitoring")) {
                                let T = window.RM.constructorRouter.workspace ? .viewport;
                                gx(f, T, v, i) && sr.sendEvent({
                                    type: "setInMismatchedViewport",
                                    widget: v,
                                    payload: {
                                        [C]: I
                                    }
                                })
                            }
                            return C === "viewport_phone_portrait" || C === "viewport_tablet_portrait" ? v[C] = I : f === "phone_portrait" && a.includes(C) ? v.viewport_phone_portrait[C] = I : f === "tablet_portrait" && a.includes(C) ? v.viewport_tablet_portrait[C] = I : v[C] = I, !0
                        }
                    }),
                    configurable: !1
                },
                viewport_default: {
                    get() {
                        return s.attributes
                    },
                    set(v) {
                        s.attributes = v
                    }
                },
                viewport_phone_portrait: {
                    get() {
                        return vM(s.attributes, s.attributes.viewport_phone_portrait, a), s.attributes.viewport_phone_portrait
                    },
                    set(v) {
                        s.attributes.viewport_phone_portrait = v
                    }
                },
                viewport_tablet_portrait: {
                    get() {
                        return vM(s.attributes, s.attributes.viewport_tablet_portrait, a), s.attributes.viewport_tablet_portrait
                    },
                    set(v) {
                        s.attributes.viewport_tablet_portrait = v
                    }
                },
                viewport: {
                    get() {
                        return f
                    }
                },
                getViewport: {
                    value() {
                        return f
                    }
                },
                setViewport: {
                    value(v = "default", C) {
                        if (f === v) return;
                        let I = kt.default.clone(this.attributes);
                        f = v;
                        let T = v !== "default" ? `viewport_${v}` : void 0;
                        v !== "default" && T && !s.attributes[T] && this.initViewport(v, C), s._previousAttributes = T ? {
                            [T]: I
                        } : I;
                        let P = {};
                        for (let F of Object.keys(this.attributes)) kt.default.isEqual(I[F], this.attributes[F]) ? delete P[F] : P[F] = this.attributes[F];
                        s.changed = T ? {
                            [T]: P
                        } : P;
                        let M = {
                            first: !0,
                            viewportChange: !0,
                            noSaveUnique: !0,
                            ...C
                        };
                        for (let F of Object.keys(this.attributes)) kt.default.isEqual(I[F], this.attributes[F]) || this.trigger("change:" + F, this, this.attributes[F], M);
                        this.trigger("change", this, M)
                    }
                },
                isViewportInitialized: {
                    value(v) {
                        let C = v !== "default" ? `viewport_${v}` : void 0;
                        return v === "default" || !!(C && s.attributes[C])
                    }
                },
                initViewport: {
                    value(v, C) {
                        let I = C ? .save !== void 0 ? C.save : !0;
                        C ? .save !== void 0 && delete C.save;
                        let T = this.getDefaults(v, C);
                        this.set(T), I && this.save({}, {
                            silent: !0,
                            skipHistory: !0
                        })
                    }
                },
                setInViewports: {
                    value(v, C) {
                        s.setInViewports(v, C)
                    }
                },
                unsetInViewports: {
                    value(v, C) {
                        s.setInViewports(v, { ...C,
                            unset: !0
                        })
                    }
                },
                setInPrimary: {
                    value(v, C) {
                        s.setInPrimary(v, C)
                    }
                },
                get: {
                    value(v) {
                        return this.attributes[v]
                    }
                },
                set: {
                    value(v, C, I) {
                        let T = typeof v == "string" ? {
                                [v]: C
                            } : v,
                            P = typeof v == "string" ? I || {} : C || {},
                            {
                                update: M,
                                options: F
                            } = P.normalized ? {
                                update: T,
                                options: P
                            } : this.normalizeUpdate(T, P);
                        if (pt("widget.anomalyMonitoring")) {
                            let R = window.RM.constructorRouter.workspace ? .viewport;
                            gx(f, R, s.attributes, i) && sr.sendEvent({
                                type: "setInMismatchedViewport",
                                widget: s.attributes,
                                payload: M
                            })
                        }
                        return s.set(M, F)
                    }
                },
                save: {
                    value(v, C, I) {
                        let T = typeof v == "string" ? {
                                [v]: C
                            } : v,
                            P = typeof v == "string" ? I || {} : C || {},
                            {
                                update: M,
                                options: F
                            } = P.normalized ? {
                                update: T,
                                options: P
                            } : this.normalizeUpdate(T, P);
                        if (pt("widget.anomalyMonitoring")) {
                            let R = window.RM.constructorRouter.workspace ? .viewport;
                            gx(f, R, s.attributes, i) && sr.sendEvent({
                                type: "setInMismatchedViewport",
                                widget: s.attributes,
                                payload: M
                            })
                        }
                        return s.save(M, F)
                    }
                },
                clone: {
                    value({
                        viewport: v,
                        pageId: C
                    } = {}) {
                        return xM({
                            target: s,
                            viewport: v || f,
                            pageId: C || o,
                            minimalViewports: n
                        })
                    }
                },
                toJSON: {
                    value() {
                        return kt.default.clone(s.attributes)
                    }
                },
                cloneJSON: {
                    value() {
                        return rt(s.attributes)
                    }
                },
                triggerReady: {
                    value() {
                        bt.trigger("ready:model", s)
                    }
                },
                normalizeUpdate: {
                    value(v, C) {
                        let I = v ? Object.keys(v) : [],
                            T = s.attributes.is_global,
                            P = C ? .viewport || f,
                            M = P !== "default" ? `viewport_${P}` : void 0;
                        if (v && M) {
                            let F = s.attributes,
                                R = s.attributes[M] || {},
                                A = Object.entries(v).reduce((X, [q, ne]) => (T && p.includes(q) && !kt.default.isEqual(ne, Ai.getUniqueValue(q, F, o)) || l.includes(q) ? X[q] = ne : pt("widget.viewportProxyNoUnsetEqual") ? a.includes(q) && (X[q] = ne) : a.includes(q) && !kt.default.isEqual(ne, F[q]) ? X[q] = ne : a.includes(q) && R[q] !== void 0 && (X[q] = void 0), X), {}),
                                D = T && kt.default.intersection(Object.keys(A), p).length > 0 ? bx(v, { ...F,
                                    ...R
                                }, o) : {},
                                O = kt.default.omit(v, a);
                            delete O.viewport_phone_portrait, delete O.viewport_tablet_portrait;
                            let L = kt.default.isEmpty(A) && kt.default.isEmpty(D),
                                W = C ? .unset && !s.attributes[M],
                                z = { ...R,
                                    ...A,
                                    ...D
                                },
                                V = Object.assign(L || W ? {} : {
                                    [M]: z
                                }, O);
                            return C ? .unset && (Object.keys(v).forEach(X => {
                                V[M] && X in V[M] ? delete V[M][X] : X in V && (V[X] = void 0)
                            }), delete C.unset), {
                                update: V,
                                options: C
                            }
                        } else if (v && P === "default" && d.length && kt.default.intersection(I, d).length) {
                            let F = s.attributes.viewport_phone_portrait,
                                R = s.attributes.viewport_tablet_portrait,
                                A = T && kt.default.intersection(I, p).length > 0 ? bx(v, s.attributes, o) : {};
                            return {
                                update: { ...v,
                                    ...A,
                                    ...F ? {
                                        viewport_phone_portrait: { ...F,
                                            ...kt.default.pick(v, d)
                                        }
                                    } : {},
                                    ...R ? {
                                        viewport_tablet_portrait: { ...R,
                                            ...kt.default.pick(v, d)
                                        }
                                    } : {}
                                },
                                options: C
                            }
                        } else {
                            let F = T && v && kt.default.intersection(I, p).length > 0 ? bx(v, s.attributes, o) : {};
                            return {
                                update: kt.default.isEmpty(F) ? v : { ...v,
                                    ...F
                                },
                                options: C
                            }
                        }
                    }
                },
                getDefaults: {
                    value(v, C) {
                        let I = this.clone({
                                viewport: "default"
                            }),
                            T = kt.default.pick(I.attributes, (M, F) => l.includes(F) && M !== void 0),
                            P = u.getViewportDefaults(I, v, C);
                        return { ...T,
                            ...P
                        }
                    }
                },
                getOverrides: {
                    value(v) {
                        let C = v !== "default" ? `viewport_${v}` : void 0;
                        return v === "default" ? {} : C ? { ...h[C] || {},
                            ...s.attributes[C] || {}
                        } : s.attributes
                    }
                },
                getWidget: {
                    value() {
                        return s
                    }
                },
                suspend: {
                    value() {
                        y = kt.default.clone(S.attributes), g = !0
                    }
                },
                resume: {
                    value() {
                        g && (S.trigger("change", S, {
                            viewportChange: !0
                        }), y = {}, g = !1)
                    }
                },
                isSuspended: {
                    value() {
                        return g
                    }
                },
                _proxied: {
                    value: s
                },
                _listenId: {
                    value: kt.default.uniqueId("l")
                },
                _events: {
                    value: {},
                    writable: !0
                },
                changed: {
                    get() {
                        let v = {};
                        if (g) {
                            let T = kt.default.union(kt.default.keys(y), kt.default.keys(S.attributes)),
                                P = S.attributes;
                            for (let M of T) kt.default.isEqual(y[M], P[M]) || (v[M] = P[M])
                        }
                        let C = kt.default.omit(g ? v : s.changed, ["viewport_phone_portrait", "viewport_tablet_portrait"]),
                            I = f !== "default" ? `viewport_${f}` : void 0;
                        if (I && I in s.changed) {
                            let T = s.previousAttributes() ? .[I] || {},
                                P = s.changed ? .[I] || {};
                            return { ...C,
                                ...Object.keys(P).reduce((M, F) => (kt.default.isEqual(P[F], T[F]) || (M[F] = P[F]), M), {})
                            }
                        } else return C
                    }
                },
                _previousAttributes: {
                    get() {
                        let v = kt.default.omit(s.previousAttributes(), ["viewport_phone_portrait", "viewport_tablet_portrait"]),
                            C = f !== "default" ? `viewport_${f}` : void 0;
                        return C ? { ...v,
                            ...kt.default.pick(s.previousAttributes() ? .[C], a)
                        } : v
                    }
                }
            }),
            w = ["re-saved"];
        return i || S.listenTo(s, "all", (v, C, I, T) => {
            if (g) return;
            let P = v.startsWith("change:") ? v.split(":")[1] : void 0,
                M = !!(P && !a.includes(P)),
                F = P ? Ai.GLOBAL_PRIVATE_KEYS.includes(P) : !1,
                R = s.attributes.is_global;
            if (v === "change:viewport_phone_portrait" || v === "change:viewport_tablet_portrait") {
                let A = I;
                if (!A) return;
                let D = s.previousAttributes() ? .[P] || {},
                    O = kt.default.unique([...Object.keys(D), ...Object.keys(A)]);
                for (let L of O)
                    if (R && p.includes(L)) {
                        let W = Ai.getUniqueValue(L, D, o),
                            z = Ai.getUniqueValue(L, A, o);
                        kt.default.isEqual(W, z) || S.trigger("change:" + L, S, z, T)
                    } else kt.default.isEqual(D[L], A[L]) || S.trigger("change:" + L, S, A[L], T)
            } else if (v === "widget:create") S.trigger(v, C, I, T);
            else if (v.startsWith("change:") && P && F && f === "default") {
                let A = new RegExp("^" + Ai.GLOBAL_UNIQUE_KEY_PREFIX),
                    D = P.replace(A, ""),
                    O = s.previousAttributes(),
                    L = Ai.getUniqueValue(D, O, o),
                    W = Ai.getUniqueValue(D, {
                        [P]: I
                    }, o);
                kt.default.isEqual(L, W) || S.trigger("change:" + D, S, W, T), S.trigger(v, S, I, T)
            } else if (v.startsWith("change:") && (M || f === "default")) S.trigger(v, S, I, T);
            else if (v === "change") {
                S.trigger(v, S, I);
                let A = s.get("type");
                Jg.sendEvent({
                    widget: A,
                    changes: S.changed
                })
            } else w.includes(v) && S.trigger(v, S, I, T)
        }), S
    }, vM = (e, t, o = []) => {
        if (t && e.type === "button") {
            let i = kt.default.difference(o, Object.keys(t));
            for (let n of i) t[n] = e[n]
        }
    }, bx = (e, t, o) => {
        let i = rt(kt.default.pick(t, Ai.GLOBAL_PRIVATE_KEYS));
        return i.is_global = !0, Ai.fillUniqueAttributeSets(e, i, o)
    }, _M = (e, t, o) => {
        let i = o !== "default" ? `viewport_${o}` : void 0;
        return i ? e[i] ? { ...e,
            [i]: { ...e[i],
                ...t
            }
        } : e : { ...e,
            ...t
        }
    }, Yh = xM
});
var Kp, EV, FV, SM, CM = k(() => {
    "use strict";
    Kp = E(ze());
    oo();
    bh();
    Yt();
    Wo();
    Ht();
    qg();
    EV = ({
        blocks: e,
        pageId: t,
        magNumId: o,
        indexController: i,
        workspace: n
    }, s = {}) => {
        let a = !1,
            l = {
                object: "rm_pastedata",
                mag_num_id: o,
                blocks: [],
                mag_edit_params: {
                    fonts: [],
                    textStyles: [],
                    listStyles: [],
                    linkStyles: []
                }
            },
            c = l.mag_edit_params,
            d = [];
        if (Kp.default.each(e, y => {
                y.blockName && y.blockName === "ecommercecart" && (a = !0), y ? .model && y.model.get("type") === "picture" && y.checkLambdaUrlSetCorrectly && y.checkLambdaUrlSetCorrectly({
                    func: "convertToClipboard-copy"
                });
                let S = rt(y.model.toJSON());
                for (let w of Oe.types) {
                    let v = i.getZIndex(y.model.id, t, w);
                    S = _M(S, {
                        z: v
                    }, w)
                }
                if (S._variationY = S.y - n.getDefaultY(S), s.disableDeleteGlobalAttributes || (S.is_global = !1), y.getNestedWidgetsJSON && (S._nestedWidgetsJSON = y.getNestedWidgetsJSON(!0)), l.blocks.push(S), S._nestedWidgetsJSON)
                    for (let w of S._nestedWidgetsJSON) d.push(w)
            }), Kp.default.isEmpty(l.blocks) || a) return;
        let p = Ln.getUsedParagraphStylesFromWidgetsModels(l.blocks, n.mag),
            h = Ln.getUsedLinkStylesFromWidgetsModels(l.blocks, n.mag),
            u = Ln.getUsedFontsFromWidgetsModels({
                includeCustom: !1,
                models: l.blocks
            }, Ln.fontsShortList),
            m = Gk([...l.blocks, ...d]);
        m.length && (c.textStyles = m);
        let f = Yk([...l.blocks, ...d]);
        f.length && (c.linkStyles = f);
        let g = Zk([...l.blocks, ...d]);
        return g.length && (c.listStyles = g), Kp.default.isEmpty(p) || (c.paragraph_styles = p), Kp.default.isEmpty(h) || (c.link_styles = h), Kp.default.isEmpty(u) || (c.fonts = u), l
    }, FV = {
        convertToClipboard: EV
    }, SM = FV
});
var TM, DV, kM, yx, IM, AV, LV, Qg, vx = k(() => {
    "use strict";
    Ht();
    Wo();
    TM = E(hn());
    uh();
    Yt();
    wa();
    CM();
    Wt();
    DV = e => {
        let t = o => {
            let i = Gc(o),
                n = mf(i, Qd);
            Object.values(n).forEach(s => {
                delete s.data ? .pageId
            })
        };
        t(e), Oe.viewport_list.forEach(o => {
            let i = e[o];
            i && t(i)
        })
    }, kM = (e, t) => t.find(o => o.id === e), yx = (e, t) => {
        if ("trigger" in e) {
            let o = ft.normalizeAnimationTriggers(e.trigger ? ? []);
            e.trigger = o.filter(i => kM(i, t))
        } else "triggers" in e && (e.triggers = (e.triggers ? ? []).filter(o => kM(o, t)))
    }, IM = (e, t) => {
        yx(e, t), ft.normalizeAnimations(e ? .animation ? ? []).forEach(n => {
            n.trigger && yx(n, t)
        }), (e.interactions ? ? []).forEach(n => {
            n.triggers && yx(n, t)
        })
    }, AV = (e, t) => {
        IM(e, t), Oe.viewport_list.forEach(o => {
            let i = e[o];
            i && IM(i, t)
        })
    }, LV = (e, t) => {
        e.pack_id && (e.pack_id = t[e.pack_id]), Oe.viewport_list.forEach(o => {
            let i = e[o];
            i && i.pack_id && (i.pack_id = t[i.pack_id])
        })
    }, Qg = ({
        blocks: e,
        mag: t,
        page: o,
        name: i,
        categoryId: n,
        workspace: s,
        indexController: a,
        type: l = "readymag"
    }) => {
        let c = t.get("packs"),
            d = SM.convertToClipboard({
                blocks: [...e],
                pageId: o.id,
                magNumId: t.get("num_id"),
                indexController: a,
                workspace: s
            }, {
                disableDeleteGlobalAttributes: !0
            });
        if (!d) return;
        let p = d.blocks,
            h = p.reduce((S, w) => (S.push(w.pack_id), S.push(w.viewport_phone_portrait ? .pack_id), S.push(w.viewport_tablet_portrait ? .pack_id), S), []).filter(Boolean),
            u = TM.default.unique(h),
            m = c.reduce((S, w) => (S[w.pack_id] = w, S), {}),
            f = u.reduce((S, w) => (S[w] = be.generateUUID(), S), {});
        p.forEach(S => {
            LV(S, f), S.type === "text" && DV(S), AV(S, e)
        });
        let g = e[0].model.get("name") || e[0].model.get("type");
        return {
            name: i ? ? (m[u[0]] ? .name || g),
            widgets: p,
            packs: u.map(S => ({
                pack_id: f[S],
                atomic: !0,
                name: m[S] ? .name ? ? "Preset Group"
            })),
            category: n,
            fonts: d.mag_edit_params.fonts || [],
            textStyles: d.mag_edit_params.textStyles,
            listStyles: d.mag_edit_params.listStyles,
            linkStyles: d.mag_edit_params.linkStyles,
            type: l,
            project: t.get("_id")
        }
    }
});

function $V() {
    let {
        model: e
    } = (0, Ds.useContext)(Y), [t] = M2(), [o, i] = (0, Ds.useState)(!1), [n, s] = (0, Ds.useState)(!1), [a, l] = (0, Ds.useState)(!1), [c, d] = (0, Ds.useState)(), [p, h] = (0, Ds.useState)(""), u = e.workspace;
    (0, Ds.useEffect)(() => {
        if (!e.selected) return;
        let w = new AbortController;
        return window.RM.constructorRouter.me && R2({
            signal: w.signal,
            ownerId: window.RM.constructorRouter.me.get("_id"),
            projectId: u.mag.get("_id")
        }), () => {
            w.abort()
        }
    }, [e.selected, u]);
    let m = (0, Ds.useCallback)(w => {
            w.preventDefault(), e.select()
        }, [e.disabled, e.selected]),
        f = window.RM.constructorRouter,
        g = async () => {
            i(!0), s(!1);
            let w = Qg({
                blocks: u.getSelectedBlocks(),
                mag: u.mag,
                page: u.page,
                name: p,
                categoryId: c,
                workspace: u,
                indexController: f.indexController
            });
            if (w) try {
                let v = await C2(w);
                ec() !== void 0 && Gg("readymag", [v]), i(!1), l(!0), setTimeout(() => l(!1), 1e3)
            } catch {
                i(!1), s(!0), setTimeout(() => s(!1), 1e3)
            }
        },
        y = w => {
            d(w.currentTarget.value)
        },
        S = w => {
            h(w.currentTarget.value)
        };
    return r(Ie, {
        control: ({
            ref: w
        }) => r(ke, {
            ref: w,
            label: "Add to presets",
            onClick: m,
            children: r(bM, {
                width: "16px"
            })
        }),
        panel: ({
            ref: w,
            style: v
        }) => e.selected ? x(Me, {
            isShowed: !0,
            ref: w,
            style: v,
            children: [r(Ut, {
                leftSlot: r($, {
                    textStyle: "regular",
                    children: "Presets"
                }),
                showBorder: !1
            }), x(b, {
                padding: "0 16px 16px",
                children: [x(zV, {
                    textStyle: "small",
                    onChange: y,
                    defaultValue: c,
                    children: [r("option", {
                        value: "",
                        children: "Choose category"
                    }), t.map(C => r("option", {
                        value: C._id,
                        children: C.name
                    }, C._id))]
                }), r(Mo, {
                    name: "name",
                    type: "text",
                    autoComplete: "off",
                    autoCorrect: "off",
                    placeholder: "Preset name",
                    value: p,
                    onChange: S,
                    textStyle: "small",
                    border: "none !important"
                }), r(jl, {
                    height: 40,
                    variant: "bordered",
                    textStyle: "small",
                    width: "100%",
                    onClick: g,
                    disabled: !c || !p || o || n,
                    children: a ? "Preset added" : n ? "Error" : "Add to presets"
                })]
            })]
        }) : null
    })
}
var Ds, zV, BM, MM = k(() => {
    "use strict";
    Ds = E(N());
    ie();
    je();
    Ur();
    nt();
    gn();
    S2();
    Be();
    ve();
    Ht();
    ae();
    Vg();
    Qw();
    ht();
    yM();
    vx();
    B();
    zV = ue(Jw)
    `
  &:focus {
    border-bottom: none;
  }
`;
    BM = $V
});
var EM, FM = k(() => {
    "use strict";
    ae();
    MM();
    EM = Ce.extend({
        name: "readymag_preset",
        component: BM,
        restrictions: () => window.RM.constructorRouter.me ? .get("permissions") ? .can_add_preset
    })
});
var DM, dt, AM = k(() => {
    "use strict";
    ve();
    ie();
    DM = b.withComponent(ue("button")
        `
  display: flex;
  justify-content: center;
  align-items: center;
  transition: 0.1s background, 0.1s border;
  background-color: ${({color:e,theme:t})=>e?t.colors[e]:t.colors.white};
  color: ${({color:e,theme:t})=>e?t.colors.white:"inherit"};
  border-radius: 50%;
  border: ${({color:e})=>e?"none":"2px solid"};
  border-color: ${({theme:e})=>e.colors.lightGray};
  box-shadow: ${({outline:e})=>e?"0 0 0 1px rgba(128, 128, 128, 0.16)":"unset"};
  cursor: pointer;
  box-sizing: border-box;
  font-size: 16px;
  margin-right: 4px;
  padding-left: 0;
  padding-right: 0;

  &:disabled {
    cursor: default;
    pointer-events: none;

    & > * {
      opacity: 0.4;
    }
  }

  &:focus {
    outline: none;
  }

  & g {
    transition: 0.1s stroke, 0.1s fill;
  }

  @media (pointer: fine) {
    &:hover,
    &[data-hovered='true'] {
      background-color: ${({hoverColor:e,theme:t})=>e?t.colors[e]:t.colors.tomato};
      border-color: ${({hoverColor:e,theme:t})=>e?t.colors[e]:t.colors.tomato};
      color: ${({hoverTextColor:e,theme:t})=>e&&t.colors[e]};

      & g {
        ${({unstyledHover:e,color:t,hoverColor:o,theme:i})=>e?"":`
        fill: $ {
            t && o ? i.colors[t] : i.colors.white
        };
        `}
      }
    }
    &:active,
    &[data-active='true'] {
      background-color: ${({activeColor:e,theme:t})=>e?t.colors[e]:t.colors.tomato};
      border-color: ${({activeColor:e,theme:t})=>e?t.colors[e]:t.colors.tomato};
      color: ${({hoverTextColor:e,theme:t})=>e&&t.colors[e]};

      & g {
        ${({unstyledActive:e,color:t,activeColor:o,theme:i})=>e?"":`
        fill: $ {
            t && o ? i.colors[t] : i.colors.white
        };
        `}
      }
    }
  }
`);
    DM.defaultProps = {
        width: 48,
        height: 48
    };
    dt = DM
});
var Jr = k(() => {
    "use strict";
    AM()
});

function OV({
    positive: e,
    max: t,
    min: o,
    step: i,
    onChange: n,
    direction: s,
    value: a,
    onStart: l,
    onDone: c
}) {
    let [d, p] = (0, qr.useState)(null), [h, u] = (0, qr.useState)(a), m = (0, qr.useRef)(null), f = i !== void 0 ? WV(i) : null, g = f && Math.pow(10, f), y = i !== void 0 && f && f > 0, [S, w] = (0, qr.useState)(0), [v, C] = (0, qr.useState)(0), I = (0, qr.useCallback)(F => {
        let R = s === "x" ? F.screenX : F.screenY,
            A = F.timeStamp;
        if (R === v) return 1;
        let D = A - S,
            O = R - v,
            L = Math.abs(Math.round(O / D * 100));
        return C(R), w(A), Math.round(Math.max(1, L / 100))
    }, [S, v]), T = (0, qr.useCallback)((F, R = "drag") => {
        let A = F;
        e && A < 0 && (A = 0), R === "drag" && (typeof t == "number" && A > t ? A = t : typeof o == "number" && A < o && (A = o)), n(A, h || 0), u(A)
    }, [n, t, o, e, h]), [P, M] = (0, qr.useState)(0);
    return (0, qr.useEffect)(() => {
        if (d !== null) {
            let F = "";
            document && document.body && (F = document.body.style.cursor, document.body.style.cursor = s === "y" ? "ns-resize" : "ew-resize");
            let R = D => {
                    if (!(D.buttons === void 0 ? D.which === 1 : D.buttons === 1)) {
                        A();
                        return
                    }
                    let O = y && g ? g : 1,
                        L = (d - (s === "y" ? D.screenY : D.screenX)) / O * (s === "y" ? 1 : -1),
                        W = y && f ? 1 : Math.min(I(D), 3),
                        z = (L - P) * W,
                        V = y && f ? z : Math.round(z / 4),
                        X = (h || 0) + V,
                        q = {
                            "-user-select": "none",
                            "-webkit-user-select": "none",
                            "-moz-user-select": "none"
                        };
                    Object.assign(document.body.style, q), m && m.current && m.current === document.activeElement && m.current.blur(), T(y && f ? parseFloat(X.toFixed(f)) : X), M(L)
                },
                A = () => {
                    m.current && a === h && m.current.focus();
                    let D = {
                        "-user-select": "auto",
                        "-webkit-user-select": "auto",
                        "-moz-user-select": "auto"
                    };
                    Object.assign(document.body.style, D), p(null), u(a), c && c(a), C(0), w(0), M(0)
                };
            return window.addEventListener("mousemove", R), window.addEventListener("mouseup", A), () => {
                document && document.body && (document.body.style.cursor = F), window.removeEventListener("mousemove", R), window.removeEventListener("mouseup", A)
            }
        }
    }, [d, T, h, s, a, c, y, g, f, P]), {
        ref: m,
        handleChange: T,
        lastValue: h,
        onMouseDown: (F, R) => {
            C(0), w(0), M(0), p(s === "y" ? F : R), u(a), l && l(a)
        }
    }
}
var qr, WV, eb, LM = k(() => {
    "use strict";
    qr = E(N()), WV = e => e % 1 ? e.toString().split(".")[1].length : 0;
    eb = OV
});

function NV({
    fontSize: e = 0,
    lineHeight: t = 0,
    onChange: o,
    linked: i = !1,
    ratio: n,
    minSize: s = 8,
    maxSize: a = 999,
    onChangeRatio: l,
    fontSizeLinked: c,
    lineHeightLinked: d,
    multipleFontSizes: p,
    multipleLineHeights: h,
    lineHeightDisabled: u,
    fontSizeDisabled: m,
    multipleLinked: f = !1
}) {
    let g = Math.max(e || 0, t || 0, 100) + s,
        y = 8,
        S = 128 - y * 2,
        w = 32,
        v = 16,
        C = v / 2,
        I = S / v,
        T = Math.round((S * e || 0) / g),
        P = Math.round((S * t || 0) / g);
    T = Math.max(T, 0), P = Math.max(P, 0);
    let M = T - T / I,
        F = P - P / I,
        R = {
            x: 0 + C,
            y: F + C
        },
        A = {
            x: w - C,
            y: M + C
        },
        D = R.x >= 0 && R.y >= 0 && A.x >= 0 && A.y >= 0,
        [O, L] = (0, wx.useState)(e),
        [W, z] = (0, wx.useState)(t),
        V = ({
            value: oe,
            oldValue: U
        }) => {
            let he = oe > a ? a : oe < s ? s : oe,
                xe = i ? n ? Math.round(he / n) : W + (he - U) : t,
                pe = {
                    fontSize: he,
                    lineHeight: xe > a ? a : xe < s ? s : xe
                };
            o(pe), !i && l && l(pe.fontSize / pe.lineHeight)
        },
        X = oe => {
            L(oe), z(t)
        },
        q = ({
            value: oe,
            oldValue: U
        }) => {
            let he = oe > a ? a : oe < s ? s : oe,
                xe = i ? n ? Math.round(he * n) : O + (he - U) : e,
                pe = {
                    fontSize: xe > a ? a : xe < s ? s : xe,
                    lineHeight: he
                };
            o(pe), !i && l && l(pe.fontSize / pe.lineHeight)
        },
        ne = oe => {
            z(oe), L(e)
        },
        re = eb({
            min: s,
            max: a,
            positive: !0,
            value: e,
            direction: "y",
            onStart: X,
            onDone: X,
            onChange: (oe, U) => V({
                value: oe,
                oldValue: U
            })
        }),
        te = eb({
            min: s,
            max: a,
            positive: !0,
            value: t,
            direction: "y",
            onStart: ne,
            onDone: ne,
            onChange: (oe, U) => q({
                value: oe,
                oldValue: U
            })
        }),
        ee = eb({
            min: s,
            max: a,
            positive: !0,
            value: t,
            direction: "y",
            onStart: ne,
            onDone: ne,
            onChange: (oe, U) => q({
                value: oe,
                oldValue: U
            })
        }),
        j = m || i && u,
        se = u || i && m;
    return x(b, {
        display: "flex",
        alignItems: "center",
        justifyContent: "space-between",
        height: S + y * 2,
        children: [r(b, {
            height: "100%",
            width: "100%",
            position: "relative",
            marginTop: y * -1 + "px",
            children: r($M, {
                bottom: `${M-(e>=100?1:10)}px`,
                right: 0,
                children: r(fe, {
                    "data-testid": "font-size-input-font",
                    disabled: j,
                    text: p ? "\u2022\u2022\u2022" : void 0,
                    min: s,
                    max: a,
                    fontSize: `${p?32:e>=100?24:40}px`,
                    lineHeight: p ? "50px" : void 0,
                    letterSpacing: "-1.2px",
                    value: e,
                    textAlign: "right",
                    onChange: V,
                    placeholder: "Font size",
                    height: "auto",
                    color: i && D || c ? "blue" : void 0,
                    transition: "color 0.2s ease"
                })
            })
        }), r(b, {
            display: "flex",
            height: "100%",
            width: "100%",
            alignItems: "center",
            justifyContent: "center",
            children: r(b, {
                height: "100%",
                width: w,
                backgroundColor: "white",
                borderRadius: "16px",
                position: "relative",
                children: r(b, {
                    position: "relative",
                    height: S,
                    top: y,
                    children: x(jV, {
                        children: [r(HV, {
                            ref: ee.ref,
                            onMouseDown: oe => {
                                oe.preventDefault(), !(j || se) && ee.onMouseDown(oe.screenY, oe.screenX)
                            },
                            x1: R.x || 0,
                            y1: R.y || 0,
                            x2: A.x || 0,
                            y2: A.y || 0,
                            stroke: i && D ? ce.blue : "transparent",
                            strokeWidth: v,
                            pointerEvents: i && D ? "all" : "none",
                            disabled: se || j,
                            opacity: f ? .5 : 1
                        }), r(zM, {
                            ref: re.ref,
                            onMouseDown: oe => {
                                oe.preventDefault(), !j && re.onMouseDown(oe.screenY, oe.screenX)
                            },
                            r: C,
                            cx: w - C,
                            cy: M + C,
                            fill: !f && (i && D || c) ? ce.blue : ce.black,
                            disabled: j,
                            opacity: !i && j ? .8 : 1
                        }), r(zM, {
                            ref: te.ref,
                            onMouseDown: oe => {
                                oe.preventDefault(), !se && te.onMouseDown(oe.screenY, oe.screenX)
                            },
                            r: C,
                            cx: C,
                            cy: F + C,
                            fill: !f && (i && D || d) ? ce.blue : ce.black,
                            disabled: se,
                            opacity: !i && se ? .8 : 1
                        })]
                    })
                })
            })
        }), r(b, {
            height: "100%",
            width: "100%",
            position: "relative",
            marginTop: y * -1 + "px",
            children: r($M, {
                bottom: `${F-(t>=100?1:10)}px`,
                left: 0,
                children: r(fe, {
                    "data-testid": "font-size-input-letter-spacing",
                    disabled: se,
                    text: h ? "\u2022\u2022\u2022" : void 0,
                    min: s,
                    max: a,
                    fontSize: `${h?32:t>=100?24:40}px`,
                    lineHeight: h ? "50px" : void 0,
                    letterSpacing: "-1.2px",
                    value: t,
                    onChange: q,
                    placeholder: "Line height",
                    height: "auto",
                    color: i && D || d ? "blue" : void 0,
                    transition: "color 0.2s ease"
                })
            })
        })]
    })
}
var wx, jV, HV, zM, $M, xx, WM = k(() => {
    "use strict";
    wx = E(N());
    ie();
    zt();
    ve();
    LM();
    ut();
    B();
    jV = ue("svg")
    `
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 100%;
  transform: rotate(180deg);
`, HV = b.withComponent(ue("line")
        `
  user-select: none;
  cursor: ${({disabled:e})=>e?"initial":"ns-resize"};
  transition: 0.2s stroke;
`), zM = b.withComponent(ue("circle")
        `
  user-select: none;
  cursor: ${({disabled:e})=>e?"initial":"ns-resize"};
  transition: 0.2s fill;

  ${({disabled:e,theme:t})=>!e&&Z` &
        : hover, &
        : active {
            fill: $ {
                t.colors.blue
            };
        }
        `}
`), $M = ue(b)
    `
  position: absolute;

  > input::placeholder {
    color: transparent;
  }
`;
    xx = NV
});
var OM = k(() => {
    "use strict";
    WM()
});
var oc, UV, VV, GV, YV, H, $e = k(() => {
    "use strict";
    oc = E(N());
    ie();
    Be();
    ve();
    od();
    B();
    UV = (0, oc.createContext)({
        leftSlotRef: void 0,
        setInitializedScrubbing: () => {}
    }), VV = ue(b, {
        excludeProps: ["activeCurrentColor", "hideOverflow"]
    })
    `
  display: flex;
  align-items: center;
  height: 100%;
  white-space: nowrap;
  width: ${e=>e.hideOverflow?"100%":"auto"};
  overflow: ${e=>e.hideOverflow?"hidden":"visible"};
  text-overflow: ${e=>e.hideOverflow?"ellipsis":"initial"};

  ${e=>e.activeCurrentColor&&Z`
      &:active {
        color: ${e.theme.colors.blue};
      }
    `}
`, GV = ({
        disabled: e,
        leftSlot: t,
        rightSlot: o,
        hideOverflow: i = !0,
        children: n,
        onClick: s,
        onSlotsClick: a,
        onMouseLeave: l,
        onMouseEnter: c,
        showBorder: d = !0,
        nested: p,
        className: h,
        dense: u = !1
    }, m) => {
        let f = (0, oc.useRef)(null),
            [g, y] = (0, oc.useState)(!1),
            {
                isHovered: S,
                ...w
            } = nr(),
            v = u ? 6 : 14;
        return r(b, {
            className: h,
            paddingLeft: "4rm",
            paddingRight: "4rm",
            onMouseLeave: l,
            onMouseEnter: c,
            "data-testid": "panel-item",
            onClick: s,
            cursor: s ? "pointer" : "auto",
            children: r(b, {
                height: n ? void 0 : u ? 32 : 40,
                borderBottom: "2px solid",
                borderColor: d ? di("gray", .24) : "transparent",
                paddingTop: n ? v : void 0,
                paddingBottom: n ? v : void 0,
                paddingLeft: p ? "2rm" : 0,
                children: x(UV.Provider, {
                    value: {
                        leftSlotRef: t ? f : void 0,
                        setInitializedScrubbing: y
                    },
                    children: [(!!t || !!o) && x(b, {
                        display: "flex",
                        ref: m,
                        height: n ? void 0 : "100%",
                        width: "100%",
                        alignItems: "center",
                        justifyContent: "space-between",
                        position: "relative",
                        opacity: e ? .4 : 1,
                        marginBottom: n ? 14 : void 0,
                        pointerEvents: e ? "none" : "initial",
                        onClick: a,
                        cursor: a ? "pointer" : "auto",
                        children: [!!t && r(VV, {
                            hideOverflow: i,
                            ref: f,
                            activeCurrentColor: typeof t == "string" && g,
                            color: typeof t == "string" && g && S ? "blue" : "inherit",
                            ...w,
                            children: typeof t == "string" ? r($, {
                                textStyle: "small",
                                children: t
                            }) : t
                        }), !!o && r(b, {
                            display: "flex",
                            alignItems: "center",
                            height: "100%",
                            children: typeof o == "string" ? r($, {
                                textStyle: "small",
                                children: o
                            }) : o
                        })]
                    }), n]
                })
            })
        })
    }, YV = (0, oc.forwardRef)(GV), H = YV
});
var Qr, Jt, ZV, Pr, lo, As, ni = k(() => {
    "use strict";
    Qr = E(N());
    B();
    Jt = (0, Qr.createContext)({}), ZV = (0, Qr.forwardRef)(({
        initialScreen: e,
        children: t,
        onNavigate: o,
        onStackUpdated: i
    }, n) => {
        let [s, a] = (0, Qr.useState)([e]), l = s[s.length - 1], c = s[s.length - 2];
        (0, Qr.useEffect)(() => {
            i && i(s)
        }, [s]);
        let d = u => {
                a([...s, u]), o && o({
                    prev: l,
                    next: u
                })
            },
            p = () => {
                if (s.length) {
                    let u = [...s];
                    u.pop(), a(u), o && o({
                        prev: l,
                        next: u[u.length - 1]
                    })
                }
            },
            h = () => {
                a([e]), o && o({
                    prev: l,
                    next: e
                })
            };
        return (0, Qr.useImperativeHandle)(n, () => ({
            stack: s,
            prevScreen: c,
            currentScreen: l,
            navigate: d,
            goBack: p,
            goHome: h
        }), [s, o, p, h, d, c, l]), r(Jt.Provider, {
            value: {
                stack: s,
                prevScreen: c,
                currentScreen: l,
                navigate: d,
                goBack: p,
                goHome: h
            },
            children: t
        })
    }), Pr = ZV, lo = ({
        screen: e,
        children: t
    }) => {
        let {
            currentScreen: o
        } = (0, Qr.useContext)(Jt);
        return o !== e ? null : r(Q, {
            children: t
        })
    }, As = e => {
        let [t, o] = (0, Qr.useState)([]);
        return {
            onStackUpdated: i => {
                o(i)
            },
            canControlBeClosed: () => e && t && t.length > 1 ? (e.goBack(), !0) : !1
        }
    }
});
var Zh, jM, XV, HM, NM = k(() => {
    "use strict";
    ie();
    zt();
    Be();
    ve();
    Zh = E(N());
    B();
    jM = ue("input")
    `
  display: block;
  /* stylelint-disable-next-line property-no-vendor-prefix */
  -webkit-appearance: none;
  width: 100%;
  margin: 0;
  height: 8px;
  background: transparent;

  &:focus {
    outline: none;
  }

  &::-webkit-slider-thumb {
    /* stylelint-disable-next-line property-no-vendor-prefix */
    -webkit-appearance: none;
    width: 8px;
    height: 8px;
    background: ${({theme:e})=>e.colors.blue};
    border-radius: 50%;
    cursor: ew-resize;
  }

  &::-moz-range-thumb {
    width: 8px;
    height: 8px;
    background: ${({theme:e})=>e.colors.blue};
    border-radius: 50%;
    cursor: ew-resize;
  }

  &::-ms-thumb {
    width: 8px;
    height: 8px;
    background: ${({theme:e})=>e.colors.blue};
    border-radius: 50%;
    cursor: ew-resize;
  }
`;
    jM.defaultProps = {
        type: "range"
    };
    XV = (0, Zh.forwardRef)(({
        title: e,
        value: t,
        max: o,
        min: i,
        onChange: n,
        disabled: s,
        nested: a,
        rightSlot: l,
        isMixed: c = !1
    }, d) => {
        let p = o / 2;
        return r(b, {
            height: 40,
            paddingLeft: "4rm",
            paddingRight: "4rm",
            children: x(b, {
                ref: d,
                display: "flex",
                alignItems: "center",
                position: "relative",
                height: "100%",
                width: "100%",
                opacity: s ? .4 : 1,
                borderBottom: "2px solid",
                borderColor: di("gray", .24),
                paddingLeft: a ? "2rm" : 0,
                pointerEvents: s ? "none" : "initial",
                children: [x(b, {
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "space-between",
                    height: "100%",
                    position: "relative",
                    children: [r(b, {
                        display: "flex",
                        alignItems: "center",
                        height: "100%",
                        whiteSpace: "nowrap",
                        children: typeof e == "string" ? r($, {
                            textStyle: "small",
                            children: e
                        }) : e
                    }), r(b, {
                        display: "flex",
                        alignItems: "center",
                        height: "100%",
                        children: l ? Zh.default.isValidElement(l) ? Zh.default.cloneElement(l, {
                            value: t,
                            max: o,
                            min: i,
                            onChange: n
                        }) : l : r(fe, {
                            isMixedValue: c,
                            textAlign: "right",
                            textStyle: "small",
                            value: t,
                            max: o,
                            min: i,
                            onChange: ({
                                value: h
                            }) => n(h)
                        })
                    })]
                }), r(b, {
                    position: "absolute",
                    bottom: "0",
                    left: "0",
                    width: "100%",
                    marginBottom: "-5px",
                    height: "8px",
                    zIndex: 10,
                    children: r(jM, {
                        max: o,
                        min: i,
                        value: c ? p : t,
                        onChange: n ? h => {
                            n(parseInt(h.target.value))
                        } : void 0
                    })
                })]
            })
        })
    }), HM = XV
});

function KV({
    selected: e,
    label: t,
    onClick: o,
    itemStyle: i,
    mixed: n = !1
}) {
    let [s, a] = (0, ea.useState)(!1), l = "blue";
    return (n && !e || s && !e) && (l = "gray"), r(b, {
        onClick: o,
        position: "relative",
        cursor: "pointer",
        padding: "4px 0 4px 24px",
        onMouseEnter: () => a(!0),
        onMouseLeave: () => a(!1),
        backgroundColor: e || s ? di(l, .2) : "white",
        children: r($, {
            textStyle: "small",
            color: e || s ? "black" : "gray",
            css: Z `
          ${i}
        `,
            children: t
        })
    })
}

function JV({
    value: e,
    items: t = [],
    onSelect: o,
    labelStyle: i,
    itemStyleFn: n,
    rightIcon: s,
    text: a,
    disabled: l,
    container: c,
    children: d,
    nested: p,
    onToggle: h,
    showBorder: u = !0,
    mixedLabel: m = "Mixed"
}) {
    let [f, g] = (0, ea.useState)(!1), [y, S] = (0, ea.useState)(!1), [w, v] = (0, ea.useState)(null), [C, I] = (0, ea.useState)(null), T = (0, ea.useMemo)(() => w ? w.getBoundingClientRect() : {}, [w]), {
        styles: P,
        attributes: M
    } = xa(w, C, {
        placement: "bottom",
        modifiers: [{
            name: "offset",
            options: {
                offset: [0, T.height * -1 || 0]
            }
        }]
    }), F = Array.isArray(e) ? e : [e].filter(Boolean), R = F.length > 0 ? F.map(z => t.find(V => V.value === z)) : [t[0]], A = R.length > 1, D = z => {
        w && (z.target && w && w.contains(z.target) || (h && h(!1), g(!1)))
    };
    (0, ea.useEffect)(() => (f ? window.addEventListener("click", D) : window.removeEventListener("click", D), () => {
        window.removeEventListener("click", D)
    }), [f]), (0, ea.useEffect)(() => () => {
        h && h(!1)
    }, []);
    let O = r(b, {
            ref: I,
            backgroundColor: "white",
            width: "calc(100% + 8px + 8px)",
            borderRadius: 8,
            border: "1px solid",
            borderColor: u ? "#F0F0F0" : "transparent",
            paddingTop: 16,
            paddingBottom: 16,
            zIndex: 102,
            style: P.popper,
            ...M.popper,
            children: t.map((z, V) => r(KV, {
                selected: !!R.find(X => z.value === X ? .value),
                mixed: A,
                label: z.label,
                itemStyle: n ? n(z) : void 0,
                onClick: () => {
                    o(z), h && h(!1), g(!1)
                }
            }, V))
        }),
        L = () => {
            l || (h && h(!f), g(!f))
        },
        W = A ? m : R[0] ? .label;
    return a && !A && (W = a), x(Q, {
        children: [d && typeof d == "function" ? d({
            toggleDropdown: L,
            ref: v
        }) : r(b, {
            height: 40,
            paddingLeft: "4rm",
            paddingRight: "4rm",
            children: x(b, {
                display: "flex",
                justifyContent: "space-between",
                alignItems: "center",
                position: "relative",
                cursor: l ? "initial" : "pointer",
                ref: v,
                onClick: L,
                onMouseEnter: () => S(!0),
                onMouseLeave: () => S(!1),
                height: "100%",
                borderBottom: "2px solid",
                borderColor: u ? di("gray", .24) : "transparent",
                paddingLeft: p ? "2rm" : 0,
                children: [r(K, {
                    height: "100%",
                    display: "block",
                    onClick: L,
                    variant: "clean",
                    lineHeight: 1,
                    disabled: l,
                    children: r($, {
                        textStyle: "small",
                        display: "block",
                        css: Z `
                  ${i||""}
                `,
                        children: W
                    })
                }), r(b, {
                    children: s || r(b, {
                        position: "relative",
                        left: "-1px",
                        top: "-2px",
                        children: r(K, {
                            onClick: L,
                            variant: "clean",
                            verticalAlign: "middle",
                            disabled: l,
                            children: r(Lt, {
                                color: y && !l ? "black" : "gray"
                            })
                        })
                    })
                })]
            })
        }), f ? c ? (0, UM.createPortal)(r(b, {
            children: O
        }), c) : O : null]
    })
}
var ea, UM, es, yd = k(() => {
    "use strict";
    ea = E(N()), UM = E(gi());
    wp();
    ie();
    en();
    Be();
    je();
    ve();
    B();
    es = JV
});

function QV(e, t = !0) {
    return t ? [Ko({
        editorState: e
    })] : e.getCurrentContent().getBlocksAsArray().map(i => Ko({
        editorState: e,
        block: i
    }))
}

function Xh(e, {
    textStyle: t,
    listStyle: o,
    allTextStyles: i,
    editorStates: n,
    isEditMode: s,
    stylePredicate: a
}, {
    some: l = !1
} = {}) {
    let c = qV[e],
        d = St[c];

    function p(u) {
        return typeof a == "function" ? a(u) : u ? ? d
    }
    if (t) {
        let u = p(t.cssProperties ? .[c]);
        return {
            raw: Array.from({
                length: n.length
            }, () => u),
            result: [u].flat()
        }
    } else if (o) {
        let u = p(o.cssProperties ? .[c]);
        return {
            raw: Array.from({
                length: n.length
            }, () => u),
            result: [u].flat()
        }
    }
    let h = n.map(u => {
        let m = Pi(u, e, s);
        if (!s && vf(u, e)) return m;
        let f = [];
        if (m.length) {
            if (l) return m;
            f.push(...m)
        }
        let y = QV(u, s).map(S => p(i.find(w => w.name === S) ? .cssProperties ? .[c])).filter(Boolean);
        return y.length && f.push(...y), f.length === 0 ? d : f
    });
    return {
        raw: h,
        result: h.flat(2)
    }
}

function _x(e) {
    let t, o;
    return [t, o] = e.split("|"), (!t || !o) && ([t, o] = e.split(" "), t = t.replace(/['"]+/g, "")), {
        code: t,
        value: Number(o)
    }
}

function GM(e) {
    return e.reduce((o, i) => {
        let {
            code: n,
            value: s
        } = _x(i);
        return !n || !s || (o[n] = s), o
    }, {})
}
var qV, VM, YM = k(() => {
    "use strict";
    mp();
    Ss();
    _s();
    Yt();
    qV = {
        FONT_WEIGHT: "fontWeight",
        FONT_FAMILY: "fontFamily",
        FONT_STYLE: "fontStyle",
        FONT_VARIABLE: "fontVariationSettings"
    }, VM = (e, t) => {
        let o = parseInt(e.replace(/\D/g, "")),
            i = parseInt(t.replace(/\D/g, ""));
        return t === "v" ? -1 : o !== i ? o - i : e.match(/^n/) ? -1 : 1
    }
});

function ob(e, t) {
    if (!t || !e) return "";
    if (e === "webtype") {
        let o = eG[t];
        if (o) return `${o} (ex. ${t})`
    }
    return t
}

function Kh() {
    let [e, t] = (0, tb.useState)([]), {
        edit_params: o
    } = window.RM.constructorRouter.fonts;
    (0, tb.useEffect)(() => {
        let n = () => {
            let s = o.get("fonts") || [];
            t([...s].sort((a, l) => a.name.localeCompare(l.name)))
        };
        return n(), o.on("change", n), () => {
            o.off("change", n)
        }
    }, [o]);

    function i(n) {
        return e.find(s => s.css_name === n)
    }
    return {
        fonts: e,
        getFontByName: i
    }
}
var tb, eG, ib = k(() => {
    "use strict";
    tb = E(N()), eG = {
        "Apres RE": "Montserrat",
        "Benton Modern RE": "Lora",
        "Benton Sans RE": "Open Sans",
        Calibri: "Open Sans",
        "Farnham Display": "Playfair Display",
        "Farnham Text": "Playfair Display",
        "Freight Big": "Playfair Display",
        "Georgia Pro": "Gelasio",
        "Gill Sans": "Cabin",
        "News Gothic": "News Cycle",
        Nitti: "Spline Sans Mono",
        Nobel: "Josefin Sans",
        Parkinson: "Lora",
        "Scout RE": "Noto Sans Display",
        "Sweet Sans": "Raleway",
        Telefon: "Jost",
        "Trio Grotesk": "Rubik"
    }
});

function nb({
    textStyle: e,
    listStyle: t,
    dropdownPortal: o,
    onChangeTextStyle: i,
    onToggleSelectPanel: n
}) {
    let [s, a] = (0, Nn.useState)(!1), {
        navigate: l
    } = (0, Nn.useContext)(Jt), {
        model: c,
        modelSet: d
    } = (0, Nn.useContext)(Y), [p, h] = c.useSharedState({
        group: !0,
        partial: !1
    }), [u] = Ii(), [m] = yk(), f = c.block ? .propsModel ? .get("isEditMode"), g = (0, Nn.useMemo)(() => [...u.global, ...u.project], [u]), y = (0, Nn.useMemo)(() => Xh("FONT_FAMILY", {
        textStyle: e,
        listStyle: t,
        allTextStyles: g,
        editorStates: p,
        isEditMode: f
    }, {
        some: f
    }).result, [e, t, g, f, p]), S = c.isMixed(y), w = (0, Nn.useMemo)(() => y.map(L => window.RM.constructorRouter.fonts.findFontByCSSName(L)), [y]), v = (0, Nn.useMemo)(() => Gd(...w.map(L => L.variations)), [w]), C = (0, Nn.useMemo)(() => Xh("FONT_WEIGHT", {
        textStyle: e,
        listStyle: t,
        allTextStyles: g,
        editorStates: p,
        isEditMode: f
    }, {
        some: f
    }), [e, t, g, f, p]), I = c.isMixed(C.result.map(L => L.toString())), T = (0, Nn.useMemo)(() => Xh("FONT_STYLE", {
        textStyle: e,
        listStyle: t,
        allTextStyles: g,
        editorStates: p,
        isEditMode: f
    }, {
        some: f
    }), [e, t, g, f, p]), P = (0, Nn.useMemo)(() => Xh("FONT_VARIABLE", {
        textStyle: e,
        listStyle: t,
        allTextStyles: g,
        editorStates: p,
        isEditMode: f,
        stylePredicate(L) {
            return typeof L == "string" ? L ? .split(", ") ? ? [] : []
        }
    }, {
        some: !0
    }), [e, t, g, f, p]), M = (0, Nn.useMemo)(() => GM(P.result), [P]), F = (0, Nn.useMemo)(() => {
        let L = y.reduce((W, z, V) => {
            let X = C.result[V],
                q = T.result[V],
                ne = m[vk({
                    fontFamily: z,
                    fontWeight: X,
                    fontStyle: q
                })] ? .variations;
            return ne && W.push(ne), W
        }, []);
        return LC(...L, "code")
    }, [y, C, T, m]), R = (0, Nn.useMemo)(() => {
        let L = P.result.filter(z => z.includes("wght")).map(z => _x(z).value).map(z => ip(Math.round(z / 100 * 100).toString(), St.fontStyle)),
            W = I ? C.raw.flatMap((z, V) => z.map((X, q) => ip(X, T.raw[V][q] ? ? St.fontStyle))) : ip(C.result[0], T.result[0]);
        return L.length ? Array.isArray(W) ? [...W, ...L] : [W, ...L] : W
    }, [I, C, T, P]);

    function A(L) {
        let {
            style: W,
            weight: z
        } = tr(L.value);
        d({
            preventClose: !1
        });
        let V = p.map(X => {
            let q = X,
                ne = X.getSelection().isCollapsed();
            return ne && (q = xr(q, f)), q = ff(q, "FONT_VARIABLE"), q = yi({
                key: "FONT_STYLE",
                value: W,
                editorState: q
            }), q = yi({
                key: "FONT_WEIGHT",
                value: z,
                editorState: q
            }), ne && (q = At(q, X.getSelection())), q
        });
        i ? i({
            fontWeight: z,
            fontStyle: W
        }) : h(V)
    }

    function D(L, W) {
        let z = e ? `'${L}' ${W}` : [L, W].join("|"),
            V = [],
            X = p.map((q, ne) => {
                let re = [...P.raw[ne]];
                V = re;
                let te = re.map((se, oe) => se.includes(L) ? oe : -1).filter(se => se > -1);
                if (te.length)
                    for (let se of te) re[se] = z;
                else re.push(z);
                let ee = q,
                    j = q.getSelection().isCollapsed();
                return j && (ee = xr(ee, f)), ee = yi({
                    key: "FONT_VARIABLE",
                    value: re,
                    editorState: ee
                }), j && (ee = At(ee, q.getSelection())), ee
            });
        i && V.length > 0 ? i({
            fontVariationSettings: V.join(", ")
        }) : h(X)
    }
    let O = null;
    return F.length > 0 ? O = F.map(L => {
        let W = c.isMixed(P.result.filter(z => z.includes(L.code)));
        return r(HM, {
            min: L.min,
            max: L.max,
            isMixed: W,
            onChange: z => D(L.code, z),
            value: M[L.code] ? ? L.defaultValue,
            title: r($, {
                width: "100%",
                maxWidth: 100,
                display: "block",
                textStyle: "small",
                overflow: "hidden",
                whiteSpace: "nowrap",
                textOverflow: "ellipsis",
                children: L.name
            })
        }, L.code)
    }) : v.length > 0 && (O = r(es, {
        disabled: v.length === 1,
        onToggle: n,
        onSelect: A,
        container: o,
        mixedLabel: "Mixed font weight",
        value: R,
        items: [...v].sort(VM).map(L => ({
            value: L,
            label: Rs[L]
        })),
        labelStyle: `
          font-family: ${y[0]}, sans-serif;
          font-weight: ${C.result[0]};
          font-style: ${T.result[0]};
          line-height: 1;
        `,
        itemStyleFn: L => {
            let {
                style: W,
                weight: z
            } = tr(L.value);
            return `
            font-style: ${W};
            font-weight: ${z};
            font-family: ${y[0]}, sans-serif;
            color: #000;
          `
        }
    })), x(Q, {
        children: [r(H, {
            onClick: () => l("FontsList"),
            leftSlot: r(K, {
                "data-testid": "select-text-font",
                width: "100%",
                height: "100%",
                textStyle: "small",
                display: "block",
                variant: "clean",
                lineHeight: 1,
                textAlign: "left",
                whiteSpace: "nowrap",
                overflow: "hidden",
                textOverflow: "ellipsis",
                fontFamily: `${y[0]}, sans-serif`,
                children: S ? "Mixed font" : ob(w[0].provider, w[0].name)
            }),
            rightSlot: r(K, {
                "data-testid": "select-text-font-icon",
                variant: "clean",
                verticalAlign: "middle",
                children: r(Lt, {
                    color: s ? "black" : "gray"
                })
            }),
            onMouseEnter: () => a(!0),
            onMouseLeave: () => a(!1)
        }), O]
    })
}
var Nn, Sx = k(() => {
    "use strict";
    je();
    $e();
    NM();
    yd();
    Be();
    en();
    oo();
    Nn = E(N());
    Fp();
    ae();
    ni();
    _s();
    Ss();
    qi();
    Yt();
    Tr();
    YM();
    ib();
    B()
});

function XM({
    isLinked: e,
    disabled: t = !1,
    isMixed: o,
    onClick: i
}) {
    let [n, s] = (0, bn.useState)(!1), a = e;
    return o && (a = !0), r(b, {
        display: "inline-block",
        onMouseEnter: () => s(!t),
        onMouseLeave: () => s(!1),
        children: r(dt, {
            color: a ? "blue" : "white",
            hoverColor: a ? "blue" : "white",
            activeColor: a ? "blue" : "white",
            marginRight: 0,
            height: 32,
            width: 32,
            onClick: i,
            disabled: t,
            css: Z `
          &:hover g {
            fill: none;
            stroke: ${a&&!n?"none":"white"};
          }

          ${o&&`background: linear-gradient(to right, ${ce.blue} 50%, white 50%);`}
        `,
            children: a ? r(ZM, {
                color: "white",
                mixed: o
            }) : n ? r(q0, {
                color: "gray"
            }) : r(ZM, {
                color: "gray"
            })
        })
    })
}
var bn, KM, ZM, tG, oG, JM, qM = k(() => {
    "use strict";
    bn = E(N());
    ie();
    Jr();
    je();
    Be();
    ir();
    Gj();
    P0();
    eH();
    en();
    tH();
    sH();
    lH();
    aH();
    OM();
    zt();
    nt();
    $e();
    Ss();
    qi();
    Dn();
    Tr();
    ni();
    _v();
    Yt(); of ();
    Yv();
    nf();
    lh();
    ae();
    KM = E(hn());
    _k();
    Mt();
    _s();
    Sh();
    Ps();
    ve();
    ut();
    pi();
    Fs();
    Zd();
    Sx();
    B();
    ZM = ue(J0)
    `
  ${({mixed:e,theme:t})=>e&&Z`
    rect: nth - child(2) {
        stroke: $ {
            t.colors.blue
        };
    }
    `}
`, tG = ue(b)
    `
  width: 58px;

  > input::placeholder {
    color: trans;
  }
`;
    oG = (0, bn.forwardRef)(({
        style: e,
        getScrollablePanelProps: t
    }, o) => {
        let {
            setSelectedTextStyle: i
        } = (0, bn.useContext)(tn), {
            model: n,
            modelSet: s
        } = (0, bn.useContext)(Y), [a, l] = n.useSharedState({
            group: !0,
            partial: !1
        }), c = a[0], {
            fontSize: d,
            fontSizeLinkStatus: p,
            letterSpacing: h,
            letterSpacingLinkStatus: u,
            lineHeight: m,
            ratio: f
        } = Sa(a, {
            listenFontFeaturesUpdates: !0
        }), [g, y] = Ii(), S = (0, bn.useMemo)(() => n.project.get("_id"), [n]), w = (0, bn.useMemo)(() => n.user.get("_id"), [n]), {
            navigate: v
        } = (0, bn.useContext)(Jt), {
            started: C
        } = cp();
        (0, bn.useEffect)(() => {
            C && st(["TextWidgetOpenPanel"])
        }, [C]);
        let I = (0, bn.useMemo)(() => a.map(oe => {
                let U = Ko({
                    editorState: oe
                });
                return [...g.global, ...g.project].find(xe => xe.name === U)
            }), [a, g]),
            T = I[0],
            P = n.isMixed(I.map(oe => oe ? .name)),
            {
                hasOneEditedStyle: M,
                hasMultipleEditedStyles: F
            } = (0, bn.useMemo)(() => {
                let oe = fh(c),
                    U = ch({
                        editorState: c
                    }),
                    he = !!(U && Object.keys(U).length > 0),
                    pe = !!Ga({
                        editorState: c
                    }),
                    le = !!Jd({
                        editorState: c
                    });
                return T ? {
                    hasOneEditedStyle: !!(oe && (Object.keys(oe).length || he || pe || le)),
                    hasMultipleEditedStyles: zk(c)
                } : {
                    hasOneEditedStyle: !1,
                    hasMultipleEditedStyles: !1
                }
            }, [c, T, g.global, g.project]),
            {
                isMultipleBlockSelected: R,
                hasDifferentStyles: A,
                hasMultipleFontSizes: D,
                hasMultipleLineHeights: O
            } = (0, bn.useMemo)(() => {
                let oe = op(c),
                    U = c.getCurrentContent(),
                    he = oe.map(le => U.getBlockForKey(le)),
                    xe = he.map(le => Ko({
                        editorState: c,
                        block: le
                    })),
                    pe = Vk({
                        editorState: c,
                        key: "FONT_SIZE",
                        defaultValue: T ? .cssProperties.fontSize
                    }),
                    J = (0, KM.uniq)(he.map(le => Jd({
                        editorState: c,
                        block: le
                    }) || St.lineHeight));
                return {
                    isMultipleBlockSelected: xe.length > 1,
                    hasDifferentStyles: xe.some(le => le !== xe[0]),
                    hasMultipleFontSizes: pe.length > 1,
                    hasMultipleLineHeights: J.length > 1
                }
            }, [T, c]),
            L = oe => g.global.includes(oe) ? "global" : "project",
            W = async oe => {
                let U = L(oe),
                    he = [...g[U]],
                    xe = he.findIndex(pe => pe.name === oe.name);
                if (xe > -1) {
                    let pe = he[xe],
                        J = fh(c),
                        le = Object.keys(J).reduce((Te, Re) => ({ ...Te,
                            [Re]: wk(Re, J[Re])
                        }), {}),
                        ye = op(c);
                    if (ye.length === 1 && ye[0]) {
                        let Te = c.getCurrentContent().getBlockForKey(ye[0]),
                            Re = ch({
                                block: Te
                            });
                        Re && (le.paddingTop = typeof Re.top == "number" ? Re.top : pe.cssProperties.paddingTop, le.paddingLeft = typeof Re.left == "number" ? Re.left : pe.cssProperties.paddingLeft, le.paddingRight = typeof Re.right == "number" ? Re.right : pe.cssProperties.paddingRight, le.paddingBottom = typeof Re.bottom == "number" ? Re.bottom : pe.cssProperties.paddingBottom);
                        let Tt = Ga({
                            block: Te
                        });
                        Tt && (le.textAlign = Tt.replace("align-", ""));
                        let Ee = Jd({
                            block: Te
                        });
                        Ee && (le.lineHeight = Ee)
                    }
                    he[xe] = { ...he[xe],
                        cssProperties: { ...he[xe].cssProperties,
                            ...le || {}
                        }
                    }, y({ ...g,
                        [U]: he
                    }), U === "global" ? await Ka({
                        userId: w,
                        styles: he
                    }) : await _a({
                        projectId: S,
                        styles: he
                    });
                    let Ue = a.map(Te => At(mh({
                        editorState: Te
                    }), Te.getSelection()));
                    l(Ue)
                }
            },
            z = oe => {
                let U = a.map(he => {
                    let xe = op(he),
                        pe = he.getCurrentContent();
                    return xe.reduce((J, le) => {
                        let ye = pe.getBlockForKey(le),
                            Ue = mh({
                                editorState: J,
                                block: ye
                            });
                        return Ue = Jk({
                            editorState: Ue,
                            styleName: oe.name,
                            block: ye
                        }), Ue
                    }, he)
                });
                l(U)
            },
            V = Qi("TextCanEditStyles"),
            X = V === !1 ? !1 : (M || F) && !(R && A);
        P && (X = !1);
        let [q, ne] = (0, bn.useState)(!1), re = oe => {
            let U = a.map((he, xe) => {
                let pe = d[xe],
                    J = m[xe],
                    le = u[xe],
                    ye = he,
                    Ue = he.getSelection().isCollapsed();
                if (Ue && (ye = xr(ye, n.block ? .propsModel ? .get("isEditMode"))), le) {
                    let Te = h[xe],
                        Re = Zs({
                            letterSpacing: Te,
                            fontSize: pe,
                            newFontSize: oe.fontSize
                        });
                    ye = yi({
                        key: "LETTER_SPACING",
                        value: Re,
                        editorState: ye
                    })
                }
                return oe.fontSize !== pe && (ye = yi({
                    key: "FONT_SIZE",
                    value: oe.fontSize,
                    editorState: ye
                })), oe.lineHeight !== J && (ye = ah({
                    editorState: ye,
                    lineHeight: oe.lineHeight
                })), Ue && (ye = At(ye, he.getSelection())), ye
            });
            l(U)
        }, te = (oe, U) => Math.floor(oe * Math.pow(10, U)) / Math.pow(10, U), ee = oe => s({
            preventClose: oe
        }), j = n.isMixed(p), se = T ? .label ? ? "No style";
        return (R && A || P) && (se = "Mixed style"), r(Me, {
            isShowed: n.selected,
            ref: o,
            style: e,
            ...t(),
            children: r(Ot.Consumer, {
                children: ({
                    dropdownContainer: oe
                }) => x(Q, {
                    children: [r(Ti, {
                        permission: "TextCanSelectStyles",
                        children: r(H, {
                            onMouseEnter: () => ne(!0),
                            onMouseLeave: () => ne(!1),
                            onClick: () => v("Styles"),
                            leftSlot: r(K, {
                                "data-testid": "select-text-style",
                                display: "block",
                                variant: "clean",
                                width: "100%",
                                height: "100%",
                                textOverflow: "ellipsis",
                                overflow: "hidden",
                                whiteSpace: "nowrap",
                                textAlign: "left",
                                lineHeight: "1",
                                children: r($, {
                                    textStyle: "small",
                                    color: X ? "tomato" : "black",
                                    children: se
                                })
                            }),
                            rightSlot: r(b, {
                                children: X ? x(b, {
                                    display: "flex",
                                    alignItems: "center",
                                    justifyContent: "flex-end",
                                    marginLeft: "1rm",
                                    children: [r(et, {
                                        text: "Reset selection to style",
                                        indent: 4,
                                        children: r(dt, {
                                            marginRight: "1rm",
                                            hoverColor: "tomato",
                                            color: "gray",
                                            height: 24,
                                            width: 24,
                                            unstyledHover: !0,
                                            onClick: U => {
                                                U.stopPropagation(), T && z(T)
                                            },
                                            css: Z `
                              &:hover svg {
                                color: #fff !important;
                              }
                            `,
                                            children: r(M0, {
                                                color: "white",
                                                height: 14,
                                                width: 13,
                                                position: "relative",
                                                left: "-1px",
                                                top: "-1px"
                                            })
                                        })
                                    }), r(et, {
                                        text: "Update style",
                                        indent: 4,
                                        children: r(dt, {
                                            disabled: F && !M,
                                            marginRight: "1rm",
                                            hoverColor: "tomato",
                                            color: "gray",
                                            height: 24,
                                            width: 24,
                                            unstyledHover: !0,
                                            onClick: U => {
                                                U.stopPropagation(), T && W(T)
                                            },
                                            css: Z `
                              &:hover svg {
                                color: #fff !important;
                              }
                            `,
                                            children: r(kf, {
                                                color: "white",
                                                height: 14,
                                                width: 13
                                            })
                                        })
                                    }), r(et, {
                                        text: "Edit style",
                                        indent: 4,
                                        children: r(dt, {
                                            disabled: F && !M,
                                            marginRight: 0,
                                            hoverColor: "blue",
                                            color: "gray",
                                            height: 24,
                                            width: 24,
                                            unstyledHover: !0,
                                            onClick: U => {
                                                U.stopPropagation(), i && i(T), v("StyleEdit")
                                            },
                                            css: Z `
                              &:hover svg {
                                color: #fff !important;
                              }
                            `,
                                            children: r(Nv, {
                                                color: "white",
                                                height: 14,
                                                width: 13
                                            })
                                        })
                                    })]
                                }) : T && V && !P ? r(et, {
                                    text: "Edit style",
                                    indent: 4,
                                    children: r(dt, {
                                        disabled: F && !M,
                                        marginRight: 0,
                                        hoverColor: "blue",
                                        color: "gray",
                                        height: 24,
                                        width: 24,
                                        unstyledHover: !0,
                                        onClick: U => {
                                            U.stopPropagation(), i && i(T), v("StyleEdit")
                                        },
                                        css: Z `
                            &:hover svg {
                              color: #fff !important;
                            }
                          `,
                                        children: r(Nv, {
                                            color: "white",
                                            height: 14,
                                            width: 13
                                        })
                                    })
                                }) : r(K, {
                                    variant: "clean",
                                    verticalAlign: "middle",
                                    children: r(Lt, {
                                        color: q ? "black" : "gray"
                                    })
                                })
                            })
                        })
                    }), r(Ti, {
                        permission: "TextCanChangeTypography",
                        children: r(nb, {
                            onToggleSelectPanel: ee,
                            dropdownPortal: oe
                        })
                    }), r(Ti, {
                        permission: "TextCanChangeTypography",
                        children: r(H, {
                            showBorder: !1,
                            children: x(Q, {
                                children: [x(b, {
                                    display: "flex",
                                    alignItems: "center",
                                    justifyContent: "center",
                                    children: [r(b, {
                                        textAlign: "center",
                                        width: "100%",
                                        children: r(b, {
                                            display: "flex",
                                            justifyContent: "center",
                                            children: r(U0, {
                                                color: "gray"
                                            })
                                        })
                                    }), r(b, {
                                        width: "100%",
                                        children: r(b, {
                                            display: "flex",
                                            width: 58,
                                            justifyContent: "center",
                                            children: r(XM, {
                                                "data-testid": "typography-font-size-linked",
                                                isMixed: j,
                                                isLinked: p[0],
                                                onClick: () => {
                                                    let U = j ? !0 : !p[0];
                                                    l(a.map(he => rf({
                                                        editorState: he,
                                                        linkedStatus: U
                                                    })))
                                                }
                                            })
                                        })
                                    }), r(b, {
                                        textAlign: "center",
                                        width: "100%",
                                        children: r(b, {
                                            display: "flex",
                                            justifyContent: "center",
                                            children: r(K0, {
                                                color: "gray"
                                            })
                                        })
                                    })]
                                }), r(ao, {
                                    targetSteps: "TextWidgetProperties",
                                    indent: 8,
                                    delay: 1400,
                                    leaveDelay: 100,
                                    position: "left",
                                    instance: !0,
                                    closeOnTargetClick: !0,
                                    componentsProps: {
                                        tooltip: {
                                            top: "18px",
                                            right: "10px"
                                        }
                                    },
                                    children: r(b, {
                                        marginLeft: "-1rm",
                                        marginRight: "-1rm",
                                        userSelect: "none",
                                        children: r(xx, {
                                            ratio: f[0],
                                            fontSize: d[0],
                                            minSize: de.minFontSize,
                                            lineHeight: m[0],
                                            linked: p[0],
                                            fontSizeLinked: u[0],
                                            multipleFontSizes: D || n.isMixed(d),
                                            multipleLineHeights: O || n.isMixed(m),
                                            multipleLinked: j,
                                            onChange: re
                                        })
                                    })
                                }), r(b, {
                                    display: "flex",
                                    justifyContent: "center",
                                    marginBottom: "8px",
                                    children: r(b, {
                                        width: 32,
                                        children: r(XM, {
                                            "data-testid": "typography-letter-spacing-linked",
                                            isMixed: n.isMixed(u),
                                            isLinked: u[0],
                                            disabled: h[0] === 0,
                                            onClick: () => {
                                                let U = n.isMixed(u) ? !0 : !u[0],
                                                    he = a.map(xe => {
                                                        let pe = xe,
                                                            J = xe.getSelection().isCollapsed();
                                                        return J && (pe = xr(pe, n.block ? .propsModel ? .get("isEditMode"))), pe = yi({
                                                            key: "IS_LINKED_LETTER_SPACING",
                                                            value: `${U}`,
                                                            editorState: pe
                                                        }), J && (pe = At(pe, xe.getSelection())), pe
                                                    });
                                                l(he)
                                            }
                                        })
                                    })
                                }), x(b, {
                                    display: "flex",
                                    alignItems: "flex-end",
                                    justifyContent: "center",
                                    children: [r(b, {
                                        textAlign: "right",
                                        children: r($, {
                                            textStyle: "small",
                                            color: "gray",
                                            children: "a"
                                        })
                                    }), r(tG, {
                                        width: 58,
                                        children: r(fe, {
                                            "data-testid": "typography-letter-spacing",
                                            textAlign: "center",
                                            placeholder: "LetterSpacing",
                                            textStyle: "regular",
                                            direction: "x",
                                            step: .1,
                                            shiftStep: 10,
                                            min: -99,
                                            max: 999,
                                            value: te(h[0], 2),
                                            isMixedValue: n.isMixed(h),
                                            color: u[0] ? "blue" : void 0,
                                            onChange: ({
                                                value: U
                                            }) => {
                                                let he = U || 0,
                                                    xe = a.map(pe => {
                                                        let J = pe,
                                                            le = pe.getSelection().isCollapsed();
                                                        return le && (J = xr(J, n.block ? .propsModel ? .get("isEditMode"))), J = yi({
                                                            key: "LETTER_SPACING",
                                                            value: he,
                                                            editorState: J
                                                        }), le && (J = At(J, pe.getSelection())), J
                                                    });
                                                l(xe)
                                            }
                                        })
                                    }), r(b, {
                                        textAlign: "left",
                                        children: r($, {
                                            textStyle: "small",
                                            color: "gray",
                                            children: "b"
                                        })
                                    })]
                                })]
                            })
                        })
                    })]
                })
            })
        })
    }), JM = oG
});

function iG({
    container: e,
    listItems: t,
    headerIcons: o,
    children: i,
    isCleanVariant: n = !1,
    onToggleDropdown: s,
    cursor: a,
    popperOffset: l,
    placement: c = "bottom",
    containerProps: d = {},
    ...p
}) {
    let [h, u] = (0, el.useState)(!1), [m, f] = (0, el.useState)(null), [g, y] = (0, el.useState)(null), S = (0, el.useMemo)(() => m ? m.getBoundingClientRect() : {}, [m]), {
        styles: w,
        attributes: v
    } = xa(m, g, {
        placement: c,
        modifiers: [{
            name: "offset",
            options: {
                offset: [0 + (l && l.length === 2 ? l[0] : 0), (S.height * -1 || 0) + (l && l.length ? l[1] : 0)]
            }
        }]
    }), C = P => {
        P.target && m && m.contains(P.target) || (u(!1), s && s(!1))
    };
    (0, el.useEffect)(() => () => {
        s && s(!1)
    }, []), (0, el.useEffect)(() => (h ? window.addEventListener("click", C) : window.removeEventListener("click", C), () => {
        window.removeEventListener("click", C)
    }), [h]);
    let I = () => {
            u(!h), s && s(!h)
        },
        T = x(b, {
            backgroundColor: "white",
            width: "calc(100% + 8px + 8px)",
            paddingTop: "16px",
            paddingBottom: "16px",
            borderRadius: 4,
            border: "1px solid #F0F0F0",
            boxShadow: "0 1px 2px 1px rgba(184, 184, 184, 0.16)",
            zIndex: 105,
            ref: y,
            style: w.popper,
            ...p,
            ...v.popper,
            children: [o && o.length ? r(b, {
                display: "flex",
                borderBottom: "1px solid",
                borderColor: "#EEEEEE",
                alignItems: "center",
                justifyContent: "flex-start",
                marginLeft: "24px",
                marginRight: "24px",
                paddingBottom: 14,
                marginBottom: "2rm",
                children: o.map((P, M) => r(dt, {
                    marginRight: M === o.length - 1 ? 0 : 3,
                    onClick: P.onClick,
                    hoverColor: "black",
                    color: "gray",
                    width: 24,
                    height: 24,
                    unstyledHover: !0,
                    children: P.icon
                }, M))
            }) : void 0, r(b, {
                children: t.map((P, M) => r(b, {
                    className: P.active ? "active" : "",
                    width: "100%",
                    height: typeof P.title == "string" ? "24px" : "auto",
                    display: P.hidden ? "none" : "flex",
                    alignItems: "center",
                    paddingLeft: "24px",
                    paddingRight: "24px",
                    backgroundColor: P.active ? Cx(P.activeVariant ? P.activeVariant : "active") : "initial",
                    ...P.props,
                    css: !P.disabled && Z `
                &:hover {
                  background-color: ${P.active?Cx(P.activeVariant?P.activeVariant:"active"):Cx(P.hoverVariant)};
                }
              `,
                    children: r(K, {
                        width: "100%",
                        position: "relative",
                        top: "-2px",
                        onClick: F => {
                            P.onClick(F), P.closeOnClick && u(!1)
                        },
                        variant: n ? "clean" : "unstyled",
                        textAlign: "left",
                        disabled: P.disabled,
                        children: typeof P.title == "string" ? r($, {
                            textStyle: "small",
                            color: "black",
                            children: P.title
                        }) : P.title
                    })
                }, M))
            })]
        });
    return x(Q, {
        children: [r(b, { ...d,
            position: "relative",
            cursor: a || "pointer",
            ref: f,
            children: i({
                toggleDropdown: I
            })
        }), h ? e ? (0, QM.createPortal)(T, e) : T : null]
    })
}
var el, QM, ui, Cx, Ho, ts = k(() => {
    "use strict";
    el = E(N()), QM = E(gi());
    wp();
    ie();
    Jr();
    je();
    Be();
    ve();
    B();
    ui = (e => (e.default = "default", e.active = "active", e.danger = "danger", e.unstyled = "unstyled", e))(ui || {}), Cx = e => {
        let t = "rgba(184, 184, 184, 0.2)";
        switch (e) {
            case "default":
                t = "rgba(184, 184, 184, 0.2)";
                break;
            case "active":
                t = "rgba(0, 128, 255, 0.2)";
                break;
            case "danger":
                t = "rgba(236, 82, 11, 0.2)";
                break;
            case "unstyled":
                t = "transparent";
                break
        }
        return t
    };
    Ho = iG
});

function tl({
    showBorder: e = !0,
    mixed: t = !1,
    fontFamily: o,
    onClick: i
}) {
    let [n, s] = (0, Qo.useState)(!1), {
        getFontByName: a
    } = Kh(), l = (0, Qo.useMemo)(() => {
        let c = a(o);
        return {
            family: c ? .css_name || o,
            name: c ? .name || o
        }
    }, [o, a]);
    return r(H, {
        showBorder: e,
        onMouseEnter: () => s(!0),
        onMouseLeave: () => s(!1),
        leftSlot: r(K, {
            textStyle: "small",
            display: "block",
            variant: "clean",
            lineHeight: 1,
            textAlign: "left",
            whiteSpace: "nowrap",
            overflow: "hidden",
            textOverflow: "ellipsis",
            fontFamily: l.family ? `${l.family}, sans-serif` : "inherit",
            children: t ? "Mixed font" : l.name
        }),
        rightSlot: r(b, {
            position: "relative",
            top: "-1px",
            left: "-1px",
            children: r(Lt, {
                color: n ? "black" : "gray"
            })
        }),
        onClick: i
    })
}

function nG({
    provider: e
}) {
    let t = {
        color: "gray",
        height: 24,
        width: 24
    };
    switch (e) {
        case "google":
            return r(G0, { ...t,
                width: 16
            });
        case "typekit":
            return r(S0, { ...t
            });
        case "typetoday":
            return r(gI, { ...t
            });
        case "webtype":
            return r(_I, { ...t,
                width: 17
            });
        default:
            return null
    }
}
var Qo, kx, rG, ta, rb = k(() => {
    "use strict";
    Qo = E(N());
    ie();
    or();
    Be();
    je();
    Jr();
    Cr();
    Rf();
    Ts();
    iH();
    Oj();
    _H();
    IH();
    en();
    qc();
    Lf();
    nt();
    $e();
    gn();
    ts();
    ut();
    ve();
    kx = E(MH());
    Tr();
    ae();
    ni();
    Yt();
    Wt();
    Mt();
    RH();
    ib();
    jr();
    Xs();
    B();
    rG = (0, Qo.forwardRef)(({
        style: e,
        headerSlot: t,
        navigatorRef: o,
        currentFontFamily: i = [],
        currentHiddenFont: n,
        panelPortalElement: s,
        onFontSelect: a,
        hideUpload: l,
        resizable: c = !0
    }, d) => {
        let {
            fonts: p
        } = Kh(), {
            model: h
        } = (0, Qo.useContext)(Y), {
            navigate: u
        } = (0, Qo.useContext)(Jt), {
            setSelectedFont: m
        } = (0, Qo.useContext)(tn), [f, g] = (0, Qo.useState)(de.textWidget.fontsListPanelDefaultHeight), [y, S] = (0, Qo.useState)(null), [w, v] = (0, Qo.useState)("all"), [C, I] = (0, Qo.useState)(!1), [T, P] = (0, Qo.useState)(null), M = (0, Qo.useRef)(null), F = h.project.get("num_id"), R = h.user.get("_id"), A = Array.isArray(i) ? i : [i], D = h.isMixed(A), O = (0, Qo.useMemo)(() => {
            let U = h.project ? .edit_params || h.project ? .attributes ? .edit_params;
            return U instanceof Backbone.Model ? U : new Backbone.Model(U)
        }, [h.project ? .edit_params]), L = (0, Qo.useMemo)(() => O.get("controls"), [O]), W = (0, Qo.useMemo)(() => L ? .FontsList, [L]), z = (0, Qo.useMemo)(() => p.filter(U => {
            if (w !== "all" && y) {
                if (w === "used") return y.has(U.css_name);
                if (w === "unused") return !y.has(U.css_name) && !U.hidden
            }
            return U.hidden ? n && U.css_name === n.css_name : !0
        }), [p, y, w, n]);
        (0, Qo.useEffect)(() => {
            M.current && M.current.scrollIntoView()
        }, []), (0, Qo.useEffect)(() => {
            W && g(W)
        }, [W]), Zv(kx.Key.ArrowUp, () => {
            let U = z.findIndex(xe => xe.css_name === A[0]),
                he = U === 0 ? z.length - 1 : U - 1;
            V(z[he])
        }, [z, A]), Zv(kx.Key.ArrowDown, () => {
            let U = z.findIndex(xe => xe.css_name === A[0]),
                he = U === z.length - 1 ? 0 : U + 1;
            V(z[he])
        }, [z, A]);
        let V = U => {
                m && m(U), a && typeof a == "function" && a(U)
            },
            X = async U => {
                window.RM.constructorRouter.fonts.changeFontHidden(U.css_name, !0, !window.RM.constructorRouter.isOwner && Al(h.user) ? window.RM.constructorRouter.mag.user.get("_id") : R, F)
            },
            q = async U => {
                window.RM.constructorRouter.fonts.changeFontHidden(U.css_name, !1, !window.RM.constructorRouter.isOwner && Al(h.user) ? window.RM.constructorRouter.mag.user.get("_id") : R, F)
            },
            ne = () => {
                if (be.isSubscriptionPaused(h.user)) {
                    window ? .RM ? .constructorRouter ? .trigger("notice:show", "unpauseSubscriptionToUploadFonts", {
                        canBeClosed: !0
                    });
                    return
                } else if (!Al(h.user)) {
                    Jo("upload-fonts");
                    return
                }
                m && m(void 0), u("FontUploader")
            },
            re = U => {
                if (!c) return;
                g(U);
                let he = h.project.edit_params.get("controls");
                h.project.edit_params.set("controls", { ...he,
                    FontsList: U
                }), h.project.edit_params.save()
            },
            te = async () => h.project.getUsedFontsNames(),
            ee = async U => {
                if (U !== w)
                    if (U !== "all") {
                        let he = await te();
                        he && (S(he), v(U))
                    } else v(U)
            },
            j = async () => {
                w !== "all" && v("all");
                let U = await te();
                if (U) {
                    S(U);
                    let he = p.filter(xe => !xe.hidden && !U.has(xe.css_name));
                    window.RM.constructorRouter.fonts.changeFontsHidden(he.map(xe => xe.css_name), !0, !window.RM.constructorRouter.isOwner && Al(h.user) ? window.RM.constructorRouter.mag.user.get("_id") : R, F)
                }
            },
            se = [{
                title: "Show all",
                onClick: () => {
                    ee("all")
                },
                active: w === "all"
            }, {
                title: "Show only used",
                onClick: () => {
                    ee("used")
                },
                active: w === "used"
            }, {
                title: "Show only unused",
                onClick: () => {
                    ee("unused")
                },
                active: w === "unused"
            }, {
                title: C ? x(b, {
                    height: "24px",
                    display: "flex",
                    justifyContent: "space-between",
                    alignItems: "center",
                    children: [r(b, {
                        onClick: () => j(),
                        "arial-label": "Delete all unused fonts",
                        children: r($, {
                            textStyle: "small",
                            color: "tomato",
                            css: Z `
                  &:hover {
                    color: ${ce.black};
                  }
                `,
                            children: "Delete"
                        })
                    }), r(b, {
                        onClick: U => {
                            U.stopPropagation(), I(!1)
                        },
                        "arial-label": "Cancel delete unused fonts",
                        children: r($, {
                            textStyle: "small",
                            color: "darkGray",
                            css: Z `
                  &:hover {
                    color: ${ce.black};
                  }
                `,
                            children: "Cancel"
                        })
                    })]
                }) : "Delete all unused",
                onClick: U => {
                    !C && U.stopPropagation(), !C && I(!0)
                },
                hoverVariant: ui.danger,
                activeVariant: ui.danger,
                active: C
            }],
            oe = "blue";
        return D && (oe = "gray"), x(Me, {
            ref: d,
            style: e,
            isShowed: !0,
            resizable: c,
            onResizeComplete: re,
            height: f,
            portalElement: s,
            children: [t || (o ? r(Ho, {
                cursor: "auto",
                popperOffset: [0, -8],
                listItems: se,
                children: ({
                    toggleDropdown: U
                }) => r(Ut, {
                    showBorder: !1,
                    leftSlot: r(K, {
                        "data-testid": "text-typography-back",
                        variant: "clean",
                        onClick: () => o.current && o.current.goBack(),
                        css: Z `
                      &:hover svg {
                        color: ${ce.black};
                        opacity: 1;
                      }
                    `,
                        children: r(_r, {
                            color: "darkGray"
                        })
                    }),
                    rightSlot: r(dt, {
                        height: 32,
                        width: 32,
                        color: "transparent",
                        hoverColor: "transparent",
                        activeColor: "transparent",
                        unstyledHover: !0,
                        unstyledActive: !0,
                        onClick: U,
                        css: Z `
                      &:hover svg {
                        color: ${ce.black};
                      }
                    `,
                        children: r(Xa, {
                            color: w !== "all" ? "blue" : "darkGray"
                        })
                    })
                })
            }) : null), r(b, {
                height: "calc(100% - 40px - 44px)",
                backgroundColor: "white",
                borderRadius: "8px 8px 0 0",
                children: r(xo, {
                    children: ({
                        ref: U
                    }) => r(b, {
                        ref: U,
                        paddingTop: 10,
                        children: z.map((he, xe) => x(b, {
                            ref: A[0] === he.css_name ? M : void 0,
                            paddingRight: 16,
                            position: "relative",
                            onClick: () => V(he),
                            cursor: "pointer",
                            children: [r(b, {
                                backgroundColor: T === xe && D ? "blue" : A.includes(he.css_name) ? oe : "gray",
                                opacity: A.includes(he.css_name) || T === xe ? .2 : 0,
                                position: "absolute",
                                top: 0,
                                left: 0,
                                width: "100%",
                                height: "100%",
                                zIndex: 0
                            }), x(b, {
                                paddingLeft: 16,
                                height: 26,
                                display: "flex",
                                alignItems: "center",
                                justifyContent: "space-between",
                                onMouseEnter: () => P(xe),
                                onMouseLeave: () => P(null),
                                position: "relative",
                                zIndex: 1,
                                children: [r($, {
                                    textStyle: "small",
                                    width: "100%",
                                    fontFamily: `${he.css_name}, sans-serif`,
                                    textOverflow: "ellipsis",
                                    overflow: "hidden",
                                    whiteSpace: "nowrap",
                                    textAlign: "left",
                                    children: ob(he.provider, he.name)
                                }), T === xe && x(b, {
                                    height: 16,
                                    width: 84,
                                    display: "flex",
                                    alignItems: "center",
                                    justifyContent: "flex-end",
                                    children: [r(b, {
                                        marginRight: 12,
                                        height: 16,
                                        display: "flex",
                                        alignItems: "center",
                                        children: r(nG, {
                                            provider: he.provider
                                        })
                                    }), n && n.css_name === he.css_name ? r(K, {
                                        onClick: pe => {
                                            pe.stopPropagation(), q(he)
                                        },
                                        display: "flex",
                                        alignItems: "center",
                                        marginRight: -5,
                                        height: 12,
                                        variant: "clean",
                                        disabled: !h.doesUserHaveAccess,
                                        children: r(Qt, {
                                            color: "gray"
                                        })
                                    }) : x(Q, {
                                        children: [he.is_personal ? r(b, {
                                            marginRight: 12,
                                            children: x(K, {
                                                onClick: pe => {
                                                    pe.stopPropagation(), m && m(he), u("FontUploader")
                                                },
                                                display: "flex",
                                                height: 16,
                                                variant: "clean",
                                                css: Z `
                                      &:hover svg {
                                        color: ${ce.black};
                                        opacity: 1;
                                      }
                                    `,
                                                children: ["\u200E", r(Za, {
                                                    color: "gray"
                                                })]
                                            })
                                        }) : null, r(K, {
                                            onClick: pe => {
                                                pe.stopPropagation(), X(he)
                                            },
                                            display: "flex",
                                            height: 12,
                                            variant: "clean",
                                            disabled: he.provider === "custom" ? !h.doesUserHaveAccess : !1,
                                            css: Z `
                                  &:hover svg {
                                    color: ${ce.red};
                                    opacity: 1;
                                  }
                                `,
                                            children: r(Nt, {
                                                color: "gray"
                                            })
                                        })]
                                    })]
                                })]
                            })]
                        }, `${he.css_name}-${xe}`))
                    })
                })
            }), x(b, {
                display: "flex",
                alignItems: "center",
                paddingTop: 10,
                paddingBottom: 10,
                children: [r(b, {
                    width: l ? "100%" : 80,
                    textAlign: "center",
                    children: r(K, {
                        textStyle: "small",
                        color: "darkGray",
                        onClick: () => {
                            window.RM.views.fontExplorer.toggle()
                        },
                        variant: "clean",
                        css: Z `
                &:hover {
                  color: ${ce.black};
                  opacity: 1;
                }
              `,
                        children: "Library"
                    })
                }), !l && x(Q, {
                    children: [r(b, {
                        width: "2px",
                        height: 24,
                        borderRadius: 2,
                        backgroundColor: "gray"
                    }), r(b, {
                        width: 80,
                        textAlign: "center",
                        children: r(K, {
                            textStyle: "small",
                            color: "darkGray",
                            onClick: ne,
                            variant: "clean",
                            css: Z `
                    &:hover {
                      color: ${ce.black};
                      opacity: 1;
                    }
                  `,
                            children: "Upload"
                        })
                    })]
                })]
            })]
        })
    }), ta = rG
});
var ol = k(() => {
    "use strict";
    rb();
    rb()
});
var vd, sG, sb, Ix = k(() => {
    "use strict";
    vd = E(N());
    ol();
    ae();
    Ss();
    Yt();
    qi();
    ib();
    B();
    sG = (0, vd.forwardRef)(({
        style: e,
        headerSlot: t,
        currentFontFamily: o = [],
        navigatorRef: i,
        onFontSelect: n
    }, s) => {
        let {
            model: a
        } = (0, vd.useContext)(Y), {
            getFontByName: l
        } = Kh(), [c] = Ii(), [d] = a.useSharedState({
            partial: !1
        }), p = Array.isArray(o) ? o : [o], h = (0, vd.useMemo)(() => {
            let m = Ko({
                editorState: d
            });
            if (m) return [...c.global, ...c.project].find(f => f.name === m)
        }, [d, c]), u = (0, vd.useMemo)(() => {
            let m = h ? [String(h.cssProperties.fontFamily)] : Pi(d, "FONT_FAMILY");
            if (m && m.length) {
                let f = l(m[0]);
                if (f && f.hidden && !f.is_personal) return f
            }
        }, [d, h, l]);
        return r(ta, {
            ref: s,
            style: e,
            headerSlot: t,
            navigatorRef: i,
            currentFontFamily: p,
            currentHiddenFont: u,
            onFontSelect: n
        })
    }), sb = sG
});

function aG({
    cancelText: e = "Cancel",
    doneText: t = "Save",
    cancelAction: o,
    doneAction: i,
    cancelDisabled: n,
    doneDisabled: s
}) {
    return x(b, {
        display: "flex",
        alignItems: "flex-end",
        justifyContent: "space-between",
        height: 64,
        paddingBottom: 10,
        paddingLeft: 16,
        paddingRight: 16,
        children: [r(b, {
            children: r(K, {
                "data-testid": "panel-action-cancel",
                variant: "clean",
                onClick: o,
                disabled: n,
                children: e
            })
        }), r(b, {
            children: r(K, {
                "data-testid": "panel-action-done",
                variant: "clean",
                onClick: i,
                disabled: s,
                color: s ? "gray" : "blue",
                css: Z `
            &:disabled {
              opacity: 1;
            }
          `,
                children: t
            })
        })]
    })
}
var qp, ab = k(() => {
    "use strict";
    ie();
    je();
    ve();
    B();
    qp = aG
});
var ji, lG, cG, Ta, Qp = k(() => {
    "use strict";
    ji = E(N());
    nt();
    yd();
    $e();
    gj();
    Fp();
    ni();
    ab();
    Tr();
    Yt();
    ae();
    ie();
    Ur();
    je();
    Ts();
    id();
    qt();
    ve();
    ut();
    B();
    lG = Object.keys(Rs), cG = (0, ji.forwardRef)(({
        style: e,
        headerSlot: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, ji.useContext)(Y), {
            goBack: s
        } = (0, ji.useContext)(Jt), {
            selectedFont: a
        } = (0, ji.useContext)(tn), [l, c] = (0, ji.useState)(null), [d, p] = (0, ji.useState)(""), [h, u] = (0, ji.useState)([]), [m, f] = (0, ji.useState)(null), [g, y] = (0, ji.useState)(!1), S = i.project.get("num_id"), w = i.user.get("_id");
        (0, ji.useEffect)(() => {
            a && (c(a._id), lk(a._id).then(({
                data: L
            }) => {
                p(L.name), u(L.variations)
            }))
        }, []), (0, ji.useEffect)(() => {
            m && setTimeout(() => {
                f(null)
            }, 4e3)
        }, [m]);
        let [v, C] = (0, ji.useState)(null), I = async L => {
            y(!0);
            try {
                let W = await sk(L);
                De(Fe.WidgetFeature, {
                    featureType: "custom font"
                });
                let z = {
                    type: v || "n4"
                };
                W.woffUrl ? z.woff = W.woffUrl : W.woff2Url ? z.woff2 = W.woff2Url : W.otfUrl ? z.otf = W.otfUrl : W.ttfUrl && (z.ttf = W.ttfUrl), u([...h, z])
            } catch (W) {
                f(W.message || "Uploading error")
            }
            y(!1), C(null)
        }, T = async () => {
            try {
                let {
                    data: L
                } = await ak({
                    is_personal: !0,
                    name: d,
                    variations: h,
                    mag_user: !window.RM.constructorRouter.isOwner && Al(i.user) ? window.RM.constructorRouter.mag.user.get("_id") : w,
                    mag_num_id: S
                });
                await window.RM.constructorRouter.fonts.addFonts([{ ...L,
                    variations: L.variations.map(W => W.type)
                }], "font-upload"), s()
            } catch {
                f("Saving error")
            }
        }, P = async () => {
            if (l) try {
                let {
                    data: L
                } = await ck(l, {
                    name: d,
                    variations: h,
                    mag_user: !window.RM.constructorRouter.isOwner && Al(i.user) ? window.RM.constructorRouter.mag.user.get("_id") : w,
                    mag_num_id: S
                });
                await window.RM.constructorRouter.fonts.addFonts([{ ...L,
                    variations: L.variations.map(W => W.type)
                }], "font-upload"), s()
            } catch {
                f("Update error")
            }
        }, M = h.map(L => L.type), F = new Set(M).size !== M.length, R = h.some(L => L.type === "v"), A = lG.filter(L => h.length > 1 && !R ? L !== "v" : L).map(L => ({
            value: L,
            label: Rs[L]
        })), D = (0, ji.useRef)(null), O = (0, ji.useRef)(null);
        return x(Me, {
            isShowed: i.selected,
            ref: o,
            style: e,
            children: [t || null, r(H, {
                leftSlot: r(Mo, {
                    textStyle: "small",
                    value: d,
                    onChange: L => p(L.target.value),
                    placeholder: "Font name",
                    borderBottom: "none !important",
                    padding: "0"
                })
            }), r(b, {
                position: "relative",
                ref: O
            }), h.map((L, W) => r(es, {
                onToggle: z => n({
                    preventClose: z
                }),
                container: O ? O.current : void 0,
                items: A,
                value: L.type,
                onSelect: z => {
                    let V = [...h];
                    V[W].type = z.value, u(V)
                },
                rightIcon: r(K, {
                    onClick: () => {
                        let z = [...h];
                        z.splice(W, 1), u(z)
                    },
                    variant: "clean",
                    children: r(Nt, {
                        color: "gray"
                    })
                })
            }, W)), R ? void 0 : x(Q, {
                children: [r(es, {
                    onToggle: L => n({
                        preventClose: L
                    }),
                    container: O ? O.current : void 0,
                    items: A,
                    value: void 0,
                    onSelect: L => {
                        C(L.value), D.current && D.current.click()
                    },
                    children: ({
                        toggleDropdown: L,
                        ref: W
                    }) => r(b, {
                        ref: W,
                        children: r(H, {
                            showBorder: !1,
                            leftSlot: r(K, {
                                width: m ? "100%" : "auto",
                                variant: "clean",
                                onClick: g ? void 0 : L,
                                color: m ? "red" : "darkGray",
                                textStyle: "small",
                                whiteSpace: "normal",
                                css: Z `
                        &:hover {
                          color: ${ce.black};
                        }
                      `,
                                children: m || (g ? "Uploading..." : h.length ? "Add another weight" : "Add weight")
                            })
                        })
                    })
                }), r(vi, {
                    ref: D,
                    onChange: I,
                    dropFile: !0,
                    readFileData: !1
                })]
            }), r(qp, {
                cancelAction: s,
                doneDisabled: !h.length || !d.length || F,
                doneAction: l ? P : T
            })]
        })
    }), Ta = cG
});
var eR, dG, eu, Px = k(() => {
    "use strict";
    eR = E(N());
    ie();
    ve();
    B();
    dG = (0, eR.forwardRef)(({
        icon: e,
        leftIcon: t,
        rightIcon: o,
        disabled: i,
        showBorder: n = !0
    }, s) => r(b, {
        height: 40,
        paddingLeft: 16,
        paddingRight: 16,
        children: x(b, {
            ref: s,
            height: "100%",
            width: "100%",
            display: "grid",
            position: "relative",
            gridTemplateColumns: "repeat(3, 1fr)",
            gridTemplateAreas: "'left center right'",
            borderBottom: "2px solid",
            borderColor: n ? di("gray", .24) : "transparent",
            opacity: i ? .4 : 1,
            pointerEvents: i ? "none" : "initial",
            children: [t && r(b, {
                height: "100%",
                width: "100%",
                display: "flex",
                alignItems: "center",
                justifyContent: "flex-start",
                gridArea: "left",
                children: t
            }), r(b, {
                height: "100%",
                width: "100%",
                display: "flex",
                alignItems: "center",
                justifyContent: "center",
                gridArea: "center",
                children: e
            }), o && r(b, {
                height: "100%",
                width: "100%",
                display: "flex",
                alignItems: "center",
                justifyContent: "flex-end",
                gridArea: "right",
                children: o
            })]
        })
    })), eu = dG
});
var lb, pG, uG, hG, cb, Tx = k(() => {
    "use strict";
    lb = E(N()), pG = ({
        callback: e,
        delay: t,
        registerCancel: o
    }) => {
        let i = new Date().getTime(),
            n = () => {
                if (new Date().getTime() - i >= t) {
                    e(), o(() => {});
                    return
                }
                let a = requestAnimationFrame(n);
                o(() => cancelAnimationFrame(a))
            },
            s = requestAnimationFrame(n);
        o(() => cancelAnimationFrame(s))
    }, uG = () => {
        let e = (0, lb.useRef)(() => {}),
            t = i => e.current = i,
            o = () => e.current();
        return (0, lb.useEffect)(() => o, []), [t, o]
    }, hG = ({
        onClick: e,
        onDoubleClick: t,
        delay: o = 160
    }) => {
        let [i, n] = uG();
        return {
            onClick: e ? s => {
                n(), pG({
                    callback: () => e(s),
                    delay: o,
                    registerCancel: i
                })
            } : void 0,
            onDoubleClick: t ? s => {
                n(), t(s)
            } : void 0
        }
    }, cb = hG
});

function mG(e, t) {
    return e / (t / tR)
}

function fG({
    styles: e
}) {
    return x(b, {
        display: "flex",
        gap: 4,
        alignItems: "center",
        children: [x($, {
            color: "gray",
            textStyle: "small",
            children: [e.fontSize, "/", e.lineHeight]
        }), r(b, {
            width: 24,
            height: 24,
            borderRadius: "100%",
            border: "1px solid",
            borderColor: di("gray", .16),
            backgroundColor: ek(e.color)
        })]
    })
}

function gG({
    dropdownPortal: e,
    listItems: t,
    index: o,
    style: i,
    isActive: n,
    selectStyle: s,
    onToggleDropdown: a,
    enterEditMode: l,
    editable: c,
    isMixed: d = !1
}) {
    let {
        isHovered: p,
        ...h
    } = nr(!1), u = pt("constructor.styleSizesPreview"), [m, f] = (0, tu.useState)(!0), g = (0, tu.useRef)(null);
    (0, tu.useEffect)(() => {
        n && m && g.current && g.current.scrollIntoView(), f(!1)
    }, [n, g, m, f]);
    let y = "blue";
    d && (y = "gray");
    let S = c && p;
    return r(Ho, {
        container: e ? e.current : void 0,
        listItems: t,
        onToggleDropdown: a,
        children: ({
            toggleDropdown: w
        }) => x(b, {
            ref: g,
            position: "relative",
            cursor: "pointer",
            maxHeight: "80px",
            minHeight: "34px",
            overflow: "hidden",
            userSelect: "none",
            ...h,
            children: [r(b, {
                backgroundColor: p && d ? "blue" : n ? y : "gray",
                opacity: p || n ? .2 : 0,
                position: "absolute",
                top: 0,
                left: 0,
                width: "100%",
                height: "100%",
                zIndex: 0
            }), x(b, {
                display: "flex",
                maxHeight: "80px",
                minHeight: "34px",
                paddingLeft: 16,
                paddingRight: 16,
                paddingTop: "8px",
                paddingBottom: "8px",
                justifyContent: "space-between",
                alignItems: "center",
                position: "relative",
                children: [r(b, {
                    className: kr(i) ? i.name : `${i.name}-preview`,
                    ...cb({
                        onClick: () => s(i),
                        onDoubleClick: () => c && l && l(i)
                    }),
                    color: u ? "black !important" : void 0,
                    style: {
                        width: "100%",
                        padding: 0,
                        textAlign: "left",
                        maxWidth: 108,
                        overflow: "hidden",
                        whiteSpace: "nowrap",
                        textOverflow: "ellipsis",
                        lineHeight: 1,
                        minHeight: u ? 24 : 20,
                        ...u && {
                            fontSize: tR,
                            letterSpacing: mG(i.cssProperties.letterSpacing, i.cssProperties.fontSize),
                            lineHeight: "24px"
                        }
                    },
                    children: i.label
                }), S ? r(b, {
                    children: r(K, {
                        height: 16,
                        marginRight: 12,
                        onClick: w,
                        variant: "clean",
                        children: r(Xa, {
                            color: "black"
                        })
                    })
                }) : u ? r(fG, {
                    styles: i.cssProperties
                }) : null]
            })]
        })
    }, o)
}
var tu, tR, oR, iR = k(() => {
    "use strict";
    tu = E(N());
    ts();
    ie();
    je();
    Lf();
    Tx();
    od();
    Be();
    FI();
    ko();
    ve();
    En();
    B();
    tR = 12;
    oR = gG
});

function ou({
    onBeforeDragStart: e,
    onDragStart: t,
    children: o,
    idList: i,
    isDragOff: n,
    onDragEnd: s,
    onAfterDragEnd: a,
    unionOn: l
}) {
    let [c, d] = (0, tt.useState)({
        startX: 0,
        startY: 0,
        refList: {},
        dropableList: {},
        originalDropable: "",
        draggableRef: null,
        origDropableRef: null,
        origDragableIdx: 0,
        draggableId: "",
        flatList: [],
        excluded: []
    }), p = (0, tt.useRef)([]), [h, u] = (0, tt.useState)({
        isDragOff: !!n
    }), m = l ? .8 : .5, {
        startY: f,
        refList: g,
        dropableList: y,
        originalDropable: S,
        draggableRef: w,
        origDropableRef: v,
        origDragableIdx: C,
        draggableId: I,
        flatList: T,
        excluded: P
    } = c, M = (0, tt.useRef)(!1), [F, R] = (0, tt.useState)(!1), A = (0, tt.useRef)(!1), D = (0, tt.useRef)(!1), O = ot => {
        A.current = ot, R(ot)
    }, L = (0, tt.useRef)(!1), W = (0, tt.useRef)(0), z = (0, tt.useRef)(0), V = (0, tt.useRef)(0), X = (0, tt.useRef)(0), q = (0, tt.useRef)(0), ne = (0, tt.useRef)(0), re = (0, tt.useRef)(""), te = (0, tt.useRef)(null), ee = (0, tt.useRef)(void 0), j = (0, tt.useRef)(void 0), se = (0, tt.useRef)(50), oe = (0, tt.useRef)(0), U = (0, tt.useRef)(0), he = (0, tt.useRef)(0), xe = (0, tt.useRef)(0), pe = (0, tt.useRef)(0), [J, le] = (0, tt.useState)(""), ye = (0, tt.useRef)(""), Ue = ot => {
        ye.current = ot, le(ot)
    }, [Te, Re] = (0, tt.useState)(""), Tt = (0, tt.useRef)(""), Ee = ot => {
        Tt.current = ot, Re(ot)
    }, Qe = () => {
        for (let ot in g) {
            let Ct = g[ot];
            Ct.current && (Ct.current.style.transform = "", Ct.current.style.zIndex = "", Ct.current.style.border = "", Ct.current.style.opacity = "", Ct.current.style.background = "", Ct.current.style.cursor = "")
        }
        for (let ot in y) {
            let Ct = y[ot].ref;
            Ct && Ct.current && (Ct.current.style.marginBottom = "", Ct.current.style.paddingBottom = "", Ct.current.style.height = ""), y[ot].deltaSize = 0
        }
    }, Ua = {
        pushDraggableRef: (ot, Ct) => {
            g[ot] = Ct, Ct.current && (Ct.current.className += " sortable-item")
        },
        pushDropableRef: (ot, Ct, Fi) => {
            y[Ct] = {
                ref: ot,
                parentId: Fi,
                deltaSize: 0
            }, ot.current && (ot.current.className += " sortable-dropable")
        },
        setDraggable: (ot, Ct, Fi, ci, Po, cn) => {
            if (!c.draggableId && ot && Fi && Fi.current) {
                let mi = e ? e(ot) : [],
                    vt = rR(i);
                mi.length && (vt = (0, nc.filter)(vt, we => !mi.includes(we.id)));
                let {
                    ref: dn,
                    parentId: Co
                } = y[Ct], Di = (0, nc.filter)(vt, we => Co ? we.parentId === Co : !we.parentId == !Co), pn = Fi.current.getBoundingClientRect();
                q.current = (0, nc.findIndex)(Di, {
                    id: ot
                }), W.current = ci, z.current = Po, V.current = Po;
                let Dt = {
                    startX: ci,
                    startY: Po,
                    draggableId: ot,
                    draggableRef: Fi,
                    flatList: vt,
                    excluded: mi,
                    originalDropable: Ct,
                    origDropableRef: dn,
                    origDragableIdx: q.current
                };
                Ee(Co), se.current = pn.height, ne.current = 0, ee.current = dn, re.current = Ct, p.current = Di, L.current = !1, X.current = 0, j.current = cn, oe.current = cn.current && cn.current.scrollTop || 0, F && O(!1);
                for (let we in y)
                    if (!y[we].parentId) {
                        let mt = y[we].ref;
                        if (mt && mt.current) {
                            te.current = mt.current;
                            let $o = mt.current.getBoundingClientRect();
                            U.current = $o.top, he.current = $o.bottom, xe.current = $o.left, pe.current = $o.right
                        }
                    }
                d(we => ({ ...we,
                    ...Dt
                }))
            }
        }
    }, Xi = (0, tt.useRef)(0), Nd = ot => {
        Xi.current && (clearTimeout(Xi.current), Xi.current = 0), Xi.current = setTimeout(() => {
            Ue(ot), Xi.current = 0
        }, 800)
    }, ga = () => {
        Ue(void 0), Xi.current && (clearTimeout(Xi.current), Xi.current = 0)
    };
    (0, tt.useEffect)(() => {
        u(ot => ({ ...ot,
            isDragOff: !!n
        }))
    }, [n]);
    let Ud = ot => {
            let Ct = y[ot].ref;
            if (!Ct.current) return;
            let Fi = y[ot].deltaSize;
            if (!Fi) {
                Ct.current.style.height = "";
                return
            }
            Ct.current.style.height = "auto";
            let ci = Ct.current.getBoundingClientRect();
            Ct.current.style.height = `${ci.height+Fi}px`
        },
        Tl = (0, tt.useCallback)(ot => {
            let Ct = () => {
                    if (!I || !w || !w.current) return;
                    let Po = w.current.getBoundingClientRect().height;
                    p.current.forEach(({
                        id: cn
                    }, mi) => {
                        let vt = g[cn];
                        vt && vt.current && (ee.current !== v ? ee.current && ee.current.current && v && v.current && (v.current.contains(ee.current.current) ? mi < q.current + X.current ? vt.current.style.transform = "translateY(0px)" : vt.current.style.transform = `translateY(${+Po}px)` : mi < q.current + X.current ? vt.current.style.transform = "translateY(0px)" : vt.current.style.transform = `translateY(${Po}px)`) : mi !== q.current && (mi < Math.min(q.current, q.current + X.current) || mi > Math.max(q.current, q.current + X.current) ? vt.current.style.transform = "translateY(0px)" : X.current < 0 ? vt.current.style.transform = `translateY(${+Po}px)` : vt.current.style.transform = `translateY(${-Po}px)`))
                    }), w && w.current && (w.current.style.transform = `translateY(${z.current-f+ne.current}px)`), ye.current = void 0, ga(), L.current = !1
                },
                Fi = (ci, Po) => {
                    if (A.current) {
                        let cn = ci.getBoundingClientRect(),
                            mi = Po.getBoundingClientRect();
                        if (cn.top - mi.top < 10 && Po.scrollTop > 0) D.current = !0, Po.scrollTop -= 15, Tl(!0), nR(() => {
                            Fi(ci, Po)
                        });
                        else if (mi.bottom - cn.bottom < 10 && Po.clientHeight + Po.scrollTop < Po.scrollHeight) D.current = !0, Po.scrollTop += 15, Tl(!0), nR(() => {
                            Fi(ci, Po)
                        });
                        else if (D.current) {
                            if (D.current = !1, te.current) {
                                let vt = te.current.getBoundingClientRect();
                                U.current = vt.top, he.current = vt.bottom
                            } else
                                for (let vt in y)
                                    if (!y[vt].parentId) {
                                        let dn = y[vt].ref;
                                        if (dn && dn.current) {
                                            let Co = dn.current.getBoundingClientRect();
                                            U.current = Co.top, he.current = Co.bottom
                                        }
                                    }
                        }
                    }
                };
            if (!(!I || L.current)) {
                if (A.current) D.current || j.current && j.current.current && w && w.current && Fi(w.current, j.current.current);
                else if (Math.abs(z.current - f) >= 5) {
                    M.current = !1, t && t(), w && w.current && (w.current.style.zIndex = "100000", w.current.style.cursor = "pointer"), O(!0);
                    return
                } else return;
                if (w && w.current && ee.current && ee.current.current) {
                    let ci = w.current.getBoundingClientRect(),
                        Po = parseInt((w.current.style.transform || "0").replace(/[^\-0-9]/g, "")),
                        cn = U.current - (ci.top - Po),
                        mi = he.current - (ci.bottom - Po),
                        vt = z.current - f + ne.current + (j.current && j.current.current ? j.current.current.scrollTop - oe.current : 0),
                        dn = Math.min(mi, Math.max(cn, vt));
                    if (w.current.style.transform = `translateY(${dn}px)`, ot) return;
                    if (j.current && j.current.current) {
                        let Mn = j.current.current.getBoundingClientRect();
                        if (ci.top - Mn.top < 10) return;
                        if (Mn.bottom - ci.bottom < 10) return
                    }
                    se.current = ci.height;
                    let Co = X.current,
                        Di = z.current - V.current,
                        pn = w.current.getBoundingClientRect(),
                        Dt = (pn.left + pn.right) / 2,
                        we = Di > 0 ? pn.bottom + 2 : pn.top - 2,
                        mt = document.elementFromPoint(Dt, we),
                        $o = mt && mt.closest(".sortable-item"),
                        qn = mt && mt.closest(".sortable-dropable"),
                        eh = (Mn, Ys = 0) => {
                            let bs = y[Mn],
                                Ki = (0, nc.filter)(T, Ji => bs.parentId ? Ji.parentId === bs.parentId : !Ji.parentId == !bs.parentId);
                            y[Mn].deltaSize += se.current, Ud(Mn), y[re.current].deltaSize -= se.current, Ud(re.current), p.current.forEach(({
                                id: Ji
                            }, Wc) => {
                                let ys = g[Ji];
                                re.current === S ? ys && ys.current && Wc !== q.current && (Wc < q.current ? ys.current.style.transform = "" : ys.current.style.transform = `translateY(-${se.current}px)`) : ys && ys.current && (ys.current.style.transform = "")
                            });
                            let Rn = Ki.find(Ji => Ji.id === y[re.current].parentId);
                            Rn ? Mn === S ? (q.current = C, X.current = Ys > 0 ? Ki.indexOf(Rn) + 1 - C : Ki.indexOf(Rn) - C) : (q.current = 0, X.current = Ys > 0 ? Ki.indexOf(Rn) + 1 : Ki.indexOf(Rn)) : Mn === S ? (X.current = Co > X.current ? -C : Ki.length - C, q.current = C) : (q.current = 0, X.current = Ys > 0 ? 0 : Ki.length);
                            let ya = p.current.findIndex(Ji => Ji.id === bs.parentId),
                                Ci = Rn ? Ki.indexOf(Rn) : -1;
                            ya !== -1 && C > ya && Mn !== S || Ci !== -1 && q.current + X.current <= Ci && Mn !== S ? ne.current = -se.current : ne.current = 0, Ee(bs.parentId), ee.current = bs.ref, re.current = Mn, p.current = Ki, V.current = z.current, L.current = !0, Ct()
                        };
                    if (Di > 0 && vt - mi > 8 && Tt.current) {
                        eh("0", Di);
                        return
                    }
                    if ($o && ee.current && ee.current.current) {
                        let Mn = $o.getBoundingClientRect(),
                            Ys = Di > 0 ? pn.bottom - Mn.top : Mn.top + se.current - pn.top,
                            Ki = Object.keys(g).find(Ci => g[Ci].current === $o);
                        if (qn && qn !== ee.current.current) {
                            let Ci = Object.keys(y).find(Ji => y[Ji].ref.current && y[Ji].ref.current === qn);
                            if (Ci && Ys > 8) {
                                eh(Ci, Di);
                                return
                            }
                        }
                        let Rn = p.current.findIndex(Ci => Ci.id === Ki),
                            ya = p.current.findIndex(Ci => Ci.id === I);
                        if (Rn !== -1) {
                            let Ci = p.current[Rn],
                                Ji = 0;
                            ya !== -1 && ya <= Rn && Di < 0 && (Ji = -1), ya !== -1 && ya >= Rn && Di > 0 && (Ji = 1);
                            let Wc = Math.abs(Rn + Ji - (q.current + X.current)) > 1 || Ys > se.current * m;
                            if (!Wc && Ys > se.current * .2 && !Tt.current && !Xi.current ? Nd(Ki) : ye.current && ye.current !== Ki && Xi.current && ga(), Wc) {
                                if (Ci.items) {
                                    let ys = Object.keys(y).find(Vm => y[Vm].ref.current && y[Vm].parentId === Ci.id);
                                    if (ys) {
                                        eh(ys, Di);
                                        return
                                    }
                                }
                                Co = Rn - q.current, Co === X.current && (Co += Di > 0 ? 1 : -1)
                            }
                        }
                    } else ga();
                    X.current !== Co && (X.current = Co, L.current = !0, Ct()), V.current = z.current
                } else ga()
            }
        }, [f, X, F]),
        Bl = ot => {
            re.current && (A.current && ot.preventDefault(), W.current = ot.screenX, z.current = ot.screenY, Tl())
        },
        gs = ot => {
            M.current && (M.current = !1), A.current && (ot.preventDefault(), O(!1), s && (ye.current ? s(I, ye.current, 0, P) : s(I, Tt.current, q.current + X.current, P)), a && a(), ga(), Qe()), d(Ct => ({ ...Ct,
                draggableIdx: 0,
                draggableId: "",
                dIdx: 0
            })), re.current = ""
        },
        Jn = ot => ot.preventDefault(),
        ba = ot => ot.preventDefault(),
        $c = ot => {
            ot.preventDefault(), window.removeEventListener("click", $c, {
                capture: !0
            })
        };
    return (0, tt.useEffect)(() => (M.current || A.current ? (window.removeEventListener("click", ba, {
        capture: !0
    }), window.removeEventListener("mousedown", Jn, {
        capture: !0
    }), window.addEventListener("click", ba, {
        capture: !0
    }), window.addEventListener("mousedown", Jn, {
        capture: !0
    })) : (window.addEventListener("click", $c, {
        capture: !0
    }), setTimeout(() => {
        window.removeEventListener("click", $c, {
            capture: !0
        })
    }, 800), window.removeEventListener("click", ba, {
        capture: !0
    }), window.removeEventListener("mousedown", Jn, {
        capture: !0
    })), () => {
        window.removeEventListener("click", ba, {
            capture: !0
        }), window.removeEventListener("mousedown", Jn, {
            capture: !0
        })
    }), [M.current, A.current]), (0, tt.useEffect)(() => (I ? (M.current = !0, window.addEventListener("mousemove", Bl, {
        capture: !0
    }), window.addEventListener("mouseup", gs, {
        capture: !0
    })) : (M.current = !1, window.removeEventListener("mousemove", Bl, {
        capture: !0
    }), window.removeEventListener("mouseup", gs, {
        capture: !0
    })), () => {
        window.removeEventListener("mousemove", Bl, {
            capture: !0
        }), window.removeEventListener("mouseup", gs, {
            capture: !0
        })
    }), [I]), r(bG.Provider, {
        value: {
            parentId: Te,
            id: I,
            isActive: F,
            onItemId: J
        },
        children: r(Mx.Provider, {
            value: { ...h,
                ...Ua
            },
            children: typeof o == "function" ? o({
                dragInProgress: F
            }) : o
        })
    })
}

function iu({
    children: e,
    parentId: t,
    dropableId: o
}) {
    let {
        pushDropableRef: i
    } = (0, tt.useContext)(Mx), n = (0, tt.useRef)(null);
    return (0, tt.useEffect)(() => {
        i(n, o, t)
    }, [n]), e({
        state: "",
        dropElementRef: n,
        dropableId: o
    })
}

function nu({
    children: e,
    draggableId: t,
    dropableId: o,
    disabled: i
}) {
    let n = (0, tt.useRef)(null),
        s = (0, tt.useRef)(null),
        {
            pushDraggableRef: a,
            setDraggable: l,
            isDragOff: c
        } = (0, tt.useContext)(Mx),
        {
            wrapperRef: d
        } = (0, tt.useContext)(_0),
        [p, h] = (0, tt.useState)([0, 0]),
        u = (0, tt.useRef)({
            x: 0,
            y: 0
        }),
        m = (0, tt.useCallback)(y => {
            let S = {
                x: y.screenX,
                y: y.screenY
            };
            Rt.getDistance(u.current, S) > 2 && (y.preventDefault(), h([u.current.x, u.current.y]), window.removeEventListener("mousemove", m))
        }, [u]),
        f = (0, tt.useCallback)(y => {
            y.preventDefault(), u.current = {
                x: 0,
                y: 0
            }, window.removeEventListener("mousemove", m), window.removeEventListener("mouseup", f)
        }, []),
        g = y => {
            if (y.defaultPrevented || y.button !== 0 || y.ctrlKey || y.metaKey || y.shiftKey || y.altKey) return;
            y.preventDefault();
            let S = {
                x: y.screenX,
                y: y.screenY
            };
            u.current = S, window.addEventListener("mouseup", f), window.addEventListener("mousemove", m)
        };
    return (0, tt.useEffect)(() => {
        !i && !c && p[0] && p[1] && l(t, o, n, p[0], p[1], d)
    }, [p]), (0, tt.useEffect)(() => {
        a(t, n)
    }, []), (0, tt.useEffect)(() => {
        let y = s.current || n.current;
        return y && (y.removeEventListener("mousedown", g), y.addEventListener("mousedown", g)), () => {
            y && y.removeEventListener("mousedown", g)
        }
    }, [n.current, s.current]), e({
        state: "",
        ref: n,
        mouseDownRef: s
    })
}
var Bx, tt, nc, bG, Mx, rR, nR, sR = k(() => {
    "use strict";
    or();
    Bx = E(N()), tt = E(N()), nc = E(hn());
    Yd();
    B();
    bG = (0, Bx.createContext)({}), Mx = (0, Bx.createContext)({}), rR = e => (0, nc.reduce)(e, (t, o) => (t.push(o), o.items ? [...t, ...rR(o.items)] : t), []), nR = typeof window < "u" && (window.requestAnimationFrame || window.setImmediate) || (e => setTimeout(e, 0))
});
var db = k(() => {
    "use strict";
    sR()
});

function yG({
    items: e,
    activeIndex: t,
    onChange: o,
    borderColor: i,
    borderActiveColor: n = "black",
    color: s = "darkGray",
    activeColor: a = "black"
}) {
    return r(b, {
        position: "relative",
        zIndex: 0,
        height: 40,
        paddingLeft: "4rm",
        paddingRight: "4rm",
        children: x(b, {
            position: "relative",
            children: [r(b, {
                height: 40,
                display: "flex",
                alignItems: "center",
                justifyContent: "flex-start",
                position: "relative",
                zIndex: 1,
                children: e.map((l, c) => {
                    let d = r(b, {
                        marginRight: c === e.length - 1 ? 0 : "2rm",
                        borderBottom: "2px solid",
                        borderColor: c === t ? n : "transparent",
                        height: "100%",
                        children: r(K, {
                            height: "100%",
                            display: "flex",
                            alignItems: "center",
                            onClick: () => o(c),
                            disabled: l.disabled,
                            children: r($, {
                                textStyle: "small",
                                color: c === t ? a : s,
                                children: l.title
                            })
                        })
                    }, c);
                    return typeof l.renderTab == "function" ? l.renderTab({
                        content: d,
                        key: c
                    }) : d
                })
            }), r(b, {
                position: "absolute",
                bottom: 0,
                left: 0,
                zIndex: 0,
                width: "100%",
                height: 2,
                backgroundColor: i || di("gray", .24)
            })]
        })
    })
}
var os, Rx = k(() => {
    "use strict";
    ie();
    Be();
    je();
    ve();
    B();
    os = yG
});
var ru = k(() => {
    "use strict";
    Rx()
});
var Ex, aR = k(() => {
    "use strict";
    ie();
    Be();
    ve();
    ut();
    B();
    Ex = ({
        onCancel: e,
        onConfirm: t,
        confirmArialLabel: o,
        cancelArialLabel: i
    }) => x(b, {
        height: "24px",
        display: "flex",
        justifyContent: "space-between",
        alignItems: "center",
        children: [r(b, {
            onClick: t,
            "arial-label": o,
            children: r($, {
                textStyle: "small",
                color: "tomato",
                css: Z `
            &:hover {
              color: ${ce.black};
            }
          `,
                children: "Delete"
            })
        }), r(b, {
            onClick: e,
            "arial-label": i,
            children: r($, {
                textStyle: "small",
                color: "darkGray",
                css: Z `
            &:hover {
              color: ${ce.black};
            }
          `,
                children: "Cancel"
            })
        })]
    })
});

function wG({
    currentTextStyles: e,
    dndInProgress: t,
    enterEditMode: o,
    duplicateStyle: i,
    deleteStyle: n,
    moveStyle: s,
    textStylesSection: a,
    dropableId: l,
    currentStyles: c,
    dropdownPortal: d,
    selectStyle: p,
    setIsDropdownOpened: h,
    editable: u,
    isMixed: m = !1
}) {
    let [f, g] = (0, Br.useState)(!1);
    return r(Q, {
        children: e.map((y, S) => {
            let w = u ? [{
                title: "Edit",
                onClick: () => {
                    t || o(y)
                }
            }, {
                title: "Duplicate",
                onClick: () => {
                    t || i(y)
                }
            }, {
                title: `Move to ${a==="global"?"Project":"Global"}`,
                hidden: pt("constructor.globalFeature") ? !window.RM.constructorRouter.mag.user.get("permissions") ? .can_use_global_features : !1,
                onClick: () => {
                    t || s(y, a === "global" ? "project" : "global")
                }
            }, {
                title: f ? x(b, {
                    paddingTop: "8px",
                    paddingBottom: "4px",
                    children: [r($, {
                        textStyle: "small",
                        color: "black",
                        children: "Reset style to default?"
                    }), r(Ex, {
                        confirmArialLabel: "Delete style",
                        cancelArialLabel: "Cancel style deletion",
                        onCancel: v => {
                            v.stopPropagation(), g(!1)
                        },
                        onConfirm: v => {
                            v.stopPropagation(), t || n(y)
                        }
                    })]
                }) : "Delete",
                onClick: v => {
                    v.stopPropagation(), g(!0)
                },
                hoverVariant: ui.danger,
                activeVariant: ui.danger,
                active: f
            }] : [];
            return r(nu, {
                draggableId: y.name,
                dropableId: l,
                children: ({
                    ref: v
                }) => r(b, {
                    ref: v,
                    children: r(oR, {
                        index: S,
                        editable: u,
                        isActive: c ? .includes(y.name),
                        isMixed: m,
                        style: y,
                        listItems: w,
                        dropdownPortal: d,
                        selectStyle: p,
                        onToggleDropdown: h,
                        enterEditMode: o
                    })
                })
            }, `${S}-${y.name}`)
        })
    })
}

function _G({
    height: e,
    style: t,
    headerSlot: o,
    onResizeComplete: i,
    textStylesSection: n,
    setTextStylesSection: s,
    onDeleteUnusedStyles: a,
    selectStyle: l,
    enterEditMode: c,
    duplicateStyle: d,
    currentStyles: p,
    moveStyle: h,
    deleteStyle: u,
    currentTextStyles: m,
    reorderStyle: f,
    onAddClick: g,
    filterState: y = "all",
    setStylesFilter: S,
    defaultStyleName: w = "No style",
    editable: v,
    isMixed: C = !1,
    isEmptyGlobalStyles: I
}, T) {
    let M = (0, Br.useRef)(null),
        [F, R] = (0, Br.useState)(null),
        A = (0, Br.useMemo)(() => m.map(ee => ({
            id: ee.name
        })), [m]),
        [D, O] = (0, Br.useState)(!1),
        [L, W] = (0, Br.useState)(!1),
        z = Fn(.76, ce.gray),
        [V, X] = (0, Br.useState)(!1),
        q = () => {
            pt("constructor.globalFeature") ? window.RM.constructorRouter.mag.user.get("permissions") ? .can_use_global_features ? g() : Jo("global-styles") : g()
        },
        ne = [{
            title: "Show all",
            onClick: () => {
                S && S("all")
            },
            active: y === "all"
        }, {
            title: "Show only used",
            onClick: () => {
                S && S("used")
            },
            active: y === "used"
        }, {
            title: "Show only unused",
            onClick: () => {
                S && S("unused")
            },
            active: y === "unused"
        }, {
            title: V ? r(Ex, {
                confirmArialLabel: "Delete all unused styles",
                cancelArialLabel: "Cancel delete unused styles",
                onCancel: ee => {
                    ee.stopPropagation(), X(!1)
                },
                onConfirm: () => a && a()
            }) : "Delete all unused",
            onClick: ee => {
                !V && ee.stopPropagation(), !V && X(!0)
            },
            hoverVariant: ui.danger,
            activeVariant: ui.danger,
            active: V
        }],
        re = F === -1 || p ? .length === 0 || p ? .includes("unstyled"),
        te = "blue";
    return C && (te = "gray"), x(Me, {
        isShowed: !0,
        resizable: !0,
        onResizeComplete: i,
        height: e,
        ref: T,
        style: t,
        gradientBackground: !0,
        children: [o || null, r(os, {
            items: [{
                title: "Project"
            }, {
                title: "Global"
            }],
            activeIndex: n === "project" ? 0 : 1,
            onChange: ee => {
                let j = ee === 0 ? "project" : "global";
                if (pt("constructor.globalFeature")) {
                    let se = window.RM.constructorRouter.mag.user.get("permissions") ? .can_use_global_features;
                    j === "global" && I && !se ? Jo("global-styles") : s(j)
                } else s(j)
            }
        }), r(b, {
            height: `calc(100% - ${o?40:0}px - 40px - ${v?40:0}px)`,
            children: r(xo, {
                children: ({
                    ref: ee
                }) => x(b, {
                    ref: ee,
                    children: [x(b, {
                        paddingLeft: 16,
                        paddingRight: 16,
                        position: "relative",
                        onMouseEnter: () => R(-1),
                        onMouseLeave: () => R(null),
                        onClick: () => l(null),
                        cursor: "pointer",
                        userSelect: "none",
                        children: [r(b, {
                            backgroundColor: F === -1 && C ? "blue" : re ? te : "gray",
                            opacity: re ? .2 : 0,
                            position: "absolute",
                            top: 0,
                            left: 0,
                            width: "100%",
                            height: "100%",
                            zIndex: 0
                        }), r(b, {
                            height: 40,
                            display: "flex",
                            alignItems: "center",
                            children: r($, {
                                textStyle: "small",
                                children: w
                            })
                        })]
                    }), r(ou, {
                        idList: A,
                        isDragOff: L,
                        onDragStart: () => {
                            O(!0)
                        },
                        onDragEnd: (j, se, oe) => {
                            f(A.findIndex(U => U.id === j), oe), O(!1)
                        },
                        children: () => r(iu, {
                            dropableId: "0",
                            children: ({
                                dropElementRef: j,
                                dropableId: se
                            }) => r(b, {
                                ref: j,
                                children: r(xG, {
                                    editable: v,
                                    dropableId: se,
                                    currentTextStyles: m,
                                    isMixed: C,
                                    currentStyles: p,
                                    enterEditMode: c,
                                    duplicateStyle: d,
                                    moveStyle: h,
                                    deleteStyle: u,
                                    selectStyle: l,
                                    dndInProgress: D,
                                    textStylesSection: n,
                                    setIsDropdownOpened: W,
                                    dropdownPortal: M
                                })
                            })
                        })
                    })]
                })
            })
        }), v ? x(Q, {
            children: [r(b, {
                paddingLeft: "4rm",
                paddingRight: "4rm",
                children: r(b, {
                    borderBottom: "2px solid",
                    borderColor: z
                })
            }), n === "project" ? r(Ho, {
                cursor: "auto",
                popperOffset: [0, -8],
                listItems: ne,
                children: ({
                    toggleDropdown: ee
                }) => r(eu, {
                    showBorder: !1,
                    icon: r(K, {
                        "data-testid": "add-text-style",
                        onClick: g,
                        variant: "clean",
                        css: Z `
                        vertical-align: middle;

                        &:hover svg {
                          color: ${ce.black};
                        }
                      `,
                        children: r(Qt, {
                            color: "darkGray"
                        })
                    }),
                    rightIcon: r(dt, {
                        height: 32,
                        width: 32,
                        color: "transparent",
                        hoverColor: "transparent",
                        activeColor: "transparent",
                        unstyledHover: !0,
                        unstyledActive: !0,
                        onClick: ee,
                        css: Z `
                        &:hover svg {
                          color: ${ce.black};
                        }
                      `,
                        children: r(Xa, {
                            color: y !== "all" ? "blue" : "darkGray"
                        })
                    })
                })
            }) : r(eu, {
                showBorder: !1,
                icon: r(K, {
                    "data-testid": "add-text-style",
                    onClick: q,
                    variant: "clean",
                    css: Z `
                    vertical-align: middle;

                    &:hover svg {
                      color: ${ce.black};
                    }
                  `,
                    children: r(Qt, {
                        color: "darkGray"
                    })
                })
            })]
        }) : null, r(b, {
            ref: M
        })]
    })
}
var Br, lR, xG, pb, Fx = k(() => {
    "use strict";
    Br = E(N()), lR = E(hn());
    nt();
    Px();
    ts();
    Dn();
    _s();
    iR();
    ie();
    je();
    Jr();
    Be();
    or();
    Cr();
    Lf();
    db();
    ru();
    ut();
    Uc();
    ve();
    En();
    Xs();
    aR();
    B();
    xG = (0, Br.memo)(wG, (e, t) => lR.default.isEqual(e.currentTextStyles, t.currentTextStyles) && e.currentStyles === t.currentStyles && e.dndInProgress === t.dndInProgress && e.textStylesSection === t.textStylesSection && e.selectStyle === t.selectStyle && e.moveStyle === t.moveStyle && e.duplicateStyle === t.duplicateStyle && e.deleteStyle === t.deleteStyle && e.editable === t.editable);
    pb = (0, Br.forwardRef)(_G)
});
var No, kG, cR, dR = k(() => {
    "use strict";
    No = E(N());
    Ol();
    Tr();
    Yt();
    Dn();
    ni();
    Yv();
    ae();
    Fx();
    qt();
    Mt();
    qi();
    Ps();
    _s();
    fx();
    Ht();
    B();
    kG = (0, No.forwardRef)(({
        style: e,
        onHeightChanged: t,
        headerSlot: o
    }, i) => {
        let {
            navigate: n
        } = (0, No.useContext)(Jt), {
            setSelectedTextStyle: s,
            setSelectedTextStyleSection: a,
            selectedTextStyleSection: l,
            setEditorStateBackup: c
        } = (0, No.useContext)(tn), d = Qi("TextCanEditStyles"), {
            model: p
        } = (0, No.useContext)(Y), h = (0, No.useMemo)(() => p.project.get("_id"), [p]), u = (0, No.useMemo)(() => p.user.get("_id"), [p]), [m, f] = p.useSharedState({
            group: !0,
            partial: !1
        }), [g, y] = (0, No.useState)(null), [S, w] = (0, No.useState)("all"), [v, C] = (0, No.useState)(l || "project"), [I, T] = Ii(), P = (0, No.useMemo)(() => v === "global" ? I.global : S === "used" ? I.project.filter(te => !!g ? .has(te.name)) : S === "unused" ? I.project.filter(te => !g ? .has(te.name)) : I.project, [v, I, S]), M = (0, No.useMemo)(() => {
            let te = m.map(se => Ko({
                    editorState: se
                })),
                ee = new Set(P.map(se => se.name)),
                j = te.filter(se => ee.has(se));
            return j ? .length ? j : ["unstyled"]
        }, [m, P]);
        (0, No.useEffect)(() => {
            let te = M[0];
            if (te && !l) {
                let ee = I.global.some(j => j.name === te);
                ee && v !== "global" ? C("global") : !ee && v === "global" && C("project")
            }
        }, [M[0], l]), (0, No.useEffect)(() => {
            t()
        }, []);
        let F = (0, No.useCallback)(te => {
                let ee = m.map((j, se) => {
                    let U = p.block ? .propsModel ? .get("isEditMode") ? j : xr(j, !1),
                        he = M[se],
                        xe = sp({
                            style: te,
                            currentStyle: he,
                            editorState: U
                        });
                    return At(xe, j.getSelection())
                });
                f(ee), Bv(h, "paragraph"), Jg.sendEvent({
                    widget: "text",
                    changes: "styles_panel_interaction"
                })
            }, [M, m, h, p.block, f]),
            R = (0, No.useCallback)(async te => {
                let ee = [...P],
                    j = ee.findIndex(se => se.name === te.name);
                j > -1 && ee.splice(j, 0, { ...te,
                    name: `style-${zn()}`,
                    label: `${te.label} (Copy)`
                }), await T({ ...I,
                    [v]: ee
                }), v === "global" ? await Ka({
                    userId: u,
                    styles: ee
                }) : await _a({
                    projectId: h,
                    styles: ee
                }), window.RM.constructorRouter.trigger("update_from_server", "TextStyles", {
                    [v]: ee
                })
            }, [P, I, v, u, h]),
            A = (0, No.useCallback)(async te => {
                let ee = I[v].filter(j => j.name !== te.name);
                T({ ...I,
                    [v]: ee
                }), F(null), v === "global" ? await Ka({
                    userId: u,
                    styles: ee
                }) : (Bv(h, "paragraph"), await _a({
                    projectId: h,
                    styles: ee
                })), window.RM.constructorRouter.trigger("update_from_server", "TextStyles", {
                    [v]: ee
                })
            }, [P, h, T, I, v, u]),
            D = te => {
                s && s(te), a && a(v), n("StyleEdit")
            },
            [O, L] = (0, No.useState)(de.textWidget.textStylesPanelDefaultHeight);
        (0, No.useEffect)(() => {
            let te = p.project.edit_params.get("controls");
            te && te.TextStyles && L(te.TextStyles)
        }, []);
        let W = te => {
                L(te);
                let ee = p.project.edit_params.get("controls");
                p.project.edit_params.set("controls", { ...ee,
                    TextStyles: te
                }), p.project.edit_params.save()
            },
            z = (0, No.useCallback)(async (te, ee) => {
                let j = [],
                    se = [];
                if (ee === "global") {
                    j = [...P];
                    let oe = j.findIndex(U => U.name === te.name);
                    oe > -1 && j.splice(oe, 1), se = [...I.global, te]
                } else {
                    se = [...P];
                    let oe = se.findIndex(U => U.name === te.name);
                    oe > -1 && se.splice(oe, 1), j = [...I.project, te]
                }
                await T({
                    global: se,
                    project: j
                }), await _a({
                    projectId: h,
                    styles: j
                }), await Ka({
                    userId: u,
                    styles: se
                }), C(ee), window.RM.constructorRouter.trigger("update_from_server", "TextStyles", {
                    global: se,
                    project: j
                }), ee === "global" && De(Fe.WidgetFeature, {
                    featureType: "typography move to global"
                })
            }, [P, I, u, h]),
            V = async (te, ee) => {
                if (te === -1) return;
                let j = [...P],
                    se = j[te];
                j.splice(te, 1), j.splice(ee, 0, se), await T({ ...I,
                    [v]: j
                }), v === "global" ? await Ka({
                    userId: u,
                    styles: j
                }) : await _a({
                    projectId: h,
                    styles: j
                }), window.RM.constructorRouter.trigger("update_from_server", "TextStyles", {
                    [v]: j
                })
            },
            X = () => {
                s && s(void 0), a && a(v), c && c(m), n("StyleEdit"), De(Fe.WidgetFeature, {
                    featureType: "typography create new style"
                })
            },
            q = () => new Promise(te => {
                let ee = p.project.getUsedStyles("paragraph");
                te(ee)
            }),
            ne = te => {
                if (te !== S)
                    if (te !== "all") {
                        let ee = rp(h, "paragraph");
                        ee ? (y(ee), w(te)) : q().then(j => {
                            j && (y(j), w(te), yf(h, "paragraph", j))
                        })
                    } else w(te)
            },
            re = async () => {
                S !== "all" && w("all");
                let te = rp(h, "paragraph"),
                    ee = te || await q();
                if (ee) {
                    let j = [...I.project].filter(se => ee.has(se.name));
                    await T({ ...I,
                        project: j
                    }), await _a({
                        projectId: h,
                        styles: j
                    }), window.RM.constructorRouter.trigger("update_from_server", "TextStyles", {
                        project: j
                    })
                }
            };
        return r(pb, {
            style: e,
            ref: i,
            height: O,
            currentStyles: M,
            isMixed: p.isMixed(M),
            onResizeComplete: W,
            headerSlot: o,
            onAddClick: X,
            filterState: S,
            setStylesFilter: ne,
            onDeleteUnusedStyles: re,
            selectStyle: F,
            moveStyle: z,
            deleteStyle: A,
            duplicateStyle: R,
            enterEditMode: D,
            reorderStyle: V,
            currentTextStyles: P,
            setTextStylesSection: C,
            textStylesSection: v,
            editable: d,
            isEmptyGlobalStyles: I.global.length === 0
        })
    }), cR = kG
});
var ub, IG, pR, uR = k(() => {
    "use strict";
    ub = E(N()), IG = ({
        watchingClick: e,
        callback: t,
        preventDefault: o,
        capture: i = !1
    }, n = []) => {
        let s = (0, ub.useRef)(null);
        return (0, ub.useEffect)(() => {
            let a = null,
                l = d => {
                    o && d.preventDefault(), a = d.target
                },
                c = d => {
                    o && d.preventDefault();
                    let p = a || d.target;
                    s.current ? .contains(p) || t(d), a = null
                };
            return e ? (window.addEventListener("click", c, {
                capture: i
            }), window.addEventListener("mousedown", l, {
                capture: !0
            })) : (window.removeEventListener("click", c, {
                capture: i
            }), window.removeEventListener("mousedown", l, {
                capture: !0
            })), () => {
                window.removeEventListener("click", c, {
                    capture: i
                }), window.removeEventListener("mousedown", l, {
                    capture: !0
                }), a = null
            }
        }, [e, i, ...n]), s
    }, pR = IG
});

function hR() {
    return r("svg", {
        width: "24",
        height: "24",
        xmlns: "http://www.w3.org/2000/svg",
        children: x("g", {
            fill: "#FFF",
            fillRule: "evenodd",
            children: [r("circle", {
                transform: "rotate(-180 6 6)",
                cx: "6",
                cy: "6",
                r: "6"
            }), r("circle", {
                transform: "rotate(-180 18 6)",
                cx: "18",
                cy: "6",
                r: "6"
            }), r("circle", {
                transform: "rotate(-180 6 18)",
                cx: "6",
                cy: "18",
                r: "6"
            }), r("circle", {
                transform: "rotate(-180 18 18)",
                cx: "18",
                cy: "18",
                r: "6"
            })]
        })
    })
}
var mR = k(() => {
    "use strict";
    B()
});

function fR() {
    return r("svg", {
        width: "16",
        height: "19",
        xmlns: "http://www.w3.org/2000/svg",
        children: x("g", {
            fill: "none",
            fillRule: "evenodd",
            children: [r("rect", {
                fill: "#FFF",
                y: "2",
                width: "16",
                height: "2",
                rx: "1"
            }), r("path", {
                d: "M6.499.528H9.5",
                stroke: "#FFF",
                strokeLinecap: "square"
            }), r("circle", {
                fill: "#FFF",
                cx: "8",
                cy: "14",
                r: "2"
            }), r("path", {
                d: "M13.474 7L11.91 17.209a.967.967 0 0 1-.918.791H5.007a.959.959 0 0 1-.918-.791L2.526 7",
                stroke: "#FFF",
                strokeWidth: "1.6",
                strokeLinecap: "round"
            })]
        })
    })
}
var gR = k(() => {
    "use strict";
    B()
});

function bR() {
    return r("svg", {
        width: "24",
        height: "24",
        xmlns: "http://www.w3.org/2000/svg",
        children: x("g", {
            fill: "none",
            fillRule: "evenodd",
            children: [r("circle", {
                fill: "#FFF",
                transform: "rotate(-180 12 12)",
                cx: "12",
                cy: "12",
                r: "12"
            }), r("path", {
                d: "M13 11h4a1 1 0 0 1 0 2h-4v4a1 1 0 0 1-2 0v-4H7a1 1 0 0 1 0-2h4V7a1 1 0 0 1 2 0v4z",
                fill: "#000"
            })]
        })
    })
}
var yR = k(() => {
    "use strict";
    B()
});

function PG({
    children: e,
    setNode: t,
    nodes: o,
    type: i,
    onMoveColors: n,
    color: s,
    index: a,
    size: l
}) {
    let [c, d] = (0, su.useState)(!1), p = (0, su.useRef)(null);
    (0, su.useEffect)(() => {
        t && p.current !== null && t(p.current)
    }, []);

    function h() {
        d(!0)
    }

    function u(m) {
        if (d(!1), typeof s > "u") return;
        let f = null,
            g = null;
        if (o && (Object.keys(o.favourite).forEach(y => {
                let S = o.favourite[y].getBoundingClientRect();
                vR(S, m) && (f = y)
            }), f || Object.keys(o.regular).forEach(y => {
                let S = o.regular[y].getBoundingClientRect();
                vR(S, m) && (g = y)
            })), f || g) {
            let y = f ? oa.favourites : g ? oa.regular : void 0;
            y && n({
                from: i,
                to: y,
                color: s,
                newIndex: f || g || -1,
                oldIndex: a
            })
        }
    }
    return r(wt.div, {
        ref: p,
        drag: s ? !0 : void 0,
        onDragStart: h,
        onDragEnd: u,
        dragSnapToOrigin: !0,
        style: {
            zIndex: c ? 10 : 1,
            position: "relative",
            height: l === "small" ? 24 : 40
        },
        transition: {
            mass: 1,
            stiffness: 1200,
            damping: 50
        },
        children: e
    })
}
var su, vR, wR, xR = k(() => {
    "use strict";
    su = E(N());
    Li();
    Jh();
    B();
    vR = (e, t) => e.left <= t.x && t.x <= e.left + e.width && e.top <= t.y && t.y <= e.top + e.height;
    wR = PG
});

function TG({
    color: e,
    size: t,
    selected: o
}) {
    let i = e;
    return i && i[0] !== "#" && (i = "#" + e), r(b, {
        backgroundColor: i || "",
        width: t === "small" ? 24 : 40,
        height: t === "small" ? 24 : 40,
        borderRadius: "50%",
        boxShadow: `inset 0px 0px 0px ${o?4:1}px #535353`,
        ...kp.fixRadiusClip()
    })
}
var Dx, _R = k(() => {
    "use strict";
    Kv();
    ie();
    B();
    Dx = TG
});

function CR({
    type: e,
    onClick: t,
    selected: o,
    color: i,
    setNode: n,
    index: s,
    nodes: a,
    onMoveColors: l,
    size: c
}) {
    return x(b, {
        position: "relative",
        children: [!!i && r(b, {
            position: "absolute",
            opacity: .4,
            children: r(Dx, {
                size: c,
                selected: !1
            })
        }), r(wR, {
            index: s,
            type: e,
            setNode: n,
            nodes: a,
            color: i,
            onMoveColors: l,
            size: c,
            children: r(K, {
                disabled: !i,
                onClick: i ? t : void 0,
                children: r(Dx, {
                    selected: o,
                    color: i,
                    size: c
                })
            })
        })]
    })
}

function BG({
    color: e,
    regular: t,
    favourites: o,
    selectSwatchColor: i,
    onMoveColors: n,
    regularInRow: s = 5,
    regularRowsMin: a = 3,
    favouriteInRow: l = 3,
    favouriteRows: c = 2,
    regularGap: d = 4,
    favouriteGap: p = 8
}) {
    let h = a * s,
        [u, m] = (0, Ba.useReducer)(SR, {}),
        [f, g] = (0, Ba.useReducer)(SR, {}),
        y = {
            regular: f,
            favourite: u
        },
        S = (0, Ba.useMemo)(() => (0, kR.default)({
            h: e.h,
            s: e.s,
            v: e.v
        }).hex().replace("#", ""), [e]),
        w = P => {
            let M = 0;
            for (let F = P.length - 1; F >= 0; F--) M === 0 && P[F].filter(R => R).length && (M = F);
            return M
        },
        v = c * l,
        C = (0, Ba.useMemo)(() => Array.from(Array(v).keys()), [v]),
        I = (0, Ba.useMemo)(() => {
            let P = DC(t, s);
            if (!P || !P.length) return h;
            let M = w(P) + 1;
            if (M < a) return h;
            let F = P[M - 1].filter(R => R).length > 0 ? M + 1 : M;
            return Math.max(F * s, h)
        }, [t]),
        T = (0, Ba.useMemo)(() => Array.from(Array(I).keys()), [I]);
    return x(Q, {
        children: [r(oi, {
            gridTemplateColumns: `repeat(${l}, 40px)`,
            gap: `${p}px`,
            children: C.map((P, M) => r(CR, {
                type: oa.favourites,
                color: o[M],
                index: M,
                selected: S.toLowerCase() === String(o[M]).toLowerCase(),
                onClick: () => i(String(o[M])),
                onMoveColors: n,
                nodes: y,
                size: "big",
                setNode: F => {
                    o[M] || m({
                        type: "set",
                        node: F,
                        key: M
                    })
                }
            }, `${M}${String(o[M])}`))
        }), r(oi, {
            gridTemplateColumns: `repeat(${s}, 24px)`,
            gap: `${d}px`,
            marginTop: "2rm",
            children: T.map((P, M) => r(CR, {
                type: oa.regular,
                color: t[M],
                index: M,
                selected: S.toLowerCase() === String(t[M]).toLowerCase(),
                onClick: () => i(String(t[M])),
                onMoveColors: n,
                nodes: y,
                size: "small",
                setNode: F => {
                    t[M] || g({
                        type: "set",
                        node: F,
                        key: M
                    })
                }
            }, `${M}${String(t[M])}`))
        })]
    })
}
var Ba, kR, SR, IR, PR = k(() => {
    "use strict";
    Ba = E(N()), kR = E(qm());
    oo();
    xR();
    je();
    _R();
    Jh();
    kh();
    ie();
    B();
    SR = (e, {
        type: t,
        node: o,
        key: i
    }) => t === "set" ? { ...e,
        [i]: o
    } : e;
    IR = (0, Ba.memo)(BG)
});

function hb() {
    let [e, t] = (0, TR.useState)("");
    return {
        start: () => {
            t(document.body.style.getPropertyValue("user-select")), document.body.style.setProperty("user-select", "none"), document.body.style.setProperty("-webkit-user-select", "none")
        },
        stop: () => {
            document.body.style.setProperty("user-select", e), document.body.style.setProperty("-webkit-user-select", e), t("")
        }
    }
}
var TR, Ax = k(() => {
    "use strict";
    TR = E(N())
});
var qh, MG, BR, MR = k(() => {
    "use strict";
    qh = E(N());
    Ax();
    MG = () => {
        let {
            start: e,
            stop: t
        } = hb(), [o, i] = (0, qh.useState)(!1), n = () => {
            t()
        };
        return (0, qh.useEffect)(() => (o && e(), n), [o]), (0, qh.useEffect)(() => n, []), {
            selectionDisabled: o,
            setSelectionDisabled: i
        }
    }, BR = MG
});

function RG() {
    return r(b, {
        height: Mr * 2,
        width: Mr * 2,
        borderRadius: "50%",
        border: "2px solid #fff",
        boxShadow: "inset 0px 0.5px 1px rgba(0, 0, 0, 0.1), 0px 0px 1px rgba(0, 0, 0, 0.1)",
        userSelect: "none",
        transform: "transle(-50%, -50%)",
        cursor: "grab"
    })
}

function EG({
    width: e = 168,
    height: t = 168,
    hue: o = 80,
    saturation: i,
    value: n,
    hidePointer: s,
    onChange: a,
    onChangeComplete: l,
    onStartDrag: c,
    onEndDrag: d
}) {
    let [p, h, u] = (0, yn.useMemo)(() => (0, RR.default)({
        h: o,
        s: 100,
        v: 100
    }).rgb().array(), [o]), [m, f] = (0, yn.useState)(!1), g = (0, yn.useRef)(null), y = (0, yn.useRef)(null), [S, w] = (0, yn.useState)({}), [v, C] = (0, yn.useState)({
        top: 0,
        left: 0
    }), {
        setSelectionDisabled: I
    } = BR(), T = D => {
        let O = y && y.current ? y.current.clientWidth : 0,
            L = y && y.current ? y.current.clientHeight : 0;
        return {
            left: Math.min(Math.max(D.left, Mr), O - Mr),
            top: Math.min(Math.max(D.top, Mr), L - Mr)
        }
    };
    (0, yn.useEffect)(() => {
        g.current && (g.current.style.display = s ? "none" : "block")
    }, [g, s]), (0, yn.useEffect)(() => {
        if (typeof i != "number" || typeof n != "number" || S.s === i && S.v === n || !g.current) return;
        let D = y && y.current ? y.current.clientWidth - Mr * 2 : 0,
            O = y && y.current ? y.current.clientHeight - Mr * 2 : 0;
        C({
            left: D * i / 100 + Mr,
            top: Mr + (n * -1 + 100) * O / 100
        }), w({ ...S,
            s: i,
            v: n
        })
    }, [i, n, S]);
    let P = D => {
            if (!g.current) return;
            let O = y && y.current ? y.current.getBoundingClientRect() : {},
                L = y && y.current ? y.current.clientWidth - Mr * 2 : 0,
                W = y && y.current ? y.current.clientHeight - Mr * 2 : 0,
                z = T({
                    top: D.pageY - O.top - window.pageYOffset,
                    left: D.pageX - O.left - window.pageXOffset
                }),
                V = (z.left - Mr) * 100 / L,
                X = Math.abs((z.top - Mr) * 100 / W - 100),
                q = {
                    h: o,
                    s: V,
                    v: X,
                    a: 1
                };
            return w(q), C(z), q
        },
        M = D => {
            if (m) {
                if (D.buttons === 0) {
                    f(!1), l && l(S);
                    return
                }
                let O = P(D);
                O && a(O)
            }
        },
        F = D => {
            if (m) {
                f(!1);
                let O = P(D);
                O && (a(O), l && l(O))
            }
        },
        R = D => {
            if (m) {
                f(!1);
                let O = P(D);
                O && (a(O), l && l(O))
            }
        };
    (0, yn.useEffect)(() => (m ? (I(!0), window.addEventListener("mousemove", M), window.addEventListener("mouseup", F), window.addEventListener("mouseleave", R), c && c()) : (I(!1), window.removeEventListener("mousemove", M), window.removeEventListener("mouseup", F), window.removeEventListener("mouseleave", R), d && d()), () => {
        I(!1), window.removeEventListener("mousemove", M), window.removeEventListener("mouseup", F), window.removeEventListener("mouseleave", R)
    }), [m]);
    let A = (0, yn.useCallback)(D => {
        f(!0);
        let O = P(D.nativeEvent);
        O && a(O)
    }, [a, P]);
    return r(b, {
        width: e,
        height: t,
        position: "relative",
        overflow: "hidden",
        cursor: m ? "grabbing !important" : "",
        children: x(b, {
            ref: y,
            width: "100%",
            height: "100%",
            position: "relative",
            zIndex: 1,
            style: {
                background: `rgb(${p}, ${h}, ${u})`
            },
            "data-testid": "colorpicker-palette",
            onMouseDown: A,
            children: [r(b, {
                ref: g,
                position: "absolute",
                zIndex: 10,
                marginLeft: -12,
                marginTop: -12,
                style: {
                    transform: `translate(${v.left}px, ${v.top}px)`
                },
                children: r(RG, {})
            }), r(b, {
                width: "100%",
                height: "100%",
                top: 0,
                left: 0,
                position: "absolute",
                zIndex: 0,
                background: "linear-gradient(to right, #fff 0%, rgba(255, 255, 255, 0) 100%)"
            }), r(b, {
                width: "100%",
                height: "100%",
                top: 0,
                left: 0,
                position: "absolute",
                zIndex: 1,
                background: "linear-gradient(to bottom, transparent 0%, #000 100%)"
            })]
        })
    })
}
var yn, RR, Mr, ER, FR = k(() => {
    "use strict";
    yn = E(N()), RR = E(qm());
    ie();
    MR();
    B();
    Mr = 12;
    ER = (0, yn.memo)(EG)
});
var DR, AR = k(() => {
    "use strict";
    DR = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTQ0IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI2IiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIzMCIgY3k9IjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNiIgY3k9IjE0IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjMwIiBjeT0iMTQiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNiIgY3k9IjIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjMwIiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNiIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjMwIiBjeT0iMzAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTAiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIzNCIgY3k9IjEwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjIiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMCIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMzQiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjIiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEwIiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMzQiIGN5PSIxOCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTAiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIzNCIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjIiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxOCIgY3k9IjEwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjQyIiBjeT0iMTAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTgiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjQyIiBjeT0iMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxOCIgY3k9IjE4IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjQyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTgiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI0MiIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjI2IiBjeT0iMTAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNTAiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIyNiIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNTAiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjI2IiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNTAiIGN5PSIxOCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIyNiIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjUwIiBjeT0iMjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTAiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzNCIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMCIgY3k9IjE0IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzNCIgY3k9IjE0IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIyIiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEwIiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjM0IiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIiIGN5PSIyMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTAiIGN5PSIzMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMzQiIGN5PSIzMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMiIgY3k9IjMwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI2IiBjeT0iMTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjMwIiBjeT0iMTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjYiIGN5PSIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzMCIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjYiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMzAiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNiIgY3k9IjI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzMCIgY3k9IjI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxNCIgY3k9IjEwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIzOCIgY3k9IjEwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxNCIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjM4IiBjeT0iMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTQiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMzgiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTQiIGN5PSIyNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMzgiIGN5PSIyNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMjIiIGN5PSIxMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNDYiIGN5PSIxMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMjIiIGN5PSIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI0NiIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjQ2IiBjeT0iMTgiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIyIiBjeT0iMjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjQ2IiBjeT0iMjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE0IiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIzOCIgY3k9IjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTQiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIzOCIgY3k9IjE0IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjE0IiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMzgiIGN5PSIyMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxNCIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjM4IiBjeT0iMzAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTgiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI0MiIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE4IiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjQyIiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE4IiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjQyIiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE4IiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjQyIiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIyIiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI0NiIgY3k9IjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjIiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI0NiIgY3k9IjE0IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjIyIiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNDYiIGN5PSIyMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIyMiIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjQ2IiBjeT0iMzAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjYiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI1MCIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjI2IiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjUwIiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjI2IiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjUwIiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjI2IiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjUwIiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjU0IiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI3OCIgY3k9IjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTAyIiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMjYiIGN5PSI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjU0IiBjeT0iMTQiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNzgiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMDIiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMjYiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1NCIgY3k9IjIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijc4IiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTAyIiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTI2IiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNTQiIGN5PSIzMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI3OCIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEwMiIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEyNiIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjU4IiBjeT0iMTAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iODIiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMDYiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMzAiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1OCIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iODIiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEwNiIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTMwIiBjeT0iMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1OCIgY3k9IjE4IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjgyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTA2IiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTMwIiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNTgiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI4MiIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEwNiIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzMCIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjY2IiBjeT0iMTAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOTAiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMTQiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMzgiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI2NiIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOTAiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjExNCIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTM4IiBjeT0iMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI2NiIgY3k9IjE4IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjkwIiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTE0IiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTM4IiBjeT0iMTgiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNjYiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI5MCIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjExNCIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzOCIgY3k9IjI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijc0IiBjeT0iMTAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOTgiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMjIiIGN5PSIxMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI3NCIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOTgiIGN5PSIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEyMiIgY3k9IjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNzQiIGN5PSIxOCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI5OCIgY3k9IjE4IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEyMiIgY3k9IjE4IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijc0IiBjeT0iMjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOTgiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMjIiIGN5PSIyNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1OCIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjgyIiBjeT0iNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTA2IiBjeT0iNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTMwIiBjeT0iNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNTgiIGN5PSIxNCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iODIiIGN5PSIxNCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTA2IiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEzMCIgY3k9IjE0IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI1OCIgY3k9IjIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI4MiIgY3k9IjIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMDYiIGN5PSIyMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTMwIiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjU4IiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjgyIiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEwNiIgY3k9IjMwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMzAiIGN5PSIzMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNTQiIGN5PSIxMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNzgiIGN5PSIxMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTAyIiBjeT0iMTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEyNiIgY3k9IjEwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI1NCIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9Ijc4IiBjeT0iMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTAyIiBjeT0iMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTI2IiBjeT0iMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNTQiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNzgiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTAyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEyNiIgY3k9IjE4IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI1NCIgY3k9IjI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI3OCIgY3k9IjI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMDIiIGN5PSIyNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTI2IiBjeT0iMjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjYyIiBjeT0iMTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9Ijg2IiBjeT0iMTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjExMCIgY3k9IjEwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMzQiIGN5PSIxMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjIiIGN5PSIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI4NiIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjExMCIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEzNCIgY3k9IjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjYyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9Ijg2IiBjeT0iMTgiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjExMCIgY3k9IjE4IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMzQiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjIiIGN5PSIyNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iODYiIGN5PSIyNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTEwIiBjeT0iMjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEzNCIgY3k9IjI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI3MCIgY3k9IjEwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5NCIgY3k9IjEwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMTgiIGN5PSIxMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTQyIiBjeT0iMTAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjcwIiBjeT0iMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOTQiIGN5PSIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMTgiIGN5PSIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxNDIiIGN5PSIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI3MCIgY3k9IjE4IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5NCIgY3k9IjE4IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMTgiIGN5PSIxOCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTQyIiBjeT0iMTgiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjcwIiBjeT0iMjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9Ijk0IiBjeT0iMjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjExOCIgY3k9IjI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxNDIiIGN5PSIyNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjIiIGN5PSI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijg2IiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMTAiIGN5PSI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzNCIgY3k9IjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNjIiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI4NiIgY3k9IjE0IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjExMCIgY3k9IjE0IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzNCIgY3k9IjE0IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjYyIiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iODYiIGN5PSIyMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMTAiIGN5PSIyMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMzQiIGN5PSIyMiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI2MiIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijg2IiBjeT0iMzAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTEwIiBjeT0iMzAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTM0IiBjeT0iMzAiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNjYiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5MCIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjExNCIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEzOCIgY3k9IjYiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjY2IiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjkwIiBjeT0iMTQiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjExNCIgY3k9IjE0IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMzgiIGN5PSIxNCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNjYiIGN5PSIyMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOTAiIGN5PSIyMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTE0IiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEzOCIgY3k9IjIyIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI2NiIgY3k9IjMwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5MCIgY3k9IjMwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMTQiIGN5PSIzMCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTM4IiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjcwIiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI5NCIgY3k9IjYiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTE4IiBjeT0iNiIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxNDIiIGN5PSI2IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjcwIiBjeT0iMTQiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOTQiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMTgiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxNDIiIGN5PSIxNCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI3MCIgY3k9IjIyIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijk0IiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTE4IiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTQyIiBjeT0iMjIiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNzAiIGN5PSIzMCIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI5NCIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjExOCIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjE0MiIgY3k9IjMwIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9Ijc0IiBjeT0iNiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOTgiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMjIiIGN5PSI2IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI3NCIgY3k9IjE0IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5OCIgY3k9IjE0IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMjIiIGN5PSIxNCIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNzQiIGN5PSIyMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOTgiIGN5PSIyMiIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTIyIiBjeT0iMjIiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9Ijc0IiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9Ijk4IiBjeT0iMzAiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEyMiIgY3k9IjMwIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K"
});

function LG({
    color: e,
    opacity: t = 100,
    onChange: o,
    onChangeComplete: i,
    previewValue: n,
    previewValueColor: s,
    disabled: a,
    hiddenOpacityMarker: l = !1
}) {
    let c = (0, Qh.useMemo)(() => (0, LR.default)({
            h: e.h,
            s: e.s,
            v: e.v
        }).hex(), [e]),
        d = (0, Qh.useMemo)(() => Number(t.toFixed(0)), [t]);
    return x(b, {
        height: 32,
        width: "100%",
        position: "relative",
        children: [n && !l && r(b, {
            position: "absolute",
            bottom: "100%",
            width: "calc(100% - 32px)",
            marginLeft: 16,
            children: r(b, {
                height: 16,
                width: 24,
                position: "absolute",
                bottom: "100%",
                style: {
                    left: `${t}%`
                },
                transform: "translateX(-50%)",
                children: r(fe, {
                    "data-testid": "colorpicker-opacity-input",
                    textStyle: "small",
                    color: s,
                    value: d,
                    min: 0,
                    max: 100,
                    onChange: ({
                        value: p
                    }) => o(p),
                    textAlign: "center",
                    disabled: !!a
                })
            })
        }), x(b, {
            backgroundColor: "black",
            height: "100%",
            width: "100%",
            overflow: "hidden",
            borderRadius: "16px",
            position: "relative",
            ...kp.fixRadiusClip(),
            children: [r(b, {
                position: "absolute",
                top: 0,
                left: 0,
                width: "100%",
                height: "100%",
                zIndex: 0,
                backgroundImage: `url('${DR}')`
            }), r(AG, {
                "data-testid": "colorpicker-opacity-range",
                background: `linear-gradient(to right, rgba(255, 255, 255, 0.64388), ${c})`,
                type: "range",
                min: 0,
                max: 100,
                step: 1,
                value: t,
                onChange: p => {
                    let h = parseInt(p.target.value);
                    o(h)
                },
                onMouseUp: () => {
                    i && i(t)
                },
                zIndex: 1,
                disabled: !!a,
                hiddenOpacityMarker: l
            })]
        })]
    })
}
var Qh, LR, FG, DG, AG, zR, $R = k(() => {
    "use strict";
    Qh = E(N()), LR = E(qm());
    ie();
    ve();
    Kv();
    zt();
    AR();
    B();
    FG = `
  &::-webkit-slider-thumb {
    background-color: transparent;
    height: 24px;
    width: 24px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.2);
    appearance: none;
    -webkit-appearance: none;
    cursor: pointer;
    cursor: move;
    cursor: grab;
    cursor: -webkit-grab;

    &:active,
    &:hover:active {
      cursor: grabbing;
      cursor: -webkit-grabbing;
    }
  }

  &::-moz-range-thumb {
    background-color: transparent;
    height: 24px;
    width: 24px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.2);
    appearance: none;
    -webkit-appearance: none;
    cursor: pointer;
    cursor: move;
    cursor: grab;
    cursor: -webkit-grab;

    &:active,
    &:hover:active {
      cursor: grabbing;
      cursor: -webkit-grabbing;
    }
  }
`, DG = `
  &::-webkit-slider-thumb {
    opacity: 0;
  }

  &::-moz-range-thumb {
    opacity: 0;
  }

  &::-ms-thumb {
    opacity: 0;
  }
`, AG = b.withComponent(ue("input", {
            excludeProps: ["hiddenOpacityMarker"]
        })
        `
  margin: 0;
  position: relative;
  z-index: 1;
  -webkit-appearance: none;
  background-color: transparent;
  padding: 0 4px;
  height: 32px;
  display: block;
  outline: none;
  width: 100%;
  box-sizing: border-box;

  &:focus {
    outline: none;
  }

  &:active,
  &:hover:active {
    cursor: grabbing;
  }

  &:disabled {
    cursor: initial;

    :active {
      cursor: initial;
    }

    ::-webkit-slider-thumb {
      cursor: initial;
      opacity: 0.8;

      :active,
      :hover:active {
        cursor: initial;
      }
    }

    ::-moz-range-thumb {
      cursor: initial;
      opacity: 0.8;

      :active,
      :hover:active {
        cursor: initial;
      }
    }
  }

  &::-moz-range-track {
    outline: none !important;
    appearance: none;
    opacity: 0;
  }

  &::-ms-track {
    outline: none !important;
    appearance: none;
    opacity: 0;
  }

  ${e=>e.hiddenOpacityMarker?Z`
          ${DG}
        `:Z`
          ${FG}
        `}
`);
    zR = (0, Qh.memo)(LG)
});

function $G({
    hue: e = 128,
    disabled: t,
    hideSlider: o,
    onChange: i,
    onChangeComplete: n
}) {
    return r(b, {
        height: 24,
        width: "100%",
        children: r(zG, {
            disabled: t,
            "data-testid": "colorpicker-hue",
            type: "range",
            min: 0,
            max: 360,
            step: 1,
            hideSlider: !!o,
            value: e,
            onChange: s => {
                let a = parseInt(s.target.value);
                i(a)
            },
            onMouseUp: () => {
                n && n(e)
            }
        })
    })
}
var WR, zG, OR, jR = k(() => {
    "use strict";
    WR = E(N());
    ve();
    ie();
    B();
    zG = ue("input", {
        excludeProps: ["hideSlider"]
    })
    `
  margin: 0;
  position: relative;
  z-index: 1;
  -webkit-appearance: none;
  background-color: rgba(235, 217, 217, 0.1);
  height: 24px;
  width: 100%;
  display: block;
  outline: none;
  background: linear-gradient(
    to right,
    rgb(255, 0, 0),
    rgb(255, 255, 0),
    rgb(0, 255, 0),
    rgb(0, 255, 255),
    rgb(0, 0, 255),
    rgb(255, 0, 255),
    rgb(255, 0, 0)
  );

  &:focus {
    outline: none;
  }

  &:active,
  &:hover:active {
    cursor: grabbing;
    cursor: -webkit-grabbing;
  }

  &::-moz-range-track {
    outline: none !important;
    appearance: none;
    opacity: 0;
  }

  &::-ms-track {
    outline: none !important;
    appearance: none;
    opacity: 0;
  }

  &::-webkit-slider-thumb {
    height: 20px;
    width: 2px;
    border-radius: 2px;
    appearance: none;
    -webkit-appearance: none;
    background-color: #000;
    cursor: pointer;
    cursor: move;
    cursor: ${({hideSlider:e})=>e?"initial":"grab"};
    cursor: ${({hideSlider:e})=>e?"initial":"-webkit-grab"};
    opacity: ${({hideSlider:e})=>e?0:1};

    &:active,
    &:hover:active {
      cursor: grabbing;
      cursor: -webkit-grabbing;
    }
  }

  &::-moz-range-thumb {
    height: 20px;
    width: 2px;
    border-radius: 2px;
    appearance: none;
    -webkit-appearance: none;
    background-color: #000;
    cursor: pointer;
    cursor: move;
    cursor: ${({hideSlider:e})=>e?"initial":"grab"};
    cursor: ${({hideSlider:e})=>e?"initial":"-webkit-grab"};
    opacity: ${({hideSlider:e})=>e?0:1};

    &:active,
    &:hover:active {
      cursor: grabbing;
      cursor: -webkit-grabbing;
    }
  }

  &[disabled] {
    pointer-events: none;
  }
`;
    OR = (0, WR.memo)($G)
});

function WG({
    color: e,
    defaultColor: t,
    onChange: o,
    onSwatchAdd: i,
    onSwatchRemove: n,
    projectSwatches: s,
    globalSwatches: a,
    onChangeComplete: l,
    onMoveColors: c,
    width: d = 168,
    height: p = 288,
    showAlpha: h = !0,
    regularInRow: u,
    regularRowsMin: m,
    favouriteInRow: f,
    favouriteRows: g,
    regularGap: y,
    favouriteGap: S,
    borderRadius: w = "8px",
    onStartDrag: v,
    onEndDrag: C,
    initialSection: I,
    onSectionChanged: T,
    swatchesOnlyMode: P,
    hiddenColorMarker: M = !1,
    hiddenOpacityMarker: F = !1,
    onOpacityChange: R,
    onChangeTab: A
}) {
    let [D, O] = (0, on.useState)(P ? "swatches" : I || "color"), [L, W] = (0, on.useState)("project"), z = (0, on.useMemo)(() => e || t || HR, [e, t, HR]), V = Ee => {
        o({ ...Ee,
            a: z.a
        })
    }, X = Ee => {
        l && l({ ...Ee,
            a: z.a
        })
    }, q = Ee => {
        if (R) {
            R(Ee / 100);
            return
        }
        o({ ...z,
            a: Ee / 100
        })
    }, ne = Ee => {
        if (R) {
            R(Ee / 100);
            return
        }
        l && l({ ...z,
            a: Ee / 100
        })
    }, re = Ee => {
        o({ ...z,
            h: Ee
        })
    }, te = Ee => {
        l && l({ ...z,
            h: Ee
        })
    }, ee = Ee => {
        A && !A(Ee) || W(Ee)
    }, {
        favouriteSwatches: j,
        regularSwatches: se,
        allSwatches: oe
    } = (0, on.useMemo)(() => {
        let Ee = L === "project" ? s : a,
            Qe = Ee ? Ee.favourites || [] : [],
            _t = Ee ? Ee.regular || [] : [],
            Ge = [...Qe, ..._t];
        return {
            favouriteSwatches: Qe,
            regularSwatches: _t,
            allSwatches: Ge
        }
    }, [L, s, a]), U = Ee => {
        let [Qe, _t, Ge] = (0, au.default)(`#${Ee}`).hsv().array();
        o({
            h: Qe,
            s: _t,
            v: Ge,
            a: z.a
        }), l && l({
            h: Qe,
            s: _t,
            v: Ge,
            a: z.a
        })
    }, he = (0, on.useMemo)(() => oe.find(Ee => Ee && Ee.toLowerCase() === (0, au.default)({
        h: z.h,
        s: z.s,
        v: z.v
    }).hex().toLowerCase().replace("#", "")), [z, oe]), [xe, pe] = (0, on.useState)("");
    (0, on.useEffect)(() => {
        pe((0, au.default)({
            h: z.h,
            s: z.s,
            v: z.v
        }).hex().replace("#", ""))
    }, [z]);
    let J = (0, on.useCallback)(Ee => {
            c && c({ ...Ee,
                tab: L
            })
        }, [L, c]),
        le = (0, on.useCallback)(Ee => {
            if (Ee.length === 6 && Ee[0] !== "#" || Ee.length === 7 && Ee[0] === "#") {
                let Qe = Ee[0] === "#" ? Ee : `#${Ee}`;
                pe(Qe);
                let [_t, Ge, br] = (0, au.default)(Qe).hsv().array();
                o({
                    h: _t,
                    s: Ge,
                    v: br,
                    a: z.a
                }), l && l({
                    h: _t,
                    s: Ge,
                    v: br,
                    a: z.a
                })
            } else pe(Ee)
        }, [o, l]),
        ye = (0, on.useMemo)(() => `Show ${D==="color"?"swatches":"color"} panel`, [D]),
        Ue = (0, on.useCallback)(() => {
            let Ee = D === "color" ? "swatches" : "color";
            O(Ee), T && T(Ee)
        }, [D, T]),
        Te = (0, on.useCallback)(Ee => {
            let Qe = Ee.clipboardData.getData("text");
            typeof Qe == "string" && (Qe.length === 7 || Qe.length === 6) && le(Qe.length === 7 && Qe[0] === "#" ? Qe.replace("#", "") : Qe)
        }, [le]),
        Re = (0, on.useCallback)(Ee => {
            le(Ee.target.value)
        }, [le]),
        Tt = (0, on.useCallback)(() => {
            i && i(L, (0, au.default)({
                h: z.h,
                s: z.s,
                v: z.v
            }).hex().replace("#", ""))
        }, [L, z, i]);
    return x(b, {
        display: "flex",
        flexDirection: "column",
        width: d,
        height: p,
        backgroundColor: D === "color" ? "#000" : "black",
        overflow: "hidden",
        borderRadius: w,
        "data-testid": "color-picker-wrapper",
        userSelect: "none",
        ...kp.fixRadiusClip(),
        children: [D === "color" ? x(Q, {
            children: [r(b, {
                position: "relative",
                marginBottom: 16,
                height: "100%",
                minHeight: 0,
                children: r(ER, {
                    height: "100%",
                    width: d,
                    hue: z.h,
                    saturation: z.s,
                    value: z.v,
                    hidePointer: M || !e,
                    onChange: V,
                    onChangeComplete: X,
                    onStartDrag: v,
                    onEndDrag: C
                })
            }), h && r(b, {
                position: "relative",
                height: 32,
                minHeight: 32,
                width: d - 12 - 12,
                margin: "0 auto",
                marginBottom: 12,
                children: r(zR, {
                    previewValue: !0,
                    previewValueColor: "white",
                    disabled: !e,
                    color: z,
                    opacity: z.a * 100,
                    onChange: q,
                    onChangeComplete: ne,
                    hiddenOpacityMarker: F
                })
            })]
        }) : x(Q, {
            children: [r(b, {
                height: "100%",
                marginBottom: "1rm",
                overflow: "hidden",
                children: r(xo, {
                    children: ({
                        ref: Ee
                    }) => r(b, {
                        ref: Ee,
                        paddingLeft: 16,
                        paddingRight: 16,
                        paddingTop: "2rm",
                        children: r(IR, {
                            color: z,
                            regular: se,
                            favourites: j,
                            selectSwatchColor: U,
                            onMoveColors: J,
                            regularInRow: u,
                            regularRowsMin: m,
                            regularGap: y,
                            favouriteInRow: f,
                            favouriteRows: g,
                            favouriteGap: S
                        })
                    })
                })
            }), x(b, {
                textAlign: "center",
                marginBottom: "10px",
                height: "30px",
                children: [r(K, {
                    onClick: () => ee("project"),
                    disabled: L === "project",
                    marginRight: "2rm",
                    opacity: .6,
                    css: Z `
                &[disabled] {
                  opacity: 1;
                  color: white;
                }

                &:hover {
                  opacity: 1;
                }
              `,
                    children: r(Bo, {
                        fontSize: "12px",
                        color: "white",
                        children: "Project"
                    })
                }), r(K, {
                    onClick: () => ee("global"),
                    disabled: L === "global",
                    opacity: "0.6",
                    css: Z `
                &[disabled] {
                  opacity: 1;
                  color: white;
                }

                &:hover {
                  opacity: 1;
                }
              `,
                    children: r(Bo, {
                        fontSize: "12px",
                        color: "white",
                        children: "Global"
                    })
                })]
            })]
        }), r(b, {
            marginBottom: 12,
            marginLeft: 16,
            marginRight: 16,
            children: x(b, {
                display: "flex",
                height: 24,
                alignItems: "center",
                justifyContent: "space-between",
                children: [r(b, {
                    height: 24,
                    width: 24,
                    children: P ? null : x(K, {
                        "data-testid": "colorpicker-swatches-toggle",
                        onClick: Ue,
                        variant: "clean",
                        children: [r(Vr, {
                            children: ye
                        }), r(hR, {})]
                    })
                }), r(b, {
                    children: r(Mo, {
                        value: xe,
                        textAlign: "center",
                        color: "white",
                        textStyle: "regular",
                        fontSize: "12px",
                        fontWeight: 600,
                        maxLength: 6,
                        padding: "0",
                        border: "none!important",
                        height: 24,
                        "data-testid": "colorpicker-hex-input",
                        onPaste: Te,
                        onChange: Re,
                        readOnly: P
                    })
                }), r(b, {
                    display: "flex",
                    height: 24,
                    width: 24,
                    alignItems: "center",
                    justifyContent: "center",
                    children: P ? null : r(Q, {
                        children: he ? x(K, {
                            variant: "clean",
                            height: 24,
                            width: 24,
                            onClick: () => n && n(L, he),
                            children: [r(Vr, {
                                children: "Remove color"
                            }), r(fR, {})]
                        }) : x(K, {
                            "data-testid": "colorpicker-swatches-add-color",
                            variant: "clean",
                            disabled: !e,
                            height: 24,
                            width: 24,
                            onClick: Tt,
                            children: [r(Vr, {
                                children: "Add color"
                            }), r(bR, {})]
                        })
                    })
                })]
            })
        }), r(b, {
            height: 24,
            position: "relative",
            children: r(OR, {
                hue: z.h,
                onChange: re,
                onChangeComplete: te,
                disabled: P,
                hideSlider: !e
            })
        })]
    })
}
var on, au, oa, vn, HR, Lx, Jh = k(() => {
    "use strict";
    on = E(N());
    ie();
    Be();
    mR();
    gR();
    yR();
    je();
    Ch();
    Kv();
    PR();
    FR();
    $R();
    jR();
    au = E(qm());
    Ur();
    or();
    ve();
    B();
    oa = (e => (e.favourites = "favourites", e.regular = "regular", e))(oa || {}), vn = (e => (e.global = "global", e.project = "project", e))(vn || {}), HR = {
        h: 180,
        s: 0,
        v: 0,
        a: 1
    };
    Lx = WG
});
var NR = k(() => {
    "use strict";
    Jh();
    Jh()
});
var UR, zx, VR, GR, YR, $x, ZR, Wx = k(() => {
    "use strict";
    Xd();
    UR = e => Gt.get(`/api/swatches/project/${e}`), zx = ({
        projectId: e,
        ...t
    }) => Gt.put(`/api/swatches/project/${e}`, t), VR = ({
        projectId: e,
        ...t
    }) => Gt.put(`/api/swatches/project/${e}/move`, t), GR = ({
        projectId: e,
        colors: t
    }) => Gt.put(`/api/swatches/project/${e}/reset`, {
        colors: t
    }), YR = e => Gt.get(`/api/swatches/global/${e}`), $x = ({
        userId: e,
        ...t
    }) => Gt.put(`/api/swatches/global/${e}`, t), ZR = ({
        userId: e,
        ...t
    }) => Gt.put(`/api/swatches/global/${e}/move`, t)
});
var XR, JR, KR, qR, zwe, QR = k(() => {
    "use strict";
    Nc();
    Wx();
    XR = {
        favourites: [],
        regular: []
    }, [JR, KR, qR] = er({
        global: { ...XR
        },
        project: { ...XR
        }
    }), zwe = async ({
        projectId: e,
        userId: t
    }) => {
        let [{
            data: o
        }, {
            data: i
        }] = await Promise.all([YR(t), UR(e)]);
        if (!i || !i.favourites.length && !i.regular.length) {
            let n = {
                favourites: window.ServerData.editParams.fav_colors,
                regular: window.ServerData.editParams.swatches
            };
            KR({
                global: o,
                project: n
            }), GR({
                projectId: e,
                colors: n
            })
        } else KR({
            global: o,
            project: i
        })
    }
});
var e4, t4 = k(() => {
    "use strict";
    e4 = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swIiBtYXNrLXR5cGU9ImFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjIiIGhlaWdodD0iMjIiPgo8Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSIxMC41IiBmaWxsPSIjQkU0MDQwIiBzdHJva2U9IiNCOEI4QjgiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swKSI+CjxjaXJjbGUgY3g9IjEiIGN5PSIxIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEiIGN5PSI5IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEiIGN5PSIxNyIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1IiBjeT0iNSIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1IiBjeT0iMTMiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNSIgY3k9IjIxIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzIiBjeT0iNSIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMyIgY3k9IjEzIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzIiBjeT0iMjEiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjEiIGN5PSI1IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjIxIiBjeT0iMTMiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjEiIGN5PSIyMSIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1IiBjeT0iMSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNSIgY3k9IjkiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjUiIGN5PSIxNyIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMSIgY3k9IjUiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEiIGN5PSIxMyIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMSIgY3k9IjIxIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5IiBjeT0iNSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjEzIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5IiBjeT0iMjEiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE3IiBjeT0iNSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTciIGN5PSIxMyIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTciIGN5PSIyMSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjEiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjE3IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzIiBjeT0iMSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTMiIGN5PSI5IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMyIgY3k9IjE3IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxNyIgY3k9IjEiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTciIGN5PSI5IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjE3IiBjeT0iMTciIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjEiIGN5PSIxIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIyMSIgY3k9IjkiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIxIiBjeT0iMTciIHI9IjIiIGZpbGw9IndoaXRlIi8+CjwvZz4KPC9zdmc+Cg=="
});

function OG(e, t) {
    let o = { ...e
    };
    if (t) {
        let i = yt(t);
        !o.favourites.includes(i) && !o.regular.includes(i) && o.regular.push(i)
    }
    return o
}

function jG(e, t) {
    let o = Math.ceil(100 / e.length),
        i = "",
        n = 0;
    return e.forEach((s, a) => {
        i += `${s} ${n}% ${n+o}%`, a + 1 < e.length && (i += ", "), n += o
    }), `linear-gradient(${t}deg, ${i})`
}

function sc({
    hex: e,
    borderWidth: t = "1px",
    borderColor: o = "white",
    opacity: i = 1,
    size: n
}) {
    let s = Array.isArray(e) ? jG(e, -45) : e;
    return r(b, {
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        children: x(b, {
            width: n || 24,
            height: n || 24,
            borderRadius: "50%",
            border: `${t} solid`,
            borderColor: o,
            position: "relative",
            children: [r(b, {
                position: "absolute",
                top: 0,
                left: 0,
                width: "100%",
                height: "100%",
                zIndex: 2,
                borderRadius: "50%",
                style: {
                    background: s,
                    opacity: i
                }
            }), r(b, {
                position: "absolute",
                top: 0,
                left: 0,
                width: "100%",
                height: "100%",
                zIndex: 1,
                borderRadius: "50%",
                backgroundImage: `url('${e4}')`
            })]
        })
    })
}

function ac({
    projectId: e,
    userId: t,
    onChangeComplete: o,
    onColorChange: i,
    color: n,
    setColor: s,
    width: a = 170,
    height: l,
    swatchesOnlyMode: c,
    hiddenOpacityMarker: d = !1,
    hiddenColorMarker: p = !1,
    ...h
}) {
    let {
        model: u
    } = (0, rc.useContext)(Y), [m, f] = JR(), g = (0, rc.useMemo)(() => u ? .project ? .edit_params ? .get("colorbox_state") || "color", []), y = R => {
        u ? .project ? .edit_params.set("colorbox_state", R), u ? .project ? .edit_params.save()
    }, S = R => {
        f({ ...m,
            project: R
        })
    }, w = R => {
        f({ ...m,
            global: R
        })
    }, [v, C] = (0, rc.useState)(n);
    (0, rc.useEffect)(() => {
        (n && v && ro(v) !== ro(n) || n && !v) && C(n)
    }, [n]);
    let I = R => {
            C(R), s(R), i && i(R)
        },
        T = async (R, A) => {
            if (pt("constructor.globalFeature")) {
                let V = window.RM.constructorRouter.mag.user.get("permissions") ? .can_use_global_features;
                if (R === vn.global && !V) {
                    Jo("global-colors");
                    return
                }
            }
            let D = HG(R === vn.project ? m.project.regular : m.global.regular),
                O = R === vn.project ? zx : $x,
                L = R === vn.project ? S : w,
                W = R === vn.project ? m.project : m.global;
            W.regular[D] = A, L(W);
            let {
                data: z
            } = await O({
                userId: t,
                projectId: e,
                color: A,
                index: D,
                type: oa.regular
            });
            L(z), window.RM.constructorRouter.trigger("update_from_server", "Swatches", {
                [R]: z
            }), De(Fe.WidgetFeature, {
                featureType: R === vn.project ? "color create new swatch" : "color create new global swatch"
            })
        },
        P = async (R, A) => {
            let D = R === vn.project ? m.project : m.global,
                O = R === vn.project ? S : w,
                L = R === vn.project ? zx : $x,
                W = D.regular.findIndex(V => V && V.toLowerCase() === A.toLowerCase()),
                z = D.favourites.findIndex(V => V && V.toLowerCase() === A.toLowerCase());
            if (W > -1) {
                let V = R === vn.project ? m.project : m.global;
                V.regular[W] = void 0, O(V);
                let {
                    data: X
                } = await L({
                    color: void 0,
                    index: W,
                    type: oa.regular,
                    projectId: e,
                    userId: t
                });
                O(X), window.RM.constructorRouter.trigger("update_from_server", "Swatches", {
                    [R]: X
                })
            } else if (z > -1) {
                let V = R === vn.project ? m.project : m.global;
                V.favourites[W] = void 0, O(V);
                let {
                    data: X
                } = await L({
                    color: void 0,
                    index: z,
                    type: oa.favourites,
                    projectId: e,
                    userId: t
                });
                O(X), window.RM.constructorRouter.trigger("update_from_server", "Swatches", {
                    [R]: X
                })
            }
        },
        M = async ({
            tab: R,
            from: A,
            to: D,
            color: O,
            newIndex: L,
            oldIndex: W
        }) => {
            let z = qR(),
                V = R === vn.project ? z.project : z.global,
                X = R === vn.project ? S : w;
            if (A !== D) {
                let q = [...V[A]];
                q[W] = void 0;
                let ne = [...V[D]];
                ne[L] = O;
                let re = {
                    [A]: q,
                    [D]: ne
                };
                X(re), window.RM.constructorRouter.trigger("update_from_server", "Swatches", {
                    [R]: re
                })
            } else {
                let q = [...V[A]];
                q[W] = void 0, q[L] = O;
                let ne = { ...V,
                    [A]: q
                };
                X(ne), window.RM.constructorRouter.trigger("update_from_server", "Swatches", {
                    [R]: ne
                })
            }
            if (R === vn.project) {
                let {
                    data: q
                } = await VR({
                    projectId: e,
                    from: A,
                    to: D,
                    color: O,
                    newIndex: L,
                    oldIndex: W
                });
                S(q)
            } else {
                let {
                    data: q
                } = await ZR({
                    userId: t,
                    from: A,
                    to: D,
                    color: O,
                    newIndex: L,
                    oldIndex: W
                });
                w(q)
            }
        },
        F = R => {
            if (pt("constructor.globalFeature")) {
                if (R === vn.project) return !0;
                let A = m.global.favourites.length === 0 && m.global.regular.length === 0,
                    D = window.RM.constructorRouter.mag.user.get("permissions") ? .can_use_global_features;
                return A && !D ? (Jo("global-colors"), !1) : !0
            } else return !0
        };
    return r(Lx, {
        width: a,
        height: l,
        onChange: I,
        color: v,
        defaultColor: de.textWidget.initialColor,
        projectSwatches: c ? OG(m.project, v) : m.project,
        globalSwatches: m.global,
        onChangeComplete: o,
        initialSection: g,
        onSectionChanged: y,
        swatchesOnlyMode: c,
        ...h,
        onSwatchAdd: T,
        onSwatchRemove: P,
        onMoveColors: M,
        hiddenColorMarker: p,
        hiddenOpacityMarker: d,
        onChangeTab: F
    })
}
var rc, HG, em = k(() => {
    "use strict";
    rc = E(N());
    ie();
    NR();
    qt();
    Wx();
    QR();
    ko();
    t4();
    ae();
    Mt();
    En();
    Xs();
    B();
    HG = e => {
        let t = e.reduce((o, i, n) => o === null && !i ? n : o, null);
        return t !== null ? t : e.length
    }
});

function NG({
    title: e = "",
    projectId: t,
    userId: o,
    color: i,
    colors: n = [],
    setColor: s,
    onChangeComplete: a,
    onColorChange: l,
    container: c,
    width: d,
    height: p,
    type: h = "list-item",
    showAlpha: u,
    regularInRow: m,
    regularRowsMin: f,
    favouriteInRow: g,
    favouriteRows: y,
    regularGap: S,
    favouriteGap: w,
    borderRadius: v,
    circleBorderWidth: C,
    circleBorderColor: I,
    circleSize: T = 28,
    onPanelShow: P,
    onPanelHide: M,
    nested: F,
    showBorder: R,
    disabled: A,
    multipleValues: D,
    swatchesOnlyMode: O,
    offset: L = 0,
    skidding: W = 0,
    opacity: z = [],
    onOpacityChange: V,
    "data-testid": X
}) {
    let q = (0, Rr.useRef)(null),
        ne = (0, Rr.useRef)(null),
        {
            modelSet: re
        } = (0, Rr.useContext)(Y),
        [te, ee] = (0, Rr.useState)(!1),
        [j, se] = (0, Rr.useState)(""),
        [oe, U] = (0, Rr.useState)(null),
        [he, xe] = (0, Rr.useState)(null),
        {
            styles: pe,
            attributes: J
        } = xa(oe, he, {
            placement: "top",
            modifiers: [{
                name: "offset",
                options: {
                    offset: [W, L]
                }
            }]
        }),
        le = pR({
            callback: Re => {
                let Tt = Re.target;
                ne ? .current ? .contains(Tt) || (ee(!1), re ? .({
                    preventClose: !1
                }))
            },
            capture: !0,
            watchingClick: te
        }),
        ye = Ik(le, q);
    (0, Rr.useEffect)(() => (te ? P && P() : M && M(), () => {
        M && M()
    }), [te]), (0, Rr.useEffect)(() => {
        if (i) {
            let Re = yt(i);
            Re !== j && se(Re)
        }
    }, [i]), (0, Rr.useEffect)(() => () => {
        re ? .({
            preventClose: !1
        })
    }, []);
    let Ue = r(b, {
            position: "relative",
            zIndex: 20,
            ref: xe,
            style: pe.popper,
            ...J.popper,
            children: r(b, {
                ref: ye,
                children: r(ac, {
                    width: d,
                    height: p,
                    borderRadius: v,
                    projectId: t,
                    userId: o,
                    color: i || void 0,
                    setColor: s,
                    showAlpha: u,
                    regularInRow: m,
                    regularRowsMin: f,
                    favouriteInRow: g,
                    favouriteRows: y,
                    regularGap: S,
                    favouriteGap: w,
                    swatchesOnlyMode: O,
                    onColorChange: l ? Re => {
                        Re && (se(yt(Re)), l(Re))
                    } : void 0,
                    onChangeComplete: a ? Re => {
                        Re && (se(yt(Re)), a(Re))
                    } : void 0,
                    hiddenColorMarker: n.length > 1,
                    hiddenOpacityMarker: z.length > 1,
                    onOpacityChange: V
                })
            })
        }),
        Te = r(K, {
            disabled: A,
            "data-testid": X,
            onClick: () => {
                ee(!te), re ? .({
                    preventClose: !te
                })
            },
            opacity: D ? .4 : 1,
            transition: ".1s opacity",
            ref: ne,
            css: Z `
        &:hover {
          opacity: 1;
        }
      `,
            children: r(sc, {
                hex: (n || []).length > 1 ? n : j ? "#" + j : "#F4F4F4",
                opacity: z[0] ? ? 1,
                borderWidth: C,
                borderColor: I || "rgba(184, 184, 184, 0.4)",
                size: T
            })
        });
    return h === "list-item" ? x(Q, {
        children: [r(b, {
            zIndex: 10,
            ref: U,
            children: r(H, {
                disabled: A,
                nested: F,
                showBorder: R,
                leftSlot: e,
                rightSlot: r(b, {
                    position: "relative",
                    children: Te
                })
            })
        }), te ? c ? Ox.default.createPortal(r(b, {
            children: Ue
        }), c) : Ue : null]
    }) : h === "circle" ? Te : h === "picker" ? Ue : h === "circle-and-picker" ? x(Q, {
        children: [r(b, {
            ref: U,
            display: "flex",
            children: Te
        }), te ? c ? Ox.default.createPortal(r(b, {
            children: Ue
        }), c) : Ue : null]
    }) : null
}
var Rr, Ox, qe, nn = k(() => {
    "use strict";
    Rr = E(N()), Ox = E(gi());
    wp();
    ie();
    je();
    $e();
    ve();
    Sv();
    ae();
    ko();
    uR();
    em();
    B();
    qe = NG
});

function gb() {
    return (e, t) => {
        switch (t.type) {
            case "Reset":
                return { ...t.payload
                };
            case "SetInfo":
                return { ...e,
                    ...t.payload
                };
            case "SetCss":
                return { ...e,
                    cssProperties: { ...e.cssProperties,
                        ...t.payload
                    }
                };
            default:
                return e
        }
    }
}

function UG({
    style: e,
    headerSlot: t,
    onCancel: o,
    onDone: i,
    textStyle: n,
    setTextStyle: s,
    projectId: a,
    userId: l,
    initialTextStyle: c,
    isNewStyle: d,
    onToggleSelectPanel: p,
    additionalSettings: h,
    getScrollablePanelProps: u
}, m) {
    let [f, g] = (0, wn.useState)(!1), y = Fn(.76, ce.gray), S = (0, wn.useCallback)(async () => {
        f && (await s({
            type: "Reset",
            payload: { ...c
            }
        }), await g(!1))
    }, [f, c]), [w, v] = (0, wn.useState)(n.cssProperties.color ? Yo(n.cssProperties.color) : de.textWidget.initialColor);
    (0, wn.useEffect)(() => {
        let X = n.cssProperties.color ? Yo(n.cssProperties.color) : de.textWidget.initialColor;
        w !== X && v(X)
    }, [n.cssProperties.color]);
    let C = () => {
            let X = de.AVAILABLE_TEXT_TAGS;
            if (kr(n)) {
                let q = n.tag,
                    ne = X.indexOf(q);
                return ne > -1 ? X[ne + 1] || X[0] : q
            }
            return X[0]
        },
        I = () => {
            let X = ["left", "center", "right", kr(n) && "justify"].filter(re => re),
                q = n.cssProperties.textAlign && X.includes(n.cssProperties.textAlign) ? n.cssProperties.textAlign : "left",
                ne = X.indexOf(q);
            return ne > -1 ? X[ne + 1] || X[0] : q
        },
        T = (0, wn.useMemo)(() => {
            switch (`align-${n.cssProperties.textAlign}`) {
                case "align-center":
                    return fp;
                case "align-right":
                    return bp;
                case "align-justify":
                    return gp;
                default:
                    return Jc
            }
        }, [n.cssProperties.textAlign]),
        P = (0, wn.useMemo)(() => n.cssProperties.textTransform === "uppercase", [n.cssProperties.textTransform]),
        [M, F] = (0, wn.useState)(n.label),
        [R, A] = (0, wn.useState)([]);
    (0, wn.useEffect)(() => {
        let X = !mb.default.isEqual(c, n) || !mb.default.isEqual(M, c.label);
        X !== f && g(X);
        let q = [];
        Object.keys(n).forEach(ne => {
            n[ne] !== c[ne] && q.push(ne)
        }), mb.default.isEqual(M, c.label) || q.push("label"), Object.keys(n.cssProperties).forEach(ne => {
            n.cssProperties[ne] !== c.cssProperties[ne] && q.push(ne)
        }), A(q)
    }, [n, M]);
    let D = X => R.includes(X),
        O = ks(n.cssProperties.letterSpacing, !0),
        L = String(O).length > 4,
        [W, z] = (0, wn.useState)(!1),
        V = () => {
            s({
                type: "SetInfo",
                payload: {
                    label: M
                }
            }), z(!0)
        };
    return (0, wn.useEffect)(() => {
        W && i()
    }, [n]), r(Me, {
        isShowed: !0,
        ref: m,
        style: e,
        ...u(),
        children: r(Ot.Consumer, {
            children: ({
                dropdownContainer: X
            }) => x(Q, {
                children: [t || null, r(H, {
                    showBorder: !1,
                    leftSlot: r(Mo, {
                        placeholder: "Style Name",
                        value: M,
                        onChange: q => {
                            F(q.target.value)
                        },
                        padding: "0 !important",
                        border: "none !important",
                        color: D("label") || d ? "blue" : "black"
                    })
                }), r(nb, {
                    onToggleSelectPanel: p,
                    dropdownPortal: X,
                    textStyle: kr(n) ? n : void 0,
                    listStyle: kr(n) ? void 0 : n,
                    onChangeTextStyle: q => {
                        !kr(n) && q.fontVariationSettings || s({
                            type: "SetCss",
                            payload: q
                        })
                    }
                }), r(H, {
                    leftSlot: "Text size",
                    rightSlot: r(fe, {
                        textAlign: "right",
                        min: 8,
                        max: 999,
                        value: ks(n.cssProperties.fontSize),
                        color: D("fontSize") ? "blue" : "black",
                        autoWidth: !0,
                        onChange: ({
                            value: q
                        }) => {
                            s({
                                type: "SetCss",
                                payload: {
                                    fontSize: q
                                }
                            })
                        }
                    })
                }), kr(n) && r(H, {
                    leftSlot: "Line height",
                    rightSlot: r(fe, {
                        min: 8,
                        max: 999,
                        textAlign: "right",
                        value: ks(n.cssProperties.lineHeight),
                        color: D("lineHeight") ? "blue" : "black",
                        autoWidth: !0,
                        onChange: ({
                            value: q
                        }) => {
                            s({
                                type: "SetCss",
                                payload: {
                                    lineHeight: q
                                }
                            })
                        }
                    })
                }), r(H, {
                    leftSlot: "Letter spacing",
                    rightSlot: r(fe, {
                        textAlign: "right",
                        min: -99,
                        max: 999,
                        step: .1,
                        fontSize: L ? 16 : void 0,
                        value: O,
                        color: D("letterSpacing") ? "blue" : "black",
                        autoWidth: !0,
                        onChange: ({
                            value: q
                        }) => {
                            s({
                                type: "SetCss",
                                payload: {
                                    letterSpacing: q
                                }
                            })
                        }
                    })
                }), !kr(n) && r(H, {
                    leftSlot: "Column width",
                    rightSlot: r(fe, {
                        textAlign: "right",
                        min: 0,
                        max: 999,
                        value: ks(n.cssProperties.width, !0),
                        color: D("width") ? "blue" : "black",
                        autoWidth: !0,
                        onChange: ({
                            value: q
                        }) => {
                            s({
                                type: "SetCss",
                                payload: {
                                    width: q
                                }
                            })
                        }
                    })
                }), r(H, {
                    leftSlot: x(b, {
                        display: "flex",
                        alignItems: "center",
                        justifyContent: "flex-start",
                        children: [r(K, {
                            variant: "clean",
                            marginLeft: "-6px",
                            onClick: () => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        textTransform: P ? void 0 : "uppercase"
                                    }
                                })
                            },
                            children: r(Ff, {
                                color: P ? "blue" : "black",
                                width: 32,
                                height: 32
                            })
                        }), r(K, {
                            variant: "clean",
                            marginLeft: "-6px",
                            marginTop: "-1px",
                            onClick: () => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        fontWeight: n.cssProperties.fontWeight === 700 ? 400 : 700
                                    }
                                })
                            },
                            children: r(If, {
                                color: n.cssProperties.fontWeight === 700 ? "blue" : "black",
                                width: 25,
                                height: 25,
                                viewBox: "-11 -9 30 30"
                            })
                        }), r(K, {
                            variant: "clean",
                            marginLeft: "-6px",
                            onClick: () => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        fontStyle: n.cssProperties.fontStyle === "italic" ? "normal" : "italic"
                                    }
                                })
                            },
                            children: r(Mf, {
                                color: n.cssProperties.fontStyle === "italic" ? "blue" : "black",
                                width: 26,
                                height: 26,
                                viewBox: "-13 -8 30 30"
                            })
                        }), r(K, {
                            variant: "clean",
                            marginLeft: "-6px",
                            onClick: () => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        textDecoration: n.cssProperties.textDecoration === "underline" ? void 0 : "underline"
                                    }
                                })
                            },
                            children: r(zf, {
                                color: n.cssProperties.textDecoration === "underline" ? "blue" : "black",
                                width: 30,
                                height: 30
                            })
                        }), r(K, {
                            variant: "clean",
                            marginLeft: "-6px",
                            onClick: () => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        textDecoration: n.cssProperties.textDecoration === "line-through" ? void 0 : "line-through"
                                    }
                                })
                            },
                            children: r(Af, {
                                color: n.cssProperties.textDecoration === "line-through" ? "blue" : "black",
                                width: 30,
                                height: 30
                            })
                        })]
                    })
                }), r(qe, {
                    "data-testid": "text-styles-color",
                    container: X,
                    title: "Color",
                    projectId: a,
                    userId: l,
                    color: w,
                    setColor: v,
                    onChangeComplete: q => {
                        s({
                            type: "SetCss",
                            payload: {
                                color: ro(q)
                            }
                        })
                    }
                }), h, x(b, {
                    paddingTop: 21,
                    paddingBottom: 22,
                    children: [kr(n) && r(b, {
                        display: "flex",
                        justifyContent: "center",
                        marginBottom: "8px",
                        children: r(fe, {
                            textAlign: "center",
                            min: 0,
                            max: 999,
                            value: ks(n.cssProperties.paddingTop),
                            color: D("paddingTop") ? "blue" : "black",
                            onChange: ({
                                value: q
                            }) => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        paddingTop: q
                                    }
                                })
                            }
                        })
                    }), x(b, {
                        display: "flex",
                        alignItems: "center",
                        flexDirection: "row",
                        marginBottom: 10,
                        children: [r(b, {
                            marginRight: 19,
                            children: r(fe, {
                                textAlign: "right",
                                min: 0,
                                max: 999,
                                value: ks(n.cssProperties.paddingLeft),
                                color: D("paddingLeft") ? "blue" : "black",
                                onChange: ({
                                    value: q
                                }) => {
                                    s({
                                        type: "SetCss",
                                        payload: {
                                            paddingLeft: q
                                        }
                                    })
                                }
                            })
                        }), r(b, {
                            children: r(K, {
                                variant: "clean",
                                onClick: () => {
                                    s({
                                        type: "SetCss",
                                        payload: {
                                            textAlign: I()
                                        }
                                    })
                                },
                                children: r(T, {
                                    color: D("textAlign") ? "blue" : "black"
                                })
                            })
                        }), r(b, {
                            marginLeft: 19,
                            children: r(fe, {
                                textAlign: "left",
                                min: 0,
                                max: 999,
                                value: ks(n.cssProperties.paddingRight),
                                color: D("paddingRight") ? "blue" : "black",
                                onChange: ({
                                    value: q
                                }) => {
                                    s({
                                        type: "SetCss",
                                        payload: {
                                            paddingRight: q
                                        }
                                    })
                                }
                            })
                        })]
                    }), kr(n) && r(b, {
                        display: "flex",
                        justifyContent: "center",
                        marginBottom: 10,
                        children: r(fe, {
                            textAlign: "center",
                            min: 0,
                            max: 999,
                            value: ks(n.cssProperties.paddingBottom),
                            color: D("paddingBottom") ? "blue" : "black",
                            onChange: ({
                                value: q
                            }) => {
                                s({
                                    type: "SetCss",
                                    payload: {
                                        paddingBottom: q
                                    }
                                })
                            }
                        })
                    })]
                }), kr(n) && r(b, {
                    paddingLeft: "4rm",
                    paddingRight: "4rm",
                    children: r(b, {
                        borderBottom: "2px solid",
                        borderColor: y
                    })
                }), kr(n) && r(H, {
                    leftSlot: "HTML Tag",
                    rightSlot: r(K, {
                        onClick: () => s({
                            type: "SetInfo",
                            payload: {
                                tag: C()
                            }
                        }),
                        variant: "clean",
                        children: x($, {
                            textStyle: "small",
                            color: D("tag") ? "blue" : "black",
                            children: ["<", n.tag, ">"]
                        })
                    })
                }), r(qp, {
                    cancelAction: async () => {
                        await S(), o()
                    },
                    doneDisabled: !d && !f,
                    doneAction: V
                })]
            })
        })
    })
}
var wn, mb, bb, yb = k(() => {
    "use strict";
    wn = E(N()), mb = E(hn());
    Uc();
    ut();
    ie();
    jv();
    Ov();
    Wv();
    Ur();
    Be();
    zt();
    je();
    cI();
    R0();
    Y0();
    uI();
    Hv();
    yI();
    nt();
    ab();
    $e();
    nn();
    ih();
    Mt();
    ko();
    _v();
    FI();
    Sx();
    B();
    bb = (0, wn.forwardRef)(UG)
});
var tm, vb, jx = k(() => {
    "use strict";
    tm = E(N());
    Dn();
    Yv();
    ae();
    vb = () => {
        let {
            model: e
        } = (0, tm.useContext)(Y), t = (0, tm.useMemo)(() => e.project.get("_id"), [e]), o = (0, tm.useMemo)(() => e.user.get("_id"), [e]);
        return async ({
            newTextStyles: i,
            textStylesSection: n,
            triggerElement: s
        }) => {
            n === "global" ? await Ka({
                userId: o,
                styles: i
            }) : await _a({
                projectId: t,
                styles: i
            }), window.RM.constructorRouter.trigger("update_from_server", s, {
                [n]: i
            })
        }
    }
});
var wi, VG, i4, n4 = k(() => {
    "use strict";
    wi = E(N());
    ae();
    Dn();
    lh();
    ko();
    Ol();
    Tr();
    ni();
    _v();
    Ss();
    Yt();
    _s();
    nf(); of ();
    yb();
    $l();
    qi();
    jx();
    B();
    VG = (0, wi.forwardRef)(({
        style: e,
        headerSlot: t,
        getScrollablePanelProps: o
    }, i) => {
        let {
            goBack: n
        } = (0, wi.useContext)(Jt), s = vb(), {
            model: a,
            modelSet: l
        } = (0, wi.useContext)(Y), c = (0, wi.useMemo)(() => a.project.get("_id"), [a]), d = (0, wi.useMemo)(() => a.user.get("_id"), [a]), [p, h] = Ii(), [u, m] = a.useSharedState({
            partial: !1
        }), {
            selectedFont: f,
            selectedTextStyle: g,
            selectedTextStyleSection: y,
            setChangedStyle: S,
            changedStyle: w,
            setSelectedFont: v,
            setEditorStateBackup: C
        } = (0, wi.useContext)(tn), [I] = (0, wi.useState)(g ? g.name : `style-${zn()}`), T = (0, wi.useMemo)(() => {
            let z = pf(u),
                V = Ko({
                    block: z
                }),
                X = {
                    label: "New style",
                    name: I,
                    cssProperties: {
                        fontFamily: St.fontFamily,
                        fontWeight: `${St.fontWeight}`,
                        fontSize: St.fontSize,
                        lineHeight: St.lineHeight
                    },
                    tag: "p"
                };
            if (V) {
                let j = [...p.project, ...p.global].find(se => se.name === V);
                j && (X.cssProperties = j.cssProperties)
            }
            let q = u.getCurrentInlineStyle(),
                ne = nk(q);
            X.cssProperties = { ...X.cssProperties,
                ...ne,
                letterSpacing: ne.letterSpacing ? ks(ne.letterSpacing, !0) : X.cssProperties.letterSpacing,
                fontSize: ne.fontSize ? ks(ne.fontSize) : X.cssProperties.fontSize
            };
            let re = ch({
                    block: z
                }),
                te = Ga({
                    block: z
                }),
                ee = Jd({
                    block: z
                });
            return X.cssProperties = { ...X.cssProperties,
                color: ne.color ? XC(QC(ne.color)) : X.cssProperties.color,
                paddingLeft: re && re.left || X.cssProperties.left,
                paddingRight: re && re.right || X.cssProperties.right,
                paddingBottom: re && re.bottom || X.cssProperties.bottom,
                paddingTop: re && re.top || X.cssProperties.top,
                textAlign: te && te.replace("align-", "") || X.cssProperties.textAlign || "left",
                lineHeight: ee || X.cssProperties.lineHeight
            }, X
        }, []), P = (0, wi.useMemo)(() => y || "project", [y]), M = P === "global" ? p.global : p.project, F = (0, wi.useMemo)(() => {
            if (g) return g; {
                let z = { ...p,
                    [P]: [...p[P], { ...T
                    }]
                };
                return h(z), z[P].find(X => X.name === I) || {}
            }
        }, [g]), [R, A] = (0, wi.useReducer)(gb(), F);
        (0, wi.useEffect)(() => {
            A({
                type: "Reset",
                payload: { ...F
                }
            })
        }, [g]);
        let D = () => {
            let z = M.findIndex(V => V.name === R.name);
            if (z > -1) {
                let V = [...M];
                V[z] = { ...R
                }, h({ ...p,
                    [P]: V
                })
            }
        };
        (0, wi.useEffect)(() => {
            D(), S && S(R)
        }, [R]), (0, wi.useEffect)(() => {
            if (w && A({
                    type: "Reset",
                    payload: w
                }), f) {
                let {
                    style: z,
                    weight: V
                } = tr(f.variations.includes("n4") ? "n4" : f.variations[0]);
                A({
                    type: "SetCss",
                    payload: {
                        fontFamily: f.css_name,
                        fontWeight: V,
                        fontStyle: z
                    }
                }), v && v(void 0)
            }
        }, []);
        let O = async () => {
            let z = [...M],
                V = z.findIndex(X => X.name === R.name);
            S && S(void 0), C && C(void 0), V < 0 ? z.push(R) : z[V] = { ...R
            }, h({ ...p,
                [P]: z
            }), await s({
                textStylesSection: P,
                newTextStyles: z,
                triggerElement: "TextStyles"
            }), window.RM.constructorRouter.trigger("notice:triggerMetrics", "paragraphStyleCreated"), m(At(u, u.getSelection())), n()
        };
        return (0, wi.useEffect)(() => {
            if (!g) {
                let z = u.getSelection();
                m(At(sp({
                    style: R,
                    editorState: At(mh({
                        editorState: u
                    }), z)
                }), z))
            }
        }, []), r(bb, {
            style: e,
            ref: i,
            headerSlot: t,
            onCancel: async () => {
                n()
            },
            onDone: O,
            textStyle: R,
            setTextStyle: A,
            projectId: c,
            userId: d,
            initialTextStyle: F,
            isNewStyle: !g,
            onToggleSelectPanel: z => l({
                preventClose: z
            }),
            getScrollablePanelProps: o
        })
    }), i4 = VG
});

function YG({
    currentScreen: e,
    navigatorRef: t
}) {
    return r(Ut, {
        showBorder: e !== "FontsList",
        leftSlot: r(K, {
            "data-testid": "text-typography-back",
            variant: "clean",
            onClick: () => t.current && t.current.goBack(),
            css: Z `
            &:hover svg {
              color: ${ce.black};
              opacity: 1;
            }
          `,
            children: r(_r, {
                color: "darkGray"
            })
        })
    })
}

function ZG() {
    let {
        model: e
    } = (0, ei.useContext)(Y), [t] = e.useSharedState();
    (0, ei.useEffect)(() => {
        e.selected && e.blocks.length > 1 && e.groupSetAndSave(h => {
            let u = h.nonReactGetSharedState();
            return wr(u.getCurrentContent())
        })
    }, [e.selected, t, e.blocks]);
    let o = h => {
            c({
                selectedFont: h
            })
        },
        i = h => {
            c({
                selectedTextStyle: h
            })
        },
        n = h => {
            c({
                selectedTextStyleSection: h
            })
        },
        s = h => {
            c({
                changedStyle: h
            })
        },
        a = h => {
            c({
                editorStateBackup: h
            })
        },
        [l, c] = (0, ei.useReducer)(Hx, {
            setSelectedFont: o,
            setSelectedTextStyle: i,
            setSelectedTextStyleSection: n,
            setChangedStyle: s,
            setEditorStateBackup: a
        }),
        d = (0, ei.useRef)(null),
        p = (0, ei.useCallback)(h => {
            if (h.preventDefault(), !e.disabled) {
                if (d.current && d.current.currentScreen !== "Typography") {
                    if (e.selected) {
                        d.current.goBack();
                        return
                    }
                    c({ ...l,
                        selectedFont: void 0,
                        selectedTextStyle: void 0
                    }), d.current.goHome()
                }
                e.select()
            }
        }, [e.selected, e.disabled, d.current, l]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: h
        }) => r(ke, {
            ref: h,
            label: "Typography",
            onClick: p,
            children: r(_h, {
                color: "white"
            })
        }),
        panel: ({
            ref: h,
            style: u,
            update: m,
            getScrollablePanelProps: f
        }) => e.selected ? r(tn.Provider, {
            value: l,
            children: r(GG, {
                ref: h,
                navigatorRef: d,
                style: u,
                panelState: l,
                setPanelState: c,
                update: m,
                getScrollablePanelProps: f
            })
        }) : null
    })
}
var ei, GG, tn, Hx, r4, Tr = k(() => {
    "use strict";
    ei = E(N());
    ae();
    ht();
    qM();
    Ix();
    Qp();
    dR();
    n4();
    ni();
    zI();
    Ss();
    _s();
    Yt();
    qi();
    bI();
    qc();
    je();
    gn();
    ve();
    ut();
    jx();
    B();
    GG = (0, ei.forwardRef)(({
        navigatorRef: e,
        panelState: t,
        setPanelState: o,
        update: i,
        style: n,
        getScrollablePanelProps: s
    }, a) => {
        let [l, c] = (0, ei.useState)(""), d = ({
            next: F
        }) => {
            c(F)
        }, p = vb(), [h, u] = Ii(), {
            model: m
        } = (0, ei.useContext)(Y), [f, g] = m.useSharedState({
            group: !0,
            partial: !1
        }), y = (0, ei.useMemo)(() => f.map(F => Ko({
            editorState: F
        })), [f]), S = (0, ei.useMemo)(() => {
            let F = [...h.global, ...h.project];
            return y.map(R => F.find(A => A.name === R))
        }, [y, h]), w = (0, ei.useMemo)(() => {
            if (t.selectedTextStyle) return [t.selectedFont ? .css_name || t.selectedTextStyle.cssProperties.fontFamily || St.fontFamily];
            let F = m.block ? .propsModel ? .get("isEditMode"),
                R = f.flatMap((A, D) => {
                    let O = [],
                        L = Pi(A, "FONT_FAMILY", F);
                    if (!F && vf(A, "FONT_FAMILY")) return L;
                    L.length && O.push(...L);
                    let W = S[D];
                    return W && O.push(W.cssProperties.fontFamily || St.fontFamily), O
                });
            return F ? R[0] : R
        }, [S, f, t.selectedTextStyle, t.selectedFont]), [v, C] = (0, ei.useState)([]), {
            canControlBeClosed: I,
            onStackUpdated: T
        } = As(e.current);
        m.injectedRefs.canControlBeClosed = I;
        let P = async () => {
            let {
                textStyles: F
            } = await Nf();
            o({
                changedStyle: void 0,
                selectedTextStyle: void 0
            }), u({ ...F
            })
        };
        (0, ei.useEffect)(() => {
            (!m.visible || !m.selected) && t.changedStyle && P()
        }, [m.selected, m.visible, t.changedStyle]), (0, ei.useEffect)(() => {
            if (t.selectedFont) {
                let F = f.map(R => {
                    let A = R.getSelection().isCollapsed(),
                        D = R;
                    return A && (D = xr(D, m.block ? .propsModel ? .get("isEditMode"))), D = yi({
                        editorState: D,
                        key: "FONT_FAMILY",
                        value: t.selectedFont.css_name
                    }), A && (D = At(D, R.getSelection())), D
                });
                g(F)
            }
        }, [t.selectedFont ? .css_name]);
        async function M(F) {
            let R = F.variations.includes("n4") ? "n4" : F.variations[0],
                {
                    style: A,
                    weight: D
                } = tr(R);
            if (t.selectedTextStyle && t.selectedTextStyleSection) {
                let L = { ...t.selectedTextStyle,
                        cssProperties: { ...t.selectedTextStyle.cssProperties,
                            fontFamily: F.css_name,
                            fontWeight: D,
                            fontStyle: A
                        }
                    },
                    W = h[t.selectedTextStyleSection].map(z => z.name === L.name ? L : z);
                u({ ...h,
                    [t.selectedTextStyleSection]: W
                }), await p({
                    textStylesSection: t.selectedTextStyleSection,
                    newTextStyles: W,
                    triggerElement: "TextStyles"
                })
            }
            let O = f.map(L => {
                let W = L.getSelection().isCollapsed(),
                    z = L;
                return W && (z = xr(z, m.block ? .propsModel ? .get("isEditMode"))), z = ff(z, "FONT_VARIABLE"), z = yi({
                    key: "FONT_WEIGHT",
                    value: D,
                    editorState: z
                }), z = yi({
                    key: "FONT_STYLE",
                    value: A,
                    editorState: z
                }), W && (z = At(z, L.getSelection())), z
            });
            g(O)
        }
        return x(Pr, {
            ref: e,
            initialScreen: "Typography",
            onStackUpdated: F => {
                let R = v[v.length - 1],
                    A = F[F.length - 1];
                R === "StyleEdit" && A !== "FontsList" && t.changedStyle && (P(), t.editorStateBackup && (g(t.editorStateBackup), t.setEditorStateBackup && t.setEditorStateBackup(void 0))), C(F), T(F)
            },
            onNavigate: F => {
                d(F), i()
            },
            children: [r(lo, {
                screen: "Typography",
                children: r(JM, {
                    ref: a,
                    style: n,
                    getScrollablePanelProps: s
                })
            }), r(lo, {
                screen: "FontsList",
                children: r(sb, {
                    ref: a,
                    style: n,
                    navigatorRef: e,
                    currentFontFamily: w,
                    onFontSelect: M
                })
            }), r(lo, {
                screen: "FontUploader",
                children: r(Ta, {
                    ref: a,
                    style: n
                })
            }), r(lo, {
                screen: "Styles",
                children: r(cR, {
                    ref: a,
                    style: n,
                    onHeightChanged: i,
                    headerSlot: r(YG, {
                        navigatorRef: e,
                        currentScreen: l
                    })
                })
            }), r(lo, {
                screen: "StyleEdit",
                children: r(i4, {
                    ref: a,
                    style: n,
                    getScrollablePanelProps: s
                })
            })]
        })
    });
    tn = (0, ei.createContext)({}), Hx = (e, t) => ({ ...e,
        ...t || {}
    });
    r4 = ZG
});
var s4, a4 = k(() => {
    "use strict";
    ae();
    Tr();
    s4 = Ce.extend({
        name: "text_typography",
        component: r4,
        restrictions: function(e, t) {
            return t.some(i => i.model.get("type") === "text") ? t.length && t.every(i => i.model.get("type") === "text") : !0
        }
    })
});

function lu({
    icon: e,
    isHovered: t,
    isActive: o,
    ...i
}) {
    let n = e === "top" ? I0 : e === "bottom" ? B0 : e === "left" ? Jc : e === "center" ? fp : e === "right" ? bp : gp;
    return r(K, {
        border: "none",
        backgroundColor: "transparent",
        cursor: "pointer",
        ...i,
        css: Z `
        &:hover g,
        &:hover path {
          fill: ${ce.blue} !important;
        }
      `,
        children: r(n, {
            color: t || o ? "blue" : "darkGray"
        })
    })
}
var Ma, KG, c4, d4 = k(() => {
    "use strict";
    Ma = E(N());
    jv();
    Wv();
    Hv();
    Ov();
    Nj();
    Vj();
    ie();
    Be();
    je();
    yH();
    Jr();
    ir();
    nt();
    $e();
    ut();
    Dn();
    lh();
    ih();
    ae();
    Yt();
    mp();
    qi();
    ve();
    B();
    KG = (0, Ma.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o
        } = (0, Ma.useContext)(Y), [i] = Ii(), [n, s] = (0, Ma.useState)(null), [a, l] = o.useSharedState({
            group: !0,
            partial: !1
        }), c = M => {
            o.groupSetAndSave(M)
        }, d = (0, Ma.useMemo)(() => a.map(M => {
            let F = Ga({
                editorState: M
            });
            if (F) return F;
            let R = Ko({
                editorState: M
            });
            if (R) {
                let A = [...i.global, ...i.project].find(D => D.name === R);
                if (A && A.cssProperties.textAlign) return `align-${A.cssProperties.textAlign}`
            }
        }), [a, i]), p = o.isMixed(d), h = o.blocks.map(M => M.model.get("verticalAlign")), u = o.isMixed(h), m = M => {
            if (o.block ? .propsModel ? .get("isEditMode")) l([qd({
                editorState: a[0],
                align: M
            })]);
            else {
                let R = a.map(A => A.getCurrentContent().getBlocksAsArray().reduce((O, L) => {
                    let W = L.getType();
                    return up(W) && M === "align-justify" ? O : qd({
                        editorState: O,
                        block: L,
                        align: M
                    })
                }, A));
                l(R), o.groupSetAndSave(A => {
                    let D = A.nonReactGetSharedState();
                    return wr(D.getCurrentContent())
                })
            }
        }, f = o.blocks.map(M => M.model.get("textDirection") || "LTR"), g = o.isMixed(f), y = () => {
            let M = f[0] === "LTR" ? "RTL" : "LTR";
            g && (M = "LTR"), c({
                textDirection: M
            })
        }, S = o.blocks.some(M => M.model.get("columns") && M.model.get("columns").count > 1), w = o.blocks.map(M => typeof M.model.get("autosize") != "boolean" ? !0 : M.model.get("autosize")), v = o.isMixed(w), C = !v && w[0] && !S, I = o.blocks.some(M => !!M.model.get("parent_wid")), T = (0, Ma.useMemo)(() => tp(a[0]), [a[0]]), P = (0, Ma.useMemo)(() => up(T), [T]);
        return r(Me, {
            ref: t,
            style: e,
            isShowed: o.selected,
            children: r(Ot.Consumer, {
                children: () => x(Q, {
                    children: [r(H, {
                        leftSlot: "Align",
                        children: x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r(lu, {
                                "data-testid": "text-align-left",
                                icon: "left",
                                isHovered: n === "left",
                                isActive: p ? !1 : d[0] === "align-left" || !d[0],
                                onMouseEnter: () => s("left"),
                                onMouseLeave: () => s(null),
                                onClick: () => {
                                    m("align-left")
                                }
                            }), r(lu, {
                                "data-testid": "text-align-center",
                                icon: "center",
                                isHovered: n === "center",
                                isActive: p ? !1 : d[0] === "align-center",
                                onMouseEnter: () => s("center"),
                                onMouseLeave: () => s(null),
                                onClick: () => {
                                    m("align-center")
                                }
                            }), r(lu, {
                                "data-testid": "text-align-right",
                                icon: "right",
                                isHovered: n === "right",
                                isActive: p ? !1 : d[0] === "align-right",
                                onMouseEnter: () => s("right"),
                                onMouseLeave: () => s(null),
                                onClick: () => {
                                    m("align-right")
                                }
                            }), r(lu, {
                                "data-testid": "text-align-justify",
                                icon: "justify",
                                isHovered: n === "justify",
                                isActive: p ? !1 : d[0] === "align-justify",
                                onMouseEnter: () => s("justify"),
                                onMouseLeave: () => s(null),
                                disabled: P,
                                onClick: () => {
                                    m("align-justify")
                                }
                            })]
                        })
                    }), r(H, {
                        leftSlot: "Resizing",
                        children: x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Auto height",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "text-align-autoheight",
                                        hoverColor: "blue",
                                        height: 40,
                                        width: 40,
                                        disabled: S || I,
                                        color: C ? "blue" : "gray",
                                        onClick: () => {
                                            c({
                                                autosize: !0
                                            })
                                        },
                                        css: Z `
                        &:hover g {
                          fill: #fff;
                        }
                      `,
                                        children: r(Jc, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Fixed size",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "text-align-fixed-size",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        disabled: I,
                                        color: !C && !v ? "blue" : "gray",
                                        onClick: () => {
                                            c({
                                                autosize: !1
                                            })
                                        },
                                        css: Z `
                        &:hover g {
                          fill: #fff;
                        }
                      `,
                                        children: r(pI, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                height: 40,
                                children: !C && !v && x(b, {
                                    display: "flex",
                                    flexDirection: "column",
                                    height: "100%",
                                    justifyContent: "space-between",
                                    children: [r(lu, {
                                        "data-testid": "text-align-top",
                                        icon: "top",
                                        isHovered: n === "top",
                                        isActive: u ? !1 : !h[0] || h[0] === "top",
                                        onMouseEnter: () => s("top"),
                                        onMouseLeave: () => s(null),
                                        onClick: () => {
                                            c({
                                                verticalAlign: "top"
                                            })
                                        }
                                    }), r(lu, {
                                        "data-testid": "text-align-bottom",
                                        icon: "bottom",
                                        isHovered: n === "bottom",
                                        isActive: u ? !1 : h[0] === "bottom",
                                        onMouseEnter: () => s("bottom"),
                                        onMouseLeave: () => s(null),
                                        onClick: () => {
                                            c({
                                                verticalAlign: "bottom"
                                            })
                                        }
                                    })]
                                })
                            })]
                        })
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: "Writing",
                        rightSlot: r(K, {
                            onClick: y,
                            "data-testid": "text-align-toggle-direction",
                            children: r($, {
                                color: "blue",
                                textStyle: "small",
                                children: g ? "Mixed" : f[0]
                            })
                        })
                    })]
                })
            })
        })
    }), c4 = KG
});

function qG() {
    let {
        model: e
    } = (0, ia.useContext)(Y);
    return r(Ie, {
        control: ({
            ref: t
        }) => r(JG, {
            ref: t
        }),
        panel: ({
            ref: t,
            style: o
        }) => e.selected ? r(c4, {
            ref: t,
            style: o
        }) : null
    })
}
var ia, JG, p4, u4 = k(() => {
    "use strict";
    ia = E(N());
    ae();
    ht();
    lh();
    ih();
    d4();
    Le();
    qi();
    Yt();
    Wv();
    Hv();
    Ov();
    jv();
    B();
    JG = (0, ia.forwardRef)((e, t) => {
        let {
            model: o
        } = (0, ia.useContext)(Y), [i] = Ii(), {
            model: n
        } = (0, ia.useContext)(ge), [s] = o.useSharedState({
            partial: !1
        }), a = (0, ia.useMemo)(() => {
            let u = Ga({
                editorState: s
            });
            if (u) return u;
            let m = Ko({
                editorState: s
            });
            if (m) {
                let f = [...i.global, ...i.project].find(g => g.name === m);
                if (f && f.cssProperties.textAlign) return `align-${f.cssProperties.textAlign}`
            }
        }, [s, i]), l = (0, ia.useMemo)(() => {
            switch (a) {
                case "align-center":
                    return fp;
                case "align-right":
                    return bp;
                case "align-justify":
                    return gp;
                default:
                    return Jc
            }
        }, [a]), c = n.columns && n.columns.count > 1, p = (typeof n.autosize != "boolean" ? !0 : n.autosize) && !c, h = (0, ia.useCallback)(u => {
            u.preventDefault(), !o.disabled && o.select()
        }, [o.disabled]);
        return r(ke, {
            ref: t,
            figure: p ? "circle" : "square",
            label: "Align",
            onClick: h,
            children: r(l, {
                color: "white"
            })
        })
    });
    p4 = qG
});
var h4, m4 = k(() => {
    "use strict";
    ae();
    u4();
    h4 = Ce.extend({
        name: "text_align",
        component: p4,
        rolePermission: "TextCanChangeAlign",
        restrictions: function(e, t) {
            return t.length && t.every(o => o.model.get("type") === "text")
        }
    })
});
var f4, g4 = k(() => {
    "use strict";
    no();
    f4 = {
        "template-constructor-control-anchor_picker": Ae `
	<div class="anchor-picker-wrapper" aria-label="Anchor picker">
		<div class="anchor-picker">
			<div class="popup">
				<span>Click</span>
				<div class="corner-wrapper"><div class="corner"></div></div>
			</div>
		</div>
	</div>
`
    }
});
var cu, b4, Nx, QG, y4, v4 = k(() => {
    "use strict";
    cu = E(Ze()), b4 = E(To()), Nx = E(ze());
    g4();
    QG = b4.default.View.extend({
        template: f4["template-constructor-control-anchor_picker"],
        initialize: function(e) {
            Nx.default.bindAll(this), Nx.default.extend(this, e)
        },
        render: function() {
            return this.setElement((0, cu.default)(this.template())), this.$picker = this.$el.find(".anchor-picker"), this.$popup = this.$el.find(".popup"), this.workspace = RM.constructorRouter.workspace, this.listenTo(this.workspace, "workspace-resize", this.setOverlayPosition), this.setOverlayPosition(), this
        },
        show: function() {
            this.render(), this.$el.insertAfter(this.$after), (0, cu.default)(window).on("resize", this.onWindowResize)
        },
        hide: function() {
            this.stopFollowing(), (0, cu.default)(window).off("resize", this.onWindowResize), this.remove()
        },
        startFollowing: function() {
            (0, cu.default)(window).on("mousemove", this.onMouseMove), this.$el.on("click", this.onMouseClick), this.$el.addClass("target-mode"), this.containerInitialScroll = this.$container.scrollTop()
        },
        stopFollowing: function() {
            (0, cu.default)(window).off("mousemove", this.onMouseMove), this.$el.off("click", this.onMouseClick), this.$el.removeClass("target-mode"), this.containerInitialScroll !== void 0 && this.$container.animate({
                scrollTop: this.containerInitialScroll
            }, 500)
        },
        onMouseMove: function(e) {
            this.updateY(e.pageY + this.$container.scrollTop() - this.top), this.$popup.css("left", e.pageX)
        },
        onMouseClick: function(e) {
            this.stopFollowing(), this.trigger("target-select", {
                y: Math.round(e.offsetY / RM.constructorRouter.zoom.getZoom())
            })
        },
        updateY: function(e) {
            this.$picker.css("top", e)
        },
        onWindowResize: function() {
            this.setOverlayPosition()
        },
        setOverlayPosition: function() {
            let e = this.$after.height(),
                t = parseInt(this.$after.css("top"), 10),
                o = parseInt(this.$after.css("border-top-width"), 10);
            this.top = t + o, this.$el.height(e * RM.constructorRouter.zoom.getZoom()), this.$el.css("top", this.top)
        }
    }), y4 = QG
});

function eY({
    value: e,
    onChange: t,
    isActive: o,
    isVisible: i,
    container: n,
    considerScroll: s,
    workspaceHeight: a = 0
}) {
    let l = (0, Un.useMemo)(() => `anchor-portal-${zn()}`, []),
        [c, d] = (0, Un.useState)(null),
        [p, h] = (0, Un.useState)(e),
        [u, m] = (0, Un.useState)(0),
        [f, g] = (0, Un.useState)({
            x: 0,
            y: 0
        });
    (0, Un.useEffect)(() => {
        m(window.innerWidth / 2)
    }, []);
    let y = () => {
            let T = document.createElement("div");
            return T.id = l, T.style.position = "absolute", T.style.top = "0", T.style.left = "0", T.style.width = "100%", T.style.zIndex = "999999", document.body.appendChild(T), T
        },
        S = () => {
            let T = document.querySelector(`#${l}`);
            T && T.parentElement && T.parentElement.removeChild(T)
        };
    (0, Un.useEffect)(() => {
        let T = n || document.querySelector(`#${l}`);
        return d(T || y()), () => {
            S()
        }
    }, []), (0, Un.useEffect)(() => {
        n && (S(), d(n))
    }, [n]), (0, Un.useEffect)(() => {
        if (c) {
            let {
                x: T,
                y: P
            } = c.getBoundingClientRect();
            g({
                x: T,
                y: P
            })
        }
    }, [n, c]);
    let w = T => {
            h(Math.max(0, T.pageY - f.y + (s && c ? c.scrollTop : 0))), m(Math.max(0, T.pageX - f.x))
        },
        v = T => {
            let P = Math.max(0, T.pageY - f.y + (s && c ? c.scrollTop : 0));
            h(P), t(P)
        };
    (0, Un.useEffect)(() => (o ? (document.body.style.cursor = "crosshair", window.addEventListener("mousemove", w), window.addEventListener("click", v)) : (document.body.style.cursor = "", window.removeEventListener("mousemove", w), window.removeEventListener("click", v)), () => {
        document.body.style.cursor = "", window.removeEventListener("mousemove", w), window.removeEventListener("click", v)
    }), [o]), (0, Un.useEffect)(() => {
        e !== p && h(e)
    }, [e]);
    let C = (0, Un.useRef)(null),
        I = r(b, {
            position: "absolute",
            style: {
                top: `${p}px`
            },
            width: "100%",
            height: "1px",
            backgroundColor: "blue",
            children: r(b, {
                position: "absolute",
                bottom: "0",
                marginBottom: 12,
                style: {
                    left: `${u}px`
                },
                transform: "translateX(-50%)",
                children: r(wt.div, {
                    initial: {
                        opacity: 0
                    },
                    animate: {
                        opacity: o ? 1 : 0
                    },
                    children: x(xp, {
                        children: ["click", r(_p, {
                            top: "100%",
                            ref: C
                        })]
                    })
                })
            })
        });
    return r(Q, {
        children: i && c ? (0, w4.createPortal)(o && a ? r(b, {
            position: "absolute",
            top: 0,
            left: 0,
            right: 0,
            height: a,
            style: {
                cursor: "crosshair",
                zIndex: 1e4
            },
            children: I
        }) : I, c) : null
    })
}
var Un, w4, x4, _4 = k(() => {
    "use strict";
    Un = E(N()), w4 = E(gi());
    Li();
    Ol();
    ie();
    ir();
    B();
    x4 = eY
});

function tY({
    title: e
}) {
    return r(b, {
        paddingLeft: 16,
        paddingRight: 16,
        height: 40,
        display: "flex",
        alignItems: "center",
        children: r($, {
            textStyle: "regular",
            children: e
        })
    })
}
var co, Vn = k(() => {
    "use strict";
    ie();
    Be();
    B();
    co = tY
});

function S4(e) {
    return Object.keys(e).filter(t => typeof t != "number" || !Number.isInteger(t)).map(t => e[t])
}
var C4 = k(() => {
    "use strict"
});

function oY({
    checked: e,
    onChange: t,
    defaultChecked: o,
    disabled: i,
    name: n,
    id: s,
    height: a = 24,
    background: l,
    backgroundChecked: c,
    togglerBackground: d,
    multipleValues: p,
    ...h
}) {
    let [u, m] = (0, k4.useState)(e || o || !1), f = typeof e == "boolean", g = f ? e : u, y = a * 2 - 8, S = g || p ? c || "tomato" : l || "gray";
    return x(b, {
        as: "label",
        width: y,
        display: "block",
        role: "checkbox",
        "aria-checked": g,
        "data-testid": "switch-checkbox",
        children: [r(Vr, {
            as: "input",
            type: "checkbox",
            checked: g,
            onChange: w => {
                let v = w.currentTarget.checked;
                f || m(v), t && t(v)
            },
            defaultChecked: o,
            disabled: i,
            id: s,
            name: n
        }), r(b, {
            height: a,
            border: "1px solid",
            borderColor: S,
            backgroundColor: S,
            borderRadius: "100px",
            alignItems: "center",
            position: "relative",
            cursor: i ? "default" : "pointer",
            opacity: p || i ? .4 : 1,
            transition: "background-color 100ms ease-in-out, opacity 100ms ease-in-out",
            css: Z `
          &:hover {
            opacity: 1;
          }
        `,
            ...h,
            children: r(b, {
                width: y - 8,
                position: "relative",
                transition: "all 100ms ease-in-out",
                transform: `translateX(${p?"25%":g?"50%":"0%"})`,
                children: r(b, {
                    borderRadius: "50%",
                    width: a - 2,
                    height: a - 2,
                    backgroundColor: d || "white"
                })
            })
        })]
    })
}
var k4, Ve, Ux = k(() => {
    "use strict";
    k4 = E(N());
    Ch();
    ie();
    ve();
    B();
    Ve = oY
});
var Hi = k(() => {
    "use strict";
    Ux();
    Ux()
});
var gt, P4, I4, iY, cr, wb = k(() => {
    "use strict";
    gt = E(N());
    ie();
    P4 = E(hn());
    je();
    Ur();
    Ts();
    en();
    ru();
    or();
    Lf();
    Cr();
    $e();
    Jr();
    Rf();
    _4();
    Ol();
    nt();
    yd();
    ts();
    Px();
    Vn();
    Tx();
    sd();
    uh();
    C4();
    AI();
    Dn();
    qi();
    db();
    Be();
    Hi();
    Uc();
    ut();
    Ps();
    ve();
    vr();
    pi();
    Fs();
    B();
    I4 = {
        URL: "Website URL",
        ScrollToTop: "Scroll to top",
        GoBack: "Go back",
        Anchor: "Anchor",
        Email: "Email",
        Page: "Type page number",
        Phone: "Phone number"
    }, iY = (0, gt.forwardRef)(({
        style: e,
        onHeightChanged: t,
        projectId: o,
        userId: i,
        onAddStyle: n,
        currentLinkData: s,
        onStartEditStyle: a,
        onResizeComplete: l,
        panelMinHeight: c = 280,
        height: d = 280,
        currentTab: p,
        setCurrentTab: h,
        onRemoveUrl: u,
        onChange: m,
        onDeleteStyle: f,
        canShowAnchorSelector: g,
        onAnchorToggle: y,
        onToggleDropdown: S,
        onToggleSelectPanel: w,
        resizeable: v,
        showStyles: C,
        showCloseTipSettings: I,
        selectedLinkNames: T
    }, P) => {
        let {
            mag: M,
            getCurrentPageNum: F,
            getCurrentPageId: R,
            zoom: A,
            workspace: D
        } = window.RM.constructorRouter, O = (0, gt.useMemo)(() => F(), []), L = (0, gt.useMemo)(() => R(), []), [W, z] = (0, gt.useState)(!1), [V, X] = (0, gt.useState)(""), [q, ne] = (0, gt.useState)(0), [re, te] = (0, gt.useState)(!1), [ee, j] = (0, gt.useState)(!1), [se, oe] = (0, gt.useState)(I), [U, he] = (0, gt.useState)(!1), [xe, pe] = (0, gt.useState)(!1), [J, le] = (0, gt.useState)(0), [ye, Ue] = (0, gt.useState)(null), [Te, Re] = (0, gt.useState)(null), Tt = Fn(.76, ce.gray), Ee = Qi("TextCanEditLinkStyles"), [Qe, _t] = (0, gt.useState)(""), [Ge, br] = (0, gt.useState)(null), [Ua, Xi] = (0, gt.useState)(0);
        (0, gt.useEffect)(() => {
            _t(V), br(ye), Xi(J)
        }, [V, ye, J]);
        let Nd = (0, gt.useMemo)(() => D.position.top, []),
            ga = (0, gt.useMemo)(() => D.getViewportPosition().pageHeight, []),
            Ud = He => {
                if (Ge === "Anchor" && (He.keyCode === 38 || He.keyCode === 40)) {
                    let Ye = He.keyCode === 38,
                        Ke = Math.max(0, Ua + 1 * (He.shiftKey ? 10 : 1) * (Ye ? 1 : -1));
                    Xi(Ke), _t(`${Ke}px`)
                }
            };
        (0, gt.useEffect)(() => {
            if (P4.default.isEqual(s, Te) || Re(s), s) {
                if (s.type === "Page" && s.pageId) {
                    let He = M.getPageDataUri(s.pageId),
                        Ye = M.getPageNum(s.pageId);
                    if (!He && !Ye) {
                        pe(!0), te(!0), Ue(s.type), mi(s.linkStyle || Dl.name);
                        return
                    } else pe(!1);
                    X(He || (Ye ? `${Ye}` : s.url))
                } else X(s.url);
                Ue(s.type), j(s.target === "_blank"), oe(typeof s.closeTip == "boolean" ? s.closeTip : I), mi(s.linkStyle || Dl.name), typeof s.anchorPosition == "number" && le(s.anchorPosition), s.pageNum && s.type === "Page" && ne(s.pageNum), te(s.url ? !!(s.url && s.type) : gs.includes(s.type))
            } else s || (X(""), mi(null), Ue(null), te(!1), ne(0), j(!1), oe(I), pe(!1))
        }, [s]);
        let Tl = S4(ph).map(He => ({
                label: I4[He],
                value: He
            })),
            Bl = (0, gt.useMemo)(() => xe ? "Page doesn't exist" : Ge !== null ? I4[Ge] : "URL, page number...", [Ge, xe]),
            gs = ["GoBack", "ScrollToTop"],
            Jn = (0, gt.useMemo)(() => Ge !== null && (Qe.length ? kv(Qe, M) === Ge : gs.includes(Ge)), [Qe, Ge, M]),
            ba = !!(Te ? .url && V !== Qe),
            $c = !!(Te ? .type && ye !== Ge),
            ot = !!(re && Ge && !ba && !$c);
        (0, gt.useEffect)(() => {
            if (re && Jn && ye) {
                let He = ye === "Anchor" ? O : ye === "Page" ? q : void 0,
                    Ye = ye === "Page" ? "" : void 0,
                    Ke;
                if (ye === "Page" && V && Cv.Page(V, M) && (Ke = M.getPageId(V) || void 0, Ke)) {
                    Ye = M.getPageDataUri(Ke);
                    let vs = M.getPageNum(Ke);
                    if (Ye && Ye !== V) return;
                    vs && q !== vs && (ne(vs), He = vs)
                }
                let It = {
                    url: V,
                    anchorPosition: J,
                    pageNum: He,
                    pageUri: Ye || void 0,
                    type: ye,
                    target: ee ? "_blank" : "_self",
                    linkStyle: cn || void 0,
                    pageId: ye === "Anchor" ? L : Ke
                };
                I && (It.closeTip = se), Te && Te.anchorPosition === It.anchorPosition && Te.url === It.url && Te.target === It.target && Te.linkStyle === It.linkStyle && Te.type === It.type && Te.pageNum === It.pageNum && Te.pageUri === It.pageUri && Te.pageId === It.pageId && Te.closeTip === It.closeTip || m(It)
            }
        }, [Jn, re, V, ye, J, ee, se, I, M]);

        function Ct() {
            z(!1), !Qe && re && !Ge ? (Ys(), t && t()) : !Qe && re && Ge && !gs.includes(Ge) && te(!1);
            let He = ye === "Page" && V && Cv.Page(V, M);
            if (re && Jn && He) {
                let Ye = M.getPageId(V);
                if (Ye) {
                    let Ke = M.getPageDataUri(Ye);
                    Ke && Ke !== V && X(Ke)
                }
            }
        }
        let Fi = document.querySelector("#main"),
            [ci, Po] = (0, gt.useState)(null),
            [cn, mi] = (0, gt.useState)(null),
            [vt, dn] = Kd(),
            [Co, Di] = (0, gt.useState)("all"),
            [pn, Dt] = (0, gt.useState)(null),
            we = (0, gt.useMemo)(() => p === 0 ? Co === "all" ? vt.project : vt.project.filter(He => Co === "used" ? !!pn ? .has(He.name) : !pn ? .has(He.name)) : vt.global, [vt, p, Co, pn]),
            mt = He => {
                if (ye) {
                    let Ye = {
                        url: V,
                        anchorPosition: J,
                        pageNum: ye === "Anchor" ? O : ye === "Page" ? q : void 0,
                        type: ye,
                        target: ee ? "_blank" : "_self",
                        pageId: Te && Te.pageId ? Te.pageId : void 0,
                        linkStyle: He.name
                    };
                    I && (Ye.closeTip = se), m(Ye)
                }
            },
            $o = async He => {
                let Ye = [...we],
                    Ke = Ye.findIndex(It => It.name === He.name);
                Ke > -1 && Ye.splice(Ke, 0, { ...He,
                    name: `link-style-${zn()}`,
                    label: `${He.label} (Copy)`
                }), await dn({ ...vt,
                    [p === 1 ? "global" : "project"]: Ye
                }), p === 1 ? await rd({
                    userId: i,
                    styles: Ye
                }) : await Vl({
                    projectId: o,
                    styles: Ye
                }), window.RM.constructorRouter.trigger("update_from_server", "LinkStyles", {
                    [p === 1 ? "global" : "project"]: Ye
                })
            },
            qn = async (He, Ye) => {
                let Ke = [],
                    It = [];
                if (Ye === 1) {
                    Ke = [...vt.project];
                    let ki = Ke.findIndex(vs => vs.name === He.name);
                    ki > -1 && Ke.splice(ki, 1), It = [...vt.global, He]
                } else {
                    It = [...vt.global];
                    let ki = It.findIndex(vs => vs.name === He.name);
                    ki > -1 && It.splice(ki, 1), Ke = [...vt.project, He]
                }
                await dn({
                    global: It,
                    project: Ke
                }), await Vl({
                    projectId: o,
                    styles: Ke
                }), await rd({
                    userId: i,
                    styles: It
                }), window.RM.constructorRouter.trigger("update_from_server", "LinkStyles", {
                    global: It,
                    project: Ke
                })
            },
            eh = async He => {
                f && f(He);
                let Ye = [...we],
                    Ke = Ye.findIndex(It => It.name === He.name);
                Ke > -1 && Ye.splice(Ke, 1), await dn({ ...vt,
                    [p === 1 ? "global" : "project"]: Ye
                }), p === 1 ? await rd({
                    userId: i,
                    styles: Ye
                }) : await Vl({
                    projectId: o,
                    styles: Ye
                }), window.RM.constructorRouter.trigger("update_from_server", "LinkStyles", {
                    1: Ye
                })
            },
            Mn = async (He, Ye) => {
                if (He === -1) return;
                let Ke = [...we],
                    It = Ke[He];
                Ke.splice(He, 1), Ke.splice(Ye, 0, It), await dn({ ...vt,
                    [p === 1 ? "global" : "project"]: Ke
                }), p === 1 ? await rd({
                    userId: i,
                    styles: Ke
                }) : await Vl({
                    projectId: o,
                    styles: Ke
                }), window.RM.constructorRouter.trigger("update_from_server", "LinkStyles", {
                    1: Ke
                })
            },
            Ys = () => {
                le(0), te(!1), X(""), Ue(null), pe(!1), u()
            },
            bs = (0, gt.useRef)(null);
        (0, gt.useEffect)(() => {
            let He = s ? .type;
            !xe && bs && bs.current && He !== "ScrollToTop" && He !== "GoBack" && bs.current.focus()
        }, []);
        let Ki = (0, gt.useRef)(null);
        (0, gt.useEffect)(() => {
            Ki.current && Ki.current.scrollIntoView()
        }, [Ki.current]), Gl(() => {
            Jn && (te(!0), X(Qe), Ue(Ge), le(Ua))
        }, [Qe, Ge, Ua, Jn]);
        let Rn = () => {
                pe(!1)
            },
            ya = (0, gt.useMemo)(() => we.map(He => ({
                id: He.name
            })), [we]),
            [Ci, Ji] = (0, gt.useState)(!1),
            [Wc, ys] = (0, gt.useState)(!1),
            Vm = He => {
                ys(He), S && S(He)
            },
            [Gm, MC] = (0, gt.useState)(!1),
            RC = async () => M.getUsedStyles("link"),
            cv = async He => {
                if (He !== Co)
                    if (He !== "all") {
                        let Ye = await RC();
                        Ye && (Dt(Ye), Di(He))
                    } else Di(He)
            },
            tj = async () => {
                if (p === 1) return;
                Co !== "all" && Di("all");
                let He = await RC(),
                    Ye = [...vt.project].filter(It => !He ? .has(It.name)),
                    Ke = [...vt.project].filter(It => !!He ? .has(It.name));
                Ye.length !== 0 && (await dn({ ...vt,
                    project: Ke
                }), await Vl({
                    projectId: o,
                    styles: Ke
                }), window.RM.constructorRouter.trigger("update_from_server", "LinkStyles", {
                    1: Ke
                }))
            },
            oj = [{
                title: "Show all",
                onClick: () => {
                    cv("all")
                },
                active: Co === "all"
            }, {
                title: "Show only used",
                onClick: () => {
                    cv("used")
                },
                active: Co === "used"
            }, {
                title: "Show only unused",
                onClick: () => {
                    cv("unused")
                },
                active: Co === "unused"
            }, {
                title: Gm ? x(b, {
                    height: "24px",
                    display: "flex",
                    justifyContent: "space-between",
                    alignItems: "center",
                    children: [r(b, {
                        onClick: () => tj(),
                        "arial-label": "Delete all unused styles",
                        children: r($, {
                            textStyle: "small",
                            color: "tomato",
                            css: Z `
                  &:hover {
                    color: ${ce.black};
                  }
                `,
                            children: "Delete"
                        })
                    }), r(b, {
                        onClick: He => {
                            He.stopPropagation(), MC(!1)
                        },
                        "arial-label": "Cancel delete unused styles",
                        children: r($, {
                            textStyle: "small",
                            color: "darkGray",
                            css: Z `
                  &:hover {
                    color: ${ce.black};
                  }
                `,
                            children: "Cancel"
                        })
                    })]
                }) : "Delete all unused",
                onClick: He => {
                    !Gm && He.stopPropagation(), !Gm && MC(!0)
                },
                hoverVariant: ui.danger,
                activeVariant: ui.danger,
                active: Gm
            }],
            dv = (T ? .length ? ? 0) > 1,
            ij = (0, gt.useMemo)(() => !W && dv ? "mixed" : xe ? "Page doesn't exist" : Qe, [xe, Qe, dv, W]),
            nj = He => {
                let Ye = He.target.value;
                _t(Ye);
                let Ke = kv(Ye, M);
                br(Ke), Ke === "Anchor" && Xi(parseInt(Ye))
            };
        return x(Q, {
            children: [Ge === "Anchor" && g && r(x4, {
                container: Fi,
                isVisible: Ge === "Anchor",
                isActive: U,
                value: Nd + Ua * A.getZoom(),
                considerScroll: !0,
                workspaceHeight: ga,
                onChange: He => {
                    let Ye = He - Nd,
                        Ke = Math.round(Ye / A.getZoom());
                    le(Ke), X(`${Ke}px`), Ue(Ge), he(!1), te(!0), y && (y(!1), st(["ButtonWidgetAnchorLinkPosition"]))
                }
            }), r(Me, {
                ref: P,
                style: e,
                isShowed: !0,
                resizable: v && re,
                onResizeComplete: l,
                minHeight: c,
                height: v && re ? d : 90,
                children: r(Ot.Consumer, {
                    children: ({
                        dropdownContainer: He
                    }) => r(Q, {
                        children: x(b, {
                            display: "flex",
                            height: "100%",
                            width: "100%",
                            flexDirection: "column",
                            children: [r(co, {
                                title: "Link"
                            }), r(b, {
                                marginBottom: re && Ge && !gs.includes(Ge) && Ge !== "Anchor" && Ge !== "Email" ? "0" : 12,
                                paddingLeft: "2rm",
                                paddingRight: "2rm",
                                position: "relative",
                                children: r(es, {
                                    container: He,
                                    items: Tl,
                                    value: Ge !== null ? Ge : void 0,
                                    onToggle: w,
                                    onSelect: Ye => {
                                        j(!1);
                                        let Ke = Ye.value;
                                        br(Ke), st(["ButtonWidgetAddLinkType"]), gs.includes(Ke) && (Ue(Ke), te(!0));
                                        let It = Ke === "Anchor";
                                        setTimeout(() => {
                                            he(It), y && y(It)
                                        }, 0)
                                    },
                                    children: ({
                                        toggleDropdown: Ye,
                                        ref: Ke
                                    }) => r("form", {
                                        onSubmit: It => {
                                            It.preventDefault(), !re && Jn && !ot && te(!0)
                                        },
                                        children: x(b, {
                                            ref: Ke,
                                            position: "relative",
                                            onClick: Rn,
                                            children: [Ge === "Anchor" && r(b, {
                                                marginLeft: 12,
                                                position: "absolute",
                                                top: "50%",
                                                left: 0,
                                                transform: "translateY(-50%)",
                                                children: r(K, {
                                                    "data-testid": "anchor-picker-button",
                                                    onClick: () => {
                                                        setTimeout(() => {
                                                            he(!0), y && y(!0)
                                                        }, 0)
                                                    },
                                                    display: "block",
                                                    children: r(Za, {
                                                        color: "gray"
                                                    })
                                                })
                                            }), r(ao, {
                                                targetSteps: "ButtonWidgetAddLinkType",
                                                indent: 8,
                                                delay: 1400,
                                                leaveDelay: 100,
                                                position: "left",
                                                instance: !0,
                                                closeOnTargetClick: !0,
                                                componentsProps: {
                                                    tooltip: {
                                                        right: "10px"
                                                    }
                                                },
                                                children: r(Mo, {
                                                    "data-testid": "text-link-input",
                                                    textStyle: "small",
                                                    ref: bs,
                                                    padding: `0 36px 0 ${Ge==="Anchor"?"36px":"8px"}`,
                                                    border: "none !important",
                                                    height: 40,
                                                    boxSizing: "border-box",
                                                    backgroundColor: "white",
                                                    borderRadius: "8px",
                                                    textOverflow: "ellipsis",
                                                    value: ij,
                                                    placeholder: Bl,
                                                    onKeyUp: Ud,
                                                    color: !W && dv ? "darkGray" : "black",
                                                    onChange: nj,
                                                    onFocus: () => z(!0),
                                                    onBlur: Ct
                                                })
                                            }), r(b, {
                                                position: "absolute",
                                                top: "50%",
                                                right: 0,
                                                transform: "translateY(-50%)",
                                                children: Jn ? ot && r(b, {
                                                    marginRight: 14,
                                                    children: r(K, {
                                                        type: "button",
                                                        onClick: Ys,
                                                        variant: "clean",
                                                        "data-testid": "text-link-set-delete",
                                                        children: r(Nt, {
                                                            color: "gray"
                                                        })
                                                    })
                                                }) : xe ? r(b, {
                                                    marginRight: 14,
                                                    children: r(K, {
                                                        type: "button",
                                                        onClick: Ys,
                                                        variant: "clean",
                                                        "data-testid": "text-link-set-delete",
                                                        children: r(Nt, {
                                                            color: "gray"
                                                        })
                                                    })
                                                }) : r(b, {
                                                    marginRight: 8,
                                                    children: r(K, {
                                                        type: "button",
                                                        onClick: Ye,
                                                        variant: "clean",
                                                        "data-testid": "text-link-set-dropdown",
                                                        verticalAlign: "middle",
                                                        children: r(Lt, {
                                                            color: "gray"
                                                        })
                                                    })
                                                })
                                            })]
                                        })
                                    })
                                })
                            }), re ? x(Q, {
                                children: [I && Ge ? r(H, {
                                    showBorder: !1,
                                    leftSlot: "Close on click",
                                    rightSlot: r(Ve, {
                                        checked: se,
                                        backgroundChecked: "black",
                                        onChange: () => oe(!se)
                                    })
                                }) : null, Ge && !gs.includes(Ge) && Ge !== "Anchor" && Ge !== "Email" ? r(H, {
                                    showBorder: C,
                                    leftSlot: "Open in tab",
                                    rightSlot: r(Ve, {
                                        checked: ee,
                                        backgroundChecked: "black",
                                        onChange: () => j(!ee)
                                    })
                                }) : null, C && x(b, {
                                    display: "flex",
                                    flexDirection: "column",
                                    flex: "1 1",
                                    children: [!!h && r(os, {
                                        items: [{
                                            title: "Project"
                                        }, {
                                            title: "Global"
                                        }],
                                        activeIndex: p || 0,
                                        onChange: h
                                    }), r(b, {
                                        flex: "1 1",
                                        position: "relative",
                                        children: r(b, {
                                            position: "absolute",
                                            top: "0",
                                            left: "0",
                                            right: "0",
                                            bottom: "0",
                                            children: r(ou, {
                                                isDragOff: Wc,
                                                idList: ya,
                                                onDragStart: () => {
                                                    Ji(!0)
                                                },
                                                onDragEnd: (Ye, Ke, It) => {
                                                    Mn(ya.findIndex(ki => ki.id === Ye), It), Ji(!1)
                                                },
                                                children: () => r(xo, {
                                                    children: ({
                                                        ref: Ye
                                                    }) => r(iu, {
                                                        dropableId: "0",
                                                        children: ({
                                                            dropElementRef: Ke,
                                                            dropableId: It
                                                        }) => r(b, {
                                                            ref: Ye,
                                                            children: r(Ti, {
                                                                permission: "TextCanSelectLinkStyles",
                                                                children: r(b, {
                                                                    ref: Ke,
                                                                    children: (we || []).map((ki, vs) => {
                                                                        let pv = (T || [cn || Dl.name]).includes(ki.name);
                                                                        return r(nu, {
                                                                            draggableId: ki.name,
                                                                            dropableId: It,
                                                                            children: ({
                                                                                ref: rj
                                                                            }) => r(b, {
                                                                                ref: rj,
                                                                                children: r(Ho, {
                                                                                    container: He,
                                                                                    onToggleDropdown: Vm,
                                                                                    listItems: Ee ? [{
                                                                                        title: "Edit",
                                                                                        onClick: () => {
                                                                                            !Ci && a && a(ki)
                                                                                        }
                                                                                    }, {
                                                                                        title: "Duplicate",
                                                                                        onClick: () => {
                                                                                            Ci || $o(ki)
                                                                                        }
                                                                                    }, {
                                                                                        title: `Move to ${p===1?"Project":"Global"}`,
                                                                                        onClick: () => {
                                                                                            Ci || qn(ki, p === 1 ? 0 : 1)
                                                                                        }
                                                                                    }, {
                                                                                        title: "Delete",
                                                                                        onClick: () => {
                                                                                            Ci || eh(ki)
                                                                                        },
                                                                                        hoverVariant: ui.danger
                                                                                    }] : [],
                                                                                    children: ({
                                                                                        toggleDropdown: sj
                                                                                    }) => x(b, {
                                                                                        position: "relative",
                                                                                        onMouseEnter: () => Po(vs),
                                                                                        onMouseLeave: () => Po(null),
                                                                                        cursor: "pointer",
                                                                                        userSelect: "none",
                                                                                        ref: pv ? Ki : void 0,
                                                                                        children: [r(b, {
                                                                                            backgroundColor: pv ? "blue" : "gray",
                                                                                            opacity: ci === vs || pv ? .2 : 0,
                                                                                            position: "absolute",
                                                                                            top: 0,
                                                                                            left: 0,
                                                                                            width: "100%",
                                                                                            height: "100%",
                                                                                            zIndex: 0
                                                                                        }), x(b, {
                                                                                            display: "flex",
                                                                                            paddingLeft: 16,
                                                                                            paddingRight: 16,
                                                                                            paddingTop: "8px",
                                                                                            paddingBottom: "8px",
                                                                                            justifyContent: "space-between",
                                                                                            alignItems: "center",
                                                                                            position: "relative",
                                                                                            children: [r(b, {
                                                                                                display: "flex",
                                                                                                width: "100%",
                                                                                                maxWidth: 108,
                                                                                                overflow: "hidden",
                                                                                                ...cb({
                                                                                                    onClick: () => mt(ki),
                                                                                                    onDoubleClick: () => {
                                                                                                        !Ci && a && a(ki)
                                                                                                    }
                                                                                                }),
                                                                                                whiteSpace: "nowrap",
                                                                                                children: r($, {
                                                                                                    textStyle: "small",
                                                                                                    className: ki.name,
                                                                                                    pointerEvents: "none",
                                                                                                    children: ki.label
                                                                                                })
                                                                                            }), Ee && ci === vs ? r(K, {
                                                                                                height: 16,
                                                                                                onClick: sj,
                                                                                                variant: "clean",
                                                                                                children: r(Xa, {
                                                                                                    color: "black"
                                                                                                })
                                                                                            }) : void 0]
                                                                                        })]
                                                                                    })
                                                                                })
                                                                            })
                                                                        }, ki.name)
                                                                    })
                                                                })
                                                            })
                                                        })
                                                    })
                                                })
                                            })
                                        })
                                    }), Ee ? x(Q, {
                                        children: [r(b, {
                                            paddingLeft: "4rm",
                                            paddingRight: "4rm",
                                            children: r(b, {
                                                borderBottom: "2px solid",
                                                borderColor: Tt
                                            })
                                        }), p === 0 ? r(Ho, {
                                            cursor: "auto",
                                            popperOffset: [0, -8],
                                            listItems: oj,
                                            children: ({
                                                toggleDropdown: Ye
                                            }) => r(eu, {
                                                showBorder: !1,
                                                icon: r(K, {
                                                    "data-testid": "text-link-style-plus",
                                                    onClick: n,
                                                    variant: "clean",
                                                    height: 18,
                                                    verticalAlign: "middle",
                                                    children: r(Qt, {
                                                        color: "black"
                                                    })
                                                }),
                                                rightIcon: r(dt, {
                                                    height: 32,
                                                    width: 32,
                                                    color: "transparent",
                                                    hoverColor: "transparent",
                                                    activeColor: "transparent",
                                                    unstyledHover: !0,
                                                    unstyledActive: !0,
                                                    onClick: Ye,
                                                    css: Z `
                                            &:hover svg {
                                              color: ${ce.black};
                                            }
                                          `,
                                                    children: r(Xa, {
                                                        color: Co !== "all" ? "blue" : "darkGray"
                                                    })
                                                })
                                            })
                                        }) : r(eu, {
                                            showBorder: !1,
                                            icon: r(K, {
                                                "data-testid": "text-link-style-plus",
                                                onClick: n,
                                                variant: "clean",
                                                height: 18,
                                                verticalAlign: "middle",
                                                children: r(Qt, {
                                                    color: "black"
                                                })
                                            })
                                        })]
                                    }) : null]
                                })]
                            }) : null]
                        })
                    })
                })
            })]
        })
    }), cr = iY
});
var il = k(() => {
    "use strict";
    wb();
    wb()
});
var Gn, T4, Vx, nY, B4, M4 = k(() => {
    "use strict";
    Gn = E(N()), T4 = E(hn());
    xb();
    ni();
    ae();
    uh();
    cf();
    Mt();
    qi();
    il();
    vr();
    B();
    Vx = 280, nY = (0, Gn.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            navigate: i
        } = (0, Gn.useContext)(Jt), {
            setSelectedStyle: n,
            currentTab: s,
            setCurrentTab: a
        } = (0, Gn.useContext)(im), {
            model: l,
            modelSet: c
        } = (0, Gn.useContext)(Y), d = (0, Gn.useMemo)(() => l.project.get("_id"), [l]), p = (0, Gn.useMemo)(() => l.user.get("_id"), [l]), [h] = Kd(), [u, m] = l.useSharedState({
            partial: !1
        }), f = (0, Gn.useMemo)(() => Ek(u), [u]), g = (0, Gn.useMemo)(() => T4.default.debounce(l.project.edit_params.save, 500), []), [y, S] = (0, Gn.useState)(de.textWidget.textLinkPanelDefaultHeight);
        (0, Gn.useEffect)(() => {
            let R = l.project.edit_params.get("controls");
            R && R.LinkStyleList && S(Math.max(R.LinkStyleList, Vx))
        }, []);
        let w = R => {
            S(Math.max(R, Vx));
            let A = l.project.edit_params.get("controls");
            l.project.edit_params.set("controls", { ...A,
                LinkStyleList: R
            }), l.project.edit_params.save()
        };
        (0, Gn.useEffect)(() => () => {
            c({
                preventClose: !1
            })
        }, []);
        let v = R => {
                let A = l.project.edit_params,
                    D = A.get(de.textWidget.cachedTextLinkStyleKey) || "";
                R !== D && (A.set(de.textWidget.cachedTextLinkStyleKey, R), g())
            },
            C = R => {
                n(R), i("EditStyle")
            },
            I = () => m(Mk(u)),
            T = () => {
                n(void 0), i("EditStyle")
            },
            P = R => m(Rk({
                editorState: u,
                oldStyle: R.name,
                newStyle: Dl.name
            })),
            M = R => {
                f.length === 0 || f.length === 1 && f[0].url !== R.url ? m(Bk({
                    editorState: u,
                    ...R,
                    linkStyle: R.linkStyle || Iv(l.project, h.project, h.global) || Dl.name
                })) : m(lf({
                    editorState: u,
                    ...R,
                    linkStyle: R.linkStyle || Iv(l.project, h.project, h.global) || Dl.name
                })), R.linkStyle && v(R.linkStyle)
            },
            F = R => c({
                preventClose: R
            });
        return r(cr, {
            ref: o,
            resizeable: !0,
            height: y,
            panelMinHeight: Vx,
            onResizeComplete: w,
            onHeightChanged: t,
            onStartEditStyle: C,
            currentLinkData: f[0],
            selectedLinkNames: f.map(R => R.linkStyle).filter(Boolean),
            canShowAnchorSelector: l.selected,
            projectId: d,
            userId: p,
            style: e,
            currentTab: s,
            setCurrentTab: a,
            onRemoveUrl: I,
            onAddStyle: T,
            onDeleteStyle: P,
            onChange: M,
            onAnchorToggle: F,
            onToggleDropdown: F,
            onToggleSelectPanel: F,
            showStyles: !0,
            showCloseTipSettings: l.hasParentBlock
        })
    }), B4 = nY
});

function _b({
    type: e,
    size: t
}) {
    let [o, i] = (0, hi.useState)(!1);
    return r(b, {
        display: "flex",
        width: "100%",
        height: 16,
        alignItems: "center",
        justifyContent: "center",
        cursor: "pointer",
        onMouseEnter: () => i(!0),
        onMouseLeave: () => i(!1),
        children: r(LI, {
            color: o ? "0080FF64" : "28282864",
            type: e,
            size: t
        })
    })
}
var hi, R4, sY, aY, E4, F4 = k(() => {
    "use strict";
    hi = E(N()), R4 = E(ze());
    Ol();
    ie();
    Ur();
    ru();
    Be();
    je();
    zt();
    Dn();
    FH();
    nt();
    ab();
    ts();
    $e();
    nn();
    ko();
    Mt();
    AI();
    wb();
    qi();
    B();
    sY = (e, t) => {
        switch (t.type) {
            case "Reset":
                return { ...t.payload
                };
            case "SetInfo":
                return { ...e,
                    ...t.payload
                };
            case "SetStyle":
                let {
                    section: o,
                    ...i
                } = t.payload;
                return { ...e,
                    style: { ...e.style,
                        [o]: { ...e.style[o] || {},
                            ...i
                        }
                    }
                };
            default:
                return e
        }
    }, aY = (0, hi.forwardRef)(({
        style: e,
        headerSlot: t,
        onLinkPreview: o,
        currentLinkData: i,
        userId: n,
        projectId: s,
        selectedStyle: a,
        currentTab: l,
        onSave: c,
        onCancel: d,
        canHaveCurrentState: p,
        onStyleSectionChanged: h,
        onToggleDropdown: u,
        getScrollablePanelProps: m
    }, f) => {
        let [g, y] = Kd(), S = l === 1 ? g.global : g.project, w = l === 1 ? "global" : "project", v = U => {
            F({
                type: "SetStyle",
                payload: {
                    section: D,
                    type: U
                }
            })
        }, C = [{
            title: "None",
            onClick: () => v("None")
        }, {
            title: r(_b, {
                size: 2,
                type: "Solid"
            }),
            onClick: () => v("Solid"),
            hoverVariant: ui.unstyled
        }, {
            title: r(_b, {
                size: 2,
                type: "Dotted"
            }),
            onClick: () => v("Dotted"),
            hoverVariant: ui.unstyled
        }, {
            title: r(_b, {
                size: 2,
                type: "Dashed"
            }),
            onClick: () => v("Dashed"),
            hoverVariant: ui.unstyled
        }], [I] = (0, hi.useState)(a ? a.name : `link-style-${zn()}`), T = (0, hi.useMemo)(() => {
            let U = {
                    padding: 0,
                    size: 1,
                    type: "Solid",
                    color: ro(de.textWidget.initialColor),
                    textColor: ro(de.textWidget.initialColor)
                },
                he = { ...U,
                    textColor: ro({ ...de.textWidget.initialColor,
                        a: .8
                    })
                };
            return {
                name: I,
                label: "New Style",
                style: {
                    link: U,
                    hover: he,
                    current: U
                }
            }
        }, []), P = (0, hi.useMemo)(() => {
            if (a) return a; {
                let U = { ...g,
                    [w]: [...g[w], { ...T
                    }]
                };
                return y(U), U[w].find(xe => xe.name === I) || {}
            }
        }, [a, T]), [M, F] = (0, hi.useReducer)(sY, P), [R, A] = (0, hi.useState)(0), D = R === 0 ? "link" : R === 1 ? "hover" : "current", O = (0, hi.useMemo)(() => {
            let U = [{
                title: "Link"
            }, {
                title: "Hover"
            }];
            return p ? [...U, {
                title: "Current"
            }] : U
        }, [p]), L = () => {
            let U = S.findIndex(he => he.name === M.name);
            if (U > -1) {
                let he = [...S];
                return he[U] = { ...M
                }, y({ ...g,
                    [w]: he
                }), he
            }
        }, [W, z] = (0, hi.useState)(!a);
        (0, hi.useEffect)(() => {
            L();
            let U = !R4.default.isEqual(P, M);
            U !== W && z(U)
        }, [M, D]), (0, hi.useEffect)(() => {
            h && h(D)
        }, [D]);
        let V = (0, hi.useCallback)(async () => {
                let U = L();
                U && (l === 1 ? await rd({
                    userId: n,
                    styles: U
                }) : await Vl({
                    projectId: s,
                    styles: U
                }), window.RM.constructorRouter.trigger("update_from_server", "LinkStyles", {
                    [l === 1 ? "global" : "project"]: U
                }))
            }, [S, M]),
            X = (0, hi.useCallback)(() => {
                let U = [...S],
                    he = U.findIndex(xe => xe.name === I);
                he > -1 && (a ? U[he] = a : U.splice(he, 1), y({ ...g,
                    [w]: U
                }))
            }, [a, W, g, I]),
            [q, ne] = (0, hi.useState)(void 0);
        (0, hi.useEffect)(() => {
            !a && i && (ne(i ? .linkStyle), o && o({ ...i,
                linkStyle: I
            }))
        }, []);
        let {
            textColor: re,
            color: te,
            type: ee,
            padding: j,
            size: se
        } = (0, hi.useMemo)(() => {
            let U = M.style[D] || {};
            return {
                textColor: U.textColor || ro(de.textWidget.initialColor),
                color: U.color || ro(de.textWidget.initialColor),
                type: U.type || "None",
                padding: U.padding || 0,
                size: U.size || 1
            }
        }, [M, D]), oe = ee === "None";
        return r(Me, {
            ref: f,
            style: e,
            isShowed: !0,
            ...m(),
            children: r(Ot.Consumer, {
                children: ({
                    dropdownContainer: U
                }) => x(Q, {
                    children: [t || null, r(H, {
                        leftSlot: r(Mo, {
                            "data-testid": "text-link-style-name",
                            textStyle: "regular",
                            value: M.label,
                            onChange: he => {
                                F({
                                    type: "SetInfo",
                                    payload: {
                                        label: he.target.value
                                    }
                                })
                            },
                            padding: 0,
                            border: "none !important",
                            placeholder: "Style Name"
                        })
                    }), r(os, {
                        items: O,
                        activeIndex: R,
                        onChange: A
                    }), r(qe, {
                        "data-testid": "link-text-color",
                        container: U,
                        title: "Text color",
                        projectId: s,
                        userId: n,
                        color: Yo(re),
                        setColor: he => {
                            he && F({
                                type: "SetStyle",
                                payload: {
                                    section: D,
                                    textColor: ro(he)
                                }
                            })
                        }
                    }), r(Ho, {
                        onToggleDropdown: u,
                        listItems: C,
                        container: U,
                        children: ({
                            toggleDropdown: he
                        }) => r(H, {
                            leftSlot: "Underline",
                            rightSlot: r(K, {
                                onClick: he,
                                variant: "clean",
                                width: 46,
                                children: oe ? r($, {
                                    textStyle: "small",
                                    display: "block",
                                    children: "None"
                                }) : r(_b, {
                                    size: 2,
                                    type: ee
                                })
                            })
                        })
                    }), r(qe, {
                        "data-testid": "link-underline-color",
                        container: U,
                        title: "Underline color",
                        projectId: s,
                        userId: n,
                        color: Yo(te),
                        setColor: he => {
                            he && F({
                                type: "SetStyle",
                                payload: {
                                    section: D,
                                    color: ro(he)
                                }
                            })
                        }
                    }), r(H, {
                        disabled: oe,
                        leftSlot: "Underline width",
                        rightSlot: r(fe, {
                            "data-testid": "text-link-style-underline-width",
                            width: 40,
                            min: 1,
                            max: 99,
                            value: se,
                            textAlign: "right",
                            onChange: ({
                                value: he
                            }) => {
                                F({
                                    type: "SetStyle",
                                    payload: {
                                        section: D,
                                        size: he
                                    }
                                })
                            }
                        })
                    }), r(H, {
                        disabled: oe,
                        leftSlot: "Padding",
                        rightSlot: r(fe, {
                            "data-testid": "text-link-style-padding",
                            width: 40,
                            min: -99,
                            max: 99,
                            value: j,
                            textAlign: "right",
                            onChange: ({
                                value: he
                            }) => {
                                F({
                                    type: "SetStyle",
                                    payload: {
                                        section: D,
                                        padding: he
                                    }
                                })
                            }
                        })
                    }), r(qp, {
                        cancelAction: async () => {
                            await X(), o && !a && i && o({ ...i,
                                linkStyle: q
                            }), d && d()
                        },
                        doneDisabled: !W,
                        doneAction: async () => {
                            await V(), c && c()
                        }
                    })]
                })
            })
        })
    }), E4 = aY
});
var Ls, lY, D4, A4 = k(() => {
    "use strict";
    Ls = E(N());
    xb();
    ae();
    ni();
    Dn();
    Le();
    F4();
    cf();
    B();
    lY = (0, Ls.forwardRef)(({
        style: e,
        headerSlot: t,
        getScrollablePanelProps: o
    }, i) => {
        let {
            goBack: n
        } = (0, Ls.useContext)(Jt), {
            model: s,
            modelSet: a
        } = (0, Ls.useContext)(Y), l = (0, Ls.useMemo)(() => s.project.get("_id"), [s]), c = (0, Ls.useMemo)(() => s.user.get("_id"), [s]), {
            model: d
        } = (0, Ls.useContext)(ge), {
            selectedStyle: p,
            currentTab: h
        } = (0, Ls.useContext)(im), [u, m] = s.useSharedState({
            partial: !1
        }), f = (0, Ls.useMemo)(() => af(u), [u]), g = v => {
            m(lf({
                editorState: u,
                ...v
            }))
        }, y = (0, Ls.useMemo)(() => {
            let v = f && f.type || null,
                C = d.is_global,
                I = s.parentBlock ? .get("is_global");
            return !!(C || I) && v === "Page"
        }, [d, s.workspace, f]);
        return r(E4, {
            ref: i,
            style: e,
            userId: c,
            projectId: l,
            headerSlot: t,
            onLinkPreview: g,
            currentLinkData: f,
            onSave: n,
            onCancel: n,
            currentTab: h,
            selectedStyle: p,
            canHaveCurrentState: y,
            onStyleSectionChanged: v => {
                s.block ? .propsModel ? .set({
                    currentLinkStyle: v
                })
            },
            onToggleDropdown: v => a({
                preventClose: v
            }),
            getScrollablePanelProps: o
        })
    }), D4 = lY
});

function cY() {
    let {
        model: e
    } = (0, Er.useContext)(Y), [t] = e.useSharedState({
        partial: !1
    }), o = (0, Er.useMemo)(() => Fk(t), [t]), [i, n] = (0, Er.useState)({
        currentTab: 0
    }), s = (0, Er.useCallback)(h => n({ ...i,
        selectedStyle: h
    }), [i]), a = (0, Er.useCallback)(h => n({ ...i,
        currentTab: h
    }), [i]), l = (0, Er.useRef)(null), {
        canControlBeClosed: c,
        onStackUpdated: d
    } = As(l.current);
    e.injectedRefs.canControlBeClosed = c;
    let p = (0, Er.useCallback)(h => {
        if (h.preventDefault(), !e.disabled) {
            if (l.current && l.current.currentScreen !== "EditInfo") {
                if (e.selected) {
                    l.current.goBack();
                    return
                }
                n({ ...i,
                    selectedStyle: void 0
                }), l.current.goHome()
            }
            e.select()
        }
    }, [e.disabled, e.selected, l.current, i]);
    return r(Ie, {
        centerPanel: ["mixed", "active"].includes(o),
        control: ({
            ref: h
        }) => r(ke, {
            ref: h,
            label: "Link",
            onClick: p,
            isActive: ["mixed", "active"].includes(o),
            isMixed: o === "mixed",
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: h,
            style: u,
            update: m,
            getScrollablePanelProps: f
        }) => e.selected ? r(im.Provider, {
            value: { ...i,
                setSelectedStyle: s,
                setCurrentTab: a
            },
            children: x(Pr, {
                ref: l,
                initialScreen: "EditInfo",
                onStackUpdated: g => {
                    e.block ? .propsModel ? .set({
                        currentLinkStyle: ""
                    }), d(g)
                },
                onNavigate: () => {
                    m()
                },
                children: [r(lo, {
                    screen: "EditInfo",
                    children: r(B4, {
                        ref: h,
                        style: u,
                        onHeightChanged: m
                    })
                }), r(lo, {
                    screen: "EditStyle",
                    children: r(D4, {
                        ref: h,
                        style: u,
                        getScrollablePanelProps: f
                    })
                })]
            })
        }) : null
    })
}
var Er, im, L4, xb = k(() => {
    "use strict";
    Er = E(N());
    ae();
    ht();
    M4();
    ni();
    A4();
    cf();
    Qc();
    il();
    B();
    im = (0, Er.createContext)({});
    L4 = cY
});
var z4, $4 = k(() => {
    "use strict";
    ae();
    xb();
    z4 = Ce.extend({
        name: "text_link",
        component: L4
    })
});

function dY() {
    let {
        model: e
    } = (0, xn.useContext)(Y), [t] = Ii(), o = (0, xn.useMemo)(() => e.project.get("_id"), [e]), i = (0, xn.useMemo)(() => e.user.get("_id"), [e]), [n, s] = e.useSharedState({
        group: !0,
        partial: !1
    }), a = Qi("BaseWidgetCanSelectColorFromPalette"), l = Qi("BaseWidgetCanSelectColorFromSwatches"), c = n[0];
    (0, xn.useEffect)(() => {
        e.selected && e.blocks.length > 1 && e.groupSetAndSave(C => {
            let I = C.nonReactGetSharedState();
            return wr(I.getCurrentContent())
        })
    }, [c, e.selected, e.blocks]);
    let {
        color: d,
        hex: p
    } = (0, xn.useMemo)(() => {
        let C = {
            color: [],
            hex: []
        };
        return n.forEach(I => {
            let T = Ko({
                    editorState: I
                }),
                P = [...t.global, ...t.project].find(A => A.name === T),
                M = Pi(I, "COLOR"),
                F = M && M.length ? M[0] : void 0,
                R = de.textWidget.initialColor;
            F ? R = Yo(F) : P && P.cssProperties.color && (R = Yo(P.cssProperties.color)), C.color.push(R), C.hex.push(yt(R))
        }), C
    }, [n, t.global, t.project]), h = (0, xn.useMemo)(() => !!af(c), [c]), u = h ? "Edit color in Link settings" : "Color";
    (0, xn.useEffect)(() => {
        h && e.selected && (e.deselect(), e.removeFade())
    }, [h, e.selected]);
    let m = (0, xn.useMemo)(() => c.getSelection().isCollapsed(), [c]),
        f = C => {
            let I = n.map((T, P) => {
                let M = T;
                return m && (M = xr(M, e.block ? .propsModel ? .get("isEditMode"))), M = yi({
                    key: "COLOR",
                    value: ro(Array.isArray(C) ? C[P] : C),
                    editorState: M
                }), m && (M = At(M, T.getSelection())), M
            });
            s(I)
        };
    (0, xn.useEffect)(() => () => {
        e.blocks.forEach(C => {
            C.toggleSelectionHighlight(!1)
        })
    }, []);
    let g = (0, xn.useCallback)(C => {
            C.preventDefault(), !(e.disabled || h) && e.select()
        }, [e.disabled, h]),
        [y, S] = (0, xn.useState)(!1);
    (0, xn.useEffect)(() => {
        !e.selected && y && window.RM.constructorRouter.trigger("notice:triggerColorMetrics", {
            id: e.model.get("_id"),
            color: p
        })
    }, [e.selected, y]);
    let w = e.isMixed(p),
        v = e.isMixed(d.map(C => C.a));
    return r(Ie, {
        control: ({
            ref: C
        }) => r(b, {
            opacity: h ? .5 : 1,
            css: Z `
            ${h?`
                &, * {
                  cursor: not-allowed !important;
                }`:""}
          `,
            children: r(ke, {
                ref: C,
                label: u,
                disableHover: !0,
                onClick: g,
                children: r(sc, {
                    hex: p.map(I => "#" + I)
                })
            })
        }),
        panel: ({
            ref: C,
            style: I
        }) => e.selected ? r(Me, {
            ref: C,
            style: I,
            isShowed: e.selected,
            clean: !0,
            children: r(ac, {
                projectId: o,
                userId: i,
                hiddenColorMarker: w,
                hiddenOpacityMarker: v,
                color: d[0],
                setColor: f,
                onOpacityChange: T => {
                    f(d.map(P => ({ ...P,
                        a: T
                    })))
                },
                onColorChange: () => {
                    e.blocks.forEach(T => {
                        T.toggleSelectionHighlight(!0)
                    })
                },
                onChangeComplete: T => {
                    f(T), e.blocks.forEach(P => {
                        P.toggleSelectionHighlight(!1)
                    }), S(!0)
                },
                swatchesOnlyMode: l && !a
            })
        }) : null
    })
}
var xn, W4, O4 = k(() => {
    "use strict";
    xn = E(N());
    ae();
    ht();
    nt();
    Ss();
    ko();
    em();
    cf();
    Yt();
    Mt();
    qi();
    ie();
    Ps();
    ve();
    B();
    W4 = dY
});
var j4, H4 = k(() => {
    "use strict";
    ae();
    O4();
    j4 = Ce.extend({
        name: "text_color",
        component: W4,
        restrictions: function(e, t) {
            return t.some(i => i.model.get("type") === "text") ? t.length && t.every(i => i.model.get("type") === "text") : !0
        }
    })
});

function pY({
    col: e,
    isActive: t
}) {
    let [o, i] = (0, nl.useState)(!1);
    return x(Q, {
        children: [r(b, {
            display: "inline-block",
            height: 24,
            width: 4,
            borderRadius: 2,
            opacity: t && o ? .8 : 1,
            backgroundColor: t || o ? "blue" : "gray",
            "data-col": e,
            onMouseEnter: () => i(!0),
            onMouseLeave: () => i(!1),
            transition: "0.1s background-color, 0.1s opacity"
        }), r(b, {
            display: "inline-block",
            height: 24,
            width: 4,
            "data-col": e,
            onMouseEnter: () => i(!0),
            onMouseLeave: () => i(!1)
        })]
    })
}

function uY({
    value: e,
    columns: t,
    onChange: o
}) {
    let [i, n] = (0, nl.useState)(!1), s = (0, nl.useRef)(null), a = (0, nl.useMemo)(() => Array.from({
        length: t
    }, (d, p) => p), [t]), l = d => {
        let p = d.clientX,
            h = d.clientY,
            u = document.elementFromPoint(p, h);
        if (u && s.current && s.current.contains(u)) {
            let m = u.dataset && u.dataset.col;
            m && o(parseInt(m) + 1)
        }
    }, c = () => {
        n(!1)
    };
    return (0, nl.useEffect)(() => (i ? (window.addEventListener("mousemove", l), window.addEventListener("mouseup", c)) : (window.removeEventListener("mousemove", l), window.removeEventListener("mouseup", c)), () => {
        window.removeEventListener("mousemove", l), window.removeEventListener("mouseup", c)
    }), [i]), r(b, {
        cursor: "pointer",
        ref: s,
        onMouseDown: d => {
            l(d.nativeEvent), n(!0)
        },
        userSelect: "none",
        children: a.map(d => r(pY, {
            col: d,
            isActive: d + 1 <= e
        }, d))
    })
}
var nl, Gx, N4 = k(() => {
    "use strict";
    nl = E(N());
    ie();
    B();
    Gx = uY
});
var U4 = k(() => {
    "use strict";
    N4()
});
var wd, V4, hY, G4, Y4 = k(() => {
    "use strict";
    wd = E(N());
    Le();
    ae();
    nt();
    qo();
    ie();
    U4();
    zt();
    Vn();
    $e();
    B();
    V4 = 12, hY = (0, wd.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o,
            modelSet: i,
            modelSave: n
        } = (0, wd.useContext)(ge), {
            model: s
        } = (0, wd.useContext)(Y), a = (0, wd.useMemo)(() => o.columns || {
            count: 1,
            gap: 0
        }, [o.columns]), {
            callback: l
        } = Je(n, 400), c = (d, p) => {
            i({
                columns: { ...a,
                    [d]: p
                }
            }), l()
        };
        return x(Me, {
            isShowed: s.selected,
            ref: t,
            style: e,
            children: [r(co, {
                title: "Columns"
            }), r(H, {
                showBorder: !1,
                leftSlot: r(b, {
                    width: 100,
                    children: r(Gx, {
                        value: a.count,
                        columns: V4,
                        onChange: d => c("count", d)
                    })
                }),
                rightSlot: r(fe, {
                    width: 40,
                    direction: "x",
                    moveSpeed: 10,
                    "data-testid": "text-columns-count",
                    value: a.count,
                    onChange: ({
                        value: d
                    }) => c("count", d),
                    min: 1,
                    max: V4,
                    textAlign: "right"
                })
            }), r(H, {
                showBorder: !1,
                leftSlot: "Gap",
                rightSlot: r(fe, {
                    "data-testid": "text-columns-gap",
                    value: a.gap,
                    onChange: ({
                        value: d
                    }) => c("gap", d),
                    min: 0,
                    max: 100,
                    textAlign: "right"
                })
            })]
        })
    }), G4 = hY
});

function mY() {
    let {
        model: e
    } = (0, Sb.useContext)(Y), t = (0, Sb.useCallback)(o => {
        o.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: o
        }) => r(ke, {
            ref: o,
            label: "Columns",
            onClick: t,
            children: r($0, {
                color: "white"
            })
        }),
        panel: ({
            ref: o,
            style: i
        }) => e.selected ? r(G4, {
            ref: o,
            style: i
        }) : null
    })
}
var Sb, Z4, X4 = k(() => {
    "use strict";
    Sb = E(N());
    ht();
    Kj();
    ae();
    Y4();
    B();
    Z4 = mY
});
var K4, J4 = k(() => {
    "use strict";
    ae();
    X4();
    K4 = Ce.extend({
        name: "text_columns",
        component: Z4,
        rolePermission: "TextCanChangeColumns"
    })
});
var q4, Q4 = k(() => {
    "use strict";
    no();
    q4 = {
        "template-constructor-control-text_edit": Ae `
	<div class="icon noarrow" aria-label="Toggle text edit mode" data-alt="Edit" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
	</div>
`
    }
});
var eE, fY, tE, oE = k(() => {
    "use strict";
    eE = E(ze());
    $n();
    Q4();
    fY = it.extend({
        name: "text_edit",
        className: "control text_edit",
        initialize: function(e) {
            this.template = q4["template-constructor-control-text_edit"], this.initControl(e)
        },
        restrictions: function(e, t) {
            return t.length && t.every(o => o.model.get("type") === "text")
        },
        select: function() {
            it.prototype.select.apply(this, arguments),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls-text_edit")
                }), eE.default.defer(function() {
                    this.blocks && this.blocks[0].enterEditMode()
                }.bind(this))
        }
    }), tE = fY
});
var iE, nE = k(() => {
    "use strict";
    no();
    iE = {
        "template-constructor-control-picture_crop": Ae `
	<div class="icon preloader" aria-label="Picture crop" data-alt="Crop" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
		<div class="permission-controller" <%= options.canCropPicture ? '' : 'disabled="true"' %>>
			<div class="scale">
				<div class="handler">
					<div class="helper"></div>
				</div>
			</div>
		</div>
		<div class="permission-controller" <%= options.canChangeSize ? '' : 'disabled="true"' %>>
			<div class="equilateral button"></div>
		</div>
		<div class="permission-controller" <%= options.canCropPicture ? '' : 'disabled="true"' %>>
			<div class="fill button">Fill</div>
		</div>
		<div class="permission-controller" <%= options.canChangeSize ? '' : 'disabled="true"' %>>
			<div class="fit button">Fit</div>
		</div>
	</div>
`
    }
});

function Cb({
    actualZoomOfPictureFrame: e,
    currentSizes: t,
    cropH: o,
    cropW: i,
    originalCropW: n,
    originalCropH: s,
    isFullWidth: a,
    isFullHeight: l
}) {
    let c = i,
        d = o;
    return (l || a) && (c = i / e, d = o / e, c = e < 1 ? Math.min(c, n) : n, d = e < 1 ? Math.min(d, s) : s), Math.max(Number((t.width / c).toFixed(5)), Number((t.height / d).toFixed(5)))
}
var Yx = k(() => {
    "use strict"
});
var Zx, Xx, kb, gY, rE, sE = k(() => {
    "use strict";
    Zx = E(Ze()), Xx = E(ze());
    $n();
    nE();
    Nr();
    Yx();
    kb = it.prototype, gY = it.extend({
        name: "picture_crop",
        className: "control picture_crop",
        events: {
            "click .equilateral": "equilateral",
            "click .fill": "fill",
            "click .fit": "fit",
            "click .scale": "setScale"
        },
        scaleParams: {
            min: .01,
            max: 5
        },
        snapParams: {
            lastZoom: null,
            activeSnap: null,
            delta: .01,
            points: [.5, 1]
        },
        HANDLER_SIZE: 26,
        initialize: function(e) {
            this.options = {
                canCropPicture: so.isPermissionAllowed("PictureCanCropPicture"),
                canChangeSize: so.isPermissionAllowed("BaseWidgetChangeSize")
            }, this.template = iE["template-constructor-control-picture_crop"], this.initControl(e), this.block = this.blocks[0], !this.block.model.get("picture") && !this.block.tempPicture && this.$el.hide(), this.onFullWidthChange(), this.onFullHeightChange()
        },
        onClick: function() {
            this.block.$picture && (this.$el.hasClass("inactive") || kb.onClick.apply(this, arguments))
        },
        render: function() {
            kb.render.apply(this, arguments), this.initScale(), this.onScaleChange(), this.block.has_parent_block && this.$el.addClass("hide-all-except-scale"), this.$equilateral = this.$(".equilateral")
        },
        select: function() {
            this.block.enterCropMode(), this.$el.removeClass("fade");
            let e = this.block.model.get("scale");
            e = Cb({
                initialScale: e,
                currentSizes: {
                    width: this.block.model.get("w"),
                    height: this.block.model.get("h")
                },
                cropH: this.block.model.get("originalCropH") || this.block.model.get("originalH"),
                cropW: this.block.model.get("originalCropW") || this.block.model.get("originalW")
            }), this.$handler.css("top", this.toScale(e)), this.$helper.text(Math.floor(e * 100) + "%"), this.snapParams.lastZoom = Number((+e || 0).toFixed(2)), this.snapParams.activeSnap = null, this.toggleSnappedStyle()
        },
        deselect: function() {
            this.block.leaveCropMode(), kb.deselect.apply(this, arguments)
        },
        toggleEnabled: function(e, t) {
            clearTimeout(this.cancelLoadingTimeout), e && t ? this.block.originalLoaded || this.$el.addClass("loading") : (this.$el.addClass("checked"), this.$icon.addClass("rmalttext-disable"), this.cancelLoadingTimeout = setTimeout(Xx.default.bind(function() {
                this.$el.removeClass("loading")
            }, this), 200), e && kb.select.apply(this, arguments))
        },
        onPictureLoaded: function() {
            this.$el.show()
        },
        bindLogic: function() {
            this.block.model.on("change:scale", this.onScaleChange), this.block.model.on("change:w change:h", this.onSizeChange), this.block.model.on("change:is_full_width", this.onFullWidthChange), this.block.model.on("change:is_full_height", this.onFullHeightChange), this.block.on("picture_added", this.onPictureLoaded), this.$scale = this.$panel.find(".scale"), this.$handler = this.$panel.find(".handler"), this.$helper = this.$panel.find(".helper"), this.$handler.on("dragstart", this.onScaleStart), this.$handler.on("drag", this.onScale), this.$handler.on("dragend", this.onScaleStop), this.block.on("crop_click", this.onClick), this.block.on("transitionmode", this.toggleEnabled)
        },
        unBindLogic: function() {
            this.block.off("transitionmode", this.toggleEnabled), this.block.off("crop_click", this.onClick), this.$handler && (this.$handler.off("dragstart", this.onScaleStart), this.$handler.off("drag", this.onScale), this.$handler.off("dragend", this.onScaleStop), this.block.model.off("change:scale", this.onScaleChange), this.block.model.off("change:w change:h", this.onSizeChange), this.block.model.off("change:is_full_width", this.onFullWidthChange), this.block.model.off("change:is_full_height", this.onFullHeightChange), this.block.off("picture_added", this.onPictureLoaded))
        },
        equilateral: function() {
            if (this.$equilateral.hasClass("fade")) return;
            let e = this.block.getBoxData();
            if (e.w > e.h) {
                var t = {
                    width: e.h,
                    height: e.h,
                    left: e.x + (e.w - e.h) / 2,
                    top: e.y
                };
                this.block.frame.doResize(t), this.block.onCropResize(t), this.block.onResizeEnd()
            } else {
                var t = {
                    width: e.w,
                    height: e.w,
                    top: e.y + (e.h - e.w) / 2,
                    left: e.x
                };
                this.block.frame.doResize(t), this.block.onCropResize(t), this.block.onResizeEnd()
            }
            this.$equilateral.addClass("fade")
        },
        fill: function() {
            this.block.fill()
        },
        fit: function() {
            this.block.fit()
        },
        toggleSnappedStyle: function() {
            this.$handler.toggleClass("snapped", !!this.snapParams.activeSnap)
        },
        onScaleStart: function(e, t) {
            t.offset = parseInt(this.$handler.css("top")), this.$handler.addClass("dragging")
        },
        onScale: function(e, t) {
            let o = Number(this.fromScale(t.deltaY + t.offset).toFixed(2));
            o < this.scaleParams.min && (o = this.scaleParams.min), o > this.scaleParams.max && (o = this.scaleParams.max), this.snapParams.lastZoom !== o && (this.snapParams.lastZoom = o, this.snapParams.activeSnap && (o > this.snapParams.activeSnap + this.snapParams.delta || o < this.snapParams.activeSnap - this.snapParams.delta) ? this.snapParams.activeSnap = null : this.snapParams.activeSnap && (o = this.snapParams.activeSnap), this.snapParams.activeSnap = null, this.snapParams.points.forEach(i => {
                o === i && o !== this.snapParams.activeSnap && (this.snapParams.activeSnap = i)
            }), this.toggleSnappedStyle(), this.block.rescale(o))
        },
        onScaleChange: function(e, t, o) {
            if (!t) return;
            let i = o && o.smooth ? "animate" : "css";
            this.$handler[i]({
                top: this.toScale(t)
            }), this.$helper.text(Math.round(t * 100) + "%")
        },
        onSizeChange: function(e) {
            e.get("w") !== e.get("h") && this.$equilateral.hasClass("fade") && this.$equilateral.removeClass("fade")
        },
        onScaleStop: function() {
            this.$handler.removeClass("dragging"), this.snapParams.activeSnap = null
        },
        setScale: function(e) {
            if ((0, Zx.default)(e.target).closest(".handler").length) return;
            let t = e.pageY - (0, Zx.default)(e.target).offset().top - this.HANDLER_SIZE / 2;
            this.block.rescale(Number(this.fromScale(t).toFixed(2)), {
                smooth: !0
            })
        },
        initScale: function() {
            this._scaleHeight = parseInt(this.$scale.css("height")) - parseInt(this.$handler.css("height")) - 4;
            let e = this.scaleParams.min,
                t = this.scaleParams.max,
                o = this._scaleHeight,
                i = Math.floor(this._scaleHeight / 2),
                n = (1 - e) * o / ((t - 1) * o / i - t + e),
                s = (t - 1) * (n / i + 1) * n,
                a = t - s / n;
            Xx.default.extend(this.scaleParams, {
                a,
                b: s,
                c: n
            })
        },
        toScale: function(e) {
            e = e - 0, e > this.scaleParams.max && (this.scaleParams.max = e, this.initScale());
            let t = this.scaleParams.a,
                o = this.scaleParams.b,
                i = this.scaleParams.c;
            return o / (e - t) - i
        },
        fromScale: function(e) {
            if (e < 0) return this.scaleParams.max;
            let t = this.scaleParams.a,
                o = this.scaleParams.b,
                i = this.scaleParams.c;
            return t + o / (i + e)
        },
        restrictions: function(e) {
            let t = e.getSelectedBlocks();
            return !(t.length == 1 && (t[0].isPictureEmpty && t[0].isPictureEmpty() || t[0].isFullWidth() || t[0].isFullHeight()))
        },
        onEnterKey: function() {
            this.selected && this.master.deselect()
        },
        onFullWidthChange: function() {
            this.$el.toggleClass("inactive", !!this.block.model.get("is_full_width"))
        },
        onFullHeightChange: function() {
            this.$el.toggleClass("inactive", !!this.block.model.get("is_full_height"))
        }
    }), rE = gY
});
var aE, lE = k(() => {
    "use strict";
    no();
    aE = {
        "template-constructor-control-picture_fwpos": Ae `
	<div class="icon noarrow" aria-label="Pseudo-crop" data-alt="Crop" data-alt-pos="left" data-alt-offset="9"></div>
`
    }
});
var cE, Kx, bY, dE, pE = k(() => {
    "use strict";
    $n();
    lE();
    cE = E(ze());
    qt();
    Ht();
    Kx = it.prototype, bY = it.extend({
        name: "picture_fwpos",
        className: "control picture_fwpos",
        initialize: function(e) {
            this.template = aE["template-constructor-control-picture_fwpos"], this.initControl(e), this.block = this.blocks[0], !this.block.model.get("picture") && !this.block.tempPicture && this.$el.hide(), this.sendAnalyticsForMouseEnterDebounced = cE.default.debounce(this.sendAnalyticsForMouseEnter, 400)
        },
        onClick: function() {
            this.block.$picture && (this.$el.hasClass("inactive") || Kx.onClick.apply(this, arguments))
        },
        select: function() {
            this.block.enterFWPosMode(), this.$el.addClass("active"), Kx.select.apply(this, arguments)
        },
        deselect: function() {
            this.block.leaveFWPosMode(), this.$el.removeClass("active"), Kx.deselect.apply(this, arguments)
        },
        onPictureLoaded: function() {
            this.$el.show()
        },
        bindLogic: function() {
            this.block.on("picture_added", this.onPictureLoaded), this.block.on("fwpos_click", this.onClick), this.$el.on("mouseenter", this.sendAnalyticsForMouseEnterDebounced), this.listenTo(this.block.model, "change:is_full_width change:is_full_height", this.disableCrop), this.listenTo(this.block.workspace, "workspace-resize", this.disableCrop)
        },
        unBindLogic: function() {
            this.block.off("crop_click", this.onClick), this.block.off("picture_added", this.onPictureLoaded), this.block.off("fwpos_click", this.onClick), this.$el.off("mouseenter", this.sendAnalyticsForMouseEnterDebounced), this.stopListening(this.block.model, "change:is_full_width change:is_full_height", this.disableCrop), this.stopListening(this.block.workspace, "workspace-resize", this.disableCrop)
        },
        disableCrop: function() {
            let e = RM.constructorRouter.zoom.getZoom(),
                t = this.block.workspace.mag.get("opts").scalableviewer ? RM.constructorRouter.zoom.getScaleRatio() : 1,
                o = Number((e / t).toFixed(5));
            this.block.isFullHeight() && this.block.isFullWidth() && o < 1 ? (this.setDisabled(!0), this.$icon.attr("data-alt", "Crop mode is not available for this zoom")) : (this.$icon.attr("data-alt", "Crop"), this.setEnabled(!1))
        },
        sendAnalyticsForMouseEnter: function() {
            this.disabled && De(Fe.WidgetMisc, {
                action: "crop mode locked hover",
                widgetType: "picture"
            })
        },
        restrictions: function(e) {
            let t = e.getSelectedBlocks();
            return t.length == 1 && !(t[0].isPictureEmpty && t[0].isPictureEmpty()) && (t[0].isFullWidth() || t[0].isFullHeight())
        },
        onEnterKey: function() {
            this.selected && this.master.deselect()
        }
    }), dE = bY
});
var rl, yY, uE, hE = k(() => {
    "use strict";
    rl = E(N());
    qo();
    ae();
    il();
    Le();
    vr();
    B();
    yY = (0, rl.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, rl.useContext)(Y), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, rl.useContext)(ge), c = (0, rl.useMemo)(() => i.project.get("_id"), [i]), d = (0, rl.useMemo)(() => i.user.get("_id"), [i]), {
            callback: p
        } = Je(l, 200), h = g => n({
            preventClose: g
        }), u = () => {
            a({
                anchor_link_pos: null,
                clickLink: null,
                clickPage: null,
                clickTarget: ""
            }), p()
        }, m = (0, rl.useMemo)(() => Xo(s), [s]);
        return r(cr, {
            ref: o,
            onHeightChanged: t,
            currentLinkData: m,
            projectId: c,
            userId: d,
            style: e,
            onRemoveUrl: u,
            onChange: g => {
                a(Is(g)), p()
            },
            onAnchorToggle: h,
            onToggleDropdown: h,
            onToggleSelectPanel: h,
            canShowAnchorSelector: !0,
            showStyles: !1,
            showCloseTipSettings: i.hasParentBlock
        })
    }), uE = yY
});

function vY() {
    let {
        model: e
    } = (0, xd.useContext)(Y), {
        model: t
    } = (0, xd.useContext)(ge), o = (0, xd.useMemo)(() => Xo(t), [t.anchor_link_pos, t.clickLink, t.clickPage, t.clickTarget]), i = (0, xd.useCallback)(n => {
        n.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: n
        }) => r(ke, {
            isActive: !!o,
            ref: n,
            label: "Link",
            onClick: i,
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: n,
            style: s,
            update: a
        }) => e.selected ? r(uE, {
            ref: n,
            style: s,
            onHeightChanged: a
        }) : null
    })
}
var xd, mE, fE = k(() => {
    "use strict";
    xd = E(N());
    ae();
    ht();
    Qc();
    hE();
    Le();
    vr();
    B();
    mE = vY
});
var gE, bE = k(() => {
    "use strict";
    ae();
    fE();
    gE = Ce.extend({
        name: "picture_link_new",
        component: mE,
        rolePermission: "PictureCanChangeLink"
    })
});

function wY() {
    let {
        model: e
    } = (0, dr.useContext)(Y), {
        model: t,
        modelSet: o,
        modelSave: i
    } = (0, dr.useContext)(ge), n = (0, dr.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), {
        callback: s
    } = Je(n ? e.groupSave : i, 400), a = () => (e ? .multipleSelectedModels || []).map(({
        attributes: f
    }) => ({
        pic_color: f.pic_color,
        pic_opacity: f.pic_opacity || 1
    })).filter(({
        pic_color: f
    }) => f), l = (0, dr.useMemo)(() => e.project.get("_id"), [e]), c = (0, dr.useMemo)(() => e.user.get("_id"), [e]), d = (0, dr.useMemo)(() => t.pic_color ? t.pic_color : "F4F4F4", [t.pic_color]), p = (0, dr.useMemo)(() => {
        if (n) {
            let f = hv(a(), "pic_opacity");
            return f.length === 1 ? f[0].pic_opacity : "mixed"
        } else return typeof t.pic_opacity == "number" && t.pic_opacity || 1
    }, [t.pic_opacity]), h = (0, dr.useMemo)(() => hv(a(), "pic_color").map(({
        pic_color: g
    }) => `#${g}`), [n, d]);
    (0, dr.useEffect)(() => {
        e.selected && s()
    }, [e.selected]);
    let u = (0, dr.useCallback)(f => {
            let g = {
                pic_color: yt(f),
                pic_opacity: f.a
            };
            n ? e.groupSet(g) : o(g), s()
        }, [n]),
        m = (0, dr.useCallback)(f => {
            f.preventDefault(), !e.disabled && e.select()
        }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: f
        }) => r(ke, {
            ref: f,
            label: "Color",
            onClick: m,
            children: r(sc, {
                hex: h.length > 1 ? h : `#${d}`,
                opacity: p === "mixed" ? 1 : p
            })
        }),
        panel: ({
            ref: f,
            style: g
        }) => e.selected ? r(Me, {
            ref: f,
            style: g,
            isShowed: e.selected,
            clean: !0,
            children: r(ac, {
                projectId: l,
                userId: c,
                setColor: u,
                onChangeComplete: u,
                color: ct(d, p === "mixed" ? 1 : p),
                hiddenColorMarker: h.length > 1,
                hiddenOpacityMarker: p === "mixed"
            })
        }) : null
    })
}
var dr, yE, vE = k(() => {
    "use strict";
    dr = E(N());
    nt();
    qo();
    oo();
    Le();
    ae();
    ht();
    ko();
    em();
    B();
    yE = wY
});
var wE, xE = k(() => {
    "use strict";
    ae();
    vE();
    wE = Ce.extend({
        name: "picture_color",
        component: yE,
        rolePermission: "PictureCanChangeSettings",
        restrictions: function(e, t) {
            return t.length && t.every(o => o.isVector && o.isVector())
        },
        saveOnDeselect: !0,
        saveOnDestroy: !0,
        bindLogic: function() {
            this.model.on("change:pic_color", this.onColorChange), this.model.on("change:pic_opacity", this.onColorChange)
        },
        unBindLogic: function() {
            this.model.off("change:pic_color", this.onColorChange), this.model.off("change:pic_opacity", this.onColorChange)
        },
        onColorChange: function() {
            this.block.$svg && this.blocks.forEach(e => {
                let {
                    pic_color: t,
                    pic_opacity: o
                } = e.attributes;
                e.setVectorColor && e.setVectorColor(t, o)
            })
        },
        save: function() {
            this.blocks.forEach(e => {
                e.saveSvg && e.saveSvg(_.bind(e.model.save, e.model))
            })
        }
    })
});

function _E() {
    return x("svg", {
        width: "16",
        height: "16",
        viewBox: "0 0 16 16",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            d: "M15 1C15.5523 1 16 1.44772 16 2C16 2.55228 15.5523 3 15 3H1C0.447715 3 0 2.55228 0 2C0 1.44772 0.447715 1 1 1H15Z"
        }), r("path", {
            d: "M15 7C15.5523 7 16 7.44772 16 8C16 8.55228 15.5523 9 15 9H1C0.447715 9 0 8.55228 0 8C0 7.44772 0.447715 7 1 7H15Z"
        }), r("path", {
            d: "M16 14C16 13.4477 15.5523 13 15 13H1C0.447715 13 0 13.4477 0 14C0 14.5523 0.447715 15 1 15H15C15.5523 15 16 14.5523 16 14Z"
        }), r("path", {
            d: "M7 2C7 3.10457 6.10457 4 5 4C3.89543 4 3 3.10457 3 2C3 0.89543 3.89543 0 5 0C6.10457 0 7 0.89543 7 2Z"
        }), r("path", {
            d: "M7 14C7 15.1046 6.10457 16 5 16C3.89543 16 3 15.1046 3 14C3 12.8954 3.89543 12 5 12C6.10457 12 7 12.8954 7 14Z"
        }), r("path", {
            d: "M13 8C13 9.10457 12.1046 10 11 10C9.89543 10 9 9.10457 9 8C9 6.89543 9.89543 6 11 6C12.1046 6 13 6.89543 13 8Z"
        })]
    })
}

function SE() {
    return r("svg", {
        width: "32",
        height: "32",
        viewBox: "0 0 32 32",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: r("path", {
            d: "M13 11.5V7H19V11.5H13ZM19 14H24V23H8V14H13V18.5H19V14Z"
        })
    })
}

function CE() {
    return r("svg", {
        width: "16",
        height: "16",
        viewBox: "0 0 16 16",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M9.23297 11.1265C8.30412 11.7118 7.20423 12.0505 6.02525 12.0505C2.6976 12.0505 0 9.35287 0 6.02523C0 2.69759 2.6976 0 6.02525 0C9.3529 0 12.0505 2.69759 12.0505 6.02523C12.0505 7.20424 11.7119 8.30415 11.1265 9.23301L15.6078 13.7143C16.1307 14.2372 16.1307 15.0849 15.6078 15.6078C15.0849 16.1307 14.2372 16.1307 13.7143 15.6078L9.23297 11.1265ZM9.37261 6.02523C9.37261 7.87392 7.87395 9.37258 6.02525 9.37258C4.17655 9.37258 2.67789 7.87392 2.67789 6.02523C2.67789 4.17654 4.17655 2.67788 6.02525 2.67788C7.87395 2.67788 9.37261 4.17654 9.37261 6.02523Z"
        })
    })
}
var Jx = k(() => {
    "use strict";
    B()
});
var du, _d, kE, IE, PE, qx, pu, Ib = k(() => {
    "use strict";
    du = E(Ze());
    Oc();
    _d = E(ze()), kE = E(To());
    Mt();
    Ro();
    IE = new RegExp("^image/(" + de.UPLOAD_IMAGE_FORMATS + ")$", "i"), PE = new RegExp("([a-z-_0-9/:.]*.(" + de.UPLOAD_IMAGE_FORMATS + ")(\\W.*)?$)", "i"), qx = kE.default.View.extend({
        DEFAULT_ERROR_MSG: "Something went wrong!",
        constructor: function(e) {
            return e instanceof me ? this.block = e : e instanceof Qn ? (this.block = e.raw_block || e.block, this.panel = e) : Object.prototype.toString.call(e) === "[object Object]" && (this.block = e.block, this.panel = {
                $el: e.dropZone,
                $refs: {
                    uploadInput: e.uploadInput
                }
            }), this.initialize.apply(this, arguments), this
        },
        initialize: function(e, t) {
            _d.default.bindAll(this);
            let o = this.block;
            t = t || {}, t.fileTypes && (this.fileTypes = new RegExp("^image/(" + t.fileTypes + ")$", "i"), this.fileTypesErrorMessage = t.fileTypesErrorMessage, delete t.fileTypes, delete t.fileTypesErrorMessage), t = _d.default.defaults(t, _d.default.extend({
                dataType: "json",
                singleFileUploads: !0,
                sequentialUploads: !0,
                formData: {
                    id: o.model.id,
                    mid: o.workspace.mag.get("num_id"),
                    name: o.name,
                    uploadType: "picture",
                    unique: t.unique
                },
                dropZone: (0, du.default)(),
                pasteZone: null,
                replaceFileInput: !1
            }, this.panel ? {
                dropZone: (0, du.default)(this.panel.$el),
                fileInput: (0, du.default)(t.uploadInputRefName ? this.panel.$refs[t.uploadInputRefName] : this.panel.$refs.uploadInput)
            } : {})), this.options = t, this.debug && console.log(t), this.$uploader = (0, du.default)(t.fileInput).fileupload(t), this.bindHandlers(), this.uploadingData = []
        },
        bindHandlers: function() {
            let e = this;
            this.preventDefaultOnDrop(), this.$uploader.bind("fileuploadadd", function(t, o) {
                if (e.debug && console.log("add", o), e.uploadData = o, !o || !o.files || !o.files[0] || o.files[0].skipped) return !1;
                let i = o.files && o.files[0].size,
                    n = o.files && o.files[0].type;
                i > de.UPLOAD_IMAGE_SIZE_LIMIT ? (o.allowUpload = !1, alert(o.files[0].uploadError = de.MSG_UPLOAD_IMAGE_SIZE_ERROR)) : (e.fileTypes || IE).test(n) ? o.allowUpload = !0 : (o.allowUpload = !1, alert(o.files[0].uploadError = e.fileTypesErrorMessage || de.MSG_UPLOAD_IMAGE_SUPPORTED_ERROR)), e.trigger("add", t, o), e.uploadingData.push(o), o.submit()
            }).bind("fileuploaddrop", function(t, o) {
                e.debug && console.log("drop", o), e.trigger("drop", t);
                let n = (t.originalEvent.dataTransfer || t.delegatedEvent.dataTransfer).getData("text/html");
                if (!n) return;
                let s = (0, du.default)(n).filter("img").attr("src");
                if (s)
                    if (PE.test(s)) e.trigger("uploadFromUrl", s);
                    else return alert(o.uploadError = de.MSG_UPLOAD_IMAGE_SUPPORTED_ERROR), o.allowUpload = !1, e.clearFileInputField(), !1
            }).bind("fileuploadsubmit", function(t, o) {
                if (e.debug && console.log("submit", o), o.allowUpload) {
                    o.allowUpload = !1;
                    return
                }
                let i = o.uploadError || o.files && o.files[0] && o.files[0].uploadError;
                return i && (delete o.uploadError, o.files && delete o.files[0].uploadError, e.trigger("fail", t, o, i), e.clearFileInputField()), !1
            }).bind("fileuploadsend", function(t, o) {
                if (e.debug && console.log("send", o), o.files[0].skipped) return !1;
                e.trigger("send", t, o)
            }).bind("fileuploadstart", function(t, o) {
                e.debug && console.log("start", o), e.uploading = !0, e.trigger("start", t, o)
            }).bind("fileuploaddone", function(t, o) {
                e.debug && console.log("done", o), e.uploadingData.shift(), e.uploading = !1, e.clearFileInputField(), !o.files[0].skipped && e.trigger("done", t, o)
            }).bind("fileuploaddragover", function(t) {
                e.trigger("dragover", t)
            }).bind("fileuploaddragleave", function(t) {
                e.trigger("dragleave", t)
            }).bind("fileuploadfail", function(t, o) {
                e.debug && console.log("fail", o), e.uploadingData.shift(), e.uploading = !1, e.clearFileInputField();
                let i, n = e.DEFAULT_ERROR_MSG;
                i = o && o.jqXHR && o.jqXHR.status, i == 500 && _d.default.delay(function() {
                    alert(n = de.MSG_UPLOAD_IMAGE_SUPPORTED_ERROR)
                }, 300), !(!o.files || o.files[0].skipped) && o.errorThrown != "abort" && e.trigger("fail", t, o, n)
            })
        },
        setOptions: function(e) {
            this.options = _d.default.extend(this.options, e), this.$uploader.fileupload(this.options)
        },
        setFormData: function(e, t, o) {
            if (!e || !t || !o) return console.error("missing required parameters");
            this.$uploader.fileupload({
                formData: {
                    id: e,
                    name: t,
                    uploadType: o
                }
            })
        },
        clearFileInputField: function() {
            this.$uploader.wrap("<form>").closest("form").get(0).reset(), this.$uploader.unwrap()
        },
        switchOff: function() {
            this.options.dropZone.off("drop dragover", this.prevent), this.$uploader.fileupload("disable")
        },
        switchOn: function() {
            this.preventDefaultOnDrop(), this.$uploader.fileupload("enable")
        },
        preventDefaultOnDrop: function() {
            this.options.dropZone.on("drop dragover", this.prevent)
        },
        prevent: function(e) {
            e.preventDefault()
        },
        abort: function() {
            this.uploadingData[0] && this.uploadingData[0].abort(), _d.default.each(this.uploadingData, function(e) {
                e.files[0].skipped = !0
            })
        },
        destroy: function() {
            this.abort(), this.switchOff(), this.off(), this.$uploader.fileupload("destroy")
        }
    });
    qx.MimeTypeRegExp = IE;
    qx.UrlImageTypeRegExp = PE;
    pu = qx
});

function TE({
    showBorder: e = !0
}) {
    let t = (0, Fr.useRef)(null),
        o = (0, Fr.useRef)(null),
        [i, n] = (0, Fr.useState)(!1),
        [s, a] = (0, Fr.useState)(!1),
        [l, c] = (0, Fr.useState)(!1),
        [d, p] = (0, Fr.useState)(""),
        {
            model: h
        } = (0, Fr.useContext)(Y),
        {
            model: u
        } = (0, Fr.useContext)(ge);

    function m() {
        c(!1), p("")
    }

    function f(w) {
        if (w.length === 0 || w === u.picture ? .url) return;
        let v = h.block;
        c(!0), v.showIconLoader(), v.loadFromUrl(w, {
            success() {
                if (st("PictureWidgetChoose"), u.picture && !Fv()) {
                    let C = h.workspace ? .controls ? .findControl("picture_crop");
                    C ? .master.select(C)
                }
            },
            error: m,
            save: !1
        }), Gf(w).then(C => {
            if (!l) return;
            let I = {
                width: C.width,
                height: C.height,
                content: w
            };
            v.setTempPicture(I, {
                withoutResize: !0
            }), c(!1)
        })
    }

    function g() {
        let w = h.block;
        window.RM.views.searchUnsplash && (st(["PictureWidgetUse"]), De(Fe.WidgetMisc, {
            action: "unsplash",
            widgetType: "picture"
        }), window.RM.views.searchUnsplash.show("", {
            upload: f,
            preview: w.setPreviewImage
        }))
    }

    function y(w) {
        w.preventDefault();
        let v = d.trim();
        if (Zm(v)) {
            f(v);
            return
        }
        window.RM.views.searchUnsplash && window.RM.views.searchUnsplash.show(v, {
            upload: f
        })
    }(0, Fr.useEffect)(() => {
        let w = h.block,
            v = t.current,
            C = o.current,
            I = new pu({
                block: w,
                dropZone: v,
                uploadInput: C
            });

        function T(M) {
            w.showTempPreloader && w.showTempPreloader(), c(!0);
            let F = M.target && M.target.files ? .length && M.target.files[0];
            F && WI(F).then(R => {
                c(!1), w.setTempPicture(R, {
                    withoutResize: !0
                })
            })
        }

        function P(M, F) {
            if (!F || !F.result) {
                m();
                return
            }
            if (c(!1), w.changePicture(F.result), st("PictureWidgetChoose"), u.picture && !Fv()) {
                let R = h.workspace ? .controls ? .findControl("picture_crop");
                R ? .master.select(R)
            }
        }
        I.on("start", T), I.on("done", P), I.on("fail", m), I.on("uploadFromUrl", f)
    }, [h.block]), (0, Fr.useEffect)(() => {
        let w;

        function v() {
            a(!0), clearTimeout(w), w = setTimeout(() => {
                a(!1)
            }, 500)
        }
        return h.workspace.on("main-dragover", v), () => {
            h.workspace.off("main-dragover", v)
        }
    }, []);
    let S = u.picture ? .url ? "Replace" : "Drop file here";
    return s && (S = "Drop file here"), r(b, {
        ref: t,
        children: x(Ti, {
            permission: "PictureCanChangePicture",
            children: [r(H, {
                showBorder: e,
                children: x(b, {
                    display: "flex",
                    flexDirection: "column",
                    gap: 4,
                    children: [r(xY, {
                        variants: {
                            dragging: {
                                y: 50
                            }
                        },
                        animate: s ? "dragging" : void 0,
                        children: r($, {
                            color: "blue",
                            fontSize: 12,
                            fontWeight: 600,
                            cursor: "pointer",
                            opacity: i ? 0 : 1,
                            onClick: () => o.current ? .click(),
                            children: S
                        })
                    }), x(b, {
                        as: "form",
                        marginLeft: -8,
                        marginRight: -8,
                        position: "relative",
                        opacity: s ? 0 : 1,
                        onSubmit: y,
                        children: [r(_Y, {
                            value: d,
                            focused: i || d.length > 0,
                            onChange: w => p(w.target.value),
                            placeholder: "Search or paste URL",
                            onFocus: () => n(!0),
                            onBlur: () => n(!1)
                        }), d.length > 0 ? r(K, {
                            type: "submit",
                            variant: "clean",
                            position: "absolute",
                            right: 16,
                            top: 10,
                            color: "gray",
                            children: r(CE, {})
                        }) : null]
                    }), r(ao, {
                        targetSteps: "PictureWidgetUse",
                        indent: 8,
                        delay: 1400,
                        leaveDelay: 100,
                        position: "left",
                        instance: !0,
                        closeOnTargetClick: !0,
                        componentsProps: {
                            tooltip: {
                                right: "10px"
                            }
                        },
                        children: r(b, {
                            display: "flex",
                            gap: 4,
                            marginTop: 36,
                            opacity: s ? 0 : 1,
                            children: r(SY, {
                                variant: "unstyled",
                                onClick: g,
                                children: r(SE, {})
                            })
                        })
                    })]
                })
            }), r(b, {
                as: "input",
                type: "file",
                name: "upload",
                width: 0,
                height: 0,
                display: "block",
                ref: o,
                "data-url": "/api/upload/lambda/",
                "data-testid": "picture-upload-input",
                visibility: "hidden"
            })]
        })
    })
}
var Fr, xY, _Y, SY, BE = k(() => {
    "use strict";
    Fr = E(N());
    Li();
    $e();
    ie();
    Be();
    ve();
    Ur();
    je();
    qt();
    Jx();
    Ib();
    Le();
    ae();
    OI();
    pi();
    Ps();
    fv();
    Fs();
    B();
    xY = wt(b), _Y = ue(Mo, {
        excludeProps: ["focused"]
    })
    `
  padding: 0 8px;
  height: 40px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 12px;
  transition: background 0.2s ease-in;
  color: ${e=>e.theme.colors.black};
  background-color: ${e=>e.theme.colors.lightGray};
  border-bottom: none !important;
  box-sizing: border-box;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

  ${e=>e.focused&&Z`
      background-color: white;
      padding-right: 36px;
    `}
`, SY = ue(K, {
        excludeProps: ["bgHover"]
    })
    `
  width: 32px;
  height: 32px;
  border-radius: 50%;
  color: white;
  background-color: ${e=>e.theme.colors.darkGray};

  &:hover {
    background-color: ${e=>e.bgHover??e.theme.colors.black};
  }
`
});

function hu({
    values: e,
    onChange: t,
    panelProps: o,
    title: i = "Borders",
    isGroupSelected: n = !1,
    models: s = [],
    inputProps: a = {}
}) {
    let {
        model: l
    } = (0, uu.useContext)(Y), {
        dropdownContainer: c
    } = (0, uu.useContext)(Ot), d = !n || n && s.every(g => g.borders === e.borders) ? e.borders : "mixed", p = (0, uu.useMemo)(() => (0, Qx.uniq)(s.map(({
        color: g
    }) => `#${g}`)), [s]), h = (0, uu.useMemo)(() => (0, Qx.uniq)(s.map(({
        opacity: g
    }) => g ? ? 1)), [s]);

    function u(g) {
        t({
            color: yt(g)
        })
    }

    function m({
        value: g
    }) {
        t({
            borders: g
        })
    }

    function f(g) {
        t({
            opacity: g
        })
    }
    return r(H, {
        hideOverflow: !1,
        leftSlot: i,
        rightSlot: x(b, {
            display: "flex",
            gap: 8,
            alignItems: "center",
            "data-testid": "border-panel",
            children: [r(fe, {
                min: 0,
                max: 999,
                autoWidth: !0,
                textAlign: "right",
                onChange: m,
                isMixedValue: d === "mixed",
                value: d === "mixed" ? 0 : d,
                textStyle: d === "mixed" ? "small" : "subheading",
                ...a
            }), r(qe, {
                circleSize: 28,
                skidding: -55,
                type: "circle-and-picker",
                container: c,
                color: ct(e.color, h[0]),
                colors: p,
                opacity: h,
                userId: l.user.get("_id"),
                projectId: l.project.get("_id"),
                setColor: u,
                onChangeComplete: u,
                onOpacityChange: f
            })]
        }),
        ...o
    })
}
var uu, Qx, Pb = k(() => {
    "use strict";
    uu = E(N());
    nt();
    $e();
    ie();
    zt();
    Qx = E(hn());
    ae();
    ko();
    nn();
    B()
});

function mu({
    values: e,
    onChange: t,
    panelProps: o,
    disableIndependentRadius: i = !1,
    isGroupSelected: n = !1,
    models: s = []
}) {
    let a = (0, e_.useMemo)(() => i ? !1 : s.some(({
            radius_rect_independent: f
        }) => f), [e.radius_rect_independent, i]),
        l = (0, e_.useMemo)(() => {
            if (i) return !1;
            let f = s.filter(({
                    radius_rect_independent: y
                }) => y),
                g = s.filter(({
                    radius_rect_independent: y
                }) => !y);
            return !!f.length && !!g.length
        }, [s, i]);

    function c(f, g) {
        return !!s.every(y => (y.radius_rect_independent ? y[f] : y.radius) === g)
    }
    let d = s.every(f => f.radius === e.radius),
        p = !n || n && d ? e.radius : "mixed";

    function h(f) {
        t({
            radius: f,
            radius_rect_tl: f,
            radius_rect_tr: f,
            radius_rect_bl: f,
            radius_rect_br: f
        })
    }

    function u(f, g) {
        l && t({
            radius_rect_independent: !0
        }), t({
            [f]: g
        })
    }

    function m() {
        t({
            radius_rect_independent: !a
        })
    }
    return r(b, {
        marginTop: a ? -9 : 0,
        children: r(H, {
            showBorder: !1,
            leftSlot: "Radius",
            rightSlot: x(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                "data-testid": "radius-panel",
                children: [a ? null : r(fe, {
                    step: 1,
                    min: 0,
                    max: 999,
                    moveSpeed: 5,
                    autoWidth: !0,
                    textAlign: "right",
                    isMixedValue: p === "mixed",
                    value: p === "mixed" ? 0 : p,
                    textStyle: p === "mixed" ? "small" : "subheading",
                    onChange: ({
                        value: f
                    }) => h(f)
                }), i ? null : r(b, {
                    role: "checkbox",
                    cursor: "pointer",
                    "aria-checked": a,
                    color: a ? "blue" : "gray",
                    onClick: m,
                    children: r(kY, {})
                })]
            }),
            ...o,
            children: a ? r(oi, {
                gridTemplateColumns: "repeat(2, 28px)",
                gap: 20,
                marginTop: -10,
                "data-testid": "independent-radius-items",
                children: CY.map(f => {
                    let g = e.radius_rect_independent ? e[f] : e.radius,
                        y = !c(f, g);
                    return r(fe, {
                        min: 0,
                        step: 1,
                        max: 999,
                        autoWidth: !0,
                        fontSize: 12,
                        moveSpeed: 5,
                        value: g,
                        isMixedValue: y,
                        "data-testid": "panel-item",
                        textStyle: y ? "small" : "subheading",
                        onChange: ({
                            value: S
                        }) => u(f, S)
                    }, f)
                })
            }) : null
        })
    })
}

function kY(e) {
    return x("svg", {
        width: "26",
        height: "26",
        viewBox: "0 0 26 26",
        fill: "currentColor",
        ...e,
        children: [r("path", {
            d: "M8 1V0C3.58172 0 0 3.58172 0 8H1C1 4.13401 4.13401 1 8 1Z"
        }), r("path", {
            d: "M0 18H1C1 21.866 4.13401 25 8 25V26C3.58172 26 0 22.4183 0 18Z"
        }), r("path", {
            d: "M18 26V25C21.866 25 25 21.866 25 18H26C26 22.4183 22.4183 26 18 26Z"
        }), r("path", {
            d: "M26 8H25C25 4.13401 21.866 1 18 1V0C22.4183 0 26 3.58172 26 8Z"
        })]
    })
}
var e_, CY, Tb = k(() => {
    "use strict";
    e_ = E(N());
    $e();
    ie();
    zt();
    kh();
    B();
    CY = ["radius_rect_tl", "radius_rect_tr", "radius_rect_bl", "radius_rect_br"]
});

function ME({
    isGroupSelected: e
}) {
    let {
        model: t
    } = (0, nm.useContext)(Y), {
        model: o
    } = (0, nm.useContext)(ge), i = t.block;

    function n(d) {
        i.$picture && (i.cropmode && i.leaveCropMode({
            noSave: !0
        }), i.setScale(d))
    }
    let s = (0, nm.useMemo)(() => {
            let d = o.cropX === 0 && o.cropY === 0,
                p = o.cropW === o.originalW,
                h = o.cropH === o.originalH;
            return d && p && h
        }, [o]),
        a = i.isFullWidth && i.isFullWidth() || i.isFullHeight && i.isFullHeight() || i.isVector && i.isVector(),
        l = Math.abs((o.scale ? ? 0) - 1) < .01 && s || a,
        c = Math.abs((o.scale ? ? 0) - .5) < .01 && s || a;
    return r(H, {
        showBorder: !1,
        children: x(b, {
            display: "flex",
            flexDirection: "column",
            gap: 8,
            children: [r(K, {
                height: 40,
                textStyle: "small",
                variant: "bordered",
                onClick: () => n(1),
                disabled: e || l,
                children: "Original Size"
            }), r(K, {
                height: 40,
                textStyle: "small",
                variant: "bordered",
                onClick: () => n(2),
                disabled: e || c,
                children: "Half of original Size"
            })]
        })
    })
}
var nm, RE = k(() => {
    "use strict";
    ie();
    je();
    $e();
    nm = E(N());
    ae();
    Le();
    B()
});

function FE({
    onChange: e,
    pictures: t
}) {
    let o = (0, EE.useMemo)(() => t.length > 1, [t.length]),
        [i] = t;

    function n(l) {
        let c = {};
        l.borders !== void 0 ? c.border_size = l.borders : l.color !== void 0 ? c.border_color = l.color : l.opacity !== void 0 && (c.border_color_opacity = l.opacity * 100), e(c)
    }

    function s(l) {
        let c = IY(l),
            d = $C(c, zC);
        e(d)
    }
    let a = !o || o && t.every(l => l.opacity === i.opacity) ? Math.floor(i.opacity * 100) : "mixed";
    return x(Ti, {
        permission: "PictureCanChangeSettings",
        children: [r(hu, {
            models: t.map(({
                borders: l,
                color: c,
                border_color_opacity: d
            }) => ({
                borders: l,
                color: c,
                opacity: d / 100
            })),
            onChange: n,
            isGroupSelected: o,
            values: {
                borders: i.borders,
                color: i.color,
                opacity: i.border_color_opacity / 100
            }
        }), r(mu, {
            models: t,
            onChange: s,
            isGroupSelected: o,
            panelProps: {
                showBorder: !0
            },
            values: {
                radius: i.radius,
                radius_rect_tl: i.radius_rect_tl,
                radius_rect_tr: i.radius_rect_tr,
                radius_rect_bl: i.radius_rect_bl,
                radius_rect_br: i.radius_rect_br,
                radius_rect_independent: !!i.radius_rect_independent
            }
        }), r(H, {
            leftSlot: "Opacity",
            showBorder: !1,
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                "data-testid": "picture-parameters-opacity",
                children: r(fe, {
                    min: 0,
                    step: 1,
                    max: 100,
                    autoWidth: !0,
                    isMixedValue: a === "mixed",
                    value: a === "mixed" ? Math.floor(i.opacity * 100) : a,
                    textStyle: a === "mixed" ? "small" : "subheading",
                    onChange: ({
                        value: l
                    }) => e({
                        opacity: l / 100
                    })
                })
            })
        }), r(ME, {
            isGroupSelected: o
        })]
    })
}
var EE, IY, DE = k(() => {
    "use strict";
    EE = E(N());
    zt();
    $e();
    ie();
    Ps();
    Pb();
    oo();
    Tb();
    RE();
    B();
    IY = ({
        radius: e,
        radius_rect_bl: t,
        radius_rect_br: o,
        radius_rect_tl: i,
        radius_rect_tr: n,
        radius_rect_independent: s
    }) => ({
        border_radius: e,
        border_radius_bl: t,
        border_radius_br: o,
        border_radius_tl: i,
        border_radius_tr: n,
        border_radius_independent: s
    })
});

function PY() {
    let {
        model: e
    } = (0, lc.useContext)(Y), {
        model: t
    } = (0, lc.useContext)(ge), o = (0, lc.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), i = e.block, n = t.picture ? .url, s = n && i.isVector && i.isVector(), a = (0, lc.useCallback)(d => {
        d.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]), l = (0, lc.useCallback)(d => {
        e.groupSetAndSave(d)
    }, []), c = d => ({
        borders: d.border_size ? ? 0,
        opacity: d.opacity ? ? 1,
        border_color_opacity: d.border_color_opacity ? ? 100,
        color: d.border_color ? ? "F4F4F4",
        radius: d.border_radius ? ? 0,
        radius_rect_tl: d.border_radius_tl ? ? 0,
        radius_rect_tr: d.border_radius_tr ? ? 0,
        radius_rect_bl: d.border_radius_bl ? ? 0,
        radius_rect_br: d.border_radius_br ? ? 0,
        radius_rect_independent: !!d.border_radius_independent
    });
    return r(Ie, {
        centerPanel: !!(n && !s),
        control: ({
            ref: d
        }) => r(ke, {
            isActive: e.selected,
            ref: d,
            label: "Picture",
            onClick: a,
            children: r(_E, {})
        }),
        panel: ({
            ref: d,
            style: p
        }) => e.selected ? x(Me, {
            isShowed: !0,
            style: p,
            ref: d,
            children: [r(Ut, {
                leftSlot: "Picture",
                showBorder: !1
            }), !o && r(TE, {
                showBorder: !!(n && !s)
            }), n && !s ? r(Ti, {
                permission: "PictureCanChangeSettings",
                children: r(FE, {
                    onChange: l,
                    pictures: o && e.multipleSelectedModels ? e.multipleSelectedModels.map(h => c(h.attributes)) : [c(t)]
                })
            }) : null]
        }) : null
    })
}
var lc, AE, LE = k(() => {
    "use strict";
    lc = E(N());
    nt();
    gn();
    ae();
    ht();
    Jx();
    BE();
    DE();
    Le();
    Ps();
    B();
    AE = PY
});
var zE, $E = k(() => {
    "use strict";
    ae();
    LE();
    zE = Ce.extend({
        name: "picture_settings",
        component: AE,
        restrictions: function(e, t) {
            return t.length && t.every(o => o.thumb === "picture")
        }
    })
});
var sl, t_, TY, is, Bb = k(() => {
    "use strict";
    sl = E(Ze()), t_ = E(ze());
    $n();
    TY = it.extend({
        MIN_PANEL_HEIGHT: 100,
        MAX_PANEL_HEIGHT: 672,
        PANEL_MARGIN: 20,
        SCROLL_GAP_START: 16,
        SCROLL_GAP_END: 16,
        render: function() {
            this.panelSizes = {
                resizable: this.getControlParam("height") || this.MIN_PANEL_HEIGHT
            }, it.prototype.render.apply(this, arguments), this.$el.addClass("control-resizable"), this.resizableScroll = (0, sl.default)(this.$el.find(".resizable-scroll-wrapper")).RMScroll({
                $container: this.$el.find(".resizable-content-wrapper"),
                $content: this.$el.find(".resizable-content"),
                $handle: this.$el.find(".resizable-scroll"),
                wheelScrollSpeed: .4,
                gap_start: this.SCROLL_GAP_START,
                gap_end: this.SCROLL_GAP_END,
                onScroll: this.onPanelScroll
            }).data("scroll"), this.__scrollRecalc_debounced = t_.default.debounce(t_.default.bind(function() {
                this.resizableScroll.recalc(), this.onScrollRecalc("control-resize")
            }, this), 300), (0, sl.default)(this.$(".resize-handle-top")).RMDrag({
                start: this.startHandleDrag,
                move: this.moveHandleDrag,
                end: this.endHandleDrag,
                silent: !0,
                preventDefault: !0
            }), (0, sl.default)(this.$(".resize-handle-bottom")).RMDrag({
                start: this.startHandleDrag,
                move: this.moveHandleDrag,
                end: this.endHandleDrag,
                silent: !0,
                preventDefault: !0
            }), this.updatePanelHeight()
        },
        onResize: function() {
            this.updatePanelHeight()
        },
        updatePanelHeight: function(e) {
            if (!this.destroyed) {
                if (e = e || this.panelSizes[this.fixedPanelSize ? "fixed" : "resizable"], !this.fixedPanelSize) {
                    let t = Math.ceil(this.MIN_PANEL_HEIGHT / 2) * 2,
                        o = Math.ceil(this.MAX_PANEL_HEIGHT / 2) * 2,
                        i = (0, sl.default)(window).height() - this.PANEL_MARGIN * 2,
                        n = Math.ceil(i / 2) * 2;
                    e = Math.max(e, t), e = Math.min(e, o), e = Math.min(e, n)
                }
                if (this.$panel.height(e), this.panelSizes[this.fixedPanelSize ? "fixed" : "resizable"] = e, this.fixedPanelSize) this.$panel.css("top", -Math.ceil((e - this.master.ICON_HEIGHT) / 2));
                else {
                    let t = parseInt(this.$el.css("top"));
                    this.$panel.css("top", -Math.ceil(e / 2) - t)
                }
                this.fixedPanelSize || this.__scrollRecalc_debounced && this.__scrollRecalc_debounced()
            }
        },
        startHandleDrag: function(e) {
            let t = (0, sl.default)(e.currentTarget);
            this.resizeParams = {
                $handle: t,
                dir: t.hasClass("resize-handle-top") ? -1 : 1,
                initial_h: this.panelSizes.resizable
            }, t.addClass("dragging"), this.$panel.addClass("no-transitions")
        },
        moveHandleDrag: function(e) {
            let t = this.resizeParams.initial_h + e.deltaY * this.resizeParams.dir * 2;
            this.updatePanelHeight(t), this.resizableScroll && this.resizableScroll.recalc(), this.onScrollRecalc("control-resize")
        },
        endHandleDrag: function() {
            this.resizeParams.$handle.removeClass("dragging"), this.$panel.removeClass("no-transitions")
        },
        toggleFixedPanelSize: function(e, t) {
            this.fixedPanelSize = e, this.$(".resize-handle-top").toggle(!e), this.$(".resize-handle-bottom").toggle(!e), this.updatePanelHeight(e ? t : this.panelSizes.resizable)
        },
        onScrollRecalc: function() {},
        onPanelScroll: function() {},
        select: function() {
            it.prototype.select.apply(this, arguments), this.resizableScroll && this.resizableScroll.recalc(), this.onScrollRecalc("control-show"), this.resizeScrollBinded || ((0, sl.default)(window).on("resize", this.onResize), this.resizeScrollBinded = !0)
        },
        deselect: function() {
            it.prototype.deselect.apply(this, arguments), this.$panel && (this.panelSizes.resizable != this.getControlParam("height") && this.saveControlParam({
                height: this.panelSizes.resizable
            }), (0, sl.default)(window).off("resize", this.onResize), this.resizeScrollBinded = !1)
        },
        destroy: function() {
            this.panelSizes.resizable != this.getControlParam("height") && this.saveControlParam({
                height: this.panelSizes.resizable
            }), (0, sl.default)(window).off("resize", this.onResize), this.resizeScrollBinded = !1, it.prototype.destroy.apply(this, arguments)
        }
    }), is = TY
});
var o_, WE = k(() => {
    "use strict";
    no();
    o_ = {
        "template-constructor-control-slideshow_manager": Ae `
	<div class="icon preloader noarrow" aria-label="Slideshow images" data-alt="Images" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
		<div class="resizable-scroll-wrapper">
			<div class="resizable-content-wrapper">
				<div class="resizable-content">

				</div>
			</div>
			<div class="resizable-scroll"></div>
		</div>
		<div class="resize-handle-top"></div>
		<div class="resize-handle-bottom"></div>

		<div class="add-block">
			<div class="add" title="Add Images"></div>
		</div>

		<div class="error-panel">
			<div class="error-panel-text"></div>
			<div class="corner-wrapper"><div class="corner"></div></div>
		</div>

		<div class="drop-text">Drop here</div>
	</div>
`,
        "template-constructor-control-slideshow_manager-image": Ae `
	<div class="slideshow-image-wrapper <%= pic.error? 'error': ''%>" data-num="<%=pic.num%>" <% if (pic.errorText) { %>data-error="<%=pic.errorText%>" <% } %> >
		<div class="slideshow-image">
			<div class="num"><%-pic.num%></div>
			<div class="image"<% if (thumbUrl) { %> style="background-image: url('<%=thumbUrl%>')" <% } %> data-id="<%-pic.id%>">
				<div class="rmpreloader">
					<div class="shadow"></div>
					<div class="arc"></div>
				</div>
			</div>
			<div class="remove" title="Delete"></div>
			<div class="update" title="Replace"></div>
		</div>
	</div>
`
    }
});
var ns, rn, BY, OE, jE = k(() => {
    "use strict";
    ns = E(Ze()), rn = E(ze());
    Bb();
    WE();
    Ip();
    Mt();
    BY = is.extend({
        name: "slideshow_manager",
        className: "control slideshow_manager",
        rolePermission: "SlideshowCanChangePictures",
        events: {},
        MIN_PANEL_HEIGHT: 275,
        MAX_PANEL_HEIGHT: 640,
        CREATE_SPEED: 270,
        initialize: function(e) {
            rn.default.bindAll(this), this.template = o_["template-constructor-control-slideshow_manager"], this.image_template = o_["template-constructor-control-slideshow_manager-image"], this.initControl(e), this.block = this.blocks[0], this.block.manager = this, this.block.workspace.on("main-dragover", this.highlightDropZone), this.slideshowPlayer = this.block.slideshowPlayer
        },
        bindLogic: function() {
            this.block.on("addUpload", this.onAddImage, this), this.block.on("addUpload replaceUpload", this.showLoader, this), this.block.on("nowUploading", this.onStartUploading, this), this.block.on("doneUpload", this.onDoneUpload, this), this.block.on("failUpload", this.onFailUpload, this), this.block.model.on("change:pictures", this.redrawAll, this), this.block.on("clear", this.clearImages), this.$panel.on("click", ".add-block .add", this.addClick), this.$panel.on("click", ".slideshow-image-wrapper .remove", this.onRemoveImage), this.$panel.on("click", ".slideshow-image-wrapper .update", this.onUpdateImage), this.$panel.on("mouseenter", ".slideshow-image-wrapper .image", this.onImageMouseEnter), this.$panel.on("mouseleave", ".slideshow-image-wrapper .image", this.onImageMouseLeave), this.$panel.on("click", ".slideshow-image-wrapper .image", this.onImageClick), this.$resizableContent = (0, ns.default)(this.$panel.find(".resizable-content")), this.block.on("reorder", this.reorder, this), this.$resizableContent.sortable({
                distance: 10,
                axis: "y",
                scrollSpeed: 20,
                containment: this.$(".resizable-scroll-wrapper"),
                tolerance: "pointer",
                cursorAt: {
                    top: 50
                },
                start: rn.default.bind(function(e, t) {
                    this.onImageMouseLeave(), t.item.find(".slideshow-image").addClass("dragging"), this.$resizableContent.css("height", this.$resizableContent.height() + 30)
                }, this),
                stop: rn.default.bind(function(e, t) {
                    setTimeout(rn.default.bind(function() {
                        t.item.find(".slideshow-image").removeClass("dragging")
                    }, this), 50), t.position.top > this.$resizableContent.height() - 30 - t.item.height() && t.item.detach().closest(".slideshow-image-wrapper").appendTo(this.$resizableContent), this.block.swapPictures(t.item.data("num"), t.item.index() + 1), this.$resizableContent.css("height", "auto")
                }, this)
            }), this.$uploadDropZone = this.$el, this.block.updateDropZone(), this.renderPictures(), this.slideshowPlayer && this.slideshowPlayer.on("currentImageChanged", this.onCurrentImageChanged), this.block.queue.length && this.showLoader()
        },
        unBindLogic: function() {
            this.block.off(null, null, this), this.$panel.off("click", ".add-block .add", this.addClick), this.$panel.off("click", ".slideshow-image-wrapper .remove", this.onRemoveImage), this.$panel.off("click", ".slideshow-image-wrapper .update", this.onUpdateImage), this.$panel.off("mouseenter", ".slideshow-image-wrapper .image", this.onImageMouseEnter), this.$panel.off("mouseleave", ".slideshow-image-wrapper .image", this.onImageMouseLeave), this.$panel.off("click", ".slideshow-image-wrapper .image", this.onImageClick), this.slideshowPlayer && this.slideshowPlayer.off(), delete this.$uploadDropZone
        },
        renderPictures: function(e) {
            let t = rn.default.sortBy(this.block.getAllPics(), function(n) {
                    return n.num
                }),
                o = "";
            rn.default.each(t, function(n) {
                o += this.image_template({
                    pic: n,
                    thumbUrl: this.getThumbUrl(n)
                })
            }, this), e && e.clear && this.$panel.find(".resizable-content").html(""), this.$panel.find(".resizable-content").append(o);
            let i = this.block.queue[0];
            i && this.onStartUploading(i), this.rendered = !0, this.resizableScroll && this.resizableScroll.recalc(), (0, ns.default)(this.$panel.find(".resizable-content")).sortable("refresh")
        },
        redrawAll: function(e, t, o) {
            o && (o.undo || o.redo) && this.rendered && (this.$el.addClass("updating"), setTimeout(rn.default.bind(function() {
                this.renderPictures({
                    clear: !0
                }), this.$el.removeClass("updating"), this.slideshowPlayer && this.onCurrentImageChanged(this.slideshowPlayer.currentImageID, !1, "change-pictures")
            }, this), 50)), rn.default.isEmpty(e.get("pictures")) && this.clearImages()
        },
        clearImages: function() {
            this.$(".resizable-content").empty(), this.resizableScroll && this.resizableScroll.recalc();
            let e = (0, ns.default)(this.$panel.find(".resizable-content"));
            e.data("ui-sortable") && e.sortable("refresh")
        },
        reorder: function() {
            this.$(".slideshow-image-wrapper:not(.deleting)").each(function(e) {
                (0, ns.default)(this).data("num", e + 1).find(".num").text(e + 1)
            })
        },
        onCurrentImageChanged: function(e, t, o) {
            let i = this.$panel.find('.slideshow-image-wrapper .image[data-id="' + e + '"]');
            if (i.length || (i = this.$panel.find(".slideshow-image-wrapper .image:first")), !i.length || (this.$panel.find(".slideshow-image").removeClass("active"), i.closest(".slideshow-image").addClass("active"), o != "switch-to-image" && o != "control-show")) return;
            i = i.closest(".slideshow-image-wrapper");
            let n = this.$panel.find(".resizable-content-wrapper"),
                s = i.position().top,
                a = n.height(),
                l = i.height(),
                c, d = 8;
            s + l * 2 - n.scrollTop() > a - d ? c = s + l * 2 - a + d : s - l - n.scrollTop() < d && (c = s - l - d), c != null && (t ? n.stop().animate({
                scrollTop: c
            }, 200) : n.scrollTop(c))
        },
        onScrollRecalc: function(e) {
            this.slideshowPlayer && this.onCurrentImageChanged(this.slideshowPlayer.currentImageID, !1, e)
        },
        onImageClick: function(e) {
            let t = (0, ns.default)(e.target).attr("data-id");
            t && this.slideshowPlayer && this.slideshowPlayer.moveToImage(t, !0, "switch-to-image")
        },
        onImageMouseEnter: function(e) {
            let t = (0, ns.default)(e.currentTarget),
                o = t.closest(".slideshow-image-wrapper"),
                i = this.$(".error-panel");
            if (t.closest(".slideshow-image").hasClass("dragging") || !o.hasClass("error")) return;
            let n = t.width(),
                s = t.offset().left - this.$panel.offset().left,
                a = t.offset().top - this.$panel.offset().top;
            i.find(".error-panel-text").text(o.attr("data-error")), i.addClass("shown").css({
                left: s + n / 2,
                top: a - i.outerHeight()
            })
        },
        onImageMouseLeave: function() {
            this.$(".error-panel").removeClass("shown")
        },
        addClick: function() {
            this.block.$(".uploadInput").trigger("click", "stop")
        },
        onAddImage: function(e) {
            let t = (0, ns.default)(this.image_template({
                pic: e,
                thumbUrl: this.getThumbUrl(e)
            }));
            t.appendTo(this.$panel.find(".resizable-content")), t.addClass("enable-transition").addClass("collapsed").addClass("collapsed-half"), setTimeout(rn.default.bind(function() {
                t.removeClass("collapsed"), setTimeout(rn.default.bind(function() {
                    t.removeClass("collapsed-half"), setTimeout(rn.default.bind(function() {
                        t.removeClass("enable-transition"), this.resizableScroll && this.resizableScroll.recalc(), (0, ns.default)(this.$panel.find(".resizable-content")).sortable("refresh")
                    }, this), this.CREATE_SPEED)
                }, this), this.CREATE_SPEED)
            }, this), 50)
        },
        showLoader: function() {
            this.$el.addClass("loading")
        },
        onStartUploading: function(e) {
            this.getImage(e).addClass("loading")
        },
        getThumbUrl: function(e) {
            if (!ii.useLambdaUrl(e)) return e.thumbUrl;
            let t = {
                width: de.THUMB_SIZE_SLIDESHOW,
                height: de.THUMB_SIZE_SLIDESHOW,
                originalW: e.width,
                originalH: e.height
            };
            return ii.getThumbnailUrl(e, t)
        },
        onDoneUpload: function(e) {
            let t = this.getImage(e);
            t.find(".rmpreloader").fadeOut("fast", function() {
                t.removeClass("loading"), (0, ns.default)(this).attr("style", "")
            }), t.find(".image").css("background-image", `url("${this.getThumbUrl(e)}")`).attr("data-id", e.id), this.block.queue.length || this.$el.removeClass("loading")
        },
        onFailUpload: function(e, t) {
            let o = this.getImage(e);
            e.error && o.addClass("error").attr("data-error", t), this.block.queue.length || this.$el.removeClass("loading")
        },
        onRemoveImage: function(e) {
            let t = (0, ns.default)(e.target).closest(".slideshow-image-wrapper"),
                o = t.addClass("deleting").data("num");
            this.block.deletePic(o), t.addClass("enable-transition"), setTimeout(rn.default.bind(function() {
                t.addClass("removed-half"), setTimeout(rn.default.bind(function() {
                    t.addClass("removed"), setTimeout(rn.default.bind(function() {
                        t.removeClass("enable-transition").remove(), this.resizableScroll && this.resizableScroll.recalc()
                    }, this), this.CREATE_SPEED)
                }, this), this.CREATE_SPEED)
            }, this), 50)
        },
        getImage: function(e) {
            return this.$(".slideshow-image-wrapper").filter(function() {
                return (0, ns.default)(this).data("num") === e.num
            })
        },
        onUpdateImage: function(e) {
            let o = (0, ns.default)(e.target).closest(".slideshow-image-wrapper").removeClass("error").data("error", "").attr("style", "").data("num");
            this.block.updatePic(o)
        },
        highlightDropZone: function() {
            this.$panel.addClass("show-dropzone"), clearTimeout(this.highlightTimeout), this.highlightTimeout = setTimeout(rn.default.bind(function() {
                this.$panel.removeClass("show-dropzone")
            }, this), 500)
        },
        select: function() {
            is.prototype.select.apply(this, arguments),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls-slideshow_manager")
                })
        },
        restrictions: function(e) {
            let t = rn.default.pluck(e.getSelectedBlocks(), "model");
            return rn.default.all(t, function(o) {
                return !o.get("type") == "slideshow" || (o.get("pictures") || []).length > 0
            })
        },
        destroy: function() {
            is.prototype.destroy.apply(this, arguments), this.rendered = !1
        }
    }), OE = BY
});

function MY() {
    let {
        model: e
    } = (0, zs.useContext)(ge), {
        model: t
    } = (0, zs.useContext)(Y), o = Qi("BaseWidgetCanSelectColorFromPalette"), i = Qi("BaseWidgetCanSelectColorFromSwatches"), n = t.blocks.map(f => f.model.get("bg_color") || "000000"), s = t.blocks.map(f => f.model.get("bg_opacity") ? ? 1), a = t.isMixed(n), l = t.isMixed(s), c = (0, zs.useMemo)(() => t.project.get("_id"), [t]), d = (0, zs.useMemo)(() => t.user.get("_id"), [t]), p = f => {
        t.groupSetAndSave({
            bg_color: yt(f)
        })
    }, h = (0, zs.useCallback)(f => {
        f.preventDefault(), !t.disabled && t.select()
    }, [t.disabled]), [u, m] = (0, zs.useState)(!1);
    return (0, zs.useEffect)(() => {
        !t.selected && u && window.RM.constructorRouter.trigger("notice:triggerColorMetrics", {
            id: t.model.get("_id"),
            color: e.bg_color
        })
    }, [t.selected, u]), r(Ie, {
        control: ({
            ref: f
        }) => r(ke, {
            ref: f,
            label: "Color",
            onClick: h,
            children: r(sc, {
                hex: n.map(g => `#${g}`),
                opacity: l ? 1 : s[0]
            })
        }),
        panel: ({
            ref: f,
            style: g
        }) => t.selected ? r(Me, {
            ref: f,
            style: g,
            isShowed: t.selected,
            clean: !0,
            children: r(ac, {
                hiddenColorMarker: a,
                hiddenOpacityMarker: l,
                projectId: c,
                userId: d,
                color: ct(n[0], s[0]),
                onOpacityChange: y => {
                    t.groupSetAndSave({
                        bg_opacity: y
                    })
                },
                setColor: p,
                swatchesOnlyMode: i && !o,
                onChangeComplete: y => {
                    p(y), m(!0)
                }
            })
        }) : null
    })
}
var zs, HE, NE = k(() => {
    "use strict";
    zs = E(N());
    nt();
    Le();
    ae();
    ht();
    ko();
    em();
    Ps();
    B();
    HE = MY
});
var UE, VE = k(() => {
    "use strict";
    ae();
    NE();
    UE = Ce.extend({
        name: "shape_color",
        component: HE,
        rolePermission: "ShapeCanChangeColor",
        restrictions: function(e, t) {
            return t.length && t.every(o => o.thumb === "shape")
        },
        saveOnDeselect: !1,
        saveOnDestroy: !0
    })
});

function ZE({
    selectedShape: e,
    onChange: t
}) {
    return r(H, {
        showBorder: !0,
        children: r(b, {
            display: "flex",
            gap: 20,
            flexWrap: "wrap",
            role: "listbox",
            children: RY.map(o => r(EY, {
                shape: o,
                onChange: t,
                active: o === e
            }, o))
        })
    })
}
var RY, GE, EY, XE = k(() => {
    "use strict";
    $e();
    ie();
    Yf();
    B();
    RY = ["rectangle", "polygon", "line", "ellipse", "icon"], GE = {
        polygon: "M12.4179 3.12275C13.8892 0.164083 18.1099 0.164094 19.5812 3.12276L31.5633 27.219C32.8856 29.8781 30.9514 33 27.9817 33H4.01742C1.04772 33 -0.886466 29.8781 0.435793 27.219L12.4179 3.12275Z",
        icon: "M16.9321 27.9689C16.3489 27.6602 15.6511 27.6602 15.0679 27.9689L7.89733 31.7641C6.43496 32.5381 4.72127 31.2959 4.99938 29.6635L6.3848 21.5314C6.48881 20.9209 6.3039 20.2967 5.88426 19.8416L0.531022 14.0364C-0.55049 12.8636 0.112041 10.9574 1.68719 10.7099L9.13511 9.53989C9.77718 9.43902 10.3299 9.03125 10.6162 8.44716L14.2097 1.11687C14.9397 -0.372289 17.0603 -0.372289 17.7903 1.11687L21.3838 8.44716C21.6701 9.03125 22.2228 9.43902 22.8649 9.53989L30.3128 10.7099C31.888 10.9574 32.5505 12.8636 31.469 14.0364L26.1157 19.8416C25.6961 20.2967 25.5112 20.9209 25.6152 21.5314L27.0006 29.6635C27.2787 31.2959 25.565 32.5381 24.1027 31.7641L16.9321 27.9689Z"
    }, EY = ({
        shape: e,
        active: t,
        onChange: o
    }) => {
        let i = {
            rectangle: r("rect", {
                x: "0",
                y: "0",
                rx: "4",
                ry: "4",
                width: 32,
                height: 32
            }),
            polygon: r("path", {
                d: GE.polygon,
                fillRule: "evenodd",
                clipRule: "evenodd"
            }),
            line: r("path", {
                d: "M1 31L31 1",
                stroke: "currentColor",
                strokeWidth: 4,
                strokeLinecap: "round"
            }),
            ellipse: r("circle", {
                cx: "16",
                cy: "16",
                r: "16"
            }),
            icon: r("path", {
                d: GE.icon,
                fillRule: "evenodd",
                clipRule: "evenodd"
            }),
            path: null
        };
        return r(b, {
            as: "span",
            cursor: "pointer",
            color: t ? "black" : "gray",
            role: "option",
            tabIndex: 0,
            onClick: () => o(e),
            "aria-selected": t,
            children: r(b, {
                as: "svg",
                display: "inline-block",
                width: 32,
                height: 32,
                viewBox: "0 0 32 32",
                fill: "currentColor",
                children: i[e]
            })
        })
    }
});

function fu({
    autoFocus: e = !1,
    showBorder: t = !0,
    title: o = "Borders",
    onChange: i,
    shapes: n,
    isGroupSelected: s
}) {
    let [a] = n;
    return r(hu, {
        title: o,
        models: n,
        onChange: i,
        isGroupSelected: s,
        panelProps: {
            showBorder: t
        },
        inputProps: {
            autoFocus: e,
            step: a.borders < 1 ? .1 : 1,
            floating: a.borders <= 1,
            min: a.borders === 1 ? .9 : 0
        },
        values: {
            borders: a.borders,
            color: a.color,
            opacity: a.opacity
        }
    })
}
var Mb = k(() => {
    "use strict";
    Pb();
    B()
});

function Rb({
    disableIndependentRadius: e = !1,
    onChange: t,
    isGroupSelected: o,
    shapes: i
}) {
    let [n] = i;
    return r(mu, {
        models: i,
        onChange: t,
        isGroupSelected: o,
        disableIndependentRadius: e,
        values: {
            radius: n.radius,
            radius_rect_bl: n.radius_rect_bl,
            radius_rect_br: n.radius_rect_br,
            radius_rect_tl: n.radius_rect_tl,
            radius_rect_tr: n.radius_rect_tr,
            radius_rect_independent: n.radius_rect_independent
        }
    })
}
var i_ = k(() => {
    "use strict";
    Tb();
    B()
});

function JE({
    onChange: e,
    shapes: t,
    isGroupSelected: o
}) {
    return x(KE.Fragment, {
        children: [r(fu, {
            onChange: e,
            shapes: t,
            isGroupSelected: o
        }), r(Rb, {
            onChange: e,
            shapes: t,
            isGroupSelected: o
        })]
    })
}
var KE, qE = k(() => {
    "use strict";
    KE = E(N());
    Mb();
    i_();
    B()
});

function eF({
    onChange: e,
    isGroupSelected: t,
    shapes: o
}) {
    let [i] = o, n = !t || t && o.every(a => a.sides === i.sides) ? i.sides : "mixed";

    function s({
        value: a
    }) {
        return e({
            sides: a
        })
    }
    return x(QE.Fragment, {
        children: [r(H, {
            leftSlot: "Sides",
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                children: r(fe, {
                    value: n === "mixed" ? 3 : n,
                    min: 3,
                    max: 30,
                    step: 1,
                    textStyle: n === "mixed" ? "small" : "subheading",
                    isMixedValue: n === "mixed",
                    textAlign: "right",
                    autoWidth: !0,
                    onChange: s
                })
            })
        }), r(fu, {
            onChange: e,
            isGroupSelected: t,
            shapes: o
        }), r(Rb, {
            onChange: e,
            isGroupSelected: t,
            shapes: o,
            disableIndependentRadius: !0
        })]
    })
}
var QE, tF = k(() => {
    "use strict";
    QE = E(N());
    $e();
    ie();
    Mb();
    i_();
    zt();
    B()
});

function iF({
    onChange: e,
    isGroupSelected: t,
    shapes: o
}) {
    let [i] = o, n = !t || t && o.every(c => c.weight === i.weight) ? i.weight : "mixed";

    function s({
        value: c
    }) {
        return e({
            weight: c
        })
    }
    let a = (0, gu.useCallback)(c => ({
            active: c === i.stroke,
            title: r(oF, {
                type: c
            }),
            closeOnClick: !0,
            onClick() {
                e({
                    stroke: c
                })
            }
        }), [i.stroke]),
        l = (0, gu.useMemo)(() => ["solid", "double", "dotted", "dashed"].map(a), [a]);
    return x(gu.Fragment, {
        children: [r(H, {
            leftSlot: "Weight",
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                children: r(fe, {
                    floating: !0,
                    max: 999,
                    min: n === 1 ? .9 : 0,
                    autoWidth: !0,
                    textAlign: "right",
                    onChange: s,
                    isMixedValue: n === "mixed",
                    step: n < 1 ? .1 : 1,
                    value: n === "mixed" ? .5 : n,
                    textStyle: n === "mixed" ? "small" : "subheading"
                })
            })
        }), r(Ho, {
            isCleanVariant: !0,
            listItems: l,
            role: "listbox",
            children: ({
                toggleDropdown: c
            }) => r(H, {
                showBorder: !1,
                leftSlot: "Stroke",
                rightSlot: r(K, {
                    variant: "unstyled",
                    width: 52,
                    onClick: c,
                    children: r(oF, {
                        type: i.stroke
                    })
                })
            })
        })]
    })
}

function oF({
    type: e
}) {
    let t = {
        solid: r("line", {
            x1: "0",
            y1: "17",
            x2: "100%",
            y2: "17",
            strokeWidth: 2,
            stroke: "black"
        }),
        double: x(Q, {
            children: [r("line", {
                x1: "0",
                y1: "14",
                x2: "100%",
                y2: "14",
                strokeWidth: 2,
                stroke: "black"
            }), r("line", {
                x1: "0",
                y1: "20",
                x2: "100%",
                y2: "20",
                strokeWidth: 2,
                stroke: "black"
            })]
        }),
        dotted: r("line", {
            x1: "0",
            y1: "17",
            x2: "100%",
            y2: "17",
            strokeWidth: 2,
            stroke: "black",
            strokeDasharray: "2, 2"
        }),
        dashed: r("line", {
            x1: "0",
            y1: "17",
            x2: "100%",
            y2: "17",
            strokeWidth: 2,
            stroke: "black",
            strokeDasharray: "5, 3"
        })
    };
    return r("svg", {
        width: "100%",
        height: "28",
        xmlns: "http://www.w3.org/2000/svg",
        children: t[e]
    })
}
var gu, nF = k(() => {
    "use strict";
    gu = E(N());
    zt();
    $e();
    ts();
    je();
    ie();
    Yf();
    B()
});

function rF({
    onChange: e,
    isGroupSelected: t,
    shapes: o
}) {
    return r(fu, {
        showBorder: !1,
        title: "Border",
        onChange: e,
        isGroupSelected: t,
        shapes: o
    })
}
var sF = k(() => {
    "use strict";
    Mb();
    B()
});
var n_, lF, FY, DY, aF, $s, bu = k(() => {
    "use strict";
    n_ = E(ze()), lF = E(Ze());
    yr();
    FY = "/api/authservice/noun?uri=", DY = !1, aF = ["defaultIcons", "defaultSlideshowRightIcons", "defaultSlideshowLeftIcons"], $s = class {
        constructor() {
            _e(this, "prevSVGSearch", {
                icons: [],
                query: "",
                nextPage: null
            });
            _e(this, "defaultIcons", [{
                rm_id: "rm0",
                icon_url: G("./constructor/blocks/shape/default-collection/00-dots-vertical.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/00-dots-vertical.svg")
            }, {
                rm_id: "rm1",
                icon_url: G("./constructor/blocks/shape/default-collection/01-dots-horizontal.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/01-dots-horizontal.svg")
            }, {
                rm_id: "rm2",
                icon_url: G("./constructor/blocks/shape/default-collection/02-align-left.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/02-align-left.svg")
            }, {
                rm_id: "rm3",
                icon_url: G("./constructor/blocks/shape/default-collection/03-minus.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/03-minus.svg")
            }, {
                rm_id: "rm4",
                icon_url: G("./constructor/blocks/shape/default-collection/04-sandwich-two-lines.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/04-sandwich-two-lines.svg")
            }, {
                rm_id: "rm5",
                icon_url: G("./constructor/blocks/shape/default-collection/05-sandwich-three-lines.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/05-sandwich-three-lines.svg")
            }, {
                rm_id: "rm6",
                icon_url: G("./constructor/blocks/shape/default-collection/06-plus.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/06-plus.svg")
            }, {
                rm_id: "rm7",
                icon_url: G("./constructor/blocks/shape/default-collection/07-checkbox.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/07-checkbox.svg")
            }, {
                rm_id: "rm8",
                icon_url: G("./constructor/blocks/shape/default-collection/08-delete.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/08-delete.svg")
            }, {
                rm_id: "rm9",
                icon_url: G("./constructor/blocks/shape/default-collection/09-arrow-1.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/09-arrow-1.svg")
            }, {
                rm_id: "rm10",
                icon_url: G("./constructor/blocks/shape/default-collection/10-arrow-2.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/10-arrow-2.svg")
            }, {
                rm_id: "rm11",
                icon_url: G("./constructor/blocks/shape/default-collection/11-arrow-3.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/11-arrow-3.svg")
            }, {
                rm_id: "rm12",
                icon_url: G("./constructor/blocks/shape/default-collection/12-edit-thin.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/12-edit-thin.svg")
            }, {
                rm_id: "rm13",
                icon_url: G("./constructor/blocks/shape/default-collection/13-edit-thick.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/13-edit-thick.svg")
            }, {
                rm_id: "rm14",
                icon_url: G("./constructor/blocks/shape/default-collection/14-file.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/14-file.svg")
            }, {
                rm_id: "rm15",
                icon_url: G("./constructor/blocks/shape/default-collection/15-flag.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/15-flag.svg")
            }, {
                rm_id: "rm16",
                icon_url: G("./constructor/blocks/shape/default-collection/16-geolocation.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/16-geolocation.svg")
            }, {
                rm_id: "rm17",
                icon_url: G("./constructor/blocks/shape/default-collection/17-geopin.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/17-geopin.svg")
            }, {
                rm_id: "rm18",
                icon_url: G("./constructor/blocks/shape/default-collection/18-star.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/18-star.svg")
            }, {
                rm_id: "rm19",
                icon_url: G("./constructor/blocks/shape/default-collection/19-heart.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/19-heart.svg")
            }, {
                rm_id: "rm20",
                icon_url: G("./constructor/blocks/shape/default-collection/20-bag.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/20-bag.svg")
            }, {
                rm_id: "rm21",
                icon_url: G("./constructor/blocks/shape/default-collection/21-user.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/21-user.svg")
            }, {
                rm_id: "rm22",
                icon_url: G("./constructor/blocks/shape/default-collection/22-eye.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/22-eye.svg")
            }, {
                rm_id: "rm23",
                icon_url: G("./constructor/blocks/shape/default-collection/23-lock.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/23-lock.svg")
            }, {
                rm_id: "rm24",
                icon_url: G("./constructor/blocks/shape/default-collection/24-instacamera.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/24-instacamera.svg")
            }, {
                rm_id: "rm25",
                icon_url: G("./constructor/blocks/shape/default-collection/25-camera.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/25-camera.svg")
            }, {
                rm_id: "rm26",
                icon_url: G("./constructor/blocks/shape/default-collection/26-lightning.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/26-lightning.svg")
            }, {
                rm_id: "rm27",
                icon_url: G("./constructor/blocks/shape/default-collection/27-play.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/27-play.svg")
            }, {
                rm_id: "rm28",
                icon_url: G("./constructor/blocks/shape/default-collection/28-video.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/28-video.svg")
            }, {
                rm_id: "rm29",
                icon_url: G("./constructor/blocks/shape/default-collection/29-pause.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/29-pause.svg")
            }, {
                rm_id: "rm30",
                icon_url: G("./constructor/blocks/shape/default-collection/30-music-note.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/30-music-note.svg")
            }, {
                rm_id: "rm31",
                icon_url: G("./constructor/blocks/shape/default-collection/31-sound-on.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/31-sound-on.svg")
            }, {
                rm_id: "rm32",
                icon_url: G("./constructor/blocks/shape/default-collection/32-sound-off.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/32-sound-off.svg")
            }, {
                rm_id: "rm33",
                icon_url: G("./constructor/blocks/shape/default-collection/33-mobile.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/33-mobile.svg")
            }, {
                rm_id: "rm34",
                icon_url: G("./constructor/blocks/shape/default-collection/34-desktop.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/34-desktop.svg")
            }, {
                rm_id: "rm35",
                icon_url: G("./constructor/blocks/shape/default-collection/35-monitor.svg"),
                preview_url_42: G("./constructor/blocks/shape/default-collection/35-monitor.svg")
            }]);
            _e(this, "defaultSlideshowRightIcons", [{
                rm_id: "rm_right_0",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/00-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/00-right-arrow.svg")
            }, {
                rm_id: "rm_right_1",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/01-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/01-right-arrow.svg")
            }, {
                rm_id: "rm_right_2",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/02-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/02-right-arrow.svg")
            }, {
                rm_id: "rm_right_3",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/03-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/03-right-arrow.svg")
            }, {
                rm_id: "rm_right_4",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/04-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/04-right-arrow.svg")
            }, {
                rm_id: "rm_right_5",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/05-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/05-right-arrow.svg")
            }, {
                rm_id: "rm_right_6",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/06-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/06-right-arrow.svg")
            }, {
                rm_id: "rm_right_7",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/07-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/07-right-arrow.svg")
            }, {
                rm_id: "rm_right_8",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/08-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/08-right-arrow.svg")
            }, {
                rm_id: "rm_right_9",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/09-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/09-right-arrow.svg")
            }, {
                rm_id: "rm_right_10",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/10-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/10-right-arrow.svg")
            }, {
                rm_id: "rm_right_11",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/11-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/11-right-arrow.svg")
            }, {
                rm_id: "rm_right_12",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/12-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/12-right-arrow.svg")
            }, {
                rm_id: "rm_right_13",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/13-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/13-right-arrow.svg")
            }, {
                rm_id: "rm_right_14",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/14-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/14-right-arrow.svg")
            }, {
                rm_id: "rm_right_15",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/15-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/15-right-arrow.svg")
            }, {
                rm_id: "rm_right_16",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/16-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/16-right-arrow.svg")
            }, {
                rm_id: "rm_right_17",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/17-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/17-right-arrow.svg")
            }, {
                rm_id: "rm_right_18",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/18-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/18-right-arrow.svg")
            }, {
                rm_id: "rm_right_19",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/19-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/19-right-arrow.svg")
            }, {
                rm_id: "rm_right_20",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/20-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/20-right-arrow.svg")
            }, {
                rm_id: "rm_right_21",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/21-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/21-right-arrow.svg")
            }, {
                rm_id: "rm_right_22",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/22-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/22-right-arrow.svg")
            }, {
                rm_id: "rm_right_23",
                icon_url: G("./constructor/blocks/slideshow/default-collection/right/23-right-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/right/23-right-arrow.svg")
            }]);
            _e(this, "defaultSlideshowLeftIcons", [{
                rm_id: "rm_left_0",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/00-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/00-left-arrow.svg")
            }, {
                rm_id: "rm_left_1",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/01-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/01-left-arrow.svg")
            }, {
                rm_id: "rm_left_2",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/02-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/02-left-arrow.svg")
            }, {
                rm_id: "rm_left_3",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/03-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/03-left-arrow.svg")
            }, {
                rm_id: "rm_left_4",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/04-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/04-left-arrow.svg")
            }, {
                rm_id: "rm_left_5",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/05-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/05-left-arrow.svg")
            }, {
                rm_id: "rm_left_6",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/06-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/06-left-arrow.svg")
            }, {
                rm_id: "rm_left_7",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/07-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/07-left-arrow.svg")
            }, {
                rm_id: "rm_left_8",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/08-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/08-left-arrow.svg")
            }, {
                rm_id: "rm_left_9",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/09-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/09-left-arrow.svg")
            }, {
                rm_id: "rm_left_10",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/10-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/10-left-arrow.svg")
            }, {
                rm_id: "rm_left_11",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/11-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/11-left-arrow.svg")
            }, {
                rm_id: "rm_left_12",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/12-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/12-left-arrow.svg")
            }, {
                rm_id: "rm_left_13",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/13-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/13-left-arrow.svg")
            }, {
                rm_id: "rm_left_14",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/14-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/14-left-arrow.svg")
            }, {
                rm_id: "rm_left_15",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/15-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/15-left-arrow.svg")
            }, {
                rm_id: "rm_left_16",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/16-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/16-left-arrow.svg")
            }, {
                rm_id: "rm_left_17",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/17-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/17-left-arrow.svg")
            }, {
                rm_id: "rm_left_18",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/18-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/18-left-arrow.svg")
            }, {
                rm_id: "rm_left_19",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/19-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/19-left-arrow.svg")
            }, {
                rm_id: "rm_left_20",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/20-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/20-left-arrow.svg")
            }, {
                rm_id: "rm_left_21",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/21-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/21-left-arrow.svg")
            }, {
                rm_id: "rm_left_22",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/22-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/22-left-arrow.svg")
            }, {
                rm_id: "rm_left_23",
                icon_url: G("./constructor/blocks/slideshow/default-collection/left/23-left-arrow.svg"),
                preview_url_42: G("./constructor/blocks/slideshow/default-collection/left/23-left-arrow.svg")
            }])
        }
        getDefaultIcons(t) {
            if (aF.indexOf(t) < 0) throw new Error(`icons: ${t} is not valid. Use: ${aF.join(",")} instead`);
            return this[t]
        }
        getPersistedIcons(t) {
            let o = this.prevSVGSearch.icons;
            return t && o.length === 0 ? this.getDefaultIcons(t) : o
        }
        fetchIconsPage(t) {
            let o;
            if (!t || this.searchInProgress) return Promise.resolve();
            let i = this.prevSVGSearch.nextPage || 1;
            return this.prevSVGSearch.query !== t && (i = 1, this.prevSVGSearch.icons = []), o = "/icons/" + t + "?page=" + i, DY && (o += "&limit_to_public_domain=1"), new Promise(function(n) {
                this.requestIcons(o, function(s, a) {
                    return s ? (this.prevSVGSearch.nextPage = null, n(this.prevSVGSearch.icons)) : (this.prevSVGSearch.icons = this.prevSVGSearch.icons.concat(a.icons), this.prevSVGSearch.query = t, this.prevSVGSearch.nextPage = i + 1, n(this.prevSVGSearch.icons))
                }.bind(this))
            }.bind(this))
        }
        requestIcons(t, o) {
            this.destroyed || (this.searchXhr && this.searchXhr.abort(), this.searchInProgress = !0, this.searchXhr = lF.default.ajax({
                method: "GET",
                url: FY + encodeURIComponent(t),
                dataType: "json",
                success: function(i) {
                    o(null, i)
                },
                error: function(i) {
                    o(i)
                },
                complete: function() {
                    this.searchInProgress = !1
                },
                context: this
            }))
        }
        abort() {
            this.searchXhr && this.searchXhr.abort()
        }
        clearSearch() {
            this.prevSVGSearch = {
                icons: [],
                query: "",
                nextPage: null
            }, this.searchXhr && this.searchXhr.abort(), this.searchInProgress = !1
        }
        findIcon(t) {
            return t.rm_id ? n_.default.findWhere(this.defaultIcons, t) : n_.default.findWhere(this.prevSVGSearch.icons, {
                id: t.noun_id
            })
        }
        destroy() {
            this.clearSearch(), this.destroyed = !0
        }
    }
});
var Ws, r_ = k(() => {
    "use strict";
    bu();
    Ws = new $s
});
var s_ = k(() => {
    "use strict"
});

function dF(e) {
    let {
        icon: t,
        iconIndex: o,
        selectedIndex: i,
        iconLoading: n,
        onClickIcon: s
    } = e, a = (0, cF.useMemo)(() => i === o && n, [i, o, n]);
    return r(Q, {
        children: x(b, {
            position: "relative",
            display: "flex",
            justifyContent: "center",
            width: "40px",
            height: "40px",
            role: "listitem",
            margin: "4px",
            style: i === o ? {
                border: "2px solid rgba(162,162,162,0.24)",
                opacity: 1
            } : {},
            opacity: "0.4",
            borderRadius: "4px",
            transition: "opacity 0.2s ease-out",
            border: "border: 2px solid transparent",
            cursor: "pointer",
            css: Z `
          &:hover {
            opacity: 1;
          }
        `,
            onClick: () => s(o),
            children: [a && r(b, {
                role: "progressbar",
                css: Z `
              position: absolute;
              display: flex;
              width: 100%;
              height: 100%;
              justify-content: center;
              align-items: center;
            `,
                children: r(_o, {
                    bgColor: "transparent",
                    size: 32,
                    color: "gray"
                })
            }), t.preview_url_42 ? r(AY, {
                icon: t.preview_url_42,
                isLoading: a
            }) : t.type === "ellipse" ? r(LY, {
                isLoading: a
            }) : t.type === "invisible_rectangle" ? r(zY, {
                isLoading: a,
                children: "No icon"
            }) : r(Q, {})]
        })
    })
}
var cF, l_, AY, LY, zY, pF = k(() => {
    "use strict";
    s_();
    ie();
    Bs();
    ve();
    cF = E(N());
    B();
    l_ = ue(b, {
        excludeProps: ["isLoading"]
    })
    `
  position: absolute;
  top: calc(50% - 16px);
  left: calc(50% - 16px);
  cursor: pointer;
  width: 32px;
  height: 32px;
  transition: opacity 0.3s, border 0.3s;

  ${e=>e.isLoading&&`
    opacity: 0.05;
  `};
`, AY = ue(l_, {
        excludeProps: ["icon"]
    })
    `
  background-image: url(${e=>e.icon});
  background-repeat: no-repeat;
  background-size: 100% auto;
  background-position: 50%;
`, LY = ue(l_)
    `
  background-color: black;
  border-radius: 100%;
`, zY = ue(l_)
    `
  display: flex;
  align-items: center;
  text-align: center;
  weight: 500;
  font-size: 12px;
  letter-spacing: -0.08px;
`
});

function rm(e) {
    let {
        height: t = 266,
        icons: o,
        selectedIndex: i,
        iconLoading: n = !1,
        scrollableRef: s,
        paginationItemRef: a,
        isMoreIconsButtonEnabled: l,
        moreIconsLabel: c = "More Icons",
        onClickIcon: d,
        onMoreIconsButtonClick: p
    } = e, h = (0, uF.useMemo)(() => {
        let u = Qm(kk.light.gray);
        return `rgba(${u.r},${u.g}, ${u.b}, 0.4)`
    }, []);
    return x(b, {
        height: t,
        overflowY: "auto",
        ref: s,
        css: Z `
        padding: 8px 8px 8px 12px;
        margin: 0 -12px -15px;

        &::-webkit-scrollbar {
          width: 4px;
        }
        &::-webkit-scrollbar-track {
          background-color: #f1f1f1;
          border-radius: 12px;
        }
        &::-webkit-scrollbar-thumb {
          border-radius: 20px;
          background-color: ${h};
        }
      `,
        children: [x(b, {
            display: "flex",
            flexWrap: "wrap",
            alignContent: "flex-start",
            role: "list",
            css: Z `
          margin: -5px -4px;
        `,
            children: [o.map((u, m) => r(dF, {
                icon: u,
                iconLoading: n,
                iconIndex: m,
                selectedIndex: i,
                onClickIcon: d
            }, u.id || u.rm_id || String(m) + u.type)), r(b, {
                width: "100%",
                ref: a
            })]
        }), l && r(K, {
            onClick: p,
            width: "100%",
            height: 46,
            variant: "tertiary",
            color: "black",
            fontSize: 14,
            children: c
        })]
    })
}
var uF, hF = k(() => {
    "use strict";
    ie();
    pF();
    Km();
    je();
    ko();
    ut();
    uF = E(N());
    B()
});
var sm = k(() => {
    "use strict";
    s_();
    hF()
});

function mF() {
    return r("svg", {
        width: "14",
        height: "14",
        viewBox: "0 0 16 16",
        fill: "#808080",
        xmlns: "http://www.w3.org/2000/svg",
        children: r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M9.23297 11.1265C8.30412 11.7118 7.20423 12.0505 6.02525 12.0505C2.6976 12.0505 0 9.35287 0 6.02523C0 2.69759 2.6976 0 6.02525 0C9.3529 0 12.0505 2.69759 12.0505 6.02523C12.0505 7.20424 11.7119 8.30415 11.1265 9.23301L15.6078 13.7143C16.1307 14.2372 16.1307 15.0849 15.6078 15.6078C15.0849 16.1307 14.2372 16.1307 13.7143 15.6078L9.23297 11.1265ZM9.37261 6.02523C9.37261 7.87392 7.87395 9.37258 6.02525 9.37258C4.17655 9.37258 2.67789 7.87392 2.67789 6.02523C2.67789 4.17654 4.17655 2.67788 6.02525 2.67788C7.87395 2.67788 9.37261 4.17654 9.37261 6.02523Z"
        })
    })
}
var fF = k(() => {
    "use strict";
    B()
});

function Eb(e) {
    let {
        label: t,
        searchText: o,
        onChangeSearch: i,
        onSubmit: n,
        isLoading: s
    } = e;
    return r($Y, {
        children: x(b, {
            as: "form",
            onSubmit: n,
            display: "flex",
            alignItems: "center",
            flexDirection: "row",
            children: [r(Mo, {
                padding: 0,
                fontSize: 12,
                value: o,
                fontWeight: 500,
                placeholder: t || "Search",
                borderBottom: "none !important",
                onChange: i,
                letterSpacing: "-0.08px"
            }), s ? r(b, {
                role: "progressbar",
                padding: "5px 4px 0",
                children: r(_o, {
                    bgColor: "transparent",
                    size: 16,
                    color: "gray"
                })
            }) : r(K, {
                type: "submit",
                variant: "unstyled",
                color: "gray",
                padding: "1px 4px 0",
                children: r(mF, {})
            })]
        })
    })
}
var $Y, c_ = k(() => {
    "use strict";
    ie();
    je();
    Ur();
    Bs();
    $e();
    fF();
    ve();
    B();
    $Y = ue(H)
    `
  > div {
    padding: 9px 0;
  }
`
});

function gF({
    onIconChange: e
}) {
    let {
        model: t
    } = (0, _n.useContext)(ge), [o, i] = (0, _n.useState)(() => Ws.prevSVGSearch.query ? ? ""), n = $I(o, 500), [s, a] = (0, _n.useState)(() => Ws.getPersistedIcons("defaultIcons")), [l, c] = (0, _n.useState)(!1), d = (0, _n.useRef)(null), p = (0, _n.useRef)(null), h = (0, _n.useRef)(null), [u, m] = (0, _n.useState)(-1), [f, g] = (0, _n.useState)(), S = !!Vf(d, {
        root: p.current,
        rootMargin: "80px"
    }) ? .isIntersecting;
    (0, _n.useEffect)(() => {
        let P = t.noun_id || t.rm_id || t.id;
        g(P)
    }, [t.noun_id, t.rm_id, t.id]), Va(() => {
        if (s.length > 0) {
            let P = s.findIndex(M => M.rm_id !== null && M.rm_id !== void 0 && M.rm_id === f || M.id !== null && M.id !== void 0 && M.id === f);
            m(P)
        }
    }, [f, s]);
    let w = (0, _n.useCallback)(() => (c(!0), Ws.searchInProgress && Ws.abort(), Ws.fetchIconsPage(o).then(P => {
        P && a(P), h.current = o
    }).finally(() => {
        c(!1)
    })), [o]);

    function v(P) {
        i(P.target.value)
    }

    function C(P) {
        if (P && P.preventDefault(), o === "") {
            a(Ws.defaultIcons), Ws.clearSearch(), h.current = null;
            return
        }
        h.current !== null && h.current === o || w().then(() => {
            p.current ? .scrollTo({
                top: 0
            })
        })
    }

    function I(P) {
        let M = s[P],
            F = M ? .id || M ? .rm_id;
        !M || !F || (g(F), e(M))
    }

    function T() {
        be.isSubscriptionPaused() ? window ? .RM ? .constructorRouter ? .trigger("notice:show", "unpauseSubscriptionToSearchNounIcons", {
            canBeClosed: !0
        }) : Jo("icon-library")
    }
    return (0, _n.useEffect)(() => {
        S && !Ws.searchInProgress && Ws.prevSVGSearch.nextPage && s.length > 30 && w()
    }, [S]), Gl(() => {
        C()
    }, [n]), x(Q, {
        children: [be.isNounSearchAvailable() && r(Eb, {
            label: "Search",
            isLoading: l,
            searchText: o,
            onChangeSearch: v,
            onSubmit: C
        }), r(H, {
            showBorder: !1,
            css: Z `
          margin: -15px 0 0;
          padding: 0 16px 0 16px !important;
        `,
            children: r(rm, {
                height: 280,
                icons: s,
                moreIconsLabel: "More Shapes",
                isMoreIconsButtonEnabled: !be.isNounSearchAvailable(),
                selectedIndex: u,
                scrollableRef: p,
                paginationItemRef: d,
                onClickIcon: I,
                onMoreIconsButtonClick: T
            })
        })]
    })
}
var _n, bF = k(() => {
    "use strict";
    _n = E(N());
    $e();
    sd();
    r_();
    Wt();
    jr();
    Xs();
    sm();
    Km();
    sh();
    c_();
    Le();
    B()
});

function yF(e) {
    let {
        onChange: t,
        onIconChange: o,
        panel: i,
        shapes: n
    } = e, s = (0, d_.useMemo)(() => n.length > 1, [n.length]), a = (0, d_.useMemo)(() => WY[i], [i]);
    return a ? i === "icon" ? r(a, {
        onIconChange: o
    }) : r(a, {
        shapes: n,
        isGroupSelected: s,
        onChange: t
    }) : null
}
var d_, WY, vF = k(() => {
    "use strict";
    d_ = E(N());
    Yf();
    qE();
    tF();
    nF();
    sF();
    bF();
    B();
    WY = {
        rectangle: JE,
        polygon: eF,
        line: iF,
        ellipse: rF,
        icon: gF,
        path: null
    }
});

function wF() {
    return x("svg", {
        width: "16",
        height: "16",
        viewBox: "0 0 16 16",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            d: "M15 1C15.5523 1 16 1.44772 16 2C16 2.55228 15.5523 3 15 3H1C0.447715 3 0 2.55228 0 2C0 1.44772 0.447715 1 1 1H15Z"
        }), r("path", {
            d: "M15 7C15.5523 7 16 7.44772 16 8C16 8.55228 15.5523 9 15 9H1C0.447715 9 0 8.55228 0 8C0 7.44772 0.447715 7 1 7H15Z"
        }), r("path", {
            d: "M16 14C16 13.4477 15.5523 13 15 13H1C0.447715 13 0 13.4477 0 14C0 14.5523 0.447715 15 1 15H15C15.5523 15 16 14.5523 16 14Z"
        }), r("path", {
            d: "M7 2C7 3.10457 6.10457 4 5 4C3.89543 4 3 3.10457 3 2C3 0.89543 3.89543 0 5 0C6.10457 0 7 0.89543 7 2Z"
        }), r("path", {
            d: "M7 14C7 15.1046 6.10457 16 5 16C3.89543 16 3 15.1046 3 14C3 12.8954 3.89543 12 5 12C6.10457 12 7 12.8954 7 14Z"
        }), r("path", {
            d: "M13 8C13 9.10457 12.1046 10 11 10C9.89543 10 9 9.10457 9 8C9 6.89543 9.89543 6 11 6C12.1046 6 13 6.89543 13 8Z"
        })]
    })
}
var xF = k(() => {
    "use strict";
    B()
});
var _F, SF, CF = k(() => {
    "use strict";
    Xd();
    _F = (e, t, o) => Gt.post("/api/authservice/noun/icon", {
        id: e,
        url: t
    }, o && {
        signal: o
    }), SF = async (e, t) => Gt.get(e, void 0, {
        headers: {
            "Cache-Control": "no-cache",
            "Content-Type": "image/svg+xml"
        },
        signal: t
    })
});
var kF, OY, Sn, yu = k(() => {
    "use strict";
    kF = E(Ze());
    CF();
    OY = {
        rasterize: function(e) {
            if (!e || !e.widgets || !e.mid || !e.svg || !e.viewport || !e.size || !e.size.height || !e.size.width) return;
            let {
                svg: t,
                b64url: o
            } = this.getNormalizedSvg(e.svg[0]), i = `${e.prefix?e.prefix+"_":""}b64url`, n = {
                [e.prefix ? e.prefix + "_rasterUrl" : "rasterUrl"]: "",
                [e.prefix ? e.prefix + "_raster2xUrl" : "raster2xUrl"]: "",
                [e.prefix ? e.prefix + "_raster3xUrl" : "raster3xUrl"]: ""
            };
            e.noPresave || e.widgets.forEach(function(l) {
                l.save({ ...n,
                    [i]: o
                }, {
                    skipHistory: !0,
                    silent: !0
                }), l.set(n, {
                    unset: !0,
                    skipHistory: !0,
                    silent: !0
                })
            });
            let a = {
                wids: e.widgets.map(function(l) {
                    return l.get("_id")
                }),
                checksum: e.checksum,
                svg: t,
                size: e.size,
                viewport: e.viewport,
                mid: e.mid,
                prefix: e.prefix,
                arrow: e.activeArrow,
                noSaveUrls: e.noSaveUrls,
                noUnsetUrls: e.noUnsetUrls
            };
            return kF.default.ajax({
                url: "/api/images/rasterize",
                type: "POST",
                data: a,
                success: function(l) {
                    e.noPresave || e.widgets.forEach(function(c) {
                        c.set({ ...l,
                            checksum: e.checksum
                        }, {
                            skipHistory: !0,
                            silent: !0
                        }), e.noUnsetUrls || c.unset(i, {
                            skipHistory: !0,
                            silent: !0
                        })
                    }), e.onSuccess && e.onSuccess(l)
                }.bind(this),
                error: e.onError
            })
        },
        getNormalizedSvg: function(e) {
            let t = document.importNode(e, !0),
                o = new XMLSerializer().serializeToString(t);
            return {
                svg: o,
                b64url: "data:image/svg+xml;base64," + window.btoa(unescape(encodeURIComponent(o)))
            }
        },
        async fetchSvgIcon(e, t, o) {
            return /^rm/.test(e) ? SF(t, o).then(i => ({
                svg: i,
                new_url: t
            })) : _F(e, t, o)
        }
    }, Sn = OY
});

function HY(e) {
    if (e.length === 0) return "path";
    if (e.includes("icon") && e.filter(n => n === "icon").length > 0) return "path";
    let t = {
            line: ["weight", "stroke"],
            icon: [],
            rectangle: ["border", "radius"],
            path: [],
            polygon: ["sides", "border", "radius"],
            ellipse: ["border"]
        },
        o = t[e[0]];
    for (let n = 1; n < e.length; n++) {
        let s = e[n];
        o = o.filter(a => t[s].includes(a))
    }
    return (0, IF.intersection)(Object.keys(t), e).find(n => t[n].every(s => o.includes(s)))
}

function NY() {
    let {
        model: e
    } = (0, rs.useContext)(Y), {
        model: t,
        modelSave: o
    } = (0, rs.useContext)(ge), i = (0, rs.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), {
        callback: n
    } = Je(i ? e.groupSave : o, 400);
    (0, rs.useEffect)(() => {
        e.selected && n()
    }, [e.selected, t.rm_id, t.noun_id, t.noun_url]);
    let s = (0, rs.useCallback)(h => {
            h.preventDefault(), !e.disabled && e.select()
        }, [e.disabled]),
        a = i && e.multipleSelectedModels ? e.multipleSelectedModels.map(h => h.attributes) : [t],
        l = (0, rs.useMemo)(() => !i || i && a.every(({
            tp: h
        }) => h === t.tp) ? t.tp : null, [t.tp, i]),
        c = (0, rs.useMemo)(() => i ? l === null ? HY(a.map(({
            tp: u
        }) => u)) : l : t.tp, [t.tp, l, i]),
        d = (0, rs.useCallback)(h => {
            e.groupSetAndSave(h), l !== "icon" && Ws.clearSearch()
        }, [l]),
        p = (0, rs.useCallback)(h => {
            let u = e.block,
                m = h ? .id || h ? .rm_id;
            m && u.getIconSVG(m, h.icon_url, {
                noCache: !0
            }, (f, {
                $svg: g
            }) => {
                if (!f && h.icon_url) {
                    let y = {
                        tp: "icon",
                        noun_url: h.icon_url
                    };
                    if (pt("widget.transactionalRasterize")) {
                        let {
                            b64url: S
                        } = g && g.length > 0 ? Sn.getNormalizedSvg(g[0]) : {
                            b64url: void 0
                        };
                        Object.assign(y, {
                            b64url: S,
                            rasterUrl: null,
                            raster2xUrl: null,
                            raster3xUrl: null
                        })
                    }
                    return h.id ? Object.assign(y, {
                        noun_id: h.id,
                        rm_id: null
                    }) : h.rm_id && Object.assign(y, {
                        noun_id: null,
                        rm_id: h.rm_id
                    }), d(y)
                }
            })
        }, [l]);
    return r(Ie, {
        control: ({
            ref: h
        }) => r(ke, {
            isActive: e.selected,
            ref: h,
            label: "Settings",
            onClick: s,
            children: r(wF, {})
        }),
        panel: ({
            ref: h,
            style: u
        }) => e.selected ? x(Me, {
            isShowed: !0,
            style: u,
            ref: h,
            children: [r(Ut, {
                leftSlot: "Shape",
                showBorder: !1
            }), r(ZE, {
                selectedShape: l,
                onChange: m => m === "icon" ? p(jY) : d({
                    tp: m
                })
            }), r(yF, {
                panel: c,
                onChange: d,
                onIconChange: p,
                shapes: a
            })]
        }) : null
    })
}
var rs, IF, jY, PF, TF = k(() => {
    "use strict";
    rs = E(N());
    qo();
    nt();
    gn();
    IF = E(hn());
    ae();
    Le();
    Yf();
    ht();
    XE();
    vF();
    r_();
    xF();
    En();
    yu();
    yr();
    B();
    jY = {
        rm_id: "rm18",
        icon_url: G("./constructor/blocks/shape/default-collection/18-star.svg"),
        preview_url_42: G("./constructor/blocks/shape/default-collection/18-star.svg")
    };
    PF = NY
});
var BF, MF = k(() => {
    "use strict";
    ae();
    TF();
    BF = Ce.extend({
        name: "shape_settings",
        component: PF,
        rolePermission: "ShapeCanChangeSettings",
        restrictions: function(e, t) {
            return t.length && t.every(o => o.thumb === "shape")
        }
    })
});
var RF, EF = k(() => {
    "use strict";
    no();
    RF = {
        "template-constructor-control-shape_1x1": Ae `
	<div class="icon noarrow" aria-label="Equilateral" data-alt="Equilateral" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
	</div>
`
    }
});
var FF, UY, DF, AF = k(() => {
    "use strict";
    FF = E(ze());
    $n();
    EF();
    UY = it.extend({
        name: "shape_1x1",
        rolePermission: "BaseWidgetChangeSize",
        className: "control shape_1x1",
        initialize: function(e) {
            this.template = RF["template-constructor-control-shape_1x1"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model, this.onScaleChange.__debounced = FF.default.debounce(this.onScaleChange, 100)
        },
        bindLogic: function() {
            this.model.on("change", this.onScaleChange.__debounced), this.onScaleChange()
        },
        unBindLogic: function() {
            this.model.off("change", this.onScaleChange.__debounced)
        },
        onScaleChange: function() {
            if (!this.model) return;
            let e = this.model.get("h") == this.model.get("w");
            this.$el.toggleClass("inactive", e)
        },
        onClick: function() {
            this.$el.hasClass("inactive") || (this.block.makeSquare(), this.model.save(), this.master.deselect())
        },
        restrictions: function(e) {
            let t = e.getSelectedBlocks();
            return t.length && !t[0].isFullWidth() && !t[0].isFullHeight()
        }
    }), DF = UY
});
var p_, LF = k(() => {
    "use strict";
    no();
    p_ = {
        "template-constructor-control-shape_icon": Ae `
	<div class="icon noarrow" aria-label="Shape icon" data-alt="Icon" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel">
		<div class="search-block">
			<input class="search" type="text" placeholder="Search">
			<div class="loupe">
				<div class="rmpreloader hidden"><div class="arc"></div></div>
			</div>
		</div>
		<div class="separator"></div>

		<div class="common-wrapper">
			<div class="resizable-scroll-wrapper">
				<div class="resizable-content-wrapper">
					<div class="resizable-content">

					</div>
				</div>
				<div class="resizable-scroll"></div>
			</div>

		</div>



		<div class="resize-handle-top"></div>
		<div class="resize-handle-bottom"></div>
	</div>
`,
        "template-constructor-control-shape_icon-item": Ae `
	<div class="icon-item">
		<div class="noun-icon" style="background-image: url(<%=icon.preview_url_42%>);" <%=icon.id ? 'data-id="' + icon.id + '"' : 'data-rm_id="' + icon.rm_id + '"'%> data-url="<%=icon.icon_url%>">
	</div>
`
    }
});
var am, vu, VY, zF, $F = k(() => {
    "use strict";
    am = E(Ze()), vu = E(ze());
    Bb();
    LF();
    VY = is.extend({
        name: "shape_icon",
        className: "control shape_icon",
        MIN_PANEL_HEIGHT: 264,
        MAX_PANEL_HEIGHT: 640,
        SCROLL_GAP_START: 0,
        SCROLL_GAP_END: 8,
        API_URL: "/api/authservice/noun?uri=",
        LIMIT_TO_PUBLIC_DOMAIN: !1,
        DEFAULT_COLLECTION_ID: 1335,
        saveOnDestroy: !0,
        saveOnDeselect: !0,
        events: {
            "click .icon-item": "onIconItemClick"
        },
        initialize: function(e) {
            this.template = p_["template-constructor-control-shape_icon"], this.templateItem = p_["template-constructor-control-shape_icon-item"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model
        },
        render: function() {
            is.prototype.render.apply(this, arguments), this.$result = this.$(".panel .resizable-content"), window.prevSVGSearch ? (this.nextPage = window.prevSVGSearch.nextPage, this.$(".search").val(window.prevSVGSearch.phrase), this.search_string = window.prevSVGSearch.phrase, this.drawSearchResults(window.prevSVGSearch), this.$(".loupe").addClass("clear")) : this.getDefaultCollection()
        },
        bindLogic: function() {
            this.$(".search").on("keyup", this.onSearchKeyUp), this.$(".loupe:not(.preloading)").on("click", this.onLoupeClick), this.listenTo(this.block.model, "change:tp", this.onShapeTypeChange)
        },
        unBindLogic: function() {
            this.$(".search").off("keyup", this.onSearchKeyUp), this.$(".loupe").off("click", this.onLoupeClick), this.stopListening(this.block.model)
        },
        onSearchKeyUp: function(e) {
            e.keyCode === am.default.keycodes.enter && this.doSearch()
        },
        onLoupeClick: function() {
            this.$(".loupe").hasClass("clear") ? this.clearSearch() : this.doSearch()
        },
        doSearch: function() {
            let e = this.$(".search").val().trim();
            !e || this.search_string == e || this.requestInProgress || (this.search_string = e, this.$result.empty(), delete window.prevSVGSearch, this.$(".loupe").addClass("clear"), this.nextPage = 1, this.getDataPage(this.nextPage))
        },
        clearSearch: function() {
            this.$(".loupe").removeClass("clear"), delete window.prevSVGSearch, this.$(".search").val(""), this.search_string = "", this.$result.empty(), this.getDefaultCollection()
        },
        getDataPage: function(e) {
            let t;
            !this.search_string || this.requestInProgress || (t = "/icons/" + this.search_string + "?page=" + e, this.LIMIT_TO_PUBLIC_DOMAIN && (t += "&limit_to_public_domain=1"), this.requestIcons(t, function(o, i) {
                if (o) {
                    delete this.nextPage;
                    return
                }
                window.prevSVGSearch = window.prevSVGSearch || {
                    icons: []
                }, window.prevSVGSearch.icons = window.prevSVGSearch.icons.concat(i.icons), window.prevSVGSearch.phrase = this.search_string, window.prevSVGSearch.nextPage = this.nextPage, this.drawSearchResults(i)
            }.bind(this)))
        },
        requestIcons: function(e, t) {
            this.searchXhr && this.searchXhr.abort(), this.searchInProgress = !0, this.showSearchPreloader(), this.searchXhr = am.default.ajax({
                method: "GET",
                url: this.API_URL + encodeURIComponent(e),
                dataType: "json",
                success: function(o) {
                    t(null, o)
                },
                error: function(o) {
                    t(o)
                },
                complete: function() {
                    this.searchInProgress = !1, this.hideSearchPreloader()
                },
                context: this
            })
        },
        getDefaultCollection: function() {
            this.drawSearchResults(this.defaultCollection)
        },
        drawSearchResults: function(e) {
            if (!(vu.default.isArray(e.icons) && e.icons.length)) {
                delete this.nextPage;
                return
            }
            vu.default.each(e.icons, function(t) {
                this.$result.append(this.templateItem({
                    icon: t
                }))
            }.bind(this)), this.__scrollRecalc_debounced()
        },
        select: function() {
            is.prototype.select.apply(this, arguments), vu.default.delay(function() {
                this.$(".search").focus().select()
            }.bind(this), 400)
        },
        save: function() {
            this.model.save(), is.prototype.save.apply(this, arguments)
        },
        onIconItemClick: function(e) {
            let t = (0, am.default)(e.currentTarget),
                o = t.find(".noun-icon"),
                i = o.attr("data-id"),
                n = o.attr("data-rm_id"),
                s = o.attr("data-url");
            this.$(".resizable-content").hasClass("preloading") || (this.hideIconPreloader(), this.showIconPreloader(t), this.block.getIconSVG(i || n, s, function(a) {
                let l;
                this.hideIconPreloader(), !a && (this.$(".icon-item").removeClass("selected"), t.addClass("selected"), l = {
                    noun_url: s
                }, i ? vu.default.extend(l, {
                    noun_id: i,
                    rm_id: null
                }) : n && vu.default.extend(l, {
                    noun_id: null,
                    rm_id: n
                }), this.block.model.set(l))
            }.bind(this)))
        },
        onPanelScroll: function(e) {
            this.selected && e.content_size - e.container_size - e.scroll_pos < 32 && this.nextPage && !this.searchInProgress && this.getDataPage(++this.nextPage)
        },
        abortRequests: function() {
            this.searchXhr && this.searchXhr.abort(), this.searchInProgress = !1
        },
        onShapeTypeChange: function() {
            this.block.model.get("tp") !== "icon" && this.abortRequests()
        },
        showSearchPreloader: function() {
            this.$(".loupe").addClass("preloading")
        },
        hideSearchPreloader: function() {
            this.$(".loupe").removeClass("preloading")
        },
        showIconPreloader: function(e) {
            e.append((0, am.default)('<div class="rmpreloader"><div class="arc"></div></div>')), this.$(".resizable-content").add(e).addClass("preloading")
        },
        hideIconPreloader: function() {
            this.$(".resizable-content").find(".rmpreloader").remove(), this.$(".resizable-content").add(this.$(".icon-item")).removeClass("preloading")
        },
        destroy: function() {
            this.abortRequests(), is.prototype.destroy.apply(this, arguments)
        }
    }), zF = VY
});
var WF, OF = k(() => {
    "use strict";
    no();
    WF = {
        "template-constructor-control-gmaps_edit": Ae `
	<div class="icon noarrow" aria-label="Edit map" data-alt="Edit map" data-alt-pos="left" data-alt-offset="9"></div>
`
    }
});
var GY, jF, HF = k(() => {
    "use strict";
    $n();
    OF();
    GY = it.extend({
        name: "gmaps_edit",
        className: "control gmaps_edit",
        saveOnDeselect: !0,
        saveOnDestroy: !0,
        initialize: function(e) {
            this.template = WF["template-constructor-control-gmaps_edit"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model
        },
        select: function() {
            it.prototype.select.apply(this, arguments), this.block.enterEditState(), this.$(".icon").addClass("edit")
        },
        deselect: function() {
            this.block.exitEditState(), it.prototype.deselect.apply(this, arguments), this.$(".icon").removeClass("edit")
        },
        bindLogic: function() {
            this.block.on("editMapClick", this.onClick)
        },
        unBindLogic: function() {
            this.block.off("editMapClick", this.onClick)
        },
        save: function() {
            this.model.save({})
        }
    }), jF = GY
});

function eZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "control-icon.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var YY, ZY, XY, KY, JY, qY, QY, tZ, NF, UF = k(() => {
    "use strict";
    YY = {
        props: {
            selected: !1,
            alt: null,
            iconClass: null
        }
    }, ZY = function() {
        var e, t = this,
            o = t.$createElement,
            i = t._self._c || o;
        return i("div", {
            staticClass: "icon preloader noarrow",
            class: (e = {}, e[t.iconClass] = !!t.iconClass, e["rmalttext-disable"] = t.selected, e),
            attrs: {
                "data-alt": t.alt,
                "data-alt-pos": "left",
                "data-alt-offset": "9"
            }
        })
    }, XY = [], KY = void 0, JY = void 0, qY = void 0, QY = !1;
    tZ = eZ({
        render: ZY,
        staticRenderFns: XY
    }, KY, YY, JY, QY, qY, !1, void 0, void 0, void 0), NF = tZ
});

function aZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var VF, Fb, oZ, iZ, nZ, rZ, sZ, lZ, Mi, na = k(() => {
    "use strict";
    VF = E(Ze()), Fb = E(ze()), oZ = {
        props: {
            block: Object,
            raw_block: Object
        },
        data: function() {
            return {
                m: {}
            }
        },
        computed: {
            Globals: function() {
                return window
            }
        },
        watch: {
            block: {
                handler: function(e) {
                    this.assignBlockState(e)
                },
                deep: !0
            }
        },
        created: function() {
            this.assignBlockState(this.block)
        },
        mounted: function() {
            this.$watch("m", e => {
                this.$parent.$emit("change", e)
            }, {
                deep: !0
            })
        },
        methods: {
            $: function(e) {
                return (0, VF.default)(this.$el.querySelector(e))
            },
            assignBlockState: function(e) {
                Fb.default.each(e, (t, o) => this.$set(this.m, o, t))
            },
            canClose: function() {
                var e = !0;
                return Fb.default.each(this.$children, function(t) {
                    e = !t.visibleBox && e, t.visibleBox = !1
                }), e
            },
            closeOthersPopups: function(e) {
                e && Fb.default.each(this.$children, function(t) {
                    t != e && (t.visibleBox = !1)
                })
            },
            hide: function() {
                this.$parent.deselect()
            }
        }
    }, iZ = void 0, nZ = void 0, rZ = void 0, sZ = void 0;
    lZ = aZ({}, iZ, oZ, nZ, sZ, rZ, !1, void 0, void 0, void 0), Mi = lZ
});
var GF = k(() => {});

function gZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "rm-variant-input.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var cZ, dZ, pZ, uZ, hZ, mZ, fZ, bZ, Db, u_ = k(() => {
    "use strict";
    GF();
    cZ = {
        props: {
            data: {
                type: Object
            }
        },
        data: function() {
            return {
                url: ""
            }
        },
        ounted: function() {
            this.url = this.updateUrl()
        },
        methods: {
            updateUrl: function() {
                return this.data.use_own_url === "page" ? "Using the page URL" : this.data.use_own_url === "mag" ? "Using the project URL" : this.data.url
            },
            updateUrlData: function(e, t) {
                this.data.url = e, this.data.use_own_url = t, this.url = this.updateUrl()
            }
        }
    }, dZ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "variant-input"
        }, [o("input", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.url,
                expression: "url"
            }],
            staticClass: "input tweet-url",
            attrs: {
                readonly: !!e.data.use_own_url,
                placeholder: "URL"
            },
            domProps: {
                value: e.url
            },
            on: {
                input: function(i) {
                    i.target.composing || (e.url = i.target.value)
                }
            }
        }), e._v(" "), e.data.use_own_url || e.data.url && e.data.url === e.url ? o("div", {
            staticClass: "input-control clear",
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.updateUrlData("", "")
                }
            }
        }) : !e.data.use_own_url && !e.data.url && !e.url ? o("div", {
            staticClass: "input-control target"
        }, [o("div", {
            staticClass: "use-url-popup"
        }, [o("ul", [o("li", {
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.updateUrlData("", "mag")
                }
            }
        }, [e._v("Using the project URL")]), e._v(" "), o("li", {
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.updateUrlData("", "page")
                }
            }
        }, [e._v("Using the page URL")])]), e._v(" "), e._m(0), e._v(" "), o("div", {
            staticClass: "hover-zone"
        })])]) : e.url !== e.data.url ? o("div", {
            staticClass: "input-control apply",
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.updateUrlData(e.url, "")
                }
            }
        }) : e._e()])
    }, pZ = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "corner-wrapper"
        }, [o("div", {
            staticClass: "corner"
        })])
    }], uZ = void 0, hZ = void 0, mZ = void 0, fZ = !1;
    bZ = gZ({
        render: dZ,
        staticRenderFns: pZ
    }, uZ, cZ, hZ, fZ, mZ, !1, void 0, void 0, void 0), Db = bZ
});
var YF = k(() => {});

function kZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "rm-switcher.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var h_, yZ, vZ, wZ, xZ, _Z, SZ, CZ, IZ, Ra, wu = k(() => {
    "use strict";
    h_ = E(mj());
    YF();
    yZ = {
        model: {
            event: "stateChange"
        },
        props: {
            value: {},
            isDisabled: {
                type: Boolean,
                default: !1
            },
            width: {
                type: Number,
                default: 37
            },
            height: {
                type: Number,
                default: 20
            },
            shadow: {
                default: "none"
            },
            colorOn: {
                default: "rgb(40, 40, 40)"
            },
            colorOff: {
                default: "rgb(184, 184, 184)"
            },
            textOn: {
                default: ""
            },
            textOff: {
                default: ""
            },
            textSizeOn: {
                default: 12
            },
            textSizeOff: {
                default: 12
            },
            textColorOn: {
                default: "#fff"
            },
            textColorOff: {
                default: "#fff"
            },
            handleColor: {
                default: "#fff"
            },
            handleShadow: {
                default: "none"
            },
            handleSpace: {
                default: 1
            },
            callback: {
                type: Function,
                default: () => {}
            }
        },
        data: function() {
            return {
                internalState: !1,
                bodyColorStyle: null,
                panelPosStyle: null,
                panelBackOpacity: null
            }
        },
        computed: {
            handleSize: function() {
                return this.height - this.handleSpace * 2
            },
            bodyStyle: function() {
                return {
                    width: this.width + "px",
                    height: this.height + "px",
                    "box-shadow": this.shadow,
                    "border-radius": Math.floor(this.height / 2) + "px",
                    opacity: this.isDisabled ? .5 : 1,
                    cursor: this.isDisabled ? "default" : "pointer"
                }
            },
            fullWidth: function() {
                return (this.width - this.handleSize - this.handleSpace) * 2 + this.handleSize
            },
            textWidth: function() {
                return Math.round(this.width * .75 - 8 - 8)
            },
            shiftWidth: function() {
                return this.width - this.fullWidth
            },
            panelStyle: function() {
                return {
                    width: this.fullWidth + "px",
                    height: this.height + "px"
                }
            },
            textStyle: function() {
                return {
                    width: this.textWidth + "px",
                    "line-height": this.height + "px"
                }
            },
            textOffStyle: function() {
                return {
                    "font-size": this.textSizeOn + "px",
                    color: this.textColorOn
                }
            },
            textOnStyle: function() {
                return {
                    "font-size": this.textSizeOff + "px",
                    color: this.textColorOff
                }
            },
            handleStyle: function() {
                return {
                    "margin-left": "-" + Math.floor(this.handleSize / 2) + "px",
                    width: this.handleSize + "px",
                    height: this.handleSize + "px",
                    "border-radius": Math.floor(this.handleSize / 2) + "px",
                    "box-shadow": this.handleShadow,
                    background: this.handleColor,
                    top: this.handleSpace + "px"
                }
            }
        },
        watch: {
            internalState: function(e) {
                clearInterval(this.timer), this.timer = setInterval(function() {
                    this.oneStepSwitcherPos(e)
                }.bind(this), 20), this.$emit("stateChange", e)
            },
            value: function(e) {
                this.internalState = e
            }
        },
        created: function() {
            this.internalState = this.value
        },
        mounted: function() {
            this.updateSwitcher()
        },
        methods: {
            setSwitcherPos: function(e) {
                this.cur_state = e, this.bodyColorStyle = {
                    "background-color": this.colorTransform(this.colorOn, this.colorOff, e)
                }, this.panelPosStyle = {
                    left: Math.round(this.shiftWidth * e) + "px"
                }, this.panelBackOpacityStyle = {
                    opacity: (1 - e).toFixed(2)
                }
            },
            updateSwitcher: function() {
                this.setSwitcherPos(this.internalState ? 0 : this.internalState === void 0 ? .5 : 1)
            },
            colorTransform: function(e, t, o) {
                let i = (0, h_.parseCSSColor)(e),
                    n = (0, h_.parseCSSColor)(t);
                return `rgba(${Math.max(Math.min(parseInt(o*(n[0]-i[0])+i[0],10),255),0)},${Math.max(Math.min(parseInt(o*(n[1]-i[1])+i[1],10),255),0)},${Math.max(Math.min(parseInt(o*(n[2]-i[2])+i[2],10),255),0)},${Math.max(Math.min(parseFloat(o*(n[3]-i[3])+i[3],10),1),0)})`
            },
            oneStepSwitcherPos: function(e) {
                if (e === void 0) return clearInterval(this.timer), this.setSwitcherPos(.5);
                let t = e ? 0 : 1,
                    o = t < this.internalState ? -1 : 1,
                    i = Math.max(Math.min(this.cur_state + .1 * o, 1), 0);
                (o > 0 && i >= t || o < 0 && i <= t) && (i = t, clearInterval(this.timer)), this.setSwitcherPos(i)
            },
            clickHanlder() {
                if (this.isDisabled) return !1;
                this.internalState = !this.internalState, this.callback(this.internalState)
            },
            disableFromOutside() {
                this.isDisabled = !0
            }
        }
    }, vZ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "rm-switcher",
            attrs: {
                "data-state": e.internalState ? "on" : "off"
            }
        }, [o("div", {
            staticClass: "rmswitcher-body",
            style: [e.bodyStyle, e.bodyColorStyle]
        }, [o("div", {
            ref: "panelBack",
            staticClass: "rmswitcher-panel-back"
        }), e._v(" "), o("div", {
            staticClass: "rmswitcher-panel",
            style: [e.panelStyle, e.panelPosStyle],
            on: {
                click: e.clickHanlder
            }
        }, [o("div", {
            staticClass: "rmswitcher-panel-on",
            style: [e.textStyle, e.textOnStyle]
        }, [e._v(e._s(e.textOff))]), e._v(" "), o("div", {
            staticClass: "rmswitcher-panel-off",
            style: [e.textStyle, e.textOffStyle]
        }, [e._v(e._s(e.textOn))]), e._v(" "), o("div", {
            staticClass: "rmswitcher-panel-slider",
            style: e.handleStyle
        })])])])
    }, wZ = [], xZ = void 0, _Z = void 0, SZ = void 0, CZ = !1;
    IZ = kZ({
        render: vZ,
        staticRenderFns: wZ
    }, xZ, yZ, _Z, CZ, SZ, !1, void 0, void 0, void 0), Ra = IZ
});
var ZF = k(() => {});

function DZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "rm-select.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var XF, PZ, TZ, BZ, MZ, RZ, EZ, FZ, AZ, Ea, xu = k(() => {
    "use strict";
    XF = E(ze());
    ZF();
    PZ = {
        props: {
            value: {},
            options: {
                type: Array,
                default: () => []
            },
            arrowSize: {
                default: "small"
            },
            showTitles: {
                type: Boolean,
                default: !1
            },
            callback: {
                type: Function,
                default: () => {}
            }
        },
        data: function() {
            return {
                isOpened: !1
            }
        },
        computed: {
            caption: function() {
                return (XF.default.findWhere(this.options, {
                    value: this.value
                }) || {}).caption
            }
        },
        methods: {
            onClick: function() {
                this.isOpened = !this.isOpened
            },
            emitValue: function(e) {
                e.disabled || (this.$emit("input", e.value), this.callback(e))
            }
        }
    }, TZ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "selector",
            class: {
                opened: e.isOpened
            },
            on: {
                click: e.onClick
            }
        }, [o("div", {
            staticClass: "types-popup"
        }, e._l(e.options, function(i) {
            return o("div", {
                key: i.value,
                staticClass: "type-item",
                class: {
                    curr: i.value === e.value, disabled: !!i.disabled
                },
                attrs: {
                    title: e.showTitles ? i.caption : ""
                },
                on: {
                    click: function(n) {
                        return e.emitValue(i)
                    }
                }
            }, [e._t("listitem", [e._v(`
        ` + e._s(i.caption) + `
        `), o("div", {
                staticClass: "point"
            })], {
                option: i,
                value: e.value
            })], 2)
        }), 0), e._v(" "), o("div", {
            staticClass: "caption"
        }, [o("div", {
            staticClass: "caption-inner"
        }, [e._v(e._s(e.caption))])]), e._v(" "), this.arrowSize === "small" ? o("div", {
            staticClass: "popup-arrow"
        }) : e._e(), e._v(" "), this.arrowSize === "big" ? o("div", {
            staticClass: "popup-arrow-big"
        }, [o("svg", {
            attrs: {
                width: "12",
                height: "7",
                xmlns: "http://www.w3.org/2000/svg"
            }
        }, [o("path", {
            attrs: {
                d: "M5.24 6.114L1.416 1.651A1 1 0 0 1 2.175 0h7.65a1 1 0 0 1 .76 1.65L6.759 6.115a1 1 0 0 1-1.518 0z",
                "fill-rule": "evenodd"
            }
        })])]) : e._e()])
    }, BZ = [], MZ = void 0, RZ = "data-v-55ada3cc", EZ = void 0, FZ = !1;
    AZ = DZ({
        render: TZ,
        staticRenderFns: BZ
    }, MZ, PZ, RZ, FZ, EZ, !1, void 0, void 0, void 0), Ea = AZ
});
var KF = k(() => {});

function NZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "rm-apply-input.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var LZ, zZ, $Z, WZ, OZ, jZ, HZ, UZ, Ab, m_ = k(() => {
    "use strict";
    KF();
    LZ = {
        props: {
            value: {
                type: String
            },
            prefix: {
                type: String,
                default: ""
            }
        },
        data: function() {
            return {
                text: ""
            }
        },
        mounted: function() {
            this.text = this.value
        }
    }, zZ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "apply-input"
        }, [o("input", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.text,
                expression: "text"
            }],
            staticClass: "input",
            class: {
                "no-prefix": !e.prefix
            },
            attrs: {
                placeholder: "Username"
            },
            domProps: {
                value: e.text
            },
            on: {
                input: function(i) {
                    i.target.composing || (e.text = i.target.value)
                }
            }
        }), e._v(" "), o("div", {
            staticClass: "input-prefix"
        }, [e._v(e._s(e.prefix))]), e._v(" "), e.value != e.text ? o("div", {
            staticClass: "input-control apply",
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.$emit("input", e.text)
                }
            }
        }) : e.value ? o("div", {
            staticClass: "input-control clear",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.$emit("input", ""), e.text = ""
                }
            }
        }) : e._e()])
    }, $Z = [], WZ = void 0, OZ = void 0, jZ = void 0, HZ = !1;
    UZ = NZ({
        render: zZ,
        staticRenderFns: $Z
    }, WZ, LZ, OZ, HZ, jZ, !1, void 0, void 0, void 0), Ab = UZ
});

function qZ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-twitter-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var VZ, GZ, YZ, ZZ, XZ, KZ, JZ, QZ, JF, qF = k(() => {
    "use strict";
    na();
    u_();
    wu();
    xu();
    m_();
    VZ = {
        components: {
            RmVariantInput: Db,
            RmSwitcher: Ra,
            RmSelect: Ea,
            RmApplyInput: Ab
        },
        mixins: [Mi]
    }, GZ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel"
        }, [o("div", {
            staticClass: "panel-title"
        }, [e._v("Twitter")]), e._v(" "), o("rm-select", {
            attrs: {
                options: [{
                    value: "type_timeline",
                    caption: "User Timeline"
                }, {
                    value: "type_embed",
                    caption: "Embed Tweet"
                }, {
                    value: "type_tweet",
                    caption: "Tweet Button"
                }, {
                    value: "type_follow",
                    caption: "Follow Button"
                }, {
                    value: "type_hashtag",
                    caption: "Hashtag Button"
                }]
            },
            model: {
                value: e.m.current_type,
                callback: function(i) {
                    e.$set(e.m, "current_type", i)
                },
                expression: "m.current_type"
            }
        }), e._v(" "), e.m.current_type == "type_timeline" ? o("div", [o("textarea", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.m.type_timeline.code,
                expression: "m.type_timeline.code"
            }],
            staticClass: "textarea",
            attrs: {
                placeholder: "Paste embed code here"
            },
            domProps: {
                value: e.m.type_timeline.code
            },
            on: {
                input: function(i) {
                    i.target.composing || e.$set(e.m.type_timeline, "code", i.target.value)
                }
            }
        }), e._v(" "), e._m(0)]) : e._e(), e._v(" "), e.m.current_type == "type_embed" ? o("div", [o("textarea", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.m.type_embed.code,
                expression: "m.type_embed.code"
            }],
            staticClass: "textarea",
            attrs: {
                placeholder: "Paste embed code here"
            },
            domProps: {
                value: e.m.type_embed.code
            },
            on: {
                input: function(i) {
                    i.target.composing || e.$set(e.m.type_embed, "code", i.target.value)
                }
            }
        }), e._v(" "), e._m(1)]) : e._e(), e._v(" "), e.m.current_type == "type_tweet" ? o("div", [o("div", {
            staticClass: "input-wrapper"
        }, [o("rm-variant-input", {
            attrs: {
                data: e.m.type_tweet
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "sep-line"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Large button")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#3366cc",
                "color-off": "rgba(75, 75, 75, 0.4)"
            },
            model: {
                value: e.m.type_tweet.large_button,
                callback: function(i) {
                    e.$set(e.m.type_tweet, "large_button", i)
                },
                expression: "m.type_tweet.large_button"
            }
        })], 1)]) : e._e(), e._v(" "), e.m.current_type == "type_follow" ? o("div", [o("div", {
            staticClass: "input-wrapper"
        }, [o("rm-apply-input", {
            attrs: {
                prefix: "@"
            },
            model: {
                value: e.m.type_follow.username,
                callback: function(i) {
                    e.$set(e.m.type_follow, "username", i)
                },
                expression: "m.type_follow.username"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "sep-line"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Show name")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#3366cc",
                "color-off": "rgba(75, 75, 75, 0.4)"
            },
            model: {
                value: e.m.type_follow.show_name,
                callback: function(i) {
                    e.$set(e.m.type_follow, "show_name", i)
                },
                expression: "m.type_follow.show_name"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Large button")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#3366cc",
                "color-off": "rgba(75, 75, 75, 0.4)"
            },
            model: {
                value: e.m.type_follow.large_button,
                callback: function(i) {
                    e.$set(e.m.type_follow, "large_button", i)
                },
                expression: "m.type_follow.large_button"
            }
        })], 1)]) : e._e(), e._v(" "), e.m.current_type == "type_hashtag" ? o("div", [o("div", {
            staticClass: "input-wrapper"
        }, [o("rm-apply-input", {
            attrs: {
                prefix: "#"
            },
            model: {
                value: e.m.type_hashtag.hash,
                callback: function(i) {
                    e.$set(e.m.type_hashtag, "hash", i)
                },
                expression: "m.type_hashtag.hash"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "sep-line"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Large button")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#3366cc",
                "color-off": "rgba(75, 75, 75, 0.4)"
            },
            model: {
                value: e.m.type_hashtag.large_button,
                callback: function(i) {
                    e.$set(e.m.type_hashtag, "large_button", i)
                },
                expression: "m.type_hashtag.large_button"
            }
        })], 1)]) : e._e()], 1)
    }, YZ = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "center"
        }, [o("a", {
            staticClass: "embed-tutorial",
            attrs: {
                target: "_blank",
                href: "https://dev.twitter.com/docs/embedded-timelines"
            }
        }, [e._v("How to embed Timeline")])])
    }, function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "center"
        }, [o("a", {
            staticClass: "embed-tutorial",
            attrs: {
                target: "_blank",
                href: "https://dev.twitter.com/docs/embedded-tweets"
            }
        }, [e._v("How to embed Tweet")])])
    }], ZZ = void 0, XZ = void 0, KZ = void 0, JZ = !1;
    QZ = qZ({
        render: GZ,
        staticRenderFns: YZ
    }, ZZ, VZ, XZ, JZ, KZ, !1, void 0, void 0, void 0), JF = QZ
});
var QF = k(() => {});

function aX(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "rm-spinner.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var eD, tD, eX, tX, oX, iX, nX, rX, sX, lX, oD, iD = k(() => {
    "use strict";
    eD = E(Ze()), tD = E(ze());
    QF();
    eX = {
        model: {
            event: "change"
        },
        props: {
            value: "",
            variants: {
                type: Array,
                default: () => []
            },
            hideControls: {
                type: Boolean,
                default: !1
            }
        },
        methods: {
            spinType: function(e) {
                let t = this,
                    o = 0;
                tD.default.each(this.variants, function(i, n) {
                    i.value === t.value && (o = n)
                }), o += e, o = o < 0 ? o + this.variants.length : o % this.variants.length, (0, eD.default)(this.$el).toggleClass("negative", e < 0), this.$emit("change", this.variants[o].value)
            }
        }
    }, tX = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "spinner"
        }, [o("transition", {
            attrs: {
                name: "fade"
            }
        }, [e._l(e.variants, function(i, n) {
            return [i.value === e.value ? o("div", {
                key: n,
                staticClass: "spin-title",
                class: {
                    clickable: e.hideControls
                },
                on: {
                    click: function(s) {
                        return s.stopPropagation(), e.spinType(1)
                    }
                }
            }, [e._v(`
        ` + e._s(i.title) + `
      `)]) : e._e()]
        })], 2), e._v(" "), e.hideControls ? e._e() : o("div", {
            staticClass: "spin left",
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.spinType(-1)
                }
            }
        }), e._v(" "), e.hideControls ? e._e() : o("div", {
            staticClass: "spin right",
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.spinType(1)
                }
            }
        })], 1)
    }, oX = [], iX = void 0, nX = void 0, rX = void 0, sX = !1;
    lX = aX({
        render: tX,
        staticRenderFns: oX
    }, iX, eX, nX, sX, rX, !1, void 0, void 0, void 0), oD = lX
});

function gX(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-facebook-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var cX, dX, pX, uX, hX, mX, fX, bX, nD, rD = k(() => {
    "use strict";
    na();
    u_();
    wu();
    iD();
    xu();
    m_();
    dd();
    cX = {
        components: {
            RmVariantInput: Db,
            RmSwitcher: Ra,
            RmSpinner: oD,
            RmSelect: Ea,
            RmApplyInput: Ab,
            NumericInput: Es
        },
        mixins: [Mi]
    }, dX = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel"
        }, [o("div", {
            staticClass: "panel-title"
        }, [e._v("Facebook")]), e._v(" "), o("rm-select", {
            attrs: {
                options: [{
                    value: "type_like_button",
                    caption: "Like Button"
                }, {
                    value: "type_page",
                    caption: "Page"
                }, {
                    value: "type_comments",
                    caption: "Comments"
                }]
            },
            model: {
                value: e.m.current_type,
                callback: function(i) {
                    e.$set(e.m, "current_type", i)
                },
                expression: "m.current_type"
            }
        }), e._v(" "), e.m.current_type == "type_like_button" ? o("div", [o("div", {
            staticClass: "input-wrapper"
        }, [o("rm-variant-input", {
            attrs: {
                data: e.m.type_like_button
            }
        })], 1), e._v(" "), o("div", [o("rm-spinner", {
            attrs: {
                variants: [{
                    value: "standard",
                    title: "Standard Layout"
                }, {
                    value: "button_count",
                    title: "Button Count"
                }, {
                    value: "box_count",
                    title: "Box Count"
                }]
            },
            model: {
                value: e.m.type_like_button.layout,
                callback: function(i) {
                    e.$set(e.m.type_like_button, "layout", i)
                },
                expression: "m.type_like_button.layout"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "sep-line"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Share Button")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#2d90ff",
                "color-off": "#313131"
            },
            model: {
                value: e.m.type_like_button.share_button,
                callback: function(i) {
                    e.$set(e.m.type_like_button, "share_button", i)
                },
                expression: "m.type_like_button.share_button"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Show Faces")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#2d90ff",
                "color-off": "#313131"
            },
            model: {
                value: e.m.type_like_button.show_faces,
                callback: function(i) {
                    e.$set(e.m.type_like_button, "show_faces", i)
                },
                expression: "m.type_like_button.show_faces"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Color")]), e._v(" "), o("div", {
            staticClass: "theme-picker",
            class: e.m.type_like_button.theme
        }, [o("div", {
            staticClass: "theme light",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.m.type_like_button.theme = "light"
                }
            }
        }), e._v(" "), o("div", {
            staticClass: "theme dark",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.m.type_like_button.theme = "dark"
                }
            }
        })])])]) : e._e(), e._v(" "), e.m.current_type == "type_page" ? o("div", [o("div", {
            staticClass: "input-wrapper"
        }, [o("rm-apply-input", {
            model: {
                value: e.m.type_page.url,
                callback: function(i) {
                    e.$set(e.m.type_page, "url", i)
                },
                expression: "m.type_page.url"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "sep-line"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Show Stream")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#2d90ff",
                "color-off": "#313131"
            },
            model: {
                value: e.m.type_page.show_stream,
                callback: function(i) {
                    e.$set(e.m.type_page, "show_stream", i)
                },
                expression: "m.type_page.show_stream"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Small Header")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#2d90ff",
                "color-off": "#313131"
            },
            model: {
                value: e.m.type_page.small_header,
                callback: function(i) {
                    e.$set(e.m.type_page, "small_header", i)
                },
                expression: "m.type_page.small_header"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Show Faces")]), e._v(" "), o("rm-switcher", {
            attrs: {
                "color-on": "#2d90ff",
                "color-off": "#313131"
            },
            model: {
                value: e.m.type_page.show_faces,
                callback: function(i) {
                    e.$set(e.m.type_page, "show_faces", i)
                },
                expression: "m.type_page.show_faces"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Color")]), e._v(" "), o("div", {
            staticClass: "theme-picker",
            class: e.m.type_page.theme
        }, [o("div", {
            staticClass: "theme light",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.m.type_page.theme = "light"
                }
            }
        }), e._v(" "), o("div", {
            staticClass: "theme dark",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.m.type_page.theme = "dark"
                }
            }
        })])])]) : e._e(), e._v(" "), e.m.current_type == "type_comments" ? o("div", [o("div", {
            staticClass: "input-wrapper"
        }, [o("rm-variant-input", {
            attrs: {
                data: e.m.type_comments
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "sep-line"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Number of posts")]), e._v(" "), o("numeric-input", {
            attrs: {
                autosize: !0,
                min: 1,
                max: 99,
                "label-selector": ".caption"
            },
            model: {
                value: e.m.type_comments.num_posts,
                callback: function(i) {
                    e.$set(e.m.type_comments, "num_posts", i)
                },
                expression: "m.type_comments.num_posts"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Color")]), e._v(" "), o("div", {
            staticClass: "theme-picker",
            class: e.m.type_comments.theme
        }, [o("div", {
            staticClass: "theme light",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.m.type_comments.theme = "light"
                }
            }
        }), e._v(" "), o("div", {
            staticClass: "theme dark",
            on: {
                click: function(i) {
                    i.stopPropagation(), e.m.type_comments.theme = "dark"
                }
            }
        })])])]) : e._e()], 1)
    }, pX = [], uX = void 0, hX = void 0, mX = void 0, fX = !1;
    bX = gX({
        render: dX,
        staticRenderFns: pX
    }, uX, cX, hX, fX, mX, !1, void 0, void 0, void 0), nD = bX
});

function kX(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-gmaps-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var f_, yX, vX, wX, xX, _X, SX, CX, IX, sD, aD = k(() => {
    "use strict";
    f_ = E(ze());
    na();
    wu();
    xu();
    yX = {
        components: {
            RmSwitcher: Ra,
            RmSelect: Ea
        },
        mixins: [Mi],
        data: function() {
            return {
                m: {
                    direction_route_type: "driving",
                    custom_json: "",
                    api_key: "",
                    scrollwheel: !0
                },
                mapTypes: [{
                    value: "standard",
                    caption: "Standard"
                }, {
                    value: "directions",
                    caption: "Directions"
                }, {
                    value: "custom",
                    caption: "Custom map"
                }],
                directions: [{
                    value: "driving",
                    icon: "car"
                }, {
                    value: "transit",
                    icon: "train"
                }, {
                    value: "walking",
                    icon: "walk"
                }, {
                    value: "bicycling",
                    icon: "bicycle"
                }],
                custom_json: "",
                api_key: "",
                is_json_invalid: !1
            }
        },
        mounted: function() {
            this.custom_json = this.m.custom_json, this.api_key = this.m.api_key
        },
        methods: {
            validateJSON: function(e) {
                try {
                    JSON.parse(e)
                } catch {
                    return !1
                }
                return !0
            },
            validateApiKey: function(e) {
                if (e) return e.length === 39
            },
            onRemove: function() {
                this.api_key = "", this.m.api_key = ""
            }
        },
        watch: {
            custom_json: f_.default.debounce(function(e) {
                !e || this.validateJSON(e) ? (this.m.custom_json = e, this.is_json_invalid = !1) : this.is_json_invalid = !0
            }, 500),
            api_key: f_.default.debounce(function(e) {
                (!e || this.validateApiKey(e)) && (this.m.api_key = e)
            }, 500),
            "m.api_key": function() {
                this.api_key = this.m.api_key
            }
        }
    }, vX = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel"
        }, [o("div", {
            staticClass: "param-caption"
        }, [e._v("Google Maps")]), e._v(" "), o("div", {
            staticClass: "param",
            attrs: {
                "data-param": "code"
            }
        }, [!e.m.api_key || !e.validateApiKey(e.m.api_key) ? o("div", [o("input", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.api_key,
                expression: "api_key"
            }],
            staticClass: "input",
            class: [{
                error: e.api_key && !e.validateApiKey(e.api_key)
            }],
            attrs: {
                placeholder: "API Key",
                minlength: "39",
                maxlength: "39",
                required: ""
            },
            domProps: {
                value: e.api_key
            },
            on: {
                input: function(i) {
                    i.target.composing || (e.api_key = i.target.value)
                }
            }
        })]) : e._e(), e._v(" "), e.m.api_key && e.validateApiKey(e.m.api_key) ? o("div", {
            staticClass: "gmap-api-enabled"
        }, [o("span", [e._v("API Key Enabled")]), e._v(" "), o("div", {
            ref: "remove",
            staticClass: "remove map-icon",
            attrs: {
                "data-alt": "Delete Google Maps API Key " + e.m.api_key,
                "data-alt-style": "controls-gmap-icon-tooltip"
            },
            on: {
                click: e.onRemove
            }
        }, [o("svg", {
            attrs: {
                width: "24",
                height: "24",
                xmlns: "http://www.w3.org/2000/svg"
            }
        }, [o("g", {
            attrs: {
                fill: "none",
                "fill-rule": "evenodd"
            }
        }, [o("circle", {
            attrs: {
                cx: "12",
                cy: "12",
                r: "12"
            }
        }), e._v(" "), o("path", {
            attrs: {
                d: "M12 10.586l4.536-4.536a1 1 0 0 1 1.414 1.414L13.414 12l4.536 4.536a1 1 0 0 1-1.414 1.414L12 13.414 7.464 17.95a1 1 0 0 1-1.414-1.414L10.586 12 6.05 7.464A1 1 0 0 1 7.464 6.05L12 10.586z",
                "fill-rule": "nonzero"
            }
        })])])]), e._v(" "), o("a", {
            ref: "question-enabled",
            staticClass: "question map-icon",
            attrs: {
                href: "https://help.readymag.com/hc/en-us/articles/360020526932-Google-Maps",
                rel: "noreferrer noopener",
                target: "_blank",
                "data-alt-style": "controls-gmap-icon-tooltip"
            }
        }, [o("svg", {
            attrs: {
                width: "24",
                height: "24",
                xmlns: "http://www.w3.org/2000/svg"
            }
        }, [o("g", {
            attrs: {
                fill: "none",
                "fill-rule": "evenodd"
            }
        }, [o("circle", {
            attrs: {
                cx: "12",
                cy: "12",
                r: "12"
            }
        }), e._v(" "), o("path", {
            attrs: {
                d: "M8 9.259C8.06 7.371 9.294 6 11.542 6 13.615 6 15 7.259 15 9.02c0 1.219-.575 2.072-1.604 2.717-.992.614-1.272 1.02-1.272 1.809V14H10.37l-.008-.542c-.068-1.195.37-1.912 1.415-2.558.939-.597 1.256-1.02 1.256-1.808 0-.83-.635-1.427-1.589-1.427-.976 0-1.604.622-1.665 1.594H8zM11.5 18c-.904 0-1.5-.592-1.5-1.495 0-.913.596-1.505 1.5-1.505.922 0 1.5.592 1.5 1.505 0 .903-.578 1.495-1.5 1.495z"
            }
        })])])])]) : e._e(), e._v(" "), !e.m.api_key && !e.api_key ? o("a", {
            ref: "question-disabled",
            staticClass: "question map-icon",
            attrs: {
                href: "http://help.readymag.com/hc/en-us/articles/360020526932-Google-Maps",
                rel: "noreferrer noopener",
                target: "_blank",
                "data-alt-style": "controls-gmap-icon-tooltip"
            }
        }, [o("svg", {
            attrs: {
                width: "24",
                height: "24",
                xmlns: "http://www.w3.org/2000/svg"
            }
        }, [o("g", {
            attrs: {
                fill: "none",
                "fill-rule": "evenodd"
            }
        }, [o("circle", {
            attrs: {
                cx: "12",
                cy: "12",
                r: "12"
            }
        }), e._v(" "), o("path", {
            attrs: {
                d: "M8 9.259C8.06 7.371 9.294 6 11.542 6 13.615 6 15 7.259 15 9.02c0 1.219-.575 2.072-1.604 2.717-.992.614-1.272 1.02-1.272 1.809V14H10.37l-.008-.542c-.068-1.195.37-1.912 1.415-2.558.939-.597 1.256-1.02 1.256-1.808 0-.83-.635-1.427-1.589-1.427-.976 0-1.604.622-1.665 1.594H8zM11.5 18c-.904 0-1.5-.592-1.5-1.495 0-.913.596-1.505 1.5-1.505.922 0 1.5.592 1.5 1.505 0 .903-.578 1.495-1.5 1.495z"
            }
        })])])]) : e._e()]), e._v(" "), o("rm-select", {
            staticClass: "map-type-select",
            class: [{
                "no-line": e.m.current_type === "directions" || e.m.current_type === "custom"
            }],
            attrs: {
                options: e.mapTypes,
                "arrow-size": "big"
            },
            model: {
                value: e.m.current_type,
                callback: function(i) {
                    e.$set(e.m, "current_type", i)
                },
                expression: "m.current_type"
            }
        }), e._v(" "), o("div", {
            staticClass: "types-param"
        }, [e.m.current_type == "custom" ? o("div", {
            staticClass: "type-param",
            attrs: {
                "data-type": "custom"
            }
        }, [o("div", {
            staticClass: "param",
            attrs: {
                "data-param": "code"
            }
        }, [o("textarea", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.custom_json,
                expression: "custom_json"
            }],
            staticClass: "custom-json",
            class: {
                error: e.is_json_invalid, empty: !e.custom_json
            },
            attrs: {
                placeholder: "Paste JSON code",
                required: ""
            },
            domProps: {
                value: e.custom_json
            },
            on: {
                input: function(i) {
                    i.target.composing || (e.custom_json = i.target.value)
                }
            }
        })]), e._v(" "), e._m(0)]) : e._e(), e._v(" "), e.m.current_type == "directions" ? o("div", {
            staticClass: "type-param",
            attrs: {
                "data-type": "directions"
            }
        }, [o("div", {
            staticClass: "param",
            attrs: {
                "data-param": "route_type"
            }
        }, [o("div", {
            staticClass: "route-switcher"
        }, e._l(e.directions, function(i, n) {
            return o("div", {
                key: n,
                staticClass: "route-item",
                class: {
                    active: e.m.direction_route_type === i.value
                },
                on: {
                    click: function(s) {
                        e.m.direction_route_type = i.value
                    }
                }
            }, [o("div", {
                staticClass: "route-icon",
                class: [i.icon]
            })])
        }), 0)])]) : e._e()]), e._v(" "), o("div", {
            staticClass: "map-controls"
        }, [o("div", {
            staticClass: "map-control"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Controls")]), e._v(" "), o("rm-switcher", {
            staticClass: "controls-switcher",
            attrs: {
                "color-off": "#B8B8B8",
                "color-on": "#0080FF",
                height: 24,
                width: 40
            },
            model: {
                value: e.m.show_controls,
                callback: function(i) {
                    e.$set(e.m, "show_controls", i)
                },
                expression: "m.show_controls"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "map-control"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Zoom on scroll")]), e._v(" "), o("rm-switcher", {
            staticClass: "controls-switcher",
            attrs: {
                "color-off": "#B8B8B8",
                "color-on": "#0080FF",
                height: 24,
                width: 40
            },
            model: {
                value: e.m.scrollwheel,
                callback: function(i) {
                    e.$set(e.m, "scrollwheel", i)
                },
                expression: "m.scrollwheel"
            }
        })], 1)])], 1)
    }, wX = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "wizard-link"
        }, [o("a", {
            attrs: {
                target: "_blank",
                href: "https://mapstyle.withgoogle.com/"
            }
        }, [e._v("Launch Maps Wizard")])])
    }], xX = void 0, _X = void 0, SX = void 0, CX = !1;
    IX = kX({
        render: vX,
        staticRenderFns: wX
    }, xX, yX, _X, CX, SX, !1, void 0, void 0, void 0), sD = IX
});

function PX({
    userId: e,
    children: t,
    ...o
}) {
    let {
        model: {
            color: i,
            opacity: n,
            update: s
        }
    } = (0, zb.useContext)(ge), a = (0, zb.useMemo)(() => ct(i || "000000", n), [i, n]);
    return r(qe, {
        "data-testid": "colorbox-panel-color",
        type: "picker",
        userId: e,
        setColor: c => {
            s("color", yt(c)), s("opacity", c.a)
        },
        color: a,
        ...o
    })
}
var zb, lD, cD, Lb, TX, _u, g_ = k(() => {
    "use strict";
    zb = E(N()), lD = E(gi()), cD = E(Ze()), Lb = E(To());
    ko();
    nn();
    Le();
    ae();
    B();
    TX = Lb.default.View.extend({
        initialize: function(e) {
            this.props = e, this.container = this.props.$parent instanceof cD.default ? this.props.$parent[0] : this.props.$parent, this.propsModel = new Lb.default.Model({
                color: e.color,
                opacity: e.opacity,
                update: (t, o) => {
                    if (this.propsModel.set(t, o), t === "color") {
                        let {
                            r: i,
                            g: n,
                            b: s
                        } = nh(o);
                        this.trigger("colorchange", i, n, s, this.propsModel.get("opacity"))
                    } else if (t === "opacity") {
                        let {
                            r: i,
                            g: n,
                            b: s
                        } = nh(this.propsModel.get("color"));
                        this.trigger("opacitychange", i, n, s, o)
                    }
                }
            }), this.projectId = window.RM.constructorRouter.mag.get("_id"), this.userId = window.RM.constructorRouter.mag.user.get("_id"), this.controlContextModel = new Lb.default.Model({
                project: window.RM.constructorRouter.mag
            }), this.render()
        },
        render: async function() {
            let {
                renderReact: e
            } = (Le(), uv(xj));
            return e({
                component: () => r(va, {
                    context: Y,
                    model: this.controlContextModel,
                    children: r(PX, {
                        projectId: this.projectId,
                        userId: this.userId,
                        width: this.props.width || 168,
                        height: this.props.height || 240,
                        showAlpha: this.props.show_opacity,
                        borderRadius: this.props.borderRadius,
                        regularInRow: this.props.swatches_per_line,
                        regularRowsMin: this.props.swatches_min && this.props.swatches_per_line ? this.props.swatches_min / this.props.swatches_per_line : void 0,
                        favouriteInRow: this.props.favourites_per_line,
                        favouriteRows: this.props.favourites_max && this.props.favourites_per_line ? this.props.favourites_max / this.props.favourites_per_line : void 0,
                        favouriteGap: this.props.favourite_gap,
                        swatchesOnlyMode: this.props.swatchesOnlyMode
                    })
                }),
                domElement: this.container,
                model: this.propsModel
            }), this
        },
        setOpacity: function(e) {
            this.propsModel.set("opacity", e)
        },
        setColor: function(e) {
            this.propsModel.set("color", e)
        },
        onSetColor: function(e) {
            this.propsModel.set("color", yt(e)), this.propsModel.set("opacity", e.a)
        },
        rgb2hex: function(e) {
            if (!e || e.some(n => typeof n > "u")) return "";
            let t = e[0].toString(16),
                o = e[1].toString(16),
                i = e[2].toString(16);
            return (t.length === 1 ? "0" + t : t) + (o.length === 1 ? "0" + o : o) + (i.length === 1 ? "0" + i : i)
        },
        areColorsClose: function(e, t) {
            let o = this.rgb2hsb(e),
                i = this.rgb2hsb(t);
            return Math.abs(o[0] - i[0]) <= 5 && Math.abs(o[1] - i[1]) <= 33 && Math.abs(o[2] - i[2]) <= 5 && Math.abs(e[3] - t[3]) <= .06
        },
        hex2rgb: function(e) {
            return [parseInt(e.substring(0, 2), 16), parseInt(e.substring(2, 4), 16), parseInt(e.substring(4, 6), 16)]
        },
        rgb2hsb: function(e) {
            let t = [e[0], e[1], e[2]];
            t[0] /= 255, t[1] /= 255, t[2] /= 255;
            let o = Math.min(t[0], t[1], t[2]),
                i = Math.max(t[0], t[1], t[2]);
            if (o === i) return [180, 0, i * 100];
            let n = t[0] === o ? t[1] - t[2] : t[1] === o ? t[2] - t[0] : t[0] - t[1],
                s = t[0] === o ? 3 : t[1] === o ? 5 : 1,
                a = Math.floor((s - n / (i - o)) * 60) % 360,
                l = Math.floor((i - o) / i * 100);
            return i = Math.floor(i * 100), [a, l, i]
        },
        destroy: function() {
            if (!this.container) return;
            lD.default.unmountComponentAtNode(this.container) && this.container.parentNode.removeChild(this.container)
        }
    }), _u = TX
});
var dD = k(() => {});

function WX(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "color-picker.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var $b, BX, MX, RX, EX, FX, DX, AX, LX, zX, $X, OX, Su, Wb = k(() => {
    "use strict";
    $b = E(Ze());
    Wt();
    g_();
    pi();
    dD();
    BX = 240, MX = 152, RX = 168, EX = {
        model: {
            event: "change"
        },
        props: {
            color: String,
            alpha: Number,
            disabled: {
                type: Boolean,
                default: !1
            },
            disabledIcon: String,
            customIcon: String,
            showAlpha: {
                type: Boolean,
                default: !0
            },
            showArrowIcon: {
                type: Boolean,
                default: !1
            },
            hOffset: {
                type: Number,
                default: 0
            },
            opacityMultiplier: {
                type: Number,
                default: 1
            },
            vOffset: {
                type: Number,
                default: 0
            },
            verticalAlign: {
                type: String,
                default: "auto"
            },
            alwaysVisible: {
                type: Boolean,
                default: !1
            },
            colorboxType: {
                type: String,
                default: "small"
            },
            colorboxWidth: {
                type: Number,
                default: 168
            },
            colorboxHeight: {
                type: Number,
                default: void 0
            },
            swatchesMin: {
                type: Number,
                default: void 0
            },
            swatchesPerLine: {
                type: Number,
                default: void 0
            },
            favouritesMax: {
                type: Number,
                default: void 0
            },
            favouritesPerLine: {
                type: Number,
                default: void 0
            },
            favouriteGap: {
                type: Number,
                default: void 0
            },
            colorboxBorderRadius: {
                type: Number,
                default: void 0
            },
            swatchesOnlyMode: {
                type: Boolean,
                default: !1
            }
        },
        data() {
            return {
                mutableColor: this.color,
                mutableAlpha: this.showAlpha ? this.alpha * this.opacityMultiplier : 1,
                visibleBox: !1,
                colorBoxStyles: {}
            }
        },
        computed: {
            bg() {
                return this.disabled && !this.mutableColor ? "#b8b8b8" : be.getRGBA(this.mutableColor, this.showAlpha ? this.opacity100based : 1)
            },
            opacity100based() {
                return this.mutableAlpha / 100
            },
            opacityResult() {
                return this.mutableAlpha / this.opacityMultiplier
            }
        },
        watch: {
            color(e) {
                if (this.mutableColor = e, !this.colorbox) return !1;
                if (!this.mutableColor) return this.visibleBox && this.hide(), !1;
                setTimeout(() => {
                    st("ClickOnPaletteIcon")
                }, 300), this.colorbox.setColor(this.mutableColor)
            }
        },
        mounted() {
            let e = 8;
            this.alwaysVisible ? (this.colorBoxStyles.width = (this.colorboxWidth || RX) + "px", this.colorBoxStyles.height = this.colorboxHeight ? this.colorboxHeight + "px" : void 0, this.colorBoxStyles.overflow = "hidden", this.colorBoxStyles["border-radius"] = "6px 6px 0 0", this.onColorClick()) : ((0, $b.default)(this.$el).hasClass("round") && (e = 7), this.$el.getBoundingClientRect().top > window.innerHeight / 2 || this.verticalAlign === "top" ? this.colorBoxStyles["margin-top"] = -(BX + e + this.vOffset) + "px" : this.colorBoxStyles["margin-top"] = (0, $b.default)(this.$refs.button).height() + e + this.vOffset + "px", this.colorBoxStyles["margin-left"] = -(this.hOffset + MX - (0, $b.default)(this.$refs.button).width()) + "px")
        },
        methods: {
            onColorClick() {
                if (!this.disabled) {
                    if (!this.colorbox) {
                        let e = {
                            $parent: this.$el.querySelector(".colorbox_container"),
                            type: this.colorboxType,
                            show_opacity: this.showAlpha
                        };
                        this.colorboxWidth && (e.width = this.colorboxWidth), this.swatchesMin && (e.swatches_min = this.swatchesMin), this.swatchesPerLine && (e.swatches_per_line = this.swatchesPerLine), this.favouritesMax && (e.favourites_max = this.favouritesMax), this.favouritesPerLine && (e.favourites_per_line = this.favouritesPerLine), typeof this.favouriteGap == "number" && (e.favourite_gap = this.favouriteGap), typeof this.colorboxHeight == "number" && (e.height = this.colorboxHeight), typeof this.colorboxBorderRadius == "number" && (e.borderRadius = this.colorboxBorderRadius), typeof this.swatchesOnlyMode == "boolean" && (e.swatchesOnlyMode = this.swatchesOnlyMode), this.colorbox = new _u(e), this.colorbox.on("colorchange", this.colorOpacityChanged), this.colorbox.on("opacitychange", this.colorOpacityChanged)
                    }
                    this.colorbox.setColor(this.mutableColor), this.colorbox.setOpacity(this.opacity100based), this.$emit(this.visibleBox ? "hidePopup" : "showPopup", this), this.visibleBox = !this.visibleBox
                }
            },
            colorOpacityChanged(e, t, o, i) {
                this.mutableColor = this.colorbox.rgb2hex([e, t, o]), this.mutableAlpha = i * 100, this.$emit("update:all", {
                    color: this.mutableColor,
                    alpha: this.opacityResult
                }), this.$emit("update:color", this.mutableColor), this.$emit("update:alpha", this.opacityResult)
            },
            hide() {
                this.visibleBox = !1, this.$emit("hidePopup")
            }
        }
    }, FX = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            ref: "button",
            class: {
                "color-picker-container": !0, "color-picker-disabled": e.disabled
            }
        }, [e.showAlpha ? o("div", {
            staticClass: "opacity-grid"
        }) : e._e(), e._v(" "), e.alwaysVisible ? e._e() : o("div", {
            staticClass: "color-preview",
            style: {
                backgroundColor: e.bg
            },
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.onColorClick(i)
                }
            }
        }, [e.disabled && e.disabledIcon ? o("img", {
            staticClass: "disabled-icon",
            attrs: {
                src: e.disabledIcon
            }
        }) : e._e(), e._v(" "), !e.disabled && e.customIcon ? o("img", {
            staticClass: "custom-icon",
            attrs: {
                src: e.customIcon
            }
        }) : e._e()]), e._v(" "), e.showArrowIcon ? o("div", {
            staticClass: "arrow-icon",
            on: {
                click: function(i) {
                    return i.stopPropagation(), e.onColorClick(i)
                }
            }
        }) : e._e(), e._v(" "), o("div", {
            staticClass: "colorbox_container",
            class: {
                visible: e.visibleBox
            },
            style: e.colorBoxStyles
        })])
    }, DX = [], AX = void 0, LX = void 0, zX = void 0, $X = !1;
    OX = WX({
        render: FX,
        staticRenderFns: DX
    }, AX, EX, LX, $X, zX, !1, void 0, void 0, void 0), Su = OX
});

function KX(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "rm-scroll.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var lm, b_, jX, HX, NX, UX, VX, GX, YX, ZX, XX, JX, pD, uD = k(() => {
    "use strict";
    lm = E(Ze()), b_ = E(ze()), jX = 16, HX = 16, NX = {
        props: {
            onPanelScroll: {
                type: Function,
                default: () => {}
            },
            onScrollRecalc: {
                type: Function,
                default: () => {}
            },
            scrollGapStart: {
                type: Number,
                default: jX
            },
            scrollGapEnd: {
                type: Number,
                default: HX
            },
            systemScroll: {
                type: Boolean,
                default: !1
            },
            savedScrollPosition: {
                type: Number,
                default: void 0
            }
        },
        mounted: function() {
            this.resizableScroll = (0, lm.default)(this.$refs.scrollWrapper).RMScroll({
                $container: (0, lm.default)(this.$refs.contentWrapper),
                $content: (0, lm.default)(this.$refs.content),
                $handle: (0, lm.default)(this.$refs.scroll),
                wheelScrollSpeed: .4,
                gap_start: this.scrollGapStart,
                gap_end: this.scrollGapEnd,
                systemScroll: this.systemScroll,
                onScroll: this.onPanelScroll,
                savedScrollPosition: this.savedScrollPosition
            }).data("scroll"), this.__scrollRecalc_debounced = b_.default.debounce(b_.default.bind(function() {
                this.resizableScroll.recalc(), this.onScrollRecalc("control-resize")
            }, this), 300)
        },
        beforeUpdate: function() {
            this.savedScrollPosition === 0 && this.resizableScroll.clearScroll()
        },
        methods: {
            recalcScroll: function() {
                this.__scrollRecalc_debounced()
            }
        }
    }, UX = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            ref: "scrollWrapper",
            staticClass: "resizable-scroll-wrapper"
        }, [o("div", {
            ref: "contentWrapper",
            staticClass: "resizable-content-wrapper"
        }, [o("div", {
            ref: "content",
            staticClass: "resizable-content"
        }, [e._t("default")], 2)]), e._v(" "), o("div", {
            ref: "scroll",
            staticClass: "resizable-scroll"
        })])
    }, VX = [], GX = void 0, YX = void 0, ZX = void 0, XX = !1;
    JX = KX({
        render: UX,
        staticRenderFns: VX
    }, GX, NX, YX, XX, ZX, !1, void 0, void 0, void 0), pD = JX
});
var hD = k(() => {});

function rK(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "shape-search.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var mD, qX, QX, eK, tK, oK, iK, nK, sK, fD, gD = k(() => {
    "use strict";
    mD = E(ze());
    Oc();
    bu();
    uD();
    hD();
    qX = {
        components: {
            RmScroll: pD
        },
        props: {
            iconsCollection: {
                type: String,
                default: "defaultIcons"
            },
            placeholder: {
                type: String,
                default: "Search"
            }
        },
        data: function() {
            let e = new $s;
            return {
                iconsutils: e,
                icons: this.getCollection(this.iconsCollection, e),
                searchString: e.prevSVGSearch.query,
                currentSearchString: e.prevSVGSearch.query,
                isSearch: !!e.prevSVGSearch.query,
                iconsListLoading: !1,
                iconLoading: null,
                iconSelected: !1,
                savedScrollPosition: e.prevSVGSearch.savedScrollPosition || 0
            }
        },
        watch: {
            "block.tp": {
                handler: function() {
                    Qn.nextTick(function() {
                        this.$emit("resize")
                    }.bind(this))
                },
                immediate: !0
            },
            iconsCollection: function(e) {
                this.icons = this.getCollection(e)
            }
        },
        mounted: function() {
            this.iconSelected = this.iconsutils.findIcon(mD.default.pick(this.block, "noun_id", "rm_id")), this._scroll = this.$refs.rmscroll
        },
        beforeDestroy: function() {
            this.iconsutils && this.iconsutils.destroy()
        },
        methods: {
            onLoupeClick: function() {
                this.isSearch ? this.clearSearch() : this.doSearch()
            },
            getCollection: function(e, t, o = !0) {
                let i = t || this.iconsutils,
                    n;
                switch (e) {
                    case "left":
                        n = "defaultSlideshowLeftIcons";
                        break;
                    case "right":
                        n = "defaultSlideshowRightIcons";
                        break;
                    default:
                        n = "defaultIcons";
                        break
                }
                return o ? i.getPersistedIcons(n) : i.getDefaultIcons(n)
            },
            doSearch: function() {
                !this.searchString || this.currentSearchString === this.searchString || this.iconsutils.searchInProgress || (this.savedScrollPosition = 0, this.currentSearchString = this.searchString, this.icons = [], delete window.prevSVGSearch, this.isSearch = !0, this.fetchIcons())
            },
            clearSearch: function() {
                this.savedScrollPosition = 0, this.isSearch = !1, this.searchString = "", this.currentSearchString = "", this.icons = this.getCollection(this.iconsCollection, this.iconsutils, !1), this.iconsutils.clearSearch()
            },
            onPanelScroll: function(e) {
                this.iconsutils.prevSVGSearch.savedScrollPosition = e.scroll_pos, this.savedScrollPosition = e.scroll_pos, e.content_size - e.container_size - e.scroll_pos < 32 && this.iconsutils.prevSVGSearch.nextPage && !this.iconsutils.searchInProgress && this.fetchIcons()
            },
            fetchIcons: async function() {
                this.iconsListLoading = !0, this.icons = await this.iconsutils.fetchIconsPage(this.searchString), this.iconsListLoading = !1, this._scroll.recalcScroll()
            },
            onIconItemClick: function(e) {
                this.iconLoading || (this.$emit("dataObtained", e), this.iconLoading = !1)
            }
        }
    }, QX = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "icons"
        }, [o("div", {
            staticClass: "search-block"
        }, [o("input", {
            directives: [{
                name: "model",
                rawName: "v-model",
                value: e.searchString,
                expression: "searchString"
            }],
            staticClass: "search",
            attrs: {
                type: "text",
                placeholder: e.placeholder
            },
            domProps: {
                value: e.searchString
            },
            on: {
                keyup: function(i) {
                    return !i.type.indexOf("key") && e._k(i.keyCode, "enter", 13, i.key, "Enter") ? null : e.doSearch(i)
                },
                input: function(i) {
                    i.target.composing || (e.searchString = i.target.value)
                }
            }
        }), e._v(" "), o("div", {
            staticClass: "loupe",
            class: {
                clear: e.isSearch, preloading: e.iconsListLoading
            },
            on: {
                click: e.onLoupeClick
            }
        }, [e._m(0)])]), e._v(" "), o("div", {
            staticClass: "common-wrapper"
        }, [o("rm-scroll", {
            ref: "rmscroll",
            attrs: {
                "on-panel-scroll": e.onPanelScroll,
                "scroll-gap-start": 8,
                "scroll-gap-end": 8,
                "saved-scroll-position": e.savedScrollPosition
            }
        }, e._l(e.icons || [], function(i) {
            return o("div", {
                key: i.id,
                staticClass: "icon-item",
                class: {
                    preloading: e.iconLoading == i, selected: e.iconSelected == i
                },
                on: {
                    click: function(n) {
                        return e.onIconItemClick(i)
                    }
                }
            }, [o("div", {
                staticClass: "noun-icon",
                style: {
                    "background-image": "url('" + i.preview_url_42 + "')"
                },
                attrs: {
                    "data-id": i.id,
                    "data-rm_id": i.rm_id,
                    "data-url": i.icon_url
                }
            }), e._v(" "), e.iconLoading == i ? o("div", {
                staticClass: "rmpreloader"
            }, [o("div", {
                staticClass: "arc"
            })]) : e._e()])
        }), 0)], 1)])
    }, eK = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "rmpreloader hidden"
        }, [o("div", {
            staticClass: "arc"
        })])
    }], tK = void 0, oK = "data-v-a0664024", iK = void 0, nK = !1;
    sK = rK({
        render: QX,
        staticRenderFns: eK
    }, tK, qX, oK, nK, iK, !1, void 0, void 0, void 0), fD = sK
});
var bD = k(() => {});

function mK(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "x-mark.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var aK, lK, cK, dK, pK, uK, hK, fK, yD, vD = k(() => {
    "use strict";
    bD();
    aK = {
        props: {
            width: {
                default: 40
            },
            height: {
                default: 40
            }
        }
    }, lK = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("svg", {
            attrs: {
                xmlns: "http://www.w3.org/2000/svg",
                width: e.width,
                height: e.height,
                viewBox: "0 0 40 40"
            }
        }, [o("path", {
            attrs: {
                "fill-rule": "evenodd",
                "clip-rule": "evenodd",
                d: "M20 32C26.6274 32 32 26.6274 32 20C32 13.3726 26.6274 8 20 8C13.3726 8 8 13.3726 8 20C8 26.6274 13.3726 32 20 32ZM25.9497 14.0503C26.3403 14.4408 26.3403 15.0739 25.9497 15.4645L21.4142 20L25.9497 24.5355C26.3403 24.9261 26.3403 25.5592 25.9497 25.9497C25.5592 26.3403 24.9261 26.3403 24.5355 25.9497L20 21.4142L15.4645 25.9497C15.0739 26.3403 14.4408 26.3403 14.0503 25.9497C13.6597 25.5592 13.6597 24.9261 14.0503 24.5355L18.5858 20L14.0503 15.4645C13.6597 15.0739 13.6597 14.4408 14.0503 14.0503C14.4408 13.6597 15.0739 13.6597 15.4645 14.0503L20 18.5858L24.5355 14.0503C24.9261 13.6597 25.5592 13.6597 25.9497 14.0503Z"
            }
        })])
    }, cK = [], dK = void 0, pK = "data-v-31a7d956", uK = void 0, hK = !1;
    fK = mK({
        render: lK,
        staticRenderFns: cK
    }, dK, aK, pK, hK, uK, !1, void 0, void 0, void 0), yD = fK
});
var wD = k(() => {});

function SK(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "permission-controller.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var gK, bK, yK, vK, wK, xK, _K, CK, Ob, y_ = k(() => {
    "use strict";
    Nr();
    wD();
    gK = {
        props: {
            permission: String
        },
        computed: {
            isAllowed: function() {
                return so.isPermissionAllowed(this.permission)
            }
        }
    }, bK = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "permission-controller",
            attrs: {
                disabled: !e.isAllowed
            }
        }, [e._t("default")], 2)
    }, yK = [], vK = void 0, wK = void 0, xK = void 0, _K = !1;
    CK = SK({
        render: bK,
        staticRenderFns: yK
    }, vK, gK, wK, _K, xK, !1, void 0, void 0, void 0), Ob = CK
});
var xD = k(() => {});

function EK(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-slideshow-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var v_, Cu, kK, IK, PK, TK, BK, MK, RK, FK, _D, SD = k(() => {
    "use strict";
    v_ = E(Ze()), Cu = E(ze());
    Oc();
    na();
    wu();
    Wb();
    gD();
    dd();
    bu();
    Wt();
    vD();
    y_();
    Nr();
    xD();
    kK = {
        components: {
            RmSwitcher: Ra,
            ColorPicker: Su,
            ShapeSearch: fD,
            NumericInput: Es,
            XMarkIcon: yD,
            PermissionController: Ob
        },
        mixins: [Mi],
        data: function() {
            let e = new $s;
            return {
                iconsutils: e,
                uploading: !1,
                dragging: !1,
                activeNounArrow: "left",
                icons: e.getPersistedIcons("defaultSlideshowLeftIcons"),
                m: {
                    pictures: []
                }
            }
        },
        computed: {
            hasPictures: function() {
                return !Cu.default.isEmpty(this.m.pictures)
            },
            compoundProperty() {
                return [this.raw_block.queue, this.block.theme_data.captions].join()
            }
        },
        watch: {
            compoundProperty: {
                handler: function() {
                    Qn.nextTick(function() {
                        this.$emit("resize")
                    }.bind(this))
                },
                immediate: !0
            }
        },
        mounted: function() {
            this.uploader = this.raw_block.uploader, this.uploader.on("start", this.showPreloader), this.uploader.on("done fail", this.checkFinishUpload), this.raw_block.settingsPanel = this, this.raw_block.updateDropZone(), this.raw_block.colorbox_visible = !1, this.raw_block.workspace.on("main-dragover", this.highlightDropZone, this)
        },
        beforeDestroy: function() {
            this.raw_block.workspace.off("main-dragover", this.highlightDropZone, this), this.iconsutils && this.iconsutils.destroy()
        },
        methods: {
            upload: function() {
                this.raw_block.$(".uploadInput").trigger("click", "stop")
            },
            closePopups(e) {
                e && e.target && e.target.closest(".colorbox_container") || Cu.default.each(this.$children, function(t) {
                    t !== e && (t.visibleBox = !1)
                })
            },
            onShowPopup(e) {
                this.closePopups(e), this.raw_block.colorbox_visible = !0
            },
            onUpdateColor: function(e) {
                this.block.theme_data.controls_color = e, this.raw_block.needRasterize = !0
            },
            updateShapeSearchScroll: function() {
                this.$refs.shapeSearch.$refs.rmscroll.recalcScroll()
            },
            getCapitalizedName: function(e) {
                return be.capitalize(e)
            },
            isSearchAvailable: function() {
                return be.isNounSearchAvailable()
            },
            onCountersTypeClick: function(e) {
                if ((0, v_.default)(e.target).hasClass("dots")) {
                    if ((0, v_.default)(e.target).hasClass("disabled")) {
                        e.preventDefault();
                        return
                    }
                    this.block.theme_data.counters_type = "dots"
                } else this.block.theme_data.counters_type = "numbers"
            },
            onCrossfadeValueChange: function(e) {
                this.block.theme_data.autoplay_delay < e && (this.block.theme_data.autoplay_delay = e)
            },
            onThumbnailsChange: function(e) {
                e && (this.block.theme_data.counters_type = "numbers", this.block.theme_data.captions = !1)
            },
            onCaptionsChange: function(e) {
                this.raw_block.trigger("captions_changed", e), e && (this.block.theme_data.thumbnails = !1)
            },
            onArrowsTypeChange: function(e) {
                (e === "library" || e === "noun") && this.updateShapeSearchScroll(), this.block.theme_data.arrows_type = e, this.block.current_mode = e, this.raw_block.trigger("arrow_type_changed")
            },
            onDataObtained: function(e) {
                let t = this.activeNounArrow === "left" ? "left_arrow_noun" : "right_arrow_noun";
                this.raw_block.getIconSVG(e.id || e.rm_id, e.icon_url, t, o => {
                    let i;
                    this.raw_block.needRasterize = !0, !o && (i = {
                        noun_url: e.icon_url
                    }, e.id ? Cu.default.extend(i, {
                        noun_id: e.id,
                        rm_id: null
                    }) : e.rm_id && Cu.default.extend(i, {
                        noun_id: null,
                        rm_id: e.rm_id
                    }), this.activeNounArrow === "left" ? this.block.theme_data.left_icon_noun = i : this.block.theme_data.right_icon_noun = i)
                })
            },
            canUpload: function() {
                return !this.hasPictures && !this.uploading
            },
            checkFinishUpload: function() {
                Cu.default.isEmpty(this.raw_block.queue) && (so.isPermissionAllowed("SlideshowCanChangeSettings") || this.$parent.$emit("deselect"), this.uploading = !1)
            },
            highlightDropZone: function() {
                this.dragging = !0, clearTimeout(this.highlightTimeout), this.highlightTimeout = setTimeout(() => {
                    this.dragging = !1
                }, 500)
            },
            showPreloader: function() {
                this.uploading = !0
            },
            cancelUpload: function() {
                this.uploading = !1, this.raw_block.removePictures()
            }
        }
    }, IK = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel slideshow-panel resizable",
            class: {
                noun: e.block.current_mode === "library" || e.block.current_mode === "noun", "has-upload-images": e.hasPictures, uploading: e.uploading && !e.hasPictures, dragging: e.dragging
            },
            on: {
                click: e.closePopups
            }
        }, [e.hasPictures ? e._e() : o("div", {
            staticClass: "panel-caption"
        }, [e._v("Images")]), e._v(" "), o("div", {
            staticClass: "upload"
        }, [o("div", {
            staticClass: "upload-wrapper"
        }, [o("div", {
            staticClass: "center-wrapper",
            on: {
                click: function(i) {
                    return e.upload(i)
                }
            }
        }, [o("div", {
            staticClass: "icon"
        }), e._v(" "), o("div", {
            staticClass: "caption-upload-dop"
        }, [e._v("Drop files here")])])])]), e._v(" "), e._m(0), e._v(" "), o("div", {
            staticClass: "loading"
        }, [o("div", {
            staticClass: "delete",
            on: {
                click: e.cancelUpload
            }
        }, [o("x-mark-icon", {
            attrs: {
                width: 32,
                height: 32
            }
        })], 1)]), e._v(" "), o("permission-controller", {
            attrs: {
                permission: "SlideshowCanChangeSettings"
            }
        }, [o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.current_mode === "default",
                expression: "block.current_mode === 'default'"
            }],
            staticClass: "settings"
        }, [o("div", {
            staticClass: "colorbox_container"
        }), e._v(" "), o("div", {
            staticClass: "params",
            attrs: {
                "data-current-theme": e.block.current_theme
            }
        }, [o("div", {
            staticClass: "param param-arrows solid-separator",
            class: {
                invisible: e.block.theme_data.arrows
            }
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Arrows")]), e._v(" "), o("rm-switcher", {
            attrs: {
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.arrows,
                callback: function(i) {
                    e.$set(e.block.theme_data, "arrows", i)
                },
                expression: "block.theme_data.arrows"
            }
        })], 1), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.theme_data.arrows,
                expression: "block.theme_data.arrows"
            }],
            staticClass: "param param-arrows-type"
        }, e._l(["default", "library"], function(i) {
            var n;
            return o("div", {
                key: i,
                staticClass: "arrows-type",
                class: (n = {
                    active: e.block.theme_data.arrows_type === i
                }, n[i] = !0, n),
                on: {
                    click: function(s) {
                        return e.onArrowsTypeChange(i)
                    }
                }
            }, [e._v(`
            ` + e._s(e.getCapitalizedName(i)) + `
          `)])
        }), 0), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.theme_data.arrows,
                expression: "block.theme_data.arrows"
            }],
            staticClass: "param param-arrows-view-mode solid-separator",
            class: {
                invisible: e.block.theme_data.arrows_view_mode === "normal"
            }
        }, e._l(["normal", "mouseover"], function(i) {
            var n;
            return o("div", {
                key: i,
                staticClass: "arrows-view-mode",
                class: (n = {
                    active: e.block.theme_data.arrows_view_mode === i
                }, n[i] = !0, n),
                on: {
                    click: function(s) {
                        e.block.theme_data.arrows_view_mode = i
                    }
                }
            }, [e._v(`
            ` + e._s(e.getCapitalizedName(i)) + `
          `)])
        }), 0), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.theme_data.arrows && e.block.theme_data.arrows_view_mode === "normal",
                expression: "block.theme_data.arrows && block.theme_data.arrows_view_mode === 'normal'"
            }],
            staticClass: "param param-arrows-position solid-separator"
        }, e._l(["sides", "bottom"], function(i) {
            var n;
            return o("div", {
                key: i,
                staticClass: "arrows-position",
                class: (n = {
                    active: e.block.theme_data.arrows_position === i
                }, n[i] = !0, n),
                on: {
                    click: function(s) {
                        e.block.theme_data.arrows_position = i
                    }
                }
            }, [e._v(`
            ` + e._s(e.getCapitalizedName(i)) + `
          `)])
        }), 0), e._v(" "), o("transition", {
            attrs: {
                name: "fade"
            }
        }, [o("div", {
            staticClass: "param param-counters solid-separator",
            class: {
                invisible: e.block.theme_data.counters
            }
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Counter")]), e._v(" "), o("rm-switcher", {
            attrs: {
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.counters,
                callback: function(i) {
                    e.$set(e.block.theme_data, "counters", i)
                },
                expression: "block.theme_data.counters"
            }
        })], 1)]), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.theme_data.counters,
                expression: "block.theme_data.counters"
            }],
            staticClass: "param param-counters-type solid-separator",
            class: {
                invisible: e.block.theme_data.counters_type !== "numbers"
            }
        }, e._l(["numbers", "dots"], function(i) {
            var n;
            return o("div", {
                key: i,
                staticClass: "counters-type",
                class: (n = {
                    active: e.block.theme_data.counters_type === i,
                    disabled: i === "dots" && e.block.theme_data.thumbnails
                }, n[i] = !0, n),
                on: {
                    click: e.onCountersTypeClick
                }
            }, [e._v(`
            ` + e._s(e.getCapitalizedName(i)) + `
          `)])
        }), 0), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.theme_data.counters && e.block.theme_data.counters_type === "dots",
                expression: "block.theme_data.counters && block.theme_data.counters_type === 'dots'"
            }],
            staticClass: "param param-counters-position solid-separator"
        }, e._l(["inside", "outside"], function(i) {
            var n;
            return o("div", {
                key: i,
                staticClass: "counters-position",
                class: (n = {
                    active: e.block.theme_data.counters_position === i,
                    disabled: i === "dots" && e.block.theme_data.thumbnails
                }, n[i] = !0, n),
                on: {
                    click: function(s) {
                        e.block.theme_data.counters_position = i
                    }
                }
            }, [e._v(`
            ` + e._s(e.getCapitalizedName(i)) + `
          `)])
        }), 0), e._v(" "), o("div", {
            staticClass: "param param-fullscreen solid-separator"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Fullscreen")]), e._v(" "), o("rm-switcher", {
            attrs: {
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.fullscreen,
                callback: function(i) {
                    e.$set(e.block.theme_data, "fullscreen", i)
                },
                expression: "block.theme_data.fullscreen"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "param param-controls"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Icons color")]), e._v(" "), o("color-picker", {
            attrs: {
                color: e.block.theme_data.controls_color,
                "show-alpha": !1
            },
            on: {
                showPopup: e.onShowPopup,
                "update:color": function(i) {
                    return e.onUpdateColor(i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "param param-controls-bg"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Background")]), e._v(" "), o("rm-switcher", {
            attrs: {
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.controls_bg,
                callback: function(i) {
                    e.$set(e.block.theme_data, "controls_bg", i)
                },
                expression: "block.theme_data.controls_bg"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "param param-show-on-hover solid-separator"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Show on hover")]), e._v(" "), o("rm-switcher", {
            attrs: {
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.show_on_hover,
                callback: function(i) {
                    e.$set(e.block.theme_data, "show_on_hover", i)
                },
                expression: "block.theme_data.show_on_hover"
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "param param-captions"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Captions")]), e._v(" "), o("rm-switcher", {
            attrs: {
                callback: e.onCaptionsChange,
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.captions,
                callback: function(i) {
                    e.$set(e.block.theme_data, "captions", i)
                },
                expression: "block.theme_data.captions"
            }
        })], 1), e._v(" "), o("transition", {
            attrs: {
                name: "fade"
            }
        }, [o("div", {
            staticClass: "param param-thumbnails"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Thumbs")]), e._v(" "), o("rm-switcher", {
            attrs: {
                callback: e.onThumbnailsChange,
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.thumbnails,
                callback: function(i) {
                    e.$set(e.block.theme_data, "thumbnails", i)
                },
                expression: "block.theme_data.thumbnails"
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "param param-fill solid-separator",
            class: {
                invisible: e.block.theme_data.thumbnails || !e.block.theme_data.fill || e.block.theme_data.radius > 0
            }
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Fill")]), e._v(" "), o("rm-switcher", {
            attrs: {
                width: 40,
                height: 24,
                "color-on": "#282828",
                "color-off": "#B8B8B8"
            },
            model: {
                value: e.block.theme_data.fill,
                callback: function(i) {
                    e.$set(e.block.theme_data, "fill", i)
                },
                expression: "block.theme_data.fill"
            }
        })], 1), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.theme_data.thumbnails || !e.block.theme_data.fill || e.block.theme_data.radius > 0,
                expression: "block.theme_data.thumbnails || !block.theme_data.fill || block.theme_data.radius > 0"
            }],
            staticClass: "param param-backgroundr solid-separator"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Bg color")]), e._v(" "), o("color-picker", {
            attrs: {
                "vertical-align": "top",
                color: e.block.theme_data.background_color,
                alpha: e.block.theme_data.background_opacity,
                "opacity-multiplier": 100,
                "show-alpha": !0
            },
            on: {
                "update:color": function(i) {
                    return e.block.theme_data.background_color = i
                },
                "update:alpha": function(i) {
                    return e.block.theme_data.background_opacity = i
                },
                showPopup: e.onShowPopup
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "param param-radius"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Radius")]), e._v(" "), o("numeric-input", {
            class: {
                active: e.block.theme_data.radius > 0
            },
            attrs: {
                autofocus: !1,
                autosize: !1,
                min: 0,
                max: 999,
                dir: "v",
                speed: 5,
                "label-selector": ".caption"
            },
            model: {
                value: e.block.theme_data.radius,
                callback: function(i) {
                    e.$set(e.block.theme_data, "radius", i)
                },
                expression: "block.theme_data.radius"
            }
        })], 1)], 1)])]), e._v(" "), o("permission-controller", {
            attrs: {
                permission: "SlideshowCanChangeSettings"
            }
        }, [o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.current_mode === "library" || e.block.current_mode === "noun",
                expression: "block.current_mode === 'library' || block.current_mode === 'noun'"
            }],
            staticClass: "noun-settings",
            class: {
                "no-search": !e.isSearchAvailable()
            }
        }, [o("div", {
            staticClass: "noun-wrapper",
            class: {
                "solid-separator": e.isSearchAvailable()
            }
        }, e._l(["left", "right"], function(i) {
            var n;
            return o("span", {
                key: i,
                staticClass: "arrow-noun",
                class: (n = {
                    active: e.activeNounArrow == i
                }, n[i] = !0, n),
                on: {
                    click: function(s) {
                        e.activeNounArrow = i
                    }
                }
            }, [e._v(e._s(e.getCapitalizedName(i)))])
        }), 0), e._v(" "), o("shape-search", {
            ref: "shapeSearch",
            attrs: {
                "icons-collection": e.activeNounArrow
            },
            on: {
                dataObtained: e.onDataObtained
            }
        })], 1)])], 1)
    }, PK = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "picture_preloader rmpreloader"
        }, [o("div", {
            staticClass: "shadow"
        }), e._v(" "), o("div", {
            staticClass: "arc"
        })])
    }], TK = void 0, BK = "data-v-ce272326", MK = void 0, RK = !1;
    FK = EK({
        render: IK,
        staticRenderFns: PK
    }, TK, kK, BK, RK, MK, !1, void 0, void 0, void 0), _D = FK
});

function jK(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-slideshow-transitions.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var CD, DK, AK, LK, zK, $K, WK, OK, HK, kD, ID = k(() => {
    "use strict";
    CD = E(ze());
    na();
    dd();
    DK = {
        components: {
            NumericInput: Es
        },
        mixins: [Mi],
        data: function() {
            return {
                isHoverDisabled: !1,
                methodsObject: {
                    click: "Play on click",
                    hover: "Play on hover",
                    autoplay: "Autoplay"
                }
            }
        },
        computed: {},
        mounted: function() {
            this.raw_block.workspace.page.on("change:viewport", this.onChangeViewport), this.onChangeViewport()
        },
        methods: {
            onTransitionsValueChange: function(e) {
                (this.block.theme_data.autoplay_delay < e || this.block.theme_data.hover_delay < e) && (this.block.theme_data.autoplay_delay = e, this.block.theme_data.hover_delay = e)
            },
            onChangeViewport: function() {
                let e = this.raw_block.workspace.viewport,
                    t = this.raw_block.workspace.page.getViewportParam("phone_portrait", "enabled"),
                    o = this.raw_block.workspace.page.getViewportParam("tablet_portrait", "enabled");
                this.isHoverDisabled = e !== "default", (t || o) && this.isHoverDisabled && this.block.play_method === "hover" && (this.block.play_method = "autoplay")
            },
            getPlayMethods: function() {
                let e = this.raw_block.workspace.viewport,
                    t = this.methodsObject;
                return t = e !== "default" ? CD.default.omit(t, "hover") : t, t
            }
        }
    }, AK = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel slideshow-transition-panel transitions resizable"
        }, [o("div", {
            staticClass: "settings"
        }, [o("div", {
            staticClass: "params"
        }, [o("div", {
            staticClass: "param param-transition-type"
        }, e._l(["slider", "crossfade"], function(i) {
            var n;
            return o("div", {
                key: i,
                staticClass: "transition-type",
                class: (n = {
                    active: e.block.transition_type === i
                }, n[i] = !0, n),
                on: {
                    click: function(s) {
                        e.block.transition_type = i
                    }
                }
            }, [e._v(`
          ` + e._s(i.charAt(0).toUpperCase() + i.slice(1)) + `
        `)])
        }), 0), e._v(" "), o("div", {
            staticClass: "param param-play-method",
            class: {
                click: e.block.play_method === "click", hover: e.block.play_method === "hover", autoplay: e.block.play_method === "autoplay", hover_disabled: e.isHoverDisabled
            }
        }, e._l(e.getPlayMethods(), function(i, n) {
            var s;
            return o("div", {
                key: n,
                staticClass: "play-method",
                class: (s = {
                    active: e.block.play_method === n
                }, s[n] = !0, s),
                on: {
                    click: function(a) {
                        e.block.play_method = n
                    }
                }
            }, [e._v(`
          ` + e._s(i) + `
        `)])
        }), 0), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.play_method === "autoplay",
                expression: "block.play_method === 'autoplay'"
            }],
            staticClass: "param param-autoplay-delay"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Delay")]), e._v(" "), o("numeric-input", {
            class: {
                active: e.block.theme_data.autoplay_delay > 0
            },
            attrs: {
                autofocus: !1,
                min: e.block.transition_type === "crossfade" ? e.block.theme_data.crossfade : e.block.theme_data.slider_transition,
                max: 60,
                dir: "v",
                step: .1,
                "shift-step": 1,
                "use-float": !0,
                speed: 5,
                "label-selector": ".caption"
            },
            model: {
                value: e.block.theme_data.autoplay_delay,
                callback: function(i) {
                    e.$set(e.block.theme_data, "autoplay_delay", i)
                },
                expression: "block.theme_data.autoplay_delay"
            }
        })], 1), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.play_method === "hover",
                expression: "block.play_method === 'hover'"
            }],
            staticClass: "param param-hover-delay"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Delay")]), e._v(" "), o("numeric-input", {
            class: {
                active: e.block.theme_data.hover_delay > 0
            },
            attrs: {
                autofocus: !1,
                min: e.block.transition_type === "crossfade" ? e.block.theme_data.crossfade : e.block.theme_data.slider_transition,
                max: 60,
                dir: "v",
                step: .1,
                "shift-step": 1,
                "use-float": !0,
                speed: 5,
                "label-selector": ".caption"
            },
            model: {
                value: e.block.theme_data.hover_delay,
                callback: function(i) {
                    e.$set(e.block.theme_data, "hover_delay", i)
                },
                expression: "block.theme_data.hover_delay"
            }
        })], 1), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.transition_type === "crossfade",
                expression: "block.transition_type === 'crossfade'"
            }],
            staticClass: "param param-crossfade"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Crossfade")]), e._v(" "), o("numeric-input", {
            class: {
                active: e.block.theme_data.crossfade > 0
            },
            attrs: {
                autofocus: !1,
                min: 0,
                max: 60,
                dir: "v",
                step: .1,
                "shift-step": 1,
                "use-float": !0,
                speed: 5,
                "label-selector": ".caption"
            },
            on: {
                change: e.onTransitionsValueChange
            },
            model: {
                value: e.block.theme_data.crossfade,
                callback: function(i) {
                    e.$set(e.block.theme_data, "crossfade", i)
                },
                expression: "block.theme_data.crossfade"
            }
        })], 1), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.block.transition_type === "slider",
                expression: "block.transition_type === 'slider'"
            }],
            staticClass: "param param-slider-transition"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Transition")]), e._v(" "), o("numeric-input", {
            class: {
                active: e.block.theme_data.slider_transition > 0
            },
            attrs: {
                autofocus: !1,
                min: 0,
                max: 60,
                dir: "v",
                step: .1,
                "use-float": !0,
                speed: 5,
                readonly: !1,
                "shift-step": 1,
                "label-selector": ".caption"
            },
            on: {
                change: e.onTransitionsValueChange
            },
            model: {
                value: e.block.theme_data.slider_transition,
                callback: function(i) {
                    e.$set(e.block.theme_data, "slider_transition", i)
                },
                expression: "block.theme_data.slider_transition"
            }
        })], 1)])])])
    }, LK = [], zK = void 0, $K = void 0, WK = void 0, OK = !1;
    HK = jK({
        render: AK,
        staticRenderFns: LK
    }, zK, DK, $K, OK, WK, !1, void 0, void 0, void 0), kD = HK
});
var jb, PD = k(() => {
    "use strict";
    no();
    jb = {
        "template-constructor-helpers-font-explorer": Ae `
	<% var initial = 'google'; %>
	<div class="font-explorer">
		<div class="font-explorer-wrapper">

			<div class="left-panel">

				<div class="search-icon"></div>

				<div class="view-wrapper">
					<div class="grid-view active" data-name="grid"></div>
					<div class="list-view"  data-name="list"></div>
				</div>

				<div class="back-icon"></div>


				<div class="size-wrapper">
					<div class="top-letter">A</div>
					<div class="slider"></div>
					<div class="bottom-letter">A</div>
				</div>
			</div>



			<div class="center-panel">

				<div class="search-wrapper">
					<div class="border"></div>
					<input class="search-string" type="text" placeholder=""/>
					<div class="clear invisible"></div>
				</div>


				<div class="scroll-wrapper main">
					<div class="results-wrapper">
						<div class="results" data-view="grid" data-size="4">
						</div>
					</div>
					<div class="scroll"></div>
				</div>

				<div class="scroll-wrapper info">
					<div class="results-wrapper">
						<div class="results" data-view="list" data-size="4">
						</div>
					</div>
					<div class="scroll"></div>
				</div>
			</div>



			<div class="right-panel">

				<div class="providers-switcher">
					<ul>
						<li <%=initial == 'google' ? 'class="active"' : '' %> data-name="google"></li>
            <li <%=initial == 'typetoday' ? 'class="active"' : '' %> data-name="typetoday"></li>
            <li <%=initial == 'typekit' ? 'class="active"' : '' %> data-name="typekit"></li>
					</ul>
					<span></span>
				</div>

        <div class="provider-filter <%=initial == 'typekit' ? '' : 'invisible' %>" data-name="typekit">

          <div class="filter-caption" data-initial="Classification">Classification</div>

          <div class="filter classification" data-name="classification" data-multiple="0">
            <div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>
            <div class="icon-serif" data-name="serif" data-alt="Serif"></div>
            <div class="icon-slab-serif" data-name="slab-serif" data-alt="Slab Serif"></div>
            <div class="icon-script" data-name="script" data-alt="Script"></div>
            <div class="icon-blackletter" data-name="blackletter" data-alt="Blackletter"></div>
            <div class="icon-monospaced" data-name="monospaced" data-alt="Monospaced"></div>
            <div class="icon-handmade" data-name="handmade" data-alt="Handmade"></div>
            <div class="icon-decorative" data-name="decorative" data-alt="Decorative"></div>
          </div>

          <div class="filter-caption" data-initial="For">For</div>

          <div class="filter recommended-for" data-name="recommended_for" data-multiple="1">
            <div class="icon-paragraphs" data-name="paragraphs">Paragraphs</div>
            <div class="icon-headings" data-name="headings">Headings</div>
          </div>

          <div class="filter-caption" data-initial="Properties">Properties</div>

          <div class="filter weight" data-name="weight" data-multiple="1">
            <div class="icon-light" data-name="light" data-alt="Light"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>
            <div class="icon-heavy" data-name="heavy" data-alt="Heavy"></div>
          </div>

          <div class="filter width" data-name="width" data-multiple="0">
            <div class="icon-condensed" data-name="condensed" data-alt="Condensed"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>
            <div class="icon-extended" data-name="extended" data-alt="Extended"></div>
          </div>

          <div class="filter x-height" data-name="x_height" data-multiple="0">
            <div class="icon-low" data-name="low" data-alt="Low x-height"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular x-height"></div>
            <div class="icon-high" data-name="high" data-alt="High x-height"></div>
          </div>

          <div class="filter contrast" data-name="contrast" data-multiple="0">
            <div class="icon-low" data-name="low" data-alt="Low Contrast"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular Contrast"></div>
            <div class="icon-high" data-name="high" data-alt="High Contrast"></div>
          </div>

          <div class="filter capitals" data-name="capitals" data-multiple="0">
            <div class="icon-uppercase-lowercase" data-name="uppercase-lowercase" data-alt="Standard"></div>
            <div class="icon-all-or-small-caps" data-name="all-or-small-caps" data-alt="Caps Only"></div>
          </div>

          <div class="filter number-style" data-name="number_style" data-multiple="0">
            <div class="icon-uppercase" data-name="uppercase" data-alt="Lining Figures"></div>
            <div class="icon-lowercase" data-name="lowercase" data-alt="Old Style Figures"></div>
          </div>



          <div class="language-wrapper">
            <div class="caption">Language Support</div>
            <div class="arrow"></div>

            <div class="filter language" data-name="language" data-multiple="1">
              <div class="top-left left" data-name="ca">Catalan</div>
              <div data-name="cs">Czech</div>
              <div class="top-right" data-name="de">German</div>

              <div class="left" data-name="en">English</div>
              <div data-name="es">Spanish</div>
              <div data-name="fr">French</div>

              <div class="left" data-name="it">Italian</div>
              <div data-name="nl">Dutch</div>
              <div data-name="pl">Polish</div>

              <div class="bottom-left bottom left" data-name="pt">Portugese</div>
              <div class="with-corner bottom" data-name="ru">Russian</div>
              <div class="bottom-right bottom" data-name="sv">Swedish</div>

              <span class="context-panel-corner"><span class="corner"></span></span>
            </div>
          </div>

          <a class="logo" href="http://typekit.com" target="_blank"></a>

        </div>

				<div class="provider-filter <%=initial == 'google' ? '' : 'invisible' %>" data-name="google">

					<div class="filter-caption" data-initial="Category">Category</div>

					<div class="filter classification" data-name="category" data-multiple="0">
						<div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>
						<div class="icon-serif" data-name="serif" data-alt="Serif"></div>
						<div class="icon-script" data-name="handwriting" data-alt="Handwriting"></div>
						<div class="icon-monospaced" data-name="monospace" data-alt="Monospaced"></div>
						<div class="icon-decorative" data-name="display" data-alt="Display"></div>
					</div>

					<div class="filter-caption">Properties</div>

          <div class="filter variable-fonts" data-name="variable" data-multiple="0">
            <div data-name="variable">Variable</div>
          </div>

					<div class="language-wrapper">
						<div class="caption">Language Support</div>
						<div class="arrow"></div>


						<div class="filter language" data-name="subsets" data-multiple="1">
							<div class="top-left left" data-name="cyrillic">Cyrillic</div>
							<div data-name="devanagari">Devanagari</div>
							<div class="top-right" data-name="greek">Greek</div>

							<div class="bottom-left bottom left" data-name="khmer">Khmer</div>
							<div class="with-corner bottom" data-name="latin">Latin</div>
							<div class="bottom-right bottom" data-name="vietnamese">Vietnamese</div>

							<span class="context-panel-corner"><span class="corner"></span></span>
						</div>
					</div>

					<a class="logo" href="http://google.com/fonts" target="_blank"></a>

				</div>


        <div class="provider-filter <%=initial == 'typetoday' ? '' : 'invisible' %>" data-name="typetoday">

          <div class="filter-caption" data-initial="Classification">Classification</div>

          <div class="filter classification" data-name="classification" data-multiple="0">
            <div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>
            <div class="icon-serif" data-name="serif" data-alt="Serif"></div>
          </div>

          <div class="filter-caption" data-initial="For">For</div>

          <div class="filter recommended-for" data-name="recommended_for" data-multiple="1">
            <div class="icon-paragraphs" data-name="paragraphs">Paragraphs</div>
            <div class="icon-headings" data-name="headings">Headings</div>
          </div>

          <div class="filter-caption" data-initial="Properties">Properties</div>

          <div class="filter weight" data-name="weight" data-multiple="1">
            <div class="icon-light" data-name="light" data-alt="Light"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>
            <div class="icon-heavy" data-name="heavy" data-alt="Heavy"></div>
          </div>

          <div class="filter width" data-name="width" data-multiple="0">
            <div class="icon-condensed" data-name="condensed" data-alt="Condensed"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>
            <div class="icon-extended" data-name="extended" data-alt="Extended"></div>
          </div>

          <div class="filter x-height" data-name="x_height" data-multiple="0">
            <div class="icon-low" data-name="low" data-alt="Low x-height"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular x-height"></div>
            <div class="icon-high" data-name="high" data-alt="High x-height"></div>
          </div>

          <div class="filter contrast" data-name="contrast" data-multiple="0">
            <div class="icon-low" data-name="low" data-alt="Low Contrast"></div>
            <div class="icon-regular" data-name="regular" data-alt="Regular Contrast"></div>
            <div class="icon-high" data-name="high" data-alt="High Contrast"></div>
          </div>

          <div class="filter capitals" data-name="capitals" data-multiple="0">
            <div class="icon-uppercase-lowercase" data-name="uppercase-lowercase" data-alt="Standard"></div>
            <div class="icon-all-or-small-caps" data-name="all-or-small-caps" data-alt="Caps Only"></div>
          </div>

          <div class="filter number-style" data-name="number_style" data-multiple="0">
            <div class="icon-uppercase" data-name="uppercase" data-alt="Lining Figures"></div>
            <div class="icon-lowercase" data-name="lowercase" data-alt="Old Style Figures"></div>
          </div>



          <div class="language-wrapper">
            <div class="caption">Language Support</div>
            <div class="arrow"></div>

            <div class="filter language" data-name="language" data-multiple="1">
              <div class="top-left left" data-name="ca">Catalan</div>
              <div data-name="cs">Czech</div>
              <div class="top-right" data-name="de">German</div>

              <div class="left" data-name="en">English</div>
              <div data-name="es">Spanish</div>
              <div data-name="fr">French</div>

              <div class="left" data-name="it">Italian</div>
              <div data-name="nl">Dutch</div>
              <div data-name="pl">Polish</div>

              <div class="bottom-left bottom left" data-name="pt">Portugese</div>
              <div class="with-corner bottom" data-name="ru">Russian</div>
              <div class="bottom-right bottom" data-name="sv">Swedish</div>

              <span class="context-panel-corner"><span class="corner"></span></span>
            </div>
          </div>

          <a class="logo" href="https://type.today" target="_blank"></a>

        </div>

				<div class="font-info">
					<div class="top-info">
						<div class="name"></div>
						<div class="foundry">by <a target="_blank" href="http://123"></a></div>
						<div class="description-wrapper huge">
							<div class="description"></div>
							<a class="more" target="_blank" href="http://123">More...</a>
						</div>
						<div class="promo">To get more styles of this typeface visit <a href="https://type.today" target="_blank">type.today</a></div>
					</div>
					<div class="bottom-info">
						<div class="language-wrapper">
							<div class="caption">Language Support:</div>
							<div class="language">
								<div class="language-clamp"></div>
							</div>
						</div>
						<div class="recommended-wrapper">
							<div class="caption">Recommended For:</div>
							<div class="recommended"></div>
						</div>
						<div class="info-add-remove-font">Add to Font Selector</div>
					</div>
				</div>
			</div>



			<div class="overlay">
				<div class="preloader"></div>
			</div>

		</div>
	</div>
`,
        "template-constructor-helpers-font-explorer-item": Ae `
	<div class="font-item" data-img1="<%=img1%>" data-img2="<%=img2%>" data-font-name="<%=name%>" data-font-id="<%=id%>" data-font-provider="<%=provider%>">
		<div class="caption"><%=text%><span class="styles-count"><%=styles%> <%=Utils.declination('styles', 'style', 'styles', styles)%></span></div>
		<div class="list-add-remove-font"></div>
	</div>
`,
        "template-constructor-helpers-font-explorer-no-found": Ae `
	<div class="no-found">
		<div class="header">Fk</div>
		<div class="sub-header">Sorry, no fonts found.</div>
		<div class="message">Try selecting fewer options.</div>
	</div>
`
    }
});
var TD, BD = k(() => {
    "use strict";
    no();
    TD = {
        "template-constructor-helpers-typekit-popup": Ae `

	<div class="typekit-popup">
		<div class="full-house">Full House</div>
		<div class="error-message">Sadly, but you cannot store more than 5 of Typekits fonts in your font selector. Please remove one and try again.</div>

		<div class="corner-wrapper">
			<div class="corner"></div>
		</div>
	</div>

`
    }
});
var w_, MD, ku, NK, Hb, x_ = k(() => {
    "use strict";
    w_ = E(Ze()), MD = E(To()), ku = E(ze());
    BD();
    NK = MD.default.View.extend({
        initialize: function(e) {
            ku.default.bindAll(this), ku.default.extend(this, e), this.destroy.__debounced = ku.default.debounce(this.destroy, 0), !this.$parent.hasClass("typekit-popup-shown") && (this.template = TD["template-constructor-helpers-typekit-popup"], this.render(), ku.default.defer(this.show))
        },
        TOP_POPUP_TRESHOLD: 170,
        render: function() {
            let e, t;
            this.setElement((0, w_.default)(this.template({}))), this.$parent.addClass("typekit-popup-shown"), this.$parent.on("mouseleave", this.setPopupTimeout), this.$parent.on("mouseenter", this.resetPopupTimeout), this.$parent.on("click", this.destroy.__debounced), e = Math.round(this.$parent.offset().left + this.$parent.width() / 2), t = Math.round(this.$parent.offset().top), this.$el.toggleClass("popup-below", t - this.TOP_POPUP_TRESHOLD < 0), (0, w_.default)("body").append(this.$el), this.$el.css({
                left: e,
                top: t
            })
        },
        show: function() {
            this.$el.addClass("shown")
        },
        setPopupTimeout: function() {
            this.$parent.hasClass("typekit-popup-shown") && (this.popupTimer = setTimeout(this.destroy.__debounced, 500))
        },
        resetPopupTimeout: function() {
            clearTimeout(this.popupTimer)
        },
        destroy: function() {
            this.$parent.removeClass("typekit-popup-shown"), this.$parent.off("mouseleave", this.setPopupTimeout), this.$parent.off("mouseenter", this.resetPopupTimeout), this.$parent.off("click", this.destroy.__debounced), clearTimeout(this.popupTimer), this.$el.removeClass("shown"), setTimeout(ku.default.bind(function() {
                this.$el.off().remove()
            }, this), 300)
        }
    }), Hb = NK
});
var RD, ED = k(() => {
    "use strict";
    RD = ["Assistant", "Bitter", "Cabin", "Catamaran", "Caveat", "Changa", "Cinzel", "Comfortaa", "Commissioner", "Crimson Pro", "Cuprum", "Dancing Script", "Domine", "Dosis", "EB Garamond", "Encode Sans", "Epilogue", "Exo", "Exo 2", "Faustina", "Fira Code", "Grandstander", "Grenze Gotisch", "Heebo", "Hepta Slab", "Ibarra Real Nova", "Inconsolata", "Inter", "Josefin Sans", "Jost", "Jura", "Kreon", "Kufam", "Lemonada", "Libre Franklin", "Literata", "Lora", "Manrope", "Manuale", "Markazi Text", "Maven Pro", "Merriweather Sans", "Mulish", "MuseoModerno", "Orbitron", "Oswald", "Oxanium", "Petrona", "Piazzolla", "Playfair Display", "Podkova", "Public Sans", "Quicksand", "Raleway", "Recursive", "Red Rose", "Roboto Mono", "Roboto Slab", "Rokkitt", "Rosario", "Rubik", "Ruda", "Sansita Swashed", "Signika", "Sora", "Space Grotesk", "Spartan", "Syne", "Trispace", "Varta", "Vollkorn", "Work Sans", "Yanone Kaffeesatz"]
});
var Xe, FD, ri, UK, DD, AD = k(() => {
    "use strict";
    Xe = E(Ze()), FD = E(To()), ri = E(ze());
    Wt();
    bh();
    PD();
    x_();
    Fp();
    ED();
    FC();
    UK = FD.default.View.extend({
        events: {
            "click .view-wrapper .grid-view, .view-wrapper .list-view": "switchView",
            "click .size-wrapper .top-letter, .size-wrapper .bottom-letter": "onSizeLetterClick",
            "click .right-panel .providers-switcher li": "switchProvider",
            "click .right-panel .provider-filter .language-wrapper": "toggleLanguage",
            "click .scroll-wrapper.main .results .font-item .list-add-remove-font": "addRemoveFont",
            "mouseenter .scroll-wrapper.main .results .font-item ": "checkAddRemoveState",
            "click .right-panel .font-info .bottom-info .info-add-remove-font": "addRemoveFont",
            "mousedown .scroll-wrapper.main .results .font-item": "onFontItemMouseDown",
            "mousemove .scroll-wrapper.main .results .font-item": "onFontItemMouseMove",
            "mouseup .scroll-wrapper.main .results .font-item": "onFontItemMouseUp",
            "click .scroll-wrapper.main .results .font-item": "openInfo",
            "click .search-icon": "toggleSearch",
            "click .back-icon": "closeInfo",
            "input .search-wrapper .search-string": "onSearchStringChange",
            "keypress .search-wrapper .search-string": "onSearchStringKey",
            "keyup .search-wrapper .search-string": "onSearchStringKey",
            "keydown .search-wrapper .search-string": "onSearchStringKey",
            "click .search-wrapper .clear": "onClearSearchString",
            click: "closeLanguage",
            "click .filter div": "onFilterItemClick",
            "mouseenter .filter div": "onFilterMouseEnter",
            "mouseleave .filter div": "onFilterMouseLeave"
        },
        PAGINATION: 4,
        DATA_URL: window.fontsConfig.fontslist,
        IMGS_URL: window.fontsConfig.fontsimgs,
        LANGUAGE_MAP: {
            cyrillic: "cyrillic",
            devanagari: "devanagari",
            greek: "greek",
            khmer: "khmer",
            latin: "latin",
            vietnamese: "vietnamese",
            ca: "latin",
            cs: "latin",
            de: "latin",
            en: "latin",
            es: "latin",
            fr: "latin",
            it: "latin",
            nl: "latin",
            pl: "latin",
            pt: "latin",
            ru: "cyrillic",
            sv: "latin"
        },
        LANGUAGE_NAMES: {
            cyrillic: "Cyrillic",
            devanagari: "Devanagari",
            greek: "Greek",
            khmer: "Khmer",
            latin: "Latin",
            vietnamese: "Vietnamese",
            ab: "Abkhazian",
            af: "Afrikaans",
            az: "Azerbaijani",
            ba: "Bahasa",
            be: "Belarusian",
            bg: "Bulgarian",
            ca: "Catalan",
            ce: "Chechen",
            cs: "Czech",
            cv: "Chuvash",
            da: "Danish",
            de: "German",
            en: "English",
            eo: "Esperanto",
            es: "Spanish",
            et: "Estonian",
            fi: "Finnish",
            fr: "French",
            gd: "Gaelic",
            gl: "Galician",
            hr: "Croatian",
            hu: "Hungarian",
            is: "Icelandic",
            it: "Italian",
            kk: "Kazakh",
            ku: "Kurdish",
            ky: "Kyrgyz",
            lt: "Lithuanian",
            lv: "Latvian",
            mt: "Maltese",
            mn: "Mongolian",
            nl: "Dutch",
            no: "Norwegian",
            pl: "Polish",
            pt: "Portuguese",
            ro: "Romanian",
            ru: "Russian",
            sk: "Slovak",
            sl: "Slovenian",
            sq: "Albanian",
            sr: "Serbian",
            sv: "Swedish",
            tg: "Tajik",
            tk: "Turkmen",
            tr: "Turkish",
            tt: "Tatar",
            uk: "Ukrainian",
            uz: "Uzbek"
        },
        FVD_NAMES: Rs,
        CHARSETS_PRIORITY_FILTER_ON: ["cyrillic", "greek", "vietnamese", "devanagari", "khmer", "latin"],
        CHARSETS_PRIORITY_FILTER_OFF: ["latin", "cyrillic", "greek", "vietnamese", "devanagari", "khmer"],
        FVD_PRIORITY_REGULAR: ["n4", "i4", "n3", "i3", "n5", "i5", "n2", "i2", "n6", "i6", "n1", "i1", "n7", "i7", "n8", "i8", "n9", "i9"],
        FVD_PRIORITY_LIGHT: ["n1", "i1", "n2", "i2", "n3", "i3", "n4", "i4", "n5", "i5", "n6", "i6", "n7", "i7", "n8", "i8", "n9", "i9"],
        FVD_PRIORITY_HEAVY: ["n9", "i9", "n8", "i8", "n7", "i7", "n6", "i6", "n5", "i5", "n4", "i4", "n3", "i3", "n2", "i2", "n1", "i1"],
        initialize: function() {
            ri.default.bindAll(this), this.template = jb["template-constructor-helpers-font-explorer"], this.itemTemplate = jb["template-constructor-helpers-font-explorer-item"], this.noFoundTemplate = jb["template-constructor-helpers-font-explorer-no-found"], this.applyFilter.__debounced = ri.default.debounce(this.applyFilter, 150), this.loadVisibleFontPreviews.__debounced = ri.default.debounce(this.loadVisibleFontPreviews, 300)
        },
        render: function() {
            this.setElement((0, Xe.default)(this.template({})).insertAfter("#constructor")), this.$mainList = this.$(".scroll-wrapper.main .results-wrapper .results"), this.$infoList = this.$(".scroll-wrapper.info .results-wrapper .results"), this.mainScroll = (0, Xe.default)(this.$mainList.closest(".scroll-wrapper")).RMScroll({
                $container: this.$mainList.closest(".results-wrapper"),
                $content: this.$mainList,
                $handle: this.$mainList.closest(".scroll-wrapper").find(".scroll"),
                onScroll: this.onFontsScroll,
                gap_start: 8,
                gap_end: 8
            }).data("scroll"), this.infoScroll = (0, Xe.default)(this.$infoList.closest(".scroll-wrapper")).RMScroll({
                $container: this.$infoList.closest(".results-wrapper"),
                $content: this.$infoList,
                $handle: this.$infoList.closest(".scroll-wrapper").find(".scroll"),
                gap_start: 8,
                gap_end: 8
            }).data("scroll");
            let e = (0, Xe.default)(this.$(".size-wrapper .slider"));
            if (this.sizeSlider = e.slider({
                    min: 1,
                    max: 7,
                    value: 4,
                    orientation: "vertical",
                    start: function() {
                        (0, Xe.default)("body").addClass("ns-resize-cursor"), e.addClass("dragging")
                    },
                    stop: function() {
                        (0, Xe.default)("body").removeClass("ns-resize-cursor"), e.removeClass("dragging")
                    },
                    change: this.sizeChanged,
                    slide: this.sizeChanged
                }), RM.constructorRouter && RM.constructorRouter.previewMode) {
                let t = Math.round(Math.abs(window.innerHeight - this.$el.height()) / 2);
                this.$el.css({
                    position: "fixed",
                    "margin-top": 0,
                    top: t + "px"
                })
            }
            this.loadFontsData(),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: t
                }) => {
                    t("fontexplorer")
                }), this.rendered = !0
        },
        loadFontsData: function() {
            let e = this,
                t = new Date().toISOString().split("T")[0];
            Xe.default.ajax({
                type: "GET",
                url: this.DATA_URL + "?timestamp=" + t + "&callback=?",
                jsonpCallback: "fontsListCallback",
                contentType: "application/json",
                cache: !0,
                dataType: "jsonp",
                success: function(o) {
                    e.$(".overlay").remove(), o.typetoday = o.typetoday.filter(i => !i.deprecated).map(i => i.deprecated_variations && i.deprecated_variations.length ? { ...i,
                        variations: ri.default.difference(i.variations, i.deprecated_variations)
                    } : i), o.google.forEach(function(i) {
                        RD.includes(i.family) && (i.variable = "variable")
                    }), e.fontsData = o, e.applyFilter()
                },
                error: function() {
                    console.log(arguments)
                }
            })
        },
        buildFilter: function() {
            let e = this.$(".right-panel .providers-switcher li.active").attr("data-name"),
                t = this.$('.right-panel .provider-filter[data-name="' + e + '"]'),
                o = {},
                i = this.$(".search-icon").hasClass("active"),
                n = "";
            return i ? n = Xe.default.trim(this.$(".search-wrapper .search-string").val()) : t.find(".filter div.active").each(function() {
                let s = (0, Xe.default)(this),
                    a = s.parent().attr("data-name"),
                    l = s.attr("data-name");
                o[a] || (o[a] = []), o[a].push(l)
            }), {
                provider: e,
                filter: o,
                search: n
            }
        },
        applyFilter: function() {
            if (!this.fontsData) return;
            let e = this.buildFilter(),
                t = e.provider,
                o = e.filter,
                i = e.search,
                n = this.fontsData[t],
                s, a, l, c;
            if (this.$(".search-wrapper .search-string").attr("placeholder", "Search " + n.length + " fonts"), JSON.stringify(this.filter) == JSON.stringify(e)) return;
            n = ri.default.filter(n, function(h) {
                h = h.browse_info ? h.browse_info : h, c = !0;
                for (s in o)
                    if (l = o[s], a = ri.default.isArray(h[s]) ? h[s] : [h[s]], c = c && ri.default.intersection(l, a).length, !c) return;
                return c
            });
            let d = ri.default.compact(be.escapeRegExp(i).split(" ")),
                p = new RegExp(d.join(".*?"), "i");
            n = ri.default.filter(n, function(h) {
                let u = h.name || h.family;
                return p.test(u)
            }), this.filteredFonts = n, this.filter = e, this.$mainList.empty(), this.mainScroll.recalc()
        },
        showFilteredFontsPortion: function() {
            if (!this.filteredFonts) return;
            let e = this,
                t = Modernizr.retina ? "@2x" : "",
                o = this.$mainList.find(".font-item").length,
                i = this.filteredFonts.length,
                n = o,
                s = Math.min(i - o, this.PAGINATION),
                a = this.filter.provider,
                l = this.filter.filter,
                c = (a == "google" ? [] : l.weight) || [],
                d = (a == "google" ? l.subsets : l.language) || [];
            if (i == 0) {
                this.$mainList.append(this.noFoundTemplate({}));
                return
            }
            if (s == 0) return;
            for (let f = n; f < n + s; f++) {
                let g = this.filteredFonts[f],
                    y = p(g.id || g.family || g.name),
                    S = h(a == "google" ? g.subsets : g.browse_info ? g.browse_info.language : ["en"], d),
                    w = u(g.variations, c),
                    v = a + "_" + y + "_" + S + "_" + w;
                this.$mainList.append(this.itemTemplate({
                    img1: v,
                    img2: t + ".png?t=" + g.lastModified,
                    text: g.name || g.family,
                    name: g.name || g.family,
                    id: g.id || g.name || g.family,
                    styles: g.variations.length,
                    provider: a,
                    Utils: be
                }))
            }
            this.mainScroll.recalc();

            function p(f) {
                return f.toLowerCase().split(" ").join("-")
            }

            function h(f, g) {
                f = g.length ? ri.default.intersection(f, g) : f, f = f.length ? f : ["latin"];
                let y = m(f),
                    S = g.length ? e.CHARSETS_PRIORITY_FILTER_ON : e.CHARSETS_PRIORITY_FILTER_OFF;
                return ri.default.intersection(S, y)[0]
            }

            function u(f, g) {
                g = g.length ? g : ["regular"];
                let y = g[0],
                    S;
                return y == "light" && (S = e.FVD_PRIORITY_LIGHT), y == "regular" && (S = e.FVD_PRIORITY_REGULAR), y == "heavy" && (S = e.FVD_PRIORITY_HEAVY), ri.default.intersection(S, f)[0]
            }

            function m(f) {
                let g = {};
                for (let y = 0; y < f.length; y++) e.LANGUAGE_MAP[f[y]] && (g[e.LANGUAGE_MAP[f[y]]] = !0);
                return Object.keys(g)
            }
        },
        loadVisibleFontPreviews: function() {
            let e = this.IMGS_URL + this.$mainList.attr("data-view") + "_",
                t = this.$mainList.parent().scrollTop(),
                o = this.$mainList.parent().height();
            this.$mainList.find(".font-item").each(function() {
                let i = (0, Xe.default)(this),
                    n = e + i.attr("data-img1") + i.attr("data-img2");
                if (!i.attr("data-loaded")) {
                    let s = i.height(),
                        a = i.position().top;
                    a + s > t && a < o + t && (i.css("background-image", 'url("' + n + '")'), i.attr("data-loaded", !0))
                }
            })
        },
        onFontsScroll: function(e) {
            e.content_size - e.container_size - e.scroll_pos < 100 && this.showFilteredFontsPortion(), this.loadVisibleFontPreviews.__debounced()
        },
        switchView: function(e) {
            let t = (0, Xe.default)(e.target);
            if (t.hasClass("active")) return;
            t.addClass("active").siblings().removeClass("active");
            let o = this.$mainList.parent().scrollTop(),
                i, n = 0;
            this.$mainList.find(".font-item").each(function() {
                if (i = (0, Xe.default)(this), n = i.position().top - o, n >= 0) return !1
            }), this.$mainList.attr("data-view", t.attr("data-name")), this.$mainList.find(".font-item").removeAttr("data-loaded").css("background-image", ""), this.mainScroll.recalc(), this.$mainList.parent().scrollTop(i.position().top - n)
        },
        switchProvider: function(e) {
            let t = (0, Xe.default)(e.target);
            t.hasClass("active") || (t.addClass("active").siblings().removeClass("active"), this.$(".provider-filter").addClass("invisible"), this.$('.provider-filter[data-name="' + t.attr("data-name") + '"]').removeClass("invisible"), this.applyFilter())
        },
        onFilterItemClick: function(e) {
            let t = (0, Xe.default)(e.target),
                o = t.closest(".filter"),
                i = !!(o.attr("data-multiple") - 0);
            t.attr("data-name") && (t.toggleClass("active"), i || t.siblings("div").removeClass("active"), o.hasClass("language") && this.updateLangs(o), this.applyFilter())
        },
        sizeChanged: function(e, t) {
            this.$mainList.attr("data-size", t.value), this.mainScroll.recalc(), this.$infoList.attr("data-size", t.value), this.infoScroll.recalc()
        },
        onSearchStringKey: function(e) {
            if (e.stopPropagation(), e.keyCode == Xe.default.keycodes.esc && e.preventDefault(), e.type == "keyup") {
                if (e.keyCode == Xe.default.keycodes.esc) {
                    this.$(".search-wrapper .search-string").val() != "" ? this.clearSearchString() : this.toggleSearch();
                    return
                }
                e.keyCode == Xe.default.keycodes.enter && (e.preventDefault(), this.applyFilter())
            }
        },
        onSearchStringChange: function() {
            let e = this.$(".search-wrapper .search-string").val();
            this.$(".search-wrapper .clear").toggleClass("invisible", e == ""), this.applyFilter.__debounced()
        },
        clearSearchString: function() {
            this.$(".search-wrapper .search-string").blur().val("").focus(), this.onSearchStringChange()
        },
        onClearSearchString: function() {
            this.clearSearchString(), this.toggleSearch()
        },
        toggleSearch: function() {
            clearTimeout(this.searchFocusTimeout), this.$(".search-icon").toggleClass("active"), this.$(".search-wrapper").toggleClass("shift-down"), this.$(".scroll-wrapper.main").toggleClass("shift-down"), this.$(".search-icon").hasClass("active") ? this.searchFocusTimeout = setTimeout(ri.default.bind(function() {
                this.$(".search-wrapper .search-string").focus()
            }, this), 700) : th(), this.applyFilter(), setTimeout(function() {
                this.mainScroll.recalc()
            }.bind(this), 300)
        },
        addRemoveFont: function(e) {
            e.stopPropagation();
            let t = (0, Xe.default)(e.target).closest(".font-item, .info-add-remove-font"),
                o = t.hasClass("removable") ? "remove" : "add",
                i = t.attr("data-font-provider"),
                n = t.attr("data-font-id"),
                s = t.attr("data-font-name"),
                a = {};
            i == "typekit" && (a = {
                id: n
            }), i == "webtype" && (a = {
                name: n
            }), i == "google" && (a = {
                family: n
            }), i == "typetoday" && (a = {
                name: n
            });
            let l = ri.default.findWhere(this.fontsData[i], a);
            o == "remove" ? RM.constructorRouter.fonts.removeFonts([n]) : RM.constructorRouter.fonts.addFonts([{
                provider: i,
                css_name: n,
                name: s,
                variations: l.variations,
                temporary: !0
            }], "font-explorer").error && new Hb({
                $parent: t.hasClass("font-item") ? t.find(".list-add-remove-font") : t
            }), this.checkAddRemoveState(t)
        },
        checkAddRemoveState: function(e) {
            let t = (0, Xe.default)(e.target || e),
                o = RM.constructorRouter.fonts.getUsedFontsCache(),
                i = t.attr("data-font-id"),
                n = o[i],
                s = n && !n.hidden;
            t.toggleClass("removable", !!s), t.hasClass("info-add-remove-font") && t.text(s ? "Remove from Font Selector" : "Add to Font Selector")
        },
        closeInfo: function() {
            this.$(".font-explorer-wrapper").removeClass("info-mode")
        },
        onFontItemMouseDown: function() {
            this.fontItemMouseDown = !0
        },
        onFontItemMouseMove: function() {
            this.fontItemMouseDown && (this.preventFontItemClick = !0)
        },
        onFontItemMouseUp: function() {
            this.fontItemMouseDown = !1
        },
        openInfo: function(e) {
            if (this.preventFontItemClick) {
                this.preventFontItemClick = !1;
                return
            }
            let t = (0, Xe.default)(e.target).closest(".font-item");
            this.$(".font-explorer-wrapper").addClass("info-mode"), this.$infoList.empty();
            let o = this,
                i = t.attr("data-font-provider"),
                n = t.attr("data-font-id"),
                s = t.attr("data-font-name"),
                a = {};
            i == "typekit" && (a = {
                id: n
            }), i == "webtype" && (a = {
                name: n
            }), i == "google" && (a = {
                family: n
            }), i == "typetoday" && (a = {
                name: n
            });
            let l = ri.default.findWhere(this.fontsData[i], a),
                c = i == "google" ? "Google Fonts" : l.foundry,
                d = i == "google" ? "http://www.google.com/fonts/specimen/" + s.split(" ").join("+") : l.web_link,
                p = l.description,
                h = l.variations,
                u = t.attr("data-img1"),
                m = t.attr("data-img2"),
                f, g, y, S = (0, Xe.default)('<a target="_blank" href="' + l.web_link + '">More...</a>');
            g = l.subsets || l.browse_info && l.browse_info.language || [], g = ri.default.map(g, function(M) {
                return be.capitalize(o.LANGUAGE_NAMES[M] || M)
            });
            let w = (0, Xe.default)(".font-info .language-wrapper .language"),
                v = (0, Xe.default)(".font-info .language-clamp");
            for (var C = g.length; C > 0 && (f = g.slice(0, C).join(", "), !(C == g.length && (v.empty().text(f), v.height() <= w.height()) || (v.empty().text(f + ", ").append(S), v.height() <= w.height()))); C--);
            y = l.browse_info && l.browse_info.recommended_for || [], y = ri.default.map(y, function(M) {
                return be.capitalize(o.LANGUAGE_NAMES[M] || M)
            }), y = y.join(" & ");
            for (var C = 0; C < h.length; C++) {
                let F = (0, Xe.default)(this.itemTemplate({
                        img1: "",
                        img2: "",
                        text: Ln.getCustomVariationNameByFVD(l.name, h[C]) || this.FVD_NAMES[h[C]],
                        name: "",
                        id: "",
                        styles: "",
                        provider: "",
                        Utils: be
                    })),
                    R = this.IMGS_URL + "list_" + u.substr(0, u.length - 2) + h[C] + m;
                F.css("background-image", 'url("' + R + '")'), this.$infoList.append(F), F.attr("data-loaded", !0)
            }
            this.infoScroll.recalc();
            let I = this.$(".right-panel .font-info"),
                T = (0, Xe.default)(".bottom-info .info-add-remove-font", I);
            (0, Xe.default)(".name", I).text(s), (0, Xe.default)(".foundry", I).toggleClass("hidden", !c), (0, Xe.default)(".foundry a", I).text(c).attr("href", d), (0, Xe.default)(".description-wrapper", I).toggleClass("hidden", !p), (0, Xe.default)(".description-wrapper .description", I).text(p), (0, Xe.default)(".description-wrapper .more", I).attr("href", d), (0, Xe.default)(".language-wrapper", I).toggleClass("hidden", !f), (0, Xe.default)(".recommended-wrapper", I).toggleClass("hidden", !y), (0, Xe.default)(".recommended-wrapper .recommended", I).text(y), (0, Xe.default)(".promo", I).toggleClass("hidden", i !== "typetoday"), (0, Xe.default)(".promo a", I).attr("href", l.web_link);
            let P = (0, Xe.default)(".description-wrapper .description", I);
            (0, Xe.default)(".description-wrapper", I).toggleClass("huge", P.height() == parseInt(P.css("max-height"), 10)), T.attr("data-font-provider", i).attr("data-font-id", n).attr("data-font-name", s), this.checkAddRemoveState(T)
        },
        toggleLanguage: function(e) {
            let t = (0, Xe.default)(e.currentTarget);
            (0, Xe.default)(e.target).closest(".filter.language").length || t.toggleClass("active")
        },
        closeLanguage: function(e) {
            (0, Xe.default)(e.target).closest(".language-wrapper").length || this.$(".language-wrapper").removeClass("active")
        },
        updateLangs: function(e) {
            let t = e.find("div.active"),
                o = [];
            t.each(function() {
                o.push((0, Xe.default)(this).text())
            }), e.closest(".language-wrapper").find(".caption").text(o.length ? o.join(", ") : "Language Support")
        },
        onFilterMouseEnter: function(e) {
            let t = (0, Xe.default)(e.target);
            if (!t.attr("data-alt")) return;
            let o = t.parent().prevAll(".filter-caption").first();
            o.text(t.attr("data-alt")), clearTimeout(o.data("clear-timer"))
        },
        onFilterMouseLeave: function(e) {
            let t = (0, Xe.default)(e.target);
            if (!t.attr("data-alt")) return;
            let o = t.parent().prevAll(".filter-caption").first();
            o.data("clear-timer", setTimeout(function() {
                o.text(o.attr("data-initial"))
            }, 100))
        },
        onSizeLetterClick: function(e) {
            let t = (0, Xe.default)(e.target),
                o = this.sizeSlider.slider("value"),
                i = t.hasClass("top-letter") ? 1 : -1;
            this.sizeSlider.slider("value", o + i)
        },
        onBodyKey: function(e) {
            this.$(".search-input").is(":focus") || ((e.keyCode == Xe.default.keycodes.esc || e.keyCode == Xe.default.keycodes.backspace) && (e.preventDefault(), e.stopPropagation()), e.type == "keyup" && (e.keyCode == Xe.default.keycodes.esc && (this.$(".font-explorer-wrapper").hasClass("info-mode") ? this.closeInfo() : this.hide()), e.keyCode == Xe.default.keycodes.backspace && (this.$(".font-explorer-wrapper").hasClass("info-mode") ? this.closeInfo() : this.hide()), e.keyCode == Xe.default.keycodes.f && this.toggleSearch()))
        },
        onMouseWheel: function(e) {
            e && e.stopPropagation(), e && e.preventDefault()
        },
        disableMouseWheel: function() {
            (0, Xe.default)(document).bind("mousewheel", this.onMouseWheel)
        },
        enableMouseWheel: function() {
            (0, Xe.default)(document).unbind("mousewheel", this.onMouseWheel)
        },
        show: function() {
            if (!this.rendered) {
                this.render(), ri.default.defer(this.show);
                return
            }
            this.disableMouseWheel(), this.$block_layer = RM.constructorRouter.showBlockLayer(this.hide), this.$el.removeClass("show-out").addClass("show-in").css("display", "block"), setTimeout(ri.default.bind(function() {
                this.$el.removeClass("show-in")
            }, this), 20), setTimeout(ri.default.bind(function() {
                this.$el.css("width", "+=1")
            }, this), 300), setTimeout(ri.default.bind(function() {
                this.$el.css("width", "-=1")
            }, this), 300), (0, Xe.default)("body").on("keypress keyup keydown", this.onBodyKey), this.shown = !0
        },
        hide: function(e) {
            e && e.stopPropagation(), this.enableMouseWheel(), RM.constructorRouter.hideBlockLayer(this.$block_layer), (0, Xe.default)("body").off("keypress keyup keydown", this.onBodyKey), this.$el.addClass("show-out"), setTimeout(ri.default.bind(function() {
                this.$el.css("display", "none")
            }, this), 200), th(), this.$(".language-wrapper").removeClass("active"), RM.constructorRouter.fonts.clearTempFonts(), this.shown = !1
        },
        toggle: function() {
            this.shown ? this.hide() : this.show(), this.trigger("toggle")
        }
    }), DD = UK
});
var cm, LD = k(() => {
    "use strict";
    no();
    cm = {
        "template-constructor-helpers-font-selector": Ae `

	<div class="rmfontselector">

		<div class="tabs-switcher">
			<div class="caption-system">System</div>
			<div class="caption-custom">Custom</div>
		</div>

		<div class="categories">

			<div class="scroll-wrapper system">
				<div class="category-wrapper">
					<div class="category">
					</div>
				</div>
				<div class="scroll"></div>
			</div>

			<div class="scroll-wrapper custom">
				<div class="category-wrapper">
					<div class="category">
					</div>
				</div>
				<div class="scroll"></div>
			</div>

		</div>


		<div class="add-font">
			<div class="add-font-button" data-type="upload">Upload</div>
			<div class="add-font-button" data-type="library">Library</div>
		</div>

		<div class="upload-font invisible"></div>
	</div>

`,
        "template-constructor-helpers-font-selector-item": Ae `

	<div class="category-element icon-<%=font.provider%> <% if (font.hidden) {%>hidden<%};%>  <%= font.is_personal && !canUploadFonts ? 'disabled' : '' %> <%= font.is_personal ? 'personal' : '' %>" data-css_name="<%=font.css_name%>" data-provider="<%=font.provider%>">
		<% if (font.provider != 'system' && !(font.provider == 'custom' && !font.is_personal)) { %>

		<!--   /  -->
		<% if (!(font.provider == 'custom' && !canEditCustomFonts)) { %>
		<div class="action"></div>
		<% } %>

			<% if (font.provider == 'custom' && font.is_personal && canEditCustomFonts) { %>
				<div class="edit-custom-font"></div>
			<% } else { %>
				<a class="tp-icon" target="_blank" title="<%-provider_data.title%>" <%=(provider_data.url ? 'href="' + provider_data.url + '"' : "")%>></a>
			<% } %>
		<% } %>
		<div style="font-family:<%=font.css_name%>" class="caption"><%=font.name%></div>
	</div>

`,
        "template-constructor-helpers-font-selector-upload": Ae `
	<div class="uf-section font-name">
		<input type="text" name="font-name-input" class="font-name-input" placeholder="Enter font name" value="<%- name %>"/>
	</div>

	<div class="uf-section weight-list invisible">
		<div class="uf-panel weights">
			<div class="scroll-wrapper">
				<div class="results-wrapper">
					<div class="results">
						<div class="list">
						</div>
						<div class="button add-weight">Add weight</div>
						<a class="uf-link add-tracking-code" href="http://help.readymag.com/hc/en-us/articles/360018417451-Text" target="_blank"><span>Add tracking code</span></a>
					</div>
				</div>
				<div class="gutter"></div>
				<div class="scroll"></div>
			</div>
		</div>
		<div class="uf-panel selector invisible">
			<div class="available-list">
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n1">Thin</div>
					<div class="weight-item italic" data-var="i1">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n2">ExtraLight</div>
					<div class="weight-item italic" data-var="i2">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n3">Light</div>
					<div class="weight-item italic" data-var="i3">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n4">Regular</div>
					<div class="weight-item italic" data-var="i4">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n5">Medium</div>
					<div class="weight-item italic" data-var="i5">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n6">SemiBold</div>
					<div class="weight-item italic" data-var="i6">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n7">Bold</div>
					<div class="weight-item italic" data-var="i7">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n8">ExtraBold</div>
					<div class="weight-item italic" data-var="i8">Italic</div>
				</div>
				<div class="available-weight">
					<div class="bullet"></div>
					<div class="weight-item name" data-var="n9">Black</div>
					<div class="weight-item italic" data-var="i9">Italic</div>
				</div>
			</div>
		</div>
		<div class="uf-panel uploader invisible">
			<div class="button select">Regular</div>
			<div class="button upload">
				<span>Upload .woff</span>
				<input class="font-file-upload" id="font-file-upload" type="file" accept=".woff" data-url="/api/upload/font"/>
			</div>
			<div class="disclaimer">By uploading webfonts you<br/>agree that you own or have<br/>the necessary license.</div>
		</div>
	</div>

	<div class="uf-section actions">
		<div class="done disabled"><span class="caption">Done</span></div>
	</div>
	<div class="dragover-overlay"></div>
`,
        "template-constructor-helpers-font-selector-upload-weights": Ae `
	<% _.each(weights, function(w) { %>
		<div class="weight" data-type="<%= w.type%>">
			<div class="name"><%= names[w.type]%></div>
			<div class="reupload-weight">
				<input class="font-file-re-upload" id="font-file-re-upload" type="file" accept=".woff" data-url="/api/upload/font"/>
			</div>
			<div class="delete-weight"></div>
		</div>
	<% }) %>
`
    }
});
var Ni, Iu, jt, VK, GK, zD, $D = k(() => {
    "use strict";
    Ni = E(Ze()), Iu = E(To()), jt = E(ze());
    oo();
    AD();
    LD();
    cj();
    x_();
    Fp();
    RM.views.fontExplorer = new DD;
    VK = Iu.default.View.extend({
        name: "FontSelector",
        initialize: function(e) {
            this.model = RM.constructorRouter.fonts, this.settings = {}, this.old_fonts = [], jt.default.bindAll(this), jt.default.extend(this.settings, e), this.mag = RM.constructorRouter.mag.toJSON(), this.settings.canUploadFonts = RM.constructorRouter.isOwner ? (RM.constructorRouter.me.get("permissions") || {}).can_use_custom_fonts : this.mag.user.permissions.can_use_custom_fonts, this.settings.canEditCustomFonts = this.mag.doesUserHaveAccess, this.template = cm["template-constructor-helpers-font-selector"], this.item_template = cm["template-constructor-helpers-font-selector-item"], this.create()
        },
        create: function() {
            this.render(), this.switchToCategory(this.model.get("fonts_tab") || "custom"), this.model.on("change:fonts", this.onFontsChange)
        },
        render: function() {
            let e = this.settings.css && this.settings.css.left || 0,
                t = this.settings.css && this.settings.css.top || 0;
            this.setElement((0, Ni.default)(this.template({})).css({
                display: "none",
                left: e,
                top: t
            })), this.settings.$parent.append(this.$el), this.$addFontPopup = this.$(".add-font-popup"), this.$el.on("click", ".tabs-switcher .caption-system", jt.default.bind(function() {
                this.switchToCategory("system")
            }, this)), this.$el.on("click", ".tabs-switcher .caption-custom", jt.default.bind(function() {
                this.switchToCategory("custom")
            }, this)), this.$el.on("click", this.onGlobalClickHandler), this.$el.on("mouseenter", ".category-element .caption", this.checkTitleShowForLongFontName), this.$el.on("click", ".category-element .edit-custom-font", this.onEditCustomFontClick), this.$el.on("click", ".add-font-button", this.onAddFontButtonClick), this.onFontsChange(), this.scroll = {
                system: this.createScroll("system"),
                custom: this.createScroll("custom")
            }, this.settings.canEditCustomFonts || this.$(".add-font-button[data-type=upload]").remove()
        },
        onFontsChange: function() {
            let e = this.old_fonts,
                t = this.model.get("fonts"),
                o = jt.default.map(e, function(c) {
                    return c.provider + "|" + c.css_name
                }),
                i = jt.default.map(t, function(c) {
                    return c.provider + "|" + c.css_name
                }),
                n = this;
            clearTimeout(this.reinitTimeout);
            let s = jt.default.difference(i, o),
                a = jt.default.difference(o, i),
                l = jt.default.intersection(o, i);
            jt.default.each(s, function(c) {
                let d = c.split("|"),
                    p = d[0],
                    h = d[1],
                    u = n.$(".categories .scroll-wrapper." + (p == "system" ? "system" : "custom") + " .category"),
                    m = n.model.findFontByCSSName(h),
                    f = n.model.getProviderData(p),
                    g = (0, Ni.default)(n.item_template({
                        provider_data: f,
                        font: m,
                        canUploadFonts: n.settings.canUploadFonts,
                        canEditCustomFonts: n.settings.canEditCustomFonts
                    })).addClass("collapsed");
                if (setTimeout(function() {
                        g.removeClass("collapsed")
                    }, 15), u.find(".category-element").length == 0) g.appendTo(u);
                else {
                    let y = !1;
                    u.find(".category-element").each(function() {
                        let S = (0, Ni.default)(this);
                        if (S.find(".caption").text().toLowerCase() > m.name.toLowerCase()) return g.insertBefore(S), y = !0, !1
                    }), y || g.appendTo(u)
                }
            }), jt.default.each(a, function(c) {
                let d = c.split("|"),
                    p = d[0],
                    h = d[1],
                    m = n.$(".categories .scroll-wrapper." + (p == "system" ? "system" : "custom") + " .category").find('.category-element[data-provider="' + p + '"][data-css_name="' + h + '"]');
                m.addClass("collapsed"), setTimeout(function() {
                    m.remove()
                }, 300)
            }), jt.default.each(l, function(c) {
                let d = c.split("|"),
                    p = d[0],
                    h = d[1],
                    u = n.$(".categories .scroll-wrapper." + (p == "system" ? "system" : "custom") + " .category"),
                    m = n.model.findFontByCSSName(h),
                    f = u.find('.category-element[data-provider="' + p + '"][data-css_name="' + h + '"]');
                f.toggleClass("hidden", !!m.hidden).find(".caption").text(m.name), m.hidden && f.removeClass("active")
            }), this.old_fonts = rt(t), this.reinitTimeout = setTimeout(this.reinitScrolls, 250)
        },
        checkTitleShowForLongFontName: function(e) {
            let t = e.currentTarget,
                o = (0, Ni.default)(t);
            t.offsetWidth < t.scrollWidth && !o.attr("title") && o.attr("title", o.text())
        },
        onEditCustomFontClick: function(e) {
            let t = (0, Ni.default)(e.currentTarget).closest(".category-element").attr("data-css_name"),
                o = this.model.get("fonts"),
                i = jt.default.findWhere(o, {
                    css_name: t
                });
            this.showFontUploadPanel(i)
        },
        scrollFontsToActive: function(e, t) {
            let o = this.$(".categories .scroll-wrapper." + e),
                i = this.$(".categories .scroll-wrapper." + e + " .category-wrapper"),
                n = i.find(".category-element.active").eq(0),
                s = !0;
            if (n.length != 1) return;
            o.is(":visible") || (o.css("display", "block"), s = !1);
            let a = n.position().top,
                l = n.height(),
                c = i.height(),
                d = Math.floor(a - (c - l) / 2);
            s ? i.stop().animate({
                scrollTop: d
            }, t) : (i.stop().scrollTop(d), o.css("display", "none"))
        },
        reinitScrolls: function() {
            jt.default.each(this.scroll, function(e) {
                e.recalc()
            })
        },
        createScroll: function(e) {
            let t = (0, Ni.default)(this.$(".categories .scroll-wrapper." + e));
            return t.RMScroll({
                $container: t.find(".category-wrapper"),
                $content: t.find(".category-wrapper .category"),
                $handle: t.find(".scroll"),
                gap_start: 8,
                gap_end: 8
            }).data("scroll")
        },
        onGlobalClickHandler: function(e) {
            let t = (0, Ni.default)(e.target),
                o = t.closest(".category-element"),
                i = o.attr("data-css_name");
            if (t.hasClass("action") && t.parent().hasClass("category-element")) {
                let n, s;
                !RM.constructorRouter.isOwner && this.settings.canEditCustomFonts && (n = this.mag.user._id, s = this.mag.num_id), this.model.changeFontHidden(i, !o.hasClass("hidden"), n, s).error && new Hb({
                    $parent: t
                })
            }
            if (t.hasClass("caption") && t.parent().hasClass("category-element")) {
                if (o.hasClass("disabled")) {
                    o.hasClass("personal") && this.showUpgradeAlert({
                        type: "type-upload-fonts"
                    }, "use custom font");
                    return
                }
                this.setActiveFont([i]), this.trigger("selectfont", i)
            }
            this.isAddFontPopupVisible && !t.closest(".add-font").length && this.toggleAddFontPopup()
        },
        setActiveFont: function(e, t) {
            this.$(".categories .category-element").removeClass("active"), jt.default.each(e, jt.default.bind(function(o) {
                this.$('.categories .category-element[data-css_name="' + o + '"]').addClass("active")
            }, this)), t !== void 0 && (this.scrollFontsToActive("system", t), this.scrollFontsToActive("custom", t))
        },
        show: function(e) {
            this._initialTab = this.model.get("fonts_tab"), this._initialFonts = this.model.get("fonts"),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: t
                }) => {
                    t("fontselector")
                }), this.$el.fadeIn(150), this.setActiveFont(e, 0), this.reinitScrolls()
        },
        hide: function() {
            this.$el.fadeOut(150), !(!this._initialTab && !this._initialFonts) && (!jt.default.isEqual(this.model.get("fonts_tab"), this._initialTab) || !jt.default.isEqual(this.model.get("fonts"), this._initialFonts)) && this.model.save({}, {
                silent: !0
            })
        },
        switchToCategory: function(e) {
            e != "system" && e != "custom" && (e = "custom"), this.model.set({
                fonts_tab: e
            }, {
                silent: !0
            }), this.$(".tabs-switcher .caption-" + e).addClass("active").siblings().removeClass("active"), e == "system" ? this.$(".add-font").stop().fadeOut() : this.$(".add-font").stop().fadeIn();
            let t = this.$(".categories > div:visible").eq(0),
                o = this.$(".categories .scroll-wrapper." + e);
            if (!t.is(o)) {
                if (t.length == 0) o.css("display", "block");
                else {
                    let i = t.index() < o.index() ? 1 : -1;
                    o.css({
                        display: "block",
                        opacity: 0,
                        "margin-left": 8 * i
                    }).animate({
                        opacity: 1,
                        "margin-left": 0
                    }, 300), t.animate({
                        opacity: 0,
                        "margin-left": -8 * i
                    }, 300, function() {
                        this.setAnimation = !1, t.css("display", "none")
                    })
                }
                this.reinitScrolls()
            }
        },
        toggleAddFontPopup: function() {
            this.$addFontPopup.toggleClass("invisible", !!this.isAddFontPopupVisible), this.isAddFontPopupVisible = !this.isAddFontPopupVisible
        },
        onAddFontButtonClick: function(e) {
            switch ((0, Ni.default)(e.currentTarget).attr("data-type")) {
                case "library":
                    this.toggleFontExplorer();
                    break;
                case "upload":
                    this.canUploadFonts() && this.showFontUploadPanel();
                    break
            }
        },
        canUploadFonts: function() {
            return this.settings.canUploadFonts || this.showUpgradeAlert({
                type: "type-upload-fonts"
            }, "upload font"), this.settings.canUploadFonts
        },
        showUpgradeAlert: function(e, t) {
            jt.default.extend(e, {
                is_contributor: !RM.constructorRouter.isOwner,
                owner_email: RM.constructorRouter.mag.get("user").email
            }), this.alertDuplicate = this.alertDuplicate || new GC({
                $parent: (0, Ni.default)("body > .popups"),
                router: RM.constructorRouter,
                opts: e,
                alert_source: t
            }), this.alertDuplicate.render()
        },
        toggleFontExplorer: function() {
            RM.views.fontExplorer.toggle()
        },
        showFontUploadPanel: function(e) {
            let t = this.$(".upload-font");
            this.fontUploader = new GK({
                el: t,
                allFonts: this.model,
                fontParams: e,
                mag: this.mag
            }), this.fontUploader.show(), this.listenTo(this.fontUploader, "hide-font", function(o) {
                let i = o.css_name;
                this.$(".category-element[data-css_name=" + i + "]").find(".action").click()
            }.bind(this)), this.listenTo(this.fontUploader, "update-font", function(o) {
                let i = o.css_name;
                this.trigger("selectfont", i)
            }.bind(this)), this.listenToOnce(this.fontUploader, "hide", function() {
                this.stopListening(this.fontUploader), this.fontUploader = null, this.isFontUploaderVisible = !1
            }.bind(this)), this.isFontUploaderVisible = !0
        },
        handleEscape: function() {
            return this.isFontUploaderVisible && this.fontUploader.handleEscape() || !this.isFontUploaderVisible
        },
        destroy: function() {
            this.fontuploader && this.fontuploader.remove(), this.fontuploader = null, this.model.off("change:fonts", this.onFontsChange), this.hide(), this.$el.remove()
        }
    }), GK = Iu.default.View.extend({
        className: "upload-font",
        template: cm["template-constructor-helpers-font-selector-upload"],
        templateWeights: cm["template-constructor-helpers-font-selector-upload-weights"],
        events: {
            "keydown .font-name-input": "onFontNameKeydown",
            "input .font-name-input": "onFontNameInput",
            "click .uf-section.actions .done:not(.disabled)": "hide",
            "click .button.add-weight:not(.disabled)": "onAddWeightClick",
            "click .weight-item:not(.disabled)": "onWeightItemClick",
            "click .button.select": "onSelectButtonClick",
            "click .uf-panel.weights .delete-weight": "onDeleteWeightClick"
        },
        WEIGTS: Rs,
        SAVE_URL: "/api/customfonts",
        initialize: function(e) {
            jt.default.bindAll(this), jt.default.extend(this, e);
            let t = Iu.default.Model.extend({
                urlRoot: this.SAVE_URL,
                idAttribute: "_id",
                defaults: {
                    is_personal: !0
                }
            });
            e.fontParams = e.fontParams || {};
            let o = jt.default.omit(e.fontParams, "variations"),
                i = jt.default.map(e.fontParams.variations || [], function(n) {
                    return {
                        type: n
                    }
                });
            this.isNew = jt.default.isEmpty(o), this.model = new t(o || {}), this.weights = new Iu.default.Collection(i), this.weights.comparator = function(n) {
                let s = n.get("type");
                return s.slice(1) + s[0].replace("n", "1").replace("i", "2")
            }, this.weights.sort()
        },
        render: function() {
            this.$el.html((0, Ni.default)(this.template(this.model.toJSON()))), this.$buttonAddWeight = this.$(".button.add-weight"), this.$buttonSelect = this.$(".button.select"), this.$buttonUpload = this.$(".button.upload"), this.$buttonDone = this.$(".uf-section.actions .done"), this.$fileUploader = (0, Ni.default)("#font-file-upload"), this.listenTo(this.weights, "add remove", this.renderVariations), this.listenTo(this.weights, "change", this.updateVariation), this.bindMainFileupload();
            let e = (0, Ni.default)(this.$(".uf-panel.weights .scroll-wrapper"));
            this.weightScroll = e.RMScroll({
                $container: e.find(".results-wrapper"),
                $content: e.find(".results"),
                $handle: e.find(".scroll"),
                gap_start: 8,
                gap_end: 88
            }).data("scroll"), this.renderVariations()
        },
        renderVariations: function() {
            this.$(".uf-panel.weights .list").html(this.templateWeights({
                weights: this.weights.toJSON(),
                names: this.WEIGTS,
                isUploadInProgress: jt.default.findWhere(this.weights, {
                    isUploading: !0
                }),
                _: jt.default
            })), this.updateWeightSelector(), this.bindWeightFileuploads(), this.weightScroll.recalc()
        },
        updateVariation: function(e) {
            let t = e.get("type"),
                o = this.$(".uf-panel.weights .weight[data-type=" + t + "]");
            o.find(".name").text(this.WEIGTS[t]), o.find(".reupload-weight").toggleClass("animate", !!e.get("isUploading")), this.$(".delete-weight").toggleClass("disabled", !!e.get("isUploading")), this.$(".uf-panel.weights .list").toggleClass("uploading", !!e.get("isUploading")), this.$buttonAddWeight.toggleClass("disabled", !!e.get("isUploading"))
        },
        updateWeightSelector: function() {
            jt.default.each(jt.default.keys(this.WEIGTS), function(e) {
                let t = !!this.weights.findWhere({
                    type: e
                });
                this.$(".weight-item[data-var=" + e + "]").toggleClass("disabled", t)
            }.bind(this))
        },
        bindMainFileupload: function() {
            (0, Ni.default)(this.$fileUploader).fileupload({
                dataType: "json",
                fileInput: this.$fileUploader,
                paramName: "upload",
                dropZone: this.$el,
                singleFileUploads: !0,
                acceptFileTypes: /(\.|\/)(woff)$/i,
                pasteZone: null,
                add: this.onUploadAdd,
                start: this.onUploadStart,
                done: this.onUploadDone,
                fail: this.onUploadFail,
                always: this.onUploadComplete
            }).bind("fileuploaddragover", function() {
                if (this.currentPanel !== "uploader") return !1;
                clearTimeout(this.dragoverTimeout), this.dragoverTimeout = setTimeout(function() {
                    this.$el.removeClass("file-dragover")
                }.bind(this), 300), !this.$el.hasClass("file-dragover") && this.$el.addClass("file-dragover")
            }.bind(this)).bind("fileuploaddrop", function() {
                if (this.currentPanel !== "uploader") return !1
            }.bind(this))
        },
        bindWeightFileuploads: function() {
            this.reUploadXHR && this.reUploadXHR.abort(), (0, Ni.default)(this.$(".uf-panel.weights .font-file-re-upload")).fileupload({
                dataType: "json",
                fileInput: this.$buttons,
                paramName: "upload",
                singleFileUploads: !0,
                acceptFileTypes: /(\.|\/)(woff)$/i,
                pasteZone: null,
                add: this.onReuploadEvent,
                start: this.onReuploadEvent,
                done: this.onReuploadEvent,
                fail: this.onReuploadEvent,
                always: this.onReuploadEvent
            })
        },
        onReuploadEvent: function(e, t) {
            let o = (0, Ni.default)(e.target),
                i = o.closest(".weight"),
                n = i.attr("data-type"),
                s = this.weights.findWhere({
                    type: n
                });
            if (s) switch (e.type) {
                case "fileuploadadd":
                    var a = this.checkFile(t);
                    if (!a) return;
                    this.reUploadXHR = t.submit();
                    break;
                case "fileuploadstart":
                    s.set("isUploading", !0);
                    break;
                case "fileuploaddone":
                    s.set("woff", t.result.woffUrl), this.saveFont();
                    break;
                case "fileuploadalways":
                    s.set("isUploading", !1);
                    break
            }
        },
        onUploadAdd: function(e, t) {
            this.checkFile(t) && (this.uploadXHR = t.submit())
        },
        checkFile: function(e) {
            return /\.woff$/i.test((e.files || [{}])[0].name)
        },
        onUploadStart: function() {
            let e = new Iu.default.Model({
                type: this.selectedVar
            });
            this.weights.add(e), e.set("isUploading", !0), this.switchToPanel("weights"), this.$buttonAddWeight.addClass("disabled")
        },
        onUploadDone: function(e, t) {
            this.weights.findWhere({
                type: this.selectedVar
            }).set("woff", t.result.woffUrl), this.saveFont()
        },
        onUploadFail: function() {
            let e = this.weights.findWhere({
                type: this.selectedVar
            });
            this.weights.remove(e)
        },
        onUploadComplete: function() {
            let e = this.weights.findWhere({
                type: this.selectedVar
            });
            e && e.set("isUploading", !1), this.$buttonAddWeight.removeClass("disabled")
        },
        show: function() {
            import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                default: e
            }) => {
                e("fontuploader")
            }), this.render(), this.switchToPanel("weights"), this.onFontNameInput(), jt.default.defer(function() {
                this.$el.removeClass("invisible"), jt.default.delay(function() {
                    this.isNew && this.$(".font-name-input").focus(), this.weightScroll.recalc()
                }.bind(this), 200)
            }.bind(this))
        },
        hide: function() {
            this.uploadXHR && this.uploadXHR.abort(), this.reUploadXHR && this.reUploadXHR.abort(), this.$el.addClass("invisible"), this.undelegateEvents(), jt.default.delay(function() {
                this.$el.empty(), this.trigger("hide")
            }.bind(this), 200)
        },
        onFontNameKeydown: function(e) {
            let t = this.$(".font-name-input").val().trim();
            e.keyCode == Ni.default.keycodes.enter && t && t !== this.model.get("name") && this.saveFont()
        },
        onFontNameInput: function() {
            let e = this.$(".font-name-input").val().trim();
            this.$(".uf-section.weight-list").toggleClass("invisible", !e), this.$buttonDone.toggleClass("disabled", !e)
        },
        switchToPanel: function(e) {
            this.currentPanel = e, this.$(".uf-panel." + e).removeClass("invisible").siblings(".uf-panel").addClass("invisible")
        },
        hidePanel: function(e) {
            this.$(".uf-panel" + e).removeClass("invisible").siblings(".uf-panel").addClass("invisible")
        },
        onAddWeightClick: function() {
            this.switchToPanel("selector")
        },
        onWeightItemClick: function(e) {
            let t = (0, Ni.default)(e.currentTarget);
            this.selectedVar = t.attr("data-var"), this.$buttonSelect.text(this.WEIGTS[this.selectedVar]), this.switchToPanel("uploader")
        },
        onSelectButtonClick: function() {
            this.switchToPanel("selector")
        },
        onDeleteWeightClick: function(e) {
            let t = (0, Ni.default)(e.currentTarget).closest(".weight"),
                o = t.attr("data-type"),
                i = this.weights.findWhere({
                    type: o
                });
            if (t.hasClass("uploading")) {
                this.uploadXHR && this.uploadXHR.abort();
                return
            }
            if (!this.isNew && this.weights.length < 2) {
                this.model.get("hidden") || this.trigger("hide-font", {
                    css_name: this.model.get("css_name")
                }), this.hide();
                return
            }
            jt.default.defer(function() {
                this.weights.remove(i), this.saveFont()
            }.bind(this))
        },
        handleEscape: function() {
            return this.currentPanel !== "weights" ? this.switchToPanel("weights") : this.hide(), !1
        },
        saveFont: function() {
            let e = this.$(".font-name-input"),
                t = e.val().trim() || this.model.get("name"),
                o = this.weights.map(function(n) {
                    return jt.default.pick(n.toJSON(), "type", "woff")
                });
            if (!t || !o.length) return;
            let i = {
                name: t,
                variations: o,
                is_personal: !0
            };
            !RM.constructorRouter.isOwner && this.mag.doesUserHaveAccess && (i.mag_user = this.mag.user._id, i.mag_num_id = this.mag.num_id), this.model.save(i, {
                url: this.SAVE_URL,
                success: function(n) {
                    this.isNew = !1;
                    let s = jt.default.pluck(n.get("variations"), "type");
                    this.weights.reset(n.get("variations")), e.val(n.get("name"));
                    let a = this.model.get("css_name");
                    this.allFonts.addFonts([{
                        provider: "custom",
                        css_name: a,
                        css_url: this.model.get("css_url"),
                        signed_css_url: this.model.get("signed_css_url"),
                        name: this.model.get("name"),
                        variations: s,
                        is_personal: !0,
                        _id: this.model.get("_id")
                    }], "font-upload"), this.trigger("update-font", {
                        css_name: a
                    })
                }.bind(this)
            })
        },
        destroy: function() {}
    }), zD = VK
});
var WD = k(() => {});

function eJ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "font-family-selector.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var OD, YK, ZK, XK, KK, JK, qK, QK, tJ, Nb, __ = k(() => {
    "use strict";
    OD = E(Ze());
    $D();
    WD();
    YK = {
        model: {
            event: "change"
        },
        props: {
            family: {
                type: [String, Array],
                default: () => [""]
            },
            disabled: {
                type: Boolean,
                default: !1
            },
            vAlign: {
                type: String,
                default: "auto"
            },
            hAlign: {
                type: String,
                default: "right"
            },
            hOffset: {
                type: Number,
                default: 0
            }
        },
        data: function() {
            return {
                visibleBox: !1,
                boxStyles: {}
            }
        },
        computed: {
            fontFamily: function() {
                return typeof this.family == "string" ? [this.family] : this.family
            },
            exStyle: function() {
                return this.getFontFamilyStyle()
            },
            caption: function() {
                let e = "";
                return this.fontFamily.forEach((t, o) => {
                    e += t, o + 1 < this.fontFamily.length && (e += ", ")
                }), e
            }
        },
        watch: {
            family(e) {
                !e && this.visibleBox && (this.visibleBox = !this.visibleBox)
            }
        },
        mounted: function() {
            if (this.vAlign === "auto") {
                let e = this.$el.getBoundingClientRect(),
                    t = "top";
                e.top > window.innerHeight / 2 && (t = "bottom"), this.boxStyles[t] = e.height + "px"
            }
            this.boxStyles[this.hAlign] = this.hOffset + "px", this.fontselector = new zD({
                $parent: (0, OD.default)(this.$el.querySelector(".box_container"))
            }), this.fontselector.on("selectfont", this.fontChanged), this.fontselector.show()
        },
        methods: {
            getFontFamilyStyle: function() {
                return {
                    "font-family": this.fontFamily.length === 1 ? this.fontFamily[0] : "-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif"
                }
            },
            fontChanged: function(e) {
                this.$emit("change", e)
            },
            toggleVisible: function() {
                this.disabled || (this.visibleBox || this.$emit("showPopup", this), this.visibleBox = !this.visibleBox)
            }
        }
    }, ZK = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            class: {
                "font-family-container": !0, "container-disabled": e.disabled
            }
        }, [o("span", {
            staticClass: "example",
            style: e.exStyle,
            on: {
                click: e.toggleVisible
            }
        }, [e._v(e._s(e.caption))]), e._v(" "), o("div", {
            staticClass: "expand-arrow",
            on: {
                click: e.toggleVisible
            }
        }), e._v(" "), o("div", {
            staticClass: "box_container",
            class: {
                visible: e.visibleBox
            },
            style: e.boxStyles
        })])
    }, XK = [], KK = void 0, JK = void 0, qK = void 0, QK = !1;
    tJ = eJ({
        render: ZK,
        staticRenderFns: XK
    }, KK, YK, JK, QK, qK, !1, void 0, void 0, void 0), Nb = tJ
});
var jD = k(() => {});

function cJ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "font-style-selector.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var Sd, HD, oJ, iJ, nJ, rJ, sJ, aJ, lJ, dJ, Ub, S_ = k(() => {
    "use strict";
    Sd = E(ze());
    jD();
    HD = {
        i1: {
            caption: "Thin Italic",
            style: {
                fontWeight: 100,
                fontStyle: "italic"
            }
        },
        i3: {
            caption: "Light Italic",
            style: {
                fontWeight: 300,
                fontStyle: "italic"
            }
        },
        i4: {
            caption: "Italic",
            style: {
                fontWeight: 400,
                fontStyle: "italic"
            }
        },
        i5: {
            caption: "Medium Italic",
            style: {
                fontWeight: 500,
                fontStyle: "italic"
            }
        },
        i7: {
            caption: "Bold Italic",
            style: {
                fontWeight: 700,
                fontStyle: "italic"
            }
        },
        i9: {
            caption: "Black Italic",
            style: {
                fontWeight: 900,
                fontStyle: "italic"
            }
        },
        n1: {
            caption: "Thin",
            style: {
                fontWeight: 100,
                fontStyle: "normal"
            }
        },
        n3: {
            caption: "Light",
            style: {
                fontWeight: 300,
                fontStyle: "normal"
            }
        },
        n4: {
            caption: "Regular",
            style: {
                fontWeight: 400,
                fontStyle: "normal"
            }
        },
        n5: {
            caption: "Medium",
            style: {
                fontWeight: 500,
                fontStyle: "normal"
            }
        },
        n7: {
            caption: "Bold",
            style: {
                fontWeight: 700,
                fontStyle: "normal"
            }
        },
        n9: {
            caption: "Black",
            style: {
                fontWeight: 900,
                fontStyle: "normal"
            }
        }
    }, oJ = {
        model: {
            event: "change"
        },
        props: {
            fontStyle: {
                type: Array,
                default: () => [""]
            },
            fontFamily: {
                type: Array,
                default: () => [""]
            },
            fontWeight: {
                type: Array,
                default: () => [0]
            },
            vAlign: {
                type: String,
                default: "auto"
            }
        },
        data: function() {
            return {
                visibleBox: !1,
                boxStyles: {},
                styleVariants: {}
            }
        },
        computed: {
            exStyle: function() {
                return {
                    "font-style": this.getParamForMultipleStyles(this.fontStyle),
                    "font-weight": this.getParamForMultipleStyles(this.fontWeight)
                }
            },
            fromTop: function() {
                return this.vAlign !== "auto" && Sd.default.keys(this.styleVariants).length > 5
            },
            disabled: function() {
                return Sd.default.keys(this.styleVariants).length === 0
            },
            caption: function() {
                let e = "";
                return this.keys.forEach((t, o) => {
                    HD[t] && (e += HD[t].caption, o + 1 < this.keys.length && (e += ", "))
                }), e
            },
            keys: function() {
                let e = [];
                for (let t = 0; t < this.fontStyle.length; t++) {
                    let o = (this.fontStyle[t] === "italic" ? "i" : "n") + ("" + this.fontWeight[t])[0];
                    !this.styleVariants[o] && this.fontFamily.length === 1 && (this.styleVariants.n4 ? o = "n4" : o = Sd.default.keys(this.styleVariants)[0], this.$emit("update:fontStyle", o[0] === "i" ? "italic" : "normal"), this.$emit("update:fontWeight", parseInt(o[1], 10) * 100)), e.push(o)
                }
                return e
            }
        },
        watch: {
            disabled: {
                handler: function(e) {
                    e && this.visibleBox && (this.visibleBox = !1)
                },
                immediate: !0
            },
            fontFamily: {
                handler: function(e) {
                    let t = e.map(n => RM.constructorRouter.fonts.findFontByCSSName(n)),
                        o = [],
                        i = {
                            i: "italic",
                            n: "normal"
                        };
                    if (t.forEach(n => {
                            let s = {};
                            n.variations.forEach(a => {
                                s[a] = {
                                    caption: this.generateName(a),
                                    style: {
                                        fontWeight: parseInt(a[1], 10) * 100,
                                        fontStyle: i[a[0]]
                                    }
                                }
                            }), o.push(s)
                        }), o.length === 1) this.styleVariants = Sd.default.clone(o[0]);
                    else if (o.length > 1) {
                        let n = Sd.default.clone(o[0]);
                        for (let s = 1; s < o.length; s++) {
                            let a = o[s];
                            Object.keys(n).forEach(l => {
                                a[l] || delete n[l]
                            })
                        }
                        this.styleVariants = n
                    }
                },
                immediate: !0
            }
        },
        mounted: function() {
            if (this.boxStyles["max-height"] = `${window.innerHeight}px`, this.vAlign === "auto") {
                let e = this.$el.getBoundingClientRect(),
                    t = "top",
                    o = "bottom";
                e.top > window.innerHeight / 2 && (t = "bottom", o = "top"), this.boxStyles[t] = "27px", this.boxStyles[o] = "auto"
            }
        },
        methods: {
            generateName: function(e) {
                let t = {
                        1: "Thin",
                        2: "ExtraLight",
                        3: "Light",
                        4: "Regular",
                        5: "Medium",
                        6: "SemiBold",
                        7: "Bold",
                        8: "ExtraBold",
                        9: "Black"
                    },
                    o = e[0] === "i",
                    i = t[e[1]];
                return o && i === "Regular" ? "Italic" : i + (o ? " Italic" : "")
            },
            getParamForMultipleStyles(e) {
                return e.length === 1 || Sd.default.every(e, o => o === e[0]) ? e[0] : "inherit"
            },
            selectFont: function(e) {
                this.$emit("update:fontStyle", e.style.fontStyle), this.$emit("update:fontWeight", e.style.fontWeight)
            },
            toggleVisible: function() {
                this.disabled || (this.visibleBox || this.$emit("showPopup", this), this.visibleBox = !this.visibleBox)
            }
        }
    }, iJ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "font-style-container"
        }, [o("span", {
            staticClass: "example",
            class: {
                disabled: e.disabled
            },
            style: e.exStyle,
            on: {
                click: e.toggleVisible
            }
        }, [e._v(e._s(e.caption))]), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: !e.disabled,
                expression: "!disabled"
            }],
            staticClass: "expand-arrow",
            on: {
                click: e.toggleVisible
            }
        }), e._v(" "), o("div", {
            staticClass: "box_container",
            class: {
                visible: e.visibleBox, "from-top": e.fromTop
            },
            style: e.boxStyles
        }, e._l(e.styleVariants, function(i, n) {
            return o("div", {
                key: n,
                staticClass: "font-elem",
                class: e.keys.includes(n) ? "curr" : "",
                style: i.style,
                on: {
                    click: function(s) {
                        return e.selectFont(i, n)
                    }
                }
            }, [e._v(`
      ` + e._s(i.caption) + `
      `), o("div", {
                staticClass: "point"
            })])
        }), 0)])
    }, nJ = [], rJ = void 0, sJ = void 0, aJ = void 0, lJ = !1;
    dJ = cJ({
        render: iJ,
        staticRenderFns: nJ
    }, rJ, oJ, sJ, lJ, aJ, !1, void 0, void 0, void 0), Ub = dJ
});
var ND = k(() => {});

function yJ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-cart-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var dm, pJ, uJ, hJ, mJ, fJ, gJ, bJ, vJ, UD, VD = k(() => {
    "use strict";
    dm = E(Ze());
    na();
    Wb();
    dd();
    __();
    S_();
    ND();
    pJ = {
        components: {
            ColorPicker: Su,
            NumericInput: Es,
            FontFamilySelector: Nb,
            FontStyleSelector: Ub
        },
        mixins: [Mi],
        data: function() {
            return {
                stylingState: "default"
            }
        },
        computed: {
            maxBorderWidth() {
                return Math.ceil(Math.min(this.m.w, this.m.h) / 2)
            }
        },
        watch: {
            stylingState(e) {
                (0, dm.default)(".common-button", this.raw_block.$el).toggleClass("hovered", e === "hover"), (0, dm.default)(".common-button", this.raw_block.$el).toggleClass("current", e === "current")
            }
        },
        destroyed() {
            this.setCorrectIconColor("default"), (0, dm.default)(".common-button", this.raw_block.$el).toggleClass("hovered", !1), (0, dm.default)(".common-button", this.raw_block.$el).toggleClass("current", !1)
        },
        methods: {
            onChangeStylingState: function(e) {
                e && e !== this.stylingState && (this.stylingState = e), this.closeOthersPopups(null), this.setCorrectIconColor(e)
            },
            changePropHandler(e, t) {
                this.m[e] = t
            },
            setCorrectIconColor(e) {
                this.raw_block.onIconColorChange(this.m, null, {}, e)
            }
        }
    }, uJ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel cart-settings-panel",
            class: {
                "default-tab": e.stylingState === "default", "hover-tab": e.stylingState === "hover"
            }
        }, [e._m(0), e._v(" "), o("div", {
            staticClass: "styling-state-switcher"
        }, [o("span", {
            class: {
                btn: !0, active: e.stylingState === "default"
            },
            on: {
                click: function(i) {
                    return e.onChangeStylingState("default")
                }
            }
        }, [e._v("Default")]), e._v(" "), o("span", {
            class: {
                btn: !0, active: e.stylingState === "hover"
            },
            on: {
                click: function(i) {
                    return e.onChangeStylingState("hover")
                }
            }
        }, [e._v("Hover")])]), e._v(" "), o("div", {
            staticClass: "separator-filled"
        }), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.stylingState === "default",
                expression: "stylingState === 'default'"
            }],
            staticClass: "settings-panel"
        }, [o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Shape color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.m["background-color"],
                alpha: e.m["background-color-opacity"],
                "data-testid": "cart-color-picker"
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("background-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("background-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Radius")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            class: {
                "one-digit": e.m["border-radius"] < 10, "two-digit": e.m["border-radius"] < 100 && e.m["border-radius"] > 9, "three-digit": e.m["border-radius"] > 99
            },
            attrs: {
                autosize: !0,
                value: e.m["border-radius"],
                min: 0,
                max: 999,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("border-radius", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            class: {
                "one-digit": e.m["border-width"] < 10, "two-digit": e.m["border-width"] < 100 && e.m["border-width"] > 9, "three-digit": e.m["border-width"] > 99
            },
            attrs: {
                autosize: !0,
                value: e.m["border-width"],
                min: 0,
                max: e.maxBorderWidth,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("border-width", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.m["border-color"],
                alpha: e.m["border-color-opacity"]
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("border-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("border-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("font-family-selector", {
            attrs: {
                family: e.m["font-family"]
            },
            on: {
                showPopup: e.closeOthersPopups,
                change: function(i) {
                    return e.changePropHandler("font-family", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("font-style-selector", {
            style: {
                "font-family": e.m["font-family"]
            },
            attrs: {
                "font-style": [e.m["font-style"]],
                "font-weight": [e.m["font-weight"]],
                "font-family": [e.m["font-family"]]
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:fontStyle": function(i) {
                    return e.changePropHandler("font-style", i)
                },
                "update:fontWeight": function(i) {
                    return e.changePropHandler("font-weight", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Size")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            attrs: {
                autosize: !0,
                value: e.m["font-size"],
                min: 8,
                max: 999
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("font-size", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Letter spacing")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            attrs: {
                autosize: !0,
                value: e.m["letter-spacing"],
                min: -99,
                max: 999,
                step: .1,
                "use-float": !0,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("letter-spacing", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Text color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.m.color,
                alpha: e.m["color-opacity"]
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("color-opacity", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.stylingState === "hover",
                expression: "stylingState === 'hover'"
            }],
            staticClass: "settings-panel"
        }, [o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Shape color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.m["hover-background-color"],
                alpha: e.m["hover-background-color-opacity"]
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("hover-background-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("hover-background-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Radius")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            class: {
                "one-digit": e.m["hover-border-radius"] < 10, "two-digit": e.m["hover-border-radius"] < 100 && e.m["hover-border-radius"] > 9, "three-digit": e.m["hover-border-radius"] > 99
            },
            attrs: {
                autosize: !0,
                value: e.m["hover-border-radius"],
                min: 0,
                max: 999,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("hover-border-radius", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            class: {
                "one-digit": e.m["hover-border-width"] < 10, "two-digit": e.m["hover-border-width"] < 100 && e.m["hover-border-width"] > 9, "three-digit": e.m["hover-border-width"] > 99
            },
            attrs: {
                autosize: !0,
                value: e.m["hover-border-width"],
                min: 0,
                max: e.maxBorderWidth,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("hover-border-width", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.m["hover-border-color"],
                alpha: e.m["hover-border-color-opacity"]
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("hover-border-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("hover-border-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Text color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.m["hover-color"],
                alpha: e.m["hover-color-opacity"]
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("hover-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("hover-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Transition")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            class: {
                "one-digit": e.m["hover-border-radius"] < 10, "two-digit": e.m["hover-border-radius"] < 100 && e.m["hover-border-radius"] > 9, "three-digit": e.m["hover-border-radius"] > 99
            },
            attrs: {
                autosize: !0,
                value: e.m["hover-tansition-duration"],
                min: 0,
                max: 2,
                step: .1,
                "use-float": !0,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("hover-tansition-duration", i)
                }
            }
        })], 1)])])
    }, hJ = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "title-row"
        }, [o("div", {
            staticClass: "title"
        }, [e._v("Cart button")])])
    }], mJ = void 0, fJ = void 0, gJ = void 0, bJ = !1;
    vJ = yJ({
        render: uJ,
        staticRenderFns: hJ
    }, mJ, pJ, fJ, bJ, gJ, !1, void 0, void 0, void 0), UD = vJ
});
var GD = k(() => {});

function PJ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-product-selector.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var wJ, xJ, _J, SJ, CJ, kJ, IJ, TJ, YD, ZD = k(() => {
    "use strict";
    na();
    xu();
    GD();
    wJ = {
        components: {
            RmSelect: Ea
        },
        mixins: [Mi],
        data: function() {
            return {
                productsOptions: this.getProductsOptions()
            }
        },
        computed: {
            thereAreProducts() {
                return this.productsOptions && this.productsOptions.length > 1
            },
            isCurrentProductInactive() {
                return !this.getCurrentProductActiveStatus()
            }
        },
        methods: {
            getProductsOptions: function(e) {
                let t = e || this.raw_block.model.get("selected_product_id");
                return this.raw_block.workspace.eCommerceManager.getProductSelectOptions(t)
            },
            getCurrentProductActiveStatus: function(e) {
                let t = e || this.raw_block.model.get("selected_product_id");
                return this.raw_block.workspace.eCommerceManager.isProductActive(t)
            },
            onProductSelect: function(e) {
                this.isCurrentProductInactive && (this.productsOptions = this.getProductsOptions(e.value), this.raw_block.workspace.eCommerceManager.getInvalidAddToCartWidgets(this.raw_block.workspace.mag.getAllWidgets()).length <= 1 && RM.constructorRouter.trigger("notice:hide", "ecommHasInvalidAddToCartWidget"))
            }
        }
    }, xJ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            class: {
                panel: !0, "select-product-panel": !0, "no-products-wrap": !e.thereAreProducts
            }
        }, [e.thereAreProducts ? e._e() : o("div", {
            staticClass: "no-products-alert"
        }, [e._v("You have no active products to choose")]), e._v(" "), e.thereAreProducts ? o("rm-select", {
            staticClass: "select-wrap",
            attrs: {
                options: e.productsOptions,
                "arrow-size": "big",
                callback: e.onProductSelect
            },
            scopedSlots: e._u([{
                key: "listitem",
                fn: function(i) {
                    return [o("span", {
                        class: {
                            "inactive-product": i.option.value === i.value && !e.getCurrentProductActiveStatus()
                        },
                        attrs: {
                            title: i.option.value === i.value && !e.getCurrentProductActiveStatus() ? "inactive product" : i.option.caption
                        }
                    }, [e._v(e._s(i.option.caption))]), e._v(" "), o("div", {
                        staticClass: "point"
                    })]
                }
            }], null, !1, 3753225650),
            model: {
                value: e.m.selected_product_id,
                callback: function(i) {
                    e.$set(e.m, "selected_product_id", i)
                },
                expression: "m.selected_product_id"
            }
        }) : e._e()], 1)
    }, _J = [], SJ = void 0, CJ = "data-v-497c76ae", kJ = void 0, IJ = !1;
    TJ = PJ({
        render: xJ,
        staticRenderFns: _J
    }, SJ, wJ, CJ, IJ, kJ, !1, void 0, void 0, void 0), YD = TJ
});

function BJ() {
    var e = this,
        t = e.$createElement,
        o = e._self._c || t;
    return [o("svg", e._g({
        attrs: {
            width: "32",
            height: "4",
            xmlns: "http://www.w3.org/2000/svg"
        }
    }, e.$listeners), [o("g", {
        attrs: {
            fill: "#282828",
            "fill-rule": "evenodd"
        }
    }, [o("rect", {
        attrs: {
            x: "18",
            width: "14",
            height: "4",
            rx: "2"
        }
    }), o("rect", {
        attrs: {
            width: "14",
            height: "4",
            rx: "2"
        }
    })])])]
}
var XD, KD = k(() => {
    "use strict";
    XD = {
        render: BJ
    }
});

function MJ() {
    var e = this,
        t = e.$createElement,
        o = e._self._c || t;
    return [o("svg", e._g({
        attrs: {
            width: "32",
            height: "12",
            xmlns: "http://www.w3.org/2000/svg"
        }
    }, e.$listeners), [o("g", {
        attrs: {
            fill: "#282828",
            "fill-rule": "evenodd"
        }
    }, [o("rect", {
        attrs: {
            width: "32",
            height: "4",
            rx: "2"
        }
    }), o("rect", {
        attrs: {
            y: "8",
            width: "32",
            height: "4",
            rx: "2"
        }
    })])])]
}
var JD, qD = k(() => {
    "use strict";
    JD = {
        render: MJ
    }
});
var eA, QD = k(() => {
    eA = "https://st-p.rmcdn1.net/ae5fa58f/dist/color-disabled-R3PBCKU6.svg"
});
var oA, tA = k(() => {
    oA = "https://st-p.rmcdn1.net/ae5fa58f/dist/number-disabled-LKXPD5B5.svg"
});
var iA = k(() => {});

function OJ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-addtocart-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var FJ, DJ, AJ, LJ, zJ, $J, WJ, jJ, nA, rA = k(() => {
    "use strict";
    na();
    Wb();
    dd();
    __();
    S_();
    KD();
    qD();
    QD();
    tA();
    iA();
    FJ = {
        components: {
            ColorPicker: Su,
            NumericInput: Es,
            FontFamilySelector: Nb,
            FontStyleSelector: Ub,
            LayoutHorizontalImg: XD,
            LayoutVerticalImg: JD
        },
        mixins: [Mi],
        data: function() {
            return {
                stylingState: "default",
                haveProductAttributes: this.raw_block.haveProductAttributes(),
                colorDisabledImg: eA,
                numberDisabledImg: oA,
                outOfStockEditing: !1
            }
        },
        computed: {
            maxBtnBorderWidth() {
                return Math.ceil(Math.min(this.m.btn_w, this.m.btn_h) / 2)
            },
            selectionState() {
                return this.raw_block.selectionState
            },
            outOfStock() {
                return this.raw_block.workspace.eCommerceManager.getTextValue("out_of_stock")
            }
        },
        watch: {
            stylingState(e) {
                this.raw_block.$el.toggleClass("hovered", e === "hover")
            }
        },
        destroyed() {
            this.onChangeStylingState("default")
        },
        methods: {
            onEditOutOfStockClick: function() {
                this.$refs.outOfStockInput.focus(), this.outOfStockEditing = !0
            },
            onOutOfStockBlur: function(e) {
                let t = e.target.value.trim();
                this.raw_block.workspace.eCommerceManager.setTextValue("out_of_stock", t);
                let o = this.raw_block.workspace.eCommerceManager.ecommerceData;
                o && this.raw_block.mag.save({
                    ecommerce_data: o
                }, {
                    patch: !0
                }), this.outOfStockEditing = !1
            },
            onChangeLayout: function(e) {
                let t = e.currentTarget.dataset.layoutType;
                t && this.m.layout && this.m.layout !== t && (this.m.layout = t)
            },
            onChangeStylingState: function(e) {
                e && e !== this.stylingState && (this.stylingState = e, this.raw_block.changeStylingState(this.stylingState))
            },
            changeSinglePropHandler(e, t) {
                this.m[e] = t
            },
            changeSelectIconProp(e, t) {
                let o = {
                    "attrs-icon-w": t,
                    "attrs-icon-h": this.m["attrs-icon-h"] + (t - this.m["attrs-icon-w"])
                };
                this.m = Object.assign(this.m, o)
            },
            changeIconPropHandler(e, t) {
                let o = {};
                o[e] = t, this.m[e] === this.m["hover-" + e] && (o["hover-" + e] = t), this.m = Object.assign(this.m, o)
            },
            changeHoverPropHandler(e, t) {
                let o = {};
                this.selectionState === "both" && (o[e] = t, o["attrs-" + e] = t), this.selectionState === "button" && (o[e] = t), this.selectionState === "selects" && (o["attrs-" + e] = t), this.m = Object.assign(this.m, o)
            },
            changePropHandler(e, t) {
                let o = {};
                this.selectionState === "both" && (o[e] = t, o["attrs-" + e] = t, this.m[e] === this.m["hover-" + e] && this.m["attrs-" + e] === this.m["attrs-hover-" + e] && (o["hover-" + e] = t, o["attrs-hover-" + e] = t)), this.selectionState === "button" && (o[e] = t, this.m[e] === this.m["hover-" + e] && (o["hover-" + e] = t)), this.selectionState === "selects" && (o["attrs-" + e] = t, this.m["attrs-" + e] === this.m["attrs-hover-" + e] && (o["attrs-hover-" + e] = t)), this.m = Object.assign(this.m, o)
            },
            getFontFamilyValue(e) {
                if (this.selectionState === "both") return this.m[e] === this.m["attrs-" + e] ? this.m[e] : [this.m[e], this.m["attrs-" + e]];
                if (this.selectionState === "button") return this.m[e];
                if (this.selectionState === "selects") return this.m["attrs-" + e]
            },
            getFontParam(e) {
                if (this.selectionState === "both") return e === "font-style" ? this.m[e] === this.m["attrs-" + e] && this.m["font-weight"] === this.m["attrs-font-weight"] ? [this.m[e]] : [this.m[e], this.m["attrs-" + e]] : e === "font-weight" ? this.m[e] === this.m["attrs-" + e] && this.m["font-style"] === this.m["attrs-font-style"] ? [this.m[e]] : [this.m[e], this.m["attrs-" + e]] : this.m[e] === this.m["attrs-" + e] ? [this.m[e]] : [this.m[e], this.m["attrs-" + e]];
                if (this.selectionState === "button") return [this.m[e]];
                if (this.selectionState === "selects") return [this.m["attrs-" + e]]
            },
            getColorValue(e) {
                if (this.selectionState === "both") return this.m[e] === this.m["attrs-" + e] ? this.m[e] : "000000";
                if (this.selectionState === "button") return this.m[e];
                if (this.selectionState === "selects") return this.m["attrs-" + e]
            },
            getNumValue(e) {
                if (this.selectionState === "both") return this.m[e] === this.m["attrs-" + e] ? this.m[e] : Math.min(this.m[e], this.m["attrs-" + e]);
                if (this.selectionState === "button") return this.m[e];
                if (this.selectionState === "selects") return this.m["attrs-" + e]
            },
            isDisabledValue(e) {
                return this.selectionState === "both" && this.m[e] !== this.m["attrs-" + e]
            }
        }
    }, DJ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel addtocart-settings-panel",
            class: {
                "panel-default": e.stylingState === "default", "panel-hover": e.stylingState === "hover", "panel-both": e.selectionState === "both", "panel-selects": e.selectionState === "selects", "panel-button": e.selectionState === "button"
            }
        }, [o("div", {
            staticClass: "title-row"
        }, [e.selectionState === "both" && e.haveProductAttributes ? o("div", {
            staticClass: "both-header header"
        }, [o("div", {
            staticClass: "title"
        }, [e._v("Layout")]), e._v(" "), o("div", {
            staticClass: "layout-controls"
        }, [o("div", {
            class: {
                "layout-btn": !0, "horizontal-layout": !0, active: e.m.layout === "horizontal"
            },
            attrs: {
                "data-layout-type": "horizontal"
            },
            on: {
                click: e.onChangeLayout
            }
        }, [o("layout-horizontal-img", {
            staticClass: "svg layout-icon",
            attrs: {
                title: "horizontal layout"
            }
        })], 1), e._v(" "), o("div", {
            class: {
                "layout-btn": !0, "vertical-layout": !0, active: e.m.layout === "vertical"
            },
            attrs: {
                "data-layout-type": "vertical"
            },
            on: {
                click: e.onChangeLayout
            }
        }, [o("layout-vertical-img", {
            staticClass: "svg layout-icon",
            attrs: {
                title: "vertical layout"
            }
        })], 1)])]) : e._e(), e._v(" "), e.selectionState === "button" || e.selectionState === "both" && !e.haveProductAttributes ? o("div", {
            staticClass: "button-header header"
        }, [e._v(`
      Button
    `)]) : e._e(), e._v(" "), e.selectionState === "selects" ? o("div", {
            staticClass: "selects-header header"
        }, [e._v("Dropdown")]) : e._e()]), e._v(" "), o("div", {
            staticClass: "styling-state-switcher"
        }, [o("span", {
            class: {
                btn: !0, active: e.stylingState === "default"
            },
            on: {
                click: function(i) {
                    return e.onChangeStylingState("default")
                }
            }
        }, [e._v("Default")]), e._v(" "), o("span", {
            class: {
                btn: !0, active: e.stylingState === "hover"
            },
            on: {
                click: function(i) {
                    return e.onChangeStylingState("hover")
                }
            }
        }, [e._v("Hover")])]), e._v(" "), o("div", {
            staticClass: "separator-filled"
        }), e._v(" "), e.stylingState === "default" ? o("div", {
            staticClass: "settings-panel"
        }, [o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Shape color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.getColorValue("background-color"),
                alpha: e.getColorValue("background-color-opacity"),
                "custom-icon": e.isDisabledValue("background-color") || e.isDisabledValue("background-color-opacity") ? e.colorDisabledImg : null
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("background-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("background-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Radius")]), e._v(" "), o("div", {
            staticClass: "num-input-wrap"
        }, [o("img", {
            class: {
                "disabled-numeric": !0, "show-disabled-icon": e.isDisabledValue("border-radius")
            },
            attrs: {
                src: e.numberDisabledImg
            }
        }), e._v(" "), o("numeric-input", {
            class: {
                "num-input": !0, "hidden-num-input": e.isDisabledValue("border-radius")
            },
            attrs: {
                autosize: !0,
                value: e.getNumValue("border-radius"),
                min: 0,
                max: 999,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("border-radius", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border")]), e._v(" "), o("div", {
            staticClass: "num-input-wrap"
        }, [o("img", {
            class: {
                "disabled-numeric": !0, "show-disabled-icon": e.isDisabledValue("border-width")
            },
            attrs: {
                src: e.numberDisabledImg
            }
        }), e._v(" "), o("numeric-input", {
            class: {
                "num-input": !0, "hidden-num-input": e.isDisabledValue("border-width")
            },
            attrs: {
                autosize: !0,
                value: e.getNumValue("border-width"),
                min: 0,
                max: e.maxBtnBorderWidth,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("border-width", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.getColorValue("border-color"),
                alpha: e.getColorValue("border-color-opacity"),
                "custom-icon": e.isDisabledValue("border-color") || e.isDisabledValue("border-color-opacity") ? e.colorDisabledImg : null
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("border-color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("border-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("font-family-selector", {
            attrs: {
                family: e.getFontFamilyValue("font-family")
            },
            on: {
                showPopup: e.closeOthersPopups,
                change: function(i) {
                    return e.changePropHandler("font-family", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("font-style-selector", {
            style: {
                "font-family": e.getFontParam("font-family").length === 1 ? e.getFontParam("font-family")[0] : "inherit"
            },
            attrs: {
                "font-style": e.getFontParam("font-style"),
                "font-weight": e.getFontParam("font-weight"),
                "font-family": e.getFontParam("font-family")
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:fontStyle": function(i) {
                    return e.changePropHandler("font-style", i)
                },
                "update:fontWeight": function(i) {
                    return e.changePropHandler("font-weight", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Size")]), e._v(" "), o("div", {
            staticClass: "num-input-wrap"
        }, [o("img", {
            class: {
                "disabled-numeric": !0, "show-disabled-icon": e.isDisabledValue("font-size")
            },
            attrs: {
                src: e.numberDisabledImg
            }
        }), e._v(" "), o("numeric-input", {
            class: {
                "num-input": !0, "hidden-num-input": e.isDisabledValue("font-size")
            },
            attrs: {
                autosize: !0,
                value: e.getNumValue("font-size"),
                min: 8,
                max: 999,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("font-size", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Letter spacing")]), e._v(" "), o("div", {
            staticClass: "num-input-wrap"
        }, [o("img", {
            class: {
                "disabled-numeric": !0, "show-disabled-icon": e.isDisabledValue("letter-spacing")
            },
            attrs: {
                src: e.numberDisabledImg
            }
        }), e._v(" "), o("numeric-input", {
            class: {
                "num-input": !0, "hidden-num-input": e.isDisabledValue("letter-spacing")
            },
            attrs: {
                autosize: !0,
                value: e.getNumValue("letter-spacing"),
                min: -99,
                max: 999,
                step: .1,
                "use-float": !0,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changePropHandler("letter-spacing", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Text color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.getColorValue("color"),
                alpha: e.getColorValue("color-opacity"),
                "custom-icon": e.isDisabledValue("color") || e.isDisabledValue("color-opacity") ? e.colorDisabledImg : null
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changePropHandler("color", i)
                },
                "update:alpha": function(i) {
                    return e.changePropHandler("color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), e.selectionState === "selects" ? o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Icon size")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            attrs: {
                autosize: !0,
                value: e.m["attrs-icon-w"],
                min: 5,
                max: 100,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changeSelectIconProp("attrs-icon-w", i)
                }
            }
        })], 1) : e._e(), e._v(" "), e.selectionState === "selects" ? o("div", {
            staticClass: "separator-dotted"
        }) : e._e(), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("input", {
            ref: "outOfStockInput",
            class: {
                "out-of-stock-input": !0, "full-width": e.outOfStockEditing
            },
            attrs: {
                readonly: !e.outOfStockEditing,
                placeholder: "Out of stock",
                maxlength: "32",
                spellcheck: "false"
            },
            domProps: {
                value: e.outOfStock
            },
            on: {
                blur: function(i) {
                    return i.preventDefault(), e.onOutOfStockBlur(i)
                }
            }
        }), e._v(" "), e.outOfStockEditing ? e._e() : o("button", {
            staticClass: "edit-out-of-stock-button",
            on: {
                click: function(i) {
                    return i.preventDefault(), e.onEditOutOfStockClick(i)
                }
            }
        }, [e._v(`
        Edit text
      `)])])]) : e._e(), e._v(" "), e.stylingState === "hover" ? o("div", {
            staticClass: "settings-panel"
        }, [o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Shape color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.getColorValue("hover-background-color"),
                alpha: e.getColorValue("hover-background-color-opacity"),
                "custom-icon": e.isDisabledValue("hover-background-color") || e.isDisabledValue("hover-background-color-opacity") ? e.colorDisabledImg : null
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changeHoverPropHandler("hover-background-color", i)
                },
                "update:alpha": function(i) {
                    return e.changeHoverPropHandler("hover-background-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Radius")]), e._v(" "), o("div", {
            staticClass: "num-input-wrap"
        }, [o("img", {
            class: {
                "disabled-numeric": !0, "show-disabled-icon": e.isDisabledValue("hover-border-radius")
            },
            attrs: {
                src: e.numberDisabledImg
            }
        }), e._v(" "), o("numeric-input", {
            class: {
                "num-input": !0, "hidden-num-input": e.isDisabledValue("hover-border-radius")
            },
            attrs: {
                autosize: !0,
                value: e.getNumValue("hover-border-radius"),
                min: 0,
                max: 999,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changeHoverPropHandler("hover-border-radius", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border")]), e._v(" "), o("div", {
            staticClass: "num-input-wrap"
        }, [o("img", {
            class: {
                "disabled-numeric": !0, "show-disabled-icon": e.isDisabledValue("hover-border-width")
            },
            attrs: {
                src: e.numberDisabledImg
            }
        }), e._v(" "), o("numeric-input", {
            class: {
                "num-input": !0, "hidden-num-input": e.isDisabledValue("hover-border-width")
            },
            attrs: {
                autosize: !0,
                value: e.getNumValue("hover-border-width"),
                min: 0,
                max: e.maxBtnBorderWidth,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changeHoverPropHandler("hover-border-width", i)
                }
            }
        })], 1)]), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Border color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.getColorValue("hover-border-color"),
                alpha: e.getColorValue("hover-border-color-opacity"),
                "custom-icon": e.isDisabledValue("hover-border-color") || e.isDisabledValue("hover-border-color-opacity") ? e.colorDisabledImg : null
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changeHoverPropHandler("hover-border-color", i)
                },
                "update:alpha": function(i) {
                    return e.changeHoverPropHandler("hover-border-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Text color")]), e._v(" "), o("color-picker", {
            staticClass: "round",
            attrs: {
                color: e.getColorValue("hover-color"),
                alpha: e.getColorValue("hover-color-opacity"),
                "custom-icon": e.isDisabledValue("hover-color") || e.isDisabledValue("hover-color-opacity") ? e.colorDisabledImg : null
            },
            on: {
                showPopup: e.closeOthersPopups,
                "update:color": function(i) {
                    return e.changeHoverPropHandler("hover-color", i)
                },
                "update:alpha": function(i) {
                    return e.changeHoverPropHandler("hover-color-opacity", i)
                }
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "separator-dotted"
        }), e._v(" "), o("div", {
            staticClass: "row"
        }, [o("div", {
            staticClass: "caption"
        }, [e._v("Transition")]), e._v(" "), o("numeric-input", {
            staticClass: "num-input",
            attrs: {
                autosize: !0,
                value: e.m["hover-tansition-duration"],
                min: 0,
                max: 2,
                step: .1,
                "use-float": !0,
                "label-selector": ".caption"
            },
            on: {
                change: function(i) {
                    return e.changeSinglePropHandler("hover-tansition-duration", i)
                }
            }
        })], 1)]) : e._e()])
    }, AJ = [], LJ = void 0, zJ = void 0, $J = void 0, WJ = !1;
    jJ = OJ({
        render: DJ,
        staticRenderFns: AJ
    }, LJ, FJ, zJ, WJ, $J, !1, void 0, void 0, void 0), nA = jJ
});
var sA = k(() => {});

function XJ(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-cart-connections.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var Vb, HJ, NJ, UJ, VJ, GJ, YJ, ZJ, KJ, aA, lA = k(() => {
    "use strict";
    Vb = E(Ze());
    na();
    wu();
    Mt();
    En();
    sA();
    HJ = {
        components: {
            RmSwitcher: Ra
        },
        mixins: [Mi],
        data: function() {
            let e = this.raw_block.workspace.eCommerceManager,
                t = e.getConnectedProvider();
            return {
                eCommerceManager: e,
                connectedProvider: t,
                connectedToStripe: t === "stripe",
                connectedToEcwid: t === "ecwid"
            }
        },
        computed: {
            switcherStripe: {
                get: function() {
                    return this.connectedToStripe
                },
                set: function(e) {
                    this.connectedToStripe = e
                }
            },
            switcherEcwid: {
                get: function() {
                    return this.connectedToEcwid
                },
                set: function(e) {
                    this.connectedToEcwid = e
                }
            }
        },
        mounted: function() {
            (0, Vb.default)(this.$el).find("div[data-alt]:not(.rmalttext, .viewport), li[data-alt]:not(.rmalttext)").RMAltText()
        },
        methods: {
            switcherStripeChange(e) {
                if (!this.connectedToEcwid)
                    if (e) {
                        if (!this.eCommerceManager.canBeConnectedTo("stripe")) return;
                        this.connectToStripe().then(t => {
                            this.switcherStripe = !0, this.checkControlsRestrictions(), t && this.eCommerceManager.updateEcommerceData(t)
                        }).catch(() => {
                            this.switcherStripe = !1, this.checkControlsRestrictions()
                        })
                    } else this.eCommerceManager.disconnect().then(t => {
                        this.switcherStripe = !1, t && this.raw_block.workspace.mag.set({
                            ecommerce_data: t
                        }, {
                            silent: !0
                        }), this.checkControlsRestrictions()
                    }).catch(t => {
                        console.error("ecwid disconnect error", t), this.switcherStripe = !0, this.checkControlsRestrictions()
                    })
            },
            connectToStripe() {
                return new Promise((e, t) => {
                    window.open("/api/connect/ecommerce/stripe/connect?num_id=" + this.raw_block.workspace.mag.get("num_id"), "_blank"), this.initStripeSocket().then(o => {
                        o && this.raw_block.workspace.mag.set({
                            ecommerce_data: o
                        }, {
                            silent: !0
                        }), e(o)
                    }).catch(o => {
                        t(o)
                    })
                })
            },
            initStripeSocket() {
                return new Promise((e, t) => {
                    let o = window.location.origin === de.readymag_auth_host,
                        i = o && de.isProd ? "sockets.readymag.com/stripe-auth" : "/stripe-auth";
                    pt("constructor.socketsHostFromEnv") && (i = o && de.readymag_sockets_host ? `${de.readymag_sockets_host}/stripe-auth` : "/stripe-auth");
                    let n = io(i, {
                        timeout: 5e3,
                        transports: ["websocket"]
                    });
                    n.on("connect", () => {
                        n.emit("wainting for mag stripe auth update", {
                            num_id: this.raw_block.workspace.mag.get("num_id"),
                            user: RM.constructorRouter.me.pick("name", "email", "_id"),
                            hash: this.raw_block.workspace.mag.get("socket_hash")
                        }), n.on("state-update", s => {
                            n.disconnect(), s.error ? t(s.error) : e(s.ecommerce_data)
                        })
                    })
                })
            },
            switcherEcwidChange(e) {
                if (!this.connectedToStripe)
                    if (e) {
                        if (!this.eCommerceManager.canBeConnectedTo("ecwid")) return;
                        this.startOauth("ecwid")
                    } else this.eCommerceManager.disconnect().then(t => {
                        this.switcherEcwid = !1, t && this.raw_block.workspace.mag.set({
                            ecommerce_data: t
                        }, {
                            silent: !0
                        }), this.checkControlsRestrictions()
                    }).catch(t => {
                        console.error("ecwid disconnect error", t), this.switcherEcwid = !0, this.checkControlsRestrictions()
                    })
            },
            startOauth(e) {
                this.AuthWindow && this.AuthWindow.close(), this.requestedProvider = e, (0, Vb.default)(window).on("message", this.processWindowMessage);
                let t = screen.width,
                    o = screen.height,
                    i = Math.min(1e3, t),
                    n = Math.min(700, o - 40),
                    s = Math.ceil((t - i) / 2),
                    a = Math.ceil((o - n) / 2),
                    l = `?num_id=${this.raw_block.workspace.mag.get("num_id")}`;
                this.AuthWindow = window.open(`/api/connect/ecommerce/${e}/connect${l}`, "_blank", ["toolbar=no", "location=" + (window.opera ? "no" : "yes"), "directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no", "width=" + i, "height=" + n, "top=" + a, "left=" + s].join())
            },
            processWindowMessage(e = {}) {
                let t, o = e.originalEvent || {};
                if (o.origin === de.readymag_auth_host) {
                    try {
                        t = JSON.parse(decodeURIComponent(o.data))
                    } catch {
                        console.log("Error parsing uri data")
                    }
                    t && t.event === "social-auth" && ((0, Vb.default)(window).off("message", this.processWindowMessage), this.AuthWindow && this.AuthWindow.close(), this.AuthWindow = null, this.handleAuthResult(t.message))
                }
            },
            handleAuthResult(e = {}) {
                let t = ((e.data || {}).provider || "").toLowerCase();
                if (this.requestedProvider) {
                    if (e.error) {
                        alert(`Connection error${e.error.message?`: ${e.error.message}`:""}`);
                        return
                    }
                    if (!t || t !== this.requestedProvider) {
                        this[`switcher${this.requestedProvider.charAt(0).toUpperCase()+this.requestedProvider.slice(1)}`] = !1, this.requestedProvider = null;
                        return
                    }
                    this[`switcher${t.charAt(0).toUpperCase()+t.slice(1)}`] = !0, this.eCommerceManager.updateEcommerceDataFromServer().then(o => {
                        o && this.raw_block.workspace.mag.set({
                            ecommerce_data: o
                        }, {
                            silent: !0
                        })
                    }), this.checkControlsRestrictions(), this.requestedProvider = null
                }
            },
            checkControlsRestrictions() {
                this.raw_block.workspace.controls.setControls(this.raw_block.controls, this.raw_block)
            }
        }
    }, NJ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel connect-panel"
        }, [o("div", {
            staticClass: "title-row"
        }, [o("span", {
            staticClass: "title"
        }, [e._v(e._s(e.connectedToStripe || e.connectedToEcwid ? "Connected" : "Connect") + " to")]), e._v(" "), o("a", {
            ref: "question-enabled",
            staticClass: "question-icon",
            attrs: {
                href: "https://help.readymag.com/hc/en-us/articles/360035903372",
                rel: "noreferrer noopener",
                target: "_blank",
                "data-alt-style": "controls-ecommerce-connection-icon-tooltip"
            }
        }, [e._v(`
      ?
    `)])]), e._v(" "), o("div", {
            staticClass: "providers-container"
        }, [o("div", {
            staticClass: "provider-row"
        }, [o("span", {
            staticClass: "provider-name"
        }, [e._v("Ecwid")]), e._v(" "), o("div", {
            class: {
                "rmalttext-disable": e.eCommerceManager.canBeConnectedTo("ecwid")
            },
            attrs: {
                "data-alt": "Disconnect Stripe to proceed",
                "data-alt-pos": "top",
                "data-alt-offset": "12"
            }
        }, [o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: !e.connectedToEcwid,
                expression: "!connectedToEcwid"
            }],
            staticClass: "connect-button",
            class: {
                disabled: !e.eCommerceManager.canBeConnectedTo("ecwid")
            },
            on: {
                click: function(i) {
                    return e.switcherEcwidChange(!0)
                }
            }
        })]), e._v(" "), o("rm-switcher", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.connectedToEcwid,
                expression: "connectedToEcwid"
            }],
            attrs: {
                value: e.switcherEcwid,
                width: 40,
                height: 24,
                "color-on": "#0080FF",
                "color-off": "#B8B8B8",
                "is-disabled": e.connectedToStripe,
                callback: e.switcherEcwidChange
            }
        })], 1), e._v(" "), o("div", {
            staticClass: "divider"
        }), e._v(" "), o("div", {
            staticClass: "provider-row"
        }, [o("span", {
            staticClass: "provider-name"
        }, [e._v("Stripe")]), e._v(" "), o("div", {
            class: {
                "rmalttext-disable": e.eCommerceManager.canBeConnectedTo("stripe")
            },
            attrs: {
                "data-alt": "Disconnect Ecwid to proceed",
                "data-alt-pos": "top",
                "data-alt-offset": "12"
            }
        }, [o("div", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: !e.connectedToStripe,
                expression: "!connectedToStripe"
            }],
            staticClass: "connect-button",
            class: {
                disabled: !e.eCommerceManager.canBeConnectedTo("stripe")
            },
            on: {
                click: function(i) {
                    return e.switcherStripeChange(!0)
                }
            }
        })]), e._v(" "), o("rm-switcher", {
            directives: [{
                name: "show",
                rawName: "v-show",
                value: e.connectedToStripe,
                expression: "connectedToStripe"
            }],
            attrs: {
                value: e.switcherStripe,
                width: 40,
                height: 24,
                "color-on": "#0080FF",
                "color-off": "#B8B8B8",
                "is-disabled": e.connectedToEcwid,
                callback: e.switcherStripeChange
            }
        })], 1)])])
    }, UJ = [], VJ = void 0, GJ = void 0, YJ = void 0, ZJ = !1;
    KJ = XJ({
        render: NJ,
        staticRenderFns: UJ
    }, VJ, HJ, GJ, ZJ, YJ, !1, void 0, void 0, void 0), aA = KJ
});
var cA = k(() => {});

function nq(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "panel-rmheader-settings.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var JJ, qJ, QJ, eq, tq, oq, iq, rq, dA, pA = k(() => {
    "use strict";
    na();
    xu();
    cA();
    JJ = {
        components: {
            RmSelect: Ea
        },
        mixins: [Mi],
        data: () => ({
            m: {
                activeLink: ""
            }
        })
    }, qJ = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "panel rmheader_settings"
        }, [e._m(0), e._v(" "), o("rm-select", {
            attrs: {
                options: [{
                    value: "none",
                    caption: "None"
                }, {
                    value: "features",
                    caption: "Features"
                }, {
                    value: "pricing",
                    caption: "Pricing"
                }, {
                    value: "examples",
                    caption: "Examples"
                }, {
                    value: "learn",
                    caption: "Learn"
                }, {
                    value: "for-designers",
                    caption: "Websites"
                }, {
                    value: "editorial",
                    caption: "Editorials"
                }, {
                    value: "portfolio",
                    caption: "Portfolios"
                }, {
                    value: "presentations",
                    caption: "Presentations"
                }]
            },
            model: {
                value: e.m.activeLink,
                callback: function(i) {
                    e.$set(e.m, "activeLink", i)
                },
                expression: "m.activeLink"
            }
        })], 1)
    }, QJ = [function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("div", {
            staticClass: "param-caption"
        }, [o("span", [e._v("RM Header")])])
    }], eq = void 0, tq = void 0, oq = void 0, iq = !1;
    rq = nq({
        render: qJ,
        staticRenderFns: QJ
    }, eq, JJ, tq, iq, oq, !1, void 0, void 0, void 0), dA = rq
});

function hq(e, t, o, i, n, s, a, l, c, d) {
    let p = (typeof o == "function" ? o.options : o) || {};
    return p.__file = "control.vue", p.render || (p.render = e.render, p.staticRenderFns = e.staticRenderFns, p._compiled = !0, n && (p.functional = !0)), p._scopeId = i, p
}
var uA, sq, aq, lq, cq, dq, pq, uq, mq, hA, mA = k(() => {
    "use strict";
    uA = E(ze());
    UF();
    qF();
    rD();
    aD();
    SD();
    ID();
    VD();
    ZD();
    rA();
    lA();
    pA();
    y_();
    Nr();
    sq = {
        components: {
            ControlIcon: NF,
            PanelAddtocartSettings: nA,
            PanelTwitterSettings: JF,
            PanelFacebookSettings: nD,
            PanelGmapsSettings: sD,
            PanelSlideshowSettings: _D,
            PanelSlideshowTransitions: kD,
            PanelCartConnections: aA,
            PanelCartSettings: UD,
            PanelProductSelector: YD,
            PanelRmheaderSettings: dA
        },
        mixins: [Ob],
        computed: {
            cssClasses: function() {
                let e = {
                    fade: this.faded && !this.selected || this.disabled,
                    checked: this.selected,
                    loading: this.loading,
                    "permission-controller": !0
                };
                if (this.raw_block.controlsClasses && typeof this.raw_block.controlsClasses == "function") {
                    let t = this.raw_block.controlsClasses(this.panelComponent);
                    t && (e[t] = !0)
                }
                return e[this.cssClass] = !0, e
            },
            isAllowed: function() {
                return so.isPermissionAllowed(this.rolePermission)
            },
            iconClass: function() {
                if (this.raw_block.controlsIconClasses && typeof this.raw_block.controlsIconClasses == "function") {
                    let e = this.raw_block.controlsIconClasses();
                    return e && e[this.panelComponent] ? typeof e[this.panelComponent] == "function" ? e[this.panelComponent]() : e[this.panelComponent] : null
                }
                return null
            }
        },
        methods: {
            onIconClick: function() {
                !this.selected && !this.disabled ? this.select() : this.selected && this.deselect()
            },
            deselect: function() {
                this.$emit("deselect")
            },
            select: function() {
                this.$emit("select")
            },
            canClosePanel: function() {
                if (!this.selected) return !0;
                let e = null;
                return uA.default.each(this.$children, t => {
                    t.canClose && e === null && (e = t.canClose())
                }), e === null ? !0 : e
            },
            closePopups: function() {
                this.$refs.panel.closeOthersPopups()
            },
            onPanelResize: function() {
                this.$emit("panel-resize", this.$refs.panel.$el)
            }
        }
    }, aq = function() {
        var e = this,
            t = e.$createElement,
            o = e._self._c || t;
        return o("transition", {
            attrs: {
                name: "control",
                appear: e.appearanceAnimation
            },
            on: {
                "after-leave": e.afterLeave
            }
        }, [e.visible ? o("div", {
            staticClass: "control",
            class: e.cssClasses,
            style: {
                top: e.y + "px"
            },
            attrs: {
                "aria-label": e.alt,
                disabled: !e.isAllowed
            }
        }, [o("control-icon", {
            attrs: {
                selected: e.selected,
                alt: e.alt,
                "icon-class": e.iconClass
            },
            nativeOn: {
                click: function(i) {
                    return e.onIconClick(i)
                }
            }
        }), e._v(" "), o("transition", {
            attrs: {
                name: "panel"
            }
        }, [e.selected ? o(e.panelComponent, {
            ref: "panel",
            tag: "component",
            attrs: {
                block: e.block,
                raw_block: e.raw_block
            },
            on: {
                resize: e.onPanelResize
            },
            nativeOn: {
                click: function(i) {
                    return e.closePopups(i)
                }
            }
        }) : e._e()], 1)], 1) : e._e()])
    }, lq = [], cq = void 0, dq = void 0, pq = void 0, uq = !1;
    mq = hq({
        render: aq,
        staticRenderFns: lq
    }, cq, sq, dq, uq, pq, !1, void 0, void 0, void 0), hA = mq
});
var pm, Cd, fq, Vt, Os = k(() => {
    "use strict";
    pm = E(Ze());
    Oc();
    Cd = E(ze());
    oo();
    $n();
    mA();
    fq = it.extend({
        name: null,
        panelComponent: null,
        $el: null,
        alt: null,
        rolePermission: null,
        saveOnDeselect: !0,
        saveOnDestroy: !0,
        waitForRender: function(e, t) {
            return this.isRendered() ? e.apply(this, t) : Qn.nextTick(function() {
                return e.apply(this, t)
            }.bind(this))
        },
        initialize: function(e) {
            e = e || {}, it.prototype.initialize.apply(this, arguments), this.block = this.blocks[0], this.model = e.models && e.models.length && e.models[0], this.y = e.y || e.fromY, this.bindShortcuts()
        },
        getData: function() {
            return {
                cssClass: this.name,
                panelComponent: this.panelComponent,
                rolePermission: this.rolePermission,
                faded: !1,
                selected: !1,
                disabled: !1,
                y: this.y,
                visible: !1,
                alt: this.alt,
                block: JSON.parse(JSON.stringify(this.model.attributes)),
                raw_block: this.blocks[0],
                loading: !1,
                appearanceAnimation: this.appearanceAnimation
            }
        },
        onModelChange: function() {
            this.waitForRender(this._onModelChange.bind(this), arguments)
        },
        _onModelChange: function(e) {
            this.vue.block = Cd.default.extend({}, this.vue.block, Cd.default.pick(rt(e.attributes), function(t) {
                return t !== void 0
            }))
        },
        onPanelChange: function(e) {
            this.model.set(rt(e))
        },
        render: function() {
            if (!this.isRendered()) {
                let e = this,
                    t = function(o) {
                        let i = o.$emit;
                        o.$emit = function() {
                            e.trigger.apply(e, arguments), i.apply(o, arguments)
                        }
                    };
                this.vue = new Qn({
                    mixins: [hA],
                    data: this.getData(),
                    mounted: function() {
                        t.called || (t(this), t.called = !0)
                    },
                    updated: function() {
                        t.called || (t(this), t.called = !0)
                    },
                    methods: {
                        afterLeave: function() {
                            this.$el.remove(), this.$destroy()
                        }
                    }
                }), this.vue.$on("panel-resize", this.onPanelResize), this.vue.visible = !0, this.$container.append('<div id="' + this.name + '">'), this.vue.$mount("#" + this.name), this.$el = (0, pm.default)(this.vue.$el), this.on("select", function() {
                    this.master.select(this)
                }.bind(this)), this.on("deselect", function() {
                    this.master.deselect()
                }.bind(this)), this.on("change", this.onPanelChange.bind(this)), this.listenTo(this.model, "change", this.onModelChange.bind(this)), this.setControlsStatusByBlockData(), this.block.on("disabledControls:changed", this.onDisabledControlsChanged.bind(this)), this.bindLogic()
            }
        },
        bindShortcuts: function() {
            this.shortcutHandler = this.master.select.bind(this.master, this), this.keyboardShortcut && RM.constructorRouter.bindGlobalKeyPress([{
                key: this.keyboardShortcut,
                handler: this.shortcutHandler
            }]), this.onWindowKeyUpBound = this.onWindowKeyUp.bind(this), (0, pm.default)(window).on("keyup", this.onWindowKeyUpBound)
        },
        unbindShortcuts: function() {
            this.keyboardShortcut && RM.constructorRouter.unbindGlobalKeyPress(this.keyboardShortcut, this.shortcutHandler), (0, pm.default)(window).off("keyup", this.onWindowKeyUpBound)
        },
        isRendered: function() {
            return !!this.vue
        },
        onPanelResize: function(e) {
            this.$panel = (0, pm.default)(e), this.updatePanelVerticalPosition()
        },
        select: function() {
            this.waitForRender(this._select.bind(this), arguments)
        },
        _select: function() {
            this.makeModelSnapshot(),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls")
                }), Cd.default.extend(this.vue, {
                    selected: !0,
                    faded: !1
                }), this.selected = !0
        },
        deselect: function() {
            this.waitForRender(this._deselect.bind(this), arguments)
        },
        _deselect: function() {
            if (!this.vue) return;
            let e = this.vue.selected;
            Cd.default.extend(this.vue, {
                selected: !1,
                faded: !1
            }), this.selected = !1, this.clearModelSnapshot(e)
        },
        fade: function() {
            this.waitForRender(this._fade.bind(this), arguments)
        },
        _fade: function() {
            this.deselect(), Cd.default.extend(this.vue, {
                faded: !0
            })
        },
        setEnabled: function() {
            this.waitForRender(this._setEnabled.bind(this), arguments)
        },
        _setEnabled: function() {
            this.vue.disabled = !1
        },
        setDisabled: function() {
            this.waitForRender(this._setDisabled.bind(this), arguments)
        },
        _setDisabled: function() {
            Cd.default.extend(this.vue, {
                selected: !1,
                disabled: !0
            })
        },
        canControlBeClosed: function() {
            return this.waitForRender(this._canControlBeClosed.bind(this), arguments)
        },
        _canControlBeClosed: function(e = {}) {
            return this.vue && this.vue.selected ? (this.vue.canClosePanel() && this.master.deselect(), !e.closeSelected) : !1
        },
        moveToNewPos: function() {
            this.waitForRender(this._moveToNewPos.bind(this), arguments)
        },
        _moveToNewPos: function(e) {
            this.vue ? this.vue.y = e : this.y = e
        },
        onEscKey: function() {
            this.waitForRender(this._onEscKey.bind(this), arguments)
        },
        _onEscKey: function() {
            this.vue.selected && this.master.deselect()
        },
        save: function() {
            this.model.save({})
        },
        destroy: function(e) {
            this.vue && (this.vue.visible = !1, e || (this.vue.$el.remove(), this.vue.$destroy()), this.block.off("disabledControls:changed", this.onDisabledControlsChanged), this.unBindLogic(), this.unbindShortcuts(), this.stopListening(this.model, "change"), this.clearModelSnapshot(this.vue.selected))
        }
    }), Vt = fq
});
var gq, fA, gA = k(() => {
    "use strict";
    Os();
    gq = Vt.extend({
        name: "gmaps_settings",
        alt: "Settings",
        panelComponent: "panel-gmaps-settings"
    }), fA = gq
});
var bA, yA = k(() => {
    "use strict";
    no();
    bA = {
        "template-constructor-control-button_edit": Ae `

	<div class="icon noarrow" aria-label="Edit button text" data-alt="Edit Text" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="panel"></div>

`
    }
});
var bq, vA, wA = k(() => {
    "use strict";
    $n();
    yA();
    bq = it.extend({
        name: "button_edit",
        className: "control button_edit",
        rolePermission: "ButtonCanChangeText",
        saveOnDeselect: !0,
        saveOnDestroy: !0,
        initialize: function(e) {
            this.template = bA["template-constructor-control-button_edit"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model
        },
        select: function() {
            it.prototype.select.apply(this, arguments),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls-button_edit")
                })
        },
        onClick: function() {
            if (this.isOnClickDisabled()) return;
            let e = this.blocks && this.blocks[0];
            e.isEditMode ? e.leaveEditMode({
                deselectControl: !0
            }) : e.enterEditMode()
        },
        onEscKey: function() {
            let e = this.blocks && this.blocks[0];
            e.isEditMode && e.leaveEditMode({
                deselectControl: !0,
                saveWidgetData: !0
            })
        },
        onEnterKey: function() {
            let e = this.blocks && this.blocks[0];
            e.isEditMode && e.leaveEditMode({
                deselectControl: !0,
                saveWidgetData: !0
            })
        },
        save: function() {
            (this.blocks && this.blocks[0]).saveWidgetData()
        },
        canControlBeClosed: function() {
            return !1
        },
        deselect: function() {
            let e = this.blocks && this.blocks[0];
            e.isEditMode && e.leaveEditMode(), it.prototype.deselect.apply(this, arguments)
        },
        destroy: function() {
            let e = this.blocks && this.blocks[0];
            e && e.isEditMode && e.leaveEditMode(), it.prototype.destroy.apply(this, arguments)
        }
    }), vA = bq
});

function _A({
    projectId: e,
    userId: t,
    buttons: o,
    onChange: i,
    isGroupSelected: n,
    maxBorderWidth: s
}) {
    let {
        dropdownContainer: a
    } = (0, al.useContext)(Ot), l = o[0], c = !n || n && o.every(w => w["hover-border-radius"] === l["hover-border-radius"]) ? l["hover-border-radius"] || 0 : "mixed", d = !n || n && o.every(w => w["hover-border-width"] === l["hover-border-width"]) ? l["hover-border-width"] || 0 : "mixed", p = !n || n && o.every(w => w.transitionTime === l.transitionTime) ? l.transitionTime || 0 : "mixed", h = (0, al.useMemo)(() => ss(o, w => `#${w["hover-background-color"]}`), [o]), u = (0, al.useMemo)(() => ss(o, w => w["hover-background-color-opacity"]), [o]), m = (0, al.useMemo)(() => ss(o, w => `#${w["hover-border-color"]}`), [o]), f = (0, al.useMemo)(() => ss(o, w => w["hover-border-color-opacity"]), [o]), g = (0, al.useMemo)(() => ss(o, w => `#${w["hover-color"]}`), [o]), y = (0, al.useMemo)(() => ss(o, w => w["hover-color-opacity"]), [o]), S = w => v => {
        if (!v) return;
        let [C, I] = w;
        return i({
            [C]: yt(v),
            [I]: Math.min(Math.round(v.a * 100), 100)
        })
    };
    return x(Q, {
        children: [r(qe, {
            container: a,
            title: "Shape color",
            projectId: e,
            userId: t,
            color: ct(h[0], Zo(u[0])),
            colors: h,
            opacity: u,
            setColor: S(["hover-background-color", "hover-background-color-opacity"]),
            onChangeComplete: S(["hover-background-color", "hover-background-color-opacity"])
        }), l.form !== "circle" && r(H, {
            leftSlot: "Radius",
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                children: r(fe, {
                    min: 0,
                    max: 999,
                    value: c === "mixed" ? 0 : c,
                    isMixedValue: c === "mixed",
                    textStyle: c === "mixed" ? "small" : "subheading",
                    textAlign: "right",
                    autoWidth: !0,
                    onChange: ({
                        value: w
                    }) => {
                        i({
                            "hover-border-radius": w
                        })
                    }
                })
            })
        }), r(H, {
            leftSlot: "Border",
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                children: r(fe, {
                    min: 0,
                    max: s,
                    value: d === "mixed" ? 0 : d,
                    isMixedValue: d === "mixed",
                    textStyle: d === "mixed" ? "small" : "subheading",
                    textAlign: "right",
                    autoWidth: !0,
                    onChange: ({
                        value: w
                    }) => {
                        i({
                            "hover-border-width": w
                        })
                    }
                })
            })
        }), r(qe, {
            container: a,
            title: "Border color",
            projectId: e,
            userId: t,
            color: ct(m[0], Zo(f[0])),
            colors: m,
            opacity: f,
            setColor: S(["hover-border-color", "hover-border-color-opacity"]),
            onChangeComplete: S(["hover-border-color", "hover-border-color-opacity"])
        }), r(qe, {
            container: a,
            title: "Text color",
            projectId: e,
            userId: t,
            color: ct(g[0], Zo(y[0])),
            colors: g,
            opacity: y,
            setColor: S(["hover-color", "hover-color-opacity"]),
            onChangeComplete: S(["hover-color", "hover-color-opacity"])
        }), r(H, {
            showBorder: !1,
            leftSlot: "Transition",
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                children: r(fe, {
                    min: 0,
                    max: 2,
                    step: .1,
                    value: p === "mixed" ? 0 : p,
                    isMixedValue: p === "mixed",
                    textStyle: p === "mixed" ? "small" : "subheading",
                    textAlign: "right",
                    autoWidth: !0,
                    onChange: ({
                        value: w
                    }) => {
                        i({
                            transitionTime: w
                        })
                    }
                })
            })
        })]
    })
}
var al, SA = k(() => {
    "use strict";
    al = E(N());
    nt();
    $e();
    zt();
    ie();
    nn();
    ko();
    Jv();
    C_();
    B()
});

function k_({
    form: e,
    onChange: t,
    isSelected: o
}) {
    let [i, n] = (0, CA.useState)(!1);
    return r(b, {
        height: 32,
        width: e === "rectangle" ? 56 : 32,
        borderRadius: e === "circle" ? "50%" : void 0,
        backgroundColor: o || i ? "black" : "gray",
        onClick: () => t(e),
        cursor: o ? "inherit" : "pointer",
        onMouseEnter: () => n(!0),
        onMouseLeave: () => n(!1),
        transition: "0.2s"
    })
}

function yq({
    value: e,
    onChange: t
}) {
    return x(b, {
        display: "flex",
        alignItems: "center",
        justifyContent: "space-between",
        children: [r(k_, {
            form: "rectangle",
            onChange: t,
            isSelected: e === "rectangle"
        }), r(k_, {
            form: "square",
            onChange: t,
            isSelected: e === "square"
        }), r(k_, {
            form: "circle",
            onChange: t,
            isSelected: e === "circle"
        })]
    })
}
var CA, kA, IA = k(() => {
    "use strict";
    CA = E(N());
    ie();
    Jv();
    B();
    kA = yq
});

function wq({
    showBorder: e = !0,
    fontFamily: t,
    fontWeight: o,
    fontStyle: i,
    onChangeStyle: n,
    dropdownContainer: s,
    onToggleSelectPanel: a,
    mixed: l = !1
}) {
    let c = (0, cc.useMemo)(() => (Array.isArray(t) ? t : [t]).filter(Boolean), [t]),
        [d, p] = (0, cc.useState)(() => c),
        [h, u] = (0, cc.useState)([]),
        m = (0, cc.useMemo)(() => o.length && i.length ? o.map((g, y) => {
            if (i[y]) return ip(g, i[y])
        }).filter(Boolean) : [], [o, i]);
    (0, cc.useEffect)(() => {
        let g = [];
        if (c.forEach(S => {
                let w = S && window.RM.constructorRouter.fonts.findFontByCSSName(S);
                w && w.variations && g.push(w.variations)
            }), u(c.length > 1 ? Gd(...g) : g[0] ? ? []), !c.every(S => d.includes(S))) {
            p(c);
            let S = t && window.RM.constructorRouter.fonts.findFontByCSSName(c[0]);
            if (S.variations && S.variations[0]) {
                let w = S.variations.includes("n4") ? "n4" : S.variations[0],
                    {
                        style: v,
                        weight: C
                    } = tr(w),
                    I = {};
                o.includes(C) || (I.weight = C), i.includes(v) || (I.style = v), Object.keys(I).length && n(I)
            }
        }
    }, [c]);
    let f = g => {
        let {
            style: y,
            weight: S
        } = tr(g.value);
        n({
            weight: S,
            style: y
        })
    };
    return r(es, {
        showBorder: e,
        container: s,
        items: [...h].sort(vq).map(g => ({
            value: g,
            label: Rs[g]
        })),
        value: l ? m : m[0],
        onSelect: f,
        onToggle: a,
        labelStyle: `
        font-family: ${d[0]?`${d[0]}, sans-serif`:"inherit"};
        font-weight: ${o||400};
        font-style: ${i||"normal"};
        line-height: 1;
      `,
        itemStyleFn: g => {
            let {
                style: y,
                weight: S
            } = tr(g.value);
            return `
        font-family: ${d[0]?`${d[0]}, sans-serif`:"inherit"};
        font-weight: ${S};
        font-style: ${y};
        color: #000;
      `
        }
    })
}
var cc, vq, Fa, I_ = k(() => {
    "use strict";
    cc = E(N());
    oo();
    yd();
    Yt();
    Fp();
    B();
    vq = (e, t) => {
        let o = parseInt(e.replace(/\D/g, "")),
            i = parseInt(t.replace(/\D/g, ""));
        return t === "v" ? -1 : o !== i ? o - i : e.match(/^n/) ? -1 : 1
    };
    Fa = wq
});
var um = k(() => {
    "use strict";
    I_();
    I_()
});

function ss(e, t) {
    let o = e.map(t);
    return (0, PA.uniq)(o)
}

function xq({
    buttons: e,
    onChange: t,
    projectId: o,
    userId: i,
    currentTab: n,
    onTabChange: s,
    currentFontFamilyList: a = [],
    onButtonStateChange: l,
    onToggleSelectPanel: c
}) {
    let {
        navigate: d
    } = (0, ti.useContext)(Jt), {
        dropdownContainer: p
    } = (0, ti.useContext)(Ot), {
        model: h
    } = (0, ti.useContext)(Y), u = e[0], m = (0, ti.useMemo)(() => e.length > 1, [e]), f = (0, ti.useMemo)(() => !!u.is_global && !!u.clickLink && !m, [u, m]), g = (0, ti.useMemo)(() => {
        let j = [{
            title: "Default"
        }, {
            title: "Hover"
        }];
        return f ? [...j, {
            title: "Current"
        }] : j
    }, [f]), y = (0, ti.useMemo)(() => Math.ceil(Math.min(u.w, u.h) / 2), [u.w, u.h]);
    (0, ti.useEffect)(() => {
        l(n === 0 ? "default" : n === 1 ? "hover" : "current")
    }, [n]), (0, ti.useEffect)(() => () => {
        l("default")
    }, []);
    let S = !m || m && e.every(j => j["border-radius"] === u["border-radius"]) ? u["border-radius"] : "mixed",
        w = !m || m && e.every(j => j["border-width"] === u["border-width"]) ? u["border-width"] : "mixed",
        v = !m || m && e.every(j => j["font-size"] === u["font-size"]) ? u["font-size"] || 0 : "mixed",
        C = !m || m && e.every(j => j["letter-spacing"] === u["letter-spacing"]) ? u["letter-spacing"] || 0 : "mixed",
        I = (0, ti.useMemo)(() => ct(u["current-border-color"], Zo(u["current-border-color-opacity"])), [e]),
        T = (0, ti.useMemo)(() => ct(u["current-color"], Zo(u["current-color-opacity"])), [e]),
        P = (0, ti.useMemo)(() => ct(u["background-color"], Zo(u["background-color-opacity"])), [e]),
        M = (0, ti.useMemo)(() => ct(u["current-background-color"], Zo(u["current-background-color-opacity"])), [e]),
        F = (0, ti.useMemo)(() => ss(e, j => `#${j["background-color"]}`), [e]),
        R = (0, ti.useMemo)(() => ss(e, j => j["background-color-opacity"]), [e]),
        A = (0, ti.useMemo)(() => ss(e, j => `#${j["border-color"]}`), [e]),
        D = (0, ti.useMemo)(() => ss(e, j => j["border-color-opacity"]), [e]),
        O = (0, ti.useMemo)(() => ss(e, j => `#${j.color}`), [e]),
        L = (0, ti.useMemo)(() => ss(e, j => j["color-opacity"]), [e]),
        W = h.isMixed(a),
        z = (j, se) => {
            if (j) return t({
                [se]: yt(j)
            })
        },
        V = (j, se) => t({
            [se]: j * 100
        }),
        X = e.map(j => j["font-weight"]).filter(Boolean),
        q = e.map(j => j["font-style"]).filter(Boolean),
        ne = h.isMixed(X),
        re = h.isMixed(q),
        te = x(Q, {
            children: [r(qe, {
                title: "Shape color",
                "data-testid": "button-background-swatch",
                container: p,
                projectId: o,
                userId: i,
                colors: F,
                opacity: R,
                color: P,
                setColor: j => z(j, "background-color"),
                onChangeComplete: j => z(j, "background-color"),
                onOpacityChange: j => V(j, "background-color-opacity")
            }), u.form !== "circle" && r(H, {
                leftSlot: "Radius",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        min: 0,
                        max: 999,
                        value: S === "mixed" ? 0 : S,
                        isMixedValue: S === "mixed",
                        textStyle: S === "mixed" ? "small" : "subheading",
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "border-radius": j
                            })
                        }
                    })
                })
            }), r(H, {
                leftSlot: "Border",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: w === "mixed" ? 0 : w,
                        min: 0,
                        max: y,
                        isMixedValue: w === "mixed",
                        textStyle: w === "mixed" ? "small" : "subheading",
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "border-width": j
                            })
                        }
                    })
                })
            }), r(qe, {
                container: p,
                title: "Border color",
                projectId: o,
                userId: i,
                colors: A,
                opacity: D,
                color: ct(A[0], Zo(D[0])),
                setColor: j => z(j, "border-color"),
                onChangeComplete: j => z(j, "border-color"),
                onOpacityChange: j => V(j, "border-color-opacity")
            }), !m && r(H, {
                leftSlot: "Side padding",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: u.em_w || 0,
                        min: 0,
                        max: 999,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                em_w: j
                            })
                        }
                    })
                })
            }), r(tl, {
                fontFamily: a[0],
                mixed: W,
                onClick: () => d("FontsList")
            }), r(Fa, {
                fontFamily: a,
                fontWeight: X.length ? X : [St.fontWeight],
                fontStyle: q.length ? q : [St.fontStyle],
                mixed: ne || re,
                dropdownContainer: p,
                onToggleSelectPanel: c,
                onChangeStyle: j => {
                    t({
                        "font-weight": j.weight,
                        "font-style": j.style
                    })
                }
            }), r(H, {
                leftSlot: "Size",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        min: 0,
                        max: 999,
                        value: v === "mixed" ? 0 : v,
                        isMixedValue: v === "mixed",
                        textStyle: v === "mixed" ? "small" : "subheading",
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "font-size": j
                            })
                        }
                    })
                })
            }), r(H, {
                leftSlot: "Letter spacing",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        min: -99,
                        max: 999,
                        step: .1,
                        value: C === "mixed" ? 0 : C,
                        isMixedValue: C === "mixed",
                        textStyle: C === "mixed" ? "small" : "subheading",
                        fontSize: String(C).length > 4 && C !== "mixed" ? 16 : void 0,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "letter-spacing": j
                            })
                        }
                    })
                })
            }), !m && r(H, {
                leftSlot: "Baseline shift",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: u.baselineShift || 0,
                        min: -999,
                        max: 999,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                baselineShift: j
                            })
                        }
                    })
                })
            }), r(qe, {
                container: p,
                showBorder: !1,
                title: "Text color",
                projectId: o,
                userId: i,
                color: ct(O[0], Zo(L[0])),
                colors: O,
                opacity: L,
                setColor: j => z(j, "color"),
                onChangeComplete: j => z(j, "color"),
                onOpacityChange: j => V(j, "color-opacity")
            })]
        }),
        ee = x(Q, {
            children: [r(qe, {
                container: p,
                title: "Shape color",
                projectId: o,
                userId: i,
                color: M,
                setColor: j => z(j, "current-background-color"),
                onChangeComplete: j => z(j, "current-background-color"),
                onOpacityChange: j => V(j, "current-background-color-opacity")
            }), u.form !== "circle" && r(H, {
                leftSlot: "Radius",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: u["current-border-radius"] || 0,
                        min: 0,
                        max: 999,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "current-border-radius": j
                            })
                        }
                    })
                })
            }), r(H, {
                leftSlot: "Border",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: u["current-border-width"] || 0,
                        min: 0,
                        max: y,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "current-border-width": j
                            })
                        }
                    })
                })
            }), r(qe, {
                container: p,
                title: "Border color",
                projectId: o,
                userId: i,
                color: I,
                setColor: j => z(j, "current-border-color"),
                onChangeComplete: j => z(j, "current-border-color"),
                onOpacityChange: j => V(j, "current-border-color-opacity")
            }), r(tl, {
                fontFamily: a[0],
                mixed: W,
                onClick: () => d("FontsList")
            }), r(Fa, {
                fontFamily: a,
                fontWeight: [u["current-font-weight"]],
                fontStyle: [u["current-font-style"]],
                mixed: h.isMixed(h.blocks.map(j => j.model.get("current-font-weight"))) || h.isMixed(h.blocks.map(j => j.model.get("current-font-style"))),
                dropdownContainer: p,
                onToggleSelectPanel: c,
                onChangeStyle: j => {
                    t({
                        "current-font-weight": j.weight,
                        "current-font-style": j.style
                    })
                }
            }), r(H, {
                leftSlot: "Size",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: u["current-font-size"] || 0,
                        min: 0,
                        max: 999,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "current-font-size": j
                            })
                        }
                    })
                })
            }), r(H, {
                leftSlot: "Letter spacing",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        textAlign: "right",
                        min: -99,
                        max: 999,
                        step: .1,
                        fontSize: String(u["current-letter-spacing"]).length > 4 ? 16 : void 0,
                        autoWidth: !0,
                        value: u["current-letter-spacing"] || 0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "current-letter-spacing": j
                            })
                        }
                    })
                })
            }), r(H, {
                leftSlot: "Baseline shift",
                rightSlot: r(b, {
                    display: "flex",
                    gap: 8,
                    alignItems: "center",
                    children: r(fe, {
                        value: u["current-baselineShift"] || 0,
                        min: -999,
                        max: 999,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            t({
                                "current-baselineShift": j
                            })
                        }
                    })
                })
            }), r(qe, {
                container: p,
                showBorder: !1,
                title: "Text color",
                projectId: o,
                userId: i,
                color: T,
                setColor: j => z(j, "current-color"),
                onChangeComplete: j => z(j, "current-color"),
                onOpacityChange: j => V(j, "current-color-opacity")
            })]
        });
    return x(Q, {
        children: [r(co, {
            title: "Button properties"
        }), !m && r(H, {
            children: r(kA, {
                value: u.form,
                onChange: j => t({
                    form: j
                })
            })
        }), r(os, {
            items: g,
            activeIndex: n,
            onChange: s
        }), n === 0 ? te : n === 1 ? r(_A, {
            projectId: o,
            userId: i,
            buttons: e,
            onChange: t,
            isGroupSelected: m,
            maxBorderWidth: y
        }) : ee]
    })
}
var ti, PA, _q, TA, C_ = k(() => {
    "use strict";
    ti = E(N()), PA = E(hn());
    ru();
    nt();
    $e();
    Vn();
    zt();
    ie();
    nn();
    SA();
    IA();
    ko();
    um();
    ol();
    ni();
    P_();
    _s();
    Jv();
    ae();
    B();
    _q = (0, ti.forwardRef)(({
        style: e,
        getScrollablePanelProps: t,
        ...o
    }, i) => r(Me, {
        isShowed: !0,
        ref: i,
        style: e,
        ...t(),
        children: r(xq, { ...o
        })
    })), TA = _q
});

function Sq() {
    let {
        model: e,
        modelSet: t
    } = (0, Dr.useContext)(Y), {
        model: o
    } = (0, Dr.useContext)(ge), i = (0, Dr.useMemo)(() => e.project.get("_id"), [e]), n = (0, Dr.useMemo)(() => e.user.get("_id"), [e]), s = (0, Dr.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), [a, l] = (0, Dr.useState)(0), c = (0, Dr.useMemo)(() => e.blocks.map(w => {
        switch (a) {
            case 0:
                return w.model.get("font-family");
            case 2:
                return w.model.get("current-font-family");
            default:
                return ""
        }
    }), [a, e.blocks, o["font-family"], o["current-font-family"]]), d = (0, Dr.useRef)(null), {
        canControlBeClosed: p,
        onStackUpdated: h
    } = As(d.current);
    e.injectedRefs.canControlBeClosed = p;
    let u = r(Ut, {
            showBorder: !1,
            leftSlot: r(K, {
                variant: "clean",
                onClick: () => d.current && d.current.goBack(),
                css: Z `
            &:hover svg {
              color: ${ce.black};
              opacity: 1;
            }
          `,
                children: r(_r, {
                    color: "darkGray"
                })
            })
        }),
        m = w => {
            if (a !== 0 && a !== 2) return;
            let v = w.variations.includes("n4") ? "n4" : w.variations[0],
                {
                    style: C,
                    weight: I
                } = tr(v);
            y({
                [a === 0 ? "font-family" : "current-font-family"]: w.css_name,
                [a === 0 ? "font-weight" : "current-font-weight"]: I,
                [a === 0 ? "font-style" : "current-font-style"]: C
            })
        },
        f = w => {
            s ? e.blocks.forEach(v => v.onChangeButtonState(w)) : e.block.onChangeButtonState(w)
        },
        g = w => t({
            preventClose: w
        }),
        y = w => {
            e.groupSetAndSave(w)
        },
        S = (0, Dr.useCallback)(w => {
            w.preventDefault(), !e.disabled && e.select()
        }, [e.disabled]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: w
        }) => r(ke, {
            ref: w,
            label: "Settings",
            onClick: S,
            children: r(Hl, {
                color: "white"
            })
        }),
        panel: ({
            ref: w,
            style: v,
            update: C,
            getScrollablePanelProps: I
        }) => e.selected ? x(Pr, {
            ref: d,
            initialScreen: "Settings",
            onStackUpdated: h,
            onNavigate: () => {
                C()
            },
            children: [r(lo, {
                screen: "Settings",
                children: r(TA, {
                    ref: w,
                    style: v,
                    buttons: s && e.multipleSelectedModels ? e.multipleSelectedModels.map(T => T.attributes) : [o],
                    onChange: y,
                    projectId: i,
                    userId: n,
                    currentTab: a,
                    onTabChange: l,
                    currentFontFamilyList: c,
                    onButtonStateChange: f,
                    onToggleSelectPanel: g,
                    getScrollablePanelProps: I
                })
            }), r(lo, {
                screen: "FontsList",
                children: r(ta, {
                    ref: w,
                    style: v,
                    headerSlot: u,
                    currentFontFamily: c,
                    onFontSelect: m
                })
            }), r(lo, {
                screen: "FontUploader",
                children: r(Ta, {
                    ref: w,
                    style: v
                })
            })]
        }) : null
    })
}
var Dr, BA, P_ = k(() => {
    "use strict";
    Dr = E(N());
    ve();
    gn();
    je();
    ut();
    qc();
    Bf();
    ae();
    ht();
    C_();
    ni();
    ol();
    Tr();
    Qp();
    Le();
    Yt();
    B();
    BA = Sq
});
var MA, RA = k(() => {
    "use strict";
    ae();
    P_();
    MA = Ce.extend({
        name: "button_settings",
        component: BA,
        rolePermission: "ButtonCanChangeSettings",
        restrictions: function(e, t) {
            return t.length && t.every(o => o.thumb === "button")
        }
    })
});
var EA, Gb, T_, FA = k(() => {
    "use strict";
    yr();
    sm();
    EA = {
        default: [{
            title: "Default"
        }, {
            title: "On click"
        }],
        tablet_portrait: [{
            title: "Default"
        }, {
            title: "On Tap"
        }],
        phone_portrait: [{
            title: "Default"
        }, {
            title: "On Tap"
        }]
    }, Gb = [{
        rm_id: "rm44",
        icon_url: G("./constructor/blocks/hotspot/default-collection/44-ellipse.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/44-ellipse.svg")
    }, {
        rm_id: "rm36",
        icon_url: G("./constructor/blocks/hotspot/default-collection/36-circle-2.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/36-circle-2.svg")
    }, {
        rm_id: "rm37",
        icon_url: G("./constructor/blocks/hotspot/default-collection/37-circle-3.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/37-circle-3.svg")
    }, {
        rm_id: "rm38",
        icon_url: G("./constructor/blocks/hotspot/default-collection/38-circle-exclamation.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/38-circle-exclamation.svg")
    }, {
        rm_id: "rm39",
        icon_url: G("./constructor/blocks/hotspot/default-collection/39-circle-plus.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/39-circle-plus.svg")
    }, {
        rm_id: "rm40",
        icon_url: G("./constructor/blocks/hotspot/default-collection/40-circle-question.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/40-circle-question.svg")
    }, {
        rm_id: "rm41",
        icon_url: G("./constructor/blocks/hotspot/default-collection/41-info-grotesk.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/41-info-grotesk.svg")
    }, {
        rm_id: "rm42",
        icon_url: G("./constructor/blocks/hotspot/default-collection/42-info-monospace.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/42-info-monospace.svg")
    }, {
        rm_id: "rm43",
        icon_url: G("./constructor/blocks/hotspot/default-collection/43-circle-plus.svg"),
        preview_url_42: G("./constructor/blocks/hotspot/default-collection/43-circle-plus.svg")
    }], T_ = [{
        rm_id: null,
        icon_url: null,
        preview_url_42: null,
        type: "invisible_rectangle"
    }, ...Gb]
});
var ra, DA = k(() => {
    "use strict";
    bu();
    ra = new $s
});

function B_(e) {
    let {
        iconId: t,
        iconType: o,
        showBorder: i = !0,
        additionalIcons: n = [],
        iconLoading: s,
        isOpenControlPanel: a,
        onChangeIcon: l
    } = e, [c, d] = (0, Ar.useState)(() => [...n, ...ra.getPersistedIcons("defaultIcons")]), [p, h] = (0, Ar.useState)(-1), [u, m] = (0, Ar.useState)(""), [f, g] = (0, Ar.useState)(null), [y, S] = (0, Ar.useState)(!1), w = (0, Ar.useRef)(null), v = (0, Ar.useRef)(null), I = !!Vf(w, {
        root: v.current,
        rootMargin: "80px"
    }) ? .isIntersecting;
    Va(() => {
        (f === "" || f === null) && P()
    }, [n]), (0, Ar.useEffect)(() => {
        a || P()
    }, [a]), (0, Ar.useEffect)(() => {
        I && !ra.searchInProgress && ra.prevSVGSearch.nextPage && c.length > 30 && R()
    }, [I]), Va(() => {
        if (c.length > 0) {
            let D = c.findIndex(O => O.rm_id !== null && O.rm_id !== void 0 && O.rm_id === t || O.id !== null && O.id !== void 0 && O.id === t || O.type === o);
            h(D)
        }
    }, [t, o, c]);
    let T = D => {
            h(D), D >= 0 && D < c.length && l(c[D])
        },
        P = () => {
            d([...n, ...ra.defaultIcons])
        },
        M = D => {
            let O = D.target.value;
            m(O), O === "" && (P(), g(""))
        },
        F = D => {
            if (D && D.preventDefault(), u === "") {
                ra.searchInProgress && ra.abort(), g(""), d([...n, ...ra.defaultIcons]);
                return
            }(f === null || f !== u) && R().then(() => {
                v.current ? .scrollTo({
                    top: 0
                })
            })
        },
        R = (0, Ar.useCallback)(() => {
            ra.searchInProgress && ra.abort(), S(!0);
            let D = u;
            return ra.fetchIconsPage(D).then(O => {
                if (O) {
                    let L = [...new Map(O.map(W => [W.id, W])).values()];
                    d([...L])
                }
                g(D), S(!1)
            })
        }, [u]),
        A = () => {
            be.isSubscriptionPaused() ? window ? .RM ? .constructorRouter ? .trigger("notice:show", "unpauseSubscriptionToSearchNounIcons", {
                canBeClosed: !0
            }) : Jo("icon-library")
        };
    return x(Q, {
        children: [be.isNounSearchAvailable() && r(Eb, {
            label: "Search icon",
            isLoading: y,
            searchText: u,
            onChangeSearch: M,
            onSubmit: F
        }), r(H, {
            showBorder: i,
            css: Z `
          margin: -15px 0 0;
          padding: 0 16px 0 16px !important;
        `,
            children: r(rm, {
                icons: c,
                iconLoading: s,
                selectedIndex: p,
                scrollableRef: v,
                paginationItemRef: w,
                isMoreIconsButtonEnabled: !be.isNounSearchAvailable(),
                onClickIcon: T,
                onMoreIconsButtonClick: A
            })
        })]
    })
}
var Ar, AA = k(() => {
    "use strict";
    Ar = E(N());
    DA();
    $e();
    sm();
    c_();
    Km();
    Wt();
    jr();
    Xs();
    sh();
    sd();
    B()
});
var LA = k(() => {
    "use strict";
    AA()
});
async function zA({
    changeset: e,
    hotspotModel: t,
    isDefaultTab: o,
    hotspotsGroupCollection: i,
    currentViewport: n,
    rasterizeIconSVG: s,
    getNormalizedSVG: a,
    setIconLoading: l,
    groupSet: c,
    groupSave: d
}) {
    l(!0);
    let p = [];
    if (e) {
        let f = !!t["viewport_default"],
            g = !!t["viewport_tablet_portrait"],
            y = !!t["viewport_phone_portrait"];
        f && p.push("default"), g && p.push("tablet_portrait"), y && p.push("phone_portrait")
    } else p.push(n), ["tablet_portrait", "phone_portrait"].forEach(f => {
        if (n !== f && n === "default") {
            let g = t[`viewport_${f}`];
            if (g) {
                let y = {
                    bgColor: o ? g.bg_color : g.clickBgColor,
                    bgOpacity: o ? g.bg_opacity : g.clickBgOpacity
                };
                !y.bgColor && !y.bgOpacity && p.push(f)
            }
        }
    });
    p.forEach(f => {
        let {
            b64url: g
        } = a(f), y = i.map(S => o ? {
            _id: S.get("_id"),
            b64url: g,
            raster2xUrl: "",
            raster3xUrl: "",
            rasterUrl: ""
        } : {
            _id: t.get("_id"),
            clickB64url: g,
            clickRaster2xUrl: "",
            clickRaster3xUrl: "",
            clickRasterUrl: ""
        }) || {};
        c(y, {
            viewport: f
        })
    }), d();
    let h = {
            noPresave: !0,
            noSaveUrls: !0,
            noUnsetUrls: !0
        },
        u = p.map(f => s({ ...h,
            viewport: f
        })),
        m = await Promise.all(u).finally(() => l(!1));
    for (let f = 0; f < m.length; f++) {
        let g = m[f],
            y = p[f];
        if (g ? .raster2xUrl && g ? .raster3xUrl && g ? .rasterUrl && i) {
            let S = i.map(w => o ? (w.unsetInViewports({
                b64url: ""
            }, {
                silent: !0
            }), {
                _id: w.get("_id"),
                ...e,
                raster2xUrl: g.raster2xUrl,
                raster3xUrl: g.raster3xUrl,
                rasterUrl: g.rasterUrl
            }) : (w.unsetInViewports({
                clickB64url: ""
            }, {
                silent: !0
            }), {
                _id: w.get("_id"),
                ...e,
                clickRaster2xUrl: g.raster2xUrl,
                clickRaster3xUrl: g.raster3xUrl,
                clickRasterUrl: g.rasterUrl
            }));
            c(S, {
                viewport: y
            })
        }
    }
    d({
        patch: !1,
        reset: !0
    }), l(!1)
}
var $A = k(() => {
    "use strict"
});
var Yb, M_ = k(() => {
    "use strict";
    Yb = (e, t) => {
        let o = t === "phone_portrait";
        return e !== void 0 ? e : !!o
    }
});

function OA(e) {
    let {
        model: t,
        projectId: o,
        userId: i,
        isOpenControlPanel: n,
        tabIndex: s,
        setTabIndex: a,
        groupSave: l,
        groupSet: c
    } = e, {
        dropdownContainer: d
    } = (0, Uo.useContext)(Ot), {
        model: p
    } = (0, Uo.useContext)(Y), h = p.workspace.viewport, [u] = (0, Uo.useState)(t.tip_show_on), [m, f] = (0, Uo.useState)(!1), [g, y] = (0, Uo.useState)(ct(t.bg_color, Zo(t.bg_opacity * 100))), [S, w] = (0, Uo.useState)(ct(t.color, Zo(t.opacity * 100))), [v, C] = (0, Uo.useState)(t.pinPosRelativeTip || "behind"), [I, T] = (0, Uo.useState)(t.pin_type), [P, M] = (0, Uo.useState)(t.rm_id || t.noun_id), [F, R] = (0, Uo.useState)(t.borders), [A, D] = (0, Uo.useState)(s === 0), [O, L] = (0, Uo.useState)(!1), W = hk(() => Yb(t["tip_box-fullscreen"], h), [t["tip_box-fullscreen"], h]), [z, V] = (0, Uo.useState)(s === 0 ? T_ : Gb);
    (0, Uo.useEffect)(() => {
        !A && (t.clickNounUrl || t.clickRaster2xUrl || t.clickRaster2xUrl || t.clickRaster3xUrl || t.clickRasterUrl || t.clickB64url || t.clickRmId || t.clickNounId || t.clickBgColor || t.clickBgOpacity || t.clickBorders || t.clickColor || t.clickOpacity || t.clickPinType) ? f(!0) : f(!1)
    }, [A, t.clickNounUrl, t.clickRaster2xUrl, t.clickRaster3xUrl, t.clickRasterUrl, t.clickB64url, t.clickRmId, t.clickNounId, t.clickBgColor, t.clickBgOpacity, t.clickBorders, t.clickColor, t.clickOpacity, t.clickPinType]), (0, Uo.useEffect)(() => {
        t.pinPosRelativeTip && ["above", "behind"].includes(t.pinPosRelativeTip) ? C(t.pinPosRelativeTip) : C("behind")
    }, [t.pinPosRelativeTip]), (0, Uo.useEffect)(() => {
        ["rectangle"].includes(I) && (a(0), ne(), j())
    }, [I]), (0, Uo.useEffect)(() => {
        let J = p.block;
        s === 0 ? (V(T_), J.setEditingPinInOnClickMode(!1), D(!0)) : s === 1 && (V(Gb), J.setEditingPinInOnClickMode(!0), D(!1))
    }, [s]), (0, Uo.useEffect)(() => {
        y(A ? ct(t.bg_color, Zo(t.bg_opacity * 100)) : ct(t.clickBgColor || t.bg_color, Zo((t.clickBgOpacity || t.bg_opacity) * 100)))
    }, [A, t.bg_color, t.bg_opacity, t.clickBgColor, t.clickBgOpacity]), (0, Uo.useEffect)(() => {
        w(A ? ct(t.color, Zo(t.opacity * 100)) : ct(t.clickColor || t.color, Zo((t.clickOpacity || t.opacity) * 100)))
    }, [A, t.color, t.opacity, t.clickColor, t.clickOpacity]), (0, Uo.useEffect)(() => {
        T(A ? t.pin_type : t.clickPinType || t.pin_type)
    }, [A, t.pin_type, t.clickPinType]), (0, Uo.useEffect)(() => {
        M(A ? t.rm_id || t.noun_id : t.clickRmId || t.clickNounId || t.rm_id || t.noun_id)
    }, [A, t.rm_id, t.noun_id, t.clickRmId, t.clickNounId]), (0, Uo.useEffect)(() => {
        R(A ? t.borders : t.clickBorders || t.borders)
    }, [A, t.borders, t.clickBorders]);
    let X = J => {
            ["ellipse", "icon"].includes(I) && a(J)
        },
        q = J => p.block ? .hotspots_group_collection ? .map(ye => ({
            _id: ye.get("_id"),
            ...J
        })) || {},
        ne = () => {
            let J = q({
                pinPosRelativeTip: "behind"
            });
            c(J), l()
        },
        re = () => {
            let J = "above";
            if (v === "above" && (J = "behind"), v !== J) {
                let le = q({
                    pinPosRelativeTip: J
                });
                c(le), l()
            }
        },
        te = async J => {
            let le = h,
                ye = p.block;
            zA({
                changeset: J,
                hotspotModel: ye.model,
                isDefaultTab: A,
                hotspotsGroupCollection: ye.hotspots_group_collection,
                currentViewport: le,
                rasterizeIconSVG: ye.rasterize_icon_SVG,
                getNormalizedSVG: ye.getNormalizedSVG,
                setIconLoading: L,
                groupSet: c,
                groupSave: l
            })
        },
        {
            callback: ee
        } = Je(te, 400),
        j = () => {
            let J = p.block,
                le = ["clickNounUrl", "clickRaster2xUrl", "clickRaster3xUrl", "clickRasterUrl", "clickB64url", "clickRmId", "clickNounId", "clickBgColor", "clickBgOpacity", "clickBorders", "clickColor", "clickOpacity", "clickPinType"];
            J.hotspots_group_collection && J.hotspots_group_collection.forEach(ye => {
                le.forEach(Ue => ye.unset(Ue)), ye.save({
                    patch: !1,
                    reset: !0
                })
            })
        },
        se = J => {
            let le = p.block,
                ye = h,
                Ue = !!le.model["viewport_tablet_portrait"],
                Te = !!le.model["viewport_phone_portrait"];
            if (A || De(Fe.WidgetMisc, {
                    action: "icon on click select icon",
                    widgetType: "hotspot"
                }), (J.id || J.rm_id) && J.icon_url) {
                let Re = {},
                    Tt = J.id || J.rm_id;
                if ((A ? le.model.get("noun_id") || le.model.get("rm_id") : le.model.get("clickNounId") || le.model.get("clickRmId")) === Tt) return;
                L(!0), le.getIconSVG(Tt, J.icon_url, Qe => {
                    if (Qe) {
                        L(!1);
                        return
                    }
                    A ? (Re.pin_type = "icon", Re.noun_url = J.icon_url, Re.noun_id = J.id ? J.id : null, Re.rm_id = J.id ? null : J.rm_id) : (Re.clickPinType = "icon", Re.clickNounUrl = J.icon_url, Re.clickNounId = J.id ? J.id : null, Re.clickRmId = J.id ? null : J.rm_id);
                    let _t = {
                        default: le.getChangesetForHotspotAfterChangingIcon("default", "icon"),
                        tablet_portrait: le.getChangesetForHotspotAfterChangingIcon("tablet_portrait", "icon"),
                        phone_portrait: le.getChangesetForHotspotAfterChangingIcon("phone_portrait", "icon")
                    };
                    if (_t.default && ye !== "default" && c(_t.default, {
                            viewport: "default"
                        }), _t.tablet_portrait && ye !== "tablet_portrait" && Ue && c(_t.default, {
                            viewport: "tablet_portrait"
                        }), _t.phone_portrait && ye !== "phone_portrait" && Te && c(_t.phone_portrait, {
                            viewport: "phone_portrait"
                        }), _t[ye]) {
                        let Ge = _t[ye] ? .map(br => ({ ...br,
                            ...Re
                        }));
                        c(Ge)
                    }
                    te(Re)
                })
            } else if (J ? .type === "ellipse" || J ? .type === "invisible_rectangle") {
                let Re = {},
                    Tt = I,
                    Ee = J.type === "ellipse" ? "ellipse" : "rectangle";
                if (le.abortRasterizeIconSVG(), Tt === Ee) return;
                L(!0);
                let Qe = {
                    default: le.getChangesetForHotspotAfterChangingIcon("default", Ee),
                    tablet_portrait: le.getChangesetForHotspotAfterChangingIcon("tablet_portrait", Ee),
                    phone_portrait: le.getChangesetForHotspotAfterChangingIcon("phone_portrait", Ee)
                };
                if (Qe.default && c(Qe.default, {
                        viewport: "default"
                    }), Qe.tablet_portrait && Ue && c(Qe.tablet_portrait, {
                        viewport: "tablet_portrait"
                    }), Qe.phone_portrait && Te && c(Qe.phone_portrait, {
                        viewport: "phone_portrait"
                    }), A ? (Re.pin_type = Ee, Re.noun_url = null, Re.noun_id = null, Re.rm_id = null, Re.raster3xUrl = "", Re.raster2xUrl = "", Re.rasterUrl = "") : (Re.clickPinType = Ee, Re.clickNounUrl = null, Re.clickNounId = null, Re.clickRmId = null, Re.clickRaster2xUrl = "", Re.clickRaster3xUrl = "", Re.clickRasterUrl = ""), le.hotspots_group_collection) {
                    let _t = le.hotspots_group_collection.map(Ge => ({
                        _id: Ge.get("_id"),
                        ...Re
                    }));
                    c(_t), l()
                }
                L(!1)
            }
        },
        oe = J => {
            let le = q(J);
            c(le), l()
        },
        U = J => {
            J && (oe(A ? {
                bg_color: yt(J),
                bg_opacity: J.a
            } : {
                clickBgColor: yt(J),
                clickBgOpacity: J.a
            }), I === "icon" && ee())
        },
        he = J => {
            J && (oe(A ? {
                color: yt(J),
                opacity: J.a
            } : {
                clickColor: yt(J),
                clickOpacity: J.a
            }), I === "icon" && ee())
        },
        xe = J => {
            !Number.isNaN(J.value) && J.value >= 0 && J.value <= 999 && (oe(A ? {
                borders: J.value
            } : {
                clickBorders: J.value
            }), I === "icon" && ee())
        },
        pe = J => J === "ellipse" ? "ellipse" : J === "icon" ? "icon" : "invisible_rectangle";
    return x(b, {
        children: [u === "click" && r(b, {
            css: Z `
            button {
              cursor: ${["rectangle"].includes(I)?"default":"pointer"};
            }
          `,
            children: r(os, {
                items: EA[h || "default"],
                onChange: X,
                activeIndex: s,
                borderActiveColor: ["rectangle"].includes(I) ? sf.textDisabled : void 0,
                activeColor: ["rectangle"].includes(I) ? sf.textDisabled : void 0,
                color: ["rectangle"].includes(I) ? sf.textDisabled : void 0
            })
        }), r(B_, {
            showBorder: ["ellipse", "icon"].includes(I),
            additionalIcons: z,
            iconType: pe(I),
            iconId: P,
            iconLoading: O,
            isOpenControlPanel: n,
            onChangeIcon: se
        }), ["ellipse", "icon"].includes(I) && r(b, {
            children: r(qe, {
                circleSize: 26,
                showBorder: !0,
                container: d,
                title: "Icon color",
                projectId: o,
                userId: i,
                color: g,
                setColor: U
            })
        }), ["ellipse"].includes(I) && r(H, {
            showBorder: !0,
            leftSlot: "Border",
            rightSlot: x(b, {
                display: "flex",
                alignItems: "center",
                flexDirection: "row",
                children: [r(b, {
                    padding: "6px 10px 5px 5px",
                    children: r(fe, {
                        min: 0,
                        max: 999,
                        autoWidth: !0,
                        textAlign: "right",
                        value: F,
                        onChange: J => xe(J)
                    })
                }), r(qe, {
                    circleSize: 26,
                    showBorder: !1,
                    container: d,
                    projectId: o,
                    userId: i,
                    color: S,
                    skidding: -55,
                    setColor: he,
                    type: "circle-and-picker"
                })]
            })
        }), r(H, {
            showBorder: !1,
            leftSlot: "Position",
            rightSlot: r(K, {
                onClick: re,
                marginBottom: "4px",
                disabled: W || ["rectangle"].includes(I),
                children: r($, {
                    textStyle: "small",
                    whiteSpace: "pre",
                    color: W || ["rectangle"].includes(I) ? "black" : "blue",
                    children: `${v.charAt(0).toUpperCase()+v.slice(1)} popup`
                })
            })
        }), m && r(H, {
            showBorder: !1,
            children: r(K, {
                width: "100%",
                height: 40,
                variant: "bordered",
                fontWeight: 500,
                fontSize: 12,
                onClick: j,
                children: "Reset to default"
            })
        })]
    })
}
var Uo, jA = k(() => {
    "use strict";
    ie();
    ru();
    Uo = E(N());
    FA();
    nn();
    nt();
    qv();
    ko();
    $e();
    zt();
    LA();
    sm();
    ae();
    je();
    qo();
    $A();
    Be();
    M_();
    sh();
    qt();
    Ht();
    ut();
    ve();
    B()
});

function HA() {
    let {
        model: e
    } = (0, as.useContext)(Y), t = (0, as.useMemo)(() => e.project.get("_id"), [e]), o = (0, as.useMemo)(() => e.user.get("_id"), [e]), {
        model: i
    } = (0, as.useContext)(ge), {
        callback: n
    } = Je(e.workspace.save_group, 400), [s, a] = (0, as.useState)(0), [l, c] = (0, as.useState)(!1), d = (0, as.useCallback)(u => {
        u.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    (0, as.useEffect)(() => {
        c(e.selected)
    }, [e.selected]);
    let p = (u, m) => {
            e.block.workspace.set_group(u, m)
        },
        h = u => {
            let m = e.block;
            n(m.hotspots_group_collection, u)
        };
    return r(Ie, {
        offset: [100, 16],
        control: ({
            ref: u
        }) => r(ke, {
            ref: u,
            label: "Icon",
            onClick: d,
            children: r(Df, {
                width: 18,
                color: ce.white,
                css: Z `
              padding-bottom: 2px;
            `
            })
        }),
        panel: ({
            ref: u,
            style: m
        }) => e.selected ? x(Me, {
            isShowed: !0,
            style: m,
            ref: u,
            children: [r(b, {
                children: r(co, {
                    title: "Icon"
                })
            }), r(OA, {
                model: i,
                projectId: t,
                userId: o,
                tabIndex: s,
                isOpenControlPanel: l,
                setTabIndex: a,
                groupSave: h,
                groupSet: p
            })]
        }) : null
    })
}
var as, NA = k(() => {
    "use strict";
    as = E(N());
    nt();
    Vn();
    jA();
    ht();
    ae();
    Le();
    Km();
    ie();
    td();
    ut();
    qo();
    B()
});
var UA, VA = k(() => {
    "use strict";
    ae();
    NA();
    UA = Ce.extend({
        name: "hotspot_pin_settings",
        component: HA,
        rolePermission: "HotspotCanChangePinSettings"
    })
});

function YA({
    position: e,
    onChange: t,
    showBorder: o
}) {
    let i = (0, GA.useCallback)(n => {
        n !== e && t({
            tip_pos: n
        })
    }, [e, t]);
    return r(b, {
        width: "100%",
        height: 90,
        padding: "0 16px",
        children: x(b, {
            width: "100%",
            height: 90,
            display: "flex",
            flexDirection: "column",
            alignItems: "center",
            gap: 8,
            borderBottom: "2px solid",
            borderColor: o ? di("gray", .24) : "transparent",
            children: [r(b, {
                height: 40,
                textAlign: "center",
                display: "flex",
                alignItems: "center",
                children: r(Bo, {
                    textStyle: "regular",
                    children: "Position"
                })
            }), x(b, {
                width: 24,
                height: 24,
                position: "relative",
                children: [r(Zb, {
                    position: "top",
                    currentPosition: e,
                    onPositionClick: i
                }), r(Zb, {
                    position: "right",
                    currentPosition: e,
                    onPositionClick: i
                }), r(Zb, {
                    position: "bottom",
                    currentPosition: e,
                    onPositionClick: i
                }), r(Zb, {
                    position: "left",
                    currentPosition: e,
                    onPositionClick: i
                })]
            })]
        })
    })
}

function Zb({
    position: e,
    currentPosition: t,
    onPositionClick: o
}) {
    return r(kq, {
        elemPosition: e,
        top: e === "top" ? -10 : "auto",
        right: e === "right" ? -10 : "auto",
        bottom: e === "bottom" ? -10 : "auto",
        left: e === "left" ? -10 : "auto",
        alignItems: "center",
        justifyContent: "center",
        cursor: t === e ? "initial" : "pointer",
        onClick: () => o(e),
        css: Z `
        &:hover > .position-iner-item {
          background-color: ${t===e?ce.blue:ce.black};
        }
      `,
        children: r(Iq, {
            className: "position-iner-item",
            elemPosition: e,
            currentPosition: t
        })
    })
}
var GA, kq, Iq, ZA = k(() => {
    "use strict";
    GA = E(N());
    ie();
    Be();
    ve();
    ut();
    B();
    kq = ue(b, {
        excludeProps: ["elemPosition"]
    })(({
        elemPosition: e
    }) => ({
        width: e === "top" || e === "bottom" ? "24px" : "12px",
        height: e === "left" || e === "right" ? "24px" : "12px",
        position: "absolute",
        display: "flex"
    })), Iq = ue(b, {
        excludeProps: ["elemPosition", "currentPosition"]
    })(({
        theme: e,
        elemPosition: t,
        currentPosition: o
    }) => ({
        width: t === "top" || t === "bottom" ? "24px" : "2px",
        height: t === "left" || t === "right" ? "24px" : "2px",
        backgroundColor: (o === t ? e ? .colors.blue : e ? .colors.darkGray) || "#808080",
        transition: "background-color 0.2s"
    }))
});

function Xb(e, t, o = !1) {
    if (t || o) {
        if (["click", "tap"].includes(e)) return "click";
        if (["hover", "hold"].includes(e)) return "hover"
    } else if (["click", "tap"].includes(e) || ["hover", "hold"].includes(e)) return "tap";
    return "click"
}
var XA = k(() => {
    "use strict"
});

function KA({
    projectId: e,
    userId: t,
    model: o,
    isPhone: i,
    isDesktop: n,
    onChange: s
}) {
    let {
        dropdownContainer: a
    } = (0, ll.useContext)(Ot), {
        model: l
    } = (0, ll.useContext)(Y), c = l.workspace.viewport, d = o.flags ? .tipFreePosition, p = ct(o["tip_background-color"], Zo(o["tip_background-color-opacity"])), h = ct(o.tipBorderColor || "000000", Zo(o.tipBorderOpacity || 100)), u = (0, ll.useMemo)(() => {
        let F = o.tip_w || 0,
            R = o.tip_h || 0,
            A = Math.floor(Math.min(F, R) / 2);
        return Math.min(A, 999)
    }, [o.tip_w, o.tip_h]), [m, f] = (0, ll.useState)(o["tip_box-shadow"]), [g, y] = (0, ll.useState)(Yb(o["tip_box-fullscreen"], c)), [S, w] = (0, ll.useState)(Xb(o.tip_show_on, n)), v = () => {
        let F = l.block,
            R = !1,
            A = ["clickNounUrl", "clickRaster2xUrl", "clickRaster3xUrl", "clickRasterUrl", "clickB64url", "clickRmId", "clickNounId", "clickBgColor", "clickBgOpacity", "clickBorders", "clickColor", "clickOpacity", "clickPinType"];
        return F.hotspots_group_collection && F.hotspots_group_collection.forEach(D => {
            A.forEach(O => {
                D.get(O) && (R = !0, D.unset(O))
            })
        }), R
    }, C = () => {
        let F = !1,
            R = "click";
        Xb(S, n, !0) === "click" && (R = "hover"), w(Xb(R, n)), n && R === "hover" && (F = v()), I(R, F)
    }, I = (F, R = !1) => {
        let A = l.block;
        if (A.hotspots_group_collection) {
            let D = A.hotspots_group_collection ? .map(O => ({
                _id: O.get("_id"),
                tip_show_on: F
            }));
            A.workspace.set_group(D), A.workspace.save_group(A.hotspots_group_collection, {
                patch: !R,
                reset: R
            })
        } else s({
            tip_show_on: F
        })
    }, T = () => {
        let F = !m;
        f(F), s({
            "tip_box-shadow": F
        })
    }, P = () => {
        let F = l.block,
            R = F.hotspots_group_collection ? .map(A => ({
                _id: A.get("_id"),
                pinPosRelativeTip: "behind"
            }));
        F.workspace.set_group(R)
    }, M = () => {
        let F = !g;
        if (y(F), F) {
            let R = l.block;
            P(), R.model.set({
                "tip_box-fullscreen": F
            }), R.workspace.save_group(R.hotspots_group_collection)
        } else s({
            "tip_box-fullscreen": F
        });
        F && De(Fe.WidgetMisc, {
            action: "popup on icon tap fullscreen on",
            widgetType: "hotspot"
        })
    };
    return x(Q, {
        children: [r(H, {
            showBorder: !0,
            leftSlot: "Show",
            rightSlot: r(jl, {
                onClick: C,
                marginBottom: "4px",
                disabled: !n,
                children: r(Bo, {
                    textStyle: "small",
                    whiteSpace: "pre",
                    color: n ? "blue" : "black",
                    children: `On icon ${S}`
                })
            })
        }), r(H, {
            leftSlot: "Radius",
            showBorder: !0,
            rightSlot: r(fe, {
                min: 0,
                max: 100,
                step: 1,
                autoWidth: !0,
                value: o["tip_border-radius"],
                onChange: ({
                    value: F
                }) => s({
                    "tip_border-radius": F
                })
            })
        }), r(qe, {
            container: a,
            title: "Background",
            circleSize: 26,
            projectId: e,
            userId: t,
            color: p,
            setColor: F => {
                F && s({
                    "tip_background-color": yt(F),
                    "tip_background-color-opacity": F.a * 100
                })
            }
        }), r(H, {
            showBorder: !0,
            leftSlot: "Border",
            rightSlot: x(b, {
                display: "flex",
                alignItems: "center",
                flexDirection: "row",
                children: [r(b, {
                    padding: "6px 10px 5px 5px",
                    children: r(fe, {
                        min: 0,
                        max: u,
                        autoWidth: !0,
                        textAlign: "right",
                        value: o.tipBorder || 0,
                        onChange: ({
                            value: F
                        }) => s({
                            tipBorder: F
                        })
                    })
                }), r(qe, {
                    circleSize: 26,
                    showBorder: !1,
                    container: a,
                    projectId: e,
                    userId: t,
                    color: h,
                    skidding: -55,
                    setColor: F => {
                        F && s({
                            tipBorderColor: yt(F),
                            tipBorderOpacity: F.a * 100
                        })
                    },
                    type: "circle-and-picker"
                })]
            })
        }), r(H, {
            showBorder: i && d,
            leftSlot: "Shadow",
            rightSlot: r(Ve, {
                backgroundChecked: "blue",
                checked: m,
                onChange: () => {
                    T()
                }
            })
        }), i && d && r(H, {
            showBorder: !1,
            leftSlot: "Fullscreen",
            rightSlot: r(Ve, {
                backgroundChecked: "blue",
                checked: g,
                onChange: () => {
                    M()
                }
            })
        })]
    })
}
var ll, JA = k(() => {
    "use strict";
    ll = E(N());
    zt();
    nt();
    $e();
    Hi();
    nn();
    ko();
    qv();
    je();
    Be();
    ae();
    ie();
    XA();
    M_();
    qt();
    Ht();
    B()
});

function qA() {
    return x("svg", {
        width: "32",
        height: "32",
        viewBox: "0 0 32 32",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("g", {
            clipPath: "url(#clip0_2241_1234)",
            children: r("path", {
                fillRule: "evenodd",
                clipRule: "evenodd",
                d: "M10 9C8.89543 9 8 9.89543 8 11V19C8 20.1046 8.89543 21 10 21H14L15.0715 23.6788C15.4068 24.517 16.5932 24.517 16.9285 23.6788L18 21H22C23.1046 21 24 20.1046 24 19V11C24 9.89543 23.1046 9 22 9H10Z",
                fill: "currentColor"
            })
        }), r("defs", {
            children: r("clipPath", {
                id: "clip0_2241_1234",
                children: r("rect", {
                    width: "32",
                    height: "32",
                    fill: "currentColor",
                    transform: "matrix(0 1 -1 0 32 0)"
                })
            })
        })]
    })
}
var QA = k(() => {
    "use strict";
    B()
});

function R_() {
    let {
        model: e
    } = (0, js.useContext)(Y), t = (0, js.useMemo)(() => e.project.get("_id"), [e]), o = (0, js.useMemo)(() => e.user.get("_id"), [e]), i = (0, js.useMemo)(() => e.workspace.viewport, [e]), n = (0, js.useMemo)(() => i === "phone_portrait", [i]), s = (0, js.useMemo)(() => i === "default", [i]), {
        model: a,
        modelSet: l,
        modelSave: c
    } = (0, js.useContext)(ge), {
        callback: d
    } = Je(c, 400), p = (0, js.useCallback)(u => {
        u.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]), h = (0, js.useCallback)(u => {
        l(u), d()
    }, []);
    return r(Ie, {
        control: ({
            ref: u
        }) => r(ke, {
            ref: u,
            label: "Popup",
            onClick: p,
            children: r(qA, {})
        }),
        panel: ({
            ref: u,
            style: m
        }) => e.selected ? x(Me, {
            isShowed: !0,
            style: m,
            ref: u,
            children: [r(co, {
                title: "Popup"
            }), !a.flags ? .tipFreePosition && r(YA, {
                position: a.tip_pos,
                onChange: h,
                showBorder: !0
            }), r(KA, {
                projectId: t,
                userId: o,
                model: a,
                onChange: h,
                isPhone: n,
                isDesktop: s
            })]
        }) : null
    })
}
var js, e9 = k(() => {
    "use strict";
    js = E(N());
    qo();
    nt();
    Vn();
    ZA();
    JA();
    QA();
    ht();
    ae();
    Le();
    B()
});
var t9 = k(() => {
    "use strict";
    e9()
});
var o9, i9 = k(() => {
    "use strict";
    ae();
    t9();
    o9 = Ce.extend({
        name: "hotspot_tip_settings",
        component: R_,
        rolePermission: "HotspotCanChangeTipSettings"
    })
});
var dc, n9 = k(() => {
    "use strict";
    no();
    dc = {
        "template-constructor-control-form_content": Ae `
	<div class="icon noarrow" aria-label="Form fields" data-alt="Fields" data-alt-pos="left" data-alt-offset="9"></div>

	<div class="form-fields-panel panel js-panel">
		<div class="form-fields-header">Fields</div>

		<div class="form-fields-wrapper">
			<div class="resizable-scroll-wrapper">
				<div class="resizable-content-wrapper">
					<div class="resizable-content js-fields-container"></div>
				</div>
				<div class="resizable-scroll"></div>
			</div>
			<div class="js-settings-popup-container"></div>
		</div>


		<% if (options.canChangeFields)  { %>
			<div class="form-fields-footer js-add-block">
				<div class="js-new-settings-container"></div>
				<div class="form-fields-add js-add" title="Add field"></div>
			</div>
		<% } %>

		<div class="js-dropdown-panel-container"></div>

		<div class="resize-handle-top"></div>
		<div class="resize-handle-bottom"></div>
	</div>
`,
        "template-constructor-control-form_content-field": Ae `
	<div class="form-fields-item js-field form-fields-item-<%=tp%> <%=isSortable ? 'js-sortable' : 'js-not-sortable'%>"
	     data-id="<%=id%>" data-type="<%=tp%>">
		<% if (tp === 'dropdown') {  %>
			<div class="form-fields-caption-dropdown-helper">
				<div class="form-fields-caption-dropdown-mask js-dropdown-trigger"></div>
				<input type="text" name="" value="<%=text%>" placeholder="<%=placeholder%>" autocomplete="off" readonly="readonly"
				       class="form-fields-caption form-fields-caption-<%=tp%> js-field-caption js-field-caption-<%=tp%>"/>
			</div>
		<% } else if (tp === 'captcha') { %>
			<span class="form-invisible-mark">Invisible</span>
		<% } else { %>
			<input type="text" name="" value="<%=text%>" placeholder="<%=placeholder%>" autocomplete="off"
				       class="form-fields-caption form-fields-caption-<%=tp%> <%=mode%> js-field-caption js-field-caption-<%=tp%>"/>
		<% }; %>
		<% if (showSettings) {  %>
			<div class="form-fields-type-token js-settings-trigger"><%=typeLetter%></div>
		<% }; %>
		<% if (showDelete) {  %>
			<div class="form-fields-delete js-delete-field"></div>
		<% }; %>
		<% if (showSubmitAfterArrow) {  %>
			<div class="form-fields-placeholder-selector <%=showRemoveArrow ? 'action-icon remove-icon' : 'js-submit-dropdown-trigger'%>">
				<div class="form-fields-placeholder-arrow"></div>
			</div>
		<% }; %>
	</div>
`,
        "template-constructor-control-form_content-settings": Ae `
	<div class="settings-popup transition-enable js-settings-popup <%=edit ? 'settings-popup-edit js-edit-settings' : 'settings-popup-add js-add-settings'%>" data-id="<%=id%>">
		<div class="settings-popup-types">
			<% _.each(types, function(label, key) {  %>
				<div class="settings-popup-type js-field-type<%=key === selectedType ? ' selected' : ''%><%=key !== selectedType && disabledTypes && disabledTypes.length && disabledTypes.includes(key) ? ' disabled' : ''%>" data-value="<%=key%>" data-action="<%=edit ? 'edit' : 'add'%>">
					<%=label%>
				</div>
			<% }); %>
		</div>
		<% if (showOptionalSwitcher) {  %>
			<div class="settings-popup-optional">
				<div class="switcher-wrapper settings-popup-optional-switcher">
					<div class="switcher-caption settings-popup-optional-caption">Optional Field</div>
					<div class="switcher settings-popup-optional-value" data-type="optional"></div>
				</div>
			</div>
		<% }; %>
		<div class="corner-wrapper">
			<div class="corner"></div>
		</div>
	</div>
`,
        "template-constructor-control-form_content-after-submit": Ae `

	<div class="submit-wrapper settings-popup js-settings-popup">
		<div class="settings-popup-types">
			<% _.each(types, function(label, key) {  %>
				<div class="settings-popup-type js-submit-field-type <%=key === selectedType ? 'selected' : ''%>" data-value="<%=key%>" >
					<%=label%>
				</div>
			<% }); %>
		</div>

		<div class="resizable-scroll-wrapper">
			<div class="resizable-content-wrapper">
				<div class="resizable-content">
					<div class="styles-wrapper"></div>
				</div>
			</div>
			<div class="resizable-scroll"></div>
		</div>
	</div>
`,
        "template-constructor-control-form_content-dropdown": Ae `
	<div class="dropdown-panel js-dropdown-panel">
		<div class="dropdown-content">
			<div class="dropdown-header form-fields-header js-dropdown-caption-container"></div>

			<div class="dropdown-wrapper">
				<div class="resizable-scroll-wrapper">
					<div class="resizable-content-wrapper">
						<div class="resizable-content js-dropdown-content">
							<div class="dropdown-options js-dropdown-options-container"></div>
							<div class="dropdown-add dropdown-option form-fields-item js-add-option">+ Add</div>
						</div>
					</div>
					<div class="resizable-scroll"></div>
				</div>
			</div>

			<div class="dropdown-footer form-fields-footer">
				<div class="dropdown-save js-save-dropdown">Save</div>
				<div class="dropdown-cancel js-cancel-dropdown"></div>
			</div>
		</div>
	</div>
`,
        "template-constructor-control-form_content-dropdown-caption": Ae `
	<input type="text" name="" value="<%=text%>" placeholder="<%=placeholder%>" autocomplete="off"
						       class="dropdown-caption-value form-fields-caption js-dropdown-caption"/>
`,
        "template-constructor-control-form_content-dropdown-option": Ae `
	<div class="form-fields-item dropdown-option js-dropdown-option js-sortable" data-value="<%=text%>" data-number="<%=number%>">
		<input type="text" name="" value="<%=text%>" placeholder="<%=placeholder%>" autocomplete="off" data-number="<%=number%>"
		       class="dropdown-option-value form-fields-caption js-dropdown-option-value"/>
		<div class="dropdown-number form-fields-type-token"><%=number%></div>
		<% if (showDelete) {  %>
			<div class="dropdown-option-delete form-fields-delete js-delete-option"></div>
		<% }; %>
	</div>
`
    }
});

function Rq(e) {
    let t = /^(.*):\/\/[^\s$.?#].[^\s]*$/i,
        o = /^[\da-z\.-]+\.[a-z-]{2,}.*/i,
        i = /\+(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/i,
        n = /^(back|scroll)\sto\stop$/i,
        s = /^(__rm_goback|go\sback)$/i,
        a = /^(__rm_mailchimp_.*|<script.*mailchimp\.com.*\{.*baseUrl.*uuid.*lid.*\}.*)$/i,
        l = /start\((\{.*\})\).*\}\)/i,
        c = "__rm_mailchimp_",
        d = /^(__rm_anchor|\d+px)$/i,
        p = /^(\d+)px$/i,
        h = /^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i;

    function u(R) {
        let A = R.match(l),
            D;
        try {
            D = A && A[1] && !!JSON.parse(A[1])
        } catch {
            D = !1
        }
        return D ? A[1] : ""
    }
    let m = RM.constructorRouter.mag,
        f = RM.constructorRouter.me;
    e = eo.default.trim(e);
    let g = t.test(e),
        y = new RegExp("/(edit|" + f.get("uri") + ")/(\\d+|" + m.get("uri") + ")/(preview/)?(.*)", "i"),
        S = e.match(y);
    S && (m.get("uri") == S[2] || m.get("num_id") == S[2]) && (e = (S[4] || "1").replace("/", ""));
    let w = e != "" && !!m.getPageId(e);
    e = e.replace(/^mailto\:/i, "");
    let v = OC(e);
    e = e.replace(/^tel\:/i, "");
    let C = i.test(e),
        I = n.test(e),
        T = s.test(e),
        P = a.test(e),
        M = d.test(e),
        F = h.test(e);
    return g || w || v || C || P || F || (g = o.test(e), g && (e = "http://" + e)), P && (e = c + u(e)), M && (e = e.match(p)[1]), {
        result: g || w || v || C || I || T || P || M || F,
        isURL: g,
        isEmail: v,
        isTel: C,
        isValidPageNumber: w,
        isBack: I,
        isGoBack: T,
        isMailchimp: P,
        isAnchor: M,
        isShare: F,
        url: e
    }
}
var eo, F_, lt, r9, Pq, Tq, Jb, s9, Yn, E_, Kb, Bq, Mq, a9, l9 = k(() => {
    "use strict";
    eo = E(Ze()), F_ = E(To()), lt = E(ze());
    Bb();
    Wt();
    n9();
    Nr();
    fv();
    r9 = "Field Text", Pq = {
        text: "Text",
        number: "Number",
        name: "Name",
        email: "Email",
        phone: "Phone number",
        dropdown: "Dropdown",
        dropdownEditMode: "Edit dropdown",
        submit: "Text",
        textAfterSubmit: "Text after submit",
        toUrlAfterSubmit: "URL",
        toPageAfterSubmit: "Jump to page",
        option: "Edit option",
        checkbox: "Checkbox",
        file: "File"
    }, Tq = {
        text: "Text",
        number: "Number",
        name: "Name",
        email: "Email",
        phone: "Phone Number",
        dropdown: "Dropdown",
        checkbox: "Checkbox",
        file: "File"
    }, Jb = function(e, t) {
        return !t || s9(e, t) ? null : t
    }, s9 = function(e, t) {
        let o = t && t.toLowerCase(),
            i = o === Yn(e).toLowerCase();
        return (e === "dropdown" || e === "dropdownEditMode") && (i = o === Yn("dropdown").toLowerCase() || o === Yn("dropdownEditMode").toLowerCase()), i || o === r9.toLowerCase()
    }, Yn = function(e) {
        return Pq[e] || r9
    }, E_ = function(e, t) {
        let o = lt.default.debounce(e, t || 300);
        return function(i) {
            i.keyCode === 13 ? (e(i), (0, eo.default)(i.target).blur()) : o(i)
        }
    }, Kb = is.prototype, Bq = is.extend({
        name: "form_content",
        className: "control form_content",
        events: {
            "click .js-panel": "onPanelClick",
            "click .js-add": "onAddClick",
            "click .js-field-type": "onFieldTypeClick",
            "click .js-submit-field-type": "onSubmitFieldClick",
            "click .js-dropdown-trigger": "onDropdownTriggerClick",
            "click .js-settings-trigger": "onSettingsTriggerClick",
            "click .js-delete-field": "onDeleteFieldClick",
            "keydown .js-field-caption": "onFieldCaptionKeydown",
            "click .js-submit-dropdown-trigger": "onSubmitArrowClick",
            "click .action-icon:not(.remove-icon)": "onActionIconClick",
            "click .remove-icon": "onRemoveIconClick",
            "click .search-wrapper .placeholder-selector .placeholder-item": "clickPlaceholder",
            "focus .form-fields-caption-submitAfter.toPageAfterSubmit ": "changeAfterSubmitToPageInput",
            "focusout .form-fields-caption-submitAfter.toPageAfterSubmit ": "changeAfterSubmitToPageInput",
            "click .form-fields-item .type-switcher": "changeCaptchaType"
        },
        MIN_PANEL_HEIGHT: 350,
        MAX_PANEL_HEIGHT: 504,
        SCROLL_GAP_START: 4,
        SCROLL_GAP_END: 4,
        FIELD_TYPES: Tq,
        SUBMIT_FIELD_TYPES: {
            textAfterSubmit: "Text after submit",
            toUrlAfterSubmit: "Website URL",
            toPageAfterSubmit: "Jump to Page"
        },
        SUBMIT_MODES: {
            textAfterSubmit: "textAfterSubmit",
            toUrlAfterSubmit: "toUrlAfterSubmit",
            toPageAfterSubmit: "toPageAfterSubmit"
        },
        PAGE_AFTER_SUBMIT_SHORT_PLACEHOLDER: "Jump to p.",
        saveOnDestroy: !0,
        saveOnDeselect: !0,
        idMap: {},
        dropdownPanels: {},
        dropdownModels: [],
        initialize: function(e) {
            this.options = {
                canChangeFields: so.isPermissionAllowed("FormCanChangeFields")
            }, this.template = dc["template-constructor-control-form_content"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model, RM.constructorRouter.me.get("permissions").can_use_forms_file_upload || (this.FIELD_TYPES.file = "File (Business plan only)"), lt.default.bindAll(this)
        },
        bindLogic: function() {
            this.listenTo(this.model, "field:add", this.onFieldsChange), this.listenTo(this.model, "field:delete", this.onFieldsChange), this.listenTo(this.model, "field:tp:change", this.onFieldTypeChange), this.listenTo(this.model, "field:caption:change", this.onFieldCaptionChange), this.updateCaptionDebounced = E_(this.updateCaption.bind(this), 300)
        },
        unBindLogic: function() {
            this.stopListening(this.model)
        },
        render: function() {
            Kb.render.apply(this, arguments), this.$content = (0, eo.default)(this.$el.find(".js-fields-container")), this.$settingsPopupContainer = this.$el.find(".js-settings-popup-container"), this.$dropdownPanelContainer = this.$el.find(".js-dropdown-panel-container"), this.$addBlock = this.$el.find(".js-add-block"), this.$scrollable = this.$el.find(".resizable-content-wrapper"), this.$content.sortable({
                items: ".js-sortable",
                distance: 10,
                axis: "y",
                scrollSpeed: 10,
                containment: "parent",
                tolerance: "pointer",
                start: this.onSortStart.bind(this),
                stop: this.onSortEnd.bind(this)
            }), this.renderContent(), this.updatePanelHeight(this.MIN_PANEL_HEIGHT), this.$addBlock.append(this.buildSettingsPopup({
                edit: !1
            })), this.$addSettingsPopup = this.$el.find(".js-add-settings"), this.$submitPopup = this.$el.find(".submit-wrapper"), this.isPageMode() && this.changeAfterSubmitToPageInput()
        },
        select: function() {
            Kb.select.apply(this, arguments), this.resizeToFit()
        },
        renderContent: function() {
            this.$content.empty().append(this.renderFields()), this.refreshSort(), this.resizableScroll && this.resizableScroll.recalc(), this.renderFieldSettingsPopups(), this.$addBlock.append(this.renderSubmitPopup()), this.$dropdownPanelContainer.empty().append(this.renderDropdowns())
        },
        renderFields: function() {
            let e = (0, eo.default)(document.createDocumentFragment());
            this.idMap = {}, lt.default.each(this.model.get("fields"), function(i, n, s) {
                let a = "field-" + be.generateUUID();
                this.idMap[i.sort] = a;
                let l = this.renderField(lt.default.extend({
                    id: a,
                    isOnly: s.length === 1
                }, i));
                e.append(l)
            }.bind(this)), e.append('<div class="button-header">Button</div>');
            let t = this.renderField({
                id: null,
                caption: this.model.get("button-caption"),
                tp: "submit"
            });
            e.append(t);
            let o = this.renderField({
                id: null,
                caption: this.model.get("button_caption_after_submit"),
                tp: "submitAfter"
            });
            return e.append(o), e
        },
        renderField: function(e) {
            let t = dc["template-constructor-control-form_content-field"];
            return t({
                tp: e.tp,
                typeLetter: e.tp === "number" ? "\u2116" : e.tp[0],
                text: Jb(e.tp === "submitAfter" ? this.model.get("submit_mode") : e.tp, e.caption),
                type: e.type,
                sort: e.sort,
                id: e.id,
                placeholder: Yn(e.tp === "submitAfter" ? this.model.get("submit_mode") : e.tp),
                showSettings: e.tp !== "submit" && e.tp !== "submitAfter",
                showDelete: this.options.canChangeFields ? e.tp !== "submit" && !e.isOnly && e.tp !== "submitAfter" : !1,
                isSortable: e.tp !== "submit" && e.tp !== "submitAfter",
                showSubmitAfterArrow: e.tp === "submitAfter",
                mode: e.tp === "submitAfter" ? this.model.get("submit_mode") : "",
                showRemoveArrow: this.model.get("submit_mode") !== this.SUBMIT_MODES.textAfterSubmit && this.model.get("link_after_submit")
            })
        },
        reRenderField: function(e, t) {
            let o = this.model.get("fields"),
                i = this.getPredicate(e),
                n = this.getField(i),
                s = this.$el.find(".js-field[data-id=" + e + "]"),
                a = this.renderField(lt.default.extend({
                    id: e,
                    isOnly: o.length === 1
                }, n));
            s.replaceWith(a), this.refreshSort(), (n.tp === "dropdown" || t === "dropdown") && this.$dropdownPanelContainer.empty().append(this.renderDropdowns())
        },
        buildFieldSettingsPopups: function() {
            let e = (0, eo.default)(document.createDocumentFragment());
            return lt.default.each(this.model.get("fields"), function(t) {
                let o = this.idMap[t.sort],
                    i = this.buildSettingsPopup({
                        showOptionalSwitcher: !0,
                        selectedType: t.tp,
                        edit: !0,
                        optional: t.optional,
                        id: o
                    });
                e.append(i)
            }.bind(this)), e
        },
        buildSettingsPopup: function(e) {
            let t = dc["template-constructor-control-form_content-settings"];
            e = lt.default.extend({
                types: this.FIELD_TYPES,
                showOptionalSwitcher: !1,
                selectedType: null,
                edit: !1,
                id: null,
                sort: null,
                _: lt.default
            }, e), e.disabledTypes = ["file", "captcha"].filter(s => this.isFieldExists(s));
            let o = t(e),
                i = (0, eo.default)(o),
                n = (0, eo.default)(i.find(".switcher"));
            return n.length && n.RMSwitcher({
                state: e.optional,
                height: 26,
                width: 44,
                "color-0": "#0078ff",
                "color-1": "#c9c8c9",
                "text-color-0": "transparent",
                "text-color-1": "transparent",
                id: e.id
            }, this.onSwitcherChange.bind(this)), i
        },
        renderSettingsPopup: function() {
            let e = this.$addBlock.find(".js-add-settings");
            e && e.remove(), this.$addBlock.append(this.buildSettingsPopup({
                edit: !1
            })), this.$addSettingsPopup = this.$el.find(".js-add-settings")
        },
        renderFieldSettingsPopups: function() {
            this.$settingsPopupContainer.empty().append(this.buildFieldSettingsPopups())
        },
        renderSubmitPopup: function(e) {
            let t = dc["template-constructor-control-form_content-after-submit"];
            e = lt.default.extend({
                types: this.SUBMIT_FIELD_TYPES,
                selectedType: this.model.get("submit_mode") || this.SUBMIT_MODES.textAfterSubmit,
                edit: !1,
                id: null,
                sort: null,
                _: lt.default
            }, e);
            let o = t(e);
            return (0, eo.default)(o)
        },
        renderDropdowns: function() {
            let e = (0, eo.default)(document.createDocumentFragment()),
                t = lt.default.where(this.model.get("fields"), {
                    tp: "dropdown"
                });
            return this.destroyDropdowns(), lt.default.each(t, function(o) {
                let i = this.idMap[o.sort],
                    n = this.renderDropdown(o);
                this.dropdownPanels[i] = n, e.append(n.el)
            }.bind(this)), e
        },
        renderDropdown: function(e) {
            let t = new F_.default.Model(lt.default.clone(e));
            this.dropdownModels.push(t), this.listenTo(t, "change:caption", this.onDropdownCaptionChange), this.listenTo(t, "change:items", this.onDropdownItemsChange), this.listenTo(t, "change:height", this.onDropdownHeightChange), this.listenTo(t, "save", this.onDropdownSave);
            let o = new Mq({
                model: t
            });
            return o.render(), o
        },
        onSortStart: function() {
            this.hideSettingsPopups(), this.$el.find(":input").blur(), this.$el.addClass("grabbing")
        },
        onSortEnd: function() {
            this.$el.removeClass("grabbing"), this.reorder(), this.$el.find(".js-field").attr("style", "")
        },
        onScrollRecalc: function() {
            lt.default.each(this.dropdownPanels, function(e) {
                e.resizableScroll && e.resizableScroll.recalc()
            })
        },
        onSwitcherChange: function(e, t) {
            let o = t.settings.id,
                i = this.getPredicate(o);
            this.block.changeField(i, {
                optional: e
            })
        },
        onPanelClick: function(e) {
            (0, eo.default)(e.target).closest(".js-settings-trigger, .js-add, .js-settings-popup, .js-submit-dropdown-trigger").length || this.hideSettingsPopups()
        },
        onAddClick: function() {
            this.toggleSettingsPopup(this.$addSettingsPopup)
        },
        onFieldTypeClick: function(e) {
            e.stopPropagation();
            let t = (0, eo.default)(e.target).closest(".js-field-type"),
                o = t.data("value"),
                i = t.data("action");
            if (!((o === "file" || o === "captcha") && this.isFieldExists(o))) {
                if (i === "add") this.addField({
                    tp: o
                }), this.hideSettingsPopups(), this.scrollToBottom(), this.isPageMode() && this.changeAfterSubmitToPageInput();
                else {
                    let n = this.getPredicate(e.target);
                    this.changeFieldType(n, o)
                }
                this.renderSettingsPopup(), this.renderFieldSettingsPopups()
            }
        },
        onSubmitFieldClick: function(e) {
            e.stopPropagation();
            let t = (0, eo.default)(event.target).data("value");
            t !== this.model.get("submit_mode") && (this.setAfterSubmitMode(t), this.reRenderAfterSubmit(t)), this.hideSettingsPopups()
        },
        isFieldExists: function(e) {
            let t = this.model.get("fields");
            return lt.default.find(t, o => o.tp === e)
        },
        isPageMode: function() {
            return this.model.get("submit_mode") && this.model.get("submit_mode") === this.SUBMIT_MODES.toPageAfterSubmit
        },
        reRenderAfterSubmit: function(e) {
            let t = this.$el.find(".form-fields-item-submitAfter"),
                o = {
                    tp: "submitAfter",
                    selectedType: e
                },
                i = this.renderField(lt.default.extend(o));
            this.$el.find(".js-submit-field-type").removeClass("selected"), this.$el.find(".js-submit-field-type[data-value=" + e + "]").addClass("selected"), t.replaceWith(i)
        },
        changeAfterSubmitToPageInput: function(e) {
            let t = e ? (0, eo.default)(e.currentTarget) : this.$el.find(".js-field-caption-submitAfter"),
                o = t.val(),
                i = this.PAGE_AFTER_SUBMIT_SHORT_PLACEHOLDER,
                n = o.indexOf(i) !== -1 ? eo.default.trim(o.replace(i, "")) : o;
            o.indexOf(i) === -1 && this.getUrlData(n).result ? t.val(i + " " + o) : t.val(n)
        },
        getUrlData: function(e) {
            let t = this.model.get("submit_mode"),
                o = RM.constructorRouter.mag,
                i = Rq(e);
            return e = i.url, i.isValidPageNumber && (e = o.getPageId(e)), {
                result: i.isURL && t === this.SUBMIT_MODES.toUrlAfterSubmit || i.isValidPageNumber && this.isPageMode(),
                url: e
            }
        },
        setAfterSubmitMode: function(e) {
            this.model.set("submit_mode", e)
        },
        onDropdownTriggerClick: function(e) {
            let t = (0, eo.default)(e.target).closest("[data-id]").data("id"),
                o = this.dropdownPanels[t];
            this.hideSettingsPopups(), o && o.show()
        },
        onSettingsTriggerClick: function(e) {
            let t = (0, eo.default)(e.target),
                o = t.closest("[data-id]").data("id"),
                i = this.$el.find(".js-settings-popup[data-id=" + o + "]"),
                n = t.offset().top - this.$scrollable.offset().top + t.height() / 2,
                s = this.$scrollable.height() - n;
            this.toggleSettingsPopup(i, {
                bottom: s
            })
        },
        onDeleteFieldClick: function(e) {
            let t = this.getPredicate(e.target);
            this.deleteField(t), this.renderSettingsPopup(), this.isPageMode() && this.changeAfterSubmitToPageInput()
        },
        onFieldCaptionKeydown: function(e) {
            this.updateCaptionDebounced(e);
            let t = this.$el.find(".form-fields-placeholder-selector");
            e && e.currentTarget && (0, eo.default)(e.currentTarget).hasClass("toPageAfterSubmit") && t.hasClass("action-icon") && e.keyCode === 13 && this.onActionIconClick()
        },
        updateCaption: function(e) {
            let t = (0, eo.default)(e.target),
                o = this.getPredicate(t),
                n = t.closest(".js-field").data("type"),
                s = this.model.get("submit_mode"),
                a = t.val();
            if (n === "submit") this.changeButton(a || Yn("submit"));
            else if (n === "submitAfter") this.changeButtonAfterSubmit(a || ""), s !== this.SUBMIT_MODES.textAfterSubmit && this.updateClasses(a), (this.isPageMode() || s === this.SUBMIT_MODES.toUrlAfterSubmit) && !this.getUrlData(a).result && (this.changeButtonAfterSubmit(""), this.model.set("link_after_submit", ""));
            else {
                let l = this.getField(o);
                a = a || Yn(l.tp), this.block.changeField(o, {
                    caption: a
                })
            }
        },
        updateClasses: function(e) {
            let t = this.$el.find(".form-fields-placeholder-selector");
            t.hasClass("remove-icon") && t.removeClass("remove-icon"), t.toggleClass("js-submit-dropdown-trigger", !this.getUrlData(e).result), t.toggleClass("action-icon", this.getUrlData(e).result)
        },
        onActionIconClick: function() {
            let e = this.$el.find(".form-fields-placeholder-selector"),
                t = this.model.get("button_caption_after_submit");
            e.addClass("remove-icon"), this.model.set("link_after_submit", this.getUrlData(t).url)
        },
        onRemoveIconClick: function() {
            let e = this.$el.find(".form-fields-placeholder-selector"),
                t = this.$el.find(".form-fields-caption-submitAfter");
            e.removeClass("action-icon remove-icon").addClass("js-submit-dropdown-trigger"), t.val(""), this.changeButtonAfterSubmit(""), this.model.set("link_after_submit", "")
        },
        onFieldsChange: function() {
            this.renderContent()
        },
        onFieldTypeChange: function(e, t) {
            let o = this.idMap[e.sort],
                i = this.$el.find(".js-settings-popup[data-id=" + o + "]");
            i.find(".js-field-type").removeClass("selected"), i.find(".js-field-type[data-value=" + e.tp + "]").addClass("selected"), this.reRenderField(o, t)
        },
        onFieldCaptionChange: function(e) {
            if (e.tp === "dropdown") {
                let t = this.idMap[e.sort];
                this.$el.find(".js-field[data-id=" + t + "]").find(".js-field-caption").val(Jb(e.tp, e.caption))
            }
        },
        onDropdownItemsChange: function(e, t) {
            this.block.changeField({
                sort: e.get("sort")
            }, {
                items: lt.default.clone(t)
            })
        },
        onDropdownHeightChange: function(e) {
            (e > 0 || e < 0 && this.getContentOverflow(e) <= 0) && this.updatePanelHeight(this.$panel.height() + e)
        },
        onDropdownCaptionChange: function(e, t) {
            this.block.changeField({
                sort: e.get("sort")
            }, {
                caption: t || Yn("dropdown")
            })
        },
        onDropdownSave: function(e) {
            let t = {
                caption: e.caption,
                items: lt.default.clone(e.items)
            };
            this.block.changeField({
                sort: e.sort
            }, t), this.save()
        },
        onPanelScroll: function() {
            this.hideSettingsPopups()
        },
        toggleSettingsPopup: function(e, t) {
            e.is(".shown") ? this.hideSettingsPopup(e) : this.showSettingsPopup(e, t)
        },
        showSettingsPopup: function(e, t) {
            this.hideSettingsPopups(), lt.default.isUndefined(t) || (e.css(t), e.removeClass("below"), e[0].getBoundingClientRect().top < 0 && e.addClass("below")), e.addClass("shown")
        },
        hideSettingsPopup: function(e) {
            e.removeClass("shown")
        },
        hideSettingsPopups: function() {
            this.hideSettingsPopup(this.$el.find(".js-settings-popup"))
        },
        hasSettingsPopupsOpen: function() {
            return !!this.$el.find(".js-settings-popup.shown").length
        },
        onSubmitArrowClick: function(e) {
            let t = (0, eo.default)(e.target),
                o = t.offset().top - this.$scrollable.offset().top + 1.5 * t.height(),
                i = this.$scrollable.height() - o;
            this.toggleSettingsPopup(this.$submitPopup, {
                bottom: i
            })
        },
        hideDropdownPanels: function() {
            lt.default.each(this.dropdownPanels, function(e) {
                e.hide()
            })
        },
        hasDropdownPanelsOpen: function() {
            return !!lt.default.find(this.dropdownPanels, function(e) {
                return e.isShown()
            })
        },
        getPredicate: function(e) {
            let t = lt.default.isString(e) ? e : (0, eo.default)(e).closest("[data-id]").data("id"),
                o = lt.default.invert(this.idMap)[t];
            return {
                sort: o && parseInt(o)
            }
        },
        changeCaptchaType: function(e) {
            let t = (0, eo.default)(e.target),
                o = this.getPredicate(t);
            this.changeField(o, {
                type: t.data("type")
            }), t.parent().attr("data-type", t.data("type"))
        },
        addField: function(e) {
            let t = lt.default.clone(this.model.get("fields")),
                o = lt.default.max(t, "sort").sort || 0,
                i = {
                    tp: e.tp,
                    caption: Yn(e.tp),
                    optional: !1,
                    sort: o + 1
                };
            i.tp === "dropdown" && (i.items = this.getDefaultDropdownItems()), i.tp === "captcha" && (i.type = "light"), t.push(i), this.model.set("fields", t), this.model.trigger("field:add", i), lt.default.defer(function() {
                this.block.trigger("resize")
            }.bind(this))
        },
        changeField: function(e, t) {
            let o = lt.default.clone(this.model.get("fields")),
                i = lt.default.findIndex(o, e),
                n = o[i],
                s = {};
            lt.default.each(t, function(a, l) {
                s[l] = lt.default.clone(n[l])
            }), n = lt.default.extend(lt.default.clone(n), t), n.items === null && delete n.items, o[i] = n, this.model.set("fields", o), lt.default.each(t, function(a, l) {
                this.model.trigger("field:" + l + ":change", n, s[l])
            }.bind(this)), this.model.trigger("field:change", n)
        },
        changeFieldType: function(e, t) {
            let o = this.getField(e);
            if (o && o.tp !== t) {
                let i = {
                    tp: t
                };
                s9(o.tp, o.caption) && (i.caption = Yn(t)), t === "captcha" ? i.type = "light" : o.tp === "captcha" && (i.type = null), t === "dropdown" ? i.items = this.getDefaultDropdownItems() : o.tp === "dropdown" && (i.items = null), this.block.changeField(e, i)
            }
        },
        getField: function(e) {
            let t = lt.default.find(this.model.get("fields"), e);
            return t && lt.default.clone(t)
        },
        getDefaultDropdownItems: function() {
            return [Yn("option"), Yn("option")]
        },
        changeButton: function(e) {
            this.model.set("button-caption", e)
        },
        changeButtonAfterSubmit: function(e) {
            this.model.set("button_caption_after_submit", e)
        },
        deleteField: function(e) {
            let t = this.model.get("fields");
            t.length > 1 && (t = lt.default.reject(t, e), this.model.set("fields", t), this.model.trigger("field:delete", e))
        },
        reorder: function() {
            let e = [],
                t = {};
            lt.default.each(this.$content.find(".js-sortable"), function(o, i) {
                let n = this.getPredicate(o),
                    s = this.getField(n);
                t[i] = this.idMap[s.sort], s.sort = i, e.push(s)
            }.bind(this)), this.model.set("fields", e), this.idMap = t, this.$dropdownPanelContainer.empty().append(this.renderDropdowns()), this.model.trigger("fields:reorder")
        },
        refreshSort: function() {
            (0, eo.default)(this.$content).sortable("refresh")
        },
        scrollToBottom: function() {
            this.$scrollable.animate({
                scrollTop: this.$content.height() - this.$scrollable.height()
            })
        },
        getContentOverflow: function(e) {
            return this.$content.height() - (this.$content.parent().height() + (e || 0))
        },
        resizeToFit: function() {
            let e = [];
            e.push(this.getContentOverflow()), lt.default.each(this.dropdownPanels, function(o) {
                e.push(o.getContentOverflow())
            });
            let t = Math.max.apply(null, e);
            this.updatePanelHeight(this.$panel.height() + t)
        },
        canControlBeClosed: function() {
            return this.hasSettingsPopupsOpen() ? (this.hideSettingsPopups(), !0) : Kb.canControlBeClosed.apply(this, arguments)
        },
        save: function() {
            this.model.save({})
        },
        destroyDropdowns: function() {
            lt.default.each(this.dropdownPanels, function(e) {
                e.destroy()
            }), this.dropdownPanels = {}, lt.default.each(this.dropdownModels, function(e) {
                this.stopListening(e)
            }.bind(this)), this.dropdownModels = []
        },
        destroy: function() {
            this.destroyDropdowns(), Kb.destroy.apply(this, arguments)
        }
    }), Mq = F_.default.View.extend({
        SCROLL_GAP_START: 4,
        SCROLL_GAP_END: 4,
        originalState: null,
        events: {
            "click .js-add-option": "onAddOptionClick",
            "click .js-delete-option": "onDeleteOptionClick",
            "click .js-cancel-dropdown": "onCancelDropdownClick",
            "click .js-save-dropdown": "onSaveDropdownClick",
            "keydown .js-dropdown-caption": "onCaptionKeydown",
            "keydown .js-dropdown-option-value": "onOptionKeydown"
        },
        initialize: function(e) {
            this.model = e.model, this.template = dc["template-constructor-control-form_content-dropdown"]
        },
        rememberState: function() {
            let e = this.model.attributes;
            this.originalState = JSON.parse(JSON.stringify(e))
        },
        render: function() {
            let e = this.template();
            return this.setElement(e), this.$scrollable = this.$el.find(".resizable-content-wrapper"), this.$content = this.$el.find(".js-dropdown-content"), this.$captionContainer = this.$el.find(".js-dropdown-caption-container"), this.$optionsContainer = (0, eo.default)(this.$el.find(".js-dropdown-options-container")), this.resizableScroll = (0, eo.default)(this.$el.find(".resizable-scroll-wrapper")).RMScroll({
                $container: this.$el.find(".resizable-content-wrapper"),
                $content: this.$el.find(".resizable-content"),
                $handle: this.$el.find(".resizable-scroll"),
                wheelScrollSpeed: .4,
                gap_start: this.SCROLL_GAP_START,
                gap_end: this.SCROLL_GAP_END
            }).data("scroll"), this.$optionsContainer.sortable({
                items: ".js-sortable",
                distance: 10,
                axis: "y",
                scrollSpeed: 10,
                containment: "parent",
                tolerance: "pointer",
                start: this.onSortStart.bind(this),
                stop: this.onSortEnd.bind(this)
            }), this.renderContent(), this.bindLogic(), this
        },
        renderContent: function() {
            this.$captionContainer.empty().append(this.renderCaption()), this.$optionsContainer.empty().append(this.renderDropdownOptions()), this.refreshSort(), this.resizableScroll && this.resizableScroll.recalc()
        },
        renderCaption: function() {
            let e = dc["template-constructor-control-form_content-dropdown-caption"],
                t = this.model.get("caption");
            return e({
                text: Jb("dropdownEditMode", t),
                placeholder: Yn("dropdownEditMode")
            })
        },
        renderDropdownOptions: function() {
            let e = (0, eo.default)(document.createDocumentFragment()),
                t = dc["template-constructor-control-form_content-dropdown-option"];
            return lt.default.each(this.model.get("items"), function(o, i, n) {
                let s = t({
                    text: Jb("option", o),
                    number: i + 1,
                    placeholder: Yn("option"),
                    showDelete: n.length > 1
                });
                e.append(s)
            }.bind(this)), e
        },
        bindLogic: function() {
            this.listenTo(this.model, "item:add", this.onModelChange), this.listenTo(this.model, "item:delete", this.onModelChange), this.listenTo(this.model, "revert", this.onModelChange), this.listenTo(this.model, "reorder", this.onModelChange), this.updateCaptionDebounced = E_(this.updateCaption.bind(this), 300), this.updateOptionDebounced = E_(this.updateOption.bind(this), 300)
        },
        unbindLogic: function() {
            this.stopListening(this.model)
        },
        refreshSort: function() {
            (0, eo.default)(this.$optionsContainer).sortable("refresh")
        },
        onSortStart: function() {
            this.$el.find(":input").blur(), this.$el.addClass("grabbing")
        },
        onSortEnd: function() {
            this.$el.removeClass("grabbing"), this.reorder(), this.$el.find(".js-dropdown-option").attr("style", "")
        },
        onAddOptionClick: function() {
            this.addOption(), this.$el.find(".js-dropdown-option-value:last").focus();
            let e = this.getContentOverflow();
            e > 0 && this.model.trigger("change:height", e), this.scrollToBottom()
        },
        onDeleteOptionClick: function(e) {
            let t = (0, eo.default)(e.target).closest("[data-number]").data("number"),
                o = t ? parseInt(t) - 1 : -1;
            this.deleteOption(o)
        },
        onCancelDropdownClick: function() {
            this.revert(), this.hide()
        },
        onSaveDropdownClick: function() {
            this.save(), this.hide()
        },
        onCaptionKeydown: function(e) {
            this.updateCaptionDebounced(e)
        },
        onOptionKeydown: function(e) {
            this.updateOptionDebounced(e)
        },
        updateCaption: function(e) {
            let o = (0, eo.default)(e.target).val() || Yn("dropdown");
            this.model.set("caption", o)
        },
        updateOption: function(e) {
            let t = (0, eo.default)(e.target),
                o = t.val(),
                i = parseInt(t.data("number")) - 1,
                n = lt.default.clone(this.model.get("items"));
            n[i] = o || Yn("option"), this.model.set("items", n)
        },
        onModelChange: function() {
            this.renderContent()
        },
        addOption: function() {
            let e = lt.default.clone(this.model.get("items")),
                t = Yn("option");
            e.push(t), this.model.set("items", e), this.model.trigger("item:add", t)
        },
        deleteOption: function(e) {
            let t = lt.default.clone(this.model.get("items"));
            t.splice(e, 1), this.model.set("items", t), this.model.trigger("item:delete", e)
        },
        reorder: function() {
            let e = [],
                t = this.model.get("items");
            lt.default.each(this.$optionsContainer.find(".js-sortable"), function(o) {
                let i = parseInt((0, eo.default)(o).data("number")),
                    n = t[i - 1];
                e.push(n)
            }), this.model.set("items", e), this.model.trigger("reorder")
        },
        scrollToBottom: function() {
            this.$scrollable.animate({
                scrollTop: this.$content.height() - this.$scrollable.height()
            })
        },
        getContentOverflow: function(e) {
            return this.$content.height() - (this.$content.parent().height() + (e || 0))
        },
        isShown: function() {
            return this.$el.is(".shown")
        },
        show: function() {
            this.$el.addClass("shown"), this.rememberState()
        },
        hide: function() {
            this.$el.removeClass("shown")
        },
        save: function() {
            this.model.trigger("save", this.model.attributes)
        },
        revert: function() {
            this.model.set("caption", this.originalState.caption), this.model.set("items", lt.default.clone(this.originalState.items)), this.model.trigger("revert")
        },
        destroy: function() {
            this.unbindLogic()
        }
    }), a9 = Bq
});
var c9, d9 = k(() => {
    "use strict";
    no();
    c9 = {
        "template-constructor-control-form_captcha": Ae `
	<div class="icon noarrow" data-alt="Turn on captcha" data-alt-pos="left" data-alt-offset="9"></div>
`
    }
});
var hm, Eq, p9, u9 = k(() => {
    "use strict";
    hm = E(ze());
    $n();
    d9();
    Eq = it.extend({
        name: "form_captcha",
        className: "control form_captcha",
        rolePermission: "FormCanChangeCaptcha",
        initialize: function(e) {
            this.template = c9["template-constructor-control-form_captcha"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model
        },
        render: function() {
            it.prototype.render.apply(this, arguments), this.updateState()
        },
        bindLogic: function() {
            hm.default.each(this.models, function(e) {
                this.listenTo(e, "change:captcha", this.onCaptchaChange)
            }.bind(this))
        },
        unBindLogic: function() {
            hm.default.each(this.models, function(e) {
                this.stopListening(e, "change:captcha")
            }.bind(this))
        },
        onClick: function() {
            if (this.isOnClickDisabled()) return;
            let e = !this.models[0].get("captcha"),
                t = hm.default.map(this.models, function(o) {
                    return {
                        _id: o.id,
                        captcha: e
                    }
                });
            this.master.workspace.save_group(t)
        },
        onCaptchaChange: function() {
            this.updateState()
        },
        updateState: function() {
            let e = hm.default.any(this.models, function(t) {
                return t.get("captcha")
            });
            this.$el.toggleClass("checked", e), this.$(".icon").attr("data-alt", e ? "Turn off captcha" : "Turn on captcha")
        }
    }), p9 = Eq
});
var D_, h9 = k(() => {
    "use strict";
    no();
    D_ = {
        "template-constructor-control-form_endpoints": Ae `
   <div class="icon noarrow" aria-label="Form endpoints" data-alt="Send Data" data-alt-pos="left" data-alt-offset="9"></div>

   <div class="panel">
   	<div class="panel-caption">
   		<span>Send Data</span>
   		<div class="inline-help">
   			<div class="help-body-wrapper">
   				<div class="help-body">
   					<span class="help-text">Manage data storage.<br/><a href="http://help.readymag.com/hc/en-us/articles/360020793111-Form" target="_blank">Learn more</a></span>
   					<div class="help-popup-corner">
   						<div class="corner"></div>
   					</div>
   				</div>
   				<div class="hover-spacer"></div>
   			</div>
   		</div>
   	</div>

   	<div class="panel-section email collapsed">
   		<div class="switcher-wrapper">
   			<div class="switcher-caption">1st email</div>
   			<div class="switcher email provider" data-provider="email"></div>
   		</div>

   		<div class="collapsable">
   			<div class="current-email overflow-fade">NO-VAL</div>
   		</div>
   	</div>

   	<div class="separator email"></div>

   	<div class="panel-section second_email collapsed">

   		<div class="switcher-wrapper">
   			<div class="switcher-caption">2nd email</div>
   			<div class="switcher second_email provider" data-provider="second_email"></div>
   		</div>

   		<div class="collapsable">
   			<p class="confirmation hidden">
   				Check<span class="confirmation email-for-confirmation">NO-VAL</span>for confirmation
   			</p>
   			<div class="input-wrapper second_email">
   				<input type="email" class="reach-input input-second-email" placeholder="Add email" data-provider="second_email" spellcheck="false">
   				<div class="action-icon hidden"></div>
   			</div>
   			<p class="confirmation resend hidden">Resend confirmation</p>
   			<p class="confirmation cancel hidden">Cancel request</p>
   			<div class="error-block hidden">
   				<p class="error red">
   					Email address <br/>
   					<span class="error email-for-confirmation">NO-VAL</span>seems not active.
   				</p>
   				<p class="error try-another">Try another address</p>
   			</div>
   			<p class="new-email hidden overflow-fade">NO-VAL</p>
   			<div class="choice-email hidden">
   				<label class="custom-select">
   					<select class="overflow-fade">

   					</select>
   				</label>
   			</div>
   			<p class="change-email hidden">Change email</p>
   			<p class="back hidden">Back</p>
   		</div>
   	</div>

   	<div class="separator second_email"></div>

   	<div class="panel-section google collapsed">
   		<div class="switcher-wrapper disconnected">
   			<div class="switcher-caption">Google Sheets</div>
   			<div class="switcher google provider" data-provider="google"></div>
   			<div class="connect-button" data-provider="google"></div>
   		</div>

   		<div class="collapsable">
   			<div class="input-wrapper sheet-name">
   				<input type="text" class="reach-input input-sheet-name" placeholder="Name a new Sheet" data-provider="google">
   				<div class="action-icon hidden"></div>
   			</div>
   		</div>
   	</div>

   	<div class="separator google"></div>

   	<div class="panel-section mailchimp collapsed">
   		<div class="switcher-wrapper disconnected">
   			<div class="switcher-caption">MailChimp</div>
   			<div class="switcher mailchimp provider" data-provider="mailchimp"></div>
   			<div class="connect-button" data-provider="mailchimp"></div>
   			<div class="switcher-overlay">
   				<div class="help-body-wrapper">
   					<div class="help-body">
   						<span class="help-text">You should have an Email field<br>to send data to Mailchimp<br><a href="http://help.readymag.com/hc/en-us/articles/360020793111-Form" target="_blank">Learn more</a></span>
   						<div class="help-popup-corner">
   							<div class="corner"></div>
   						</div>
   					</div>
   					<div class="hover-spacer"></div>
   				</div>
   			</div>
   		</div>

   		<div class="collapsable">
   			<div class="input-wrapper list-name">
   				<input type="text" class="input-list-name" placeholder="Select Audience" disabled>
   				<select name="list-select" class="list-select"></select>
   				<div class="list-triangle"></div>
   				<div class="action-icon hidden"></div>
   			</div>
   		</div>
   	</div>

   	<div class="separator mailchimp"></div>

   	<div class="panel-section url collapsed">
   		<div class="switcher-wrapper">
   			<div class="switcher-caption">Webhook URL</div>
   			<div class="switcher url provider" data-provider="url"></div>
   		</div>

   		<div class="collapsable">
   			<div class="input-wrapper url">
   				<input type="text" class="reach-input input-custom-url" placeholder="Enter Webhook" data-provider="url">
   				<div class="action-icon hidden"></div>
   			</div>
   		</div>
   </div>

  <div class="separator file-data"></div>

   	<div class="panel-caption">
   		<span>File Storage</span>
   		<div class="inline-help">
   			<div class="help-body-wrapper">
   				<div class="help-body">
   					<span class="help-text">Manage file storage.<br/><a href="http://help.readymag.com/hc/en-us/articles/360020793111-Form" target="_blank">Learn more</a></span>
   					<div class="help-popup-corner">
   						<div class="corner"></div>
   					</div>
   				</div>
   				<div class="hover-spacer"></div>
   			</div>
   		</div>
  </div>

  <div class="separator email-storage"></div>

    <div class="panel-section email-storage collapsed">
        <div class="switcher-wrapper">
            <div class="switcher-caption">Email</div>
            <div class="switcher email-storage storage" data-provider="email-storage"></div>
        </div>
 </div>

  <div class="separator dropbox"></div>

   	<div class="panel-section dropbox collapsed">
   		<div class="switcher-wrapper disconnected">
   			<div class="switcher-caption">Dropbox</div>
   			<div class="switcher dropbox storage" data-provider="dropbox"></div>
   			<div class="connect-button" data-provider="dropbox"></div>
   		</div>
   		<div class="collapsable">
   			<div class="input-wrapper dropbox-folder-name">
   				<input type="text" class="reach-input input-dropbox-folder-name" placeholder="Folder" data-provider="dropbox">
   				<div class="action-icon hidden"></div>
   			</div>
   		</div>
   </div>

  	<div class="separator googledrive"></div>

   	<div class="panel-section googledrive collapsed">
   		<div class="switcher-wrapper disconnected">
   			<div class="switcher-caption">Google Drive</div>
   			<div class="switcher googledrive storage" data-provider="googledrive"></div>
   			<div class="connect-button" data-provider="googledrive"></div>
   		</div>
   		<div class="collapsable">
   			<div class="input-wrapper googledrive-folder-name">
   				<input type="text" class="reach-input input-googledrive-folder-name" placeholder="Folder" data-provider="googledrive">
   				<div class="action-icon hidden"></div>
   			</div>
   		</div>
   	</div>

   </div>
`,
        "template-constructor-control-form_endpoints-list-selector": Ae `
  <option value="none" disabled selected hidden></option>
  <% _.each(lists, function (l) { %>
  	<option value="<%= l.id %>" <%= l.id == selected ? 'selected' : '' %>><%= l.name %></option>
  <% }) %>
`
    }
});
var go, sn, A_, Fq, m9, f9 = k(() => {
    "use strict";
    go = E(Ze()), sn = E(ze());
    $n();
    Mt();
    h9();
    Nr();
    A_ = it.prototype, Fq = it.extend({
        name: "form_endpoints",
        className: "control form_endpoints",
        events: {
            "click .connect-button:not(.disabled)": "onConnectButtonClick",
            "click .action-icon": "onActionIconClick",
            "input .reach-input": "onReachInputChange",
            "change .list-select": "onListSelectChange",
            "click .try-another": "tryAnotherClick",
            "click .change-email": "changeEmailClick",
            "click .cancel": "cancelRequestClick",
            "click .resend": "resendCodeClick",
            "click .back": "backClick",
            "change .choice-email": "onEmailsSelectChange"
        },
        saveOnDeselect: !0,
        saveOnDestroy: !0,
        GOOGLE_DEFAULT_SHEET_NAME: "New Form",
        FILES_DEFAULT_FOLDER_NAME: "Folder",
        initialize: function(e) {
            this.template = D_["template-constructor-control-form_endpoints"], this.listOptionsTemplate = D_["template-constructor-control-form_endpoints-list-selector"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model, this.switchers = {}
        },
        render: function() {
            let e = [],
                t = RM.constructorRouter.me.get("additionalEmails");
            t && t.length > 0 && (t.forEach(function(c) {
                c.confirmed === !0 && e.push(c)
            }), this.model.set("endpoint_additonal_emails", e)), A_.render.apply(this, arguments), this.createSwitchers(), this.$confirmationView = this.$(".panel-section.second_email .confirmation"), this.$emailNew = this.$(".panel-section.second_email .new-email"), this.$inputWrapper = this.$(".panel-section.second_email .input-wrapper"), this.$selectWrapper = this.$(".panel-section.second_email .choice-email"), this.$changeEmail = this.$(".panel-section.second_email .change-email"), this.$(".current-email").text(RM.constructorRouter.me.get("email"));
            let o = this.$(".input-sheet-name"),
                i = this.getEndpointParam("google", "sheet_name");
            i && (o.val(i), this.setReachInputIcon(o, "remove-icon"));
            let n = this.$(".input-custom-url"),
                s = this.getEndpointParam("url", "custom_url") || "";
            n.val(s), this.setReachInputIcon(n, s ? "remove-icon" : "hidden");
            let a = this.$(".input-dropbox-folder-name");
            this.dropboxFolderName = this.getEndpointParam("dropbox", "folder_name") || (RM.constructorRouter.mag.get("title") ? RM.constructorRouter.mag.get("title") : this.FILES_DEFAULT_FOLDER_NAME), a.val(this.dropboxFolderName), this.setReachInputIcon(a, "remove-icon");
            let l = this.$(".input-googledrive-folder-name");
            this.googledriveFolderName = this.getEndpointParam("googledrive", "folder_name") || (RM.constructorRouter.mag.get("title") ? RM.constructorRouter.mag.get("title") : this.FILES_DEFAULT_FOLDER_NAME), l.val(this.googledriveFolderName), this.setReachInputIcon(l, "remove-icon"), this.$panel = this.$(".panel"), (!window.RM.constructorRouter.isOwner || so.getCurrentRole() === "editor") && this.$el.addClass("disabled no-hover"), this.setEmailsView(), (0, go.default)(window).on("resize", this.updateSwitchers)
        },
        renderListOptions: function(e, t) {
            this.$(".list-select").html(this.listOptionsTemplate({
                lists: e,
                selected: t,
                _: sn.default
            }))
        },
        setEndpointParam: function(e, t, o, i) {
            let n = "endpoint_" + e,
                s = this.model.get(n) || {},
                a = {},
                l;
            if (e === "google" && t === "sheet_name" && o !== s.sheet_name && delete s.sheet_id, a[t] = o, e === "additonal_emails") {
                l = sn.default.isEmpty(s) ? [] : s, l.push(a), this.model.set(n, l);
                return
            }
            this.model.set(n, sn.default.extend({}, s, a), i)
        },
        getEndpointParam: function(e, t) {
            let o = "endpoint_" + e;
            return (this.model.get(o) || {})[t]
        },
        onReachInputChange: function(e) {
            let t = e instanceof go.default ? e : (0, go.default)(e.currentTarget),
                o = t.val().trim();
            this.setReachInputIcon(t, o && this.validateInput(t) ? "apply-icon" : "hidden")
        },
        validateInput: function(e) {
            let t = e.val().trim(),
                o = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,
                i = e.attr("data-provider");
            return i === "url" ? /http(s?):\/\/.+/i.test(t) : i === "second_email" ? o.test(t) : i === "confirmation-code" ? t.length === 4 && !isNaN(t) : !0
        },
        setReachInputIcon: function(e, t) {
            let o = e.closest(".input-wrapper"),
                i = o.find(".action-icon"),
                n = ["apply-icon", "remove-icon", "preloader-icon", "hidden"];
            i.removeClass(n.join(" ")).addClass(t)
        },
        checkPanelPosition: function(e) {
            if (!(0, go.default)(".control.form_endpoints").hasClass("checked")) return;
            let t = (0, go.default)(".panel." + e).outerHeight();
            (0, go.default)(window).height() <= 768 && t >= 450 && (0, go.default)(".panel").css({
                top: -Math.round(t / 2.3)
            }), t < 450 && (0, go.default)(".panel").css({
                top: -149
            })
        },
        createSwitchers: function() {
            let e = this.$(".switcher"),
                t = ["google", "mailchimp", "dropbox"];
            sn.default.each(e, function(o) {
                let i = (0, go.default)(o),
                    n = i.attr("data-provider");
                this.switchers[n] = i.RMSwitcher({
                    state: !1,
                    height: 26,
                    width: 44,
                    "color-0": "#0078ff",
                    "color-1": "#c9c8c9",
                    "text-color-0": "transparent",
                    "text-color-1": "transparent"
                }, this.getSwitcherHandler(n)).data("switcher"), sn.default.contains(t, n) && this.checkAccountConnected(n)
            }.bind(this)), this.updateState()
        },
        getSwitcherHandler: function(e) {
            return function(t) {
                sn.default.delay(function() {
                    this.setEndpointParam(e, "enabled", t)
                }.bind(this), 300)
            }.bind(this)
        },
        checkAccountConnected: function(e) {
            let t = this.$(".connect-button[data-provider=" + e + "]");
            t.addClass("disabled"), this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/connect/forms/" + e + "/check",
                method: "GET",
                success: function(o) {
                    this.onSuccessfulConnect(e, o)
                }.bind(this),
                error: function() {
                    this.switchers[e] && this.switchers[e].setState(!1), e === "google" && this.switchers.googledrive && this.switchers.googledrive.setState(!1)
                }.bind(this),
                complete: function() {
                    t.removeClass("disabled")
                }.bind(this)
            })
        },
        onSuccessfulConnect: function(e, t = {}) {
            if (this.$(".connect-button[data-provider=" + e + "]").closest(".switcher-wrapper").removeClass("disconnected"), e === "mailchimp" && t.accessToken && this.updateMailchimpList(t), e === "google" && t.scopes && t.scopes.includes("https://www.googleapis.com/auth/drive.file")) {
                let i = this.$(".connect-button[data-provider=googledrive]");
                i && i.closest(".switcher-wrapper").removeClass("disconnected")
            }
        },
        updateMailchimpList: function() {
            let e = this.$(".input-list-name"),
                t = this.$(".list-select");
            this.setReachInputIcon(e, "preloader-icon"), t.prop("disabled", !0), this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/connect/forms/mailchimp/lists",
                method: "GET",
                success: function(o) {
                    o = o || {};
                    let i = o.lists || [];
                    if (!i.length) {
                        e.val("No lists");
                        return
                    }
                    let n = this.getEndpointParam("mailchimp", "list_id");
                    this.renderListOptions(i, n), this.onListSelectChange(), t.prop("disabled", !1)
                }.bind(this),
                error: function(o) {
                    console.log("xhr : ", o)
                }.bind(this),
                complete: function() {
                    this.setReachInputIcon(e, "hidden")
                }.bind(this)
            })
        },
        onListSelectChange: function() {
            let e = this.$(".list-select"),
                t = e.val(),
                o = e.find("option:selected");
            t || (t = this.getEndpointParam("mailchimp", "list_id"), o = e.find("option[value='" + t + "']")), o.length && (this.$(".input-list-name").val(o.text()), this.setEndpointParam("mailchimp", "list_id", o.val()))
        },
        processWindowMessage: function(e) {
            let t;
            if (e = e.originalEvent || {}, e.origin === de.readymag_auth_host) {
                try {
                    t = JSON.parse(decodeURIComponent(e.data))
                } catch {
                    console.log("Error parsing uri data")
                }
                t && t.event === "social-auth" && ((0, go.default)(window).off("message", this.processWindowMessage), this.AuthWindow && this.AuthWindow.close(), this.AuthWindow = null, this.handleAuthResult(t.message))
            }
        },
        startOauth: function(e) {
            this.AuthWindow && this.AuthWindow.close(), this.requestedProvider = e, (0, go.default)(window).on("message", this.processWindowMessage);
            let t = screen.width,
                o = screen.height,
                i = Math.min(1e3, t),
                n = Math.min(700, o - 40),
                s = Math.ceil((t - i) / 2),
                a = Math.ceil((o - n) / 2);
            this.AuthWindow = window.open("/api/connect/forms/" + e + "/connect", "_blank", ["toolbar=no", "location=" + (window.opera ? "no" : "yes"), "directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no", "width=" + i, "height=" + n, "top=" + a, "left=" + s].join())
        },
        handleAuthResult: function(e = {}) {
            let t = (e.data || {}).provider;
            t && (this.onSuccessfulConnect(t, e.data), this.switchers[this.requestedProvider || t].setState(!0), this.requestedProvider = null)
        },
        onConnectButtonClick: function(e) {
            let o = (0, go.default)(e.currentTarget).attr("data-provider");
            this.startOauth(o)
        },
        onActionIconClick: function(e) {
            let t = (0, go.default)(e.currentTarget),
                o = t.closest(".input-wrapper").find("input"),
                i = o.val().trim(),
                n = o.attr("data-provider");
            t.hasClass("remove-icon") ? (o.val(""), this.onReachInputChange(o), n === "google" && (this.setEndpointParam("google", "sheet_name", null), this.setEndpointParam("google", "sheet_id", null)), n === "url" && this.setEndpointParam("url", "custom_url", null), n === "dropbox" && (this.setEndpointParam("dropbox", "folder_name", this.dropboxFolderName), o.focus()), n === "googledrive" && this.setEndpointParam("googledrive", "folder_name", this.googledriveFolderName)) : t.hasClass("apply-icon") && (this.setReachInputIcon(o, "remove-icon"), n === "google" && (this.getEndpointParam("google", "sheet_name") === i || (this.setReachInputIcon(o, "preloader-icon"), this.createSheet(i, function(a, l) {
                this.setReachInputIcon(o, a ? "apply-icon" : "remove-icon"), !a && l.spreadsheetId && (this.setEndpointParam("google", "sheet_name", i), this.setEndpointParam("google", "sheet_id", l.spreadsheetId))
            }.bind(this)))), n === "url" && this.setEndpointParam("url", "custom_url", i), n === "second_email" && this.addEmail(i, o), n === "dropbox" && this.setEndpointParam("dropbox", "folder_name", i || this.dropboxFolderName), n === "googledrive" && this.setEndpointParam("googledrive", "folder_name", i || this.googledriveFolderName), n === "confirmation-code" && this.checkConfirmationCode(i, o))
        },
        addEmail: function(e, t) {
            let o = {
                additonal_email: e,
                mag_title: RM.constructorRouter.mag.get("title") ? RM.constructorRouter.mag.get("title") : "Project Title",
                page_number: RM.constructorRouter.workspace.getPageNum()
            };
            this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/me/addemail",
                method: "POST",
                data: o,
                success: function() {
                    this.$(".panel-section.second_email .back").hasClass("hidden") || this.$(".panel-section.second_email .back").addClass("hidden"), this.$confirmationView.removeClass("hidden"), t.val(""), this.$(".panel-section.second_email .email-for-confirmation").text(e), t.attr("data-provider", "confirmation-code"), this.onReachInputChange(t), t.addClass("padding-right-zero"), t.attr("type", "text"), t.attr("placeholder", "and paste code"), this.checkPanelPosition("second_email")
                }.bind(this),
                error: function(i) {
                    this.$inputWrapper.addClass("hidden"), this.$(".panel-section.second_email .error.email-for-confirmation").text(e), this.$(".panel-section.second_email .error-block").removeClass("hidden"), console.log("xhr : ", i)
                }.bind(this)
            })
        },
        setEmailsView: function(e) {
            let t = this.model.get("endpoint_additonal_emails") ? this.model.get("endpoint_additonal_emails").length : 0,
                o = this.getEndpointParam("selected_email", "last_selected_email") ? this.getEndpointParam("selected_email", "last_selected_email") : "",
                i, n, s, a;
            if (e || (e = o), t === 0) this.setInputView();
            else if (t === 1) this.$emailNew.removeClass("hidden"), this.$emailNew.text(e), o || this.setEndpointParam("selected_email", "last_selected_email", e), this.$inputWrapper.addClass("hidden"), this.$changeEmail.removeClass("hidden");
            else {
                i = this.model.get("endpoint_additonal_emails"), n = (0, go.default)(".panel-section.second_email .choice-email select"), n.children("option").length !== 0 && n.children("option").remove(), a = i.map(function(l) {
                    return l.additonal_email
                }), o && !a.includes(o) && a.push(o);
                for (let l = 0; l < a.length; l++) s = (0, go.default)("<option></option>").text(a[l]), n[0].add(s[0]);
                n.children("option").filter(function() {
                    return (0, go.default)(this).text() === e
                }).prop("selected", !0), this.setEndpointParam("selected_email", "last_selected_email", e), this.$inputWrapper.addClass("hidden"), this.$changeEmail.removeClass("hidden"), this.$selectWrapper.removeClass("hidden")
            }
        },
        checkConfirmationCode: function(e, t) {
            let o = {
                    confirmation_code: e
                },
                i = this.$(".panel-section.second_email .confirmation .confirmation.email-for-confirmation").text();
            this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/me/checkcode",
                method: "POST",
                data: o,
                success: function() {
                    this.setEndpointParam("additonal_emails", "additonal_email", i), this.setEmailsView(i), this.$confirmationView.addClass("hidden")
                }.bind(this),
                error: function(n) {
                    t.addClass("err-code"), setTimeout(sn.default.bind(function() {
                        t.removeClass("err-code"), t.val(""), this.$(".panel-section.second_email .input-wrapper .action-icon").removeClass("remove-icon").addClass("hidden")
                    }, this), 3e3), console.log("xhr : ", n)
                }.bind(this)
            })
        },
        backClick: function() {
            let e = this.getEndpointParam("selected_email", "last_selected_email");
            this.setEmailsView(e), this.$(".panel-section.second_email .back").addClass("hidden")
        },
        tryAnotherClick: function() {
            this.$inputWrapper.removeClass("hidden"), this.$(".panel-section.second_email .error-block").addClass("hidden")
        },
        setInputView: function() {
            let e = this.$(".panel-section.second_email .input-second-email");
            e.val(""), e.removeClass("padding-right-zero"), e.attr("type", "email"), e.attr("placeholder", "Add email"), this.$inputWrapper.removeClass("hidden"), e.attr("data-provider", "second_email"), this.$(".panel-section.second_email .input-wrapper .action-icon").removeClass("remove-icon").addClass("hidden")
        },
        changeEmailClick: function() {
            this.$(".panel-section.second_email .back").removeClass("hidden"), this.model.get("endpoint_additonal_emails").length > 1 && this.$(".panel-section.second_email .back").text("Back to list"), this.$selectWrapper.hasClass("hidden") || this.$selectWrapper.addClass("hidden"), this.setInputView(), this.$emailNew.addClass("hidden"), this.$changeEmail.addClass("hidden")
        },
        onEmailsSelectChange: function() {
            let e;
            (0, go.default)(".choice-email option:selected").each(function() {
                e = (0, go.default)(this).val()
            }), this.setEndpointParam("selected_email", "last_selected_email", e)
        },
        resendCodeClick: function() {
            let e = {
                additonal_email: this.$(".panel-section.second_email .confirmation .email-for-confirmation").text(),
                mag_title: RM.constructorRouter.mag.get("title") ? RM.constructorRouter.mag.get("title") : "Project Title",
                page_number: RM.constructorRouter.workspace.getPageNum()
            };
            this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/me/resendcode",
                method: "POST",
                data: e,
                success: function() {
                    setTimeout(sn.default.bind(function() {
                        this.$(".panel-section.second_email .confirmation.resend").text("Resend confirmation")
                    }, this), 4e3), this.$(".panel-section.second_email .confirmation.resend").text("Confirmation sent")
                }.bind(this),
                error: function(t) {
                    console.log("xhr : ", t)
                }.bind(this)
            })
        },
        cancelRequestClick: function() {
            let e = this.$(".panel-section.second_email .confirmation .email-for-confirmation").text(),
                t = {
                    additonal_email: e
                };
            this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/me/cancelrequest",
                method: "POST",
                data: t,
                success: function() {
                    this.setEmailsView(), this.$confirmationView.addClass("hidden")
                }.bind(this),
                error: function(o) {
                    console.log("xhr : ", o)
                }.bind(this)
            })
        },
        createSheet: function(e, t) {
            this.xhr = go.default.ajax({
                dataType: "json",
                url: "/api/connect/forms/google/createsheet",
                method: "POST",
                data: {
                    title: e
                },
                success: function(o) {
                    t(null, o.sheet)
                }.bind(this),
                error: function(o) {
                    console.log("xhr : ", o), t(o.responseText)
                }.bind(this)
            })
        },
        setSectionCollapsed: function(e, t) {
            this.$(".panel-section." + e).toggleClass("collapsed", t), this.$panel.toggleClass(e, !t)
        },
        hasMailchimpFields: function() {
            let e = this.model.get("fields");
            return sn.default.any(e, function(t) {
                return t.tp === "email" && !t.optional
            })
        },
        onFieldsChange: function() {
            this.updateState()
        },
        onEndpointsChange: function() {
            this.updateState()
        },
        getEndpointProviders: function() {
            return sn.default.map(this.$(".switcher.provider"), function(e) {
                return (0, go.default)(e).attr("data-provider")
            })
        },
        getEndpointStorages: function() {
            return sn.default.map(this.$(".switcher.storage"), function(e) {
                return (0, go.default)(e).attr("data-provider")
            })
        },
        updateState: function() {
            let e = this.hasMailchimpFields(),
                t = this.getEndpointProviders(),
                o = this.getEndpointStorages();
            this.allExceptEmailDisabled = !0, this.allExceptDataStoragesDisabled = !0, this.hasEnabledEmail = !!this.getEndpointParam("email", "enabled") || !!this.getEndpointParam("second_email", "enabled"), sn.default.each(sn.default.without(t, "email"), function(i) {
                let n = !!this.getEndpointParam(i, "enabled");
                i === "mailchimp" && (e || (this.setEndpointParam(i, "enabled", !1, {
                    silent: !0
                }), n = !1), this.$(".panel-section.mailchimp").find(".switcher-wrapper").toggleClass("forbidden", !e)), n && (this.allExceptEmailDisabled = !1)
            }.bind(this)), this.allExceptEmailDisabled && this.setEndpointParam("email", "enabled", !0, {
                silent: !0
            }), sn.default.each(sn.default.without(o, "email-storage"), function(i) {
                !!this.getEndpointParam(i, "enabled") && (this.allExceptDataStoragesDisabled = !1)
            }.bind(this)), this.hasEnabledEmail ? this.allExceptDataStoragesDisabled && this.setEndpointParam("email-storage", "enabled", !0, {
                silent: !0
            }) : this.setEndpointParam("email-storage", "enabled", !1, {
                silent: !0
            }), this.updateSwitchers()
        },
        updateSwitchers: function() {
            sn.default.each(sn.default.keys(this.switchers), function(e) {
                let t = this.switchers[e],
                    o = !!this.getEndpointParam(e, "enabled");
                t.setState(o, !0), this.setSectionCollapsed(e, !o), e === "email" && t.setDisabled(!!this.allExceptEmailDisabled), e === "email-storage" && t.setDisabled(!!this.allExceptDataStoragesDisabled || !this.hasEnabledEmail), o && this.checkPanelPosition(e)
            }.bind(this))
        },
        bindLogic: function() {
            this.listenTo(this.model, "change:fields", this.onFieldsChange), this.listenTo(this.model, "change:endpoint_email change:endpoint_second_email change:endpoint_google change:endpoint_mailchimp change:endpoint_url change:endpoint_dropbox change:endpoint_googledrive", this.onEndpointsChange)
        },
        unBindLogic: function() {
            this.stopListening(this.model)
        },
        save: function() {
            this.model.save({})
        },
        deselect: function() {
            this.getEndpointParam("google", "sheet_id") || this.setEndpointParam("google", "enabled", !1), this.getEndpointParam("mailchimp", "list_id") || this.setEndpointParam("mailchimp", "enabled", !1), this.getEndpointParam("url", "custom_url") || this.setEndpointParam("url", "enabled", !1), this.updateState(), A_.deselect.apply(this, arguments)
        },
        destroy: function() {
            this.xhr && this.xhr.abort(), (0, go.default)(window).off("message", this.processWindowMessage), A_.destroy.apply(this, arguments)
        }
    }), m9 = Fq
});

function Lq({
    form: e,
    onChange: t,
    projectId: o,
    currentStyleField: i,
    currentSection: n,
    currentButtonModifier: s,
    onToggleSelectPanel: a,
    userId: l
}) {
    let {
        callback: c
    } = Je(C => t(C), 50);

    function d(C = "") {
        let I = ["left", "center", "right"],
            T = (I.indexOf(C) + 1) % I.length;
        return I[T]
    }
    let {
        dropdownContainer: p
    } = (0, pc.useContext)(Ot), {
        navigate: h
    } = (0, pc.useContext)(Jt), u = { ...e[i]
    }, m = n === "fields", f = n === "button", g = s === "default", y = (0, pc.useMemo)(() => e["style-" + e.style + "-fields"], [e.style]), S = (0, pc.useMemo)(() => e["style-" + e.style + "-button-default"], [e.style]), w = (0, pc.useMemo)(() => {
        let C = e.fields.length,
            I = S.gutter + C * y.gutter,
            T = e.w - I;
        return Math.floor(T / (C + 1))
    }, [e.w, y.gutter, S.gutter]);
    if (f) {
        let C = `style-${e.style}-fields`,
            I = e[C],
            T = `style-${e.style}-button-default`,
            P = e[T];
        Object.keys(u).forEach(M => {
            let F = M;
            u[F] === "inherit" && (u[F] = P[F] === "inherit" ? I[F] : P[F])
        })
    }
    let v = (0, pc.useMemo)(() => u && f && !g ? ct(u["text-color"], u["text-opacity"]) : ct("ffffff", 100), [f, g, u, u["text-color"], u["text-opacity"]]);
    return u ? x(Q, {
        children: [f && g && e.layout === "horizontal" && r(H, {
            showBorder: !1,
            leftSlot: "Width",
            rightSlot: r(fe, {
                value: u.width || w || 0,
                min: 0,
                max: 999,
                textAlign: "right",
                autoWidth: !0,
                onChange: ({
                    value: C
                }) => {
                    t({
                        width: C
                    })
                }
            })
        }), f && g && r(H, {
            showBorder: !1,
            leftSlot: e.layout === "vertical" ? "Top margin" : "Left margin",
            rightSlot: r(fe, {
                value: u.gutter || 0,
                min: 0,
                max: 999,
                textAlign: "right",
                autoWidth: !0,
                onChange: ({
                    value: C
                }) => {
                    t({
                        gutter: C
                    })
                }
            })
        }), m && r(H, {
            showBorder: !1,
            leftSlot: "Spacing",
            rightSlot: r(fe, {
                value: u.gutter || 0,
                min: 0,
                max: 999,
                textAlign: "right",
                autoWidth: !0,
                onChange: ({
                    value: C
                }) => {
                    c({
                        gutter: C
                    })
                }
            })
        }), m && e.style === "underlined" && r(qe, {
            showBorder: !1,
            container: p,
            title: "Underline color",
            projectId: o,
            userId: l,
            color: ct(u["underline-color"] || "", u["underline-opacity"] / 100),
            setColor: C => {
                C && t({
                    "underline-color": yt(C),
                    "underline-opacity": C.a * 100
                })
            }
        }), m && e.style === "underlined" && r(H, {
            leftSlot: "Underline width",
            rightSlot: r(fe, {
                value: u["underline-width"] || 0,
                min: 0,
                max: 999,
                textAlign: "right",
                autoWidth: !0,
                onChange: ({
                    value: C
                }) => {
                    t({
                        "underline-width": C
                    })
                }
            })
        }), (f || m && e.style !== "underlined") && r(qe, {
            showBorder: !1,
            container: p,
            title: "Shape color",
            projectId: o,
            userId: l,
            color: ct(u.color || "", u.opacity / 100),
            setColor: C => {
                C && t({
                    color: yt(C),
                    opacity: C.a * 100
                })
            }
        }), (f && g || m && e.style !== "underlined") && r(H, {
            showBorder: !1,
            leftSlot: "Radius",
            rightSlot: r(fe, {
                value: u["border-radius"] || 0,
                min: 0,
                max: 999,
                textAlign: "right",
                autoWidth: !0,
                onChange: ({
                    value: C
                }) => {
                    t({
                        "border-radius": C
                    })
                }
            })
        }), (f || m && e.style !== "underlined") && r(H, {
            showBorder: !1,
            leftSlot: "Border",
            rightSlot: r(fe, {
                value: u["border-width"] || 0,
                min: 0,
                max: 999,
                textAlign: "right",
                autoWidth: !0,
                onChange: ({
                    value: C
                }) => {
                    c({
                        "border-width": C
                    })
                }
            })
        }), (f || m && e.style !== "underlined") && r(qe, {
            container: p,
            title: "Border color",
            projectId: o,
            userId: l,
            color: ct(u["border-color"] || "", u["border-opacity"] / 100),
            setColor: C => {
                C && t({
                    "border-color": yt(C),
                    "border-opacity": C.a * 100
                })
            }
        }), (m || g) && x(Q, {
            children: [r(tl, {
                showBorder: !1,
                fontFamily: u["font-family"],
                onClick: () => h("fontList")
            }), r(Fa, {
                showBorder: !1,
                fontFamily: u["font-family"],
                fontWeight: [u["font-weight"]],
                fontStyle: [u["font-style"]],
                dropdownContainer: p,
                onToggleSelectPanel: a,
                onChangeStyle: C => {
                    t({
                        "font-weight": C.weight || u["font-weight"],
                        "font-style": C.style || u["font-style"]
                    })
                }
            }), r(H, {
                leftSlot: "Size",
                showBorder: !1,
                rightSlot: r(fe, {
                    value: u["font-size"] || 0,
                    min: 0,
                    max: 999,
                    textAlign: "right",
                    autoWidth: !0,
                    onChange: ({
                        value: C
                    }) => {
                        t({
                            "font-size": C
                        })
                    }
                })
            }), r(H, {
                leftSlot: "Letter spacing",
                showBorder: !1,
                rightSlot: r(fe, {
                    textAlign: "right",
                    min: -99,
                    max: 999,
                    step: .1,
                    fontSize: String(u["letter-spacing"]).length > 4 ? 16 : void 0,
                    autoWidth: !0,
                    value: u["letter-spacing"] || 0,
                    onChange: ({
                        value: C
                    }) => {
                        t({
                            "letter-spacing": C
                        })
                    }
                })
            }), r(qe, {
                container: p,
                showBorder: !1,
                title: "Text color",
                projectId: o,
                userId: l,
                color: ct(u["text-color"] || "", u["text-opacity"] / 100),
                setColor: C => {
                    C && t({
                        "text-color": yt(C),
                        "text-opacity": C.a * 100
                    })
                }
            })]
        }), f && g && r(H, {
            showBorder: !1,
            leftSlot: r(K, {
                onClick: () => {
                    t({
                        "text-align": d(u["text-align"])
                    })
                },
                children: x($, {
                    fontSize: 12,
                    fontWeight: 500,
                    children: ["Aligned ", u["text-align"]]
                })
            })
        }), f && !g && x(Q, {
            children: [r(qe, {
                showBorder: !1,
                container: p,
                title: "Text color",
                projectId: o,
                userId: l,
                color: v,
                setColor: C => {
                    C && t({
                        "text-color": yt(C),
                        "text-opacity": C.a <= 1 ? C.a * 100 : C.a
                    })
                }
            }), r(H, {
                showBorder: !1,
                leftSlot: "Transition",
                rightSlot: r(Ve, {
                    checked: !!u.transition,
                    backgroundChecked: "black",
                    onChange: () => t({
                        transition: !u.transition
                    })
                })
            })]
        }), m && r(H, {
            showBorder: !1,
            leftSlot: "RTL",
            rightSlot: r(Ve, {
                backgroundChecked: "black",
                checked: u.direction === "rtl",
                onChange: () => t({
                    direction: !u.direction || u.direction === "ltr" ? "rtl" : "ltr",
                    "text-align": !u.direction || u.direction === "ltr" ? "right" : "left"
                })
            })
        })]
    }) : null
}
var pc, g9, b9 = k(() => {
    "use strict";
    pc = E(N());
    qo();
    Be();
    je();
    Hi();
    zt();
    nt();
    $e();
    nn();
    ko();
    um();
    ol();
    ni();
    L_();
    Sf();
    Sf();
    B();
    g9 = Lq
});

function zq({
    width: e,
    selected: t,
    values: o,
    captions: i,
    onChange: n,
    margin: s,
    height: a = 40,
    borderRadius: l = 8,
    bgColor: c = ce.gray,
    hoverColor: d = ce.darkGray,
    activeHoverColor: p = ce.red,
    activeColor: h = ce.black
}) {
    let [u, m] = (0, Pu.useState)(t), [f, g] = (0, Pu.useState)(null), [y, S] = (0, Pu.useState)(!1);
    return (0, Pu.useEffect)(() => {
        m(t)
    }, [t]), x(b, {
        display: "flex",
        position: "relative",
        width: e,
        height: a,
        backgroundColor: !f || y || f === u ? c : d,
        borderRadius: l,
        justifyContent: "space-between",
        cursor: "pointer",
        margin: s,
        children: [r(Vr, {
            as: "select",
            value: t,
            onChange: w => {
                n(w.currentTarget && w.currentTarget.value === o[0] ? o[0] : o[1])
            }
        }), r(b, {
            position: "absolute",
            width: e / 2,
            height: a,
            borderRadius: l,
            padding: 12,
            transform: `translateX(${u===o[0]?"0px":`${e/2}px`})`,
            transition: "transform 0.2s ease-in-out",
            backgroundColor: f === u && !y ? p : h
        }), r(b, {
            display: "flex",
            position: "absolute",
            left: 0,
            alignItems: "center",
            justifyContent: "center",
            width: e / 2,
            height: a,
            borderRadius: l,
            padding: 12,
            onMouseEnter: () => {
                g(o[0])
            },
            onMouseLeave: () => {
                S(!1), g(null)
            },
            onClick: () => {
                S(!0), m(o[0]), n(o[0])
            },
            children: i[0]
        }), r(b, {
            display: "flex",
            position: "absolute",
            right: 0,
            alignItems: "center",
            justifyContent: "center",
            width: e / 2,
            height: a,
            borderRadius: l,
            padding: 12,
            onMouseEnter: () => {
                g(o[1])
            },
            onMouseLeave: () => {
                S(!1), g(null)
            },
            onClick: () => {
                S(!0), m(o[1]), n(o[1])
            },
            children: i[1]
        })]
    })
}
var Pu, y9, v9 = k(() => {
    "use strict";
    Pu = E(N());
    ie();
    ut();
    Ch();
    B();
    y9 = zq
});

function w9({
    layout: e,
    onChange: t,
    isSelected: o
}) {
    let [i, n] = (0, x9.useState)(!1), s = e === "horizontal" ? jq : Oq;
    return r(b, {
        width: 56,
        onClick: () => t(e),
        cursor: o ? "inherit" : "pointer",
        onMouseEnter: () => n(!0),
        onMouseLeave: () => n(!1),
        transition: "0.2s",
        children: r(s, {
            color: i || o ? "black" : "gray"
        })
    })
}

function Hq({
    value: e,
    onChange: t
}) {
    return x(b, {
        display: "flex",
        alignItems: "center",
        justifyContent: "space-between",
        children: [r(w9, {
            layout: "vertical",
            onChange: t,
            isSelected: e === "vertical"
        }), r(w9, {
            layout: "horizontal",
            onChange: t,
            isSelected: e === "horizontal"
        })]
    })
}
var x9, $q, Wq, Oq, jq, _9, S9 = k(() => {
    "use strict";
    x9 = E(N());
    ie();
    ve();
    Sf();
    B();
    $q = e => x("svg", {
        width: "56",
        height: "20",
        viewBox: "0 0 56 20",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("rect", {
            x: "56",
            y: "6",
            width: "56",
            height: "6",
            rx: "3",
            transform: "rotate(-180 56 6)",
            fill: "currentColor"
        }), r("rect", {
            x: "56",
            y: "13",
            width: "56",
            height: "6",
            rx: "3",
            transform: "rotate(-180 56 13)",
            fill: "currentColor"
        }), r("rect", {
            x: "56",
            y: "20",
            width: "56",
            height: "6",
            rx: "3",
            transform: "rotate(-180 56 20)",
            fill: "currentColor"
        })]
    }), Wq = e => x("svg", {
        width: "56",
        height: "6",
        viewBox: "0 0 56 6",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("rect", {
            x: "56",
            y: "6",
            width: "17",
            height: "6",
            rx: "3",
            transform: "rotate(-180 56 6)",
            fill: "currentColor"
        }), r("rect", {
            x: "37",
            y: "6",
            width: "18",
            height: "6",
            rx: "3",
            transform: "rotate(-180 37 6)",
            fill: "currentColor"
        }), r("rect", {
            x: "17",
            y: "6",
            width: "17",
            height: "6",
            rx: "3",
            transform: "rotate(-180 17 6)",
            fill: "currentColor"
        })]
    }), Oq = b.withComponent(ue($q)
        `
  display: block;
`), jq = b.withComponent(ue(Wq)
        `
  display: block;
`);
    _9 = Hq
});

function Nq({
    layout: e,
    caption: t,
    onChange: o,
    isSelected: i
}) {
    let [n, s] = (0, qb.useState)(!1);
    return r(b, {
        onClick: () => o(e),
        cursor: i ? "inherit" : "pointer",
        onMouseEnter: () => s(!0),
        onMouseLeave: () => s(!1),
        transition: "0.2s",
        paddingLeft: 10,
        paddingRight: 10,
        children: r($, {
            color: n || i ? "black" : "gray",
            fontWeight: i ? 600 : 500,
            fontSize: 12,
            children: t
        })
    })
}

function Uq({
    value: e,
    onChange: t
}) {
    let o = [{
            value: "colored",
            caption: "Colored"
        }, {
            value: "outlined",
            caption: "Outlined"
        }, {
            value: "underlined",
            caption: "Underlined"
        }],
        i = [46, -15, -88],
        n = (0, qb.useMemo)(() => {
            let s = o.findIndex(a => a.value === e);
            return i[s]
        }, [e]);
    return r(b, {
        overflow: "hidden",
        marginLeft: "-16px",
        marginRight: "-16px",
        children: r(b, {
            display: "flex",
            alignItems: "center",
            justifyContent: "flex-start",
            transition: "0.5s ease-in-out",
            transform: `translateX(${n}px)`,
            children: o.map(s => r(Nq, {
                layout: s.value,
                onChange: t,
                isSelected: e === s.value,
                caption: s.caption
            }, s.value))
        })
    })
}
var qb, C9, k9 = k(() => {
    "use strict";
    qb = E(N());
    ie();
    Be();
    Sf();
    B();
    C9 = Uq
});

function Vq() {
    let {
        model: e,
        modelSet: t,
        modelSave: o
    } = (0, Ui.useContext)(ge), {
        model: i,
        modelSet: n
    } = (0, Ui.useContext)(Y), s = (0, Ui.useMemo)(() => i.project.get("_id"), [i]), a = (0, Ui.useMemo)(() => i.user.get("_id"), [i]), {
        callback: l
    } = Je(o, 400), c = (0, Ui.useRef)(null), {
        canControlBeClosed: d,
        onStackUpdated: p
    } = As(c.current);
    i.injectedRefs.canControlBeClosed = d;
    let h = R => n({
            preventClose: R
        }),
        [u, m] = (0, Ui.useState)("fields"),
        [f, g] = (0, Ui.useState)(0),
        [y, S] = (0, Ui.useState)("default");
    (0, Ui.useEffect)(() => {
        S(f === 0 ? "default" : "hover")
    }, [f]);
    let w = (0, Ui.useMemo)(() => {
            let R = ["style", e.style, u];
            return u === "button" && R.push(y || "default"), R.join("-")
        }, [e.style, u, y]),
        v = (0, Ui.useMemo)(() => {
            let R = ["style", e.style, u];
            return u === "button" && R.push("default"), R.join("-")
        }, [e.style, u, y]),
        C = (0, Ui.useMemo)(() => e[v]["font-family"] === "inherit" ? e[`style-${e.style}-button-default`]["font-family"] === "inherit" ? e[`style-${e.style}-fields`]["font-family"] : e[`style-${e.style}-button-default`]["font-family"] : e[v]["font-family"], [v]),
        I = R => {
            t({
                [v]: { ...e[v],
                    "font-family": R.css_name
                }
            }), l()
        },
        T = R => {
            t(R), l()
        },
        P = R => {
            t({
                [w]: { ...e[w],
                    ...R
                }
            }), l()
        },
        M = r(Ut, {
            showBorder: !1,
            leftSlot: r(K, {
                variant: "clean",
                onClick: () => c.current && c.current.goBack(),
                css: Z `
            &:hover svg {
              color: ${ce.black};
              opacity: 1;
            }
          `,
                children: r(_r, {
                    color: "darkGray"
                })
            })
        }),
        F = (0, Ui.useCallback)(R => {
            R.preventDefault(), !i.disabled && i.select()
        }, [i.disabled]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: R
        }) => r(ke, {
            ref: R,
            label: "Columns",
            onClick: F,
            children: r(Hl, {
                color: "white"
            })
        }),
        panel: ({
            ref: R,
            style: A,
            update: D,
            getScrollablePanelProps: O
        }) => i.selected ? x(Pr, {
            ref: c,
            initialScreen: "styles",
            onStackUpdated: p,
            onNavigate: () => {
                D()
            },
            children: [r(lo, {
                screen: "styles",
                children: x(Me, {
                    ref: R,
                    style: A,
                    isShowed: i.selected,
                    ...O(),
                    children: [r(co, {
                        title: "Form style"
                    }), x(b, {
                        ref: R,
                        children: [r(H, {
                            showBorder: !1,
                            children: r(_9, {
                                value: e.layout,
                                onChange: L => T({
                                    layout: L
                                })
                            })
                        }), r(H, {
                            showBorder: !1,
                            children: r(C9, {
                                value: e.style,
                                onChange: L => T({
                                    style: L
                                })
                            })
                        }), r(H, {
                            showBorder: !1,
                            children: r(y9, {
                                width: 136,
                                selected: "fields",
                                values: ["fields", "button"],
                                captions: [r($, {
                                    fontSize: 12,
                                    fontWeight: 500,
                                    color: "white",
                                    children: "Fields"
                                }, 0), r($, {
                                    fontSize: 12,
                                    fontWeight: 500,
                                    color: "white",
                                    children: "Button"
                                }, 1)],
                                onChange: L => {
                                    m(L)
                                }
                            })
                        }), u === "button" && r(os, {
                            items: [{
                                title: "Default"
                            }, {
                                title: "Hover"
                            }],
                            activeIndex: f,
                            onChange: L => {
                                g(L)
                            }
                        }), r(g9, {
                            currentButtonModifier: y,
                            currentSection: u,
                            onToggleSelectPanel: h,
                            form: e,
                            currentStyleField: w,
                            onChange: P,
                            projectId: s,
                            userId: a
                        })]
                    })]
                })
            }), r(lo, {
                screen: "fontList",
                children: r(ta, {
                    ref: R,
                    style: A,
                    headerSlot: M,
                    currentFontFamily: C,
                    onFontSelect: I
                })
            }), r(lo, {
                screen: "fontUploader",
                children: r(Ta, {
                    ref: R,
                    style: A
                })
            })]
        }) : null
    })
}
var Ui, I9, L_ = k(() => {
    "use strict";
    Ui = E(N());
    Le();
    ae();
    ht();
    nt();
    ut();
    qo();
    Vn();
    $e();
    b9();
    rb();
    Qp();
    ni();
    qc();
    je();
    gn();
    v9();
    Be();
    Rx();
    S9();
    k9();
    Bf();
    ve();
    ie();
    B();
    I9 = Vq
});
var P9, T9 = k(() => {
    "use strict";
    ae();
    L_();
    P9 = Ce.extend({
        name: "form_styles",
        component: I9,
        rolePermission: "FormCanChangeStyle"
    })
});

function hc({
    labels: e,
    children: t,
    initialIndex: o,
    onTabChange: i,
    backgroundColor: n,
    activeTabColor: s,
    textColor: a,
    activeTextColor: l,
    disabled: c,
    tabSwitcherRef: d,
    ...p
}) {
    let [h, u] = (0, uc.useState)(() => o ? ? 0), m = f => {
        c ? i ? .(f) : (i ? .(f), u(f))
    };
    return (0, uc.useImperativeHandle)(d, () => m, [m]), x(Q, {
        children: [r(b, { ...p,
            children: r(b, {
                display: "flex",
                flexDirection: "row",
                alignItems: "stretch",
                borderRadius: 8,
                backgroundColor: n,
                children: e.map((f, g) => r(b, {
                    padding: 8,
                    display: "flex",
                    alignItems: "flex-start",
                    width: "100%",
                    justifyContent: "center",
                    borderRadius: 8,
                    backgroundColor: g === h ? s : "transparent",
                    cursor: g === h ? "default" : "pointer",
                    color: g === h ? l : a,
                    css: Z `
                &:hover {
                  color: ${l};
                }
              `,
                    onClick: () => m(g),
                    children: typeof f == "string" ? r($, {
                        textStyle: "small",
                        color: "inherit",
                        children: f
                    }) : f
                }, g))
            })
        }), r(Gq, {
            value: h,
            children: t
        })]
    })
}

function Hs({
    index: e,
    children: t
}) {
    return Yq() === e ? r(Q, {
        children: t
    }) : null
}

function Gq({
    value: e,
    children: t
}) {
    return r(B9.Provider, {
        value: e,
        children: t
    })
}

function Yq() {
    return (0, uc.useContext)(B9)
}
var uc, B9, mm = k(() => {
    "use strict";
    uc = E(N());
    ie();
    Be();
    ve();
    B();
    B9 = (0, uc.createContext)(0)
});

function Qb({
    initialValue: e = "",
    placeholder: t = "",
    disabled: o,
    onApply: i,
    onClearInput: n,
    validator: s = () => !0,
    externalError: a,
    isValidating: l
}) {
    let c = (0, fm.useRef)(null),
        [d, p] = (0, fm.useState)(() => e),
        [h, u] = (0, fm.useState)(!1);

    function m() {
        u(!1), n ? .(), p(""), c.current ? .focus()
    }

    function f(y) {
        let S = y || d;
        s(S.trim()) ? i ? .(S.trim()) : u(!0)
    }

    function g(y) {
        y.preventDefault();
        let w = y.clipboardData.getData("Text");
        p(w), f(w)
    }
    return d && h || a ? x(b, {
        padding: "0 16px",
        display: "flex",
        flexDirection: "column",
        justifyContent: "center",
        children: [r($, {
            textAlign: "center",
            textStyle: "small",
            color: "red",
            marginBottom: "8px",
            children: "Wrong link format"
        }), r($, {
            role: "button",
            onClick: m,
            textStyle: "small",
            textAlign: "center",
            color: "black",
            cursor: "pointer",
            children: "Try again"
        })]
    }) : !d || !h ? x(b, {
        backgroundColor: o ? "transparent" : "white",
        display: "flex",
        flexDirection: "row",
        alignItems: "center",
        position: "relative",
        borderRadius: "8px",
        paddingLeft: 8,
        paddingRight: 8,
        children: [r(Mo, {
            autoFocus: !0,
            ref: c,
            disabled: o,
            placeholder: t,
            height: "40px",
            border: "none !important",
            padding: 0,
            paddingRight: 4,
            textStyle: "small",
            value: d,
            onPaste: g,
            onChange: y => p(y.target.value),
            onKeyUp: y => y.key === "Enter" && f()
        }), d && r(Zq, {
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
            height: 24,
            width: 24,
            disabled: o,
            onClick: () => f(),
            borderRadius: "50%",
            backgroundColor: "#0080FF33",
            margin: 0,
            padding: 3,
            role: "button",
            children: l ? r(_o, {
                color: "blue",
                size: 16,
                bgColor: "transparent"
            }) : r(T0, {
                color: "#0080FF"
            })
        })]
    }) : null
}
var fm, Zq, z_ = k(() => {
    "use strict";
    fm = E(N());
    ie();
    Be();
    Ur();
    Uj();
    Zd();
    Bs();
    B();
    Zq = ue(b)
    `
  &:hover {
    cursor: pointer;
    background-color: #0080ff;
    svg {
      color: #fff;
    }
  }
`
});

function Kq({
    useSharedState: e
}) {
    let {
        model: t
    } = (0, Aa.useContext)(Y), {
        model: o,
        modelSet: i,
        modelSave: n
    } = (0, Aa.useContext)(ge), [s, a] = (0, Aa.useState)(!1), [l, c] = (0, Aa.useState)(!1), [{
        isUploading: d,
        isPlayerReady: p,
        player: h
    }, u] = e(), m = h || Xq, f = Hr(m ? .state), g = t && t.page && t.page.workspace && t.page.workspace.controls && t.page.workspace.controls.findControl("lottie_interactions"), y = (0, Aa.useCallback)(v => {
        v.preventDefault(), !t.disabled && t.select()
    }, [t.disabled]);
    async function S(v) {
        u({
            isUploading: !0
        }), a(!1);
        try {
            let C = await (v instanceof File ? JI(v, t.project.attributes._id) : qI(v, t.project.attributes._id));
            C.uri && (u({
                isPlayerReady: !1,
                containerHeight: void 0
            }), c(!1), i({
                uri: C.uri
            }), m.remount(), g && t.selected && g.master.select(g))
        } catch (C) {
            alert(`Error uploading Lottie file: ${C.message}`)
        } finally {
            u({
                isUploading: !1
            })
        }
    }

    function w() {
        let v = n1(o.uri);
        v && (n({
            uri: v
        }), m.remount(), c(!1))
    }
    return r(Ie, {
        control: ({
            ref: v
        }) => r(ke, {
            ref: v,
            label: "Lottie file",
            onClick: y,
            children: r(Pp, {
                color: "white"
            })
        }),
        panel: ({
            ref: v,
            style: C
        }) => x(Me, {
            ref: v,
            style: C,
            isShowed: t.selected,
            children: [r(Ut, {
                showBorder: !1,
                leftSlot: r($, {
                    children: "Lottie"
                }),
                rightSlot: r($_, {
                    href: "https://help.readymag.com/hc/en-us/articles/23124356427931-Lottie"
                })
            }), x(Q, {
                children: [x(hc, {
                    labels: ["File", "URL"],
                    padding: "0 16px",
                    initialIndex: 0,
                    backgroundColor: ce.gray,
                    activeTabColor: ce.black,
                    textColor: ce.white,
                    activeTextColor: ce.white,
                    children: [r(Hs, {
                        index: 0,
                        children: r(vi, {
                            id: `lottie-file-upload-${o._id}`,
                            cursor: d ? "default" : "pointer",
                            readFileData: !1,
                            onChange: S,
                            dropFile: !d,
                            accept: "application/json, .lottie",
                            children: r(b, {
                                padding: "16px",
                                paddingBottom: 0,
                                children: r(b, {
                                    borderRadius: 8,
                                    minHeight: "100px",
                                    backgroundColor: s ? "rgba(112, 112, 112, 0.2)" : "transparent",
                                    display: "flex",
                                    justifyContent: "center",
                                    alignItems: "center",
                                    onDragOver: () => a(!0),
                                    onDragLeave: () => a(!1),
                                    css: Z `
                        &:hover {
                          opacity: 0.8;
                        }
                      `,
                                    children: s ? r($, {
                                        as: "div",
                                        textStyle: "small",
                                        color: "#0080FF",
                                        textAlign: "center",
                                        children: "Drop me here!"
                                    }) : x($, {
                                        as: "div",
                                        textStyle: "small",
                                        color: "#0080FF",
                                        textAlign: "center",
                                        children: ["Drop here", r("br", {}), ".lottie", r("br", {}), "or", r("br", {}), ".json"]
                                    })
                                })
                            })
                        })
                    }), r(Hs, {
                        index: 1,
                        children: r(b, {
                            padding: "16px",
                            paddingBottom: 60,
                            children: r(Qb, {
                                placeholder: "Paste URL here",
                                disabled: d,
                                validator: I => QI(I),
                                onApply: I => S(I),
                                isValidating: d
                            })
                        })
                    })]
                }), r(Jq, {
                    disabled: d,
                    onClick: w
                })]
            }), o.uri && p && !l && x(b, {
                paddingBottom: 16,
                children: [r($, {
                    display: "block",
                    padding: 16,
                    children: "Uploaded"
                }), r(Da, {
                    label: "Pixels",
                    value: `${Math.floor(f?.animationWidth||0)}\xD7${Math.floor(f?.animationHeight||0)}`
                }), r(Da, {
                    label: "Frames",
                    value: f.totalFrames
                }), r(Da, {
                    label: "Frame rate",
                    value: Math.round(f.frameRate)
                }), r(Da, {
                    label: "Duration",
                    value: `${EI(f.totalFrames/f.frameRate,1)} sec`
                })]
            })]
        })
    })
}

function $_({
    href: e
}) {
    return r(xs, {
        href: e,
        target: "_blank",
        children: r(dt, {
            css: Z `
          position: relative;
        `,
            color: "transparent",
            marginRight: 0,
            height: 24,
            width: 24,
            hoverColor: "darkGray",
            children: r($, {
                color: "gray",
                lineHeight: "24px",
                textStyle: "small",
                width: "100%",
                position: "absolute",
                top: "50%",
                transform: "translateY(-50%)",
                css: Z `
            &:hover {
              color: white;
            }
          `,
                children: "?"
            })
        })
    })
}

function Da({
    label: e,
    value: t
}) {
    return r(H, {
        dense: !0,
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            children: e
        }),
        rightSlot: r($, {
            textStyle: "small",
            whiteSpace: "nowrap",
            children: t
        })
    })
}

function Jq({
    onClick: e,
    disabled: t
}) {
    let o = (0, Aa.useRef)(null),
        i = Uf(o);
    return r(b, {
        padding: "0 16px",
        children: x(K, {
            ref: o,
            width: "100%",
            height: "56px",
            variant: "unstyled",
            display: "flex",
            alignItems: "center",
            onClick: e,
            disabled: t,
            children: [r($, {
                textStyle: "small",
                whiteSpace: "nowrap",
                color: t ? ce.gray : ce.black,
                opacity: i ? .8 : 1,
                children: "Random preset"
            }), r(b, {
                width: 56,
                height: 56,
                transform: i ? "rotate(-45deg)" : "",
                transition: "transform 0.1s linear",
                children: r(VI, {
                    color: ce.gray
                })
            })]
        })
    })
}
var Aa, Xq, M9, ey = k(() => {
    "use strict";
    Aa = E(N());
    nt();
    ae();
    Le();
    ht();
    ie();
    Be();
    id();
    Ih();
    mm();
    gn();
    Jr();
    ve();
    $e();
    rh();
    Jf();
    je();
    ut();
    jf();
    ad();
    sd();
    z_();
    B();
    Xq = new Yl;
    M9 = Kq
});

function R9(e) {
    return e.length > Mv ? `${e.slice(0,Mv)}..` : e
}

function qq(e) {
    let t = e.split(".");
    if (t.length > 1) {
        let o = "." + t.pop();
        return [t.join("."), o]
    }
    return [e, ""]
}
var gm, E9, F9 = k(() => {
    "use strict";
    gm = E(N());
    Be();
    ey();
    jf();
    ie();
    je();
    Zc();
    B();
    E9 = (0, gm.memo)(({
        widget: e,
        onReplace: t
    }) => {
        if (!e ? .url) return null;
        let o = (0, gm.useMemo)(() => e.provider_name, [e.provider_name]),
            i = (0, gm.useMemo)(() => {
                if (e.provider_name === "File" && e ? .file_meta ? .fileName) {
                    let [n, s] = qq(e.file_meta.fileName);
                    return x(Q, {
                        children: [r($, {
                            children: R9(n)
                        }), r($, {
                            color: "gray",
                            display: "inline-block",
                            children: s
                        })]
                    })
                }
                return R9(e.title)
            }, [e ? .file_meta ? .fileName, e.provider_name, e.title]);
        return x(b, {
            paddingBottom: "16px",
            children: [r(b, {
                margin: "9px 15px 13px 16px",
                wordBreak: "break-word",
                children: i
            }), x(b, {
                display: "flex",
                flexDirection: "column",
                justifyContent: "space-between",
                paddingRight: "2px",
                marginBottom: "9px",
                children: [o && o !== "File" && r(Da, {
                    label: "Source",
                    value: o
                }), o === "File" && e ? .file_meta ? .totalSize && r(Da, {
                    label: "Size",
                    value: Cp(e.file_meta.totalSize)
                }), o === "File" && r(Da, {
                    label: "Pixels",
                    value: `${e?.file_meta?.width} x ${e?.file_meta?.height}`
                }), o === "File" && e ? .file_meta ? .duration && r(Da, {
                    label: "Duration",
                    value: Xv(e.file_meta.duration)
                }), o !== "File" && e ? .duration && r(Da, {
                    label: "Duration",
                    value: Xv(e.duration)
                })]
            }), r(b, {
                display: "flex",
                justifyContent: "center",
                children: r(K, {
                    textStyle: "small",
                    height: "40px",
                    variant: "bordered",
                    width: "136px",
                    onClick: t,
                    children: "Replace"
                })
            })]
        })
    })
});

function D9({
    useSharedState: e
}) {
    let {
        model: t
    } = (0, Vi.useContext)(Y), {
        video_upload_limit: o
    } = (0, Vi.useMemo)(() => Xf.getPermissions(), []), i = o === 0, {
        model: n,
        modelSet: s,
        modelSave: a
    } = (0, Vi.useContext)(ge), [l, c] = (0, Vi.useState)(!1), [{
        isUploading: d,
        uploadError: p,
        lastSelectedVideoTypeTab: h = 0
    }, u] = e({
        partial: !0
    }), [m, f] = (0, Vi.useState)(null), [g, y] = (0, Vi.useState)(!1), S = (0, Vi.useRef)(), [w, v] = (0, Vi.useState)(n.provider_name ? n.provider_name === "File" ? 1 : 0 : h), C = t && t.page && t.page.workspace && t.page.workspace.controls && t.page.workspace.controls.findControl("video_controls"), I = (0, Vi.useCallback)(D => {
        D.preventDefault(), !t.disabled && t.select()
    }, [t.disabled]);
    (0, Vi.useEffect)(() => {
        u({
            isFileUploadVisible: t.selected
        })
    }, [t.selected]), (0, Vi.useEffect)(() => {
        let D = S.current;
        d && D ? .(1)
    }, [d]), (0, Vi.useEffect)(() => {
        p && S.current ? .(1)
    }, [p]);
    let T = D => {
            c(!1), D && u({
                fileToUpload: D
            })
        },
        P = D => rr.isVimeo(D) || rr.isYoutube(D),
        M = async D => {
            n.url !== D && (u({
                uploadError: void 0
            }), f(null), y(!0), rr.getEmbedData(D, O => {
                s({
                    thumbnail_url: O.thumbnail_url,
                    provider_name: O.provider_name,
                    url: D,
                    description: O.description,
                    duration: O.duration,
                    title: O.title,
                    file_meta: null,
                    video_styles: n.video_styles || zl,
                    video_id: rr.isYoutube(D) ? rr.getYoutubeIdFromUrl(D) : null,
                    controls: !1,
                    controls_type: "default"
                }), a(), De(Fe.WidgetVideoUpload, {
                    videoType: "url"
                })
            }, O => {
                console.info("uploading error", O), f("Wrong link format")
            }, () => y(!1)), v(0))
        },
        F = D => {
            u({
                lastSelectedVideoTypeTab: D
            }), D === 1 && i && Jo("video-upload")
        },
        R = () => {
            s({
                url: void 0,
                provider_name: void 0,
                description: "",
                title: "",
                thumbnail_url: "",
                file_meta: null
            }), a(), f(null), u({
                uploadError: void 0
            })
        };
    (0, Vi.useEffect)(() => {
        let D;
        return C && t.selected && (D = setTimeout(() => C.master.select(C), 1e3)), () => clearTimeout(D)
    }, [C]);
    let A = !!n.url;
    return r(Ie, {
        control: ({
            ref: D
        }) => r(ke, {
            ref: D,
            label: "Video file",
            onClick: I,
            children: r(Pp, {
                color: "white"
            })
        }),
        panel: ({
            ref: D,
            style: O
        }) => r(Me, {
            ref: D,
            style: O,
            isShowed: t.selected,
            children: A ? r(E9, {
                widget: n,
                onReplace: R
            }) : x(Q, {
                children: [r(Ut, {
                    showBorder: !1,
                    leftSlot: r($, {
                        children: "Video"
                    })
                }), x(hc, {
                    labels: ["URL", "File"],
                    padding: "0 16px",
                    initialIndex: w,
                    backgroundColor: ce.gray,
                    activeTabColor: ce.black,
                    textColor: ce.white,
                    activeTextColor: ce.white,
                    disabled: i,
                    onTabChange: F,
                    tabSwitcherRef: S,
                    children: [r(Hs, {
                        index: 0,
                        children: x(b, {
                            padding: "16px",
                            height: 126,
                            display: "flex",
                            flexDirection: "column",
                            justifyContent: "space-between",
                            children: [r(Qb, {
                                initialValue: n.provider_name === "File" ? "" : n.url,
                                placeholder: "Paste URL here",
                                disabled: !1,
                                validator: L => P(L),
                                onApply: L => M(L),
                                onClearInput: R,
                                isValidating: g,
                                externalError: !!m
                            }), !n ? .url && r(b, {
                                children: r($, {
                                    textStyle: "small",
                                    color: "gray",
                                    children: "Youtube or Vimeo"
                                })
                            })]
                        })
                    }), r(Hs, {
                        index: 1,
                        children: r(vi, {
                            id: `video-file-upload-${n._id}`,
                            readFileData: !1,
                            onChange: T,
                            disabled: d,
                            dropFile: !d,
                            accept: rr.allowedVideoFormats.join(", "),
                            children: r(b, {
                                padding: "16px",
                                display: "flex",
                                flexDirection: "column",
                                justifyContent: "center",
                                children: r(b, {
                                    borderRadius: 8,
                                    minHeight: "100px",
                                    cursor: d ? "not-allowed" : "pointer",
                                    backgroundColor: l ? "rgba(112, 112, 112, 0.2)" : "transparent",
                                    display: "flex",
                                    justifyContent: "center",
                                    alignItems: "center",
                                    onDragOver: () => c(!0),
                                    onDragLeave: () => c(!1),
                                    css: Z `
                          &:hover {
                            opacity: 0.8;
                          }
                        `,
                                    children: l && !d ? r($, {
                                        as: "div",
                                        textStyle: "small",
                                        color: "#0080FF",
                                        textAlign: "center",
                                        children: "Drop me here!"
                                    }) : p ? x(b, {
                                        display: "flex",
                                        flexDirection: "column",
                                        justifyContent: "center",
                                        children: [r($, {
                                            textAlign: "center",
                                            textStyle: "small",
                                            color: "red",
                                            marginBottom: "12px",
                                            children: p
                                        }), r($, {
                                            onClick: L => {
                                                L.preventDefault(), R()
                                            },
                                            textStyle: "small",
                                            textAlign: "center",
                                            color: "black",
                                            cursor: "pointer",
                                            children: "Okay"
                                        })]
                                    }) : r($, {
                                        as: "div",
                                        textStyle: "small",
                                        color: "#0080FF",
                                        textAlign: "center",
                                        "data-testid": "upload-link",
                                        children: d ? r(Q, {
                                            children: "Uploading file"
                                        }) : x(Q, {
                                            children: ["Drop here", r("br", {}), ".mp4 or .mov"]
                                        })
                                    })
                                })
                            })
                        })
                    })]
                })]
            })
        })
    })
}
var Vi, A9 = k(() => {
    "use strict";
    ht();
    ad();
    nt();
    gn();
    Be();
    mm();
    ut();
    id();
    ie();
    ve();
    Vi = E(N());
    Le();
    Qv();
    ae();
    Zc();
    Xs();
    XI();
    F9();
    z_();
    qt();
    B()
});
var Qq, L9, z9 = k(() => {
    "use strict";
    ae();
    A9();
    Qq = Ce.extend({
        name: "video_settings",
        component: D9
    }), L9 = Qq
});
var bo, La = k(() => {
    "use strict";
    je();
    ve();
    bo = ue(K)
    `
  padding: 0;

  &:hover,
  &:focus {
    color: ${({hoverColor:e,theme:t})=>t.colors[e]??e};
  }
`;
    bo.defaultProps = {
        color: "gray",
        hoverColor: "white",
        variant: "unstyled"
    }
});
var ty, W_, O_, j_, bm, eQ, XLe, KLe, Lr, H_ = k(() => {
    "use strict";
    wa();
    ty = E(To());
    Wo();
    bm = {
        enterPickTriggerMode(e, t, o = [], i) {
            j_ = (n, s) => {
                if (bm.canBeATrigger(n, t, o)) {
                    s.stopPropagation();
                    let a = n.id;
                    bm.highlightActiveTriggerBlock(e, t, a, !1, !1), i(a)
                }
            }, W_ = n => {
                let s = e.findBlock(n);
                s && bm.canBeATrigger(s, t, o) && s && s.highlight(!0, ft.ACTIVE_TRIGGER_HIGHLIGHT_CLASS)
            }, O_ = n => {
                let s = e.findBlock(n);
                s && s.highlight(!1, ft.ACTIVE_TRIGGER_HIGHLIGHT_CLASS)
            }, e.on("block:click", j_), e.on("block:mouseenter", W_), e.on("block:mouseleave", O_)
        },
        leavePickTriggerMode(e) {
            e.off("block:click", j_), e.off("block:mouseenter", W_), e.off("block:mouseleave", O_)
        },
        canBeATrigger(e, t, o = []) {
            return !ft.EXTERNAL_TRIGGER_BLOCK_EXCLUDE.includes(e.model.attributes.type) && !o.includes(e.id) && bm.canBeExternalTrigger(e)
        },
        canBeExternalTrigger(e) {
            let t = e.attributes || e.model.attributes || {};
            return t.type && ft.EXTERNAL_TRIGGER_BLOCK_EXCLUDE.indexOf(t.type) === -1
        },
        highlightActiveTriggerBlock(e, t, o, i, n) {
            let s = o && e.findBlock(o),
                a = t.id === o && e.getPackBlocks(t.model.get("pack_id")).length === 1,
                l = n ? ft.ACTIVE_TRIGGER_REMOVE_CLASS : ft.ACTIVE_TRIGGER_HIGHLIGHT_CLASS;
            s && s.highlight(i, l);
            let c = t.triggerAssets && t.triggerAssets[o];
            if (c) {
                let d = a ? t.ownTooltip && t.ownTooltip.getElement() : c.tooltip && c.tooltip.getElement();
                d && d.toggleClass(l, !!i)
            }
        }
    }, eQ = e => {
        let t = ft.normalizeAnimations(e.animation ? ? []),
            o = e.interactions ? ? [];
        return [...t.reduce((i, n) => n.trigger ? [...i, ...ft.normalizeAnimationTriggers(n && n.trigger)] : i, []), ...o.reduce((i, n) => n.triggers ? [...i, ...n.triggers] : i, []), ...e.triggers || []]
    }, XLe = e => {
        let t = e.map(o => o instanceof ty.default.View ? o.id : o._id);
        return e.reduce((o, i) => {
            let n = i instanceof ty.default.View ? i.model.toJSON() : i;
            return Oe.viewport_listall.forEach(s => {
                let a = s === "viewport_default" ? n : n[s];
                if (a) {
                    let l = eQ(a);
                    if (l.length && _.intersection(t, l).length) {
                        let c = i instanceof ty.default.View ? i.id : i._id;
                        o.indexOf(c) < 0 && o.push(c)
                    }
                }
            }), o
        }, [])
    }, KLe = (e, t, o) => {
        let i = [],
            n = s => {
                let a = [];
                for (let l of s) t[l] && a.push(t[l]);
                return a
            };
        return e.forEach(s => {
            let a = t[s],
                l = o.find(p => p.id === a),
                c = l.model.toJSON(),
                d = !1;
            Oe.viewport_listall.forEach(p => {
                let h = VC(p),
                    u = p === "viewport_default" ? c : c[p],
                    m = l.model.clone({
                        viewport: h
                    });
                if (u && u.animation && ft.normalizeAnimations(u.animation).forEach(g => {
                        let y = g.trigger || [];
                        if (y && y.length > 0) {
                            let S = ft.normalizeAnimationTriggers(y);
                            g.trigger = n(S), d = !0
                        }
                    }), u ? .interactions && m.get("interactions").forEach(g => {
                        let y = g.triggers;
                        y && y.length > 0 && (g.triggers = n(y), d = !0)
                    }), u ? .triggers) {
                    let f = m.get("triggers");
                    f && (m.set("triggers", n(f), {
                        silent: !0
                    }), d = !0)
                }
            }), d && i.push(l)
        }), i
    }, Lr = bm
});

function Tu({
    block: e,
    workspace: t,
    triggers: o,
    onTriggerClick: i
}) {
    let [n, s] = (0, mc.useState)("idle"), a = Xl(p => {
        i && (i(p), s("idle"))
    });
    (0, mc.useEffect)(() => (n === "pending" && Lr.enterPickTriggerMode(t, e, o, a), () => {
        n === "pending" && Lr.leavePickTriggerMode(t)
    }), [n, e, t, o]);
    let l = (0, mc.useCallback)(p => h => {
            Lr.highlightActiveTriggerBlock(t, e, h, !1, !0), p(h)
        }, [e, t]),
        c = (0, mc.useCallback)((p, h = !1) => ({
            onMouseOver: () => {
                Lr.highlightActiveTriggerBlock(t, e, p, !0, h)
            },
            onMouseOut: () => {
                Lr.highlightActiveTriggerBlock(t, e, p, !1, h)
            }
        }), [t, e]),
        d = (0, mc.useCallback)(p => {
            let h = t.findBlock(p),
                u = h ? null : t.mag.getWidgetPage(p),
                m = u ? .id !== t.page.id,
                f = p === e.id,
                g;
            return f ? g = "Self" : h ? g = h.model.get("name") || h.getStandardName() : m && u ? g = `Trigger on p. ${u.attributes.num}` : g = "Trigger", {
                label: g,
                page: u ? .attributes ? .num,
                id: p
            }
        }, [t, e]);
    return {
        status: n,
        setStatus: s,
        removeTrigger: l,
        getTriggerHoverProps: c,
        getTriggerData: d
    }
}
var mc, oy = k(() => {
    "use strict";
    mc = E(N());
    H_();
    jn()
});

function $9() {
    let [e, t] = (0, sa.useState)(!1), {
        model: o,
        modelSet: i
    } = (0, sa.useContext)(Y), {
        model: n,
        modelSave: s
    } = (0, sa.useContext)(ge), a = (0, sa.useRef)();
    Gl(() => {
        n.triggers ? .length && n.triggers.length > tQ && a.current && a.current.scrollTo({
            top: a.current.scrollHeight,
            behavior: "smooth"
        })
    }, [n.triggers ? .length]);

    function l(T) {
        let P = n.triggers || [];
        P.push(T), P = [...new Set(P)], s({
            triggers: P
        }), t(!0), o.model.trigger("animation:trigger:add")
    }

    function c(T) {
        if (!Array.isArray(n.triggers)) return;
        let P = n.triggers.filter(M => M !== T);
        s({
            triggers: P
        })
    }
    let {
        status: d,
        setStatus: p,
        getTriggerHoverProps: h,
        removeTrigger: u,
        getTriggerData: m
    } = Tu({
        block: o.block,
        workspace: o.workspace,
        triggers: n.triggers || [],
        onTriggerClick: T => {
            l(T)
        }
    }), f = d === "pending";

    function g() {
        p(f ? "idle" : "pending")
    }(0, sa.useEffect)(() => {
        i({
            preventClose: f
        })
    }, [f]);
    let y = !!n.triggers ? .length;

    function S(T, P) {
        window.RM.constructorRouter.once("pageChange", M => {
            let F = M.blocks.find(R => R.id === T);
            F && F.onClick()
        }), window.RM.constructorRouter.showWorkspace({
            num: P
        })
    }
    let w = u(T => {
            c(T), o.model.trigger("animation:trigger:remove")
        }),
        v = (0, sa.useMemo)(() => n.triggers ? .map(T => m(T)) || [], [n.triggers, m]),
        C = x(bo, {
            width: "100%",
            display: "flex",
            textStyle: "small",
            alignItems: "center",
            hoverColor: "black",
            justifyContent: "space-between",
            color: f ? "blue" : "darkGray",
            onClick: () => g(),
            children: [f ? "Choose widget" : y ? "Add" : "Trigger", f ? r(Bi, {}) : r(Qt, {})]
        });
    return x(Q, {
        children: [r(H, {
            showBorder: !1,
            leftSlot: y ? x(b, {
                role: "button",
                display: "flex",
                cursor: "pointer",
                marginLeft: -6,
                alignItems: "center",
                onClick: () => t(!e),
                children: [r(Lt, {
                    transform: `rotate(${e?"0deg":"-90deg"})`,
                    color: "black"
                }), r($, {
                    textStyle: "small",
                    userSelect: "none",
                    children: "Triggers"
                })]
            }) : C
        }), r(wo, {
            initial: !1,
            children: e && y ? x(oQ, {
                exit: {
                    height: 0
                },
                initial: {
                    height: 0
                },
                animate: {
                    height: "auto"
                },
                children: [r(b, {
                    maxHeight: 96,
                    children: r(xo, {
                        alwaysActiveBar: !0,
                        onFirstRender: T => a.current = T,
                        children: ({
                            ref: T
                        }) => r(b, {
                            ref: T,
                            children: v.map(({
                                label: P,
                                id: M,
                                page: F
                            }) => r(H, {
                                dense: !0,
                                showBorder: !1,
                                leftSlot: r(iQ, {
                                    variant: "clean",
                                    textStyle: "small",
                                    role: F ? "button" : void 0,
                                    cursor: F ? "pointer" : "auto",
                                    ...h(M),
                                    onClick: () => F ? S(M, F) : void 0,
                                    children: P
                                }),
                                rightSlot: r(bo, {
                                    hoverColor: "black",
                                    onClick: () => {
                                        w(M)
                                    },
                                    ...h(M, !0),
                                    children: r(Bi, {})
                                })
                            }, M))
                        })
                    })
                }), r(H, {
                    dense: !0,
                    showBorder: !1,
                    leftSlot: C
                })]
            }) : null
        })]
    })
}
var sa, tQ, oQ, iQ, W9 = k(() => {
    "use strict";
    La();
    Nl();
    Cr();
    ie();
    en();
    Be();
    sa = E(N());
    $e();
    oy();
    ae();
    Li();
    or();
    ve();
    Le();
    sd();
    B();
    tQ = 3, oQ = wt(ue(b)
        `
  overflow: hidden;
`), iQ = ue($)
    `
  width: 100%;
  &:hover {
    color: ${e=>e.theme.colors.blue};
  }
`
});
var O9, za, j9, H9, ym = k(() => {
    "use strict";
    O9 = "https://help.readymag.com/hc/en-us/articles/360020527132-Fixed-and-positioned-widgets", za = ["nw", "n", "ne", "w", "c", "e", "sw", "s", "se"], j9 = ["shape", "picture", "video", "iframe", "rmfooter", "rmheader", "shots"], H9 = ["shape", "picture", "video", "iframe", "shots"]
});

function N9() {
    let {
        model: e,
        modelSet: t
    } = (0, $a.useContext)(ge), {
        model: o
    } = (0, $a.useContext)(Y), [i, n] = (0, $a.useState)(!1), [s, a] = (0, $a.useState)(e.custom_controls.position), [l, c] = (0, $a.useState)(null), d = o.workspace.viewport !== "default", p = g => o.groupSetAndSave({
        custom_controls: { ...e.custom_controls,
            ...g
        }
    }), h = () => {
        s || a("c"), n(!0)
    }, u = () => {
        p({
            position: s
        })
    }, m = () => {
        u(), n(!1)
    };
    (0, $a.useEffect)(() => (s !== e.custom_controls.position && u(), () => {
        u()
    }), [s]), (0, $a.useEffect)(() => {
        l && t({
            custom_controls: { ...e.custom_controls,
                position: l
            }
        })
    }, [l]);
    let f = Bp({
        watchingClick: i,
        callback: m
    });
    return x(b, {
        ref: f,
        display: "flex",
        justifyContent: "space-between",
        alignItems: "center",
        padding: "0 17px",
        height: "40px",
        position: "relative",
        children: [r(b, {
            children: r($, {
                textStyle: "small",
                lineHeight: "24px",
                children: "Position"
            })
        }), i && r(rQ, {
            activePosition: s,
            onPositionSelect: g => {
                a(g), n(!1)
            },
            onPositionPreselect: g => c(g)
        }), x(b, {
            display: "flex",
            flexDirection: "row",
            justifyContent: "space-between",
            alignItems: "center",
            children: [r(b, {
                cursor: "pointer",
                onClick: () => {
                    p({
                        position: null
                    }), a(null)
                },
                children: !d && r(Pf, {
                    color: s === null ? "blue" : "gray"
                })
            }), r(nQ, {
                onClick: h,
                activePosition: s
            })]
        })]
    })
}

function nQ({
    activePosition: e,
    onClick: t
}) {
    return r(b, {
        display: "grid",
        gridTemplateColumns: "repeat(3, 5px)",
        rowGap: "4px",
        columnGap: "4px",
        onClick: t,
        cursor: "pointer",
        margin: "0 1px 0 10px",
        children: za.map(o => r(aQ, {
            active: o === e
        }, `preview-${o}`))
    })
}

function rQ({
    activePosition: e,
    onPositionSelect: t,
    onPositionPreselect: o
}) {
    return r(b, {
        position: "absolute",
        backgroundColor: ce.white,
        width: "169px",
        height: "110px",
        padding: "16px",
        borderWidth: "1px 0",
        borderStyle: "solid",
        borderColor: "rgba(162, 162, 162, 0.16)",
        borderRadius: "4px",
        left: "calc(50% - 85px)",
        zIndex: "5",
        children: r(b, {
            display: "grid",
            gridTemplateColumns: "repeat(3, 24px)",
            rowGap: "4px",
            columnGap: "8px",
            float: "right",
            children: za.map(i => r(sQ, {
                active: i === e,
                onClick: () => t(i),
                onMouseOver: () => o(i)
            }, i))
        })
    })
}
var $a, sQ, aQ, U9 = k(() => {
    "use strict";
    ie();
    ym();
    O0();
    Be();
    $a = E(N());
    ae();
    Le();
    ut();
    ve();
    ew();
    B();
    sQ = b.withComponent(ue(b)
        `
  width: 24px;
  height: 24px;
  cursor: pointer;
  border-radius: 100%;
  box-shadow: inset 0 0 0 1px rgba(162, 162, 162, 0.24);
  ${e=>e.active?{backgroundColor:e.theme.colors.blue,boxShadow:"none"}:{backgroundColor:e.theme.colors.white}};
  &:hover {
    cursor: pointer;
    background-color: rgba(0, 128, 255, 0.2);
    box-shadow: none;
  }
`), aQ = b.withComponent(ue(b)
        `
  width: 5px;
  height: 5px;
  border-radius: 100%;
  background-color: ${e=>e.active?e.theme.colors.blue:e.theme.colors.gray};
`)
});

function V9({
    label: e,
    onClick: t
}) {
    return r(K, {
        onClick: t,
        children: r(lQ, {
            as: "div",
            textStyle: "small",
            children: e
        })
    })
}

function Y9() {
    let {
        model: e,
        modelSet: t
    } = (0, Zn.useContext)(Y), {
        model: o
    } = (0, Zn.useContext)(ge), {
        navigate: i
    } = (0, Zn.useContext)(Jt), {
        dropdownContainer: n
    } = (0, Zn.useContext)(Ot), s = e.workspace.viewport !== "default", [a, l] = (0, Zn.useState)(o ? .custom_controls ? .playbackType === "Click" ? 0 : o ? .custom_controls ? .playbackType === "Hover" ? 1 : 2), c = o.custom_controls ? .type || t0, [d, p] = (0, Zn.useState)(c === "Icon" ? 1 : 0), [h, u] = (0, Zn.useState)(() => o.custom_controls ? .autoHide ? ? n0), m = (0, Zn.useMemo)(() => e.project.get("_id"), [e.project]), f = (0, Zn.useMemo)(() => e.user.get("_id"), [e.user]), g = (0, Zn.useMemo)(() => o ? .controls, [o ? .controls]), y = T => t({
        preventClose: T
    }), S = () => l((a + 1) % Object.values(Rv).length), w = () => p((d + 1) % wf.length), v = T => {
        T === 0 ? C({
            controls_type: "custom"
        }) : T === 1 && C({
            controls_type: "default"
        })
    }, C = T => e.groupSetAndSave(T);
    (0, Zn.useEffect)(() => {
        C({
            custom_controls: { ...o.custom_controls,
                type: wf[d],
                playbackType: Object.values(Rv)[a],
                autoHide: h
            }
        })
    }, [a, d, h]), (0, Zn.useEffect)(() => {
        o.controls && l(0)
    }, [o.controls]);
    let I = s ? e0[o.custom_controls ? .playbackType] : Qk[o.custom_controls ? .playbackType];
    return x(b, {
        margin: "8px 0px",
        children: [x(b, {
            width: "100%",
            height: 24,
            marginBottom: "8px",
            padding: "0 16px",
            display: "flex",
            justifyContent: "space-between",
            textTransform: "capitalize",
            userSelect: "none",
            children: [r($, {
                textStyle: "small",
                lineHeight: "24px",
                children: "Controls"
            }), r(Ve, {
                backgroundChecked: "black",
                checked: g,
                onChange: T => C({
                    controls: T
                })
            })]
        }), g ? x(hc, {
            labels: ["Custom", "Default"],
            padding: "3px 16px",
            marginBottom: o.controls_type === "custom" ? "20px" : "13px",
            initialIndex: o.controls_type === "custom" ? 0 : 1,
            backgroundColor: ce.gray,
            activeTabColor: ce.black,
            textColor: ce.white,
            activeTextColor: ce.white,
            onTabChange: T => v(T),
            children: [r(Hs, {
                index: 0,
                children: x(b, {
                    margin: "-18px 0 -4px 0",
                    children: [r(H, {
                        showBorder: !1,
                        leftSlot: "Control type",
                        rightSlot: r(V9, {
                            label: c,
                            onClick: w
                        })
                    }), r(N9, {}), r(H, {
                        showBorder: !1,
                        leftSlot: "Hide on playback",
                        rightSlot: r(V9, {
                            label: h ? "Auto" : "Off",
                            onClick: () => u(!h)
                        })
                    }), r(qe, {
                        disabled: !1,
                        container: n,
                        title: "Color",
                        projectId: m,
                        userId: f,
                        setColor: T => T && C({
                            custom_controls: { ...o.custom_controls,
                                controlColor: T
                            }
                        }),
                        showBorder: !1,
                        color: o.custom_controls ? .controlColor || ap
                    }), wf[d] === "Text" && x(b, {
                        width: "100%",
                        children: [r(tl, {
                            showBorder: !1,
                            fontFamily: o.custom_controls ? .fontFamily || St.fontFamily,
                            onClick: () => i("FontsList")
                        }), r(Fa, {
                            showBorder: !1,
                            fontFamily: o.custom_controls ? .fontFamily || St.fontFamily,
                            fontWeight: [o.custom_controls ? .fontWeight || St.fontWeight],
                            fontStyle: [o.custom_controls ? .fontStyle || St.fontStyle],
                            mixed: !1,
                            dropdownContainer: n,
                            onToggleSelectPanel: y,
                            onChangeStyle: T => C({
                                custom_controls: { ...o.custom_controls,
                                    fontWeight: T ? .weight || 400,
                                    fontStyle: T ? .style || "normal"
                                }
                            })
                        }), r(H, {
                            leftSlot: "Letter spacing",
                            showBorder: !1,
                            rightSlot: r(b, {
                                display: "flex",
                                gap: 8,
                                alignItems: "center",
                                children: r(fe, {
                                    min: -99,
                                    max: 999,
                                    step: .1,
                                    value: o.custom_controls ? .letterSpacing || 0,
                                    isMixedValue: !1,
                                    textStyle: "subheading",
                                    textAlign: "right",
                                    autoWidth: !0,
                                    onChange: ({
                                        value: T
                                    }) => C({
                                        custom_controls: { ...o.custom_controls,
                                            letterSpacing: T
                                        }
                                    })
                                })
                            })
                        })]
                    }), r(H, {
                        leftSlot: "Size",
                        showBorder: !1,
                        rightSlot: r(b, {
                            display: "flex",
                            gap: 8,
                            alignItems: "center",
                            children: r(fe, {
                                min: 0,
                                max: 999,
                                value: c === "Icon" ? o.custom_controls ? .size ? ? o0 : o.custom_controls ? .fontSize ? ? i0,
                                isMixedValue: !1,
                                textStyle: "subheading",
                                textAlign: "right",
                                autoWidth: !0,
                                onChange: ({
                                    value: T
                                }) => C({
                                    custom_controls: { ...o.custom_controls,
                                        ...c === "Icon" ? {
                                            size: T
                                        } : {
                                            fontSize: T
                                        }
                                    }
                                })
                            })
                        })
                    })]
                })
            }), r(Hs, {
                index: 1
            })]
        }) : x(Q, {
            children: [r(H, {
                showBorder: !1,
                leftSlot: "Play or Pause",
                rightSlot: r(b, {
                    marginTop: "-3px",
                    width: "max-content",
                    userSelect: "none",
                    children: r(K, {
                        onClick: S,
                        "data-testid": "video-playback-toggle",
                        children: r($, {
                            color: "blue",
                            textStyle: "small",
                            children: I || o.custom_controls ? .playbackType
                        })
                    })
                })
            }), o.custom_controls ? .playbackType !== "None" && r($9, {})]
        })]
    })
}
var Zn, G9, lQ, Z9 = k(() => {
    "use strict";
    Zn = E(N());
    ie();
    Be();
    Hi();
    mm();
    ut();
    je();
    ol();
    um();
    _s();
    ae();
    Le();
    ni();
    nt();
    N_();
    nn();
    zt();
    Zc();
    $e();
    W9();
    Zd();
    U9();
    B();
    G9 = ue(b)
    `
  height: 0;
  margin: 0 16px;
  border-bottom: 2px solid rgba(162, 162, 162, 0.24);
`, lQ = ue($)
    `
  color: ${e=>e.theme.colors.blue};
`
});
var r8e, Bu, iy = k(() => {
    "use strict";
    r8e = async (e, t) => {
        let o = new FormData;
        return o.append("name", e), o.append("upload", t), await fetch("/api/upload", {
            headers: {
                "cache-control": "no-cache"
            },
            method: "post",
            body: o
        }).then(i => i.json())
    }, Bu = async (e, t) => {
        let o = new FormData;
        return o.append("name", e), o.append("upload", t), await fetch("/api/upload/lambda", {
            headers: {
                "cache-control": "no-cache"
            },
            method: "post",
            body: o
        }).then(i => i.json())
    }
});

function K9() {
    let {
        model: e,
        modelSet: t,
        modelSave: o
    } = (0, aa.useContext)(ge), [i, n] = (0, aa.useState)(!1), [s, a] = (0, aa.useState)(!1), [l, c] = (0, aa.useState)(""), d = (0, aa.useMemo)(() => e.provider_name === "Vimeo", [e.provider_name]), p = h => {
        if (h.size > de.UPLOAD_IMAGE_SIZE_LIMIT) {
            c(`Please upload file smaller than ${Cp(de.UPLOAD_IMAGE_SIZE_LIMIT)}`);
            return
        } else c("");
        n(!0), Bu("widget-video-thumbnail", h).then(u => {
            t({
                picture: u.picture
            })
        }).catch().finally(() => {
            n(!1), o()
        })
    };
    return i ? r(b, {
        marginTop: "40px",
        display: "flex",
        justifyContent: "center",
        children: r(_o, {
            size: "medium",
            bgColor: "gray",
            color: "white"
        })
    }) : e ? .picture ? .lambdaUrl ? x(Q, {
        children: [r(vi, {
            id: `video-thumbnail-file-upload-${e._id}`,
            cursor: i ? "default" : "pointer",
            readFileData: !1,
            onChange: p,
            dropFile: !i,
            accept: "image/png, image/jpg, image/jpeg, image/webp",
            children: x(b, {
                marginTop: "24px",
                marginBottom: d ? "-16px" : 0,
                borderRadius: 8,
                width: "136px",
                height: "96px",
                display: "flex",
                overflow: "hidden",
                position: "relative",
                children: [r(b, {
                    position: "absolute",
                    top: "50%",
                    left: "50%",
                    zIndex: 2,
                    transform: "translate(-50%, -50%)",
                    children: r(cQ, {})
                }), r("img", {
                    style: {
                        filter: "brightness(0.75)",
                        objectFit: "cover"
                    },
                    width: "100%",
                    height: "100%",
                    src: e.picture.lambdaUrl || e.picture.url,
                    alt: "video thumbnail"
                })]
            })
        }), r(X9, {
            errorMessage: l
        })]
    }) : x(Q, {
        children: [r(vi, {
            id: `video-thumbnail-file-upload-${e._id}`,
            cursor: i ? "default" : "pointer",
            readFileData: !1,
            onChange: p,
            dropFile: !i,
            accept: "image/png, image/jpg, image/jpeg, image/webp",
            children: r(b, {
                padding: "16px",
                paddingBottom: 0,
                children: r(b, {
                    borderRadius: 8,
                    minHeight: "100px",
                    backgroundColor: s ? "rgba(112, 112, 112, 0.2)" : "transparent",
                    display: "flex",
                    justifyContent: "center",
                    alignItems: "center",
                    onDragOver: () => a(!0),
                    onDragLeave: () => a(!1),
                    css: Z `
              &:hover {
                opacity: 0.8;
              }
            `,
                    children: s ? r($, {
                        as: "div",
                        textStyle: "small",
                        color: "#0080FF",
                        textAlign: "center",
                        children: "Drop me here!"
                    }) : x($, {
                        as: "div",
                        textStyle: "small",
                        color: "#0080FF",
                        textAlign: "center",
                        children: ["Drop here", r("br", {}), ".jpeg", r("br", {}), "or", r("br", {}), ".png"]
                    })
                })
            })
        }), r(X9, {
            errorMessage: l
        })]
    })
}
var aa, X9, cQ, J9 = k(() => {
    "use strict";
    id();
    ie();
    ve();
    Be();
    aa = E(N());
    Le();
    iy();
    Bs();
    Mt();
    jf();
    B();
    X9 = (0, aa.memo)(({
        errorMessage: e
    }) => e ? r(b, {
        margin: "8px 0",
        display: "flex",
        justifyContent: "center",
        children: r($, {
            textAlign: "center",
            textStyle: "small",
            color: "red",
            children: e
        })
    }) : null), cQ = (0, aa.memo)(() => x("svg", {
        width: "56",
        height: "56",
        viewBox: "0 0 56 56",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M14.6544 23.3013C14.6074 23.9127 15.1167 24.422 15.7281 24.375L21.5895 23.9241C22.4413 23.8586 22.824 22.8241 22.2199 22.22L16.8094 16.8095C16.2053 16.2054 15.1708 16.5881 15.1053 17.4399L14.6544 23.3013Z",
            fill: "#FFF"
        }), r("path", {
            d: "M35.7929 20.2071C36.1834 20.5976 36.8166 20.5976 37.2071 20.2071C37.5976 19.8166 37.5976 19.1834 37.2071 18.7929L35.7929 20.2071ZM20.2071 20.2071C24.511 15.9032 31.489 15.9032 35.7929 20.2071L37.2071 18.7929C32.1222 13.7079 23.8778 13.7079 18.7929 18.7929L20.2071 20.2071Z",
            fill: "#FFF"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M41.497 32.6987C41.544 32.0873 41.0347 31.578 40.4232 31.625L34.5619 32.0759C33.7101 32.1414 33.3274 33.1759 33.9315 33.78L39.3419 39.1905C39.9461 39.7946 40.9806 39.4119 41.0461 38.5601L41.497 32.6987Z",
            fill: "#FFF"
        }), r("path", {
            d: "M20.3585 35.7929C19.968 35.4024 19.3348 35.4024 18.9443 35.7929C18.5537 36.1834 18.5537 36.8166 18.9443 37.2071L20.3585 35.7929ZM35.9443 35.7929C31.6404 40.0968 24.6624 40.0968 20.3585 35.7929L18.9443 37.2071C24.0292 42.2921 32.2735 42.2921 37.3585 37.2071L35.9443 35.7929Z",
            fill: "#FFF"
        })]
    }))
});

function q9() {
    let {
        model: e
    } = (0, U_.useContext)(ge), {
        model: t
    } = (0, U_.useContext)(Y), o = e.video_styles || zl, i = {
        color: o.color,
        borders: o.borders,
        opacity: o.opacity
    }, n = {
        radius: o.radius,
        radius_rect_tl: o.radius_rect_tl,
        radius_rect_tr: o.radius_rect_tr,
        radius_rect_bl: o.radius_rect_bl,
        radius_rect_br: o.radius_rect_br,
        radius_rect_independent: o.radius_rect_independent
    }, s = a => {
        t.groupSetAndSave({
            video_styles: { ...o,
                ...a
            }
        })
    };
    return x(b, {
        marginTop: "8px",
        children: [r(hu, {
            onChange: a => s(a),
            values: i,
            isGroupSelected: !1,
            models: [i],
            panelProps: {
                showBorder: !1
            }
        }), r(mu, {
            onChange: a => s(a),
            isGroupSelected: !1,
            panelProps: {
                showBorder: !1
            },
            values: n,
            models: [n]
        }), r(H, {
            leftSlot: "Opacity",
            showBorder: !1,
            rightSlot: r(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                "data-testid": "picture-parameters-opacity",
                children: r(fe, {
                    min: 0,
                    step: 1,
                    max: 100,
                    autoWidth: !0,
                    textStyle: "subheading",
                    value: o.video_opacity,
                    onChange: ({
                        value: a
                    }) => t.groupSetAndSave({
                        video_styles: { ...o,
                            video_opacity: a
                        }
                    }),
                    isMixedValue: !1
                })
            })
        })]
    })
}
var U_, Q9 = k(() => {
    "use strict";
    Pb();
    Tb();
    $e();
    ie();
    zt();
    U_ = E(N());
    Le();
    ae();
    Zc();
    B()
});

function e3() {
    let {
        model: e
    } = (0, Cn.useContext)(ge), {
        model: t
    } = (0, Cn.useContext)(Y), [o, i] = (0, Cn.useState)(!1), n = (0, Cn.useMemo)(() => t.project.get("_id"), [t]), s = (0, Cn.useMemo)(() => t.user.get("_id"), [t]), a = (0, Cn.useCallback)(m => {
        m.preventDefault(), !t.disabled && t.select()
    }, [t.disabled]);
    (0, Cn.useEffect)(() => {
        t.selected ? i(!0) : o && (i(!1), dQ(e))
    }, [t.selected, e]);
    let l = (m, f) => {
        f === "autoplay" && m && t.groupSetAndSave({
            mute: !0,
            custom_thumbnail: !1
        }), t.groupSetAndSave({
            [f]: m
        })
    };
    (0, Cn.useEffect)(() => {
        e.custom_controls ? .playbackType === "None" && t.groupSetAndSave({
            mute: !0,
            autoplay: !0,
            custom_thumbnail: !1
        })
    }, [e.custom_controls ? .playbackType]);
    let c = (0, Cn.useRef)(null),
        {
            onStackUpdated: d
        } = As(c.current),
        p = (0, Cn.useMemo)(() => r(Ut, {
            showBorder: !1,
            leftSlot: r(K, {
                variant: "clean",
                onClick: () => c.current && c.current.goBack(),
                css: Z `
              &:hover svg {
                color: ${ce.black};
                opacity: 1;
              }
            `,
                children: r(_r, {
                    color: "darkGray"
                })
            })
        }), []),
        h = (0, Cn.useMemo)(() => t.blocks.map(m => m.model.attributes.custom_controls ? .fontFamily), [t.blocks, e.custom_controls ? .fontFamily]),
        u = m => {
            let f = m.variations.includes("n4") ? "n4" : m.variations[0],
                {
                    style: g,
                    weight: y
                } = tr(f);
            t.groupSetAndSave({
                custom_controls: { ...e.custom_controls,
                    fontFamily: m.css_name,
                    fontWeight: y,
                    fontStyle: g
                }
            }), c.current && c.current.goBack()
        };
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: m
        }) => r(ke, {
            ref: m,
            label: "Video settings",
            onClick: a,
            children: r(Hl, {
                color: "white"
            })
        }),
        panel: ({
            ref: m,
            style: f,
            update: g
        }) => t.selected ? x(Pr, {
            ref: c,
            initialScreen: "Settings",
            onStackUpdated: d,
            onNavigate: g,
            children: [r(lo, {
                screen: "Settings",
                children: r(Me, {
                    ref: m,
                    style: f,
                    isShowed: t.selected,
                    scrollable: !0,
                    maxHeight: yh(window.innerHeight - 50),
                    children: r(Ot.Consumer, {
                        children: ({
                            dropdownContainer: y
                        }) => x(Q, {
                            children: [r(Ut, {
                                showBorder: !1,
                                leftSlot: r($, {
                                    children: "Player"
                                }),
                                rightSlot: r($_, {
                                    href: qk
                                })
                            }), e ? .provider_name === "File" && x(Q, {
                                children: [r(Y9, {}), r(G9, {})]
                            }), x(H, {
                                showBorder: !0,
                                children: [x(b, {
                                    marginBottom: "-16px",
                                    children: [x(b, {
                                        width: "100%",
                                        height: 24,
                                        marginBottom: "4rm",
                                        display: "flex",
                                        justifyContent: "space-between",
                                        textTransform: "capitalize",
                                        userSelect: "none",
                                        children: [r($, {
                                            textStyle: "small",
                                            lineHeight: "24px",
                                            children: "Autoplay"
                                        }), r(Ve, {
                                            backgroundChecked: "black",
                                            checked: e.autoplay || e.custom_controls ? .playbackType === "None",
                                            disabled: e.custom_controls ? .playbackType === "None",
                                            onChange: S => l(S, "autoplay")
                                        })]
                                    }), x(b, {
                                        width: "100%",
                                        height: 24,
                                        marginBottom: "4rm",
                                        display: "flex",
                                        justifyContent: "space-between",
                                        textTransform: "capitalize",
                                        userSelect: "none",
                                        children: [r($, {
                                            textStyle: "small",
                                            lineHeight: "24px",
                                            children: "Mute"
                                        }), r(Ve, {
                                            backgroundChecked: "black",
                                            checked: e.mute || e.custom_controls ? .playbackType === "None",
                                            disabled: e.autoplay,
                                            onChange: S => l(S, "mute")
                                        })]
                                    }), x(b, {
                                        width: "100%",
                                        height: 24,
                                        marginBottom: "4rm",
                                        display: "flex",
                                        justifyContent: "space-between",
                                        textTransform: "capitalize",
                                        userSelect: "none",
                                        children: [r($, {
                                            textStyle: "small",
                                            lineHeight: "24px",
                                            children: "Loop"
                                        }), r(Ve, {
                                            backgroundChecked: "black",
                                            checked: e.loop,
                                            onChange: S => l(S, "loop")
                                        })]
                                    }), x(b, {
                                        width: "100%",
                                        height: 24,
                                        marginBottom: "4rm",
                                        display: "flex",
                                        justifyContent: "space-between",
                                        textTransform: "capitalize",
                                        userSelect: "none",
                                        children: [r($, {
                                            textStyle: "small",
                                            lineHeight: "24px",
                                            children: "Thumbnail"
                                        }), r(Ve, {
                                            backgroundChecked: "black",
                                            checked: e.custom_thumbnail && !e.autoplay,
                                            disabled: e.autoplay,
                                            onChange: S => l(S, "custom_thumbnail")
                                        })]
                                    })]
                                }), e.custom_thumbnail && r(K9, {}), e.provider_name === "Vimeo" && x(Q, {
                                    children: [x(b, {
                                        marginTop: "32px",
                                        width: "100%",
                                        height: 24,
                                        display: "flex",
                                        justifyContent: "space-between",
                                        textTransform: "capitalize",
                                        marginBottom: "-8px",
                                        userSelect: "none",
                                        children: [r($, {
                                            textStyle: "small",
                                            lineHeight: "24px",
                                            children: "Show info"
                                        }), r(Ve, {
                                            backgroundChecked: "black",
                                            checked: e.info,
                                            onChange: S => l(S, "info")
                                        })]
                                    }), r(b, {
                                        margin: "18px -16px -8px -16px",
                                        children: r(qe, {
                                            disabled: !1,
                                            container: y,
                                            title: "Color",
                                            projectId: n,
                                            userId: s,
                                            setColor: S => l(KC(S), "color"),
                                            showBorder: !1,
                                            color: JC(e.color) || ap
                                        })
                                    })]
                                })]
                            }), r(q9, {})]
                        })
                    })
                })
            }), r(lo, {
                screen: "FontsList",
                children: r(ta, {
                    ref: m,
                    style: f,
                    headerSlot: p,
                    currentFontFamily: h,
                    onFontSelect: u
                })
            }), r(lo, {
                screen: "FontUploader",
                children: r(Ta, {
                    ref: m,
                    style: f
                })
            })]
        }) : null
    })
}

function dQ(e) {
    let t = {
        controls: e.controls ? "on" : "off",
        controlsOnType: e.controls_type === "custom" ? "custom" : "default",
        customControlType: e.custom_controls ? .type === "Icon" ? "icon" : e.custom_controls ? .type === "Text" ? "text" : "",
        customControlPosition: e.custom_controls ? .position ? "fixed" : "cursor",
        playOrPause: e.custom_controls ? .playbackType === "Click" ? "on click" : e.custom_controls ? .playbackType === "Hover" ? "on hover" : "off",
        triggers: e.triggers ? .length ? "TRUE" : "FALSE",
        videoType: e.provider_name === "File" ? "file" : "url"
    };
    De(Fe.WidgetVideoState, t)
}
var Cn, N_ = k(() => {
    "use strict";
    Be();
    Hi();
    ie();
    Cn = E(N());
    ht();
    nt();
    gn();
    ae();
    Le();
    nn();
    ut();
    Bf();
    je();
    Z9();
    ni();
    ol();
    Tr();
    Qp();
    ve();
    qc();
    Yt();
    $e();
    J9();
    ko();
    Zc();
    ey();
    Q9();
    qt();
    l0();
    B()
});
var t3, o3 = k(() => {
    "use strict";
    ae();
    N_();
    t3 = Ce.extend({
        name: "video_controls",
        component: e3
    })
});
var pQ, i3, n3 = k(() => {
    "use strict";
    Os();
    pQ = Vt.extend({
        name: "twitter_settings",
        alt: "Settings",
        panelComponent: "panel-twitter-settings"
    }), i3 = pQ
});
var uQ, r3, s3 = k(() => {
    "use strict";
    Os();
    uQ = Vt.extend({
        name: "facebook_settings",
        alt: "Settings",
        panelComponent: "panel-facebook-settings"
    }), r3 = uQ
});
var hQ, a3, l3 = k(() => {
    "use strict";
    Os();
    hQ = Vt.extend({
        name: "iframe_edit",
        alt: "Edit Code",
        rolePermission: "CodeCanEditCode",
        select: function() {
            Vt.prototype.select.apply(this, arguments), this.block.showPanel()
        },
        deselect: function() {
            this.block.hidePanel(), Vt.prototype.deselect.apply(this, arguments)
        },
        bindLogic: function() {
            this.block.on("editCodeClick", this.onClick)
        },
        unBindLogic: function() {
            this.block.off("editCodeClick")
        }
    }), a3 = hQ
});
var mQ, c3, d3 = k(() => {
    "use strict";
    Os();
    mQ = Vt.extend({
        name: "cart_connections",
        alt: "Cart connections",
        panelComponent: "panel-cart-connections",
        rolePermission: "EcommCartCanChangeConnections"
    }), c3 = mQ
});
var fQ, p3, u3 = k(() => {
    "use strict";
    Os();
    fQ = Vt.extend({
        name: "cart_settings",
        alt: "Settings",
        panelComponent: "panel-cart-settings",
        rolePermission: "EcommCartCanChangeSettings"
    }), p3 = fQ
});
var h3, m3 = k(() => {
    "use strict";
    no();
    h3 = {
        "template-constructor-control-cart_add_product_widget": Ae `
	<div class="icon noarrow" aria-label="Add product widget" data-alt="Add product widget" data-alt-pos="left" data-alt-offset="9"></div>
`
    }
});
var f3, gQ, g3, b3 = k(() => {
    "use strict";
    $n();
    m3();
    f3 = E(DH());
    Ht();
    gQ = it.extend({
        name: "cart_add_product_widget",
        className: "control cart_add_product_widget",
        rolePermission: "EcommCartCanAddProduct",
        restrictions: function(e) {
            return !!e.eCommerceManager ? .getConnectedProvider()
        },
        initialize: function(e) {
            this.template = h3["template-constructor-control-cart_add_product_widget"], this.initControl(e), this.block = this.blocks[0], this.model = this.block.model
        },
        render: function() {
            it.prototype.render.apply(this, arguments);
            let e = this.$el.find(".svg");
            (0, f3.default)(e)
        },
        onClick: function() {
            this.isOnClickDisabled() || this.block && this.block.workspace && this.block.workspace.createWidget("addtocart")
        }
    }), g3 = gQ
});
var bQ, y3, v3 = k(() => {
    "use strict";
    Os();
    bQ = Vt.extend({
        name: "product_selector",
        alt: "Select product",
        panelComponent: "panel-product-selector",
        rolePermission: "EcommAddToCartCanChangeProduct"
    }), y3 = bQ
});
var yQ, w3, x3 = k(() => {
    "use strict";
    Os();
    yQ = Vt.extend({
        name: "add_to_cart_settings",
        alt: "Settings",
        panelComponent: "panel-addtocart-settings",
        rolePermission: "EcommAddToCartCanChangeSettings"
    }), w3 = yQ
});
var vQ, _3, S3 = k(() => {
    "use strict";
    Os();
    vQ = Vt.extend({
        name: "slideshow_settings",
        alt: "Settings",
        panelComponent: "panel-slideshow-settings",
        rolePermission: "SlideshowCanChangeSettings",
        initialize: function() {
            Vt.prototype.initialize.apply(this, arguments), this.checkRolePermission()
        },
        select: function() {
            Vt.prototype.select.apply(this, arguments),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls-slideshow_settings")
                }), this.block.updateDropZone()
        },
        setPopupToDefault: function() {
            this.model.set("current_mode", "default")
        },
        onEscKey: function() {
            if (this.selected && this.checkNeedClosePopup()) {
                this.setPopupToDefault(), this.closeColorBox();
                return
            }
            Vt.prototype.onEscKey.apply(this, arguments)
        },
        checkNeedClosePopup: function() {
            return this.model.get("current_mode") !== "default" || this.block.colorbox_visible
        },
        canControlBeClosed: function() {
            if (this.checkNeedClosePopup()) return this.closeColorBox(), this.setPopupToDefault(), !0;
            Vt.prototype.canControlBeClosed.apply(this, arguments)
        },
        closeColorBox: function() {
            this.block.settingsPanel.closePopups(), this.block.colorbox_visible = !1
        },
        deselect: function() {
            this.setPopupToDefault(), Vt.prototype.deselect.apply(this, arguments)
        },
        destroy: function() {
            this.block.needRasterize && (this.block.rasterizeIconsBeforeDestroy(), delete this.block.needRasterize), Vt.prototype.destroy.apply(this, arguments)
        },
        checkRolePermission: function() {
            let t = this.block.model.get("pictures");
            (!t || !t.length) && (this.rolePermission = null)
        }
    }), _3 = vQ
});
var wQ, C3, k3 = k(() => {
    "use strict";
    Os();
    wQ = Vt.extend({
        name: "slideshow_transitions",
        alt: "Transitions",
        panelComponent: "panel-slideshow-transitions",
        rolePermission: "SlideshowCanChangeTransitions",
        onPanelChange: function() {
            Vt.prototype.onPanelChange.apply(this, arguments)
        },
        select: function() {
            Vt.prototype.select.apply(this, arguments),
                import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-R4BAKHY4.js").then(({
                    default: e
                }) => {
                    e("controls-slideshow_transitions")
                })
        },
        deselect: function() {
            Vt.prototype.deselect.apply(this, arguments)
        }
    }), C3 = wQ
});

function xQ({
    text: e,
    href: t,
    width: o = 160,
    height: i,
    padding: n = "12px 16px",
    boxPosition: s,
    arrowPosition: a,
    onClick: l,
    variant: c = "default",
    forceShow: d,
    whiteSpace: p,
    ...h
}) {
    let u = (0, ny.useRef)(null),
        [m, f] = (0, ny.useState)(!!d),
        g = c === "white";
    return x(b, {
        position: "relative",
        width: 24,
        height: 24,
        minWidth: 24,
        ...h,
        children: [r(b, {
            as: t ? "a" : void 0,
            href: t,
            target: t ? "_blank" : void 0,
            display: "flex",
            justifyContent: "center",
            alignItems: "center",
            border: "1px solid",
            borderColor: Fn(.92, ce.black),
            borderRadius: "50%",
            width: 24,
            height: 24,
            lineHeight: 24,
            cursor: t ? "pointer" : "default",
            onMouseEnter: () => f(!0),
            onMouseLeave: () => f(!1),
            onClick: () => l && l(),
            textDecoration: "none",
            css: Z `
          &:hover {
            background: ${g?ce.white:Fn(.04,ce.darkGray)};
            & > * {
              color: ${g?ce.gray:ce.white};
              cursor: inherit;
            }
          }
        `,
            children: r($, {
                textStyle: "small",
                color: "gray",
                cursor: "default",
                children: "?"
            })
        }), e ? r(wo, {
            children: m ? r(wt.div, {
                style: {
                    position: "absolute",
                    bottom: "100%",
                    left: 0,
                    pointerEvents: "none"
                },
                initial: {
                    opacity: 0
                },
                animate: {
                    opacity: 1
                },
                exit: {
                    opacity: 0
                },
                transition: {
                    duration: 0
                },
                children: r(b, {
                    position: "absolute",
                    bottom: 0,
                    marginBottom: "12px",
                    width: o,
                    ...s || {
                        marginLeft: `${-parseInt(o?.toString()||"")/2+12}px`
                    },
                    children: x(xp, {
                        height: "auto",
                        padding: n,
                        whiteSpace: p,
                        color: g ? "black" : void 0,
                        backgroundColor: g ? "white" : void 0,
                        border: g ? `1px solid ${Fn(.92,ce.black)}` : void 0,
                        textAlign: "center",
                        children: [e, r(_p, {
                            ref: u,
                            top: "100%",
                            left: "50%",
                            ...a
                        })]
                    })
                })
            }) : null
        }) : null]
    })
}
var ny, Mu, ry = k(() => {
    "use strict";
    ny = E(N());
    Uc();
    Li();
    ie();
    ut();
    Be();
    ir();
    ve();
    B();
    Mu = xQ
});
var P3 = un((sy, I3) => {
    "use strict";
    (function(e, t) {
        if (typeof define == "function" && define.amd) define(["module", "exports"], t);
        else if (typeof sy < "u") t(I3, sy);
        else {
            var o = {
                exports: {}
            };
            t(o, o.exports), e.autosize = o.exports
        }
    })(sy, function(e, t) {
        "use strict";
        var o = typeof Map == "function" ? new Map : function() {
                var c = [],
                    d = [];
                return {
                    has: function(h) {
                        return c.indexOf(h) > -1
                    },
                    get: function(h) {
                        return d[c.indexOf(h)]
                    },
                    set: function(h, u) {
                        c.indexOf(h) === -1 && (c.push(h), d.push(u))
                    },
                    delete: function(h) {
                        var u = c.indexOf(h);
                        u > -1 && (c.splice(u, 1), d.splice(u, 1))
                    }
                }
            }(),
            i = function(d) {
                return new Event(d, {
                    bubbles: !0
                })
            };
        try {
            new Event("test")
        } catch {
            i = function(p) {
                var h = document.createEvent("Event");
                return h.initEvent(p, !0, !1), h
            }
        }

        function n(c) {
            if (!c || !c.nodeName || c.nodeName !== "TEXTAREA" || o.has(c)) return;
            var d = null,
                p = null,
                h = null;

            function u() {
                var v = window.getComputedStyle(c, null);
                v.resize === "vertical" ? c.style.resize = "none" : v.resize === "both" && (c.style.resize = "horizontal"), v.boxSizing === "content-box" ? d = -(parseFloat(v.paddingTop) + parseFloat(v.paddingBottom)) : d = parseFloat(v.borderTopWidth) + parseFloat(v.borderBottomWidth), isNaN(d) && (d = 0), y()
            }

            function m(v) {
                {
                    var C = c.style.width;
                    c.style.width = "0px", c.offsetWidth, c.style.width = C
                }
                c.style.overflowY = v
            }

            function f(v) {
                for (var C = []; v && v.parentNode && v.parentNode instanceof Element;) v.parentNode.scrollTop && C.push({
                    node: v.parentNode,
                    scrollTop: v.parentNode.scrollTop
                }), v = v.parentNode;
                return C
            }

            function g() {
                if (c.scrollHeight !== 0) {
                    var v = f(c),
                        C = document.documentElement && document.documentElement.scrollTop;
                    c.style.height = "", c.style.height = c.scrollHeight + d + "px", p = c.clientWidth, v.forEach(function(I) {
                        I.node.scrollTop = I.scrollTop
                    }), C && (document.documentElement.scrollTop = C)
                }
            }

            function y() {
                g();
                var v = Math.round(parseFloat(c.style.height)),
                    C = window.getComputedStyle(c, null),
                    I = C.boxSizing === "content-box" ? Math.round(parseFloat(C.height)) : c.offsetHeight;
                if (I < v ? C.overflowY === "hidden" && (m("scroll"), g(), I = C.boxSizing === "content-box" ? Math.round(parseFloat(window.getComputedStyle(c, null).height)) : c.offsetHeight) : C.overflowY !== "hidden" && (m("hidden"), g(), I = C.boxSizing === "content-box" ? Math.round(parseFloat(window.getComputedStyle(c, null).height)) : c.offsetHeight), h !== I) {
                    h = I;
                    var T = i("autosize:resized");
                    try {
                        c.dispatchEvent(T)
                    } catch {}
                }
            }
            var S = function() {
                    c.clientWidth !== p && y()
                },
                w = function(v) {
                    window.removeEventListener("resize", S, !1), c.removeEventListener("input", y, !1), c.removeEventListener("keyup", y, !1), c.removeEventListener("autosize:destroy", w, !1), c.removeEventListener("autosize:update", y, !1), Object.keys(v).forEach(function(C) {
                        c.style[C] = v[C]
                    }), o.delete(c)
                }.bind(c, {
                    height: c.style.height,
                    resize: c.style.resize,
                    overflowY: c.style.overflowY,
                    overflowX: c.style.overflowX,
                    wordWrap: c.style.wordWrap
                });
            c.addEventListener("autosize:destroy", w, !1), "onpropertychange" in c && "oninput" in c && c.addEventListener("keyup", y, !1), window.addEventListener("resize", S, !1), c.addEventListener("input", y, !1), c.addEventListener("autosize:update", y, !1), c.style.overflowX = "hidden", c.style.wordWrap = "break-word", o.set(c, {
                destroy: w,
                update: y
            }), u()
        }

        function s(c) {
            var d = o.get(c);
            d && d.destroy()
        }

        function a(c) {
            var d = o.get(c);
            d && d.update()
        }
        var l = null;
        typeof window > "u" || typeof window.getComputedStyle != "function" ? (l = function(d) {
            return d
        }, l.destroy = function(c) {
            return c
        }, l.update = function(c) {
            return c
        }) : (l = function(d, p) {
            return d && Array.prototype.forEach.call(d.length ? d : [d], function(h) {
                return n(h, p)
            }), d
        }, l.destroy = function(c) {
            return c && Array.prototype.forEach.call(c.length ? c : [c], s), c
        }, l.update = function(c) {
            return c && Array.prototype.forEach.call(c.length ? c : [c], a), c
        }), t.default = l, e.exports = t.default
    })
});
var vm, ay, _Q, T3, B3 = k(() => {
    "use strict";
    vm = E(N()), ay = E(P3()), _Q = () => {
        let [e, t] = (0, vm.useState)(null);
        return (0, vm.useEffect)(() => {
            if (e) return (0, ay.default)(e), () => {
                e && ay.default.destroy(e)
            }
        }, [e]), (0, vm.useEffect)(() => {
            e && ay.default.update(e)
        }), t
    }, T3 = _Q
});
var M3, SQ, CQ, R3, V_, G_ = k(() => {
    "use strict";
    M3 = E(N());
    ve();
    B3();
    vj();
    Be();
    B();
    SQ = ue("textarea")
    `
  box-sizing: border-box;
  display: block;
  width: 100%;
  background: transparent;
  border: none;
  outline: none;
  resize: none;
  font-family: inherit;

  &::placeholder {
    color: ${({theme:e})=>e.colors.gray};
  }
`, CQ = (0, M3.forwardRef)(({
        autoSize: e = !1,
        ...t
    }, o) => {
        let i = T3();
        return r(SQ, {
            ref: ep(o, e ? i : null),
            ...t
        })
    }), R3 = $.withComponent(CQ);
    R3.defaultProps = {
        padding: 0,
        textStyle: "regular",
        color: "black"
    };
    V_ = R3
});
var E3 = k(() => {
    "use strict";
    G_();
    G_()
});

function kQ({
    value: e,
    onBlur: t,
    onChange: o
}) {
    let [i, n] = (0, F3.useState)(!1);
    return r(b, {
        border: "1px solid",
        borderColor: i ? di("gray", .24) : "transparent",
        borderRadius: 4,
        backgroundColor: "white",
        children: r(V_, {
            padding: "4px 14px 4px 8px",
            color: "black",
            fontFamily: "mono",
            textStyle: "small",
            width: "100%",
            minHeight: 100,
            maxLength: 280,
            autoSize: !0,
            placeholder: "Descriptive alt text",
            onFocus: () => n(!0),
            onBlur: () => {
                n(!1), t && t()
            },
            onChange: s => o(s.currentTarget.value || ""),
            value: e
        })
    })
}
var F3, ly, Y_ = k(() => {
    "use strict";
    F3 = E(N());
    ie();
    ve();
    E3();
    B();
    ly = kQ
});

function IQ() {
    let {
        model: {
            block: e
        }
    } = (0, cl.useContext)(Y), {
        model: t,
        modelSet: o,
        modelUnset: i,
        modelSave: n
    } = (0, cl.useContext)(ge), {
        callback: s
    } = Je(n, 400), a = e.slideshowPlayer, [l, c] = (0, cl.useState)(a.currentImageID);

    function d(S) {
        c(S)
    }
    let p = (0, cl.useMemo)(() => {
            let S = t.pictures.findIndex(w => w.id === l);
            return S > -1 ? S : 0
        }, [t, l]),
        h = t.pictures[p],
        u = typeof t.commonAlt == "string",
        m = (u ? t.commonAlt : h.alt) || "";
    (0, cl.useEffect)(() => (a.on("currentImageChanged", d), () => {
        a.off("currentImageChanged", d)
    }), [e]);

    function f(S) {
        if (u) o({
            commonAlt: S
        });
        else {
            let w = JSON.parse(JSON.stringify(t.pictures));
            p > -1 && (w[p].alt = S), o({
                pictures: w
            })
        }
        s()
    }

    function g() {
        o({
            commonAlt: m
        })
    }

    function y() {
        i("commonAlt")
    }
    return x(Q, {
        children: [r(b, {
            paddingTop: 18,
            height: 62,
            children: u ? null : r(H, {
                leftSlot: `${p+1}/${t.pictures.length}`,
                rightSlot: x(Q, {
                    children: [r(dt, {
                        height: 32,
                        width: 32,
                        color: "gray",
                        hoverColor: "darkGray",
                        onClick: () => e.slideshowPlayer.prevImage(),
                        children: r(yp, {
                            color: "white"
                        })
                    }), r(dt, {
                        height: 32,
                        width: 32,
                        color: "gray",
                        hoverColor: "darkGray",
                        margin: 0,
                        onClick: () => e.slideshowPlayer.nextImage(),
                        children: r(vp, {
                            color: "white"
                        })
                    })]
                }),
                showBorder: !1
            })
        }), r(b, {
            paddingTop: 0,
            paddingLeft: 8,
            paddingRight: 8,
            paddingBottom: 0,
            children: r(ly, {
                value: m,
                onChange: f,
                onBlur: s
            })
        }), r(H, {
            showBorder: !1,
            leftSlot: "One for all",
            rightSlot: r(Ve, {
                checked: u,
                backgroundChecked: "black",
                onChange: S => {
                    S ? g() : y(), s()
                }
            })
        })]
    })
}
var cl, D3, A3 = k(() => {
    "use strict";
    cl = E(N());
    qo();
    ie();
    $e();
    Hi();
    td();
    Jr();
    Y_();
    Le();
    ae();
    B();
    D3 = IQ
});

function PQ() {
    let {
        model: e,
        modelSet: t,
        modelSave: o
    } = (0, L3.useContext)(ge), {
        callback: i
    } = Je(o, 400);

    function n(s) {
        t({
            alt: s
        }), i()
    }
    return r(b, {
        paddingTop: 10,
        paddingLeft: 8,
        paddingRight: 8,
        paddingBottom: 8,
        children: r(ly, {
            value: e.alt || "",
            onChange: n,
            onBlur: i
        })
    })
}
var L3, z3, $3 = k(() => {
    "use strict";
    L3 = E(N());
    qo();
    ie();
    Y_();
    Le();
    B();
    z3 = PQ
});
var cy, TQ, W3, O3 = k(() => {
    "use strict";
    cy = E(N());
    nt();
    gn();
    Be();
    ry();
    Le();
    A3();
    $3();
    Ak();
    B();
    TQ = (0, cy.forwardRef)(({
        style: e,
        helpHref: t
    }, o) => {
        let {
            model: i
        } = (0, cy.useContext)(ge);
        return x(Me, {
            isShowed: !0,
            ref: o,
            style: e,
            children: [r(Ut, {
                leftSlot: r($, {
                    textStyle: "regular",
                    children: "Semantics"
                }),
                rightSlot: r(Mu, {
                    href: t,
                    marginRight: 4
                }),
                showBorder: !1
            }), df(i) ? r(D3, {}) : r(z3, {})]
        })
    }), W3 = TQ
});

function BQ({
    helpHref: e
}) {
    let {
        model: t
    } = (0, wm.useContext)(Y), {
        model: o
    } = (0, wm.useContext)(ge), i = (0, wm.useCallback)(s => {
        s.preventDefault(), !t.disabled && t.select()
    }, [t.disabled]), n = df(o) ? typeof o.commonAlt == "string" ? !!o.commonAlt : o.pictures ? .some(s => !!s.alt) : !!o.alt;
    return r(Ie, {
        control: ({
            ref: s
        }) => r(ke, {
            ref: s,
            label: "Alt text",
            onClick: i,
            isActive: n,
            children: r(rI, {
                color: "white"
            })
        }),
        panel: ({
            ref: s,
            style: a
        }) => t.selected ? r(W3, {
            ref: s,
            style: a,
            helpHref: e
        }) : null
    })
}
var wm, Ru, dy = k(() => {
    "use strict";
    wm = E(N());
    ae();
    ht();
    mH();
    O3();
    Le();
    Ak();
    B();
    Ru = BQ
});
var j3, H3 = k(() => {
    "use strict";
    ae();
    dy();
    B();
    j3 = Ce.extend({
        name: "picture_alt",
        component: () => r(Ru, {
            helpHref: "https://help.readymag.com/hc/en-us/articles/360019989052-Picture"
        }),
        rolePermission: "PictureCanChangeAltText",
        restrictions(e) {
            let t = window.RM.constructorRouter ? .me ? .get("permissions"),
                o = e.getSelectedBlocks();
            return o.length === 1 && o[0].isPictureEmpty && !o[0].isPictureEmpty() && t ? .can_use_picture_alt
        }
    })
});
var N3, U3 = k(() => {
    "use strict";
    ae();
    dy();
    B();
    N3 = Ce.extend({
        name: "shape_alt",
        component: () => r(Ru, {
            helpHref: "https://help.readymag.com/hc/en-us/articles/360020526772-Shapes-Icons"
        }),
        rolePermission: "ShapeCanChangeAltText",
        restrictions(e) {
            let t = window.RM.constructorRouter ? .me ? .get("permissions");
            return e.getSelectedBlocks().length === 1 && t ? .can_use_shape_alt
        }
    })
});
var V3, G3 = k(() => {
    "use strict";
    ae();
    dy();
    B();
    V3 = Ce.extend({
        name: "slideshow_alt",
        component: () => r(Ru, {
            helpHref: "https://help.readymag.com/hc/en-us/articles/360019989392-Slideshow"
        }),
        rolePermission: "SlideshowCanChangeAltText",
        restrictions(e) {
            let t = window.RM.constructorRouter ? .me ? .get("permissions"),
                o = e.getSelectedBlocks();
            return o.length === 1 && o[0].model.get("pictures").length && t ? .can_use_slideshow_alt
        }
    })
});
var MQ, Y3, Z3 = k(() => {
    "use strict";
    Os();
    MQ = Vt.extend({
        name: "rmheader_settings",
        alt: "RM Header Settings",
        panelComponent: "panel-rmheader-settings"
    }), Y3 = MQ
});
var Ft, EQ, X3, K3 = k(() => {
    "use strict";
    Ft = E(N());
    Le();
    nt();
    yd();
    $e();
    Yt();
    Ss();
    fj();
    mp();
    xk();
    ko();
    _s();
    ae();
    nn();
    Tr();
    ni();
    qo();
    Mt();
    qi();
    Be();
    ie();
    Jr();
    SH();
    ir();
    R0();
    Y0();
    yI();
    uI();
    uH();
    wH();
    vH();
    oH();
    cI();
    nH();
    CH();
    Hi();
    je();
    en();
    zt();
    Yj();
    pH();
    ut();
    Sh();
    ve();
    B();
    EQ = (0, Ft.forwardRef)(({
        style: e,
        onHeightChanged: t,
        getScrollablePanelProps: o
    }, i) => {
        let {
            navigate: n
        } = (0, Ft.useContext)(Jt), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, Ft.useContext)(ge), {
            model: c,
            modelSet: d
        } = (0, Ft.useContext)(Y), p = (0, Ft.useMemo)(() => c.project.get("_id"), [c]), h = (0, Ft.useMemo)(() => c.user.get("_id"), [c]), {
            callback: u
        } = Je(l, 400), [m, f] = c.useSharedState({
            partial: !1
        }), g = Sa(m), [y, S] = (0, Ft.useState)([]), [w, v] = (0, Ft.useState)([]), [C, I] = (0, Ft.useState)([]), [T, P] = (0, Ft.useState)(!1), M = g.fontInfo[0];
        (0, Ft.useEffect)(() => {
            if (M) {
                let Dt = M.features ? .length ? M.features : [],
                    we = Ok(Dt);
                S(we);
                let mt = jk(Dt);
                v(mt);
                let $o = Hk(Dt);
                I($o);
                let qn = Dt.includes("frac");
                P(qn)
            }
        }, [m, M]);
        let F = (0, Ft.useMemo)(() => Pi(m, "FONT_FEATURE"), [m]),
            R = (0, Ft.useMemo)(() => Pi(m, "STROKE"), [m]),
            A = !!(R && R.length),
            D = (0, Ft.useMemo)(() => tp(m), [m]),
            O = (0, Ft.useMemo)(() => up(D), [D]);
        (0, Ft.useEffect)(() => {
            t()
        }, [O, A]);
        let L = (0, Ft.useMemo)(() => w.find(Dt => F.includes(Dt)), [w, F]),
            W = (0, Ft.useMemo)(() => C.find(Dt => F.includes(Dt)), [C, F]),
            z = x($, {
                textAlign: "center",
                textStyle: "small",
                display: "inline-block",
                width: "86px",
                children: ["Stylistic set ", L ? L.replace(/\D/g, "") : ""]
            }),
            V = (0, Ft.useMemo)(() => s.bgColor, [s.bgColor]),
            [X, q] = (0, Ft.useState)(V ? Yo(V) : null);
        (0, Ft.useEffect)(() => {
            if (s.bgColor) {
                let Dt = Yo(s.bgColor);
                X && (Dt.h !== X.h || Dt.s !== X.s || Dt.v !== X.v) && q(Dt)
            } else q(Yo("#ffffff00"))
        }, [V]);
        let [ne, re] = (0, Ft.useState)(1), [te, ee] = (0, Ft.useState)(A && R[1] ? Yo(R[1]) : {
            h: 0,
            s: 0,
            v: 50,
            a: 1
        }), [j, se] = (0, Ft.useState)("");
        (0, Ft.useEffect)(() => {
            if (R && R.length) {
                let [Dt, we] = R;
                Number(Dt) !== ne && re(Number(Dt));
                let mt = qC(we);
                mt && mt !== j && (ee(Yo(we)), se(mt))
            }
        }, [R, A]);
        let oe = Pi(m, "DECORATION"),
            U = Pi(m, "TRANSFORM"),
            he = Pi(m, "FEATURES"),
            xe = he && he[0] === "superscript",
            pe = he && he[0] === "subscript",
            J = oe && oe[0] === "overline",
            le = g.textStyle[0],
            ye = le ? le.cssProperties.textTransform === "uppercase" : !1,
            Ue = U && U[0] ? U[0] === "uppercase" : ye,
            Te = U && U[0] === "lowercase",
            Re = U && U[0] === "capitalize",
            Tt = le ? le.cssProperties.textDecoration === "underline" : !1,
            Ee = oe && oe[0] ? oe[0] === "underline" : Tt,
            Qe = le ? le.cssProperties.textDecoration === "line-through" : !1,
            _t = oe && oe[0] ? oe[0] === "line-through" : Qe,
            Ge = Pi(m, "FONT_WEIGHT"),
            br = le ? le.cssProperties.fontWeight === 700 : !1,
            Ua = Ge && Ge[0] ? Ge[0] === "700" : br,
            Xi = Pi(m, "FONT_STYLE"),
            Nd = le ? le.cssProperties.fontStyle === "italic" : !1,
            ga = Xi && Xi[0] ? Xi[0] === "italic" : Nd,
            [Ud, Tl] = (0, Ft.useState)(!1),
            [Bl] = El(),
            gs = [...Bl.global, ...Bl.project],
            Jn = (0, Ft.useMemo)(() => Xc({
                editorState: m
            }), [m]),
            ba = (0, Ft.useMemo)(() => gs.find(Dt => Dt.name === Jn), [Jn]),
            {
                isMultipleBlockSelected: $c,
                hasDifferentStyles: ot
            } = (0, Ft.useMemo)(() => {
                let Dt = op(m),
                    we = m.getCurrentContent(),
                    mt = Dt.map($o => {
                        let qn = we.getBlockForKey($o);
                        return Ko({
                            editorState: m,
                            block: qn
                        })
                    });
                return {
                    isMultipleBlockSelected: mt.length > 1,
                    hasDifferentStyles: mt.some($o => $o !== mt[0])
                }
            }, [ba, m]),
            Ct = Dt => {
                let we = ro(Dt);
                f(bi({
                    key: "STROKE",
                    value: `${ne}${np}${we}`,
                    editorState: m
                }))
            },
            Fi = !!s.selectionColor,
            [ci, Po] = (0, Ft.useState)(s.selectionColor ? .textColor ? Yo(s.selectionColor.textColor) : de.textWidget.initialColor),
            [cn, mi] = (0, Ft.useState)(s.selectionColor ? .backgroundColor ? Yo(s.selectionColor.backgroundColor) : de.textWidget.customSelectionColor),
            [vt, dn] = (0, Ft.useState)(null),
            Co = () => {
                dn(m.getSelection()), f($k(m))
            },
            Di = () => {
                vt && (f(At(m, vt)), dn(null))
            },
            pn = (Dt, we) => {
                a({
                    selectionColor: { ...s.selectionColor || {},
                        [Dt]: ro(we)
                    }
                })
            };
        return r(Me, {
            ref: i,
            style: e,
            isShowed: c.selected,
            ...o(),
            children: r(Ot.Consumer, {
                children: ({
                    dropdownContainer: Dt
                }) => x(Q, {
                    children: [x(H, {
                        leftSlot: "Transform",
                        children: [x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            marginBottom: "8px",
                            children: [r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Uppercase",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-uppercase",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: Ue ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "TRANSFORM",
                                                value: Ue ? "none" : "uppercase"
                                            });
                                            f(we)
                                        },
                                        children: r(vI, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Capitalize",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-capitalize",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: Re ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "TRANSFORM",
                                                value: Re ? "none" : "capitalize"
                                            });
                                            f(we)
                                        },
                                        children: r(F0, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Lowercase",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-lowercase",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: Te ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "TRANSFORM",
                                                value: Te ? "none" : "lowercase"
                                            });
                                            f(we)
                                        },
                                        children: r(tI, {
                                            color: "white"
                                        })
                                    })
                                })
                            })]
                        }), x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Bold",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-bold",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: Ua ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "FONT_WEIGHT",
                                                value: Ua ? St.fontWeight : "700"
                                            });
                                            f(we)
                                        },
                                        children: r(If, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Italic",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-italic",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: ga ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "FONT_STYLE",
                                                value: ga ? St.fontStyle : "italic"
                                            });
                                            f(we)
                                        },
                                        children: r(Mf, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40
                            })]
                        })]
                    }), r(H, {
                        leftSlot: "Decoration",
                        children: x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Underline",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-underline",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: Ee ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "DECORATION",
                                                value: Ee ? "none" : "underline"
                                            });
                                            f(we)
                                        },
                                        css: Z `
                          &:hover g {
                            fill: #fff;
                          }
                        `,
                                        children: r(zf, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Strikethrough",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-strikethrough",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: _t ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "DECORATION",
                                                value: _t ? "none" : "line-through"
                                            });
                                            f(we)
                                        },
                                        css: Z `
                          &:hover g {
                            fill: #fff;
                          }
                        `,
                                        children: r(Af, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Overline",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-overline",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: J ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "DECORATION",
                                                value: J ? "none" : "overline"
                                            });
                                            f(we)
                                        },
                                        css: Z `
                          &:hover g {
                            fill: #fff;
                          }
                        `,
                                        children: r(iI, {
                                            color: "white"
                                        })
                                    })
                                })
                            })]
                        })
                    }), x(H, {
                        leftSlot: "Features",
                        children: [x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            marginBottom: "8px",
                            children: [r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Superscript",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-superscript",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: xe ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "FEATURES",
                                                value: xe ? "none" : "superscript"
                                            });
                                            f(we)
                                        },
                                        children: r(mI, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Subscript",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-subscript",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: pe ? "black" : "gray",
                                        onClick: () => {
                                            let we = bi({
                                                editorState: m,
                                                key: "FEATURES",
                                                value: pe ? "none" : "subscript"
                                            });
                                            f(we)
                                        },
                                        children: r(hI, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: T ? "Fractions" : "Font doesn't support Fractions",
                                    indent: 4,
                                    children: r("span", {
                                        children: r(dt, {
                                            "data-testid": "advanced-typography-fractions",
                                            hoverColor: "black",
                                            height: 40,
                                            width: 40,
                                            disabled: !T,
                                            color: F.includes("frac") ? "black" : "gray",
                                            onClick: () => {
                                                let we = [...F],
                                                    mt = we.indexOf("frac");
                                                mt > -1 ? we.splice(mt, 1) : we.push("frac"), f(bi({
                                                    key: "FONT_FEATURE",
                                                    value: we,
                                                    editorState: m
                                                }))
                                            },
                                            children: r(V0, {
                                                color: "white"
                                            })
                                        })
                                    })
                                })
                            })]
                        }), x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r(b, {
                                width: 40,
                                children: r(et, {
                                    text: "Small caps",
                                    indent: 4,
                                    children: r(dt, {
                                        "data-testid": "advanced-typography-smallcaps",
                                        hoverColor: "black",
                                        height: 40,
                                        width: 40,
                                        color: F.includes("smcp") ? "black" : "gray",
                                        onClick: () => {
                                            let we = [...F],
                                                mt = we.indexOf("smcp");
                                            mt > -1 ? we.splice(mt, 1) : we.push("smcp"), f(bi({
                                                key: "FONT_FEATURE",
                                                value: we,
                                                editorState: m
                                            }))
                                        },
                                        children: r(Ff, {
                                            color: "white"
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: !y || !y.length ? "Font doesn't support Ligatures" : "Ligatures",
                                    indent: 4,
                                    children: r("span", {
                                        children: r(dt, {
                                            "data-testid": "advanced-typography-ligatures",
                                            hoverColor: "black",
                                            height: 40,
                                            width: 40,
                                            disabled: !y || !y.length,
                                            color: F.includes("liga") ? "black" : "gray",
                                            onClick: () => {
                                                let we = [...F],
                                                    mt = we.indexOf("liga");
                                                mt > -1 ? we.splice(mt, 1) : we.push("liga"), f(bi({
                                                    key: "FONT_FEATURE",
                                                    value: we,
                                                    editorState: m
                                                }))
                                            },
                                            children: r(Z0, {
                                                color: "white"
                                            })
                                        })
                                    })
                                })
                            }), r(b, {
                                width: 40,
                                children: r(et, {
                                    text: !w || !w.length ? "Font doesn't support Stylistic sets" : z,
                                    indent: 4,
                                    children: r("span", {
                                        children: r(dt, {
                                            "data-testid": "advanced-typography-stylistic-set",
                                            hoverColor: "black",
                                            height: 40,
                                            width: 40,
                                            disabled: !w || !w.length,
                                            color: L ? "black" : "gray",
                                            onClick: () => {
                                                let we = [...F],
                                                    mt = L ? we.indexOf(L) : null;
                                                if (mt !== null && mt > -1 && we.splice(mt, 1), L) {
                                                    let $o = w.indexOf(L);
                                                    if ($o > -1) {
                                                        let qn = w[$o + 1];
                                                        qn && we.push(qn)
                                                    }
                                                } else we.push(w[0]);
                                                f(bi({
                                                    key: "FONT_FEATURE",
                                                    value: we,
                                                    editorState: m
                                                }))
                                            },
                                            children: r(wI, {
                                                color: "white"
                                            })
                                        })
                                    })
                                })
                            })]
                        })]
                    }), C && C.length ? r(es, {
                        onToggle: we => d({
                            preventClose: we
                        }),
                        container: Dt,
                        items: [{
                            label: "Default figures",
                            value: "default"
                        }, ...C.map(we => ({
                            label: rk[we],
                            value: we
                        }))],
                        value: W || "default",
                        onSelect: we => {
                            let mt = [...F],
                                $o = W ? mt.indexOf(W) : null;
                            $o !== null && $o > -1 && mt.splice($o, 1), we.value !== "default" && mt.push(we.value), f(bi({
                                key: "FONT_FEATURE",
                                value: mt,
                                editorState: m
                            }))
                        }
                    }) : void 0, r(H, {
                        showBorder: !O,
                        leftSlot: "List",
                        rightSlot: r(Ve, {
                            "data-testid": "advanced-typography-list",
                            checked: O,
                            backgroundChecked: "black",
                            onChange: () => {
                                let we = O ? D : "unordered-list-item",
                                    mt = At(uf(m, we), m.getSelection());
                                f(mt)
                            }
                        })
                    }), O && x(Q, {
                        children: [r(H, {
                            nested: !0,
                            showBorder: !1,
                            leftSlot: x(Q, {
                                children: [r(b, {
                                    marginRight: "2rm",
                                    display: "inline-block",
                                    children: r(K, {
                                        "data-testid": "advanced-typography-unordered-list",
                                        color: D === "unordered-list-item" ? "black" : "darkGray",
                                        textStyle: "small",
                                        variant: "clean",
                                        onClick: () => {
                                            let we = At(uf(m, "unordered-list-item"), m.getSelection());
                                            f(we)
                                        },
                                        css: Z `
                              &:hover {
                                color: ${ce.black};
                              }
                            `,
                                        children: "Unordered"
                                    })
                                }), r(b, {
                                    display: "inline-block",
                                    children: r(K, {
                                        "data-testid": "advanced-typography-ordered-list",
                                        color: D === "ordered-list-item" ? "black" : "darkGray",
                                        textStyle: "small",
                                        variant: "clean",
                                        onClick: () => {
                                            let we = At(uf(m, "ordered-list-item"), m.getSelection());
                                            f(we)
                                        },
                                        css: Z `
                              &:hover {
                                color: ${ce.black};
                              }
                            `,
                                        children: "Ordered"
                                    })
                                })]
                            })
                        }), up(D) && r(H, {
                            nested: !0,
                            onClick: () => n("Styles"),
                            onMouseEnter: () => Tl(!0),
                            onMouseLeave: () => Tl(!1),
                            leftSlot: r(K, {
                                "data-testid": "advanced-typography-go-to-list-styles",
                                display: "block",
                                variant: "clean",
                                width: "100%",
                                textOverflow: "ellipsis",
                                overflow: "hidden",
                                whiteSpace: "nowrap",
                                textAlign: "left",
                                lineHeight: "1",
                                children: r($, {
                                    textStyle: "small",
                                    color: "black",
                                    children: ba ? $c && ot ? "..." : ba.label : "Same as text"
                                })
                            }),
                            rightSlot: r(K, {
                                variant: "clean",
                                verticalAlign: "middle",
                                children: r(Lt, {
                                    color: Ud ? "black" : "gray"
                                })
                            })
                        })]
                    }), r(H, {
                        showBorder: !A,
                        leftSlot: "Outline",
                        rightSlot: r(Ve, {
                            "data-testid": "advanced-typography-outline",
                            checked: A,
                            backgroundChecked: "black",
                            onChange: () => {
                                te && f(bi({
                                    key: "STROKE",
                                    value: A ? void 0 : `${ne}${np}${ro(te)}`,
                                    editorState: m
                                }))
                            }
                        })
                    }), A && x(Q, {
                        children: [r(H, {
                            nested: !0,
                            showBorder: !1,
                            leftSlot: "Width",
                            rightSlot: r(fe, {
                                "data-testid": "advanced-typography-outline-width",
                                value: ne,
                                min: 1,
                                max: 999,
                                textAlign: "right",
                                autoWidth: !0,
                                onChange: ({
                                    value: we
                                }) => {
                                    let mt = te || de.textWidget.initialColor;
                                    if (!mt) return;
                                    let $o = ro(mt),
                                        qn = we;
                                    re(qn), f(bi({
                                        key: "STROKE",
                                        value: `${qn}${np}${$o}`,
                                        editorState: m
                                    }))
                                }
                            })
                        }), r(qe, {
                            nested: !0,
                            "data-testid": "advanced-typography-outline-color",
                            container: Dt,
                            title: "Color",
                            projectId: p,
                            userId: h,
                            color: te,
                            setColor: ee,
                            onColorChange: Ct,
                            onChangeComplete: Ct
                        })]
                    }), r(qe, {
                        "data-testid": "advanced-typography-box-color",
                        container: Dt,
                        title: "Box Color",
                        projectId: p,
                        userId: h,
                        color: X,
                        setColor: q,
                        onChangeComplete: we => {
                            a({
                                bgColor: ro(we)
                            }), u()
                        }
                    }), x(Q, {
                        children: [r(H, {
                            showBorder: !1,
                            leftSlot: "Selection",
                            rightSlot: r(Ve, {
                                "data-testid": "advanced-custom-selection",
                                checked: Fi,
                                backgroundChecked: "black",
                                onChange: () => {
                                    a({
                                        selectionColor: Fi ? void 0 : {
                                            textColor: ci && ro(ci),
                                            backgroundColor: cn && ro(cn)
                                        }
                                    }), u()
                                }
                            })
                        }), Fi && x(Q, {
                            children: [r(qe, {
                                nested: !0,
                                showBorder: !1,
                                "data-testid": "advanced-typography-selection-text-color",
                                container: Dt,
                                title: "Text",
                                projectId: p,
                                userId: h,
                                color: ci,
                                setColor: Po,
                                onPanelShow: Co,
                                onPanelHide: Di,
                                onColorChange: we => pn("textColor", we),
                                onChangeComplete: we => {
                                    pn("textColor", we), u()
                                }
                            }), r(qe, {
                                nested: !0,
                                showBorder: !1,
                                "data-testid": "advanced-typography-selection-background-color",
                                container: Dt,
                                title: "Background",
                                projectId: p,
                                userId: h,
                                color: cn,
                                setColor: mi,
                                onPanelShow: Co,
                                onPanelHide: Di,
                                onColorChange: we => pn("backgroundColor", we),
                                onChangeComplete: we => {
                                    pn("backgroundColor", we), u()
                                }
                            })]
                        })]
                    })]
                })
            })
        })
    }), X3 = EQ
});
var Vo, FQ, J3, q3 = k(() => {
    "use strict";
    Vo = E(N());
    Ol();
    qt();
    Tr();
    Dn();
    ni();
    DI();
    ae();
    Fx();
    mp();
    Yt();
    Mt();
    qi();
    B();
    FQ = (0, Vo.forwardRef)(({
        style: e,
        onHeightChanged: t,
        headerSlot: o
    }, i) => {
        let {
            navigate: n
        } = (0, Vo.useContext)(Jt), {
            setSelectedListStyle: s,
            setSelectedTextStyleSection: a,
            selectedTextStyleSection: l,
            setEditorStateBackup: c
        } = (0, Vo.useContext)(tn), {
            model: d
        } = (0, Vo.useContext)(Y), p = (0, Vo.useMemo)(() => d.project.get("_id"), [d]), h = (0, Vo.useMemo)(() => d.user.get("_id"), [d]), [u, m] = d.useSharedState({
            partial: !1
        }), [f, g] = (0, Vo.useState)(null), [y, S] = (0, Vo.useState)("all"), [w, v] = (0, Vo.useState)(l || "project"), [C, I] = El(), T = (0, Vo.useMemo)(() => w === "global" ? C.global : y === "used" ? C.project.filter(re => !!f ? .has(re.name)) : y === "unused" ? C.project.filter(re => !f ? .has(re.name)) : C.project, [w, C, y]), P = (0, Vo.useMemo)(() => Xc({
            editorState: u
        }), [u]);
        (0, Vo.useEffect)(() => {
            if (P && !l) {
                let re = C.global.some(te => te.name === P);
                re && w !== "global" ? v("global") : !re && w === "global" && v("project")
            }
        }, [P, l]), (0, Vo.useEffect)(() => {
            t()
        }, []);
        let M = (0, Vo.useCallback)(re => {
                let te = hp({
                    style: re,
                    currentStyle: P,
                    editorState: u
                });
                m(At(te, u.getSelection()))
            }, [P, u]),
            F = (0, Vo.useCallback)(async re => {
                let te = [...T],
                    ee = te.findIndex(j => j.name === re.name);
                ee > -1 && te.splice(ee, 0, { ...re,
                    name: `style-${zn()}`,
                    label: `${re.label} (Copy)`
                }), await I({ ...C,
                    [w]: te
                }), w === "global" ? await nd({
                    userId: h,
                    styles: te
                }) : await Ul({
                    projectId: p,
                    styles: te
                }), window.RM.constructorRouter.trigger("update_from_server", "ListStyles", {
                    [w]: te
                })
            }, [T, C, w, h, p]),
            R = (0, Vo.useCallback)(async re => {
                let te = [...T],
                    ee = te.findIndex(j => j.name === re.name);
                ee > -1 && te.splice(ee, 1), await I({ ...C,
                    [w]: te
                }), w === "global" ? await nd({
                    userId: h,
                    styles: te
                }) : await Ul({
                    projectId: p,
                    styles: te
                }), window.RM.constructorRouter.trigger("update_from_server", "ListStyles", {
                    [w]: te
                })
            }, [T, C, w, h, p]),
            A = async (re, te) => {
                if (re === -1) return;
                let ee = [...T],
                    j = ee[re];
                ee.splice(re, 1), ee.splice(te, 0, j), await I({ ...C,
                    [w]: ee
                }), w === "global" ? await nd({
                    userId: h,
                    styles: ee
                }) : await Ul({
                    projectId: p,
                    styles: ee
                }), window.RM.constructorRouter.trigger("update_from_server", "ListStyles", {
                    [w]: ee
                })
            },
            D = re => {
                s && s(re), a && a(w), n("StyleEdit")
            },
            [O, L] = (0, Vo.useState)(de.textWidget.listStylesPanelDefaultHeight);
        (0, Vo.useEffect)(() => {
            let re = d.project.edit_params.get("controls");
            re && re.ListStyles && L(re.ListStyles)
        }, []);
        let W = re => {
                L(re);
                let te = d.project.edit_params.get("controls");
                d.project.edit_params.set("controls", { ...te,
                    ListStyles: re
                }), d.project.edit_params.save()
            },
            z = (0, Vo.useCallback)(async (re, te) => {
                let ee = [],
                    j = [];
                if (te === "global") {
                    ee = [...T];
                    let se = ee.findIndex(oe => oe.name === re.name);
                    se > -1 && ee.splice(se, 1), j = [...C.global, re]
                } else {
                    j = [...T];
                    let se = j.findIndex(oe => oe.name === re.name);
                    se > -1 && j.splice(se, 1), ee = [...C.project, re]
                }
                await I({
                    global: j,
                    project: ee
                }), await Ul({
                    projectId: p,
                    styles: ee
                }), await nd({
                    userId: h,
                    styles: j
                }), window.RM.constructorRouter.trigger("update_from_server", "ListStyles", {
                    global: j,
                    project: ee
                })
            }, [T, C, h, p]),
            V = () => {
                s && s(void 0), a && a(w), c && c([u]), n("StyleEdit"), De(Fe.WidgetFeature, {
                    featureType: "typography create new style"
                })
            },
            X = () => new Promise(re => {
                let te = d.project.getUsedStyles("list");
                re(te)
            });
        return r(pb, {
            style: e,
            ref: i,
            height: O,
            currentStyles: [P],
            onResizeComplete: W,
            headerSlot: o,
            onAddClick: V,
            filterState: y,
            setStylesFilter: re => {
                if (re !== y)
                    if (re !== "all") {
                        let te = rp(p, "list");
                        te ? (g(te), S(re)) : X().then(ee => {
                            ee && (g(ee), S(re), yf(p, "list", ee))
                        })
                    } else S(re)
            },
            onDeleteUnusedStyles: async () => {
                y !== "all" && S("all");
                let re = rp(p, "paragraph"),
                    te = re || await X();
                if (te) {
                    let ee = [...C.project].filter(j => te.has(j.name));
                    await I({ ...C,
                        project: ee
                    }), await Ul({
                        projectId: p,
                        styles: ee
                    }), window.RM.constructorRouter.trigger("update_from_server", "ListStyles", {
                        project: ee
                    })
                }
            },
            selectStyle: M,
            moveStyle: z,
            deleteStyle: R,
            duplicateStyle: F,
            enterEditMode: D,
            reorderStyle: A,
            currentTextStyles: T,
            setTextStylesSection: v,
            textStylesSection: w,
            defaultStyleName: "Same as text",
            editable: !0,
            isEmptyGlobalStyles: C.global.length === 0
        })
    }), J3 = FQ
});

function fc({
    renderButton: e,
    value: t,
    accordionValue: o,
    containerHeight: i,
    count: n,
    onCollapseClick: s,
    buttonPadding: a,
    transition: l = {
        mass: 1,
        stiffness: 170,
        damping: 26
    },
    dynamicHeight: c,
    children: d,
    onAnimationStart: p,
    onAnimationComplete: h
}) {
    let u = (0, zr.useRef)(null),
        {
            height: m
        } = xh(u),
        f = (0, zr.useRef)(null),
        {
            height: g
        } = xh(f),
        y = !c,
        [S, w] = (0, zr.useState)(0),
        [v, C] = (0, zr.useState)(!1);
    (0, zr.useEffect)(() => {
        i && n && !c && w(i - n * m)
    }, [i]);
    let I = (0, zr.useMemo)(() => c ? g : S, [c, g, S]),
        T = (0, zr.useMemo)(() => o === t, [o, t]),
        P = (0, zr.useMemo)(() => c ? g && T : S && T, [S, g, T]),
        [M, F] = (0, zr.useState)(!0);
    (0, zr.useEffect)(() => {
        I > 0 && F(!1)
    }, [I]);

    function R() {
        y && C(!0), p ? .()
    }

    function A() {
        y && C(!1), h ? .()
    }
    return x(b, {
        children: [r(b, {
            width: "100%",
            ref: u,
            position: "relative",
            padding: a || "0",
            onClick: () => s && s(t),
            children: e({
                isActive: T
            })
        }), r(b, {
            overflow: "hidden",
            children: d ? r(wt.div, {
                initial: {
                    height: T ? I : 0
                },
                animate: {
                    height: P ? I : 0
                },
                transition: M ? {
                    duration: 0
                } : l,
                onAnimationStart: R,
                onAnimationComplete: A,
                children: y ? r(xo, {
                    freeze: v,
                    children: ({
                        ref: D
                    }) => d(D, T)
                }) : d(f, T)
            }) : null
        })]
    })
}
var zr, Z_ = k(() => {
    "use strict";
    zr = E(N());
    Li();
    ie();
    or();
    x0();
    B()
});

function xm({
    children: e,
    dynamicHeight: t,
    transition: o,
    value: i,
    onChange: n
}) {
    let [s, a] = (0, pr.useState)({
        containerHeight: 0,
        dynamicHeight: t
    }), l = (0, pr.useRef)(null), {
        height: c
    } = xh(l);
    (0, pr.useEffect)(() => {
        a({ ...s,
            containerHeight: c
        })
    }, []), (0, pr.useEffect)(() => {
        a({ ...s,
            containerHeight: c
        })
    }, [c]);
    let d = m => {
            n(m)
        },
        p = pr.Children.map(e, m => (0, pr.isValidElement)(m) ? m : null) ? .filter(Boolean),
        h = pr.Children.count(p),
        u = pr.Children.map(p, m => {
            if (m ? .type === fc) return (0, pr.cloneElement)(m, { ...s,
                transition: o,
                onCollapseClick: d,
                accordionValue: i,
                count: h
            });
            throw new Error("Only Collapse elements can be children of Accordion")
        });
    return r(b, {
        width: "100%",
        height: "100%",
        ref: l,
        children: u
    })
}
var pr, Q3 = k(() => {
    "use strict";
    pr = E(N());
    ie();
    Z_();
    x0();
    B()
});
var X_ = k(() => {
    "use strict";
    Q3();
    Z_()
});
var Ns, DQ, AQ, LQ, py, K_ = k(() => {
    "use strict";
    Ns = E(N());
    ie();
    je();
    kh();
    or();
    Be();
    Yt();
    ae();
    Sh();
    B();
    DQ = (0, Ns.memo)(({
        item: e,
        onSelect: t,
        fontFamily: o,
        fontWeight: i,
        fontStyle: n
    }) => {
        let s = String.fromCharCode(e);
        return r(b, {
            textAlign: "center",
            children: r(K, {
                height: "100%",
                width: "100%",
                variant: "clean",
                onClick: () => t(s),
                children: r($, {
                    "data-char": e,
                    textStyle: "small",
                    fontSize: 16,
                    fontFamily: `${o}, sans-serif`,
                    fontWeight: i,
                    fontStyle: n,
                    children: s
                })
            })
        })
    }), AQ = (0, Ns.memo)(({
        onSelect: e,
        useListFont: t
    }) => {
        let [o, i] = (0, Ns.useState)([]), {
            model: n
        } = (0, Ns.useContext)(Y), [s, a] = n.useSharedState({
            partial: !1
        }), {
            fontFamily: l,
            fontWeight: c,
            fontStyle: d,
            fontInfo: p
        } = Sa(s), {
            fontFamily: h,
            fontWeight: u,
            fontStyle: m,
            fontInfo: f
        } = RI(s, {
            listenFontFeaturesUpdates: !0
        });
        (0, Ns.useEffect)(() => {
            if (!t)
                if (p[0]) {
                    let {
                        characters: y
                    } = p[0];
                    i(y && y.length ? y : [])
                } else i([])
        }, [l, c, d, p, t]), (0, Ns.useEffect)(() => {
            if (t)
                if (f) {
                    let {
                        characters: y
                    } = f;
                    i(y && y.length ? y : [])
                } else i([])
        }, [h, u, m, f, t]);
        let g = y => {
            e ? e(y) : a(Yc({
                editorState: s,
                text: y
            }))
        };
        return r(oi, {
            gridTemplateColumns: "repeat(6, 1fr)",
            gap: 4,
            children: o.map((y, S) => r(DQ, {
                onSelect: g,
                item: y,
                fontFamily: l[0],
                fontWeight: c[0],
                fontStyle: d[0]
            }, S))
        })
    }), LQ = (0, Ns.forwardRef)(({
        onSelect: e,
        useListFont: t
    }, o) => r(b, {
        ref: o,
        backgroundColor: "white",
        borderRadius: "0 0 8px 8px",
        height: 320,
        children: r(xo, {
            children: ({
                ref: i
            }) => r(b, {
                ref: i,
                paddingLeft: "2rm",
                paddingRight: "2rm",
                paddingTop: "2rm",
                paddingBottom: "2rm",
                children: r(AQ, {
                    onSelect: e,
                    useListFont: t
                })
            })
        })
    })), py = LQ
});
var Eu, zQ, eL, tL = k(() => {
    "use strict";
    Eu = E(N());
    nt();
    Vn();
    $e();
    X_();
    je();
    K_();
    yb();
    ve();
    ut();
    B();
    zQ = (0, Eu.forwardRef)(({
        style: e,
        setTextStyle: t,
        closePanel: o
    }, i) => {
        let [n, s] = (0, Eu.useState)(0), a = (0, Eu.useCallback)(l => {
            t && l && t({
                type: "SetInfo",
                payload: {
                    markerContent: l
                }
            }), o()
        }, [t, o]);
        return x(Me, {
            isShowed: !0,
            ref: i,
            style: e,
            gradientBackground: !0,
            children: [r(co, {
                title: "List marker"
            }), r(xm, {
                dynamicHeight: !0,
                value: n,
                onChange: l => s(l),
                children: r(fc, {
                    value: 0,
                    renderButton: ({
                        isActive: l
                    }) => r(H, {
                        showBorder: !l,
                        leftSlot: r(K, {
                            variant: "clean",
                            textStyle: "small",
                            color: l ? "black" : "darkGray",
                            css: Z `
                      &:hover {
                        color: ${ce.black};
                      }
                    `,
                            children: "Glyph"
                        })
                    }),
                    children: l => r(py, {
                        ref: l,
                        onSelect: a,
                        useListFont: !0
                    })
                })
            })]
        })
    }), eL = zQ
});
var Eo, $Q, oL, iL = k(() => {
    "use strict";
    Eo = E(N());
    Ol();
    Be();
    je();
    $e();
    zt();
    Yt();
    ae();
    Dn();
    ni();
    DI();
    _s();
    yb();
    Tr();
    qi();
    tL();
    mp();
    xk();
    Sh();
    ko();
    Mt();
    qi();
    Ss();
    B();
    $Q = (0, Eo.forwardRef)(({
        style: e,
        headerSlot: t,
        getScrollablePanelProps: o
    }, i) => {
        let {
            goBack: n
        } = (0, Eo.useContext)(Jt), {
            model: s,
            modelSet: a
        } = (0, Eo.useContext)(Y), l = (0, Eo.useMemo)(() => s.project.get("_id"), [s]), c = (0, Eo.useMemo)(() => s.user.get("_id"), [s]), [d, p] = s.useSharedState({
            partial: !1
        }), h = (0, Eo.useMemo)(() => tp(d), [d]), u = (0, Eo.useMemo)(() => Xc({
            editorState: d
        }), [d]), m = Sa(d), [f] = Ii(), g = (0, Eo.useMemo)(() => {
            let j = Ko({
                    editorState: d
                }),
                se = [...f.global, ...f.project].find(U => U.name === j),
                {
                    hexa: oe
                } = (() => {
                    let U = Pi(d, "COLOR"),
                        he = U && U.length ? U[0] : void 0,
                        xe = de.textWidget.initialColor;
                    return he ? xe = Yo(he) : se && se.cssProperties.color && (xe = Yo(se.cssProperties.color)), {
                        hexa: ro(xe)
                    }
                })();
            return {
                label: "New style",
                name: `list-style-${zn()}`,
                listPosition: "outside",
                markerContent: "\u2022",
                baselineShift: 0,
                cssProperties: {
                    fontFamily: m.fontFamily[0] || St.fontFamily,
                    fontWeight: `${m.fontWeight[0]}` || `${St.fontWeight}`,
                    fontStyle: m.fontStyle[0] || St.fontStyle,
                    fontSize: m.fontSize[0] || St.fontSize,
                    lineHeight: m.lineHeight[0] || St.lineHeight,
                    color: oe,
                    width: 26
                }
            }
        }, []), {
            selectedFont: y,
            selectedListStyle: S,
            selectedTextStyleSection: w,
            setChangedListStyle: v,
            changedListStyle: C,
            setSelectedFont: I,
            setEditorStateBackup: T
        } = (0, Eo.useContext)(tn), P = (0, Eo.useMemo)(() => w || "project", [w]), [M, F] = El(), R = P === "global" ? M.global : M.project, A = (0, Eo.useMemo)(() => {
            if (S) return S; {
                let j = { ...M,
                    [P]: [...M[P], { ...g
                    }]
                };
                return F(j), j[P].find(oe => oe.name === g.name) || {}
            }
        }, [S]), [D, O] = (0, Eo.useReducer)(gb(), A);
        (0, Eo.useEffect)(() => {
            O({
                type: "Reset",
                payload: { ...A
                }
            })
        }, [S]);
        let L = () => {
            let j = R.findIndex(se => se.name === D.name);
            if (j > -1) {
                let se = [...R];
                se[j] = { ...D
                }, F({ ...M,
                    [P]: se
                })
            }
        };
        (0, Eo.useEffect)(() => {
            L(), v && v(D)
        }, [D]), (0, Eo.useEffect)(() => {
            if (!S) {
                let j = hp({
                    style: D,
                    currentStyle: u,
                    editorState: d
                });
                p(At(j, d.getSelection()))
            }
        }, []);
        let W = async () => {
            let j = [...R],
                se = j.findIndex(oe => oe.name === D.name);
            v && v(void 0), T && T(void 0), se < 0 ? j.push(D) : j[se] = { ...D
            }, F({ ...M,
                [P]: j
            }), P === "global" ? await nd({
                userId: c,
                styles: j
            }) : await Ul({
                projectId: l,
                styles: j
            }), window.RM.constructorRouter.trigger("update_from_server", "ListStyles", {
                [P]: j
            })
        };
        (0, Eo.useEffect)(() => {
            if (C) {
                let j = { ...C
                };
                y && (j.cssProperties.fontFamily = y.css_name, I && I(void 0)), O({
                    type: "Reset",
                    payload: j
                })
            } else y && (O({
                type: "SetCss",
                payload: {
                    fontFamily: y.css_name
                }
            }), I && I(void 0))
        }, []);
        let z = () => {
                n()
            },
            V = async () => {
                await W(), n()
            },
            X = j => a({
                preventClose: j
            }),
            [q, ne] = (0, Eo.useState)(!1),
            re = (0, Eo.useCallback)(() => ne(!0), []),
            te = (0, Eo.useCallback)(() => ne(!1), []),
            ee = x(Q, {
                children: [r(H, {
                    leftSlot: "Align",
                    rightSlot: r(K, {
                        position: "relative",
                        top: "-2px",
                        "data-testid": "list-style-position",
                        onClick: () => {
                            O({
                                type: "SetInfo",
                                payload: {
                                    listPosition: D.listPosition === "outside" ? "inside" : "outside"
                                }
                            })
                        },
                        children: r($, {
                            color: "blue",
                            textStyle: "small",
                            children: D.listPosition === "outside" ? "On" : "Off"
                        })
                    })
                }), h === "unordered-list-item" && r(H, {
                    leftSlot: "Marker",
                    rightSlot: D.markerContent || "\u2022",
                    onClick: re
                }), r(H, {
                    leftSlot: "Baseline shift",
                    rightSlot: r(fe, {
                        value: D.baselineShift || 0,
                        min: -99,
                        max: 99,
                        textAlign: "right",
                        autoWidth: !0,
                        onChange: ({
                            value: j
                        }) => {
                            O({
                                type: "SetInfo",
                                payload: {
                                    baselineShift: j
                                }
                            })
                        }
                    })
                })]
            });
        return x(Q, {
            children: [!q && r(bb, {
                style: e,
                ref: i,
                headerSlot: t,
                onCancel: z,
                onDone: V,
                textStyle: D,
                setTextStyle: O,
                projectId: l,
                userId: c,
                initialTextStyle: A,
                isNewStyle: !S,
                onToggleSelectPanel: X,
                additionalSettings: ee,
                getScrollablePanelProps: o
            }), h === "unordered-list-item" && q && r(eL, {
                style: e,
                ref: i,
                setTextStyle: O,
                closePanel: te
            })]
        })
    }), oL = $Q
});

function nL({
    navigatorRef: e
}) {
    return r(Ut, {
        leftSlot: r(K, {
            "data-testid": "text-typography-back",
            variant: "clean",
            onClick: () => e.current && e.current.goBack(),
            css: Z `
            &:hover svg {
              color: ${ce.black};
              opacity: 1;
            }
          `,
            children: r(_r, {
                color: "darkGray"
            })
        })
    })
}

function jQ() {
    let {
        model: e
    } = (0, an.useContext)(Y), t = (0, an.useRef)(null), [, o] = e.useSharedState({
        partial: !1
    }), {
        canControlBeClosed: i,
        onStackUpdated: n
    } = As(t.current);
    e.injectedRefs.canControlBeClosed = i;
    let [, s] = El(), [, a] = (0, an.useState)(""), l = C => {
        m({
            selectedFont: C
        })
    }, c = C => {
        m({
            selectedListStyle: C
        })
    }, d = C => {
        m({
            selectedTextStyleSection: C
        })
    }, p = C => {
        m({
            changedListStyle: C
        })
    }, h = C => {
        m({
            editorStateBackup: C
        })
    }, [u, m] = (0, an.useReducer)(Hx, {
        setSelectedFont: l,
        setSelectedListStyle: c,
        setSelectedTextStyleSection: d,
        setChangedListStyle: p,
        setEditorStateBackup: h
    }), f = async () => {
        let {
            listStyles: C
        } = await Nf();
        m({
            changedListStyle: void 0,
            selectedListStyle: void 0
        }), s({ ...C
        })
    }, g = ({
        prev: C
    }) => {
        a(C)
    };
    (0, an.useEffect)(() => {
        (!e.visible || !e.selected) && u.changedListStyle && f()
    }, [e.selected, e.visible, u.changedListStyle]);
    let y = (0, an.useCallback)(C => {
            if (C.preventDefault(), !e.disabled) {
                if (t.current && t.current.currentScreen !== "Typography") {
                    if (e.selected) {
                        t.current.goBack();
                        return
                    }
                    m({ ...u,
                        selectedFont: void 0,
                        selectedTextStyle: void 0
                    }), t.current.goHome()
                }
                e.select()
            }
        }, [e.disabled, e.selected, t.current, u]),
        [S, w] = (0, an.useState)([]),
        v = C => {
            let I = S[S.length - 1],
                T = C[C.length - 1];
            I === "StyleEdit" && T !== "FontsList" && u.changedListStyle && (f(), u.editorStateBackup && (o(u.editorStateBackup[0]), u.setEditorStateBackup && u.setEditorStateBackup(void 0))), w(C), n(C)
        };
    return r(Ie, {
        control: ({
            ref: C
        }) => r(ke, {
            ref: C,
            label: "Advanced Typography",
            onClick: y,
            children: r(Za, {
                color: "white"
            })
        }),
        panel: ({
            ref: C,
            style: I,
            update: T,
            getScrollablePanelProps: P
        }) => e.selected ? r(tn.Provider, {
            value: u,
            children: r(OQ, {
                ref: C,
                style: I,
                navigatorRef: t,
                onNavigate: g,
                onStackUpdated: v,
                update: T,
                getScrollablePanelProps: P
            })
        }) : null
    })
}
var an, WQ, OQ, rL, sL = k(() => {
    "use strict";
    an = E(N());
    Rf();
    ae();
    ht();
    K3();
    ni();
    zI();
    Tr();
    Ix();
    Qp();
    q3();
    iL();
    qi();
    je();
    ut();
    qc();
    Sh();
    gn();
    ve();
    B();
    WQ = (0, an.forwardRef)(({
        style: e,
        headerSlot: t,
        fontControllerFontFamily: o
    }, i) => {
        let {
            selectedListStyle: n
        } = (0, an.useContext)(tn), s = n ? .cssProperties.fontFamily || o;
        return r(sb, {
            style: e,
            ref: i,
            headerSlot: t,
            currentFontFamily: s
        })
    }), OQ = (0, an.forwardRef)(({
        navigatorRef: e,
        update: t,
        onStackUpdated: o,
        onNavigate: i,
        style: n,
        getScrollablePanelProps: s
    }, a) => {
        let {
            model: l
        } = (0, an.useContext)(Y), [c] = l.useSharedState({
            partial: !1
        }), d = Sa(c);
        return x(Pr, {
            ref: e,
            initialScreen: "Typography",
            onStackUpdated: o,
            onNavigate: p => {
                i(p), t()
            },
            children: [r(lo, {
                screen: "Typography",
                children: r(X3, {
                    ref: a,
                    style: n,
                    onHeightChanged: t,
                    getScrollablePanelProps: s
                })
            }), r(lo, {
                screen: "FontsList",
                children: r(WQ, {
                    ref: a,
                    style: n,
                    headerSlot: r(nL, {
                        navigatorRef: e
                    }),
                    fontControllerFontFamily: d.fontFamily[0]
                })
            }), r(lo, {
                screen: "FontUploader",
                children: r(Ta, {
                    ref: a,
                    style: n
                })
            }), r(lo, {
                screen: "Styles",
                children: r(J3, {
                    ref: a,
                    style: n,
                    onHeightChanged: t,
                    headerSlot: r(nL, {
                        navigatorRef: e
                    })
                })
            }), r(lo, {
                screen: "StyleEdit",
                children: r(oL, {
                    ref: a,
                    style: n,
                    getScrollablePanelProps: s
                })
            })]
        })
    });
    rL = jQ
});
var aL, lL = k(() => {
    "use strict";
    ae();
    sL();
    aL = Ce.extend({
        name: "text_advanced_typography",
        component: rL,
        rolePermission: "TextCanChangeAdvancedTypography"
    })
});

function NQ({
    onBoxClick: e,
    template: t
}) {
    let o = a => {
            a.currentTarget.currentTime = 0, a.currentTarget.pause()
        },
        i = !!t.previewVideoFileName,
        n = `${t.basePath}/000001.${t.fileExtension}`,
        s = t.fileExtension === "png";
    return r(b, {
        css: Z `
        &::before {
          content: '';
          position: relative;
          display: block;
          padding-bottom: 100%;
        }
      `,
        position: "relative",
        width: "calc(33% - 10px)",
        display: "inline-block",
        marginRight: 10,
        marginBottom: 10,
        background: !i && s ? "#f4f4f4" : "",
        backgroundPosition: i ? "" : "center",
        backgroundSize: i ? "" : "cover",
        backgroundImage: i ? "" : `url(${n})`,
        cursor: "pointer",
        onClick: () => e(t),
        children: i && r(HQ, {
            src: `${t.basePath}/${t.previewVideoFileName}`,
            onMouseEnter: a => a.currentTarget.play(),
            onMouseLeave: o,
            onEnded: a => a.currentTarget.play()
        })
    })
}
var HQ, cL, dL = k(() => {
    "use strict";
    ie();
    ve();
    B();
    HQ = ue("video")
    `
  position: absolute;
  top: 0;
  left: 0;
  display: block;
  width: 100%;
  height: 100%;
`;
    cL = NQ
});
var UQ, VQ, pL, uL = k(() => {
    "use strict";
    ve();
    ie();
    B();
    UQ = e => x("svg", {
        width: 158,
        height: 44,
        viewBox: "0 0 158 44",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M22 43.0833C33.644 43.0833 43.0833 33.644 43.0833 22C43.0833 10.356 33.644 0.916667 22 0.916667C10.356 0.916667 0.916667 10.356 0.916667 22C0.916667 33.644 10.356 43.0833 22 43.0833ZM22 44C34.1503 44 44 34.1503 44 22C44 9.84974 34.1503 0 22 0C9.84974 0 0 9.84974 0 22C0 34.1503 9.84974 44 22 44Z",
            fill: "black"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M19.6166 16.8747V26.2086C19.6166 27.9343 18.1802 29.3333 16.4083 29.3333C14.6364 29.3333 13.2 27.9343 13.2 26.2086V16.8747C13.2 15.149 14.6364 13.75 16.4083 13.75C18.1802 13.75 19.6166 15.149 19.6166 16.8747ZM30.6166 16.8747V26.2086C30.6166 27.9343 29.1802 29.3333 27.4083 29.3333C25.6364 29.3333 24.2 27.9343 24.2 26.2086V16.8747C24.2 15.149 25.6364 13.75 27.4083 13.75C29.1802 13.75 30.6166 15.149 30.6166 16.8747Z",
            fill: "white"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M30.6187 25.9321V17.2684C30.6187 15.6666 29.3202 14.3681 27.7184 14.3681C26.1166 14.3681 24.8181 15.6666 24.8181 17.2684V25.9321C24.8181 27.5339 26.1166 28.8324 27.7184 28.8324C29.3202 28.8324 30.6187 27.5339 30.6187 25.9321ZM27.7184 13.2917C25.5221 13.2917 23.7416 15.0721 23.7416 17.2684V25.9321C23.7416 28.1284 25.5221 29.9088 27.7184 29.9088C29.9147 29.9088 31.6951 28.1284 31.6951 25.9321V17.2684C31.6951 15.0721 29.9147 13.2917 27.7184 13.2917Z",
            fill: "black"
        }), r("path", {
            d: "M23.7416 26.4351C23.7416 24.2388 25.5221 22.4583 27.7184 22.4583V22.4583C29.9147 22.4583 31.6951 24.2388 31.6951 26.4351V26.4351C31.6951 28.6314 29.9147 30.4118 27.7184 30.4118V30.4118C25.5221 30.4118 23.7416 28.6314 23.7416 26.4351V26.4351Z",
            fill: "black"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M19.1604 25.9321V17.2684C19.1604 15.6666 17.8619 14.3681 16.2601 14.3681C14.6582 14.3681 13.3597 15.6666 13.3597 17.2684V25.9321C13.3597 27.5339 14.6582 28.8324 16.2601 28.8324C17.8619 28.8324 19.1604 27.5339 19.1604 25.9321ZM16.2601 13.2917C14.0638 13.2917 12.2833 15.0721 12.2833 17.2684V25.9321C12.2833 28.1284 14.0638 29.9088 16.2601 29.9088C18.4564 29.9088 20.2368 28.1284 20.2368 25.9321V17.2684C20.2368 15.0721 18.4564 13.2917 16.2601 13.2917Z",
            fill: "black"
        }), r("path", {
            d: "M12.2833 26.4351C12.2833 24.2388 14.0638 22.4583 16.2601 22.4583V22.4583C18.4564 22.4583 20.2368 24.2388 20.2368 26.4351V26.4351C20.2368 28.6314 18.4564 30.4118 16.2601 30.4118V30.4118C14.0638 30.4118 12.2833 28.6314 12.2833 26.4351V26.4351Z",
            fill: "black"
        }), r("path", {
            d: "M60.324 29H62.15L65.714 18.022L69.256 29H71.082L76.406 13.6H73.744L70.092 24.798L66.638 13.6H64.768L61.314 24.798L57.662 13.6H55L60.324 29Z",
            fill: "black"
        }), r("path", {
            d: "M80.327 29.264C81.581 29.264 82.989 28.648 83.605 27.614V29H86.003V18.748H83.605V20.134C82.989 19.1 81.757 18.484 80.393 18.484C77.203 18.484 75.289 20.86 75.289 23.874C75.289 26.888 77.027 29.264 80.327 29.264ZM80.679 27.13C78.809 27.13 77.687 25.744 77.687 23.874C77.687 22.004 78.809 20.618 80.679 20.618C82.725 20.618 83.715 22.114 83.715 23.874C83.715 25.634 82.725 27.13 80.679 27.13Z",
            fill: "black"
        }), r("path", {
            d: "M88.6385 29H91.0365V23.368C91.0365 21.564 91.9165 20.53 93.4785 20.53C95.1505 20.53 95.7225 21.476 95.7225 23.654V29H98.1205V22.554C98.1205 19.87 96.8445 18.484 94.3805 18.484C92.8625 18.484 91.6745 19.078 91.0365 20.178V18.748H88.6385V29Z",
            fill: "black"
        }), r("path", {
            d: "M100.659 29H103.057V23.368C103.057 21.564 103.937 20.53 105.499 20.53C107.171 20.53 107.743 21.476 107.743 23.654V29H110.141V22.554C110.141 19.87 108.865 18.484 106.401 18.484C104.883 18.484 103.695 19.078 103.057 20.178V18.748H100.659V29Z",
            fill: "black"
        }), r("path", {
            d: "M116.948 29.264C118.202 29.264 119.61 28.648 120.226 27.614V29H122.624V18.748H120.226V20.134C119.61 19.1 118.378 18.484 117.014 18.484C113.824 18.484 111.91 20.86 111.91 23.874C111.91 26.888 113.648 29.264 116.948 29.264ZM117.3 27.13C115.43 27.13 114.308 25.744 114.308 23.874C114.308 22.004 115.43 20.618 117.3 20.618C119.346 20.618 120.336 22.114 120.336 23.874C120.336 25.634 119.346 27.13 117.3 27.13Z",
            fill: "black"
        }), r("path", {
            d: "M129.902 26.976C128.956 26.976 128.406 26.756 128.406 24.974V20.75H130.76V18.748H128.406V15.646H126.008V18.748H124.27V20.75H126.008V25.524C126.008 28.978 128.164 29.132 129.33 29.132C130.034 29.132 130.738 29.066 131.112 29V26.888C130.87 26.932 130.276 26.976 129.902 26.976Z",
            fill: "black"
        }), r("path", {
            d: "M138.619 18.484C137.101 18.484 135.913 19.078 135.275 20.178V13.6H132.877V29H135.275V23.368C135.275 21.564 136.155 20.53 137.717 20.53C139.389 20.53 139.961 21.476 139.961 23.654V29H142.359V22.554C142.359 19.87 141.083 18.484 138.619 18.484Z",
            fill: "black"
        }), r("path", {
            d: "M146.107 17.274C147.163 17.274 147.889 16.482 147.889 15.492C147.889 14.502 147.163 13.71 146.107 13.71C145.051 13.71 144.326 14.502 144.326 15.492C144.326 16.482 145.051 17.274 146.107 17.274ZM144.897 29H147.296V18.748H144.897V29Z",
            fill: "black"
        }), r("path", {
            d: "M153.522 29.264C156.14 29.264 157.57 27.878 157.57 25.92C157.57 24.6 156.58 23.566 155.194 23.17L152.752 22.466C152.224 22.312 151.872 21.938 151.872 21.366C151.872 20.728 152.51 20.31 153.346 20.31C154.468 20.31 155.128 20.816 155.128 21.674H157.482C157.482 19.848 156.118 18.484 153.434 18.484C151.058 18.484 149.496 19.826 149.496 21.498C149.496 22.862 150.2 23.918 151.718 24.336L154.358 25.062C154.952 25.216 155.128 25.678 155.128 26.14C155.128 26.866 154.556 27.35 153.654 27.35C152.422 27.35 151.564 26.734 151.564 25.854H149.166C149.166 27.724 150.882 29.264 153.522 29.264Z",
            fill: "black"
        })]
    }), VQ = b.withComponent(ue(UQ)
        `
      display: block;
    `), pL = VQ
});
var hL, mL = k(() => {
    "use strict";
    hL = e => {
        let t = e.filter(({
                previewVideoFileName: i
            }) => !i),
            o = [];
        for (let i of t) {
            let n = new Promise(s => {
                let a = new Image;
                a.onload = () => s(), a.onerror = () => s(), a.src = `${i.basePath}/000001.${i.fileExtension}`
            });
            o.push(n)
        }
        return Promise.all(o)
    }
});

function GQ({
    active: e,
    onClose: t,
    shotsTemplateSuccess: o,
    shotsTemplateStart: i
}) {
    let {
        modelSave: n
    } = (0, gc.useContext)(ge), [s, a] = (0, gc.useState)(null), [l, c] = (0, gc.useState)(!1), [d, p] = (0, gc.useState)(!1), h = Bp({
        watchingClick: d,
        callback: t
    }), u = async () => {
        c(!0);
        let g = await s1();
        await hL(g), a(g), c(!1), p(!0)
    };
    (0, gc.useEffect)(() => {
        e && u(), e || p(!1)
    }, [e]);
    let m = async g => {
            let {
                width: y,
                height: S
            } = await Gf(`${g.basePath}/000001.${g.fileExtension}`);
            c(!0), i(), n({
                basePath: g.basePath,
                imageWidth: y,
                imageHeight: S,
                numberOfImages: g.numberOfImages,
                firstFrameLambdaUrl: g.firstFrameLambdaUrl,
                fileExtension: g.fileExtension,
                totalSize: g.totalSize
            }, {
                success: () => {
                    setTimeout(() => {
                        o(), t(), De(Fe.WidgetFeature, {
                            featureType: "shots default added"
                        })
                    }, 200)
                }
            })
        },
        f = {
            duration: .1
        };
    return r(wo, {
        children: e ? r(wt.div, {
            style: {
                position: "fixed",
                zIndex: 9999
            },
            transition: f,
            initial: {
                opacity: 0
            },
            animate: {
                opacity: 1
            },
            exit: {
                opacity: 0
            },
            children: r(Sp, {
                backgroundColor: "rgba(0, 0, 0, 0.2)",
                perspective: "600px",
                opacity: 1,
                pointerEvents: e ? "all" : "none",
                children: r(wt.div, {
                    ref: h,
                    style: {
                        position: "absolute",
                        left: "50%",
                        top: "50%"
                    },
                    transition: f,
                    initial: {
                        z: -100,
                        y: -20,
                        rotateX: 13,
                        opacity: 0
                    },
                    animate: {
                        z: 0,
                        y: 0,
                        rotateX: 0,
                        opacity: 1
                    },
                    exit: {
                        z: -100,
                        y: 20,
                        rotateX: -13,
                        opacity: 0
                    },
                    children: x(b, {
                        position: "absolute",
                        left: "50%",
                        top: "50%",
                        transform: "translate(-50%, -50%)",
                        width: "640px",
                        paddingTop: "38px",
                        background: "white",
                        borderRadius: "12px",
                        children: [r(b, {
                            height: "395px",
                            padding: "0 28px 0 38px",
                            marginBottom: "15px",
                            children: r(xo, {
                                alwaysActiveBar: !0,
                                children: ({
                                    ref: g
                                }) => r(b, {
                                    ref: g,
                                    children: l ? r(b, {
                                        position: "absolute",
                                        top: "50%",
                                        left: "50%",
                                        transform: "translate(-50%, -50%)",
                                        children: r(_o, {})
                                    }) : r(b, {
                                        marginTop: 10,
                                        children: s ? .map(y => r(cL, {
                                            template: y,
                                            onBoxClick: () => m(y)
                                        }, y._id))
                                    })
                                })
                            })
                        }), r(b, {
                            padding: "0 38px 0 15px",
                            marginBottom: 10,
                            display: "flex",
                            children: r(b, {
                                as: "a",
                                href: "https://wannathis.one/",
                                target: "_blank",
                                display: "block",
                                padding: "5px",
                                marginLeft: "-5px",
                                opacity: .5,
                                transition: "opacity 0.2s ease-out",
                                css: Z `
                      &:hover {
                        opacity: 1;
                      }

                      img {
                        display: block;
                      }
                    `,
                                children: r(pL, {
                                    viewBox: "0 0 158 44",
                                    width: 102,
                                    height: 28,
                                    alt: "wannathis logo"
                                })
                            })
                        })]
                    })
                })
            })
        }) : null
    })
}
var gc, fL, gL = k(() => {
    "use strict";
    gc = E(N());
    ie();
    qt();
    Vv();
    or();
    Bs();
    ew();
    ve();
    Li();
    Le();
    AH();
    OI();
    dL();
    uL();
    mL();
    B();
    fL = GQ
});

function YQ({
    width: e,
    height: t
}) {
    return x("svg", {
        width: e,
        height: t,
        viewBox: "0 0 44 44",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M22 43.0833C33.644 43.0833 43.0833 33.644 43.0833 22C43.0833 10.356 33.644 0.916667 22 0.916667C10.356 0.916667 0.916667 10.356 0.916667 22C0.916667 33.644 10.356 43.0833 22 43.0833ZM22 44C34.1503 44 44 34.1503 44 22C44 9.84974 34.1503 0 22 0C9.84974 0 0 9.84974 0 22C0 34.1503 9.84974 44 22 44Z",
            fill: "black"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M19.6166 16.8747V26.2086C19.6166 27.9343 18.1802 29.3333 16.4083 29.3333C14.6364 29.3333 13.2 27.9343 13.2 26.2086V16.8747C13.2 15.149 14.6364 13.75 16.4083 13.75C18.1802 13.75 19.6166 15.149 19.6166 16.8747ZM30.6166 16.8747V26.2086C30.6166 27.9343 29.1802 29.3333 27.4083 29.3333C25.6364 29.3333 24.2 27.9343 24.2 26.2086V16.8747C24.2 15.149 25.6364 13.75 27.4083 13.75C29.1802 13.75 30.6166 15.149 30.6166 16.8747Z",
            fill: "white"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M30.6187 25.9321V17.2684C30.6187 15.6666 29.3202 14.3681 27.7184 14.3681C26.1166 14.3681 24.8181 15.6666 24.8181 17.2684V25.9321C24.8181 27.5339 26.1166 28.8324 27.7184 28.8324C29.3202 28.8324 30.6187 27.5339 30.6187 25.9321ZM27.7184 13.2917C25.5221 13.2917 23.7416 15.0721 23.7416 17.2684V25.9321C23.7416 28.1284 25.5221 29.9088 27.7184 29.9088C29.9147 29.9088 31.6951 28.1284 31.6951 25.9321V17.2684C31.6951 15.0721 29.9147 13.2917 27.7184 13.2917Z",
            fill: "black"
        }), r("path", {
            d: "M23.7416 26.4351C23.7416 24.2388 25.5221 22.4584 27.7184 22.4584V22.4584C29.9147 22.4584 31.6951 24.2388 31.6951 26.4351V26.4351C31.6951 28.6314 29.9147 30.4119 27.7184 30.4119V30.4119C25.5221 30.4119 23.7416 28.6314 23.7416 26.4351V26.4351Z",
            fill: "black"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M19.1604 25.9321V17.2684C19.1604 15.6666 17.8619 14.3681 16.2601 14.3681C14.6582 14.3681 13.3597 15.6666 13.3597 17.2684V25.9321C13.3597 27.5339 14.6582 28.8324 16.2601 28.8324C17.8619 28.8324 19.1604 27.5339 19.1604 25.9321ZM16.2601 13.2917C14.0638 13.2917 12.2833 15.0721 12.2833 17.2684V25.9321C12.2833 28.1284 14.0638 29.9088 16.2601 29.9088C18.4564 29.9088 20.2368 28.1284 20.2368 25.9321V17.2684C20.2368 15.0721 18.4564 13.2917 16.2601 13.2917Z",
            fill: "black"
        }), r("path", {
            d: "M12.2833 26.4351C12.2833 24.2388 14.0638 22.4584 16.2601 22.4584V22.4584C18.4564 22.4584 20.2368 24.2388 20.2368 26.4351V26.4351C20.2368 28.6314 18.4564 30.4119 16.2601 30.4119V30.4119C14.0638 30.4119 12.2833 28.6314 12.2833 26.4351V26.4351Z",
            fill: "black"
        })]
    })
}
var bL, yL = k(() => {
    "use strict";
    B();
    bL = YQ
});

function ZQ(e) {
    let {
        model: {
            basePath: t,
            imageHeight: o,
            imageWidth: i,
            totalSize: n,
            numberOfImages: s,
            _id: a
        }
    } = (0, Ri.useContext)(ge), {
        model: l
    } = (0, Ri.useContext)(Y), [c, d] = (0, Ri.useState)(!1), [p, h] = (0, Ri.useState)(!1), [u, m] = (0, Ri.useState)(!0), [f, g] = (0, Ri.useState)(!1), [y, S] = (0, Ri.useState)(""), [w, v] = (0, Ri.useState)(""), [C, I] = (0, Ri.useState)(!1), [T, P] = (0, Ri.useState)(!1), M = t && o && i && n && s, F = (0, Ri.useRef)(null), [{
        isUploading: R,
        uploadError: A,
        url: D,
        canDirectLinkBeUsed: O
    }, L] = e.useSharedState(), W = l && l.page && l.page.workspace && l.page.workspace.controls && l.page.workspace.controls.findControl("playback_settings");
    (0, Ri.useEffect)(() => {
        t && o && i && s && n && typeof R == "boolean" && !R && !A && W && l && l.selected && W.master.select(W)
    }, [R]), (0, Ri.useEffect)(() => {
        A && A.length && setTimeout(() => {
            L({
                uploadError: "",
                url: ""
            }), m(!0), d(!1), y && S("")
        }, 4e3)
    }, [A]);
    let z = () => {
            L({
                url: ""
            }), m(!0), d(!1)
        },
        V = se => {
            w === "Your Dropbox link is incorrect. Please select your file in Dropbox and click on the Share button to get a correct link." || se === "Your Dropbox link is incorrect. Please select your file in Dropbox and click on the Share button to get a correct link." && w !== "Your Dropbox link is incorrect. Please select your file in Dropbox and click on the Share button to get a correct link." ? (v(""), setTimeout(() => {
                v(se)
            }, 0)) : v(se)
        },
        X = (se, oe) => {
            let U = se.match(/\.(webm|mpg|mp2|mpeg|mpe|mpv|ogg|ogv|mp4|m4p|m4v|avi|wmv|mov|qt|flv|swf|avchd|ts|3g|3g2)$/i) !== null;
            h(!U && se.length > 0), V(U ? "" : "Your link is incorrect. Please enter the valid link."), L({
                url: `${U?oe||se:""}`
            })
        };
    (0, Ri.useEffect)(() => {
        let se = y.match(/(youtu\.be|youtube\.com)/),
            oe = y.match(/(vimeo\.com)/),
            U = y.match(/(dropbox\.com)/);
        if (!y.length) {
            h(!1), v("");
            return
        }
        if (se !== null || oe !== null) {
            h(!0), V(se !== null ? "Upload from Youtube is not supported." : "Upload from Vimeo is not supported.");
            return
        }
        if (U)
            if (y.match(/preview/)) {
                V("Your Dropbox link is incorrect. Please select your file in Dropbox and click on the Share button to get a correct link."), h(!0);
                return
            } else {
                let xe = new URL(y),
                    pe = y.indexOf("?"),
                    J = y.substring(0, pe !== -1 ? pe : y.length);
                xe.searchParams.set("dl", "1"), X(J, xe.href)
            }
        else X(y)
    }, [y]);
    let q = se => {
            if (se !== null) return se.toString().split("").reverse().map((oe, U) => U !== 0 && U % 3 === 0 ? `${oe}.` : oe).reverse().join("")
        },
        ne = se => {
            let {
                errorMsg: oe,
                validated: U,
                uploadLimit: he
            } = a1(se);
            oe ? pt("constructor.newUploadLimits") && typeof he == "number" ? Jo("shots-widget-limit", {
                currentLimit: he
            }) : alert(oe) : L({
                files: U,
                isUploading: !0
            }), C && I(!1)
        },
        re = () => R ? M ? "Replacing..." : "Uploading..." : M ? "Replace shots" : "Shots",
        te = !!(f || R || A || !t || !o || !i || !s || !n),
        ee = !R && !(A && A.length),
        j = (0, Ri.useCallback)(se => {
            se.preventDefault(), !l.disabled && (!l.selected && f && g(!1), l.select(), D && z())
        }, [l.disabled, l.selected, f]);
    return x(Q, {
        children: [r(Ie, {
            control: ({
                ref: se
            }) => r(ke, {
                ref: se,
                label: "Shots settings",
                onClick: j,
                children: r(Pp, {})
            }),
            panel: ({
                ref: se,
                style: oe
            }) => r(Me, {
                ref: se,
                style: oe,
                isShowed: l.selected,
                children: r(Ot.Consumer, {
                    children: () => r(Q, {
                        children: te ? r(et, {
                            text: w,
                            open: w.length ? void 0 : !1,
                            placement: "left",
                            enterDelay: 2,
                            indent: 4,
                            componentsProps: {
                                tooltip: {
                                    backgroundColor: "tomato",
                                    display: "flex",
                                    flexDirection: "column",
                                    width: "310px",
                                    height: "auto",
                                    whiteSpace: "pre-line"
                                }
                            },
                            children: r(Q, {
                                children: x(b, {
                                    className: "drag-events",
                                    padding: "5px 8px",
                                    onDragOver: () => {
                                        I(!0)
                                    },
                                    userSelect: "none",
                                    cursor: "default",
                                    minHeight: "119px",
                                    css: Z `
                            & > label {
                              position: ${C?"absolute":"relative"};
                              top: 0;
                              left: 0;
                              width: ${C?"100%":"auto"};
                              height: ${C?"100%":"auto"};
                              display: block;
                              margin-bottom: 36px;
                            }
                          `,
                                    width: "100%",
                                    height: "100%",
                                    children: [x(vi, {
                                        onClick: U => {
                                            R && c && U.preventDefault()
                                        },
                                        id: `rm-shots-panel-main-file-upload-${a}`,
                                        cursor: R ? "default" : "pointer",
                                        readFileData: !1,
                                        onChangeMultiple: ne,
                                        dropFile: !R,
                                        multiple: !0,
                                        accept: "image/png, image/jpeg, video/*, .mkv",
                                        children: [x(b, {
                                            display: "flex",
                                            justifyContent: "space-between",
                                            cursor: "default",
                                            flexDirection: A && A.length ? "column" : "row",
                                            padding: "0 8px",
                                            paddingBottom: !C || R ? "23px" : "0",
                                            children: [(!C || R) && r($, {
                                                fontSize: "16px",
                                                color: "black",
                                                lineHeight: "1.5",
                                                children: re()
                                            }), A && A.length && r(b, {
                                                paddingTop: "47px",
                                                paddingBottom: "12px",
                                                children: r($, {
                                                    textStyle: "small",
                                                    color: "tomato",
                                                    lineHeight: "1.5",
                                                    children: A
                                                })
                                            }), !M && !R && !A && !C && r(xs, {
                                                href: "https://help.readymag.com/hc/en-us/articles/360045455132",
                                                target: "_blank",
                                                children: r(dt, {
                                                    css: Z `
                                      position: relative;
                                    `,
                                                    color: "transparent",
                                                    marginRight: 0,
                                                    height: 24,
                                                    width: 24,
                                                    hoverColor: "darkGray",
                                                    children: r($, {
                                                        color: "gray",
                                                        lineHeight: "24px",
                                                        textStyle: "small",
                                                        width: "100%",
                                                        position: "absolute",
                                                        top: "50%",
                                                        transform: "translateY(-50%)",
                                                        css: Z `
                                        &:hover {
                                          color: white;
                                        }
                                      `,
                                                        children: "?"
                                                    })
                                                })
                                            })]
                                        }), x(Q, {
                                            children: [ee && r(b, {
                                                position: "relative",
                                                top: C ? "50%" : "0",
                                                transform: C ? "translateY(-50%)" : "none",
                                                height: "max-content",
                                                paddingLeft: C ? 0 : "8px",
                                                paddingRight: C ? 0 : "16px",
                                                textAlign: C ? "center" : "left",
                                                children: r($, {
                                                    textStyle: "small",
                                                    cursor: "pointer",
                                                    color: c ? Ck.transparent : ce.blue,
                                                    display: "block",
                                                    lineHeight: "16px",
                                                    children: C ? "Drop files here" : "Drop video file or image sequence"
                                                })
                                            }), ee && O && !C && x(Q, {
                                                children: [r(Mo, {
                                                    ref: F,
                                                    height: "40px",
                                                    padding: "0 33px 0 8px",
                                                    placeholder: "or paste link to video",
                                                    value: y,
                                                    onChange: U => {
                                                        let he = U.target.value;
                                                        S(he)
                                                    },
                                                    onKeyDown: U => {
                                                        U.keyCode === 13 && D && L({
                                                            isUploading: !0
                                                        })
                                                    },
                                                    textStyle: "small",
                                                    ellipsis: !0,
                                                    border: "none !important",
                                                    spellCheck: !1,
                                                    backgroundColor: u && !c ? "transparent" : "white",
                                                    onFocus: () => d(!0),
                                                    onBlur: () => {
                                                        y.length || d(!1)
                                                    },
                                                    boxSizing: "border-box",
                                                    borderRadius: "8px",
                                                    css: Z `
                                      & {
                                        user-select: text;
                                      }

                                      &::placeholder {
                                        color: ${u?ce.gray:"transparent"};
                                        font-size: 12px;
                                      }
                                    `
                                                }), ee && x(b, {
                                                    position: "absolute",
                                                    right: "4px",
                                                    bottom: "8px",
                                                    children: [D && !p && !!y.length && r(b, {
                                                        children: r(dt, {
                                                            height: 24,
                                                            width: 24,
                                                            onClick: U => {
                                                                U.stopPropagation(), d(!0), L({
                                                                    isUploading: !0
                                                                })
                                                            },
                                                            marginRight: "1px",
                                                            color: "gray",
                                                            hoverColor: "blue",
                                                            display: "block",
                                                            transform: "rotate(-90deg)",
                                                            children: r(Lt, {
                                                                color: "white",
                                                                display: "inline"
                                                            })
                                                        })
                                                    }), p && r(b, {
                                                        children: r(K, {
                                                            onClick: U => {
                                                                U.stopPropagation(), U.preventDefault(), S(""), F && F.current && F.current.focus()
                                                            },
                                                            padding: "6px 5px",
                                                            css: Z `
                                              &:hover {
                                                color: ${ce.red};
                                              }
                                            `,
                                                            children: r(Nt, {
                                                                color: "gray"
                                                            })
                                                        })
                                                    })]
                                                })]
                                            }), R && r(b, {
                                                display: "flex",
                                                flexDirection: "column",
                                                paddingLeft: "8px",
                                                paddingTop: "35px",
                                                cursor: "default",
                                                children: r($, {
                                                    textStyle: "small",
                                                    color: "blue",
                                                    children: "It might take some time"
                                                })
                                            }), C && r(b, {
                                                position: "absolute",
                                                width: "100%",
                                                height: "100%",
                                                left: "0",
                                                top: "0",
                                                onDragLeave: () => I(!1)
                                            })]
                                        })]
                                    }), ee && !C && r(b, {
                                        padding: "0 8px",
                                        children: r(et, {
                                            text: "Gallery",
                                            indent: 4,
                                            placement: "right",
                                            children: r(b, {
                                                onClick: () => P(!0),
                                                cursor: "pointer",
                                                display: "inline-flex",
                                                marginRight: "4px",
                                                opacity: .5,
                                                css: Z `
                                    &:hover {
                                      opacity: 1;
                                    }
                                  `,
                                                children: r(bL, {
                                                    height: "32px",
                                                    width: "32px"
                                                })
                                            })
                                        })
                                    })]
                                })
                            })
                        }) : x(b, {
                            css: Z `
                        label {
                          cursor: default;
                        }
                      `,
                            userSelect: "none",
                            children: [r(vi, {
                                id: `rm-shots-panel-replace-file-upload-${a}`,
                                readFileData: !1,
                                onChangeMultiple: ne,
                                dropFile: !0,
                                onClick: U => {
                                    U.preventDefault()
                                },
                                accept: "image/png, image/jpeg, video/*, .mkv",
                                multiple: !0,
                                children: x(b, {
                                    display: "flex",
                                    padding: "8px 15px 40px",
                                    flexDirection: "column",
                                    children: [r(b, {
                                        paddingBottom: "5px",
                                        children: x($, {
                                            fontSize: "16px",
                                            color: "black",
                                            children: [q(s), " shots loaded"]
                                        })
                                    }), x(b, {
                                        display: "flex",
                                        flexDirection: "column",
                                        children: [x($, {
                                            textStyle: "small",
                                            color: "darkGray",
                                            children: [i, "\xD7", o, " px"]
                                        }), x($, {
                                            textStyle: "small",
                                            color: "darkGray",
                                            children: [Cp(n), " total size"]
                                        })]
                                    })]
                                })
                            }), r(b, {
                                display: "flex",
                                paddingLeft: "15px",
                                paddingRight: "15px",
                                paddingBottom: "16px",
                                children: r(vi, {
                                    id: `rm-shots-button-replace-file-upload-${a}`,
                                    readFileData: !1,
                                    dropFile: !0,
                                    onChangeMultiple: ne,
                                    disabled: O,
                                    accept: "image/png, image/jpeg, video/*, .mkv",
                                    multiple: !0,
                                    children: r(b, {
                                        display: "flex",
                                        width: "136px",
                                        justifyContent: "center",
                                        alignItems: "center",
                                        height: "40px",
                                        backgroundColor: "transparent",
                                        borderRadius: "8px",
                                        cursor: "pointer",
                                        color: "darkGray",
                                        onClick: U => {
                                            U.preventDefault, S(""), g(!0)
                                        },
                                        border: "1px solid rgba(64, 64, 64, 0.08)",
                                        css: Z `
                              &:hover {
                                color: ${ce.black};
                              }
                            `,
                                        children: r($, {
                                            textStyle: "small",
                                            children: "Replace shots"
                                        })
                                    })
                                })
                            })]
                        })
                    })
                })
            })
        }), vL.default.createPortal(r(fL, {
            active: T,
            shotsTemplateStart: () => L({
                isUploading: !0
            }),
            shotsTemplateSuccess: () => {
                g(!1), L({
                    isUploading: !1,
                    uploadError: ""
                })
            },
            onClose: () => P(!1)
        }), document.body)]
    })
}
var Ri, vL, wL, xL = k(() => {
    "use strict";
    Ri = E(N()), vL = E(gi());
    Le();
    ae();
    ht();
    nt();
    ir();
    id();
    ie();
    Be();
    Jr();
    Ur();
    en();
    je();
    ut();
    Ts();
    LH();
    gL();
    yL();
    ve();
    ad();
    jf();
    En();
    Xs();
    B();
    wL = ZQ
});
var _L, SL = k(() => {
    "use strict";
    ae();
    xL();
    _L = Ce.extend({
        name: "shots_settings",
        component: wL,
        rolePermission: "ShotsCanChangeSettings"
    })
});

function KQ({
    onEditScrollSettings: e,
    curOffset: t,
    curStartPoint: o
}) {
    let [i, n] = (0, Fu.useState)(() => t || 0), [s, a] = (0, Fu.useState)(() => o || "bottom"), [l, c] = (0, Fu.useState)(!1), d = (0, Fu.useRef)(null), p = ["top", "center", "bottom"], h = 63, m = {
        top: 0,
        center: .5,
        bottom: 1
    }[s] * h, f = -h * i / window.innerHeight, g = Math.max(Math.min(m + f, h), 0);
    return x(b, {
        display: "flex",
        position: "absolute",
        flexDirection: "column",
        alignItems: "center",
        backgroundColor: "white",
        zIndex: 102,
        userSelect: "none",
        borderRadius: "3px",
        height: "222px",
        width: "120px",
        left: "24px",
        top: "31px",
        boxShadow: "0 0 0 1px rgba(0, 0, 0, 0.0672)",
        onClick: y => {
            y.stopPropagation()
        },
        children: [r(b, {
            display: "flex",
            flexDirection: "column",
            paddingTop: "8px",
            children: p.map((y, S) => {
                let w = s === y;
                return r(b, {
                    display: "flex",
                    color: w ? "#2c9672" : "black",
                    position: "relative",
                    justifyContent: "center",
                    onClick: () => {
                        a(y), e({
                            offset: i,
                            selectedPoint: y === "bottom" ? "bottom" : y === "center" ? "center" : "top"
                        })
                    },
                    cursor: "pointer",
                    lineHeight: "24px",
                    transition: "all 0.1s ease-out",
                    fontSize: "14px",
                    css: Z `
                &:hover:before {
                  background: ${w?"#2c9672":"rgba(182, 182, 188, 0.48)"};
                }

                &:before {
                  content: '';
                  position: absolute;
                  top: 8px;
                  left: -28px;
                  border-radius: 100%;
                  background: ${w?"#2c9672":"transparent"};
                  height: 6px;
                  width: 6px;
                }
              `,
                    children: be.capitalize(y)
                }, S)
            })
        }), x(b, {
            display: "flex",
            width: "100%",
            flexDirection: "column",
            paddingTop: "8px",
            ref: d,
            textAlign: "center",
            children: [r(b, {
                position: "relative",
                margin: "0 8px",
                paddingTop: "11px",
                css: Z `
            &:after {
              content: '';
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              height: 1px;
              background: linear-gradient(
                to right,
                rgba(61, 61, 61, 0.18) 0%,
                rgba(61, 61, 61, 0.18) 50%,
                transparent 50%,
                transparent 100%
              );
              background-size: 2px 1px;
              background-position: 0 100%;
              background-repeat: repeat-x;
            }
          `,
                children: r($, {
                    fontSize: "14px",
                    color: i > 0 || i < 0 ? "tomato" : "black",
                    children: "Offset"
                })
            }), x(b, {
                display: "flex",
                css: Z `
            &:hover {
              color: tomato;
            }
          `,
                justifyContent: "center",
                children: [r(fe, {
                    value: i,
                    autoWidth: !0,
                    onChange: ({
                        value: y
                    }) => {
                        n(y), e({
                            offset: y,
                            selectedPoint: s === "bottom" ? "bottom" : s === "center" ? "center" : "top"
                        })
                    },
                    placeholder: "0",
                    min: -9999,
                    max: 9999,
                    labelRef: d,
                    height: "24px",
                    color: i !== 0 || l ? "tomato" : "rgba(68, 68, 76, 0.32)",
                    fontSize: "22px",
                    transition: "all 0.1s ease-out",
                    onMouseEnter: () => {
                        c(!0)
                    },
                    onMouseLeave: () => {
                        c(!1)
                    }
                }), r($, {
                    transition: "all 0.1s ease-out",
                    onMouseEnter: () => {
                        c(!0)
                    },
                    onMouseLeave: () => {
                        c(!1)
                    },
                    fontSize: "22px",
                    color: i !== 0 || l ? "tomato" : "rgba(68, 68, 76, 0.32)",
                    children: "px"
                })]
            })]
        }), x(b, {
            display: "flex",
            width: "104px",
            height: "64px",
            position: "relative",
            margin: "7px auto 0",
            boxShadow: "inset 0 0 0 1px #e5e5e5",
            children: [r(b, {
                position: "absolute",
                left: "0",
                right: "0",
                height: "1px",
                top: m,
                background: "linear-gradient(to right, #2c9672 0%, #2c9672 50%, transparent 50%, transparent 100%)",
                backgroundSize: "2px 1px",
                backgroundPosition: "0 100%",
                backgroundRepeat: "repeat-x"
            }), r(b, {
                position: "absolute",
                left: "50%",
                width: "1px",
                backgroundColor: "tomato",
                top: Math.min(m, g),
                bottom: h - Math.max(m, g)
            }), r(b, {
                position: "absolute",
                left: "0",
                right: "0",
                height: "1px",
                backgroundColor: "#2c9672",
                top: g
            })]
        }), r(b, {
            position: "absolute",
            left: "50%",
            width: "12px",
            height: "6px",
            top: "-6px",
            marginLeft: "-6px",
            clip: "rect(0, 111px, 6px, -99px)",
            children: r(b, {
                position: "absolute",
                width: "8px",
                height: "8px",
                left: "2px",
                top: "2px",
                backgroundColor: "white",
                transform: "rotate(45deg)"
            })
        })]
    })
}
var Fu, CL, kL = k(() => {
    "use strict";
    Fu = E(N());
    Wt();
    tw();
    Be();
    zt();
    ie();
    ve();
    B();
    CL = KQ
});

function JQ({
    selectedText: e
}) {
    let {
        modelSet: t
    } = (0, _m.useContext)(ge), {
        model: {
            byStepSpeed: o = 1,
            byStepLoop: i = !0,
            byStepSpringLoop: n = !1,
            pausable: s = !0
        }
    } = (0, _m.useContext)(ge), a = (0, _m.useRef)(null);
    return x(b, {
        children: [x(b, {
            display: "flex",
            flexDirection: "column",
            paddingTop: "12px",
            textAlign: "center",
            height: "84px",
            ref: a,
            backgroundColor: "#4E4E56",
            children: [r($, {
                textStyle: "small",
                color: "white",
                children: "Speed"
            }), x(b, {
                paddingLeft: "27px",
                paddingTop: "1px",
                display: "flex",
                justifyContent: "center",
                alignItems: "center",
                color: "white",
                children: [r(fe, {
                    step: .1,
                    value: o,
                    autoWidth: !0,
                    caretColor: "transparent",
                    labelRef: a,
                    onChange: ({
                        value: l
                    }) => {
                        t({
                            byStepSpeed: l
                        })
                    },
                    placeholder: "1",
                    min: .1,
                    max: 10,
                    height: "40px",
                    color: "white",
                    fontSize: "34px"
                }), r(b, {
                    position: "relative",
                    display: "flex",
                    top: "1px",
                    left: "-3px",
                    children: r($, {
                        fontSize: "34px",
                        lineHeight: "1",
                        color: "white",
                        opacity: "0.3",
                        children: "\xD7"
                    })
                })]
            })]
        }), x(b, {
            display: "flex",
            position: "relative",
            alignItems: "stretch",
            height: "40px",
            backgroundColor: "#4E4E56",
            color: "darkGrey",
            children: [r(b, {
                position: "absolute",
                zIndex: 1,
                height: 2,
                left: "16px",
                right: "16px",
                top: "-2px",
                backgroundColor: "gray",
                opacity: .24
            }), r(IL, {
                marginLeft: "16px",
                color: i && n ? "orange" : "darkGrey",
                onClick: () => {
                    t({
                        byStepLoop: !(i && n),
                        byStepSpringLoop: !(i && n)
                    })
                },
                children: r(eI, {})
            }), r($, {
                textStyle: "small",
                color: i ? "orange" : "white",
                margin: "0 auto",
                alignSelf: "center",
                children: "Loop"
            }), r(IL, {
                marginRight: "16px",
                color: i && !n ? "orange" : "darkGrey",
                onClick: () => {
                    t({
                        byStepLoop: i && n ? !0 : !i,
                        byStepSpringLoop: !1
                    })
                },
                children: r(Q0, {})
            })]
        }), x(b, {
            display: "flex",
            position: "relative",
            alignItems: "stretch",
            height: "40px",
            backgroundColor: "#4E4E56",
            color: "darkGrey",
            borderRadius: "0 0 8px 8px",
            children: [r(b, {
                position: "absolute",
                zIndex: 1,
                height: 2,
                top: "-2px",
                left: "16px",
                right: "16px",
                backgroundColor: "gray",
                opacity: .24
            }), x($, {
                textStyle: "small",
                color: s ? "darkGrey" : "orange",
                margin: "0 auto",
                alignSelf: "center",
                padding: "5px",
                cursor: "pointer",
                onClick: () => t({
                    pausable: !s
                }),
                children: ["Restart on ", e]
            })]
        })]
    })
}
var _m, IL, PL, TL = k(() => {
    "use strict";
    _m = E(N());
    ie();
    Be();
    zt();
    cH();
    dH();
    ve();
    Le();
    B();
    IL = ue(b)
    `
  display: flex;
  align-items: center;
  padding: 0 5px;
  cursor: pointer;
`;
    PL = JQ
});

function QQ({
    isStartPopupVisible: e,
    setIsStartPopupVisible: t
}) {
    let {
        model: o
    } = (0, Wa.useContext)(Y), {
        model: i,
        modelSet: n
    } = (0, Wa.useContext)(ge), {
        model: {
            triggers: s,
            _id: a
        }
    } = (0, Wa.useContext)(ge), [l, c] = (0, Wa.useState)("none"), d = s, p = f => {
        n({
            triggers: [...d || [], f]
        }), setTimeout(() => {
            c("none")
        }, 0)
    }, h = f => {
        let g = o.page.workspace.findBlock(f);
        if (a === f) return "Self";
        if (g) return g.model.get("name") || g.getStandardName()
    }, u = (0, Wa.useMemo)(() => o.page.workspace.findBlock(i._id), [i._id]), m = f => {
        u && Lr.highlightActiveTriggerBlock(o.page.workspace, u, f, !1, !0), n({
            triggers: d && d.filter(g => g !== f)
        })
    };
    return (0, Wa.useEffect)(() => (l === "pending" && u && Lr.enterPickTriggerMode(o.page.workspace, u, d, p), () => {
        Lr.leavePickTriggerMode(o.page.workspace)
    }), [l]), o.injectedRefs.canControlBeClosed = () => e ? (t(!1), !0) : l === "pending", x(b, {
        display: "flex",
        flexDirection: "column",
        padding: "0 0 12px",
        children: [d && d.length > 0 && d.map((f, g) => {
            let y = h(f);
            return y && x(b, {
                display: "flex",
                padding: "6px 30px 0 16px",
                marginTop: g > 0 ? "4px" : 0,
                position: "relative",
                children: [r($, {
                    textStyle: "small",
                    color: "black",
                    onMouseOver: () => {
                        u && Lr.highlightActiveTriggerBlock(o.page.workspace, u, f, !0)
                    },
                    onMouseOut: () => {
                        u && Lr.highlightActiveTriggerBlock(o.page.workspace, u, f, !1)
                    },
                    overflow: "hidden",
                    textOverflow: "ellipsis",
                    whiteSpace: "nowrap",
                    css: Z `
                    &:hover {
                      cursor: default;
                      color: ${ce.blue};
                    }
                  `,
                    children: y
                }), r(K, {
                    position: "absolute",
                    top: "7px",
                    right: "18px",
                    onMouseOver: () => {
                        u && Lr.highlightActiveTriggerBlock(o.page.workspace, u, f, !0, !0)
                    },
                    onMouseOut: () => {
                        u && Lr.highlightActiveTriggerBlock(o.page.workspace, u, f, !1, !0)
                    },
                    onClick: () => m(f),
                    display: "flex",
                    height: 16,
                    children: r(Nt, {
                        color: "gray"
                    })
                })]
            }, g)
        }), d && d.length < qQ && x(b, {
            display: "flex",
            padding: "6px 30px 0 16px",
            marginTop: "4px",
            position: "relative",
            children: [x($, {
                onClick: () => {
                    l === "none" && c("pending")
                },
                textStyle: "small",
                opacity: l === "none" ? "0.2" : "1",
                color: l === "pending" ? "blue" : "black",
                cursor: l === "none" ? "pointer" : "default",
                css: Z `
              &:hover {
                opacity: 1;
              }
            `,
                children: [l === "none" ? "Add" : "Choose", " Trigger"]
            }), l === "pending" && r(K, {
                position: "absolute",
                top: "7px",
                right: "18px",
                onClick: () => c("none"),
                display: "flex",
                height: 16,
                children: r(Nt, {
                    color: "gray"
                })
            })]
        })]
    })
}
var Wa, qQ, BL, ML = k(() => {
    "use strict";
    ie();
    je();
    Ts();
    Be();
    ut();
    Wa = E(N());
    ae();
    H_();
    Le();
    ve();
    Mt();
    B();
    qQ = de.TRIGGER_COUNT_LIMIT;
    BL = QQ
});

function oee(e) {
    let [t, o] = (0, xi.useState)(!1), [i, n] = (0, xi.useState)(!1), [s, a] = (0, xi.useState)(0), [l, c] = (0, xi.useState)(!1), d = (0, xi.useRef)(null), p = (0, xi.useRef)(null), {
        model: h,
        modelSet: u
    } = (0, xi.useContext)(Y), {
        model: m,
        modelSet: f,
        modelSave: g
    } = (0, xi.useContext)(ge), {
        model: {
            playbackType: y,
            hoverDirection: S,
            triggers: w,
            scrollSpeed: v,
            scrollStartPoint: C,
            startPointOffset: I,
            scrollDelay: T,
            useEasing: P,
            pausable: M,
            byStepSpeed: F,
            byStepLoop: R,
            byStepSpringLoop: A
        }
    } = (0, xi.useContext)(ge), [{
        viewport: D
    }] = e.useSharedState(), O = D === "default", {
        callback: L
    } = Je(se => {
        f(se), g()
    }, 1e3);
    (0, xi.useEffect)(() => {
        h && h.selected && L(m)
    }, [y, S, w, v, C, I, T, M, F, R, A]);
    let W = y,
        z = S,
        V = v,
        X = C,
        q = I,
        ne = T;
    (0, xi.useEffect)(() => {
        let oe = Math.min(84 * T / window.innerHeight, 84);
        a(oe)
    }, [T]);
    let re = se => {
            f({
                scrollStartPoint: se.selectedPoint
            }), f({
                startPointOffset: se.offset
            })
        },
        te = (0, xi.useRef)(null);
    (0, xi.useEffect)(() => {
        !O && S !== "horizontally" && f({
            hoverDirection: "horizontally"
        })
    }, [D]);
    let ee = (0, xi.useCallback)(se => {
            se.preventDefault(), !h.disabled && h.select()
        }, [h.disabled]),
        j = (0, xi.useMemo)(() => !O && y === "mousemove" ? "Touch move" : !O && y === "hover" ? "Hold" : !O && y === "click" ? "Tap" : O && y === "mousemove" ? "Mouse move" : be.capitalize(y), [O, y]);
    return r(Q, {
        children: r(Ie, {
            control: ({
                ref: se
            }) => r(ke, {
                ref: se,
                label: "Playback settings",
                onClick: ee,
                children: r(Zf, {})
            }),
            panel: ({
                ref: se,
                style: oe
            }) => x(Me, {
                isShowed: h.selected,
                ref: se,
                style: oe,
                children: [x(b, {
                    userSelect: "none",
                    children: [r(b, {
                        position: "relative",
                        zIndex: 105,
                        children: r(Ho, {
                            onToggleDropdown: U => u({
                                preventClose: U
                            }),
                            container: te ? te.current : void 0,
                            isCleanVariant: !1,
                            listItems: [{
                                title: r(b, {
                                    marginTop: "-3px",
                                    marginLeft: "1px",
                                    marginBottom: "1rm",
                                    css: Z `
                            &:hover {
                              * {
                                color: ${ce.red};
                              }
                            }
                          `,
                                    children: r($, {
                                        color: W === "hover" ? "tomato" : "black",
                                        children: O ? "Hover" : "Hold"
                                    })
                                }),
                                onClick: () => {
                                    f({
                                        playbackType: "hover"
                                    })
                                },
                                hoverVariant: ui.unstyled
                            }, {
                                title: r(b, {
                                    marginBottom: "1rm",
                                    css: Z `
                            &:hover {
                              * {
                                color: ${ce.red};
                              }
                            }
                          `,
                                    children: r($, {
                                        color: W === "click" ? "tomato" : "black",
                                        children: O ? "Click" : "Tap"
                                    })
                                }),
                                onClick: () => {
                                    f({
                                        playbackType: "click"
                                    })
                                },
                                hoverVariant: ui.unstyled
                            }, {
                                title: r(b, {
                                    marginBottom: "1rm",
                                    css: Z `
                            &:hover {
                              * {
                                color: ${ce.red};
                              }
                            }
                          `,
                                    children: r($, {
                                        color: W === "mousemove" ? "tomato" : "black",
                                        children: O ? "Mouse move" : "Touch move"
                                    })
                                }),
                                onClick: () => {
                                    f({
                                        playbackType: "mousemove"
                                    })
                                },
                                hoverVariant: ui.unstyled
                            }, {
                                title: r(b, {
                                    css: Z `
                            &:hover {
                              * {
                                color: ${ce.red};
                              }
                            }
                          `,
                                    children: r($, {
                                        color: W === "scroll" ? "tomato" : "black",
                                        children: "Scroll"
                                    })
                                }),
                                onClick: () => {
                                    f({
                                        playbackType: "scroll"
                                    })
                                },
                                hoverVariant: ui.unstyled
                            }],
                            children: ({
                                toggleDropdown: U
                            }) => r(b, {
                                position: "relative",
                                cursor: "pointer",
                                backgroundColor: "lightGray",
                                width: "100%",
                                borderRadius: "8px 8px 0 0",
                                padding: "10px 18px 10px 16px",
                                zIndex: 102,
                                border: "1px solid",
                                borderColor: "lightGray",
                                borderBottomColor: "transparent",
                                transition: "background-color 0.1s",
                                css: Z `
                        &:hover {
                          background-color: #fff;
                          border-bottom-left-radius: ${y==="mousemove"?"8px":"0"};
                          border-bottom-right-radius: ${y==="mousemove"?"8px":"0"};
                        }
                      `,
                                children: x(b, {
                                    display: "flex",
                                    alignItems: "center",
                                    justifyContent: "space-between",
                                    onClick: U,
                                    children: [r($, {
                                        color: "tomato",
                                        fontSize: "16px",
                                        children: j
                                    }), r(Lt, {
                                        color: "gray",
                                        position: "relative",
                                        left: 8
                                    })]
                                })
                            })
                        })
                    }), W === "scroll" && x(b, {
                        position: "relative",
                        children: [l && !m.fixed_position && r(CL, {
                            curOffset: q,
                            curStartPoint: X,
                            onEditScrollSettings: re
                        }), x(b, {
                            onClick: () => {
                                l && c(!1)
                            },
                            children: [m.fixed_position ? x(b, {
                                display: "flex",
                                flexDirection: "column",
                                ref: p,
                                position: "relative",
                                textAlign: "center",
                                height: "84px",
                                backgroundColor: "#5f5f69",
                                children: [r(b, {
                                    display: "flex",
                                    position: "absolute",
                                    height: s,
                                    width: "100%",
                                    backgroundColor: "tomato",
                                    bottom: "0",
                                    left: "0"
                                }), r(b, {
                                    position: "relative",
                                    top: "10px",
                                    zIndex: 100,
                                    children: r($, {
                                        textStyle: "small",
                                        color: "white",
                                        children: "Delay"
                                    })
                                }), x(b, {
                                    display: "flex",
                                    zIndex: 100,
                                    paddingLeft: "36px",
                                    paddingTop: "11px",
                                    justifyContent: "center",
                                    alignItems: "center",
                                    children: [r(fe, {
                                        value: ne || 0,
                                        autoWidth: !0,
                                        caretColor: "transparent",
                                        onChange: ({
                                            value: U
                                        }) => {
                                            f({
                                                scrollDelay: U
                                            })
                                        },
                                        labelRef: p,
                                        placeholder: "0",
                                        min: 0,
                                        max: 9999,
                                        height: "40px",
                                        color: "white",
                                        fontSize: "34px"
                                    }), r(b, {
                                        display: "flex",
                                        position: "relative",
                                        top: "1px",
                                        left: "-1px",
                                        children: r($, {
                                            fontSize: "34px",
                                            lineHeight: "1",
                                            color: "white",
                                            opacity: "0.3",
                                            children: "px"
                                        })
                                    })]
                                })]
                            }) : x(b, {
                                display: "flex",
                                cursor: "pointer",
                                paddingTop: "12px",
                                position: "relative",
                                zIndex: 101,
                                flexDirection: "column",
                                textAlign: "center",
                                height: "68px",
                                backgroundColor: "#2C9773",
                                onClick: () => c(!l),
                                children: [r($, {
                                    textStyle: "small",
                                    color: "white",
                                    children: "Start Point"
                                }), r($, {
                                    fontSize: "24px",
                                    lineHeight: "1.05",
                                    color: "white",
                                    children: be.capitalize(X)
                                })]
                            }), x(b, {
                                display: "flex",
                                flexDirection: "column",
                                paddingTop: "12px",
                                textAlign: "center",
                                height: "84px",
                                ref: d,
                                backgroundColor: "#4E4E56",
                                color: "white",
                                children: [r($, {
                                    textStyle: "small",
                                    color: "white",
                                    children: "Speed"
                                }), x(b, {
                                    display: "flex",
                                    paddingLeft: "27px",
                                    paddingTop: "1px",
                                    justifyContent: "center",
                                    alignItems: "center",
                                    children: [r(fe, {
                                        step: .01,
                                        value: V || 1,
                                        autoWidth: !0,
                                        caretColor: "transparent",
                                        labelRef: d,
                                        onChange: ({
                                            value: U
                                        }) => {
                                            f({
                                                scrollSpeed: U
                                            })
                                        },
                                        placeholder: "1",
                                        min: .1,
                                        max: 999,
                                        height: "40px",
                                        color: "white",
                                        fontSize: "34px"
                                    }), r(b, {
                                        display: "flex",
                                        position: "relative",
                                        top: "1px",
                                        left: "-3px",
                                        children: r($, {
                                            fontSize: "34px",
                                            lineHeight: "1",
                                            color: "white",
                                            opacity: "0.3",
                                            children: "\xD7"
                                        })
                                    })]
                                })]
                            })]
                        })]
                    }), y !== "scroll" && r(BL, {
                        isStartPopupVisible: l,
                        setIsStartPopupVisible: c
                    }), y === "mousemove" && x(b, {
                        display: "flex",
                        flexDirection: "column",
                        children: [r(b, {
                            display: "flex",
                            justifyContent: "center",
                            alignItems: "center",
                            height: "68px",
                            cursor: "pointer",
                            backgroundColor: z === "horizontally" ? "#2C9773" : "#4E4E56",
                            onClick: () => {
                                f({
                                    hoverDirection: "horizontally"
                                })
                            },
                            onMouseEnter: () => n(!0),
                            onMouseLeave: () => n(!1),
                            children: r($, {
                                fontSize: "24px",
                                color: "white",
                                opacity: z === "horizontally" || i ? 1 : .4,
                                children: "Horizontal"
                            })
                        }), O && r(b, {
                            display: "flex",
                            justifyContent: "center",
                            alignItems: "center",
                            height: "168px",
                            cursor: "pointer",
                            backgroundColor: z === "vertically" ? "#2C9773" : "#4E4E56",
                            onClick: () => {
                                f({
                                    hoverDirection: "vertically"
                                })
                            },
                            onMouseEnter: () => o(!0),
                            onMouseLeave: () => o(!1),
                            children: r($, {
                                writingMode: "vertical-rl",
                                textOrientation: "mixed",
                                fontSize: "24px",
                                color: "white",
                                opacity: z === "vertically" || t ? 1 : .4,
                                children: "Vertical"
                            })
                        })]
                    }), (y === "hover" || y === "click") && r(PL, {
                        selectedText: j.toLowerCase()
                    }), y === "scroll" && r(H, {
                        showBorder: !1,
                        leftSlot: "Easing",
                        rightSlot: r(Ve, {
                            backgroundChecked: "tomato",
                            checked: P,
                            onChange: U => f({
                                useEasing: U
                            })
                        })
                    })]
                }), r(b, {
                    ref: te
                })]
            })
        })
    })
}
var xi, RL, EL = k(() => {
    "use strict";
    xi = E(N());
    Le();
    ae();
    ht();
    nt();
    $e();
    ut();
    ts();
    qo();
    kL();
    Wt();
    tw();
    TL();
    ML();
    ie();
    Be();
    en();
    zt();
    Hi();
    ve();
    ad();
    B();
    RL = oee
});
var FL, DL = k(() => {
    "use strict";
    ae();
    EL();
    FL = Ce.extend({
        name: "playback_settings",
        component: RL,
        rolePermission: "ShotsCanChangePlaybackSettings"
    })
});
var Du, iee, AL, LL = k(() => {
    "use strict";
    Du = E(N());
    nt();
    $e();
    Vn();
    Yt();
    K_();
    ae();
    _j();
    Be();
    X_();
    je();
    ie();
    ve();
    ut();
    B();
    iee = (0, Du.forwardRef)(({
        style: e,
        getScrollablePanelProps: t
    }, o) => {
        let {
            model: i
        } = (0, Du.useContext)(Y), [n, s] = i.useSharedState({
            partial: !1
        }), [a, l] = (0, Du.useState)(0), c = d => {
            s(Yc({
                editorState: n,
                text: d
            }))
        };
        return x(Me, {
            isShowed: i.selected,
            ref: o,
            style: e,
            ...t(),
            children: [r(co, {
                title: "Insert"
            }), x(xm, {
                dynamicHeight: !0,
                value: a,
                onChange: d => l(d),
                children: [r(fc, {
                    value: 0,
                    renderButton: ({
                        isActive: d
                    }) => r(H, {
                        showBorder: !d,
                        leftSlot: r(K, {
                            variant: "clean",
                            textStyle: "small",
                            color: d ? "black" : "darkGray",
                            css: Z `
                    &:hover {
                      color: ${ce.black};
                    }
                  `,
                            children: "Glyph"
                        })
                    }),
                    children: d => r(py, {
                        ref: d
                    })
                }), r(fc, {
                    value: 1,
                    renderButton: ({
                        isActive: d
                    }) => r(H, {
                        showBorder: !1,
                        leftSlot: r(K, {
                            variant: "clean",
                            textStyle: "small",
                            color: d ? "black" : "darkGray",
                            css: Z `
                    &:hover {
                      color: ${ce.black};
                    }
                  `,
                            children: "Space"
                        })
                    }),
                    children: d => r(b, {
                        ref: d,
                        backgroundColor: "white",
                        paddingTop: "2rm",
                        paddingBottom: "2rm",
                        paddingLeft: "4rm",
                        paddingRight: "4rm",
                        borderRadius: "0 0 8px 8px",
                        children: Pv.map((p, h) => {
                            let u = h === Pv.length - 1;
                            return r(b, {
                                paddingBottom: u ? void 0 : "10px",
                                marginBottom: u ? void 0 : 2,
                                borderBottom: "1px solid",
                                borderColor: u ? "transparent" : "lightGray",
                                children: r(K, {
                                    variant: "clean",
                                    onClick: () => {
                                        c(p.char)
                                    },
                                    children: r($, {
                                        textStyle: "small",
                                        children: p.name
                                    })
                                })
                            }, h)
                        })
                    })
                })]
            })]
        })
    }), AL = iee
});

function nee() {
    let {
        model: e
    } = (0, uy.useContext)(Y), t = (0, uy.useCallback)(o => {
        o.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: o
        }) => r(ke, {
            ref: o,
            label: "Insert",
            onClick: t,
            children: r(fI, {
                color: "white",
                position: "relative",
                left: "-1px"
            })
        }),
        panel: ({
            ref: o,
            style: i,
            getScrollablePanelProps: n
        }) => e.selected ? r(AL, {
            ref: o,
            style: i,
            getScrollablePanelProps: n
        }) : null
    })
}
var uy, zL, $L = k(() => {
    "use strict";
    uy = E(N());
    xH();
    ae();
    ht();
    LL();
    B();
    zL = nee
});
var WL, OL = k(() => {
    "use strict";
    ae();
    $L();
    WL = Ce.extend({
        name: "text_insert",
        component: zL,
        rolePermission: "TextCanInsertSymbols"
    })
});

function see({
    onIconSelect: e,
    onIconDisable: t,
    selectedIconId: o
}) {
    let i = (0, dl.useRef)(new $s).current,
        n = (0, dl.useRef)(null),
        [s, a] = (0, dl.useState)("empty"),
        [l, c] = (0, dl.useState)(""),
        [d, p] = (0, dl.useState)(() => i.getPersistedIcons("defaultIcons")),
        h = () => {
            !l || i.searchInProgress || u(l)
        },
        u = async w => {
            a("loading");
            let v = await i.fetchIconsPage(w);
            v ? .length && p(v), a("results")
        },
        m = () => {
            p(i.defaultIcons || []), c(""), a("empty"), i.clearSearch()
        },
        f = (0, dl.useCallback)(w => {
            let v = w.target;
            if (v) {
                let C = v.scrollHeight,
                    I = v.clientHeight,
                    T = v.scrollTop;
                I + T === C && i.prevSVGSearch.nextPage && n ? .current ? .value && u(n ? .current.value)
            }
        }, [s, l]),
        g = w => {
            e && typeof e == "function" && e(w)
        },
        y = () => {
            t && typeof t == "function" && t()
        };

    function S() {
        be.isSubscriptionPaused() ? window ? .RM ? .constructorRouter ? .trigger("notice:show", "unpauseSubscriptionToSearchNounIcons", {
            canBeClosed: !0
        }) : Jo("icon-library")
    }
    return x(Q, {
        children: [be.isNounSearchAvailable() && x(Q, {
            children: [x(b, {
                position: "relative",
                display: "flex",
                alignItems: "center",
                justifyContent: "start",
                marginBottom: "10px",
                children: [r(Mo, {
                    ref: n,
                    width: "calc(100% - 16px)",
                    border: "none !important",
                    padding: 0,
                    textStyle: "small",
                    color: "black",
                    value: l,
                    onChange: w => {
                        let v = w.target.value;
                        c(v), s === "empty" && a("filled-in")
                    },
                    onKeyDown: w => {
                        w.keyCode === 13 && h()
                    },
                    placeholder: "Search"
                }), r(b, {
                    width: "16px",
                    height: "16px",
                    display: "flex",
                    alignItems: "center",
                    justifyContent: "center",
                    children: s === "loading" ? r(_o, {
                        size: 16,
                        color: "lightGray",
                        bgColor: "transparent"
                    }) : s === "results" ? r(Nt, {
                        width: 14,
                        height: 14,
                        color: "gray",
                        cursor: "pointer",
                        onClick: m,
                        css: Z `
                    &:hover {
                      color: ${ce.black};
                    }
                  `
                    }) : null
                })]
            }), r(b, {
                width: "100%",
                height: "2px",
                backgroundColor: "gray",
                opacity: .24
            })]
        }), r(b, {
            width: "calc(100% + 16px)",
            height: 286,
            paddingTop: "2rm",
            children: r(xo, {
                onScroll: f,
                children: ({
                    ref: w
                }) => x(b, {
                    ref: w,
                    children: [(s === "empty" || s === "filled-in") && r(b, {
                        position: "relative",
                        display: "inline-block",
                        width: 32,
                        height: 32,
                        marginRight: 20,
                        marginBottom: 17,
                        cursor: "pointer",
                        onClick: y,
                        opacity: o ? .4 : 1,
                        transition: "opacity 0.2s ease-out",
                        css: Z `
                    &:hover {
                      opacity: 1;
                    }
                  `,
                        children: r(b, {
                            position: "absolute",
                            bottom: 0,
                            left: 0,
                            height: 67,
                            width: "1px",
                            backgroundColor: o ? "#000000" : "tomato",
                            transformOrigin: "100% 100%",
                            transform: "rotate(45deg)"
                        })
                    }), d.map(v => r(b, {
                        display: "inline-block",
                        width: 32,
                        height: 32,
                        marginTop: "1px",
                        marginRight: 20,
                        marginBottom: 17,
                        css: Z `
                    &:nth-child(3n) {
                      margin-right: 0 !important;
                    }
                  `,
                        onClick: () => g(v),
                        children: r(ree, {
                            iconPreview: v.preview_url_42,
                            iconIsSelected: !!(o && (v.id && v.id === o.icon_noun_id || v.rm_id && v.rm_id === o.icon_rm_id))
                        })
                    }, v.id || v.rm_id)), !be.isNounSearchAvailable() && r(K, {
                        onClick: S,
                        width: "100%",
                        height: 40,
                        paddingRight: 16,
                        marginBottom: 20,
                        variant: "tertiary",
                        color: "darkGray",
                        fontSize: 12,
                        children: "More shapes"
                    })]
                })
            })
        }), r(b, {
            width: "100%",
            height: "2px",
            backgroundColor: "gray",
            opacity: .24
        })]
    })
}
var dl, ree, jL, HL = k(() => {
    "use strict";
    dl = E(N());
    ve();
    ie();
    Ur();
    or();
    Bs();
    ut();
    Ts();
    bu();
    Wt();
    je();
    jr();
    Xs();
    B();
    ree = ue("div")
    `
  width: 100%;
  height: 100%;
  background-size: 100% auto;
  background-position: center center;
  background-repeat: no-repeat;
  background-image: ${e=>`url(${e.iconPreview})`||"none"};
  opacity: ${e=>e.iconIsSelected?"1":"0.4"};
  transition: opacity 0.2s ease-out;

  &:hover {
    cursor: pointer;
    opacity: 1;
  }
`;
    jL = see
});

function aee() {
    let {
        model: e,
        modelSet: t
    } = (0, kn.useContext)(ge), {
        model: o
    } = (0, kn.useContext)(Y), i = (0, kn.useMemo)(() => o.project.get("_id"), [o]), n = (0, kn.useMemo)(() => o.user.get("_id"), [o]), [s, a] = (0, kn.useState)(), l = W => {
        W.get("icon_enabled") ? a({
            icon_noun_id: W.get("icon_noun_id"),
            icon_rm_id: W.get("icon_rm_id")
        }) : a(void 0)
    }, c = W => {
        o.block.getIconSVG(W.id || W.rm_id, W.icon_url, z => {
            if (z) return;
            let V = {
                icon_enabled: !0,
                icon_noun_url: W.icon_url
            };
            W.id ? V = { ...V,
                icon_noun_id: W.id,
                icon_rm_id: null
            } : W.rm_id && (V = { ...V,
                icon_noun_id: null,
                icon_rm_id: W.rm_id
            }), t(V)
        })
    }, d = () => {
        t({
            icon_enabled: !1
        })
    }, [p, h] = (0, kn.useState)(e.icon_h), u = (0, kn.useCallback)((0, hy.debounce)(W => t({
        icon_h: W
    }), 300), []), m = ({
        value: W
    }) => {
        h(W), u(W)
    }, f = W => {
        p !== W.get("icon_h") && h(W.get("icon_h"))
    }, [g, y] = (0, kn.useState)(e.icon_pos), S = () => {
        let W = g === "left" ? "right" : "left";
        y(W), t({
            icon_pos: W
        })
    }, w = W => {
        g !== W.get("icon_pos") && y(W.get("icon_pos"))
    }, v = W => Number((W / 100).toFixed(1)), [C, I] = (0, kn.useState)(e.icon_color ? ct(e.icon_color, v(e.icon_color_opacity)) : null), T = (W, z = "") => {
        let V = W.a * 100,
            X = (0, hy.omit)(W, "a"),
            q = yt(X);
        t({
            [`${z}icon_color`]: q,
            [`${z}icon_color_opacity`]: V
        })
    }, P = W => {
        let z = ct(W.get("icon_color"), v(W.get("icon_color_opacity")));
        I(z)
    }, [M, F] = (0, kn.useState)(e["hover-icon_color"] ? ct(e["hover-icon_color"], v(e["hover-icon_color_opacity"])) : null), R = W => {
        T(W, "hover-")
    }, A = W => {
        let z = ct(W.get("hover-icon_color"), v(W.get("hover-icon_color_opacity")));
        F(z)
    }, D = () => {
        o.block.$el.addClass("hovered"), o.block.changeStylingState && o.block.changeStylingState("hover")
    }, O = () => {
        o.block.$el.removeClass("hovered"), o.block.changeStylingState && o.block.changeStylingState("default")
    };
    (0, kn.useEffect)(() => (l(o.block.model), o.block.model.on(NL, l), o.block.model.on("change:icon_h", f), o.block.model.on("change:icon_pos", w), o.block.model.on("change:icon_color change:icon_color_opacity", P), o.block.model.on("change:hover-icon_color change:hover-icon_color_opacity", A), () => {
        o.block.$el.hasClass("hovered") && o.block.$el.removeClass("hovered"), o.block.changeStylingState && o.block.changeStylingState("default"), o.block.model.off(NL, l), o.block.model.off("change:icon_h", f), o.block.model.off("change:icon_pos", w), o.block.model.off("change:icon_color change:icon_color_opacity", P), o.block.model.off("change:hover-icon_color change:hover-icon_color_opacity", A)
    }), [o.block]);
    let L = (0, kn.useCallback)(W => {
        W.preventDefault(), !o.disabled && o.select()
    }, [o.disabled]);
    return r(Ie, {
        control: ({
            ref: W
        }) => r(ke, {
            ref: W,
            label: "Icon",
            onClick: L,
            children: r(b, {
                position: "relative",
                top: "-1px",
                children: r(Df, {
                    width: 18,
                    color: ce.white
                })
            })
        }),
        panel: ({
            ref: W,
            style: z,
            getScrollablePanelProps: V
        }) => o.selected ? x(Me, {
            ref: W,
            style: z,
            isShowed: o.selected,
            ...V(),
            children: [r(co, {
                title: "Icon"
            }), r(b, {
                paddingLeft: "4rm",
                paddingRight: "4rm",
                children: r(jL, {
                    onIconSelect: c,
                    onIconDisable: d,
                    selectedIconId: s
                })
            }), r(Ti, {
                permission: "ButtonCanChangeIconSize",
                children: r(H, {
                    leftSlot: "Size",
                    rightSlot: r(fe, {
                        autoWidth: !0,
                        value: p,
                        onChange: m
                    })
                })
            }), r(H, {
                leftSlot: "Position",
                rightSlot: r(K, {
                    position: "relative",
                    top: "-2px",
                    "data-testid": "icon-toggle-position",
                    onClick: S,
                    children: r(Bo, {
                        color: "blue",
                        textStyle: "small",
                        children: g.charAt(0).toUpperCase() + g.slice(1)
                    })
                })
            }), r(qe, {
                "data-testid": "icon-color",
                title: "Color",
                projectId: i,
                userId: n,
                color: C,
                setColor: I,
                onColorChange: T
            }), r(qe, {
                showBorder: !1,
                "data-testid": "hover-icon-color",
                title: "Hover color",
                projectId: i,
                userId: n,
                color: M,
                setColor: F,
                onColorChange: R,
                onPanelShow: D,
                onPanelHide: O
            })]
        }) : null
    })
}
var kn, hy, NL, J_, UL = k(() => {
    "use strict";
    kn = E(N()), hy = E(hn());
    ut();
    ie();
    je();
    Be();
    zt();
    HL();
    ht();
    nt();
    nn();
    ko();
    Le();
    ae();
    Vn();
    $e();
    Ps();
    td();
    B();
    NL = "change:icon_enabled change:icon_noun_id change:icon_rm_id";
    J_ = aee
});
var VL = k(() => {
    "use strict";
    UL()
});
var GL, YL = k(() => {
    "use strict";
    ae();
    VL();
    GL = Ce.extend({
        name: "icon_settings",
        component: J_,
        rolePermission: "ButtonCanChangeIcon"
    })
});
var pl, lee, ZL, XL = k(() => {
    "use strict";
    pl = E(N());
    qo();
    ae();
    il();
    Le();
    vr();
    B();
    lee = (0, pl.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, pl.useContext)(Y), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, pl.useContext)(ge), c = (0, pl.useMemo)(() => i.project.get("_id"), [i]), d = (0, pl.useMemo)(() => i.user.get("_id"), [i]), {
            callback: p
        } = Je(l, 200), h = g => n({
            preventClose: g
        }), u = () => {
            a({
                anchor_link_pos: null,
                clickLink: null,
                clickPage: null,
                clickTarget: ""
            }), p()
        }, m = (0, pl.useMemo)(() => Xo(s), [s]);
        return r(cr, {
            ref: o,
            onHeightChanged: t,
            currentLinkData: m,
            projectId: c,
            userId: d,
            style: e,
            onRemoveUrl: u,
            onChange: g => {
                a(Is(g)), p()
            },
            onAnchorToggle: h,
            onToggleDropdown: h,
            onToggleSelectPanel: h,
            canShowAnchorSelector: !0,
            showStyles: !1
        })
    }), ZL = lee
});

function cee() {
    let {
        model: e
    } = (0, kd.useContext)(Y), {
        model: t
    } = (0, kd.useContext)(ge), o = (0, kd.useMemo)(() => Xo(t), [t.anchor_link_pos, t.clickLink, t.clickPage, t.clickTarget]), i = (0, kd.useCallback)(n => {
        n.preventDefault(), !e.disabled && (st(["ButtonWidgetAddLink"]), e.select())
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: n
        }) => r(ke, {
            ref: n,
            helpTourSteps: "ButtonWidgetAddLink",
            isActive: !!o,
            label: "Link",
            onClick: i,
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: n,
            style: s,
            update: a
        }) => e.selected ? r(ZL, {
            ref: n,
            style: s,
            onHeightChanged: a
        }) : null
    })
}
var kd, KL, JL = k(() => {
    "use strict";
    kd = E(N());
    ae();
    ht();
    Qc();
    XL();
    Le();
    vr();
    pi();
    B();
    KL = cee
});
var qL, QL = k(() => {
    "use strict";
    ae();
    JL();
    qL = Ce.extend({
        name: "button_link",
        component: KL,
        rolePermission: "ButtonCanChangeLink"
    })
});

function dee({
    size: e,
    circleSize: t,
    position: o,
    pointerPosition: i,
    onPin: n,
    onUnPin: s,
    isShowed: a,
    useScale: l
}) {
    let c = (0, bc.useMemo)(() => t / 4, [t]),
        d = (0, bc.useMemo)(() => e / 2, [e]),
        p = (0, bc.useRef)(null),
        h = Gv(n),
        u = Gv(s),
        m = 4.2,
        f = (0, bc.useMemo)(() => {
            let g = Math.sqrt((i.x - o.x) ** 2 + (i.y - o.y) ** 2);
            return g < c ? Math.min(1, (c - g) / (t / m)) : 0
        }, [i]);
    return (0, bc.useEffect)(() => {
        f > .9 ? h() : u()
    }, [f]), r(b, {
        ref: p,
        width: e,
        height: e,
        borderRadius: d,
        backgroundColor: "gray",
        position: "absolute",
        top: "50%",
        left: "50%",
        zIndex: 6,
        marginTop: `${d*-1}px`,
        marginLeft: `${d*-1}px`,
        style: {
            transform: `translate3d(${o.x}px, ${o.y}px, 0px) scale(${l?f:1})`
        },
        userSelect: "none",
        opacity: a ? 1 : 0,
        transition: "0.1s opacity"
    })
}
var bc, e5, t5 = k(() => {
    "use strict";
    bc = E(N());
    BH();
    ie();
    B();
    e5 = dee
});

function pee({
    value: e,
    onChange: t,
    circleSize: o = 136,
    pointerSize: i = 16,
    boundary: n = 100,
    disabled: s,
    invert: a,
    pins: l = ["center", 0, 45, 90, 135, 180, 225, 270, 315, 360],
    showPins: c,
    alwaysVisiblePins: d
}) {
    let {
        start: p,
        stop: h
    } = hb(), u = (0, Gi.useMemo)(() => (o - i) / 2, [o, i]), m = (0, Gi.useMemo)(() => o / 2, [u]), f = (0, Gi.useMemo)(() => i / 2, [i]), [g, y] = (0, Gi.useState)(null), [S, w] = (0, Gi.useState)(null), [v, C] = (0, Gi.useState)(), [I, T] = (0, Gi.useState)(null), P = (0, Gi.useRef)(I), M = (0, Gi.useRef)({}), F = ne => {
        (ne.x !== e.x || ne.y !== e.y) && t(ne)
    }, [R, A] = (0, Gi.useState)(e);
    (0, Gi.useEffect)(() => {
        (R.x !== e.x || R.y !== e.y) && A(e)
    }, [e]);
    let {
        start: D,
        moving: O
    } = Of({
        disabled: s,
        disableClickThreshold: !0,
        onMove: ({
            event: ne
        }) => {
            let re = Math.round(ne.pageX - M.current.x - (v ? .x || 0) - u - window.pageXOffset),
                te = Math.round(ne.pageY - M.current.y - (v ? .y || 0) - u - window.pageYOffset),
                ee = {
                    x: Math.round(Math.min(M.current.width - i - u, Math.max(0 - u, re))),
                    y: Math.round(Math.min(M.current.height - i - u, Math.max(0 - u, te)))
                },
                j = W(ee),
                se = L(j);
            A(se)
        },
        onMoveStart: ne => {
            p(), M.current = g ? .getBoundingClientRect() || {};
            let re = S ? .getBoundingClientRect() || {};
            C({
                x: ne.clientX - re.x,
                y: ne.clientY - re.y
            })
        },
        onMoveEnd: () => {
            h(), C(null), P.current && (T(null), A(L(P.current)), P.current = null)
        }
    }), L = ne => {
        let re = a ? -1 : 1;
        return {
            x: Math.round(ne.x * n / u) * re,
            y: Math.round(ne.y * n / u) * re
        }
    }, W = ne => {
        let re = Math.atan2(ne.y, ne.x),
            te = Math.round(u * Math.cos(re)),
            ee = Math.round(u * Math.sin(re));
        return {
            x: ne.x === 0 ? 0 : Math.round(ne.x > 0 ? Math.min(ne.x, te) : Math.max(ne.x, te)),
            y: ne.y === 0 ? 0 : Math.round(ne.y > 0 ? Math.min(ne.y, ee) : Math.max(ne.y, ee))
        }
    }, z = (ne, re) => {
        let te = Math.atan2(ne.y, ne.x);
        return {
            x: Math.round((u + re) * Math.cos(te)),
            y: Math.round((u + re) * Math.sin(te))
        }
    }, {
        value: V,
        isOutside: X
    } = (0, Gi.useMemo)(() => {
        let ne = a ? -1 : 1,
            re = {
                x: Math.round(R.x * u / n) * ne,
                y: Math.round(R.y * u / n) * ne
            },
            te = W(re),
            ee = te.x !== re.x || te.y !== re.y;
        return !ee && !I && O && F(L(te)), !O && ee ? {
            value: z(te, f),
            isOutside: !0
        } : {
            value: te
        }
    }, [R, I, O]), q = (0, Gi.useMemo)(() => !l || !l.length ? [] : l.map(ne => {
        if (ne === "center") return {
            x: 0,
            y: 0
        };
        let re = ne * (Math.PI / 180);
        return {
            x: Math.round(Math.cos(re) * u),
            y: Math.round(Math.sin(re) * u)
        }
    }), [u, l]);
    return x(Gi.Fragment, {
        children: [x(b, {
            ref: y,
            width: o,
            height: o,
            borderRadius: m,
            backgroundColor: "white",
            position: "relative",
            userSelect: s ? "none" : void 0,
            cursor: O ? "grabbing" : void 0,
            children: [r(b, {
                ref: w,
                width: i,
                height: i,
                onMouseDown: D,
                style: {
                    transform: I ? `translate3d(${I.x}px, ${I.y}px, 0px)` : `translate3d(${V.x}px, ${V.y}px, 0px)`
                },
                position: "absolute",
                top: "50%",
                left: "50%",
                zIndex: 10,
                marginTop: `${f*-1}px`,
                marginLeft: `${f*-1}px`,
                userSelect: O ? "none" : void 0,
                "data-testid": "position-circle-pointer",
                cursor: s ? "initial" : "grab",
                transition: !O || I ? ".1s" : "none",
                children: r(b, {
                    borderRadius: f,
                    backgroundColor: s || X ? "gray" : "black",
                    width: "100%",
                    height: "100%",
                    transition: "background-color 0.1s, transform 0.1s"
                })
            }), c && q.length ? q.map((ne, re) => r(e5, {
                isShowed: d || O,
                useScale: !d,
                circleSize: o,
                size: i,
                position: ne,
                pointerPosition: V,
                onPin: () => {
                    O && !I && (T(ne), P.current = ne, F(L(ne)))
                },
                onUnPin: () => {
                    O && I && (P.current = null, T(null))
                }
            }, re)) : null]
        }), O ? r(Wf, {
            children: r(Sp, {
                zIndex: 99999,
                userSelect: "none",
                cursor: "grabbing",
                role: "presentation",
                backgroundColor: "transparent"
            })
        }) : null]
    })
}
var Gi, o5, i5 = k(() => {
    "use strict";
    Gi = E(N());
    MI();
    ie();
    Vv();
    TI();
    t5();
    Ax();
    B();
    o5 = pee
});
var my, uee, fy, q_ = k(() => {
    "use strict";
    my = E(N());
    Uc();
    ie();
    ir();
    ut();
    B();
    uee = (0, my.forwardRef)(({
        text: e,
        arrowPosition: t,
        ...o
    }, i) => {
        let n = (0, my.useRef)(null),
            s = Fn(.04, ce.red);
        return r(b, {
            ref: i,
            height: 32,
            padding: "0 8px 0 0",
            ...o,
            visibility: o.visibility || "visible",
            children: x(xp, {
                backgroundColor: s,
                children: [e, r(_p, {
                    ref: n,
                    left: "100%",
                    transform: "translateX(-4px) rotate(-90deg)",
                    color: s,
                    ...t
                })]
            })
        })
    }), fy = b.withComponent(uee)
});

function by(e, t) {
    let o = (0, gy.useRef)(0);
    return (0, gy.useCallback)((...n) => {
        let s = Date.now();
        s - o.current >= t && (e(...n), o.current = s)
    }, [e, t])
}
var gy, Q_ = k(() => {
    "use strict";
    gy = E(N())
});
var Au, hee, mee, Sm, n5 = k(() => {
    "use strict";
    Au = E(N());
    nt();
    Vn();
    i5();
    $e();
    zt();
    nn();
    ko();
    q_();
    ie();
    Hi();
    Q_();
    B();
    hee = {
        x: 0,
        y: 0,
        blur: 0,
        color: "00000064"
    }, mee = (0, Au.forwardRef)(({
        style: e,
        value: t,
        defaultValue: o,
        isShadowEnabled: i,
        onToggleShadow: n,
        onChange: s,
        projectId: a,
        userId: l,
        disabled: c,
        alertText: d,
        boundary: p = 100,
        pins: h,
        isGlobalShadowEnabled: u,
        onGlobalShadowToggle: m,
        getScrollablePanelProps: f
    }, g) => {
        let [y, S] = (0, Au.useState)(!1), w = t || o || hee, v = by(C => {
            s({ ...w,
                ...C
            })
        }, 100);
        return (0, Au.useEffect)(() => {
            !c && y && S(!1)
        }, [c, y]), r(Me, {
            isShowed: !0,
            ref: g,
            style: e,
            ...f(),
            children: r(Ot.Consumer, {
                children: ({
                    dropdownContainer: C
                }) => x(Q, {
                    children: [c && y && d && r(fy, {
                        visibility: "visible",
                        text: d,
                        position: "absolute",
                        top: "50%",
                        right: "100%",
                        zIndex: 10
                    }), r(co, {
                        title: "Shadow"
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: i ? "On" : "Off",
                        rightSlot: r(Ve, {
                            disabled: c,
                            checked: i,
                            backgroundChecked: "black",
                            onChange: () => {
                                n(!i)
                            }
                        })
                    }), r(H, {
                        showBorder: !1,
                        children: r(o5, {
                            invert: !0,
                            pins: h,
                            showPins: !0,
                            disabled: c,
                            boundary: p,
                            value: {
                                x: w.x,
                                y: w.y
                            },
                            onChange: v
                        })
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: "X offset",
                        rightSlot: r(fe, {
                            disabled: c,
                            "data-testid": "shadow-panel-x-offset",
                            value: w.x,
                            min: -500,
                            max: 500,
                            textAlign: "right",
                            autoWidth: !0,
                            onChange: ({
                                value: I
                            }) => {
                                s({ ...w,
                                    x: I
                                })
                            }
                        })
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: "Y offset",
                        rightSlot: r(fe, {
                            disabled: c,
                            "data-testid": "shadow-panel-y-offset",
                            value: w.y,
                            min: -500,
                            max: 500,
                            textAlign: "right",
                            autoWidth: !0,
                            onChange: ({
                                value: I
                            }) => {
                                s({ ...w,
                                    y: I
                                })
                            }
                        })
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: "Blur",
                        rightSlot: r(fe, {
                            disabled: c,
                            "data-testid": "shadow-panel-blur",
                            value: w.blur,
                            min: 0,
                            max: 100,
                            textAlign: "right",
                            autoWidth: !0,
                            onChange: ({
                                value: I
                            }) => {
                                s({ ...w,
                                    blur: I
                                })
                            }
                        })
                    }), r(qe, {
                        disabled: c || !i,
                        container: C,
                        title: "Color",
                        projectId: a,
                        userId: l,
                        color: Yo(w.color),
                        setColor: I => {
                            I && s({ ...w,
                                color: ro(I)
                            })
                        }
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: "Show on hover",
                        rightSlot: r(Ve, {
                            disabled: c || !i,
                            checked: w.fadeOnHover,
                            backgroundChecked: "black",
                            onChange: () => {
                                let I = !w.fadeOnHover;
                                s({ ...w,
                                    fadeOnHover: I,
                                    onHover: I ? !1 : w.onHover,
                                    onScroll: I ? !1 : w.onScroll,
                                    duration: .5
                                })
                            }
                        })
                    }), w.fadeOnHover && r(H, {
                        nested: !0,
                        showBorder: !1,
                        leftSlot: "Duration",
                        rightSlot: r(fe, {
                            disabled: c || !i,
                            value: typeof w.duration == "number" ? w.duration : .5,
                            min: .1,
                            max: 4,
                            step: .1,
                            textAlign: "right",
                            autoWidth: !0,
                            onChange: ({
                                value: I
                            }) => {
                                s({ ...w,
                                    duration: I
                                })
                            }
                        })
                    }), r(H, {
                        showBorder: !1,
                        leftSlot: "Move on hover",
                        rightSlot: r(Ve, {
                            disabled: c || !i,
                            checked: w.onHover,
                            backgroundChecked: "black",
                            onChange: () => {
                                let I = !w.onHover;
                                s({ ...w,
                                    onHover: I,
                                    onScroll: I ? !1 : w.onScroll,
                                    fadeOnHover: I ? !1 : w.fadeOnHover,
                                    ratio: .5
                                })
                            }
                        })
                    }), w.onHover && r(H, {
                        nested: !0,
                        showBorder: !1,
                        leftSlot: "Distance",
                        rightSlot: r(fe, {
                            disabled: c || !i,
                            value: typeof w.ratio == "number" ? w.ratio : .5,
                            min: .1,
                            max: 1,
                            step: .1,
                            textAlign: "right",
                            autoWidth: !0,
                            onChange: ({
                                value: I
                            }) => {
                                s({ ...w,
                                    ratio: I
                                })
                            }
                        })
                    }), r(H, {
                        showBorder: w.onScroll ? !1 : !!m,
                        leftSlot: "Move on scroll",
                        rightSlot: r(Ve, {
                            disabled: c || !i,
                            checked: w.onScroll,
                            backgroundChecked: "black",
                            onChange: () => {
                                let I = !w.onScroll;
                                s({ ...w,
                                    onScroll: I,
                                    onHover: I ? !1 : w.onHover,
                                    fadeOnHover: I ? !1 : w.fadeOnHover,
                                    ratio: .5
                                })
                            }
                        })
                    }), w.onScroll && r(H, {
                        nested: !0,
                        showBorder: !!m,
                        leftSlot: "Distance",
                        rightSlot: r(fe, {
                            disabled: c || !i,
                            value: typeof w.ratio == "number" ? w.ratio : .5,
                            min: .1,
                            max: 1,
                            step: .1,
                            textAlign: "right",
                            autoWidth: !0,
                            onChange: ({
                                value: I
                            }) => {
                                s({ ...w,
                                    ratio: I
                                })
                            }
                        })
                    }), !!m && r(H, {
                        showBorder: !1,
                        leftSlot: "Global",
                        rightSlot: r(Ve, {
                            disabled: c || !i,
                            checked: u,
                            backgroundChecked: "black",
                            onChange: () => {
                                m(!u)
                            }
                        })
                    }), c && r(b, {
                        onClick: () => S(!0),
                        position: "absolute",
                        left: 0,
                        top: 0,
                        width: "100%",
                        height: "100%",
                        zIndex: 10,
                        "data-testid": "shadow-panel-overlay"
                    })]
                })
            })
        })
    }), Sm = mee
});
var eS = k(() => {
    "use strict";
    n5()
});

function fee() {
    let {
        model: e
    } = (0, In.useContext)(Y), {
        model: t,
        modelSet: o,
        modelSave: i
    } = (0, In.useContext)(ge), n = (0, In.useMemo)(() => e.project.get("_id"), [e]), s = (0, In.useMemo)(() => e.user.get("_id"), [e]), {
        callback: a
    } = Je(i, 300), {
        callback: l
    } = Je(e.groupSave, 300), [c, d] = (0, In.useState)(), {
        callback: p
    } = Je(R => {
        u.set(de.shadow.cachedShadowStyleKey, R), u.save()
    }), {
        callback: h
    } = Je(R => {
        e.workspace.syncManager.groupSave.save({
            changeset: R
        }, {
            noSet: !0,
            patch: !0,
            viewport: e.workspace.viewport
        })
    }, 300), u = e.project.edit_params, {
        callback: m
    } = Je(u.save, 300), f = !!t.isShadowEnabled, [g, y] = (0, In.useState)(!1), S = R => {
        y(R), u.set("isGlobalShadowEnabled", R), R && T(t.shadow), m()
    }, w = (0, In.useCallback)(() => {
        y(u.get("isGlobalShadowEnabled") || !1), t.shadow || d(u.get(de.shadow.cachedShadowStyleKey))
    }, [u, t]);
    (0, In.useEffect)(() => (w(), u.on(`change:isGlobalShadowEnabled change:${de.shadow.cachedShadowStyleKey}`, w), () => {
        u.off(`change:isGlobalShadowEnabled change:${de.shadow.cachedShadowStyleKey}`, w)
    }), [u, w]);
    let {
        globalShadow: v,
        widgetsWithShadow: C
    } = (0, In.useMemo)(() => {
        let R = ok({
            pages: e.project.pages ? .models,
            includeWidgetIds: [t._id]
        });
        return g ? {
            widgetsWithShadow: R,
            globalShadow: R.length && R[0] ? R[0].get("shadow") : c || de.shadow.initialShadow
        } : {
            widgetsWithShadow: R
        }
    }, [g, c, e.project.pages ? .models, t._id]), I = (0, In.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), T = R => {
        let A = C.map(D => (D.set({
            shadow: R
        }), {
            model: D,
            attrs: {
                shadow: R,
                _id: D.get("_id")
            }
        }));
        h(A)
    }, P = R => {
        f || o({
            isShadowEnabled: !0
        }), g && R ? T(R) : I ? (e.groupSet({
            shadow: R
        }), l()) : (o({
            shadow: R
        }), a()), R && p(R)
    }, M = (0, In.useCallback)(R => {
        let A = t.shadow;
        R && (De(Fe.WidgetFeature, {
            featureType: "shadows"
        }), g && v ? A = v : t.shadow || (A = c || de.shadow.initialShadow));
        let D = {
            isShadowEnabled: R,
            shadow: A
        };
        I ? (e.groupSet(D), l()) : (o(D), a())
    }, [t, g, v, c, a, l, o, I, e]), F = (0, In.useCallback)(R => {
        R.preventDefault(), !e.disabled && (t.shadow || M(!0), e.select())
    }, [t.shadow, e, M]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: R
        }) => r(ke, {
            ref: R,
            label: "Shadow",
            isActive: f,
            onClick: F,
            children: r(Ef, {})
        }),
        panel: ({
            ref: R,
            style: A,
            getScrollablePanelProps: D
        }) => e.selected ? r(Sm, {
            ref: R,
            style: A,
            userId: s,
            projectId: n,
            value: t.shadow,
            onChange: P,
            isGlobalShadowEnabled: g,
            onGlobalShadowToggle: S,
            boundary: 40,
            isShadowEnabled: f,
            onToggleShadow: M,
            defaultValue: v || t.shadow || c,
            getScrollablePanelProps: D
        }) : null
    })
}
var In, r5, s5 = k(() => {
    "use strict";
    In = E(N());
    qo();
    lI();
    qt();
    ae();
    Le();
    ht();
    eS();
    wv();
    Mt();
    B();
    r5 = fee
});
var a5, l5 = k(() => {
    "use strict";
    ae();
    s5();
    a5 = Ce.extend({
        name: "common_shadow",
        component: r5,
        rolePermission: "BaseWidgetCanChangeShadow"
    })
});

function gee() {
    let {
        model: e
    } = (0, $r.useContext)(Y), [t, o] = e.useSharedState({
        partial: !1
    }), i = (0, $r.useMemo)(() => e.project.get("_id"), [e]), n = (0, $r.useMemo)(() => e.user.get("_id"), [e]), s = e.project.edit_params, {
        currentShadow: a,
        isShadowEnabled: l
    } = (0, $r.useMemo)(() => {
        let g = Pi(t, "SHADOW");
        if (g.length) {
            let {
                shadow: y,
                isShadowEnabled: S
            } = ik(g);
            return {
                currentShadow: y,
                isShadowEnabled: S
            }
        }
        return {
            isShadowEnabled: !1
        }
    }, [t]), c = g => {
        let S = g ? vv({ ...g,
            blur: (!a && g.blur === 0 ? de.shadow.initialShadow.blur : g.blur) || 0
        }, !0) : void 0;
        o(bi({
            key: "SHADOW",
            value: S,
            editorState: t
        })), g && u(g)
    }, [d, p] = (0, $r.useState)(), h = (0, $r.useCallback)(() => {
        a || p(s.get(de.shadow.cachedShadowStyleKey))
    }, [a, s]), {
        callback: u
    } = Je(g => {
        s.set(de.shadow.cachedShadowStyleKey, g), s.save()
    });
    (0, $r.useEffect)(() => (h(), s.on(`change:${de.shadow.cachedShadowStyleKey}`, h), () => {
        s.off(`change:${de.shadow.cachedShadowStyleKey}`, h)
    }), [s, h]);
    let m = (0, $r.useCallback)(g => {
            o(yi({
                key: "SHADOW",
                value: vv(a || d || de.shadow.initialShadow, g),
                editorState: t
            }))
        }, [t, d, a, o]),
        f = (0, $r.useCallback)(g => {
            g.preventDefault(), !e.disabled && (l || m(!0), e.select())
        }, [l, m, e]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: g
        }) => r(ke, {
            ref: g,
            label: "Shadow",
            isActive: l,
            onClick: f,
            children: r(Ef, {})
        }),
        panel: ({
            ref: g,
            style: y,
            getScrollablePanelProps: S
        }) => e.selected ? r(Sm, {
            ref: g,
            style: y,
            userId: n,
            projectId: i,
            value: a,
            onChange: c,
            alertText: "You have not selected the text",
            boundary: 40,
            pins: ["center"],
            isShadowEnabled: l,
            onToggleShadow: m,
            defaultValue: a || d,
            getScrollablePanelProps: S
        }) : null
    })
}
var $r, c5, d5 = k(() => {
    "use strict";
    $r = E(N());
    lI();
    ae();
    ht();
    eS();
    Yt();
    Ss();
    wv();
    Mt();
    qo();
    B();
    c5 = gee
});
var p5, u5 = k(() => {
    "use strict";
    ae();
    d5();
    p5 = Ce.extend({
        name: "text_shadow",
        component: c5,
        rolePermission: "BaseWidgetCanChangeShadow"
    })
});
var ul, bee, h5, m5 = k(() => {
    "use strict";
    ul = E(N());
    qo();
    ae();
    il();
    Le();
    vr();
    B();
    bee = (0, ul.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, ul.useContext)(Y), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, ul.useContext)(ge), c = (0, ul.useMemo)(() => i.project.get("_id"), [i]), d = (0, ul.useMemo)(() => i.user.get("_id"), [i]), {
            callback: p
        } = Je(l, 200), h = g => n({
            preventClose: g
        }), u = () => {
            a({
                anchor_link_pos: null,
                clickLink: null,
                clickPage: null,
                clickTarget: ""
            }), p()
        }, m = (0, ul.useMemo)(() => Xo(s), [s]);
        return r(cr, {
            ref: o,
            onHeightChanged: t,
            currentLinkData: m,
            projectId: c,
            userId: d,
            style: e,
            onRemoveUrl: u,
            onChange: g => {
                a(Is(g)), p()
            },
            onAnchorToggle: h,
            onToggleDropdown: h,
            onToggleSelectPanel: h,
            canShowAnchorSelector: !0,
            showStyles: !1
        })
    }), h5 = bee
});

function yee() {
    let {
        model: e
    } = (0, Id.useContext)(Y), {
        model: t
    } = (0, Id.useContext)(ge), o = (0, Id.useMemo)(() => Xo(t), [t.anchor_link_pos, t.clickLink, t.clickPage, t.clickTarget]), i = (0, Id.useCallback)(n => {
        n.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: n
        }) => r(ke, {
            isActive: !!o,
            ref: n,
            label: "Link",
            onClick: i,
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: n,
            style: s,
            update: a
        }) => e.selected ? r(h5, {
            ref: n,
            style: s,
            onHeightChanged: a
        }) : null
    })
}
var Id, f5, g5 = k(() => {
    "use strict";
    Id = E(N());
    ae();
    ht();
    Qc();
    m5();
    Le();
    vr();
    B();
    f5 = yee
});
var b5, y5 = k(() => {
    "use strict";
    ae();
    g5();
    b5 = Ce.extend({
        name: "shape_link",
        component: f5,
        rolePermission: "ShapeCanChangeLink"
    })
});

function wee(e) {
    return e.includes("soundcloud.com")
}
async function xee(e) {
    let t = new URL("https://soundcloud.com/oembed.json");
    return t.searchParams.set("url", e), fetch(t.toString()).then(o => o.json())
}
var ur, _ee, v5, w5 = k(() => {
    "use strict";
    ur = E(N());
    nt();
    Vn();
    Ur();
    $e();
    ie();
    ut();
    Jr();
    en();
    Ts();
    je();
    Be();
    Hi();
    L0();
    z0();
    qo();
    ae();
    nn();
    ko();
    Le();
    l1();
    bH();
    q_();
    Ps();
    ve();
    fv();
    B();
    _ee = (0, ur.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: {
                project: o,
                user: i
            }
        } = (0, ur.useContext)(Y), n = (0, ur.useMemo)(() => o.get("_id"), [o]), s = (0, ur.useMemo)(() => i.get("_id"), [i]), {
            model: a,
            modelSet: l,
            modelSave: c
        } = (0, ur.useContext)(ge), {
            callback: d
        } = Je(c, 400), [p, h] = (0, ur.useState)(a.url || ""), [u, m] = (0, ur.useState)(!1), [f, g] = (0, ur.useState)(!1), [y, S] = (0, ur.useState)(!1), w = (0, ur.useMemo)(() => !WC(p) && Zm(p) && wee(p), [p]), v = !!a.url, C = a.url !== p, [I, T] = (0, ur.useState)(ct(a.color)), P = Qi("BaseWidgetCanSelectColorFromPalette"), M = Qi("BaseWidgetCanSelectColorFromSwatches");

        function F(W) {
            l(W), d()
        }
        async function R() {
            if (w && (!v || v && C)) {
                S(!0);
                try {
                    let z = await xee(p);
                    F({
                        url: p,
                        title: z.title,
                        thumbnail_url: z.thumbnail_url
                    })
                } catch {
                    g(!0)
                } finally {
                    S(!1)
                }
            }
        }

        function A() {
            h(""), F({
                url: ""
            })
        }

        function D() {
            F({
                current_type: a.current_type === "visual" ? "standard" : "visual"
            })
        }

        function O(W) {
            W && T(W)
        }

        function L(W) {
            W && F({
                color: yt(W)
            })
        }
        return x(Me, {
            isShowed: !0,
            ref: t,
            style: e,
            children: [r(co, {
                title: "SoundCloud"
            }), r(Ti, {
                permission: "MusicCanChangeTrack",
                children: x(b, {
                    as: "form",
                    onSubmit: W => {
                        W.preventDefault(), R()
                    },
                    paddingLeft: "2rm",
                    paddingRight: "2rm",
                    marginTop: 30,
                    marginBottom: a.url ? 0 : 16,
                    position: "relative",
                    onClick: () => {
                        f && g(!1)
                    },
                    children: [f && r(fy, {
                        visibility: "visible",
                        text: "Can't add track due to it's privacy settings.",
                        position: "absolute",
                        marginTop: -16,
                        top: "50%",
                        right: "100%",
                        zIndex: 10
                    }), r(Mo, {
                        textStyle: "small",
                        padding: w ? "0 36px 0 8px" : "0 8px",
                        border: "none !important",
                        height: 40,
                        backgroundColor: u || p ? "white" : "transparent",
                        color: u || p ? "black" : "blue",
                        placeholder: "Paste URL to track",
                        value: p,
                        onChange: W => {
                            f && g(!1), h(W.target.value)
                        },
                        onFocus: () => m(!0),
                        onBlur: () => m(!1),
                        boxSizing: "border-box",
                        borderRadius: "8px",
                        textOverflow: "ellipsis",
                        css: Z `
              &::placeholder {
                color: ${u||p?ce.gray:ce.blue};
                font-size: 12px;
              }
            `
                    }), w && r(b, {
                        position: "absolute",
                        top: "50%",
                        right: 0,
                        transform: "translateY(-50%)",
                        children: r(b, {
                            marginRight: v && !C ? 18 : 12,
                            children: v && !C ? r(K, {
                                "data-testid": "audio-settings-cross-button",
                                type: "button",
                                onClick: A,
                                variant: "clean",
                                children: r(Nt, {
                                    color: "gray"
                                })
                            }) : r(dt, {
                                "data-testid": "audio-settings-next-button",
                                disabled: y,
                                height: 24,
                                width: 24,
                                onClick: R,
                                color: "gray",
                                hoverColor: "blue",
                                display: "block",
                                transform: "rotate(-90deg)",
                                children: r(Lt, {
                                    color: "white",
                                    display: "inline"
                                })
                            })
                        })
                    })]
                })
            }), a.url ? x(Q, {
                children: [r(H, {
                    showBorder: !1,
                    children: r($, {
                        color: "darkGray",
                        textStyle: "small",
                        textOverflow: "ellipsis",
                        children: a.title
                    })
                }), x(Ti, {
                    permission: "MusicCanChangeSettings",
                    children: [r(H, {
                        children: x(b, {
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r(K, {
                                variant: "clean",
                                onClick: D,
                                children: r(yp, {
                                    color: "darkGray"
                                })
                            }), r($, {
                                textStyle: "small",
                                children: a.current_type === "visual" ? "Visual" : "Standard"
                            }), r(K, {
                                variant: "clean",
                                onClick: D,
                                children: r(vp, {
                                    color: "darkGray"
                                })
                            })]
                        })
                    }), a.current_type === "standard" && r(H, {
                        leftSlot: "Artwork",
                        rightSlot: r(Ve, {
                            checked: a.artwork,
                            backgroundChecked: "black",
                            onChange: () => F({
                                artwork: !a.artwork
                            })
                        })
                    }), r(H, {
                        leftSlot: "Comments",
                        rightSlot: r(Ve, {
                            checked: a.comments,
                            backgroundChecked: "black",
                            onChange: () => F({
                                comments: !a.comments
                            })
                        })
                    }), r(H, {
                        leftSlot: "Socials",
                        rightSlot: r(Ve, {
                            checked: a.socials,
                            backgroundChecked: "black",
                            onChange: () => F({
                                socials: !a.socials
                            })
                        })
                    })]
                }), r(Ti, {
                    permission: "MusicCanChangeColor",
                    children: r(qe, {
                        showBorder: !1,
                        projectId: n,
                        userId: s,
                        title: "Color",
                        showAlpha: !1,
                        color: I,
                        setColor: O,
                        onChangeComplete: L,
                        swatchesOnlyMode: M && !P
                    })
                })]
            }) : r(H, {
                showBorder: !1,
                children: r(dt, {
                    as: "a",
                    href: "https://soundcloud.com/",
                    target: "_blank",
                    color: "gray",
                    hoverColor: "black",
                    height: 32,
                    width: 32,
                    children: r(dI, {
                        color: "white"
                    })
                })
            })]
        })
    }), v5 = _ee
});

function See() {
    let {
        model: e
    } = (0, yy.useContext)(Y), t = (0, yy.useCallback)(o => {
        o.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: o
        }) => r(ke, {
            ref: o,
            label: "Settings",
            onClick: t,
            children: r(Hl, {
                color: "white"
            })
        }),
        panel: ({
            ref: o,
            style: i
        }) => e.selected ? r(v5, {
            ref: o,
            style: i
        }) : null
    })
}
var yy, x5, _5 = k(() => {
    "use strict";
    yy = E(N());
    ae();
    ht();
    Bf();
    w5();
    B();
    x5 = See
});
var S5, C5 = k(() => {
    "use strict";
    ae();
    _5();
    S5 = Ce.extend({
        name: "audio_settings",
        component: x5
    })
});
var vy, k5, tS = k(() => {
    "use strict";
    vy = (e, t) => {
        let o = { ...e
        };
        if (!o.static) return o;
        o.static = [...o.static];
        for (let [i, n] of o.static.entries()) t.hasOwnProperty(n.id) && (o.static[i].value = t[n.id]);
        return o
    }, k5 = (e = [], t) => {
        if (!e.length) return "uncertain";
        let o = 0;
        return e.forEach(i => {
            i.attributes.modifiers && i.attributes.modifiers.find(n => t(n)) && (o += 1)
        }), o ? o === e.length ? "allOn" : "mixed" : "allOff"
    }
});
var Lu, kee, I5, P5 = k(() => {
    "use strict";
    Lu = E(N());
    ie();
    Be();
    id();
    Bs();
    Ts();
    nt();
    tS();
    iy();
    Mt();
    Wt();
    ve();
    B();
    kee = (0, Lu.forwardRef)(({
        style: e,
        selected: t,
        cursorImage: o,
        isGroupSelected: i,
        mixedCursorStatus: n,
        onAddCursor: s,
        onUpdateCursor: a,
        onDeleteCursor: l
    }, c) => {
        let [d, p] = (0, Lu.useState)(!1), [h, u] = (0, Lu.useState)(!1), [m, f] = (0, Lu.useState)(!1), g = async y => {
            if (d && p(!1), !m) {
                if (y && y.size > de.UPLOAD_IMAGE_SIZE_LIMIT) {
                    window.alert(de.MSG_UPLOAD_IMAGE_SIZE_ERROR);
                    return
                }
                f(!0);
                try {
                    let S = await Bu("widget-custom-cursor", y),
                        w = S.picture.type,
                        v = w === "svg" ? de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION : de.UPLOAD_CURSOR_IMAGE_DIMENSION;
                    if (S.size && (S.size.height > v || S.size.width > v)) {
                        f(!1), window.alert(`Maximum ${v} pixels per side`);
                        return
                    }
                    if (w === "svg") {
                        let I = window.document.getElementById("tmp"),
                            T = await be.getSvgSizesByUrl(S.picture.url, I);
                        if (T && (T.bbox.height > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION || T.clientRect.width > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION || T.clientRect.height > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION || T.bbox.width > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION)) {
                            f(!1), window.alert("Check svg size within browser, it should be less than 128 pixels");
                            return
                        }
                    }
                    let C = S.picture.lambdaUrl ? S.picture.lambdaUrl : S.picture.url;
                    if (C) {
                        let I = {
                            cursorUrl: C,
                            urlIsLambda: !!S.picture.lambdaUrl && w !== "svg",
                            cursorImageDimension: S.size ? Math.max(S.size.height, S.size.width) : 0
                        };
                        o || i ? a(I) : s(I)
                    } else window.alert("loading image failed")
                } catch (S) {
                    console.error(S)
                } finally {
                    f(!1)
                }
            }
        };
        return r(Me, {
            className: "cursor-panel",
            isShowed: t,
            ref: c,
            style: e,
            children: x(b, {
                width: "100%",
                height: "100%",
                minHeight: 120,
                className: "drag-events",
                paddingLeft: "4rm",
                paddingRight: "4rm",
                userSelect: "none",
                onDragEnter: () => {
                    d || p(!0)
                },
                onDragLeaveCapture: y => {
                    let S = y && y.relatedTarget;
                    d && (S ? .classList ? .contains("cursor-panel") || S ? .id === "main") && setTimeout(() => {
                        p(!1)
                    }, 50)
                },
                css: Z `
            & .title-on-hover {
              opacity: 0;
            }
            &:hover {
              & .title-on-hover {
                opacity: 1;
              }
            }
          `,
                children: [!d && r(b, {
                    width: "100%",
                    paddingTop: "8px",
                    paddingBottom: "8px",
                    display: "flex",
                    alignItems: "center",
                    children: x($, {
                        textStyle: "regular",
                        color: "black",
                        children: ["Custom cursor", r("br", {}), r("span", {
                            className: "title-on-hover",
                            children: "on widget hover"
                        })]
                    })
                }), r(b, {
                    width: "100%",
                    height: d ? "120px" : "40px",
                    marginTop: d ? 0 : 14,
                    marginBottom: d ? 0 : 10,
                    children: !i && o || i && n !== "allOff" ? x(b, {
                        width: "100%",
                        height: "100%",
                        display: "flex",
                        alignItems: "center",
                        justifyContent: "space-between",
                        css: Z `
                  & .delete-image-icon {
                    opacity: ${i?1:0};
                  }
                  &:hover {
                    & .delete-image-button {
                      background-image: none;
                    }
                    & .delete-image-icon {
                      opacity: 1;
                    }
                  }
                `,
                        children: [r(vi, {
                            id: "widget-cursor-reupload",
                            accept: "image/png, image/jpeg, image/svg+xml",
                            dropFile: !0,
                            readFileData: !1,
                            disabled: m,
                            onChange: g,
                            children: r(b, {
                                width: d ? "136px" : "auto",
                                height: d ? "96px" : "auto",
                                display: "flex",
                                alignItems: "center",
                                children: m ? r($, {
                                    textStyle: "small",
                                    color: "blue",
                                    children: "Uploading..."
                                }) : r($, {
                                    textStyle: "small",
                                    color: "blue",
                                    children: d ? "Drop file here" : "Replace"
                                })
                            })
                        }), r(b, {
                            className: "delete-image-button",
                            width: 24,
                            height: 24,
                            display: d ? "none" : "flex",
                            justifyContent: "center",
                            alignItems: "center",
                            backgroundImage: o && !i ? `url(${o})` : "none",
                            backgroundSize: "cover",
                            backgroundPosition: "center",
                            backgroundRepeat: "no-repeat",
                            cursor: "pointer",
                            onClick: l,
                            onMouseEnter: () => u(!0),
                            onMouseLeave: () => u(!1),
                            children: r(Nt, {
                                className: "delete-image-icon",
                                color: h ? "black" : "gray"
                            })
                        })]
                    }) : r(vi, {
                        id: "widget-cursor-upload",
                        accept: "image/png, image/jpeg, image/svg+xml",
                        dropFile: !0,
                        readFileData: !1,
                        disabled: m,
                        onChange: g,
                        children: r(b, {
                            width: "100%",
                            height: "100%",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            css: Z `
                    & .text-on-hover {
                      display: none;
                    }
                    &:hover {
                      & .text-default {
                        display: none;
                      }
                      & .text-on-hover {
                        display: block;
                      }
                    }
                  `,
                            children: m ? x(Q, {
                                children: [r($, {
                                    textStyle: "small",
                                    color: "blue",
                                    children: "Uploading..."
                                }), r(_o, {
                                    size: 24,
                                    color: "gray",
                                    bgColor: "transparent"
                                })]
                            }) : x(Q, {
                                children: [r($, {
                                    className: "text-default",
                                    textStyle: "small",
                                    color: "blue",
                                    children: "Choose file"
                                }), r($, {
                                    className: "text-on-hover",
                                    textStyle: "small",
                                    color: "blue",
                                    children: "png 2x / svg 128px max"
                                })]
                            })
                        })
                    })
                })]
            })
        })
    }), I5 = kee
});
var Tee, oS, T5 = k(() => {
    "use strict";
    qf();
    Tee = {
        id: "cursor",
        title: "Cursor",
        category: "default",
        owner: "readymag",
        private: !0,
        static: [{
            id: "cursor-keyword",
            name: "Cursor",
            type: "select",
            operator: "assignment",
            modelField: "cursor",
            value: "auto",
            params: {
                default: "auto",
                options: [{
                    label: "Auto",
                    value: "auto"
                }, {
                    label: "Pointer",
                    value: "pointer"
                }, {
                    label: "Move",
                    value: "move"
                }]
            }
        }, {
            id: "cursor-url",
            name: "Cursor image",
            type: "file",
            operator: "assignment",
            modelField: "cursor"
        }, {
            id: "url-is-lambda",
            name: "Is cursor url lambda",
            type: "toggle",
            operator: "assignment",
            modelField: "cursorUrlIsLambda",
            value: !1,
            params: {
                default: !1,
                isDisabled: !0
            }
        }, {
            id: "cursor-image-dimension",
            name: "Cursor image dimension",
            type: "number",
            operator: "assignment",
            modelField: "cursorImageDimension",
            value: 0,
            params: {
                default: 0,
                isDisabled: !0
            }
        }],
        events: [{
            eventName: "rendered",
            eventHandler: "Cursor/WidgetRendered"
        }]
    }, oS = Tee
});

function Cm() {
    De(Fe.WidgetFeature, {
        featureType: "custom cursor"
    })
}

function Mee() {
    let {
        model: e
    } = (0, Us.useContext)(Y), {
        model: t,
        modelSave: o
    } = (0, Us.useContext)(ge), i = (0, Us.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), n = () => t.modifiers ? .find(g => g.id === "cursor"), [s, a] = (0, Us.useState)(() => n());
    (0, Us.useEffect)(() => {
        a(n())
    }, [t.modifiers]);
    let l = (0, Us.useMemo)(() => {
            if (s) return (s.static || []).find(y => y.id === "cursor-url") ? .value
        }, [s]),
        c = i ? k5(e.multipleSelectedModels, g => g.id === "cursor") : l ? "allOn" : "allOff",
        d = ({
            cursorUrl: g,
            urlIsLambda: y,
            cursorImageDimension: S
        }) => {
            let w = t.modifiers || [];
            if (w.findIndex(C => C.id === "cursor") === -1) {
                let C = vy(oS, {
                    "cursor-url": g,
                    "url-is-lambda": y,
                    "cursor-image-dimension": S
                });
                o({
                    modifiers: [...w, C]
                }, {
                    patch: !0
                }), Cm()
            }
        },
        p = ({
            cursorUrl: g,
            urlIsLambda: y,
            cursorImageDimension: S
        }) => {
            let w = t.modifiers || [],
                v = w.findIndex(C => C.id === "cursor");
            if (v > -1) {
                let C = vy(w[v], {
                    "cursor-url": g,
                    "url-is-lambda": y,
                    "cursor-image-dimension": S
                });
                if (C) {
                    let I = [...w];
                    I[v] = C, a(C), o({
                        modifiers: I
                    }, {
                        patch: !0
                    }), Cm()
                }
            }
        },
        h = () => {
            let g = t.modifiers || [],
                y = g.findIndex(S => S.id === "cursor");
            if (y > -1) {
                let S = [...g];
                S.splice(y, 1), o({
                    modifiers: S
                }, {
                    patch: !0
                })
            }
            Cm()
        },
        u = ({
            cursorUrl: g,
            urlIsLambda: y,
            cursorImageDimension: S
        }) => {
            e.multipleSelectedBlocks ? .forEach(w => {
                if (!(w.controls && !!w.controls.find(F => F === "common_cursor"))) return;
                let C = w.model.attributes.modifiers || [],
                    I = C.findIndex(F => F.id === "cursor"),
                    T;
                I > -1 ? T = C[I] : T = oS;
                let P = vy(T, {
                        "cursor-url": g,
                        "url-is-lambda": y,
                        "cursor-image-dimension": S
                    }),
                    M = [...C];
                I > -1 ? M[I] = P : M.push(P), w.model.set({
                    modifiers: M
                })
            }), e.multipleSelectedBlocks && e.groupSave(), Cm()
        },
        m = () => {
            e.multipleSelectedBlocks ? .forEach(g => {
                if (!(g.controls && !!g.controls.find(w => w === "common_cursor"))) return;
                let S = g.model.attributes.modifiers || [];
                if (S) {
                    let w = S.findIndex(v => v.id === "cursor");
                    if (w > -1) {
                        let v = [...S];
                        v.splice(w, 1), g.model.set({
                            modifiers: v
                        })
                    }
                }
            }), e.multipleSelectedBlocks && e.groupSave(), Cm()
        },
        f = (0, Us.useCallback)(g => {
            g.preventDefault(), !e.disabled && e.select()
        }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: g
        }) => r(ke, {
            ref: g,
            label: "Custom cursor",
            isActive: !!l || i && c !== "allOff",
            isMixed: c === "mixed",
            onClick: f,
            children: r(Pf, {})
        }),
        panel: ({
            ref: g,
            style: y
        }) => r(I5, {
            ref: g,
            style: y,
            selected: e.selected,
            cursorImage: l,
            isGroupSelected: i,
            mixedCursorStatus: c,
            onAddCursor: d,
            onUpdateCursor: i ? u : p,
            onDeleteCursor: i ? m : h
        })
    })
}
var Us, iS, B5 = k(() => {
    "use strict";
    Us = E(N());
    O0();
    qt();
    P5();
    ht();
    Le();
    T5();
    tS();
    qf();
    ae();
    B();
    iS = Mee
});
var M5 = k(() => {
    "use strict";
    B5()
});
var R5, E5 = k(() => {
    "use strict";
    ae();
    M5();
    R5 = Ce.extend({
        name: "common_cursor",
        component: iS,
        rolePermission: "BaseWidgetCanChangeModifiers",
        restrictions(e) {
            let t = e.viewport;
            return !["tablet_portrait", "phone_portrait"].includes(t)
        }
    })
});
var Ree, wy, F5 = k(() => {
    "use strict";
    qf();
    Ree = {
        id: "drag",
        title: "Drag",
        category: "default",
        owner: "readymag",
        private: !0,
        events: [{
            eventName: "rendered",
            eventHandler: "Drag/WidgetRendered"
        }, {
            eventName: "pointerdown",
            eventHandler: "Drag/PointerDown"
        }, {
            eventName: "pointerup",
            eventHandler: "Drag/PointerUp",
            isGlobal: !0
        }, {
            eventName: "pointermove",
            eventHandler: "Drag/PointerMove",
            isGlobal: !0
        }, {
            eventName: "touchend",
            eventHandler: "Drag/TouchEnd",
            isGlobal: !0
        }, {
            eventName: "dragstart",
            eventHandler: "Drag/DragStart"
        }]
    }, wy = Ree
});

function nS() {
    De(Fe.WidgetFeature, {
        featureType: "draggable"
    })
}

function Dee() {
    let {
        model: e
    } = (0, Oa.useContext)(Y), {
        model: t,
        modelSave: o
    } = (0, Oa.useContext)(ge), i = (0, Oa.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), n = (0, Oa.useMemo)(() => !!t.modifiers ? .find(u => u.id === "drag"), [t.modifiers]), s = i ? Eee(e.multipleSelectedModels) : n ? "allOn" : "allOff", a = i ? Fee(e.multipleSelectedBlocks) : !0, l = (0, Oa.useMemo)(() => {
        if (!a) {
            if (s === "mixed") return "linear-gradient(90deg, rgba(0, 128, 255,1) 50%, rgba(183, 183, 186, 1) 50%)";
            if (s === "allOff") return "linear-gradient(90deg, rgba(68, 68, 76, 0.95) 50%, rgba(183, 183, 186, 1) 50%)"
        }
    }, [s, a]), c = (0, Oa.useMemo)(() => a ? s === "allOn" ? "Make non-draggable" : "Make draggable" : s === "allOff" ? "Make draggable" : "Make non-draggable", [s, a]), d = () => {
        let u = t.modifiers || [],
            m = u.findIndex(f => f.id === "drag");
        if (!n && m === -1 && (o({
                modifiers: [...u, wy]
            }, {
                patch: !0
            }), nS()), n && m > -1) {
            let f = [...u];
            f.splice(m, 1), o({
                modifiers: f
            }, {
                patch: !0
            })
        }
    }, p = () => {
        let u = a ? s !== "allOn" : s === "allOff";
        e.multipleSelectedBlocks ? .forEach(m => {
            if (!(m.controls && !!m.controls.find(y => y === "common_draggable"))) return;
            let g = m.model.attributes.modifiers || [];
            if (g) {
                let y = g.findIndex(S => S.id === "drag");
                if (y > -1) {
                    if (!u) {
                        let S = [...g];
                        S.splice(y, 1), m.model.set({
                            modifiers: S
                        })
                    }
                } else if (u) {
                    let S = [...g, wy];
                    m.model.set({
                        modifiers: S
                    }), nS()
                }
            } else if (u) {
                let y = [wy];
                m.model.set({
                    modifiers: y
                }), nS()
            }
        }), e.groupSave()
    }, h = (0, Oa.useCallback)(u => {
        u.preventDefault(), !e.disabled && (e.deselectControls(), i ? p() : d())
    }, [e, n, i, s, a]);
    return r(Ie, {
        control: ({
            ref: u
        }) => r(ke, {
            ref: u,
            label: c,
            isActive: i ? s !== "allOff" : n,
            isMixed: s === "mixed",
            customBackground: l,
            onClick: h,
            children: r(H0, {})
        })
    })
}
var Oa, Eee, Fee, rS, D5 = k(() => {
    "use strict";
    Oa = E(N());
    Qj();
    qt();
    ht();
    F5();
    qf();
    Le();
    ae();
    B();
    Eee = e => {
        if (!e) return "uncertain";
        let t = 0;
        return e.forEach(o => {
            o.attributes.modifiers && o.attributes.modifiers.find(i => i.id === "drag") && (t += 1)
        }), t ? t === e.length ? "allOn" : "mixed" : "allOff"
    }, Fee = e => {
        if (!e) return !1;
        let t = 0;
        return e.forEach(o => {
            let i = !1;
            o.controls && (i = !!o.controls.find(n => n === "common_draggable")), i && (t += 1)
        }), t === e.length
    };
    rS = Dee
});
var A5 = k(() => {
    "use strict";
    D5()
});
var L5, z5 = k(() => {
    "use strict";
    ae();
    A5();
    L5 = Ce.extend({
        name: "common_draggable",
        component: rS,
        rolePermission: "BaseWidgetCanChangeModifiers"
    })
});
var Pn, $5, Aee, W5, O5 = k(() => {
    "use strict";
    Pn = E(N()), $5 = E(gi());
    Hi();
    nt();
    Vn();
    $e();
    qt();
    qo();
    ae();
    Le();
    Mt();
    ko();
    nn();
    zH();
    Ht();
    h1();
    Ps();
    B();
    Aee = (0, Pn.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o
        } = (0, Pn.useContext)(Y), {
            model: i,
            modelSet: n,
            modelSave: s
        } = (0, Pn.useContext)(ge), {
            callback: a
        } = Je(s, 400), {
            callback: l
        } = Je(o.groupSave, 400), c = !!o.multipleSelectedModels, d = !!i.picture, [p, h] = (0, Pn.useState)(!1), [u, m] = (0, Pn.useState)(!1), [f, g] = (0, Pn.useState)(!1);
        (0, Pn.useEffect)(() => {
            let O = o.multipleSelectedModels ? o.multipleSelectedModels.map(V => V.get("lightbox") || void 0).filter(V => V) : [],
                L = new Set(O.map(V => V.enabled)),
                W = new Set(O.map(V => V.color)),
                z = new Set(O.map(V => V.gallery));
            g(L.size > 1), h(W.size > 1), m(z.size > 1)
        }, []);
        let y = o.block.$el.get(0),
            S = (0, Pn.useMemo)(() => o.project.get("_id"), [o]),
            w = (0, Pn.useMemo)(() => o.user.get("_id"), [o]),
            v = i.lightbox ? .enabled || !1,
            C = i.lightbox ? .gallery || !1,
            I = i.lightbox ? .color || de.lightbox.initialColorHexa,
            [T, P] = (0, Pn.useState)(Yo(I)),
            M = Qi("BaseWidgetCanSelectColorFromPalette"),
            F = Qi("BaseWidgetCanSelectColorFromSwatches");

        function R(O) {
            let L = {
                lightbox: {
                    enabled: v,
                    color: ro(T),
                    gallery: C,
                    ...O
                }
            };
            c ? (o.groupSet(L), l()) : (n(L), a()), f && g(!1), p && h(!1), u && m(!1)
        }
        let A = (0, Pn.useMemo)(() => document.getElementById("main"), []),
            D = (0, Pn.useMemo)(() => {
                let O = o.workspace.viewport,
                    L = o.workspace.mag.getViewportWidth(O),
                    W = o.workspace.mag.get("opts");
                return p1({
                    widgetElement: y,
                    viewportWidth: L,
                    viewport: O,
                    viewerOptions: W
                })
            }, []);
        return x(Q, {
            children: [x(Me, {
                ref: t,
                style: e,
                isShowed: !0,
                children: [r(co, {
                    title: "Lightbox"
                }), r(H, {
                    showBorder: !1,
                    leftSlot: v ? "On" : "Off",
                    rightSlot: r(Ve, {
                        multipleValues: f,
                        checked: v,
                        backgroundChecked: "black",
                        onChange: () => {
                            let O = !v;
                            R({
                                enabled: O
                            }), O && De(Fe.WidgetFeature, {
                                featureType: "lightbox on"
                            })
                        }
                    })
                }), r(qe, {
                    multipleValues: p,
                    showBorder: !1,
                    disabled: !v,
                    title: "Overlay",
                    projectId: S,
                    userId: w,
                    color: T,
                    setColor: O => {
                        O && P(O)
                    },
                    onChangeComplete: O => {
                        R({
                            color: ro(O)
                        })
                    },
                    swatchesOnlyMode: F && !M
                }), r(H, {
                    showBorder: !1,
                    disabled: !v,
                    leftSlot: "Add to Gallery",
                    rightSlot: r(Ve, {
                        multipleValues: u,
                        checked: C,
                        backgroundChecked: "black",
                        onChange: () => {
                            let O = !C;
                            R({
                                gallery: O
                            }), O && De(Fe.WidgetFeature, {
                                featureType: "lightbox add to gallery on"
                            })
                        }
                    })
                })]
            }), !c && A && v && d && $5.default.createPortal(r(c1, {
                mode: "constructor",
                isVisible: !0,
                index: 0,
                slides: d1([{ ...i,
                    $el: o.block.$el
                }]),
                originRect: D
            }), A)]
        })
    }), W5 = Aee
});

function Lee() {
    let {
        model: e
    } = (0, km.useContext)(Y), {
        model: t
    } = (0, km.useContext)(ge), o = (0, km.useCallback)(i => {
        i.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: i
        }) => r(ke, {
            ref: i,
            isActive: t.lightbox ? .enabled,
            label: "Lightbox",
            onClick: o,
            children: r(X0, {
                color: "white"
            })
        }),
        panel: ({
            ref: i,
            style: n
        }) => e.selected ? r(W5, {
            ref: i,
            style: n
        }) : null
    })
}
var km, j5, H5 = k(() => {
    "use strict";
    km = E(N());
    rH();
    ae();
    ht();
    O5();
    Le();
    B();
    j5 = Lee
});
var N5, U5 = k(() => {
    "use strict";
    ae();
    H5();
    N5 = Ce.extend({
        name: "lightbox",
        component: j5,
        rolePermission: "PictureCanChangeLightbox"
    })
});
var zee, la, sS = k(() => {
    "use strict";
    ie();
    ve();
    zee = ue(b)
    `
  width: 30px;
  height: 30px;
  background-color: rgba(68, 68, 76, 0.95);
  border-radius: 100%;
  margin-left: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;

  &:first-of-type {
    margin-left: 0px;
  }

  &:hover {
    background-color: ${({theme:e})=>e.colors.blue};
  }
`, la = zee
});

function V5(e) {
    let t = {
        t: Number.POSITIVE_INFINITY,
        l: Number.POSITIVE_INFINITY,
        b: Number.NEGATIVE_INFINITY,
        r: Number.NEGATIVE_INFINITY
    };
    return e.forEach(o => {
        let i = o.getBoxData({
            includeBoundingBox: !0
        });
        t.t = Math.min(t.t, i.bb_y), t.l = Math.min(t.l, i.bb_x), t.b = Math.max(t.b, i.bb_y + i.bb_h), t.r = Math.max(t.r, i.bb_x + i.bb_w)
    }), {
        x: t.l,
        y: t.t,
        w: t.r - t.l,
        h: t.b - t.t
    }
}

function Pd(e) {
    let t = !1,
        o = {
            selectedDims: V5(e),
            groupBlocks: {}
        };
    e.forEach(a => {
        let l = a.model.get("pack_id");
        l ? (o.groupBlocks[l] || (o.groupBlocks[l] = []), o.groupBlocks[l].push(a)) : t = !0
    });
    let i = Object.keys(o.groupBlocks),
        n = i.reduce((a, l) => {
            let c = o.groupBlocks[l];
            return a[l] = V5(c), a
        }, {}),
        s = !t && i.length === 1;
    return {
        selectedDims: o.selectedDims,
        groupDims: n,
        selectedOnlyOneGroup: s
    }
}

function ca(e, t, o) {
    return () => {
        let i = Array.isArray(t) ? t : [t];
        i.forEach(s => s.storeFixedPosition()), e();
        let n = i.map(s => (s.restoreFixedPosition(), s.model));
        o.save_group(n)
    }
}
var aS = k(() => {
    "use strict"
});
var G5, $ee, Y5, Z5 = k(() => {
    "use strict";
    G5 = E(N());
    ie();
    ir();
    Hj();
    k0();
    ae();
    sS();
    aS();
    B();
    $ee = (0, G5.forwardRef)(({
        style: e,
        blocks: t
    }, o) => {
        let {
            model: i
        } = Ms();

        function n(h, u) {
            let m = t.map(f => {
                let g = f.model.get("pack_id"),
                    y = f.getBoxData({
                        includeBoundingBox: !0
                    });
                return {
                    _id: f.model.id,
                    [h]: u({
                        packId: g,
                        boxData: y
                    })
                }
            });
            i.workspace.save_group(m)
        }

        function s() {
            let h = Pd(t),
                u = h.selectedDims.y;
            n("y", ({
                boxData: m,
                packId: f
            }) => {
                let g = f && h.groupDims[f];
                return g && !h.selectedOnlyOneGroup ? m.y + (u - g.y) : u - (m.bb_y - m.y)
            })
        }

        function a() {
            let h = Pd(t),
                u = h.selectedDims.x;
            n("x", ({
                boxData: m,
                packId: f
            }) => {
                let g = f && h.groupDims[f];
                return g && !h.selectedOnlyOneGroup ? m.x + (u - g.x) : u - (m.bb_x - m.x)
            })
        }

        function l() {
            let h = Pd(t),
                u = h.selectedDims.x + h.selectedDims.w;
            n("x", ({
                boxData: m,
                packId: f
            }) => {
                let g = f && h.groupDims[f];
                return g && !h.selectedOnlyOneGroup ? m.x + (u - g.w - g.x) : u - (m.bb_w - (m.bb_w - m.w) / 2)
            })
        }

        function c() {
            let h = Pd(t),
                u = h.selectedDims.y + h.selectedDims.h;
            n("y", ({
                boxData: m,
                packId: f
            }) => {
                let g = f && h.groupDims[f];
                return g && !h.selectedOnlyOneGroup ? m.y + (u - g.h - g.y) : u - (m.bb_h - (m.bb_h - m.h) / 2)
            })
        }

        function d() {
            let h = Pd(t),
                u = h.selectedDims.y + h.selectedDims.h / 2;
            n("y", ({
                boxData: m,
                packId: f
            }) => {
                let g = f && h.groupDims[f];
                return g && !h.selectedOnlyOneGroup ? m.y + (u - g.h / 2 - g.y) : u - m.h / 2
            })
        }

        function p() {
            let h = Pd(t),
                u = h.selectedDims.x + h.selectedDims.w / 2;
            n("x", ({
                boxData: m,
                packId: f
            }) => {
                let g = f && h.groupDims[f];
                return g && !h.selectedOnlyOneGroup ? m.x + (u - g.w / 2 - g.x) : u - m.w / 2
            })
        }
        return x(b, {
            ref: o,
            style: e,
            display: "flex",
            children: [r(et, {
                text: "Align Left Edges",
                indent: 4,
                children: r(la, {
                    onClick: ca(a, t, i.workspace),
                    children: r(Kc, {
                        color: "white"
                    })
                })
            }), r(et, {
                text: "Align Vertical Centers",
                indent: 4,
                children: r(la, {
                    onClick: ca(p, t, i.workspace),
                    children: r($v, {
                        color: "white"
                    })
                })
            }), r(et, {
                text: "Align Right Edges",
                indent: 4,
                children: r(la, {
                    onClick: ca(l, t, i.workspace),
                    children: r(Kc, {
                        color: "white",
                        transform: "scale(-1, 1)"
                    })
                })
            }), r(et, {
                text: "Align Bottom Edges",
                indent: 4,
                children: r(la, {
                    onClick: ca(c, t, i.workspace),
                    children: r(Kc, {
                        color: "white",
                        transform: "rotate(-90deg)"
                    })
                })
            }), r(et, {
                text: "Align Horizontal Centers",
                indent: 4,
                children: r(la, {
                    onClick: ca(d, t, i.workspace),
                    children: r($v, {
                        color: "white",
                        transform: "rotate(90deg)"
                    })
                })
            }), r(et, {
                text: "Align Top Edges",
                indent: 4,
                children: r(la, {
                    onClick: ca(s, t, i.workspace),
                    children: r(Kc, {
                        color: "white",
                        transform: "rotate(90deg) scale(1, -1)"
                    })
                })
            })]
        })
    }), Y5 = $ee
});
var X5, Wee, K5, J5 = k(() => {
    "use strict";
    X5 = E(N());
    ie();
    ir();
    C0();
    jj();
    ae();
    Wo();
    sS();
    aS();
    B();
    Wee = (0, X5.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o
        } = Ms(), i = Oe.dictionary[o.workspace.viewport].width;

        function n(d, p) {
            o.block.model.set(d, p), o.block.model.save()
        }

        function s() {
            let d = o.block.getBoxData({
                    includeBoundingBox: !0
                }),
                p = (i - o.workspace.getCachedSizes().elWidth) / 2;
            n("x", p - (d.bb_x - d.x))
        }

        function a() {
            let d = o.block.getBoxData({
                    includeBoundingBox: !0
                }),
                p = i + (o.workspace.getCachedSizes().elWidth - i) / 2;
            n("x", p - (d.bb_w - (d.bb_w - d.w) / 2))
        }

        function l() {
            let d = o.block.getBoxData({
                includeBoundingBox: !0
            });
            n("x", i / 2 - d.w / 2)
        }
        let c = d => {
            d === "left" ? ca(s, o.block, o.workspace)() : d === "center" ? ca(l, o.block, o.workspace)() : d === "right" && ca(a, o.block, o.workspace)()
        };
        return x(b, {
            ref: t,
            style: e,
            display: "flex",
            children: [r(et, {
                text: "Align Left",
                indent: 4,
                children: r(la, {
                    onClick: () => c("left"),
                    children: r(zv, {
                        color: "white"
                    })
                })
            }), r(et, {
                text: "Align Center",
                indent: 4,
                children: r(la, {
                    onClick: () => c("center"),
                    children: r(Cf, {
                        color: "white"
                    })
                })
            }), r(et, {
                text: "Align Right",
                indent: 4,
                children: r(la, {
                    onClick: () => c("right"),
                    children: r(zv, {
                        color: "white",
                        transform: "scale(-1, 1)"
                    })
                })
            })]
        })
    }), K5 = Wee
});

function Oee() {
    let {
        model: e
    } = Ms(), t = (0, xy.useMemo)(() => !!e.multipleSelectedBlocks, [e.multipleSelectedBlocks]), o = (0, xy.useCallback)(i => {
        i.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        offset: [0, 5],
        control: ({
            ref: i
        }) => r(ke, {
            ref: i,
            label: "Align",
            onClick: o,
            children: t ? r(Kc, {}) : r(Cf, {})
        }),
        panel: ({
            ref: i,
            style: n
        }) => e.selected ? t ? r(Y5, {
            ref: i,
            style: n,
            blocks: e.multipleSelectedBlocks
        }) : r(K5, {
            ref: i,
            style: n
        }) : null
    })
}
var xy, q5, Q5 = k(() => {
    "use strict";
    xy = E(N());
    k0();
    C0();
    ae();
    ht();
    Z5();
    J5();
    B();
    q5 = Oee
});
var e8, t8 = k(() => {
    "use strict";
    ae();
    Q5();
    e8 = Ce.extend({
        name: "common_align",
        component: q5,
        rolePermission: "BaseWidgetCanChangeCoordinates"
    })
});

function i8({
    icon: e,
    ...t
}) {
    return r(o8, { ...t,
        children: e
    })
}
var o8, lS, cS = k(() => {
    "use strict";
    je();
    ve();
    B();
    o8 = ue(jl)
    `
  position: relative;
  width: ${e=>e.size?`${e.size}px`:"24px"};
  height: ${e=>e.size?`${e.size}px`:"24px"};
  padding: 0;
  border-radius: 50%;
  transition: 0.1s background;
  box-sizing: border-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  background: ${({inverted:e,solid:t,color:o,theme:i})=>e?i.colors[o||"orange"]:t?i.colors.white:"transparent"};
  ${({inverted:e,theme:t})=>e?`
    border: 2 px solid $ {
        t.colors.white
    };
    box - sizing: content - box;
    `:""}

  & path {
    transition: 0.1s stroke, 0.1s fill;
    fill: ${({inverted:e,color:t,theme:o})=>e?o.colors.white:o.colors[t||"orange"]};
  }

  &:focus,
  &:hover {
    background: ${({inverted:e,color:t,theme:o})=>e?o.colors.white:o.colors[t||"orange"]};

    & path {
      fill: ${({inverted:e,color:t,theme:o})=>e?o.colors[t||"orange"]:o.colors.white};
    }
  }
`;
    o8.displayName = "IconButton";
    i8.defaultProps = {
        color: "gray"
    };
    lS = i8
});
var n8 = k(() => {
    "use strict";
    cS();
    cS()
});

function r8() {
    return r(Ut, {
        showBorder: !1,
        leftSlot: "Position",
        rightSlot: r(lS, {
            onClick: () => {
                window.open(O9, "_blank")
            },
            icon: r(ed, {})
        })
    })
}
var s8 = k(() => {
    "use strict";
    gn();
    Uv();
    n8();
    ym();
    B()
});
var da, a8 = k(() => {
    "use strict";
    ie();
    ve();
    da = b.withComponent(ue(b)
        `
  width: 24px;
  height: 24px;
  cursor: pointer;
  border-radius: 100%;
  ${e=>e.active?{backgroundColor:e.theme.colors.blue,boxShadow:"none"}:{backgroundColor:e.theme.colors.lightGray,boxShadow:"inset 0 0 0 1px rgb(153 153 153 / 40%)"}};

  ${e=>e.disabled&&{boxShadow:"none",cursor:"default",pointerEvents:"none",backgroundColor:e.theme.colors.gray}};
`);
    da.defaultProps = {
        active: !1
    }
});
var dS = k(() => {
    "use strict";
    a8()
});

function l8({
    onClick: e,
    activePosition: t,
    disabledPositions: o = []
}) {
    return x(H, {
        leftSlot: "Fix on screen",
        children: [r(b, {
            position: "relative",
            top: 10,
            children: r(ao, {
                targetSteps: ["PositionTopRight"],
                position: "left",
                indent: -52,
                children: r("div", {})
            })
        }), r(b, {
            display: "grid",
            gridTemplateColumns: "repeat(3, 24px)",
            rowGap: "4px",
            columnGap: "8px",
            children: za.map(i => r(da, {
                "aria-label": `Fixed position toggle "${i}"`,
                onClick: () => {
                    e(i), i === "ne" && st("PositionTopRight")
                },
                active: i === t,
                disabled: o.includes(i),
                "data-testid": `fixed-position-${i}`
            }, i))
        })]
    })
}
var c8 = k(() => {
    "use strict";
    ie();
    $e();
    dS();
    ym();
    Fs();
    pi();
    B()
});

function d8({
    top: e,
    left: t,
    right: o,
    bottom: i,
    middleFullWidth: n,
    middleFullHeight: s,
    disabledHovers: a
}) {
    let {
        isHovered: l,
        ...c
    } = nr(), {
        isHovered: d,
        ...p
    } = nr();
    return x(b, {
        position: "relative",
        width: "100%",
        height: "100%",
        children: [r(zu, {
            variant: "top",
            children: e
        }), r(zu, {
            variant: "left",
            children: t
        }), r(zu, {
            variant: "right",
            children: o
        }), r(zu, {
            variant: "bottom",
            children: i
        }), s ? r(zu, {
            variant: "middleHeight",
            opacity: d && !a ? .5 : 1,
            ...c,
            children: s
        }) : null, s ? r(zu, {
            variant: "middleWidth",
            opacity: l && !a ? .5 : 1,
            ...p,
            children: n
        }) : null]
    })
}
var zu, p8 = k(() => {
    "use strict";
    ie();
    od();
    ve();
    B();
    zu = ue(b)
    `
  position: absolute;
  ${Jm({top:{top:0,left:"50%",transform:"translateX(-50%)",zIndex:3},left:{top:"50%",left:0,transform:"translateY(-50%)",zIndex:3},right:{top:"50%",right:0,transform:"translateY(-50%)",zIndex:3},bottom:{bottom:0,left:"50%",transform:"translateX(-50%)",zIndex:3},middleWidth:{top:"50%",left:"50%",width:"100%",transform:"translate(-50%, -50%)","&:hover":{zIndex:2}},middleHeight:{top:"50%",left:"50%",height:"100%",transform:"translate(-50%, -50%)","&:hover":{zIndex:2}}})}
`
});

function h8({
    onClickSticky: e,
    activePosition: t,
    activeFullWidth: o,
    onClickFullWidth: i,
    activeFullHeight: n,
    onClickFullHeight: s,
    allowFullWidth: a,
    allowFullHeight: l,
    fullHeightInputProps: c,
    fullWidthInputProps: d,
    disabledFullHeight: p,
    disabledFullWidth: h
}) {
    return r(H, {
        leftSlot: "Stick to page edges",
        showBorder: !1,
        children: x(b, {
            display: "flex",
            flexWrap: "wrap",
            children: [r(b, {
                height: "100px",
                width: "70%",
                children: r(d8, {
                    disabledHovers: h && p,
                    top: r(da, {
                        "aria-label": "Sticky top toggle",
                        active: t === "top",
                        onClick: () => e("top"),
                        "data-testid": "sticky-position-top"
                    }),
                    left: r(da, {
                        "aria-label": "Sticky left toggle",
                        active: t === "left",
                        onClick: () => e("left"),
                        "data-testid": "sticky-position-left"
                    }),
                    right: r(da, {
                        "aria-label": "Sticky right toggle",
                        active: t === "right",
                        onClick: () => e("right"),
                        "data-testid": "sticky-position-right"
                    }),
                    bottom: r(da, {
                        "aria-label": "Sticky bottom toggle",
                        active: t === "bottom",
                        onClick: () => e("bottom"),
                        "data-testid": "sticky-position-bottom"
                    }),
                    middleFullWidth: a ? r(da, {
                        disabled: h,
                        onClick: i,
                        active: o,
                        borderRadius: "12px",
                        width: "100%",
                        "data-testid": "sticky-position-full-width"
                    }) : null,
                    middleFullHeight: l ? r(da, {
                        disabled: p,
                        onClick: s,
                        active: n,
                        borderRadius: "12px",
                        height: "100%",
                        "data-testid": "sticky-position-full-height"
                    }) : null
                })
            }), a && o ? r(b, {
                width: "30%",
                alignSelf: "center",
                children: r(fe, {
                    fontSize: 20,
                    textAlign: "end",
                    max: 256,
                    min: 0,
                    ...d
                })
            }) : null, l && n ? r(b, {
                width: "70%",
                children: r(fe, {
                    fontSize: 20,
                    textAlign: "center",
                    max: 256,
                    min: 0,
                    ...c
                })
            }) : null]
        })
    })
}
var m8 = k(() => {
    "use strict";
    $e();
    ie();
    zt();
    Ht();
    dS();
    p8();
    B()
});

function jee(e, t) {
    let o = {
        t: Number.POSITIVE_INFINITY,
        l: Number.POSITIVE_INFINITY,
        b: Number.NEGATIVE_INFINITY,
        r: Number.NEGATIVE_INFINITY
    };
    return e.forEach(i => {
        let n = i.getBoxData(t);
        o.t = Math.min(o.t, n.bb_y), o.l = Math.min(o.l, n.bb_x), o.b = Math.max(o.b, n.bb_y + n.bb_h), o.r = Math.max(o.r, n.bb_x + n.bb_w)
    }), o
}

function _y(e) {
    return e.flatMap(t => {
        if (t.model.get("type") === "hotspot") {
            let o = [t, ...t.getGroupBlocks()];
            return Hee(o)
        }
        return t
    })
}

function Hee(e) {
    return [...new Map(e.map(t => [t.model.get("_id"), t])).values()]
}

function Sy(e, t, o, i = !1) {
    let n = o.viewport,
        s = o.mag.toJSON(),
        a = o.page.toJSON(),
        l = {
            width: window.innerWidth,
            height: window.innerHeight
        },
        c = !1,
        d = {
            default: {},
            phone_portrait: {},
            tablet_portrait: {}
        };
    for (let p of Oe.types)
        for (let h of e) {
            let u = h.model.toJSON(),
                m = vo.getCoordinateBox(u, p);
            d[p][u._id] = m.fixed_position
        }
    for (let p of e) {
        let h = p.model,
            u = h.id,
            m = (f, g) => {
                let y = d[g][u];
                return {
                    sticked: "",
                    sticked_margin: void 0,
                    fixed_position: (typeof t == "function" ? t(y || void 0) : t) ? ? ""
                }
            };
        i ? h.setInViewports(m) : h.set(m(h.attributes, n)), c = c || h.get("is_full_height")
    }
    for (let p of Oe.types) {
        let h = n === p ? window.RM.constructorRouter.zoom.getZoom() : 1,
            u = n === p ? o.$container[0] : {
                scrollTop: 0,
                scrollLeft: 0
            },
            f = {
                workspaceSize: vo.getWorkspaceSize(s, a, p),
                windowSize: l,
                viewport: p,
                zoom: h,
                scroller: u
            };
        for (let g of e) {
            let y = g.model,
                S = y.id,
                w = y.toJSON(),
                C = vo.getCoordinateBox(w, p).fixed_position,
                I = d[p][S];
            if (C !== I && y.isViewportInitialized(p)) {
                let T = vo.mapWidgetToWindow([w], f, {
                        fixed_position: I
                    }),
                    P = n === p ? T : Bt.confine(T, l),
                    {
                        x: M,
                        y: F
                    } = vo.mapWidgetToWorkspace(P, C || void 0, f);
                y.clone({
                    viewport: p
                }).set({
                    x: M,
                    y: F
                })
            }
        }
    }
    return {
        needToSetFullHeight: c
    }
}

function f8(e, t, o) {
    let i = t.$container.scrollTop(),
        n = window.RM.constructorRouter.zoom.getZoom(),
        s = t.position,
        a = t.getCachedSizes(),
        l = t.viewport,
        c = Oe.dictionary[l].width,
        d = !1,
        p = [];
    for (let h of e)
        if (h.model.get("is_full_height") && (d = !0), h.model.get("fixed_position") && (!o || h.model.get("fixed_position") === o)) {
            let u = h.$el.offset();
            p.push({
                _id: h.model.get("_id"),
                fixed_position: "",
                x: u.left - s.left - (a.elWidth - c) / 2,
                y: u.top - s.top + i / n
            })
        }
    return {
        result: p,
        needToSetFullHeight: d
    }
}

function Im(e, t, o) {
    let i = _y(t),
        n = [],
        s = [];
    for (let a of i) n.push({
        _id: a.model.id,
        is_global: e
    });
    if (!e) s = o.mag.changeParentPage(i.map(a => a.model), o.page, {
        silent: !0
    });
    else
        for (let a of i) Ai.resetGlobalData(a.model);
    return {
        result: n,
        blocks: t,
        affectedPages: s
    }
}

function g8(e, t) {
    let o = jee(t, {
            includeBoundingBox: !0
        }),
        i = [];
    for (let n of t) {
        let s = n.getBoxData({
                includeBoundingBox: !0
            }),
            a = 0;
        switch (e) {
            case "left":
                a = s.x - o.l;
                break;
            case "right":
                a = (o.r - (s.x + s.w)) / window.RM.constructorRouter.zoom.getZoom();
                break;
            case "top":
                a = s.y - o.t;
                break;
            case "bottom":
                a = o.b - (s.y + s.h);
                break;
            default:
                let c = e;
                throw new Error(`Unknown position: ${c}`)
        }
        let l = n.getStickedDims(e, a);
        i.push({
            _id: n.model.id,
            sticked: e,
            sticked_margin: a,
            x: l.x,
            y: l.y
        })
    }
    return i
}

function Td(e, t = {}) {
    let o = [];
    for (let i of e) {
        let n = i.model.get("sticked");
        if (n && (!t.side || n === t.side)) {
            if (t.horizontalOnly && n !== "left" && n !== "right" || t.verticalOnly && n !== "bottom" && n !== "top") continue;
            let s = i.getStickedDims();
            o.push({
                _id: i.model.id,
                x: s.x,
                y: s.y,
                sticked: "",
                sticked_margin: void 0
            })
        }
    }
    return o
}

function Bd(e, t, o) {
    let i = _y(t),
        n = [];
    for (let s of i) n.push({
        _id: s.model.id,
        is_above: e
    });
    return e && Sy(i, s => s || "c", o, !0), n
}

function pS(e, t, o) {
    let i = [],
        n = e[0].getFullWidthDims(t);
    for (let s of e) {
        let a = {
            _id: s.model.get("_id"),
            is_full_width: !0,
            w: n.w,
            full_width_margin: t
        };
        o ? .storeWidth && (a.full_width_initial_x = s.model.get("x"), a.full_width_initial_w = s.model.get("w"), s.model.get("angle") && (a.angle = 0), s.model.get("flip_v") && (a.flip_v = !1), s.model.get("flip_h") && (a.flip_h = !1)), i.push(a)
    }
    return i
}

function uS(e) {
    let t = [];
    for (let o of e) o.model.get("is_full_width") && t.push({
        _id: o.model.get("_id"),
        is_full_width: !1,
        x: o.model.get("full_width_initial_x") || o.model.get("x"),
        w: o.model.get("full_width_initial_w") || o.model.get("w")
    }), o.model.get("is_full_height") && t.push({
        _id: o.model.get("_id"),
        h: o.getFullHeightDims().h
    });
    return t
}

function $u(e, t, o) {
    let i = [],
        s = e[0].getFullHeightDims(t);
    for (let a of e) {
        let l = {
            _id: a.model.get("_id"),
            is_full_height: !0,
            h: s.h,
            full_height_margin: t
        };
        o ? .storeHeight && (l.full_height_initial_y = a.model.get("y"), l.full_height_initial_h = a.model.get("h"), a.model.get("angle") && (l.angle = 0), a.model.get("flip_v") && (l.flip_v = !1), a.model.get("flip_h") && (l.flip_h = !1)), i.push(l)
    }
    return i
}

function hS(e) {
    let t = [];
    for (let o of e) o.model.get("is_full_height") && t.push({
        _id: o.model.get("_id"),
        is_full_height: !1,
        y: o.model.get("full_height_initial_y") || o.model.get("y"),
        h: o.model.get("full_height_initial_h") || o.model.get("h")
    }), o.model.get("is_full_width") && t.push({
        _id: o.model.get("_id"),
        w: o.getFullWidthDims().w
    });
    return t
}
var mS = k(() => {
    "use strict";
    Ht();
    Dv();
    Wo();
    Ya();
    Ml()
});
var b8, Cy, fS = k(() => {
    "use strict";
    b8 = E(N());
    B();
    Cy = (0, b8.forwardRef)((e, t) => x("svg", {
        width: "32",
        height: "32",
        viewBox: "0 0 32 32",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ref: t,
        ...e,
        children: [x("g", {
            clipPath: "url(#clip0_1907_624)",
            children: [r("path", {
                fillRule: "evenodd",
                clipRule: "evenodd",
                d: "M17.701 10.0538L20.299 11.5538L17.8941 19.4029L12.1309 16.0756L17.701 10.0538Z",
                fill: "currentColor"
            }), r("path", {
                fillRule: "evenodd",
                clipRule: "evenodd",
                d: "M15.866 18.232L11.9888 24.0136C11.8324 24.2474 11.5214 24.3198 11.2778 24.1791C11.0341 24.0385 10.9414 23.7329 11.0656 23.4805L14.134 17.232L15.866 18.232Z",
                fill: "currentColor"
            }), r("path", {
                d: "M16.0359 7.93781C16.312 7.45952 16.9236 7.29565 17.4019 7.57179L22.5981 10.5718C23.0764 10.8479 23.2402 11.4595 22.9641 11.9378C22.688 12.4161 22.0764 12.58 21.5981 12.3038L16.4019 9.30384C15.9236 9.0277 15.7598 8.41611 16.0359 7.93781Z",
                fill: "currentColor"
            }), r("path", {
                d: "M9.43782 13.366C9.71396 12.8877 10.3256 12.7238 10.8038 13L21.1962 19C21.6744 19.2761 21.8383 19.8877 21.5622 20.366C21.286 20.8443 20.6744 21.0082 20.1962 20.732L9.80385 14.732C9.32556 14.4559 9.16168 13.8443 9.43782 13.366Z",
                fill: "currentColor"
            })]
        }), r("defs", {
            children: r("clipPath", {
                id: "clip0_1907_624",
                children: r("rect", {
                    width: "14",
                    height: "18",
                    fill: "currentColor",
                    transform: "translate(13.9378 5.57179) rotate(30)"
                })
            })
        })]
    }))
});

function v8(e) {
    let t = (0, y8.useRef)();
    return Va(() => {
        t.current = e
    }, [e]), t.current
}
var y8, w8 = k(() => {
    "use strict";
    y8 = E(N());
    sh()
});

function Nee() {
    let {
        current: e
    } = (0, hl.useRef)([]), {
        model: t
    } = (0, hl.useContext)(ge), {
        model: o
    } = Ms(), i = v8(o.selected);
    (0, hl.useEffect)(() => (pt("widget.anomalyMonitoring") && document.addEventListener("click", Rh.onClick), () => document.removeEventListener("click", Rh.onClick)), []);
    let n = () => {
            let v = _y(o.blocks).map(T => T.model).concat(e);
            if (pt("widget.anomalyMonitoring")) {
                let T = v.find(P => P.attributes.sticked && P.attributes.fixed_position);
                T && sr.sendEvent({
                    type: "widgetIsBothFixedAndSticked",
                    widget: T
                })
            }
            let C = o.workspace.viewport;
            o.workspace.save_group(v, {
                viewport: "default"
            });
            let I = window.RM.constructorRouter.indexController.getPagesToSave();
            o.workspace.syncManager.saveGroup(I, {
                patch: !0,
                silent: !0
            }), C !== "default" && v.forEach(T => {
                T.setViewport ? .(C)
            })
        },
        s = v => {
            o.workspace.set_group(v), window.RM.constructorRouter.indexController.updateIndex(o.workspace.page, o.blocks.map(C => C.model), !1)
        },
        a = v => {
            if (t.fixed_position === v) {
                s(Bd(!1, o.blocks, o.workspace));
                let T = [],
                    P = !1;
                ({
                    needToSetFullHeight: P
                } = Sy(o.blocks, void 0, o.workspace)), ky.default.defer(() => {
                    P && (s($u(o.blocks, t.full_height_margin || 0)), n())
                }), s(T), n();
                return
            }
            s(Td(o.blocks)), t.is_global ? s(Bd(!0, o.blocks, o.workspace)) : s(Bd(!1, o.blocks, o.workspace));
            let C = [],
                {
                    needToSetFullHeight: I
                } = Sy(o.blocks, v, o.workspace);
            ky.default.defer(() => {
                I && (s($u(o.blocks, t.full_height_margin || 0)), n())
            }), s(C), n(), o.blocks.forEach(() => {
                window.RM.constructorRouter.trigger("notice:triggerMetrics", "countFixedWidgetCreated")
            }), window.RM.constructorRouter.trigger("notice:triggerMetrics", "fixedWidgetUsed")
        },
        l = v => {
            v || s(Bd(!1, o.blocks, o.workspace));
            let {
                blocks: C,
                result: I,
                affectedPages: T
            } = Im(v, o.blocks, o.workspace);
            e.push(...T), s(I), n(), o.workspace.trigger("widget:context:change", C), v && De(Fe.WidgetFeature, {
                featureType: "position on all pages on"
            }), t.is_global, t.is_above && st("PositionTogglesOn")
        },
        c = v => {
            if (v) {
                let {
                    blocks: C,
                    result: I,
                    affectedPages: T
                } = Im(v, o.blocks, o.workspace);
                e.push(...T), s(I), o.workspace.trigger("widget:context:change", C)
            }
            s(Bd(v, o.blocks, o.workspace)), n(), v && De(Fe.WidgetFeature, {
                featureType: "position above pages on"
            }), t.is_global, t.is_above && st("PositionTogglesOn")
        },
        d = v => {
            if (t.sticked === v) {
                s(Td(o.blocks, {
                    side: v
                })), n();
                return
            }
            let {
                result: C,
                needToSetFullHeight: I
            } = f8(o.blocks, o.workspace);
            I && s($u(o.blocks, t.full_height_margin || 0)), s(C), ["left", "right"].includes(v) ? s(uS(o.blocks)) : ["top", "bottom"].includes(v) && s(hS(o.blocks)), s(g8(v, o.blocks)), s(Bd(!1, o.blocks, o.workspace)), n(), v === "top" ? o.workspace.scrollToTop() : v === "bottom" && o.workspace.scrollToBottom()
        },
        p = () => {
            if (t.is_full_width) {
                s(uS(o.blocks)), n();
                return
            }
            s(Td(o.blocks, {
                horizontalOnly: !0
            })), s(pS(o.blocks, 0, {
                storeWidth: !0
            })), n()
        },
        h = () => {
            if (t.is_full_height) {
                s(hS(o.blocks)), n();
                return
            }
            s(Td(o.blocks, {
                verticalOnly: !0
            })), s($u(o.blocks, 0, {
                storeHeight: !0
            })), n()
        },
        u = ({
            value: v
        }) => {
            s(Td(o.blocks, {
                horizontalOnly: !0
            })), s(pS(o.blocks, v)), n()
        },
        m = ({
            value: v
        }) => {
            s(Td(o.blocks, {
                verticalOnly: !0
            })), s($u(o.blocks, v)), n()
        },
        f = v => {
            v.preventDefault(), !o.disabled && (st("PositionControlClick"), o.select())
        };
    (0, hl.useEffect)(() => {
        i && !o.selected && n(), mn(["PositionTopRight", "PositionTogglesOn"], {
            show: !o.selected
        })
    }, [o.selected, n, i]);
    let g = (0, hl.useMemo)(() => {
            let v = t.is_full_width,
                C = t.is_full_height,
                I = ky.default.chunk(za, 3);
            if (v && C) {
                let T = za[Math.floor(za.length / 2)];
                return za.filter(P => P !== T)
            } else {
                if (v) return I.flatMap(T => [T[0], T[2]]);
                if (C) return [...I[0], ...I[2]]
            }
            return []
        }, [t.is_full_width, t.is_full_height]),
        y = o.workspace.viewport === "default",
        S = t.fixed_position || o.block.restoreFixed,
        w = [S, t.is_global, t.sticked, t.is_full_height, t.is_full_width].some(Boolean);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: v
        }) => r(ke, {
            helpTourSteps: ["PositionControlClick"],
            label: "Position",
            ref: v,
            onClick: f,
            isActive: w,
            children: r(Cy, {})
        }),
        panel: ({
            ref: v,
            style: C
        }) => x(Me, {
            ref: v,
            style: C,
            "aria-label": "Position panel",
            isShowed: o.selected,
            children: [r(r8, {}), r(l8, {
                onClick: a,
                activePosition: S,
                disabledPositions: g
            }), r(pp, {
                position: "relative",
                top: 20,
                children: r(ao, {
                    targetSteps: ["PositionTogglesOn"],
                    position: "left",
                    indent: 8,
                    children: r("div", {})
                })
            }), r(H, {
                leftSlot: "On all pages",
                rightSlot: r(Ve, {
                    "aria-label": "On all pages toggle",
                    "data-testid": "on-all-page-switcher",
                    backgroundChecked: "blue",
                    onChange: l,
                    checked: t.is_global,
                    disabled: o.blocks.some(I => I.blockName === "ecommercecart")
                })
            }), r(ao, {
                eduTips: "eduTipUseAbovePages",
                position: "left",
                indent: 24,
                leaveDelay: 100,
                instance: !0,
                closeOnTargetClick: !0,
                children: r(H, {
                    leftSlot: "Above pages",
                    rightSlot: r(Ve, {
                        "aria-label": "Above pages toggle",
                        "data-testid": "above-page-switcher",
                        backgroundChecked: "blue",
                        onChange: c,
                        checked: t.is_above,
                        disabled: o.blocks.some(I => I.blockName === "ecommercecart")
                    })
                })
            }), r(h8, {
                onClickSticky: d,
                activePosition: t.sticked,
                onClickFullWidth: p,
                activeFullWidth: t.is_full_width,
                onClickFullHeight: h,
                activeFullHeight: t.is_full_height,
                allowFullWidth: j9.includes(t.type),
                allowFullHeight: H9.includes(t.type),
                disabledFullHeight: !y,
                disabledFullWidth: !y,
                fullWidthInputProps: {
                    value: t.full_width_margin || 0,
                    onChange: u
                },
                fullHeightInputProps: {
                    value: t.full_height_margin || 0,
                    onChange: m
                }
            })]
        })
    })
}
var hl, ky, x8, _8 = k(() => {
    "use strict";
    hl = E(N()), ky = E(ze());
    nt();
    $e();
    Hi();
    Ht();
    qt();
    ae();
    ht();
    s8();
    c8();
    m8();
    mS();
    ym();
    $l();
    Le();
    fS();
    w8();
    En();
    pd();
    aw();
    Fs();
    jr();
    pi();
    m0();
    B();
    x8 = Nee
});
var S8, C8 = k(() => {
    "use strict";
    ae();
    _8();
    S8 = Ce.extend({
        name: "common_position",
        component: x8,
        rolePermission: "BaseWidgetCanChangePosition",
        restrictions(e) {
            let t = {},
                o = e.getSelectedBlocks();
            return o.reduce(function(i, n) {
                if (!i) return i;
                if (n.model.get("pack_id")) {
                    let s = n.model.get("pack_id");
                    return t[s] ? i : (t[s] = e.blocks.filter(a => a.model.get("pack_id") === s), i && _.filter(o, a => a.model.get("pack_id") === s).length === t[s].length)
                } else return i
            }, !0)
        }
    })
});
var k8, I8 = k(() => {
    "use strict";
    B();
    k8 = () => r("svg", {
        xmlns: "http://www.w3.org/2000/svg",
        width: "32",
        height: "32",
        viewBox: "0 0 32 32",
        children: r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            fill: "currentColor",
            xmlns: "http://www.w3.org/2000/svg",
            d: "M10 15C9.44771 15 9 14.5523 9 14L9 10C9 9.44772 9.44771 9 10 9L14 9C14.5523 9 15 9.44772 15 10L15 14C15 14.5523 14.5523 15 14 15L10 15ZM10 23C9.44771 23 9 22.5523 9 22L9 18C9 17.4477 9.44771 17 10 17L14 17C14.5523 17 15 17.4477 15 18L15 22C15 22.5523 14.5523 23 14 23L10 23ZM17 22C17 22.5523 17.4477 23 18 23L22 23C22.5523 23 23 22.5523 23 22L23 18C23 17.4477 22.5523 17 22 17L18 17C17.4477 17 17 17.4477 17 18L17 22ZM18 15C17.4477 15 17 14.5523 17 14L17 10C17 9.44772 17.4477 9 18 9L22 9C22.5523 9 23 9.44772 23 10L23 14C23 14.5523 22.5523 15 22 15L18 15Z"
        })
    })
});
var Uee, Vee, Iy, gS = k(() => {
    "use strict";
    ve();
    ie();
    B();
    Uee = e => x("svg", {
        viewBox: "0 0 64 10",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("rect", {
            width: 64,
            height: 1,
            fill: "currentColor"
        }), r("rect", {
            y: 9,
            width: 64,
            height: 1,
            fill: "currentColor"
        }), r("rect", {
            y: 3,
            width: 64,
            height: 1,
            fill: "currentColor"
        }), r("rect", {
            y: 6,
            width: 64,
            height: 1,
            fill: "currentColor"
        })]
    }), Vee = b.withComponent(ue(Uee)
        `
      display: block;
    `), Iy = Vee
});
var Gee, Yee, Py, bS = k(() => {
    "use strict";
    ve();
    ie();
    B();
    Gee = e => r("svg", {
        viewBox: "0 0 16 10",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: x("g", {
            fill: "none",
            fillRule: "evenodd",
            children: [r("path", {
                stroke: "#808080",
                opacity: .4,
                d: "M.5.5h15v9H.5z"
            }), r("path", {
                fill: "#000000",
                fillRule: "nonzero",
                d: "M0 0h1v10H0z"
            })]
        })
    }), Yee = b.withComponent(ue(Gee)
        `
      display: block;
    `), Py = Yee
});
var Zee, Xee, Ty, yS = k(() => {
    "use strict";
    ve();
    ie();
    B();
    Zee = e => r("svg", {
        viewBox: "0 0 16 10",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: x("g", {
            fill: "none",
            fillRule: "evenodd",
            children: [r("path", {
                stroke: "#808080",
                opacity: .4,
                d: "M.5.5h15v9H.5z"
            }), r("path", {
                fill: "#000000",
                fillRule: "nonzero",
                d: "M15 0h1v10h-1z"
            })]
        })
    }), Xee = b.withComponent(ue(Zee)
        `
      display: block;
    `), Ty = Xee
});

function vS({ ...e
}) {
    return x(Qee, { ...e,
        children: [r(ete, {}), r(tte, {})]
    })
}
var Kee, Jee, qee, Qee, ete, tte, P8 = k(() => {
    "use strict";
    ie();
    ve();
    B();
    Kee = ws `
  0%,
  40% {
    width: 138px;
  }
  60%,
  100% {
    width: 45px;
  }
`, Jee = ws `
  0%,
  40% {
    transform: translate(0px) scale(1);
    border-radius: 4px;
  }
  60%,
  100% {
    transform: translate(-57px, 39px) scale(0.542, 0.48);
    border-radius: 12px;
  }
`, qee = ws `
  0%,
  40% {
    transform: scale(1);
  }
  60%,
  100% {
    transform: scale(0.75) translate(-2px, -2px);
  }
`, Qee = ue(b)
    `
  position: relative;
  box-sizing: border-box;
  width: 138px;
  height: 82px;
  border-radius: 8px;
  background: rgba(244, 244, 244, 0.96);
  overflow: hidden;
  animation: ${Kee} 2s ease-in alternate infinite;
`, ete = ue(b)
    `
  position: absolute;
  left: 5px;
  top: 5px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: ${e=>e.theme.colors.blue};
  transform-origin: left top;
  animation: ${qee} 2s ease-in alternate infinite;
  animation-play-state: inherit;
  animation-delay: inherit;
`, tte = ue(b)
    `
  position: absolute;
  left: 60px;
  top: 5px;
  background: ${e=>e.theme.colors.blue};
  width: 72px;
  height: 72px;
  border-radius: 4px;
  animation: ${Jee} 2s ease-in alternate infinite;
  animation-play-state: inherit;
  animation-delay: inherit;
  transform-origin: left top;
`
});

function wS({ ...e
}) {
    return x(ate, { ...e,
        children: [r(lte, {}), r(cte, {}), x(dte, {
            children: [r(Wu, {}), r(Wu, {}), r(Wu, {}), r(Wu, {}), r(Wu, {}), r(Wu, {})]
        }), r(pte, {})]
    })
}
var ote, ite, nte, rte, ste, ate, lte, cte, dte, Wu, pte, T8 = k(() => {
    "use strict";
    ie();
    ve();
    B();
    ote = ws `
  0%,
    40% {
      width: 138px;
    }
    60%,
    100% {
      width: 45px;
    }
`, ite = ws `
  0%,
    40% {
      // translate3d is needed so that the square doesn't disappear when animated in safari.
      // This seems to be due to overflow hidden and animated width on the tooltip container, but they are mandatory.
      transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1);
      border-radius: 4px;
    }
    60%,
    100% {
      transform: translate3d(-40px, -1px, 0px) scale3d(0.29, 0.29, 0.29);
      border-radius: 10px;
    }
`, nte = ws `
  0%,
    40% {
      transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1);
    }
    60%,
    100% {
      transform: translate3d(-2px, -1px, 0px) scale3d(0.29, 0.29, 0.29);
    }
`, rte = ws `
  0%,
    40% {
      transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1);
    }
    60%,
    100% {
      transform: translate3d(0px, -63px, 0px) scale3d(0.29, 0.29, 0.29);
    }
`, ste = ws `
  0%,
    40% {
      transform: translate3d(0px, 0px, 0px) scale3d(1, 1, 1);
    }
    60%,
    100% {
      transform: translate3d(0px, -156px, 0px) scale3d(0.29, 0.29, 0.29);
    }
`, ate = ue(b)
    `
  position: relative;
  box-sizing: border-box;
  width: 138px;
  height: 82px;
  overflow: hidden;
  border-radius: 8px;
  background: rgba(244, 244, 244, 0.96);
  animation: ${ote} 2s ease-in alternate infinite;
`, lte = ue(b)
    `
  position: absolute;
  left: 5px;
  top: 5px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: ${e=>e.theme.colors.blue};
  transform-origin: left top;
  animation: ${nte} 2s ease-in alternate infinite;
  animation-play-state: inherit;
  animation-delay: inherit;
`, cte = ue(b)
    `
  position: absolute;
  left: 60px;
  top: 5px;
  background: ${e=>e.theme.colors.blue};
  width: 72px;
  height: 72px;
  border-radius: 4px;
  animation: ${ite} 2s ease-in alternate infinite;
  animation-play-state: inherit;
  animation-delay: inherit;
  transform-origin: left top;
`, dte = ue(b)
    `
  position: absolute;
  left: 3px;
  top: 92px;
  width: 132px;
  animation: ${rte} 2s ease-in alternate infinite;
  animation-play-state: inherit;
  animation-delay: inherit;
  transform-origin: left top;
`, Wu = ue(b)
    `
  width: 100%;
  height: 10px;
  background: ${e=>e.theme.colors.blue};
  & + & {
    margin-top: 11px;
  }
  &:last-child {
    width: 75%;
  }
`, pte = ue(b)
    `
  position: absolute;
  left: 3px;
  top: 222px;
  width: 132px;
  height: 42px;
  background: ${e=>e.theme.colors.blue};
  border-radius: 0 0 10px 10px;
  animation: ${ste} 2s ease-in alternate infinite;
  animation-play-state: inherit;
  animation-delay: inherit;
  transform-origin: left top;
`
});
var ml, xS, OKe, B8 = k(() => {
    "use strict";
    ml = E(N());
    pd();
    B();
    xS = (0, ml.createContext)({
        selectedBlocks: [],
        blocks: [],
        mag: void 0,
        page: void 0,
        eCommerceManager: void 0,
        viewport: "default",
        viewports: [],
        setViewport: (e, t) => {},
        trigger: (e, t) => {},
        workspace: void 0,
        isCurrentPageLocked: !1
    }), OKe = ({
        router: e,
        children: t
    }) => {
        let o = e.workspace,
            i = e.workspace.page,
            [n, s] = (0, ml.useState)(() => ({
                selectedBlocks: o.getSelectedBlocks(),
                viewport: o.viewport,
                viewports: o.getViewports(),
                setViewport: o.setViewport,
                workspace: o
            })),
            a = () => s(m => ({ ...m,
                selectedBlocks: o.getSelectedBlocks()
            })),
            l = () => s(m => !o.getSelectedBlocks().length && !m.selectedBlocks.length ? m : { ...m,
                selectedBlocks: o.getSelectedBlocks()
            }),
            c = () => s(m => ({ ...m,
                viewport: e.workspace.viewport
            })),
            d = () => s(m => ({ ...m,
                selectedBlocks: []
            })),
            p = () => s(m => ({ ...m,
                viewports: o.getViewports()
            })),
            h = () => s(m => ({ ...m,
                viewports: e.workspace.getViewports(),
                viewport: e.workspace.viewport,
                selectedBlocks: e.workspace.getSelectedBlocks(),
                setViewport: e.workspace.setViewport,
                workspace: e.workspace
            })),
            u = (0, ml.useMemo)(() => e.isCurrentPageLocked(), [i, e]);
        return (0, ml.useEffect)(() => {
            let m = e.workspace.mag.pages;
            return o.on("select", a), o.on("deselect", l), m.on("widgets:remove", d), m.on("change:viewport", c), m.on("change:viewport_phone_portrait", p), m.on("change:viewport_tablet_portrait", p), e.on("pageChange", h), e.on("select:workspace", h), sr.setContext({
                pageNumId: o.page.get("num_id")
            }), () => {
                o.off("select", a), o.off("deselect", l), m.off("widgets:remove", d), m.off("change:viewport", c), m.off("change:viewport_phone_portrait", p), m.off("change:viewport_tablet_portrait", p), e.off("pageChange", h), e.off("select:workspace", h)
            }
        }, [o]), (0, ml.useEffect)(() => {
            sr.setContext({
                viewport: n.viewport
            })
        }, [n.viewport]), r(xS.Provider, {
            value: { ...n,
                mag: o.mag,
                page: i,
                eCommerceManager: o.eCommerceManager,
                blocks: o.blocks,
                trigger: o.trigger,
                isCurrentPageLocked: u
            },
            children: t
        })
    }
});
var ute, hte, M8, R8 = k(() => {
    "use strict";
    ve();
    ie();
    B();
    ute = e => r("svg", {
        viewBox: "0 0 16 10",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: x("g", {
            fill: "none",
            fillRule: "evenodd",
            children: [r("path", {
                stroke: "#808080",
                opacity: .4,
                d: "M.5.5h15v9H.5z"
            }), r("path", {
                fill: "#000000",
                fillRule: "nonzero",
                d: "M0 0h16v1H0z"
            })]
        })
    }), hte = b.withComponent(ue(ute)
        `
      display: block;
    `), M8 = hte
});
var mte, fte, E8, F8 = k(() => {
    "use strict";
    ve();
    ie();
    B();
    mte = e => x("svg", {
        viewBox: "0 0 16 10",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("rect", {
            opacity: .4,
            x: .5,
            y: .5,
            width: 15,
            height: 9,
            stroke: "#808080"
        }), r("rect", {
            y: 9,
            width: 16,
            height: 1,
            fill: "#000000"
        })]
    }), fte = b.withComponent(ue(mte)
        `
      display: block;
    `), E8 = fte
});

function _S({
    color: e = "gray",
    ...t
}) {
    return r(b, {
        height: "2px",
        borderRadius: "2px",
        backgroundColor: e,
        ...t
    })
}
var D8 = k(() => {
    "use strict";
    ie();
    B()
});
var ls, A8, L8, z8 = k(() => {
    "use strict";
    ls = E(N());
    Uc();
    ie();
    Be();
    Hi();
    id();
    Bs();
    Ts();
    ut();
    qt();
    iy();
    Mt();
    Wt();
    ve();
    pi();
    B();
    A8 = (0, ls.memo)(({
        useCustomCursor: e,
        customCursorImage: t,
        customHoverCursorImage: o,
        saveProjectOptions: i
    }) => {
        let n = Fn(.76, ce.gray),
            s = () => {
                e || st("UseCustomCursor"), i({
                    useCustomCursor: !e
                })
            },
            [a, l] = (0, ls.useState)(t),
            [c, d] = (0, ls.useState)(!1),
            [p, h] = (0, ls.useState)(!1),
            [u, m] = (0, ls.useState)(!1),
            [f, g] = (0, ls.useState)(o),
            [y, S] = (0, ls.useState)(!1),
            [w, v] = (0, ls.useState)(!1),
            [C, I] = (0, ls.useState)(!1),
            T = async (M, F) => {
                if (u && m(!1), C && I(!1), M && M.size > de.UPLOAD_IMAGE_SIZE_LIMIT) {
                    window.alert(de.MSG_UPLOAD_IMAGE_SIZE_ERROR);
                    return
                }
                let R = F === "default" ? c : y,
                    A = F === "default" ? d : S,
                    D = F === "default" ? l : g;
                if (!R) {
                    A(!0);
                    try {
                        let O = await Bu("project-custom-cursor", M),
                            L = O.picture.type;
                        if (O.size && (O.size.height > (L === "svg" ? de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION : de.UPLOAD_CURSOR_IMAGE_DIMENSION) || O.size.width > (L === "svg" ? de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION : de.UPLOAD_CURSOR_IMAGE_DIMENSION))) {
                            A(!1), window.alert(`Maximum ${L==="svg"?de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION:de.UPLOAD_CURSOR_IMAGE_DIMENSION} pixels per side`);
                            return
                        }
                        if (L === "svg") {
                            let z = window.document.getElementById("tmp"),
                                V = await be.getSvgSizesByUrl(O.picture.url, z);
                            if (V && (V.bbox.height > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION || V.clientRect.width > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION || V.clientRect.height > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION || V.bbox.width > de.UPLOAD_CURSOR_SVG_IMAGE_DIMENSION)) {
                                A(!1), window.alert("Check svg size within browser, it should be less than 128 pixels");
                                return
                            }
                        }
                        let W = O.picture.lambdaUrl ? O.picture.lambdaUrl : O.picture.url;
                        if (W) {
                            let z = {
                                [F === "default" ? "customCursorImage" : "customHoverCursorImage"]: W
                            };
                            F === "default" ? (z.customCursorSize = O.size, z.customCursorIsLambda = !!O.picture.lambdaUrl && L !== "svg") : (z.customHoverCursorSize = O.size, z.customHoverCursorIsLambda = !!O.picture.lambdaUrl && L !== "svg"), i(z), D(W), De(Fe.SettingsViewer, {
                                settingsType: `custom cursor ${F==="default"?"default":"pointer"} set`
                            })
                        } else window.alert("loading image failed")
                    } catch (O) {
                        console.error(O)
                    } finally {
                        A(!1)
                    }
                }
            },
            P = (0, ls.useCallback)(M => {
                let F = {
                    [M === "default" ? "customCursorImage" : "customHoverCursorImage"]: void 0
                };
                M === "default" ? (F.customCursorSize = void 0, F.customCursorIsLambda = void 0) : (F.customHoverCursorSize = void 0, F.customHoverCursorIsLambda = void 0), i(F), (M === "default" ? l : g)(void 0)
            }, [i]);
        return x(Q, {
            children: [x(b, {
                width: "100%",
                height: 24,
                marginBottom: "1rm",
                display: "flex",
                justifyContent: "space-between",
                children: [r($, {
                    textStyle: "small",
                    lineHeight: "24px",
                    children: "Use custom cursor"
                }), r(Ve, {
                    backgroundChecked: "green",
                    checked: e,
                    onChange: s
                })]
            }), e && x(Q, {
                children: [x(b, {
                    width: "100%",
                    height: 40,
                    position: "relative",
                    paddingLeft: "4rm",
                    css: Z `
                & .extension-text {
                  opacity: 0;
                }
                &:hover {
                  & .extension-text {
                    opacity: 1;
                  }
                }
              `,
                    onDragEnter: () => {
                        a && !u && m(!0)
                    },
                    onDragLeaveCapture: () => {
                        a && u && m(!1)
                    },
                    children: [a ? r(vi, {
                        id: "project-cursor-reupload",
                        accept: "image/png, image/jpeg, image/svg+xml",
                        dropFile: !0,
                        readFileData: !1,
                        disabled: c,
                        onChange: M => T(M, "default"),
                        children: x(b, {
                            width: "100%",
                            height: "100%",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            css: Z `
                      & .delete-image-icon {
                        opacity: 0;
                      }
                      &:hover {
                        & .delete-image-button {
                          background-image: none;
                        }
                        & .delete-image-icon {
                          opacity: 1;
                        }
                      }
                    `,
                            children: [c ? r($, {
                                textStyle: "small",
                                color: "blue",
                                children: "Uploading..."
                            }) : r($, {
                                textStyle: "small",
                                color: "blue",
                                pointerEvents: u ? "none" : "auto",
                                children: u ? "Drop file here" : "Replace default"
                            }), c ? r(_o, {
                                size: 24,
                                color: "gray",
                                bgColor: "transparent"
                            }) : r(b, {
                                className: "delete-image-button",
                                width: 24,
                                height: 24,
                                display: u ? "none" : "flex",
                                justifyContent: "center",
                                alignItems: "center",
                                backgroundImage: a ? `url(${a})` : "none",
                                backgroundSize: "cover",
                                backgroundPosition: "center",
                                backgroundRepeat: "no-repeat",
                                cursor: "pointer",
                                onClick: M => {
                                    M.preventDefault(), P("default")
                                },
                                onMouseEnter: () => h(!0),
                                onMouseLeave: () => h(!1),
                                children: r(Nt, {
                                    className: "delete-image-icon",
                                    color: p ? "black" : "gray"
                                })
                            })]
                        })
                    }) : r(vi, {
                        id: "project-cursor-upload",
                        accept: "image/png, image/jpeg, image/svg+xml",
                        dropFile: !0,
                        readFileData: !1,
                        disabled: c,
                        onChange: M => T(M, "default"),
                        children: x(b, {
                            width: "100%",
                            height: "100%",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            css: Z `
                      & .text-on-hover {
                        display: none;
                      }
                      &:hover {
                        & .text-default {
                          display: none;
                        }
                        & .text-on-hover {
                          display: block;
                        }
                      }
                    `,
                            children: [c ? r($, {
                                textStyle: "small",
                                color: "blue",
                                children: "Uploading..."
                            }) : x(Q, {
                                children: [r($, {
                                    className: "text-default",
                                    textStyle: "small",
                                    color: "blue",
                                    children: "Choose default"
                                }), r($, {
                                    className: "text-on-hover",
                                    textStyle: "small",
                                    color: "blue",
                                    children: "PNG 2x / SVG 128px max"
                                })]
                            }), c && r(_o, {
                                size: 24,
                                color: "gray",
                                bgColor: "transparent"
                            })]
                        })
                    }), r(b, {
                        width: "100%",
                        height: "2px",
                        backgroundColor: n,
                        cursor: "default",
                        pointerEvents: u ? "none" : "auto"
                    })]
                }), x(b, {
                    width: "100%",
                    height: 40,
                    position: "relative",
                    paddingLeft: "4rm",
                    marginBottom: "12px",
                    css: Z `
                & .extension-text {
                  opacity: 0;
                }
                &:hover {
                  & .extension-text {
                    opacity: 1;
                  }
                }
              `,
                    onDragEnter: () => {
                        f && !C && I(!0)
                    },
                    onDragLeaveCapture: () => {
                        f && C && I(!1)
                    },
                    children: [f ? r(vi, {
                        id: "project-links-cursor-reupload",
                        accept: "image/png, image/jpeg, image/svg+xml",
                        dropFile: !0,
                        readFileData: !1,
                        disabled: y,
                        onChange: M => T(M, "links"),
                        children: x(b, {
                            width: "100%",
                            height: "100%",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            css: Z `
                      & .delete-image-icon {
                        opacity: 0;
                      }
                      &:hover {
                        & .delete-image-button {
                          background-image: none;
                        }
                        & .delete-image-icon {
                          opacity: 1;
                        }
                      }
                    `,
                            children: [y ? r($, {
                                textStyle: "small",
                                color: "blue",
                                children: "Uploading..."
                            }) : r($, {
                                textStyle: "small",
                                color: "blue",
                                pointerEvents: C ? "none" : "auto",
                                children: C ? "Drop file here" : "Replace pointer"
                            }), y ? r(_o, {
                                size: 24,
                                color: "gray",
                                bgColor: "transparent"
                            }) : r(b, {
                                className: "delete-image-button",
                                width: 24,
                                height: 24,
                                display: C ? "none" : "flex",
                                justifyContent: "center",
                                alignItems: "center",
                                backgroundImage: f ? `url(${f})` : "none",
                                backgroundSize: "cover",
                                backgroundPosition: "center",
                                backgroundRepeat: "no-repeat",
                                cursor: "pointer",
                                onClick: M => {
                                    M.preventDefault(), P("links")
                                },
                                onMouseEnter: () => v(!0),
                                onMouseLeave: () => v(!1),
                                children: r(Nt, {
                                    className: "delete-image-icon",
                                    color: w ? "black" : "gray"
                                })
                            })]
                        })
                    }) : r(vi, {
                        id: "project-links-cursor-upload",
                        accept: "image/png, image/jpeg, image/svg+xml",
                        dropFile: !0,
                        readFileData: !1,
                        disabled: y,
                        onChange: M => T(M, "links"),
                        children: x(b, {
                            width: "100%",
                            height: "100%",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            css: Z `
                      & .text-on-hover {
                        display: none;
                      }
                      &:hover {
                        & .text-default {
                          display: none;
                        }
                        & .text-on-hover {
                          display: block;
                        }
                      }
                    `,
                            children: [y ? r($, {
                                textStyle: "small",
                                color: "blue",
                                children: "Uploading..."
                            }) : x(Q, {
                                children: [r($, {
                                    className: "text-default",
                                    textStyle: "small",
                                    color: "blue",
                                    children: "Choose pointer"
                                }), r($, {
                                    className: "text-on-hover",
                                    textStyle: "small",
                                    color: "blue",
                                    children: "PNG 2x / SVG 128px max"
                                })]
                            }), y && r(_o, {
                                size: 24,
                                color: "gray",
                                bgColor: "transparent"
                            })]
                        })
                    }), r(b, {
                        width: "100%",
                        height: "2px",
                        backgroundColor: n,
                        cursor: "default",
                        pointerEvents: C ? "none" : "auto"
                    })]
                })]
            })]
        })
    });
    A8.displayName = "CursorSettings";
    L8 = A8
});

function gte({
    checked: e,
    onChange: t,
    ...o
}) {
    return x(b, {
        display: "flex",
        maxWidth: 216,
        height: 52,
        padding: 16,
        borderRadius: 52,
        alignItems: "center",
        backgroundColor: e ? "green" : "gray",
        cursor: "pointer",
        onClick: () => t(!e),
        ...o,
        children: [r(Vr, {
            as: "input",
            type: "checkbox",
            checked: e,
            onChange: () => t(!e)
        }), r($, {
            color: "white",
            textStyle: "small",
            userSelect: "none",
            children: "Stack all pages vertically"
        })]
    })
}
var $8, W8 = k(() => {
    "use strict";
    ie();
    Ch();
    Be();
    B();
    $8 = gte
});

function yte({
    direction: e,
    arrowsOn: t,
    slideIn: o,
    slideInRequiresArrows: i,
    arrowsDisabled: n,
    excludeSlideIn: s,
    onArrowsChange: a,
    onSlideInChange: l,
    variant: c,
    ...d
}) {
    let p = s || i && !t;
    return x(b, {
        display: "flex",
        height: 104,
        maxWidth: 216,
        position: "relative",
        alignItems: "center",
        justifyContent: "space-between",
        ...d,
        children: [r(Vr, {
            as: "input",
            type: "checkbox",
            checked: t,
            onChange: () => a(!t)
        }), r(Vr, {
            as: "input",
            type: "checkbox",
            checked: o,
            onChange: () => l(!o)
        }), x(b, {
            position: "absolute",
            width: c === "small" ? 104 : 110,
            height: 104,
            left: 0,
            right: 0,
            margin: "auto",
            backgroundColor: o ? "green" : "gray",
            cursor: p ? "auto" : "pointer",
            onClick: () => !p && l(!o),
            opacity: p ? 0 : o ? .7 : 1,
            children: [r(b, {
                position: "absolute",
                right: c === "small" ? -43 : -46,
                top: 0,
                bottom: 0,
                margin: "auto",
                width: 90,
                height: 90,
                borderRadius: 28,
                backgroundColor: "inherit",
                transform: "rotate(45deg)"
            }), r(b, {
                display: "flex",
                position: "absolute",
                left: 59,
                width: 104,
                height: 104,
                padding: 16,
                alignItems: "center",
                children: x($, {
                    color: "white",
                    textStyle: "small",
                    children: ["Slide-in", r("br", {}), "transition"]
                })
            })]
        }), x(b, {
            display: "flex",
            position: "relative",
            width: 104,
            height: 104,
            padding: 16,
            alignItems: "center",
            cursor: n ? "auto" : "pointer",
            onClick: h => {
                h.stopPropagation(), a(!t)
            },
            children: [r(b, {
                position: "absolute",
                left: c === "small" ? 7 : 8,
                width: 90,
                height: 90,
                borderRadius: 28,
                backgroundColor: n ? "lightGray" : void 0,
                transform: "rotate(45deg)",
                children: r(b, {
                    width: "100%",
                    height: "100%",
                    borderRadius: 28,
                    position: "absolute",
                    backgroundColor: t ? "green" : "gray",
                    opacity: n ? .5 : 1
                })
            }), r($, {
                position: "relative",
                color: "white",
                textStyle: "small",
                userSelect: "none",
                children: e === "vertical" ? x(Q, {
                    children: ["Scroll down", r("br", {}), "arrow"]
                }) : x(Q, {
                    children: ["Navigation", r("br", {}), "arrows"]
                })
            })]
        })]
    })
}
var O8, j8 = k(() => {
    "use strict";
    ie();
    Ch();
    Be();
    Ht();
    B();
    O8 = yte
});

function UJe({
    selectedViewport: e,
    exclude: t = [],
    disabled: o = [],
    setProjectOptions: i,
    options: n
}) {
    return (0, By.useEffect)(() => {
        e === "default" && st("SwitchToDesktop")
    }, [e]), x(b, {
        display: "flex",
        flexDirection: "column",
        gap: 20,
        children: [x(b, {
            display: "flex",
            flexDirection: "column",
            gap: "3rm",
            margin: "0 -8px",
            children: [r($8, {
                checked: n.viewertype === "vertical",
                onChange: s => {
                    i(s ? {
                        viewertype: "vertical"
                    } : {
                        viewertype: "horizontal"
                    }), De(Fe.SettingsPreviewViewer, {
                        action: "stack all pages vertically click"
                    })
                },
                borderRadius: "2rm"
            }), r(O8, {
                variant: "small",
                direction: n.viewertype,
                arrowsOn: n.arrows,
                slideIn: n.slidein,
                slideInRequiresArrows: n.viewertype === "horizontal",
                excludeSlideIn: t.includes("slidein"),
                arrowsDisabled: o.includes("arrows"),
                onArrowsChange: s => i({
                    arrows: s
                }),
                onSlideInChange: s => i({
                    slidein: s
                })
            })]
        }), x(b, {
            display: "flex",
            flexDirection: "column",
            gap: "1rm",
            children: [r(yc, {
                isVisible: !t.includes("menubutton"),
                children: r(pa, {
                    checked: n.menubutton,
                    onChange: s => {
                        i(s ? {
                            menubutton: s
                        } : {
                            menubutton: s,
                            projectinfo: !1
                        }), De(Fe.SettingsPreviewViewer, {
                            action: "project menu toggle on"
                        })
                    },
                    HelptipProps: {
                        href: "https://help.readymag.com/hc/en-us/articles/360020588752-Viewer-navigation",
                        text: n.controlsontop ? "Show the menu button in the top right corner of a page" : "Show the menu button in the bottom right corner of a page"
                    },
                    children: "Project menu"
                })
            }), r(yc, {
                isVisible: !t.includes("sharebutton"),
                children: r(pa, {
                    checked: n.sharebutton,
                    disabled: o.includes("sharebutton"),
                    onChange: s => i({
                        sharebutton: s
                    }),
                    HelptipProps: {
                        text: "Show the share button to the user"
                    },
                    children: "Share button"
                })
            }), r(yc, {
                isVisible: !t.includes("pagecounter"),
                children: r(pa, {
                    checked: n.pagecounter,
                    disabled: o.includes("pagecounter"),
                    onChange: s => i({
                        pagecounter: s
                    }),
                    HelptipProps: {
                        text: "Show a number of a current page to the user"
                    },
                    children: "Page counter"
                })
            }), r(yc, {
                isVisible: !t.includes("controlsontop"),
                children: r(pa, {
                    checked: n.controlsontop,
                    disabled: o.includes("controlsontop"),
                    onChange: s => i({
                        controlsontop: s
                    }),
                    HelptipProps: {
                        text: "Keep Project menu, Share button, and Page counter at the top of the screen"
                    },
                    children: "Buttons on top"
                })
            }), r(yc, {
                isVisible: !t.includes("branding"),
                children: r(pa, {
                    checked: o.includes("branding") || n.branding,
                    disabled: be.isSubscriptionPaused(),
                    onChange: s => {
                        o.includes("branding") ? Jo("branding") : i({
                            branding: s
                        })
                    },
                    HelptipProps: be.isSubscriptionPaused() ? {
                        text: "Unpause subscription to disable branding",
                        href: "/settings#change-plan"
                    } : void 0,
                    children: "Readymag branding"
                })
            })]
        }), x(b, {
            display: "flex",
            flexDirection: "column",
            gap: "1rm",
            children: [x(yc, {
                isVisible: !t.includes("useCustomCursor"),
                children: [r(b, {
                    position: "relative",
                    top: 20,
                    children: r(ao, {
                        targetSteps: ["UseCustomCursor"],
                        position: "left",
                        indent: 24,
                        children: r("div", {})
                    })
                }), r(b, {
                    position: "relative",
                    top: 56,
                    children: r(ao, {
                        targetSteps: ["PointerCursorUpload"],
                        position: "left",
                        indent: 24,
                        children: r("div", {})
                    })
                }), r(L8, {
                    useCustomCursor: !!n.useCustomCursor,
                    customCursorImage: n.customCursorImage,
                    customHoverCursorImage: n.customHoverCursorImage,
                    saveProjectOptions: i
                })]
            }), r(yc, {
                isVisible: !t.includes("lqip"),
                children: r(pa, {
                    marginBottom: "1rm",
                    checked: n.lqip,
                    disabled: o.includes("lqip"),
                    onChange: s => i({
                        lqip: s
                    }),
                    HelptipProps: {
                        text: "Use blurred image previews while loading",
                        href: "https://help.readymag.com/hc/en-us/articles/360019989052-Picture"
                    },
                    children: "Progressive images"
                })
            })]
        }), pt("viewer.nextSwitcher") && r(b, {
            display: "flex",
            flexDirection: "column",
            gap: "1rm",
            children: r(yc, {
                isVisible: pt("viewer.nextSwitcher") && !t ? .includes("viewerNext"),
                children: r(pa, {
                    marginBottom: "1rm",
                    checked: !!n.viewerNext,
                    multipleValues: n.viewerNext !== !1 && n.viewerNext !== !0,
                    onChange: s => i({
                        viewerNext: s
                    }),
                    children: "Viewer Next (beta)"
                })
            })
        })]
    })
}

function yc({
    isVisible: e = !0,
    children: t
}) {
    return r(Q, {
        children: e ? t : null
    })
}
var By, vte, pa, SS = k(() => {
    "use strict";
    By = E(N());
    ie();
    Be();
    Hi();
    Ht();
    qt();
    ry();
    z8();
    W8();
    j8();
    Wt();
    En();
    Xs();
    Fs();
    pi();
    B();
    vte = {
        width: 194,
        boxPosition: {
            marginLeft: "-125px"
        },
        arrowPosition: {
            left: "auto",
            right: 49
        }
    }, pa = ({
        checked: e,
        disabled: t,
        children: o,
        onChange: i,
        showSwitch: n = !0,
        HelptipProps: s,
        textColor: a = "green",
        switchColor: l = "green",
        multipleValues: c,
        ...d
    }) => {
        let [p, h] = (0, By.useState)(!1);
        return r(b, { ...d,
            onMouseEnter: () => h(!0),
            onMouseLeave: () => h(!1),
            children: x(b, {
                display: "flex",
                justifyContent: "space-between",
                alignItems: "center",
                children: [r($, {
                    flex: "1",
                    textStyle: "small",
                    color: e ? a : t ? void 0 : "black",
                    opacity: t || !e ? .4 : 1,
                    children: o
                }), s && r(Mu, { ...vte,
                    marginRight: "4px",
                    ...s,
                    opacity: p ? 1 : 0
                }), n ? r(Ve, {
                    backgroundChecked: l,
                    checked: e,
                    multipleValues: c,
                    disabled: t,
                    onChange: i
                }) : null]
            })
        })
    }
});
async function ZJe(e) {
    return Gt.get(`/api/single-column-options/${e}`)
}

function H8({
    id: e,
    mag: t,
    data: o
}) {
    return Gt.put(`/api/single-column-options/${t}/${e}`, o)
}
var N8 = k(() => {
    "use strict";
    Xd()
});
var wte, xte, My, eqe, tqe, _te, U8, CS = k(() => {
    "use strict";
    oo();
    Nc();
    N8();
    wte = Vd(H8, 500), xte = {
        _id: "none",
        topMargin: 20,
        rightMargin: 20,
        bottomMargin: 80,
        leftMargin: 20,
        verticalGap: 20,
        preserveGroups: !0,
        includeGlobal: !1,
        includeFixed: !1
    }, [My, eqe, tqe, _te] = er(xte), U8 = !1;
    _te(({
        _id: e,
        ...t
    }) => {
        U8 ? wte({
            data: t,
            id: e,
            mag: window.RM.constructorRouter.mag.get("num_id")
        }) : U8 = !0
    })
});

function Ste({ ...e
}) {
    let [t, o] = My(), [i, n] = (0, si.useState)(void 0), [s, a] = (0, si.useState)(!0), [l, c] = (0, si.useState)(!0), d = (0, si.useRef)(), p = (0, si.useRef)(), h = (P, M) => {
        let F = { ...t,
            [P]: M
        };
        o(F), d.current ? .stopTimer(), a(!0), P === "preserveGroups" && De(Fe.WidgetArrange, {
            action: M ? "desktop groups toggle on" : "desktop groups toggle off",
            editorArea: "arrange widgets"
        })
    }, {
        workspace: u,
        blocks: m
    } = (0, si.useContext)(xS), {
        started: f
    } = cp(), [g, y] = (0, si.useState)(!1);
    (0, si.useEffect)(() => {
        l || u ? .page.widgets.once("change", () => c(!0))
    }, [u, l]), (0, si.useEffect)(() => {
        s || u ? .page.widgets.once("change", () => a(!0))
    }, [u, s]), (0, si.useEffect)(() => {
        setTimeout(() => {
            y(!0)
        }, 10)
    }, []);
    let S = () => {
            u ? .restoreDesktopLayout(m, {
                resetAllKeys: !0,
                includeHidden: !0,
                includeFixed: !0,
                includeGlobal: !0,
                includeAboveAll: !0,
                includeAtomic: !0
            }), d.current ? .stopTimer(), p.current ? .startTimer(), c(!1), a(!0), De(Fe.WidgetArrange, {
                action: "desktop layout",
                editorArea: "arrange widgets"
            })
        },
        w = () => {
            u ? .singleColumnLayout(m, { ...t,
                includeHidden: !1,
                includeFixed: !1,
                includeGlobal: !1,
                includeAboveAll: !1,
                includeAtomic: !0
            }), n(G8(t)), p.current ? .stopTimer(), d.current ? .startTimer(), a(!1), c(!0), f && st(["ArrangeMobile", "PreviewAndPublish"]), De(Fe.WidgetArrange, {
                action: "single column",
                editorArea: "arrange widgets"
            })
        },
        v = () => {
            window.RM.constructorRouter.undo(), d.current ? .stopTimer()
        },
        C = () => {
            window.RM.constructorRouter.undo(), p.current ? .stopTimer()
        },
        I = !_.isEqual(G8(t), i),
        T = r(vc, {
            dirty: s || I,
            onClick: w,
            position: "relative",
            width: "206px",
            children: "Single column"
        });
    return x(oi, {
        "aria-label": "Autolayout panel",
        role: "grid",
        display: "flex",
        flexDirection: "column",
        gap: "16px",
        padding: "12px 8px 20px",
        ...e,
        children: [r(Y8, {
            onClick: C,
            controllerRef: p,
            position: "relative",
            width: "206px",
            children: r(V8, {
                content: wS,
                children: r(vc, {
                    dirty: l,
                    onClick: S,
                    position: "relative",
                    width: "206px",
                    children: "Desktop layout"
                })
            })
        }), r(_S, {
            opacity: "0.24",
            width: "auto",
            margin: "6px 8px 4px"
        }), x(oi, {
            role: "group",
            "aria-label": "single column options",
            gridTemplateColumns: "64px repeat(4, 16px)",
            gap: "16px",
            padding: "0 8px",
            children: [x(oi, {
                gap: "6px",
                children: [r(Iy, {
                    width: "64px"
                }), r(fe, {
                    min: 0,
                    max: 999,
                    autoWidth: !0,
                    value: t.verticalGap,
                    textStyle: "small",
                    color: "blue",
                    onChange: ({
                        value: P
                    }) => h("verticalGap", P)
                })]
            }), x(oi, {
                gap: "6px",
                children: [r(Py, {
                    width: "16px"
                }), r(fe, {
                    min: 0,
                    max: 999,
                    autoWidth: !0,
                    textStyle: "small",
                    color: "blue",
                    value: t.leftMargin,
                    onChange: ({
                        value: P
                    }) => h("leftMargin", P)
                })]
            }), x(oi, {
                gap: "6px",
                children: [r(M8, {
                    width: "16px"
                }), r(fe, {
                    min: 0,
                    max: 999,
                    autoWidth: !0,
                    value: t.topMargin,
                    textStyle: "small",
                    color: "blue",
                    onChange: ({
                        value: P
                    }) => h("topMargin", P)
                })]
            }), x(oi, {
                gap: "6px",
                children: [r(E8, {
                    width: "16px"
                }), r(fe, {
                    min: 0,
                    max: 999,
                    autoWidth: !0,
                    value: t.bottomMargin,
                    textStyle: "small",
                    color: "blue",
                    onChange: ({
                        value: P
                    }) => h("bottomMargin", P)
                })]
            }), x(oi, {
                gap: "6px",
                children: [r(Ty, {
                    width: "16px"
                }), r(fe, {
                    min: 0,
                    max: 999,
                    autoWidth: !0,
                    value: t.rightMargin,
                    textStyle: "small",
                    color: "blue",
                    onChange: ({
                        value: P
                    }) => h("rightMargin", P)
                })]
            })]
        }), r(oi, {
            role: "group",
            gap: "8px",
            padding: "0 8px",
            children: r(pa, {
                "aria-label": "Autolayout group toggle",
                checked: t.preserveGroups,
                onChange: P => h("preserveGroups", P),
                textColor: "black",
                switchColor: "blue",
                children: "Keep desktop groups"
            })
        }), r(Y8, {
            onClick: v,
            controllerRef: d,
            position: "relative",
            width: "206px",
            children: f && g ? r(b, {
                height: 48,
                children: r(ao, {
                    position: "right",
                    targetSteps: ["ArrangeMobile"],
                    indent: 16,
                    children: T
                })
            }) : r(V8, {
                content: vS,
                children: T
            })
        }), r(b, {
            color: "gray",
            textAlign: "center",
            children: x(Bo, {
                textStyle: "small",
                children: ["Not applied to", " ", r(b, {
                    as: "span",
                    display: "inline-flex",
                    verticalAlign: "-5px",
                    children: r(Cy, {
                        viewBox: "12 6 8 20",
                        width: "20",
                        height: "20"
                    })
                }), "Fixed"]
            })
        })]
    })
}

function Y8({
    seconds: e = 8,
    controllerRef: t,
    children: o,
    ...i
}) {
    let [n, s] = (0, si.useState)(null), a = (0, si.useRef)(null), l = (0, si.useRef)(null), c = (0, si.useCallback)(() => {
        a.current !== null && clearInterval(a.current), a.current = null, l.current = null
    }, []), d = (0, si.useCallback)(() => (c(), new Promise(u => {
        l.current = {
            resolve: u
        }, s(e), a.current = setInterval(() => {
            s(m => (m ? ? e) - 1)
        }, 1e3)
    })), [e, c]), p = (0, si.useCallback)(() => {
        l.current !== null && (l.current.resolve(), s(null), c())
    }, [c]);
    return (0, si.useEffect)(() => {
        n === 0 && p()
    }, [n, p]), (0, si.useEffect)(() => {
        t && (t.current = {
            startTimer: d,
            stopTimer: p
        })
    }, [d, p, t]), n === null ? r(Q, {
        children: o
    }) : x(vc, {
        dirty: !0,
        ...i,
        children: ["Undo", " ", x(b, {
            as: "span",
            opacity: .4,
            children: [n, " seconds"]
        })]
    })
}
var si, vc, V8, G8, Z8 = k(() => {
    "use strict";
    si = E(N());
    je();
    kh();
    zt();
    Zd();
    ir();
    ie();
    Be();
    ve();
    P8();
    T8();
    B8();
    gS();
    bS();
    yS();
    R8();
    F8();
    D8();
    SS();
    CS();
    fS();
    pi();
    Fs();
    qt();
    B();
    vc = ue(jl)
    `
  height: 48px;
  padding: 0 8px;
  background: ${e=>e.dirty?di(e.theme.colors.blue,.2):di(e.theme.colors.gray,.4)};
  color: ${e=>e.theme.colors.blue};
  border-radius: 8px;
  margin: 0 auto;
  transition: 0.1s ease;
  white-space: nowrap;
  &:hover {
    background: ${e=>e.theme.colors.blue};
    color: ${e=>e.theme.colors.white};
  }
`;
    vc.defaultProps = {
        textStyle: "small"
    };
    V8 = ({
        content: e,
        children: t
    }) => r(et, {
        text: "",
        placement: "right",
        indent: 24,
        enterDelay: 800,
        leaveDelay: 0,
        componentsProps: {
            motion: {
                transition: {
                    duration: 0
                }
            }
        },
        components: {
            Tooltip: e
        },
        children: t
    }), G8 = e => _.pick(e, ["topMargin", "rightMargin", "bottomMargin", "leftMargin", "verticalGap"])
});
var Pm, X8, K8 = k(() => {
    "use strict";
    Pm = E(N());
    nt();
    gn();
    Be();
    ie();
    $e();
    kh();
    zt();
    gS();
    bS();
    yS();
    Z8();
    SS();
    ae();
    CS();
    ve();
    qt();
    B();
    X8 = (0, Pm.forwardRef)(({
        style: e,
        blocks: t
    }, o) => {
        let [i, n] = My(), {
            model: s
        } = Ms();

        function a(m, f) {
            n({ ...i,
                [m]: f
            })
        }
        let l = () => {
                s.workspace ? .desktopLayoutFitMobile(t, {
                    includeHidden: !1,
                    includeFixed: !0,
                    includeGlobal: !1,
                    includeAboveAll: !1,
                    includeAtomic: !0
                }), De(Fe.WidgetArrange, {
                    action: "fit desktop to mobile",
                    editorArea: "arrange selected"
                })
            },
            c = () => {
                s.workspace ? .singleColumnLayout(t, { ...i,
                    includeHidden: !1,
                    includeFixed: !1,
                    includeGlobal: !1,
                    includeAboveAll: !1,
                    includeAtomic: !0
                }), De(Fe.WidgetArrange, {
                    action: "single column",
                    editorArea: "arrange selected"
                })
            },
            d = () => {
                s.workspace ? .restoreDesktopLayout(t, {
                    resetAllKeys: !0,
                    includeHidden: !1,
                    includeFixed: !0,
                    includeGlobal: !1,
                    includeAboveAll: !1,
                    includeAtomic: !0
                }), De(Fe.WidgetArrange, {
                    action: "desktop layout",
                    editorArea: "arrange selected"
                })
            },
            p = m => {
                a("preserveGroups", m), De(Fe.WidgetArrange, {
                    action: m ? "desktop groups toggle on" : "desktop groups toggle off",
                    editorArea: "arrange selected"
                })
            },
            h = (0, Pm.useMemo)(() => {
                let m = !!t.find(g => g.model.get("is_global")),
                    f = !!t.find(g => !g.model.get("is_global"));
                return m && f
            }, [t]),
            u = (0, Pm.useMemo)(() => {
                let m = "regular",
                    f = !1,
                    g = !1;
                for (let y of t) y.isFixed() ? f = !0 : g = !0;
                return f && g ? m = "separately" : f ? m = "fixed" : m = "regular", m
            }, [t]);
        return h ? r(Me, {
            isShowed: !0,
            style: e,
            ref: o,
            clean: !0,
            children: x(b, {
                background: di("#44444c", .95),
                borderRadius: 8,
                padding: "12px 20px 16px",
                textAlign: "center",
                children: [r(b, {
                    margin: "0 0 8px 0",
                    children: r(Bo, {
                        whiteSpace: "nowrap",
                        textStyle: "regular",
                        color: "white",
                        children: "Arrange selected"
                    })
                }), r(Bo, {
                    color: "white",
                    textStyle: "small",
                    children: "On all pages and Above pages widgets cannot be auto\u2011arranged"
                })]
            })
        }) : x(Me, {
            "aria-label": "Arrange panel",
            isShowed: !0,
            style: e,
            ref: o,
            children: [r(Ut, {
                leftSlot: r(Bo, {
                    whiteSpace: "nowrap",
                    textStyle: "regular",
                    children: "Arrange selected"
                }),
                showBorder: !1
            }), r(H, {
                showBorder: u !== "separately",
                children: r(oi, {
                    gap: "8px",
                    children: r(b, {
                        margin: "0 -8px",
                        children: r(vc, {
                            dirty: !0,
                            width: "100%",
                            onClick: d,
                            children: "Desktop composition"
                        })
                    })
                })
            }), u !== "separately" ? r(H, {
                showBorder: u === "regular",
                children: r(b, {
                    margin: "0 -8px",
                    children: r(vc, {
                        dirty: !0,
                        width: "100%",
                        onClick: l,
                        children: "Fit desktop to mobile"
                    })
                })
            }) : null, u === "regular" ? r(H, {
                showBorder: !1,
                children: x(oi, {
                    gap: "8px",
                    children: [x(oi, {
                        gridTemplateColumns: "16px 72px 16px",
                        gap: "16px",
                        children: [x(oi, {
                            gap: "6px",
                            children: [r(Py, {
                                width: "16px"
                            }), r(fe, {
                                min: 0,
                                max: 999,
                                autoWidth: !0,
                                color: "blue",
                                textStyle: "small",
                                value: i.leftMargin,
                                onChange: ({
                                    value: m
                                }) => a("leftMargin", m)
                            })]
                        }), x(oi, {
                            gap: "6px",
                            justifyItems: "center",
                            children: [r(Iy, {
                                width: "72px"
                            }), r(fe, {
                                min: 0,
                                max: 999,
                                autoWidth: !0,
                                color: "blue",
                                textStyle: "small",
                                value: i.verticalGap,
                                onChange: ({
                                    value: m
                                }) => a("verticalGap", m)
                            })]
                        }), x(oi, {
                            gap: "6px",
                            children: [r(Ty, {
                                width: "16px"
                            }), r(fe, {
                                min: 0,
                                max: 999,
                                autoWidth: !0,
                                color: "blue",
                                textStyle: "small",
                                value: i.rightMargin,
                                onChange: ({
                                    value: m
                                }) => a("rightMargin", m)
                            })]
                        })]
                    }), r(pa, {
                        textColor: "black",
                        switchColor: "blue",
                        margin: "0 -2px",
                        checked: i.preserveGroups,
                        onChange: p,
                        children: "Desktop groups"
                    }), r(b, {
                        margin: "0 -8px",
                        children: r(vc, {
                            dirty: !0,
                            width: "100%",
                            onClick: c,
                            children: "Single column"
                        })
                    })]
                })
            }) : null]
        })
    })
});

function Cte() {
    let {
        model: e
    } = Ms(), t = (0, J8.useCallback)(o => {
        o.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        offset: [0, 5],
        control: ({
            ref: o
        }) => r(ke, {
            ref: o,
            label: "Arrange",
            onClick: t,
            children: r(k8, {})
        }),
        panel: ({
            ref: o,
            style: i
        }) => e.selected ? r(X8, {
            ref: o,
            style: i,
            blocks: e.multipleSelectedBlocks
        }) : null
    })
}
var J8, q8, Q8 = k(() => {
    "use strict";
    J8 = E(N());
    ae();
    ht();
    I8();
    K8();
    B();
    q8 = Cte
});
var ez, tz = k(() => {
    "use strict";
    ae();
    Q8();
    ez = Ce.extend({
        name: "common_arrange",
        component: q8,
        rolePermission: "BaseWidgetCanChangeCoordinates",
        restrictions: e => e.viewport !== "default" && !e.getSelectedBlocks().every(t => t.model.get("is_global"))
    })
});

function oz() {
    return x("svg", {
        width: "25",
        height: "29",
        viewBox: "0 0 25 29",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M19.1142 5.95927C19.5798 5.56017 19.5798 4.83985 19.1142 4.44075L14.6508 0.614974C14.0021 0.0589688 13 0.519878 13 1.37423L13 9.02579C13 9.88014 14.0021 10.3411 14.6508 9.78505L19.1142 5.95927Z"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M14 5C14 4.44771 13.5523 4 13 4C5.8203 4 0 9.8203 0 17C0 17.5523 0.447715 18 1 18C1.55229 18 2 17.5523 2 17C2 10.9249 6.92487 6 13 6C13.5523 6 14 5.55228 14 5Z"
        }), r("path", {
            d: "M25 15C25 13.8954 24.1046 13 23 13H11C9.89543 13 9 13.8954 9 15V27C9 28.1046 9.89543 29 11 29H23C24.1046 29 25 28.1046 25 27V15Z"
        })]
    })
}

function iz() {
    return x("svg", {
        width: "30",
        height: "17",
        viewBox: "0 0 30 17",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            d: "M10.4382 1.45217C11.6193 -0.0241037 14 0.811006 14 2.70156V15C14 16.1046 13.1045 17 12 17H2.16122C0.484212 17 -0.448134 15.0601 0.599488 13.7506L10.4382 1.45217Z",
            fillOpacity: "0.4"
        }), r("path", {
            d: "M19.5617 1.45217C18.3807 -0.0241037 16 0.811006 16 2.70156V15C16 16.1046 16.8954 17 18 17H27.8387C29.5157 17 30.4481 15.0601 29.4005 13.7506L19.5617 1.45217Z"
        })]
    })
}

function nz() {
    return x("svg", {
        width: "17",
        height: "30",
        viewBox: "0 0 17 30",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            d: "M1.45219 10.4383C-0.0240809 11.6193 0.811029 14 2.70158 14H15C16.1046 14 17 13.1046 17 12L17 2.16125C17 0.484235 15.0602 -0.448111 13.7506 0.599511L1.45219 10.4383Z",
            fillOpacity: "0.4"
        }), r("path", {
            d: "M1.4522 19.5617C-0.0240806 18.3807 0.811029 16 2.70158 16H15C16.1046 16 17 16.8954 17 18V27.8387C17 29.5158 15.0602 30.4481 13.7506 29.4005L1.4522 19.5617Z"
        })]
    })
}

function rz() {
    return x("svg", {
        width: "25",
        height: "29",
        viewBox: "0 0 25 29",
        fill: "currentColor",
        xmlns: "http://www.w3.org/2000/svg",
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M5.8858 5.95927C5.42019 5.56017 5.42019 4.83985 5.8858 4.44075L10.3492 0.614974C10.9979 0.0589688 12 0.519878 12 1.37423V9.02579C12 9.88014 10.9979 10.3411 10.3492 9.78505L5.8858 5.95927Z"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M11 5C11 4.44771 11.4477 4 12 4C19.1797 4 25 9.8203 25 17C25 17.5523 24.5523 18 24 18C23.4477 18 23 17.5523 23 17C23 10.9249 18.0751 6 12 6C11.4477 6 11 5.55228 11 5Z"
        }), r("path", {
            d: "M0 15C0 13.8954 0.895431 13 2 13H14C15.1046 13 16 13.8954 16 15V27C16 28.1046 15.1046 29 14 29H2C0.895431 29 0 28.1046 0 27V15Z"
        })]
    })
}
var sz = k(() => {
    "use strict";
    B()
});

function az({
    isGroupSelected: e
}) {
    let {
        model: t
    } = (0, cs.useContext)(Y), {
        modelSave: o
    } = (0, cs.useContext)(ge), {
        callback: i
    } = Je(e ? t.groupSave : o, 400), n = (0, cs.useMemo)(() => e && t.multipleSelectedModels ? t.multipleSelectedModels.filter(y => y.attributes.type !== "hotspot") : [t.model], [e]), s = n[0], a = !e || e && n.every(y => (y.attributes.angle || 0) === (s.attributes.angle || 0)) ? s.attributes.angle || 0 : "mixed", l = !e || e && n.every(y => y.attributes.flip_v === s.attributes.flip_v) ? s.attributes.flip_v || !1 : "mixed", c = !e || e && n.every(y => y.attributes.flip_h === s.attributes.flip_h) ? s.attributes.flip_h || !1 : "mixed", d = (0, cs.useCallback)((y, S) => {
        let w = y,
            v = S.model,
            C = v.attributes.y;
        w = w >= 360 ? w - 360 : w, w = w <= -360 ? w + 360 : w;
        let I = t.workspace.spacesController;
        if (I) {
            let T = Math.abs(Math.cos(w / 180 * Math.PI)),
                P = Math.abs(Math.sin(w / 180 * Math.PI)),
                M = v.attributes.w * P + v.attributes.h * T,
                F = v.attributes.y - M / 2 + v.attributes.h / 2,
                R = I.getRestriction(v, [S]);
            R.top !== void 0 && (!R.canMoveTop || F < R.top) && (C += R.top - F)
        }
        v.set({
            angle: w,
            y: C
        })
    }, [t.workspace.spacesController]), p = (0, cs.useCallback)(({
        value: y
    }) => {
        e && t.multipleSelectedBlocks ? t.multipleSelectedBlocks.forEach(S => d(y, S)) : d(y, t.block), i()
    }, [e, t.block, t.multipleSelectedBlocks, d]), h = (0, cs.useCallback)((y, S) => {
        let w = (S.attributes.angle + 360) % 360,
            v = S.attributes.flip_v,
            C = S.attributes.flip_h,
            I = S.attributes.angle ? ? 0;
        w <= 45 || w >= 135 && w <= 225 || w >= 315 ? I = -I : (w > 45 && w < 135 || w > 225 && w < 315) && (I = 180 - I), y === "vertical" ? v = !S.attributes.flip_v : C = !S.attributes.flip_h, S.set({
            angle: I,
            flip_v: v,
            flip_h: C
        })
    }, []), u = (0, cs.useCallback)(y => {
        e && t.multipleSelectedBlocks ? t.multipleSelectedBlocks.forEach(S => h(y, S.model)) : h(y, t.block.model), i()
    }, [e, t.block, t.multipleSelectedBlocks]), m = (0, cs.useCallback)(y => {
        y && (e && t.multipleSelectedBlocks ? t.multipleSelectedBlocks.forEach(S => d((S.model.attributes.angle || 0) + y, S)) : d((t.block.model.attributes.angle || 0) + y, t.block), i())
    }, [e, t.multipleSelectedBlocks, t.block, d]), f = (0, cs.useCallback)(() => {
        m(90)
    }, [m]), g = (0, cs.useCallback)(() => {
        m(-90)
    }, [m]);
    return r(H, {
        showBorder: !1,
        children: x(b, {
            display: "flex",
            flexDirection: "column",
            gap: 16,
            children: [r(b, {
                display: "flex",
                alignItems: "center",
                justifyContent: "center",
                children: x(b, {
                    position: "relative",
                    children: [r(fe, {
                        autoFocus: a !== "mixed",
                        autoWidth: !0,
                        max: 360,
                        min: -360,
                        fontSize: 40,
                        value: a === "mixed" ? 0 : a,
                        isMixedValue: a === "mixed",
                        textStyle: a === "mixed" ? "small" : "subheading",
                        onChange: p
                    }), r(b, {
                        fontSize: 16,
                        as: "span",
                        color: "gray",
                        position: "absolute",
                        right: -8,
                        top: 8,
                        children: "\xB0"
                    })]
                })
            }), x(b, {
                display: "flex",
                role: "listbox",
                justifyContent: "space-between",
                alignItems: "baseline",
                children: [r(K, {
                    variant: "clean",
                    color: "darkGray",
                    height: 40,
                    onClick: f,
                    children: r(oz, {})
                }), r(K, {
                    variant: "clean",
                    "aria-checked": c && c !== "mixed",
                    onClick: () => u("horizontal"),
                    color: c && c !== "mixed" ? "blue" : "darkGray",
                    children: r(iz, {})
                }), r(K, {
                    variant: "clean",
                    "aria-checked": l && l !== "mixed",
                    alignSelf: "flex-end",
                    onClick: () => u("vertical"),
                    color: l && l !== "mixed" ? "blue" : "darkGray",
                    children: r(nz, {})
                }), r(K, {
                    variant: "clean",
                    color: "darkGray",
                    height: 40,
                    onClick: g,
                    children: r(rz, {})
                })]
            })]
        })
    })
}
var cs, lz = k(() => {
    "use strict";
    cs = E(N());
    qo();
    ie();
    zt();
    $e();
    je();
    Le();
    sz();
    ae();
    B()
});

function kte() {
    let {
        model: e
    } = (0, Ou.useContext)(Y), t = (0, Ou.useMemo)(() => !!e.multipleSelectedModels, [e.multipleSelectedModels]), o = (0, Ou.useCallback)(i => {
        i.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: i
        }) => r(ke, {
            isActive: e.selected,
            ref: i,
            label: "Rotate",
            onClick: o,
            children: r(kf, {})
        }),
        panel: ({
            ref: i,
            style: n
        }) => e.selected ? x(Me, {
            isShowed: !0,
            style: n,
            ref: i,
            children: [r(Ut, {
                leftSlot: "Rotate",
                showBorder: !1
            }), r(az, {
                isGroupSelected: t
            })]
        }) : null
    })
}
var Ou, cz, dz = k(() => {
    "use strict";
    Ou = E(N());
    nt();
    gn();
    P0();
    ae();
    ht();
    lz();
    B();
    cz = kte
});
var pz, uz = k(() => {
    "use strict";
    ae();
    dz();
    pz = Ce.extend({
        name: "common_rotation",
        component: cz,
        rolePermission: "BaseWidgetCanRotate",
        restrictions: e => {
            let t = e.getSelectedBlocks();
            return t.length && !t[0].isFullWidth() && !t[0].isFullHeight()
        },
        saveOnDeselect: !1
    })
});

function mz(e) {
    return r("svg", {
        width: "24",
        height: "24",
        viewBox: "0 0 24 24",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M14.6915 3.40145L18.743 7.27744C18.7537 7.28765 18.7641 7.29808 18.7743 7.30875C19.1561 7.70782 19.1421 8.34083 18.743 8.72261L14.6915 12.5986C14.5054 12.7767 14.2578 12.876 14.0002 12.876C13.448 12.876 13.0002 12.4283 13.0002 11.876L13.0002 9L0.999996 9C0.447711 9 -4.06236e-06 8.55228 -4.06236e-06 8C-4.06236e-06 7.44771 0.447711 7 0.999996 7L13.0002 7V4.12404C13.0002 3.86648 13.0996 3.61886 13.2777 3.43275C13.6594 3.03368 14.2925 3.01967 14.6915 3.40145ZM9.36047 11.4015L5.30896 15.2774C5.2983 15.2876 5.28786 15.2981 5.27766 15.3087C4.89587 15.7078 4.90989 16.3408 5.30896 16.7226L9.36047 20.5986C9.54658 20.7767 9.7942 20.876 10.0518 20.876C10.604 20.876 11.0518 20.4283 11.0518 19.876V17L23 17C23.5523 17 24 16.5523 24 16C24 15.4477 23.5523 15 23 15L11.0518 15V12.124C11.0518 11.8665 10.9524 11.6189 10.7743 11.4328C10.3926 11.0337 9.75954 11.0197 9.36047 11.4015Z",
            fill: "currentColor"
        })
    })
}

function fz(e) {
    return x("svg", {
        width: "24",
        height: "24",
        viewBox: "0 0 24 24",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M18.743 7.27658L14.6915 3.40059C14.2925 3.0188 13.6594 3.03282 13.2777 3.43189C13.0996 3.61799 13.0002 3.86562 13.0002 4.12317V11.8752C13.0002 12.4275 13.448 12.8752 14.0002 12.8752C14.2578 12.8752 14.5054 12.7758 14.6915 12.5978L18.743 8.72175C19.1421 8.33996 19.1561 7.70695 18.7743 7.30788C18.7641 7.29722 18.7537 7.28678 18.743 7.27658Z",
            fill: "currentColor"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M5.30896 15.2766L9.36048 11.4006C9.75955 11.0188 10.3926 11.0328 10.7743 11.4319C10.9524 11.618 11.0518 11.8656 11.0518 12.1232V19.8752C11.0518 20.4275 10.604 20.8752 10.0518 20.8752C9.7942 20.8752 9.54658 20.7758 9.36048 20.5978L5.30896 16.7217C4.90989 16.34 4.89588 15.707 5.27766 15.3079C5.28786 15.2972 5.2983 15.2868 5.30896 15.2766Z",
            fill: "currentColor"
        }), r("path", {
            d: "M23 16H10",
            stroke: "currentColor",
            strokeWidth: "2",
            strokeLinecap: "round"
        }), r("path", {
            d: "M1 7.99999L14 8",
            stroke: "currentColor",
            strokeWidth: "2",
            strokeLinecap: "round"
        })]
    })
}

function ju(e) {
    return x("svg", {
        width: "24",
        height: "24",
        viewBox: "0 0 24 24",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M-0.000122582 12C-0.000122582 9.23859 2.23845 7.00002 4.99988 7.00002H11.9999C12.5522 7.00002 12.9999 7.44773 12.9999 8.00002C12.9999 8.5523 12.5522 9.00002 11.9999 9.00002H4.99988C3.34302 9.00002 1.99988 10.3432 1.99988 12C1.99988 13.6569 3.34302 15 4.99988 15H18.9999C20.6567 15 21.9999 13.6569 21.9999 12C21.9999 10.3432 20.6567 9.00002 18.9999 9.00002C18.4476 9.00002 17.9999 8.5523 17.9999 8.00002C17.9999 7.44773 18.4476 7.00002 18.9999 7.00002C21.7613 7.00002 23.9999 9.23859 23.9999 12C23.9999 14.7614 21.7613 17 18.9999 17H4.99988C2.23845 17 -0.000122582 14.7614 -0.000122582 12Z",
            fill: "currentColor"
        }), r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M16.7429 7.27743L12.6914 3.40144C12.2923 3.01966 11.6593 3.03367 11.2775 3.43274C11.0995 3.61885 11.0001 3.86647 11.0001 4.12403L11.0001 11.876C11.0001 12.4283 11.4478 12.876 12.0001 12.876C12.2577 12.876 12.5053 12.7767 12.6914 12.5986L16.7429 8.7226C17.142 8.34082 17.156 7.70781 16.7742 7.30874C16.764 7.29807 16.7536 7.28764 16.7429 7.27743Z",
            fill: "currentColor"
        })]
    })
}

function gz(e) {
    let t = (0, hz.useRef)(null),
        {
            rect: {
                height: o
            }
        } = m1(t);
    return x("svg", {
        ref: t,
        width: "24",
        height: "100%",
        fill: "none",
        viewBox: `0 0 24 ${o}`,
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M16.7429 4.27743L12.6914 0.40144C12.2923 0.0196553 11.6593 0.0336704 11.2775 0.432743C11.0995 0.618848 11.0001 0.866471 11.0001 1.12402V4.00003H4.99988C2.23845 4.00003 -0.00012207 6.23861 -0.00012207 9.00003H1.99988C1.99988 7.34318 3.34302 6.00003 4.99988 6.00003H11.0001V8.87602C11.0001 9.42831 11.4478 9.87602 12.0001 9.87602C12.2577 9.87602 12.5053 9.77665 12.6914 9.59861L16.7429 5.7226C17.142 5.34082 17.156 4.70781 16.7742 4.30874C16.764 4.29807 16.7536 4.28764 16.7429 4.27743ZM21.9999 9.00003C21.9999 7.34318 20.6567 6.00003 18.9999 6.00003C18.4476 6.00003 17.9999 5.55231 17.9999 5.00003C17.9999 4.44775 18.4476 4.00003 18.9999 4.00003C21.7613 4.00003 23.9999 6.23861 23.9999 9.00003H21.9999Z",
            fill: "currentColor"
        }), r("path", {
            d: "M2.99988 0.875992C1.99988 2.53285 3.34302 3.87599 4.99988 3.87599H18.9999C20.6567 3.87599 21.9999 2.53285 21.9999 0.875992H23.9999C23.9999 3.63742 21.7613 5.87599 18.9999 5.87599H4.99988C2.23845 5.87599 -0.00012207 3.63742 -0.00012207 0.875992H1.99988Z",
            fill: "currentColor",
            transform: `translate(0, ${o-16})`
        })]
    })
}

function bz(e) {
    return x("svg", {
        width: "20",
        height: "18",
        viewBox: "0 0 20 18",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: [r("circle", {
            opacity: "0.2",
            cx: "4",
            cy: "14",
            r: "4",
            fill: "white",
            fillOpacity: "0.96"
        }), r("circle", {
            opacity: "0.4",
            cx: "7",
            cy: "9",
            r: "4",
            fill: "white",
            fillOpacity: "0.96"
        }), r("circle", {
            opacity: "0.6",
            cx: "10",
            cy: "4",
            r: "4",
            fill: "white",
            fillOpacity: "0.96"
        }), r("circle", {
            opacity: "0.8",
            cx: "13",
            cy: "9",
            r: "4",
            fill: "white",
            fillOpacity: "0.96"
        }), r("circle", {
            cx: "16",
            cy: "14",
            r: "4",
            fill: "white",
            fillOpacity: "0.96"
        })]
    })
}
var hz, Tm = k(() => {
    "use strict";
    hz = E(N());
    $H();
    B()
});
var wc = k(() => {
    "use strict"
});
var Hu, Ry, xc, yz = k(() => {
    "use strict";
    Hu = E(Ze()), Ry = E(ze()), xc = function() {
        this.popups = {}, this.openedPopup = "", Ry.default.bindAll(this), this.closeAllPopups.__debounced = Ry.default.debounce(this.closeAllPopups, 50)
    };
    xc.prototype.addPopup = function(e) {
        e.onClick = Ry.default.bind(function(t) {
            t && (0, Hu.default)(t.target).closest(e.popupSelector).length > 0 || (t.stopPropagation(), this.onClick(e.name, t.currentTarget))
        }, this), e.$parent.on("click", e.selector, e.onClick), e.$parent.on("click", this.closeAllPopups.__debounced), this.popups[e.name] = e
    };
    xc.prototype.onClick = function(e, t) {
        this.openedPopup === e ? this.closePopup(e) : this.openPopup(e, t)
    };
    xc.prototype.closePopup = function(e) {
        this.openedPopup === e && this.popups[e] && (this.openedPopup = "", (0, Hu.default)(this.popups[e].selector, this.popups[e].$parent).removeClass("opened"), this.popups[e].cbClose && this.popups[e].cbClose())
    };
    xc.prototype.openPopup = function(e, t) {
        this.openedPopup !== e && this.popups[e] && (this.openedPopup && this.closePopup(this.openedPopup), this.openedPopup = e, (0, Hu.default)(t).addClass("opened"), this.popups[e].cbOpen && this.popups[e].cbOpen((0, Hu.default)(t)))
    };
    xc.prototype.closeAllPopups = function(e) {
        return this.openedPopup ? e && (0, Hu.default)(e.target).closest(this.popups[this.openedPopup].selector).length > 0 ? !1 : (this.closePopup(this.openedPopup), !0) : !0
    };
    xc.prototype.destroy = function() {
        for (let e in this.popups) this.popups[e].$parent.off("click", this.popups[e].selector, this.popups[e].onClick), this.popups[e].$parent.off("click", this.closeAllPopups.__debounced);
        delete this.popups
    }
});
var vz, wz = k(() => {
    "use strict";
    no();
    vz = {
        "template-constructor-helpers-animation_steps_add_button": Ae `

	<div class="add-button skip-rotate js-add-step" title="Add Step">
		<div class="rhomb"></div>

		<div class="effect-popup js-add-step-popup">
			<div class="effect-popup-caption">Add Step</div>
			<div class="effect-popup-item" data-value="use_move">Move</div>
			<div class="effect-popup-item" data-value="use_opacity">Opacity</div>
			<div class="effect-popup-item" data-value="use_rotate">Rotate</div>
			<div class="effect-popup-item" data-value="use_scale">Scale</div>
			<div class="corner-wrapper"><div class="corner"></div></div>
		</div>
	</div>

`
    }
});

function Ite(e, t) {
    let o = rt(e);
    return o[0].x += t.x, o[0].y += t.y, o[1].x += t.x, o[1].y += t.y, o
}

function Pte({
    workspace: e,
    isFixed: t,
    ...o
}) {
    return new PS(new IS(e, t), o)
}
var kS, IS, PS, Tte, xz, _z = k(() => {
    "use strict";
    kS = E(Ze());
    oo();
    Wo();
    c0();
    IS = class {
        constructor(t, o) {
            this.workspace = t;
            _e(this, "zoneClassName", "bezier-curve-editor");
            _e(this, "zone");
            _e(this, "path");
            _e(this, "point1");
            _e(this, "line1");
            _e(this, "point2");
            _e(this, "line2");
            _e(this, "prevScreenX", 0);
            _e(this, "prevScreenY", 0);
            this.path = document.createElementNS("http://www.w3.org/2000/svg", "path"), this.point1 = document.createElementNS("http://www.w3.org/2000/svg", "line"), this.line1 = document.createElementNS("http://www.w3.org/2000/svg", "line"), this.point2 = document.createElementNS("http://www.w3.org/2000/svg", "line"), this.line2 = document.createElementNS("http://www.w3.org/2000/svg", "line"), [this.point1, this.point2].forEach(i => {
                i.classList.add("point")
            }), this.zone = this.createSVGZone(o), [this.path, this.line1, this.line2, this.point1, this.point2].forEach(i => {
                this.zone.appendChild(i)
            }), t.$el.append(this.zone)
        }
        createSVGZone(t) {
            let o = document.querySelector(`.${this.zoneClassName}`);
            if (o && o.remove(), o = document.createElementNS("http://www.w3.org/2000/svg", "svg"), o.classList.add(this.zoneClassName), t) o.style.setProperty("position", "fixed"), o.style.setProperty("margin", "initial");
            else {
                let i = this.workspace.viewport;
                o.style.setProperty("width", `${Oe.dictionary[i].width}px`)
            }
            return o
        }
        update(t, o) {
            let i = this.path;
            i.setAttribute("d", "");
            for (let l of t) {
                let {
                    startPoint: c,
                    endPoint: d,
                    controlPoints: p
                } = l, h = i.getAttribute("d") || "", u = vh.getBezierPath(c, p[0], p[1], d);
                i.setAttribute("d", `${h} ${u}`)
            }
            let n = t[o.selectedStepIndex],
                [s, a] = n.controlPoints;
            this.toggleVisiblePointsState(o.useBezier), this.updateControlPoint(this.point1, this.line1, s, n.startPoint), this.updateControlPoint(this.point2, this.line2, a, n.endPoint)
        }
        onMovePoints(t) {
            function o(i, n) {
                let {
                    screenX: s = 0,
                    screenY: a = 0
                } = n, l = (s - (this.prevScreenX || s)) / window.RM.constructorRouter.zoom.getZoom(), c = (a - (this.prevScreenY || a)) / window.RM.constructorRouter.zoom.getZoom();
                t(i, {
                    movementX: l,
                    movementY: c
                }), this.prevScreenX = s, this.prevScreenY = a
            }(0, kS.default)(this.point1).on("drag", o.bind(this, "c1")).on("dragend", () => {
                this.prevScreenX = 0, this.prevScreenY = 0
            }), (0, kS.default)(this.point2).on("drag", o.bind(this, "c2")).on("dragend", () => {
                this.prevScreenX = 0, this.prevScreenY = 0
            })
        }
        destroy() {
            this.zone.remove()
        }
        updateControlPoint(t, o, i, n) {
            t.setAttribute("x1", i.x.toString()), t.setAttribute("y1", i.y.toString()), t.setAttribute("x2", i.x.toString()), t.setAttribute("y2", i.y.toString()), o.setAttribute("x1", n.x.toString()), o.setAttribute("y1", n.y.toString()), o.setAttribute("x2", i.x.toString()), o.setAttribute("y2", i.y.toString())
        }
        toggleVisiblePointsState(t) {
            [this.point1, this.point2].forEach(o => {
                t ? o.setAttributeNS(null, "display", "block") : o.setAttributeNS(null, "display", "none")
            })
        }
    }, PS = class {
        constructor(t, {
            blockDimensions: o,
            startCenterPosition: i,
            animation: n,
            onChange: s
        }) {
            _e(this, "startCenterPosition");
            _e(this, "blockDimensions");
            _e(this, "animation");
            _e(this, "ui");
            this.startCenterPosition = i, this.blockDimensions = o, this.animation = n, this.ui = t, this.ui.onMovePoints((a, l) => {
                let c = this.animation.selected ? ? 0,
                    d = { ...this.animation.steps[c].curve ? .[a]
                    };
                d && (d.x += l.movementX, d.y += l.movementY), s(c, a, d)
            }), this.update()
        }
        preparePath() {
            let t = 0,
                o = 0;
            return this.animation.steps.map(n => {
                let s = this.blockDimensions.w / 2 + t,
                    a = this.blockDimensions.h / 2 + o,
                    l = this.blockDimensions.w / 2 + (n.dx ? ? 0),
                    c = this.blockDimensions.h / 2 + (n.dy ? ? 0);
                return t = n.dx ? ? 0, o = n.dy ? ? 0, {
                    x1: s,
                    y1: a,
                    x2: l,
                    y2: c,
                    curve: [n.curve.c1, n.curve.c2]
                }
            }).map(n => {
                let s = {
                        x: this.startCenterPosition.x + n.x1,
                        y: this.startCenterPosition.y + n.y1
                    },
                    a = {
                        x: this.startCenterPosition.x + n.x2,
                        y: this.startCenterPosition.y + n.y2
                    };
                return {
                    startPoint: s,
                    endPoint: a,
                    controlPoints: Ite(n.curve, {
                        x: this.startCenterPosition.x + this.blockDimensions.w / 2,
                        y: this.startCenterPosition.y + this.blockDimensions.h / 2
                    })
                }
            })
        }
        update(t = {}) {
            t.animation && (this.animation = t.animation), t.blockDimensions && (this.blockDimensions = t.blockDimensions), t.startCenterPosition && (this.startCenterPosition = t.startCenterPosition);
            let o = this.animation.selected ? ? 0,
                i = this.animation.steps[o];
            this.ui.update(this.preparePath(), {
                selectedStepIndex: o,
                useBezier: i.use_bezier ? ? !1
            })
        }
        destroy() {
            this.ui.destroy()
        }
    };
    Tte = {
        createBezierCurveEditor: Pte
    }, xz = Tte
});
var TS, hr, yo, Sz, Bte, Cz, kz = k(() => {
    "use strict";
    TS = E(To()), hr = E(Ze()), yo = E(ze());
    wz();
    wa();
    Wt();
    Ro();
    On();
    _z();
    oo();
    Zr();
    Sz = me.extend({
        controls: [],
        initialize: function(e) {
            yo.default.extend(this, e), this.uuid = e.uuid, this.isStandalone = !0, this.proportional = !0, this.resizeFromCenter = !0, this.addButtonTemplate = vz["template-constructor-helpers-animation_steps_add_button"], this.frameClass = $t.extend({
                minwidth: 0,
                minheight: 0
            }), this.initBlock(this.model, this.workspace)
        },
        render: function() {
            this.create(), this.$el.addClass("animation-step"), this.$mainContent = this.$(".content"), this.$addButton = (0, hr.default)(this.addButtonTemplate()), this.$addButton.find('.effect-popup-item[data-value="use_rotate"]').toggle(!this.hideRotateEffect), this.$addButton.on("click", ".effect-popup-item", this.addStepWithEffectClick), this.$el.append(this.$addButton), this.$mainContent.addClass("main-content")
        },
        addStepWithEffectClick: function(e) {
            e.currentTarget instanceof HTMLElement && this.trigger("add-step", (0, hr.default)(e.currentTarget).attr("data-value")), e.stopPropagation()
        },
        select: function(e, t) {
            me.prototype.select.apply(this, [e, t]), this.updateAddButtonPos()
        },
        setContent: function(e) {
            this.$innerContent = e, this.$innerContent.addClass("fantoms"), this.$mainContent.html(this.$innerContent), this.redrawOpacity(), this.redrawScale()
        },
        show: function() {
            this.$el.show()
        },
        hide: function() {
            this.$el.hide()
        },
        onClick: function() {
            this.selected || this.select()
        },
        flashTransitions: function() {
            clearTimeout(this.flashTransitionsTimeout), this.$el.addClass("animation-transitions"), this.flashTransitionsTimeout = setTimeout(yo.default.bind(function() {
                this.$el.removeClass("animation-transitions")
            }, this), 200)
        },
        redrawOpacity: function() {
            this.$innerContent && this.$innerContent.css({
                opacity: this.model.get("opacity") / 100
            })
        },
        redrawScale: function() {
            this.$innerContent && be.applyTransform(this.$innerContent, this.model.get("scale") === 100 ? "" : "scale(" + this.model.get("scale") / 100 + ")")
        },
        updateAddButtonPos: function() {
            if (!this.selected || !this.$addButton) return;
            let e = this.zoomView.getZoom(),
                t = yo.default.extend({}, this.latestPosSizeAngle, {
                    width: this.latestPosSizeAngle.width * e,
                    height: this.latestPosSizeAngle.height * e
                }),
                o = t.height + 18,
                i = t.width / 2,
                n = t.height / 2,
                s = n - o,
                a = i + t.sinAngle * s;
            o = n - t.cosAngle * s, this.$addButton.css({
                left: Math.round(a),
                top: Math.round(o),
                zoom: 1 / e
            }), be.applyTransform(this.$addButton, "");
            let l = this.$addButton.offset(),
                c = 30,
                d = l.top + c / 2,
                p = l.left + c / 2,
                h = 0,
                u = 0,
                m = (0, hr.default)(window).height(),
                f = (0, hr.default)(window).width(),
                g = 32;
            d < g ? h = d - g : d > m - g && (h = d - (m - g)), p < g ? u = p - g : p > f - g && (u = p - (f - g)), (h || u) && be.applyTransform(this.$addButton, "translate(" + Math.round(-u) + "px, " + Math.round(-h) + "px)")
        },
        updateAddButtonPopupPos: function() {
            if (!this.$addButton || !this.selected) return;
            let e = this.$addButton.offset(),
                t = 15,
                o = 30,
                i = e.top + o / 2,
                n = e.left + o / 2,
                s = (0, hr.default)(window).height(),
                a = (0, hr.default)(window).width(),
                l = this.$addButton.find(".effect-popup"),
                c = l.height(),
                d = l.width(),
                p = 12;
            l.css("margin-top", "").find(".corner-wrapper").css("margin-top", ""), n > p + d / 2 && n < a - d / 2 ? i > p + c + o / 2 + t ? l.attr("data-pos", "top") : l.attr("data-pos", "bottom") : (n < a / 2 ? l.attr("data-pos", "right") : l.attr("data-pos", "left"), i < c / 2 + p && l.css("margin-top", c / 2 + p - i).find(".corner-wrapper").css("margin-top", -(c / 2 + p - i)), i > s - (c / 2 + p) && l.css("margin-top", -(i - s + c / 2 + p)).find(".corner-wrapper").css("margin-top", i - s + c / 2 + p))
        },
        css: function(e) {
            me.prototype.css.apply(this, [e]), this.updateAddButtonPos()
        },
        redraw: function(e, t) {
            this.$mainContent && (this.redrawOpacity(), this.redrawScale(), me.prototype.redraw.apply(this, [e, t]))
        }
    }), Bte = TS.default.View.extend({
        className: "animation-steps-container",
        StepModel: TS.default.Model.extend({ ...N1,
            getViewport: function() {
                return this.blocks && this.blocks.length && this.blocks[0].model.getViewport()
            },
            getAnimations() {
                return []
            }
        }),
        initialize: function(e) {
            if (yo.default.bindAll(this), yo.default.extend(this, e), this.someModel = this.blocks[0].model, this.workspace.switchOnAnimationMode(this), this.$el.appendTo(this.workspace.$origin), this.$workspaceScroll = this.workspace.$scroller, (0, hr.default)(this.$el).drag("start", function(t) {
                    t.stopPropagation()
                }), this.$stepsLinesWrapper = (0, hr.default)('<div class="steps-lines-wrapper">'), this.$el.append(this.$stepsLinesWrapper), this.$previewAnimator = (0, hr.default)('<div class="preview-animator">'), this.$el.append(this.$previewAnimator), this.popupManager && this.popupManager.addPopup({
                    $parent: this.$el,
                    name: "add-step-selector",
                    selector: ".block .add-button",
                    popupSelector: ".block .add-button .effect-popup",
                    cbOpen: function(t) {
                        this.currentStep && this.currentStep.updateAddButtonPopupPos(), yo.default.each(this.blocks, function(o) {
                            o.trigger("animation:stepsPopup:open", t)
                        })
                    }.bind(this),
                    cbClose: function() {
                        yo.default.each(this.blocks, function(t) {
                            t.trigger("animation:stepsPopup:closed")
                        })
                    }.bind(this)
                }), this.updateContainerDims(), this.static || (this.bezierEditor = xz.createBezierCurveEditor({ ...this.getBezierCurveEditorParams(),
                    isFixed: !!this.someModel.get("fixed_position"),
                    onChange: (t, o, i) => {
                        this.handleUpdateBezier({
                            step: t,
                            pointName: o,
                            point: i
                        })
                    }
                })), this.updateFantoms(), this.updateSteps(), yo.default.each(this.blocks, function(t) {
                    t.toggleAnimationMode(!0)
                }), this.$previewAnimator.css({
                    visibility: "hidden"
                }), this.isPreviewMode = !1, (0, hr.default)(window).on("resize", this.onResize), this.$workspaceScroll.on("scroll", this.onWorkspaceScroll), this.updateIndexes) {
                let t = this.blocks[0],
                    o = parseInt(this.$el.css("z-index"), 10),
                    i = yo.default.max(yo.default.map(this.blocks, function(n) {
                        return n.model.attributes.z
                    }));
                yo.default.each(t.getTriggerBlocks(), function(n, s) {
                    let a = n.$el.css("z-index"),
                        l = n.model.attributes.z;
                    i < l && n.$el.css({
                        "z-index": o + s + 1
                    }), n.$el.data({
                        "original-element-z-index": a
                    })
                })
            }
        },
        startPreviewMode: function() {
            this.isPreviewMode || (this.isPreviewMode = !0, this.$previewAnimator.css({
                visibility: "inherit"
            }), this.$stepsLinesWrapper.css({
                visibility: "hidden"
            }), this.updatePreviewMode({
                immediate: !0
            }))
        },
        getBezierCurveEditorParams() {
            let e = {
                    x: this.baseDimensions.left,
                    y: this.baseDimensions.top
                },
                t = {
                    w: this.baseDimensions.width,
                    h: this.baseDimensions.height
                },
                o = window.RM.constructorRouter.workspace.viewport,
                i = this.someModel.getAnimations(),
                n = this.uuid ? i.find(a => a.UUID === this.uuid) : i[0],
                s = ft.getNormalizedAnimation(n, this.isFixed, this.isFullwidth, this.isFullheight, 1, o, window.RM.constructorRouter.workspace.mag.getViewportWidth(o), window.RM.constructorRouter.workspace.mag.get("opts"), !0);
            return {
                startCenterPosition: e,
                blockDimensions: t,
                animation: s,
                workspace: this.workspace
            }
        },
        updatePreviewMode: function(e = {}) {
            if (!this.isPreviewMode) return;
            let t = window.RM.constructorRouter.workspace.viewport,
                o = window.RM.constructorRouter.workspace.mag.getViewportWidth(t),
                i = window.RM.constructorRouter.workspace.mag.get("opts"),
                n = this;
            clearTimeout(this.updatePreviewModeTimeout), e.immediate ? s() : this.updatePreviewModeTimeout = setTimeout(s, 500);

            function s() {
                n.previewTimeline && n.previewTimeline.destroy();
                let a = n.someModel.getAnimations(),
                    l = ft.getNormalizedAnimation(n.uuid ? a.find(p => p.UUID === n.uuid) : a[0], n.isFixed, n.isFullwidth, n.isFullheight, 1, t, o, i, !0),
                    c = {
                        t: Number.POSITIVE_INFINITY,
                        l: Number.POSITIVE_INFINITY,
                        b: Number.NEGATIVE_INFINITY,
                        r: Number.NEGATIVE_INFINITY
                    };
                n.blocks.forEach(p => {
                    let h = p.getBoxData({
                        includeBoundingBox: !0
                    });
                    c.t = Math.min(c.t, h.bb_y), c.l = Math.min(c.l, h.bb_x), c.b = Math.max(c.b, h.bb_y + h.bb_h), c.r = Math.max(c.r, h.bb_x + h.bb_w)
                });
                let d = {
                    x: (c.r - c.l) / 2,
                    y: (c.b - c.t) / 2
                };
                n.previewTimeline = ft.createAnimationTimeline({
                    el: n.$previewAnimator,
                    steps: l.steps,
                    type: l.type,
                    force3d: !1,
                    loop: ft.normalizeLoopValue(l.loop),
                    animationTrigger: l.trigger,
                    screenshotMode: !1,
                    centerPoint: d
                }), l.type !== "scroll" ? n.previewTimeline.play() : n.onWorkspaceScroll()
            }
        },
        stopPreviewMode: function() {
            this.isPreviewMode && (this.isPreviewMode = !1, this.$previewAnimator.css({
                visibility: "hidden"
            }), this.$stepsLinesWrapper.css({
                visibility: "inherit"
            }), this.previewTimeline && this.previewTimeline.destroy())
        },
        togglePreviewMode: function() {
            this.isPreviewMode ? this.stopPreviewMode() : this.startPreviewMode()
        },
        getScrollStart(e) {
            let t = {
                    top: 1,
                    center: .5,
                    bottom: 0
                },
                o = this.zoomView.getZoom(),
                i = this.baseDimensions.top,
                n = i - this.$workspaceScroll.height() / o;
            return t[e.steps[0].start_point || "bottom"] * (i - n) + n + (e.steps[0].start_offset ? ? 0)
        },
        getAnimation() {
            let e = this.someModel.getAnimations();
            return this.uuid ? e.find(t => t.UUID === this.uuid) : e[0]
        },
        onWorkspaceScroll: function() {
            if (this.currentStep && this.currentStep.updateAddButtonPos(), !this.previewTimeline || !this.isPreviewMode) return;
            let e = this.getAnimation();
            if (e.type !== "scroll" || !e) return;
            let t = Math.max(0, this.$workspaceScroll.scrollTop()),
                o = this.zoomView.getZoom();
            if (this.isFixed) {
                this.previewTimeline.seek(t);
                return
            }
            let i = this.getScrollStart(e);
            i <= 0 ? this.previewTimeline.seek(t / o) : this.previewTimeline.seek(Math.max(0, t - i * o) / o)
        },
        updateContainerDims: function() {
            let e;
            yo.default.each(this.blocks, function(t) {
                let o = t.getBoxData({
                    includeBoundingBox: !0,
                    checkFixedPosition: !0
                });
                e = e || {
                    t: Number.POSITIVE_INFINITY,
                    l: Number.POSITIVE_INFINITY,
                    b: Number.NEGATIVE_INFINITY,
                    r: Number.NEGATIVE_INFINITY
                }, e.t = Math.min(e.t, o.bb_y), e.l = Math.min(e.l, o.bb_x), e.b = Math.max(e.b, o.bb_y + o.bb_h), e.r = Math.max(e.r, o.bb_x + o.bb_w)
            }, this), e && (this.baseDimensions = {
                left: e.l + (this.isFixed ? this.workspace.position.left : 0),
                top: e.t + (this.isFixed ? this.workspace.position.top : 0),
                width: e.r - e.l,
                height: e.b - e.t
            }, this.$el.css({
                width: e.r - e.l,
                height: e.b - e.t,
                position: this.isFixed ? "fixed" : "absolute"
            }), this.$previewAnimator.css(this.baseDimensions))
        },
        createStep: function(e = {}) {
            let t = new Sz({
                    model: new this.StepModel,
                    workspace: this.workspace,
                    constraintHorzMove: this.isFullwidth,
                    constraintVertMove: this.isFullheight,
                    hideRotateEffect: this.isFullwidth || this.isFullheight,
                    $standaloneContainer: this.$stepsLinesWrapper,
                    zoomView: this.zoomView
                }),
                o = this;
            return t.on("select", function() {
                if (o.currentStep = this, o.steps)
                    for (let i = 0; i <= o.steps.length; i++) {
                        let n = o.$lines && o.$lines[i] && o.$lines[i].find("line"),
                            s = i === o.steps.length ? o.initialStep : o.steps[i];
                        this !== s ? (s.deselect(), n && n.attr("stroke-dasharray", "4,2")) : (o.isIndirectSelect || o.trigger("select", s.model.get("id") === "initial" ? 0 : s.model.get("id")), n && n.removeAttr("stroke-dasharray"))
                    }
            }), t.model.set({
                id: e.id,
                is_locked: e.id === "initial"
            }), t.render(), t.setContent(this.getFantom()), e.id !== "initial" && t.on("move", yo.default.bind(Ym(function(i) {
                let n = Math.round(i.left - this.baseDimensions.left + (i.width - this.baseDimensions.width) / 2),
                    s = Math.round(i.top - this.baseDimensions.top + (i.height - this.baseDimensions.height) / 2),
                    a = {
                        dx: n,
                        dy: s
                    };
                (this.cachedMove ? .dx !== a.dx || this.cachedMove ? .dy !== a.dy) && (this.trigger("move", {
                    id: t.model.get("id"),
                    ...a
                }), this.updateSteps({
                    exceptStep: t
                })), this.cachedMove = a
            }, 10), this)), t.on("resize", yo.default.bind(function(i) {
                e.id === "initial" ? this.trigger("scale", {
                    id: 0,
                    from_scale: Math.round(100 * i.width / this.baseDimensions.width)
                }) : this.trigger("scale", {
                    id: t.model.get("id"),
                    scale: Math.round(100 * i.width / this.baseDimensions.width)
                }), t.model.set({
                    scale: 100 * i.width / this.baseDimensions.width
                }, {
                    silent: !0
                }), t.redrawScale(), this.updateSteps({
                    exceptStep: t
                })
            }, this)), t.on("add-step", yo.default.bind(function(i) {
                this.trigger("add-step", {
                    after_step: t.model.get("id"),
                    use_effect: i
                }), this.popupManager && this.popupManager.closePopup("add-step-selector")
            }, this)), t
        },
        setStepModel: function(e, t) {
            let o = this.baseDimensions,
                i = o.width * t.scale / 100,
                n = o.height * t.scale / 100;
            e.model.set({
                x: o.left + o.width / 2 + t.dx - i / 2,
                y: o.top + o.height / 2 + t.dy - n / 2,
                w: i,
                h: n,
                z: 1,
                angle: t.rotate,
                opacity: t.opacity,
                scale: t.scale,
                aspect: o.width / o.height
            }, {
                silent: !0
            }), e.redraw(e.model)
        },
        getFantom: function(e) {
            let t = e ? e.$el.clone() : this.$fantoms.clone();
            if (e && e.model.get("type") === "picture" && e.model.get("picture")) {
                let i = e.model.get("picture"),
                    n = e,
                    s = n.useLambdaUrl && n.useLambdaUrl() ? n.getLambdaUrl() : i.unscaledOptimizedUrl || i.unscaledUrl || i.url;
                s && t.find(".content div").css("background-image", `url(${s})`)
            }
            let o = [];
            if (t.find("defs mask, defs clippath").each(function() {
                    o.push((0, hr.default)(this).attr("id"))
                }), e && e.model.get("type") === "hotspot" && t.find(".tip").remove(), t.find(".size-tool").remove(), t.find(".animation-trigger-tooltip").remove(), o.length) {
                let i = t[0].outerHTML;
                for (let n = 0; n < o.length; n++) {
                    let s = be.generateUUID(),
                        a = new RegExp("(" + be.escapeSpecial(o[n], !1) + ")", "g");
                    i = i.replace(a, s)
                }
                t = (0, hr.default)(i)
            }
            return t
        },
        updateFantoms: function() {
            this.$fantoms && this.$fantoms.remove(), this.$fantoms = (0, hr.default)("<div>").css({
                position: "relative",
                left: 0,
                top: 0,
                width: this.baseDimensions.width,
                height: this.baseDimensions.height
            }), yo.default.each(this.blocks, yo.default.bind(function(e) {
                let t = this.getFantom(e);
                t.find(".frameborder").remove(), t.find(".animation-trigger-tooltip").remove(), t.removeClass("animation-mode"), this.isFixed ? t.css({
                    position: "absolute",
                    left: "50%",
                    top: "50%",
                    bottom: "",
                    right: "",
                    "margin-left": -e.model.get("w") / 2,
                    "margin-top": -e.model.get("h") / 2
                }) : t.css({
                    left: "-=" + this.baseDimensions.left,
                    top: "-=" + this.baseDimensions.top
                }), this.$fantoms.append(t)
            }, this)), this.$previewAnimator.html(this.getFantom())
        },
        updateSteps: function(e = {}) {
            this.initialStep = this.initialStep || this.createStep({
                id: "initial"
            });
            let t = window.RM.constructorRouter.workspace.viewport,
                o = this.someModel.getAnimations(),
                i = this.uuid ? o.find(s => s.UUID === this.uuid) : o[0];
            if (!i) return;
            let n = ft.getNormalizedAnimation(i, this.isFixed, this.isFullwidth, this.isFullheight, 1, t, window.RM.constructorRouter.workspace.mag.getViewportWidth(t), window.RM.constructorRouter.workspace.mag.get("opts"));
            if (e.animateStepInd === 0 && this.initialStep.flashTransitions(), n.steps.length !== 0) {
                e.exceptStep !== this.initialStep && this.setStepModel(this.initialStep, {
                    dx: 0,
                    dy: 0,
                    opacity: n.steps[0].from_opacity,
                    rotate: n.steps[0].from_rotate,
                    scale: n.steps[0].from_scale
                }), this.steps = this.steps || [];
                for (let s = 0; s < n.steps.length; s++) this.steps[s] = this.steps[s] || this.createStep({
                    id: s
                }), e.animateStepInd !== void 0 && e.animateStepInd <= s && this.steps[s].flashTransitions(), e.exceptStep !== this.steps[s] && this.setStepModel(this.steps[s], n.steps[s]);
                this.updateLines();
                for (let s = n.steps.length; s < this.steps.length; s++) this.steps[s].model.destroy(), this.steps[s].destroy(), this.steps[s].off();
                this.steps.length = n.steps.length
            }
        },
        handleUpdateBezier({
            step: e,
            point: t,
            pointName: o
        }) {
            this.trigger("update-move-bezier", {
                step: e,
                point: t,
                pointName: o
            })
        },
        updateLines: function() {
            this.bezierEditor ? .update(this.getBezierCurveEditorParams())
        },
        selectStep: function(e) {
            this.isIndirectSelect = !0, this.steps[e].select(), this.isIndirectSelect = !1, this.bezierEditor ? .update(this.getBezierCurveEditorParams())
        },
        moveSelected: function(e, t) {
            let o = yo.default.filter(yo.default.union(this.steps, this.initialStep), function(a) {
                return !a.isLocked() && a.selected
            });
            if (yo.default.isEmpty(o) || this.isFullwidth && (0, yo.default)(["left", "right"]).contains(t) || this.isFullheight && (0, yo.default)(["up", "down"]).contains(t)) return;
            let i = e.shiftKey ? 10 : 1,
                n = window.RM.constructorRouter.gg.snap;
            window.RM.constructorRouter.gg.snap = !1;
            let s = {
                deltaY: 0,
                deltaX: 0
            };
            switch (t) {
                case "up":
                    s.deltaY = -i;
                    break;
                case "right":
                    s.deltaX = i;
                    break;
                case "down":
                    s.deltaY = i;
                    break;
                case "left":
                    s.deltaX = -i;
                    break
            }
            Sz.prototype.moveBlocks(null, o, s), window.RM.constructorRouter.gg.snap = n, e.stopPropagation(), e.preventDefault()
        },
        removeSelected: function() {
            let e = yo.default.filter(yo.default.union(this.steps, this.initialStep), function(t) {
                return t.selected
            });
            yo.default.isEmpty(e) || this.trigger("remove-step", e[0].model.get("id"))
        },
        onResize: function() {
            (this.isFullwidth || this.isFullheight || this.isFixed || this.isSticked) && (this.updateContainerDims(), this.updateSteps()), this.isFullwidth && (clearTimeout(this.updateFantomsTimer), this.updateFantomsTimer = setTimeout(yo.default.bind(function() {
                this.updateFantoms(), this.initialStep.setContent(this.getFantom());
                for (let e = 0; e < this.steps.length; e++) this.steps[e].setContent(this.getFantom())
            }, this), 100)), this.onWorkspaceScroll()
        },
        destroy: function() {
            if (this.bezierEditor ? .destroy(), this.stopPreviewMode(), yo.default.each(this.blocks, function(e) {
                    e.toggleAnimationMode(!1)
                }), this.$fantoms && this.$fantoms.remove(), this.initialStep && (this.initialStep.model.destroy(), this.initialStep.destroy(), this.initialStep.off()), this.steps)
                for (let e = 0; e < this.steps.length; e++) this.steps[e].model.destroy(), this.steps[e].destroy(), this.steps[e].off();
            if (this.remove(), this.workspace.switchOffAnimationMode(), (0, hr.default)(window).off("resize", this.onResize), this.$workspaceScroll.off("scroll", this.onWorkspaceScroll), this.updateIndexes) {
                let e = this.blocks[0];
                yo.default.each(e.getTriggerBlocks(), function(t) {
                    let o = t.$el.data("original-element-z-index");
                    t.$el.css({
                        "z-index": o && o !== "auto" ? o : null
                    })
                })
            }
        }
    }), Cz = Bte
});

function Pz({
    blocks: e,
    currentAnimation: t,
    workspace: o,
    callbacks: i = {}
}) {
    let {
        current: n
    } = (0, mr.useRef)(new Set([])), [s, a] = (0, mr.useState)(!1), l = (0, mr.useRef)(null), c = Xl(i.onEffectChange), d = Xl(i.onAddStep), p = Xl(i.onBezierMoveChange), h = Xl(i.onRemoveStep), u = Xl(i.onSelectStep), m = t ? .type, f = t ? .UUID, g = t ? .selected ? ? 0, y = (t ? .steps ? ? []).length, S = (0, mr.useCallback)(() => {
        if (!f || m === "none" || l.current) return;

        function P(D) {
            c(D)
        }

        function M(D) {
            d(D)
        }

        function F(D) {
            h(D)
        }

        function R(D) {
            u(D)
        }

        function A({
            point: D,
            pointName: O,
            step: L
        }) {
            p(L, {
                pointName: O,
                point: D
            })
        }
        if (y > 0) {
            let D = e[0];
            l.current = new Cz({
                uuid: f,
                blocks: e,
                workspace: o,
                isFixed: !!D.model.get("fixed_position"),
                isFullwidth: D.model.get("is_full_width"),
                isFullheight: D.model.get("is_full_height"),
                isSticked: !!D.model.get("sticked"),
                updateIndexes: !0,
                popupManager: Iz,
                zoomView: window.RM.constructorRouter.zoom
            }), l.current.selectStep(g), n.forEach(O => {
                O()
            }), n.clear(), l.current.on("move scale", P), l.current.on("add-step", M), l.current.on("remove-step", F), l.current.on("select", R), l.current.on("update-move-bezier", A)
        }
    }, [m, f, y, o]), w = (0, mr.useCallback)(() => {
        l.current && (l.current.destroy(), l.current = null, n.clear(), Iz.closeAllPopups())
    }, []);
    (0, mr.useEffect)(() => {
        l.current && l.current.selectStep(g)
    }, [g]), (0, mr.useEffect)(() => (S(), () => {
        w()
    }), [S]);
    let v = (0, mr.useCallback)((P = {}) => {
            l.current ? l.current.updateSteps(P) : n.add(() => l.current.updateSteps(P))
        }, []),
        C = (0, mr.useCallback)(() => {
            l.current && l.current.updatePreviewMode()
        }, []),
        I = (0, mr.useCallback)(() => {
            l.current && (l.current.startPreviewMode(), a(!0))
        }, []),
        T = (0, mr.useCallback)(() => {
            l.current && (l.current.stopPreviewMode(), a(!1))
        }, []);
    return {
        init: S,
        destroy: w,
        updateSteps: v,
        updatePreviewMode: C,
        startPreviewMode: I,
        stopPreviewMode: T,
        preview: s
    }
}
var mr, Iz, Tz = k(() => {
    "use strict";
    mr = E(N());
    yz();
    jn();
    kz();
    Iz = new xc
});

function Mte(e) {
    let [t, o] = (0, to.useState)(() => {
        let n = RP(),
            s = e.filter(a => a !== "none");
        return n !== null && s.includes(n) ? n : s[s.length - 1] ? ? null
    }), i = n => {
        let s = typeof n == "function" ? n(t) : n;
        EP(s), o(s)
    };
    return (0, to.useEffect)(() => {
        if (e.length > 0 && t === null) {
            let n = e.filter(s => s !== "none");
            i(n[0])
        }
    }, [e, t]), [t, i]
}

function Bz(e) {
    let {
        children: t,
        value: o = [],
        onChange: i,
        blocks: n,
        workspace: s,
        injectedRefs: a
    } = e, [l, c] = (0, to.useState)(null), [d, p] = Mte(o.map(pe => pe.type)), h = (0, to.useMemo)(() => o.reduce((pe, J) => (pe[J.UUID] = J, pe), {}), [o]), u = (0, to.useMemo)(() => d ? Object.values(h).find(pe => pe.type === d) ? ? null : null, [h, d]), m = u ? .selected ? ? 0, f = u ? .steps ? .[m] ? ? { ...wg
    }, {
        preview: g,
        updateSteps: y,
        init: S,
        destroy: w,
        startPreviewMode: v,
        stopPreviewMode: C,
        updatePreviewMode: I
    } = Pz({
        blocks: n,
        workspace: s,
        currentAnimation: u,
        callbacks: {
            onAddStep({
                use_effect: pe
            }) {
                V(pe)
            },
            onSelectStep(pe) {
                q(pe)
            },
            onRemoveStep(pe) {
                ne(pe)
            },
            onEffectChange(pe) {
                let {
                    id: J,
                    ...le
                } = pe;
                le.dx !== void 0 || le.dy !== void 0 ? le.use_move = !0 : le.scale !== void 0 && (le.use_scale = !0), X(le, {
                    stepIndex: J,
                    updateWorkspace: !1
                })
            },
            onBezierMoveChange(pe, {
                point: J,
                pointName: le
            }) {
                X({
                    curve: { ...f ? .curve,
                        [le] : J
                    },
                    use_bezier: !0
                }, {
                    stepIndex: pe,
                    updateWorkspace: !0
                })
            }
        }
    }), {
        status: T,
        setStatus: P,
        removeTrigger: M,
        getTriggerHoverProps: F
    } = Tu({
        block: n[0],
        workspace: s,
        triggers: u ? .trigger ? ? [],
        onTriggerClick(pe) {
            let le = [...u ? .trigger ? ? [], pe];
            W({
                trigger: le
            }), n[0].model.trigger("animation:trigger:add"), De(Fe.AnimationAddTrigger, {
                triggerNumber: le.length
            })
        }
    });
    a && (a.canControlBeClosed = () => T === "pending"), (0, to.useEffect)(() => {
        T === "pending" ? w() : S()
    }, [T, w, S]), (0, to.useEffect)(() => (jo.on("undo", y), jo.on("redo", y), () => {
        jo.off("redo", y), jo.off("undo", y)
    }), [y, u]);
    let R = (0, to.useCallback)(pe => {
            p(pe)
        }, []),
        A = (0, to.useCallback)(pe => {
            i(pe)
        }, [i]),
        D = (0, to.useCallback)((pe = {}) => {
            let J = s.viewport,
                le = n[0];
            return ft.getNormalizedAnimation({ ...u,
                ...pe
            }, !!le.model.get("fixed_position"), le.model.get("is_full_width"), le.model.get("is_full_height"), 1, J, s.mag.getViewportWidth(J), s.mag.get("opts"), !0)
        }, [s, n, u]),
        O = (0, to.useCallback)(pe => {
            c(J => J === pe ? null : pe)
        }, []),
        L = (0, to.useCallback)(pe => {
            let J = Zl.createInteraction(pe);
            R(pe), A([...o, J]), De(Fe.AnimationLoad, {
                loadOn: pe
            })
        }, [o, A]),
        W = (0, to.useCallback)((pe, J) => {
            let le = d,
                ye = Te => (typeof pe.type < "u" && Te.steps[0] && (Te.steps[0].hideInEditor = !1), { ...Te,
                    ...pe
                }),
                Ue = o.map(Te => J ? Te.UUID === J ? ye(Te) : Te : Te.type === le ? ye(Te) : Te);
            A(Ue), g && I()
        }, [o, d, g, I, A]),
        z = (0, to.useCallback)(pe => {
            let J = o.filter(({
                UUID: le
            }) => le !== pe);
            R(J[0] ? .type ? ? null), A(J)
        }, [o, A]),
        V = (0, to.useCallback)(pe => {
            if (u) {
                let J = Zl.createInteractionStep(u),
                    le = D(J);
                W({
                    steps: le.steps
                }), De(Fe.AnimationAddStep, {
                    step: le.steps.length
                }), setTimeout(() => {
                    let {
                        steps: ye,
                        selected: Ue
                    } = Zl.addInteractionStepEffect(J, le, pe);
                    W({
                        steps: ye,
                        selected: Ue
                    }), y({
                        animateStepInd: Ue
                    })
                })
            }
        }, [u, D, W, y]),
        X = (0, to.useCallback)((pe, {
            stepIndex: J,
            updateWorkspace: le = !0
        } = {}) => {
            if (u) {
                let {
                    steps: ye
                } = Zl.updateInteractionStep(u, pe, {
                    stepIndex: J
                });
                W({
                    steps: ye
                }), le && y()
            }
        }, [u, W, y]),
        q = (0, to.useCallback)(pe => {
            u && u.steps[pe] && W({
                selected: pe
            })
        }, [u, W]),
        ne = (0, to.useCallback)(pe => {
            if (u) {
                let J = D(u),
                    {
                        steps: le,
                        selected: ye
                    } = Zl.removeInteractionStep(u, J, pe);
                W({
                    steps: le,
                    selected: ye
                }), y({
                    animateStepInd: pe
                })
            }
        }, [u, D, W, y]),
        re = (0, to.useCallback)((pe, J) => {
            if (u) {
                let le = u.selected ? ? 0,
                    ye = [...u.steps],
                    Ue = ye[pe];
                ye[pe] = ye[J], ye[J] = Ue;
                let Te = le;
                le === pe ? Te = J : le === J && (Te = Math.max(J - 1, 0)), W({
                    steps: ye,
                    selected: Te
                })
            }
        }, [u, W]),
        te = (0, to.useCallback)(pe => {
            if (u) {
                let J = D(),
                    le = Zl.addInteractionStepEffect(u, J, pe);
                W({
                    steps: le.steps
                }), y({
                    animateStepInd: J.selected
                })
            }
        }, [u, D, W, y]),
        ee = (0, to.useCallback)(pe => {
            W(FP(pe)), y(), De(Fe.AnimationPresetSelected, {
                preset: pe
            })
        }, [W, y]),
        j = M(pe => {
            if (u) {
                let J = u.trigger ? ? [];
                W({
                    trigger: J.filter(le => le !== pe)
                }), n[0].model.trigger("animation:trigger:remove")
            }
        }),
        se = (0, to.useCallback)(() => {
            P("pending")
        }, [P]),
        oe = (0, to.useCallback)(() => {
            P("idle")
        }, [P]),
        U = (0, to.useCallback)(() => {
            g ? C() : v()
        }, [g, v, C]),
        he = (0, to.useCallback)(pe => {
            let J = {
                use_bezier: pe
            };
            if (!f.curve && pe) {
                let {
                    curve: le
                } = Zl.setDefaultCurveAfterEnable(D());
                J.curve = le
            }
            X(J), pe && De(Fe.AnimationSettings, {
                settingsType: "bezier toggle on"
            })
        }, [X, D, f]),
        xe = {
            setSelectedInteraction: R,
            createInteraction: L,
            updateInteraction: W,
            removeInteraction: z,
            createStep: V,
            updateStep: X,
            selectStep: q,
            removeStep: ne,
            addStepEffect: te,
            pastePreset: ee,
            enterPickTriggerMode: se,
            leavePickTriggerMode: oe,
            removeInteractionTrigger: j,
            getTriggerHoverProps: F,
            togglePanel: O,
            togglePreviewMode: U,
            changeStepPosition: re,
            toggleBezierMode: he
        };
    return r(Fo.Provider, {
        value: {
            actions: xe,
            selectedInteraction: d,
            selectedInteractionSettings: u,
            selectedStepSettings: f,
            interactions: h,
            triggerStatus: T,
            openedPanel: l,
            preview: g
        },
        children: t
    })
}
var to, Fo, Wr = k(() => {
    "use strict";
    to = E(N());
    qt();
    wa();
    wc();
    Bh();
    jn();
    Tz();
    oy();
    B();
    Fo = (0, to.createContext)({
        selectedInteraction: null,
        openedPanel: null,
        preview: !1,
        selectedStepSettings: { ...wg
        },
        actions: {
            setSelectedInteraction() {},
            createInteraction() {},
            updateInteraction() {},
            removeInteraction() {},
            createStep() {},
            updateStep() {},
            selectStep() {},
            removeStep() {},
            addStepEffect() {},
            pastePreset() {},
            enterPickTriggerMode() {},
            leavePickTriggerMode() {},
            removeInteractionTrigger() {},
            getTriggerHoverProps: () => ({
                onMouseOut() {},
                onMouseOver() {}
            }),
            togglePanel() {},
            togglePreviewMode() {},
            changeStepPosition() {},
            toggleBezierMode() {}
        },
        selectedInteractionSettings: null,
        interactions: {},
        triggerStatus: "idle"
    })
});

function Mz(e) {
    let t = () => {
            let i = {},
                n = 0,
                s = e.blocks[0];
            e.blocks.forEach(a => {
                let l = a.model,
                    c = ft.getUuidHash(l.getAnimations()) || "none";
                i[c] = (i[c] || 0) + 1, c !== "none" && i[c] > n && (s = a, n = i[c])
            }), e.onMerge(s)
        },
        o = null;
    switch (e.messageType) {
        case "is_full_height":
            o = r($, {
                textStyle: "small",
                children: "Nope, you can\u2019t animate multiple full height widgets at a time."
            });
            break;
        case "is_full_width":
            o = r($, {
                textStyle: "small",
                children: "Nope, you can\u2019t animate multiple full width widgets at a time."
            });
            break;
        case "sticked":
            o = r($, {
                textStyle: "small",
                children: "Nope, you can\u2019t animate multiple sticky widgets at a time."
            });
            break;
        case "fixed":
            o = x(Ey.Fragment, {
                children: [r($, {
                    textStyle: "small",
                    children: "Nope, you can\u2019t animate multiple fixed widgets at a time."
                }), x($, {
                    textStyle: "small",
                    children: ["Use Shift + ", Rte(), " + C/V to copy animation effects from one widget and apply them to others"]
                })]
            });
            break;
        case "mixed-animations":
            o = x(Ey.Fragment, {
                children: [r($, {
                    textStyle: "small",
                    children: "You selected different animations"
                }), r(K, {
                    padding: "11px 0",
                    textStyle: "small",
                    variant: "bordered",
                    onClick: t,
                    children: "Merge"
                })]
            });
            break;
        default:
            o = r($, {
                textStyle: "small",
                children: "Nope, you can\u2019t mix fixed, full width, full height, sticky and normal widgets at a time"
            });
            break
    }
    return r(Ey.Fragment, {
        children: r(H, {
            showBorder: !1,
            children: r(b, {
                display: "flex",
                gap: 24,
                flexDirection: "column",
                children: o
            })
        })
    })
}
var Ey, Rte, Rz = k(() => {
    "use strict";
    Ey = E(N());
    ie();
    je();
    $e();
    Be();
    wa();
    B();
    Rte = () => Modernizr.mac ? "Cmd" : "Ctrl"
});

function ds(e) {
    let {
        panelProps: t = {},
        leftButtonSlot: o,
        rightButtonSlot: i,
        leftButtonProps: n = {},
        rightButtonProps: s = {}
    } = e, {
        isHovered: a,
        ...l
    } = nr(!1);
    return r(H, { ...t,
        onMouseEnter: () => l.onMouseEnter(),
        onMouseLeave: () => l.onMouseLeave(),
        leftSlot: o ? r(bo, {
            width: "100%",
            display: "flex",
            textStyle: "small",
            alignItems: "center",
            justifyContent: "space-between",
            ...n,
            children: typeof o == "function" ? o({
                isHovered: a
            }) : o
        }) : null,
        rightSlot: i ? r(bo, { ...s,
            children: typeof i == "function" ? i({
                isHovered: a
            }) : i
        }) : null
    })
}
var Md = k(() => {
    "use strict";
    $e();
    od();
    La();
    B()
});

function Ez() {
    let {
        actions: e
    } = (0, Bm.useContext)(Fo);
    return x(Ql, {
        dark: !0,
        disableBorders: !0,
        children: [r(H, {
            showBorder: !1,
            leftSlot: r($, {
                color: "orange",
                children: "Add Action"
            })
        }), md.map(({
            label: t,
            name: o
        }, i) => r(ds, {
            panelProps: {
                showBorder: i !== md.length - 1
            },
            leftButtonProps: {
                onClick: () => {
                    o === "use_move" ? st("AddTapMoveAnimations") : o === "use_opacity" && window.RM.constructorRouter.trigger("notice:triggerMetrics", "opacityAnimationAdded"), e.createStep(o)
                },
                hoverColor: "orange",
                color: "white"
            },
            leftButtonSlot: x(Bm.Fragment, {
                children: [t, r(Qt, {})]
            })
        }, o)), r(H, {
            showBorder: !1,
            leftSlot: r($, {
                color: "gray",
                children: "Use a preset"
            })
        }), gw.map(({
            name: t,
            label: o
        }, i) => r(ds, {
            panelProps: {
                showBorder: i !== gw.length - 1
            },
            leftButtonProps: {
                onClick: () => e.pastePreset(t)
            },
            leftButtonSlot: x(Bm.Fragment, {
                children: [o, r(Qt, {})]
            })
        }, t))]
    })
}
var Bm, Fz = k(() => {
    "use strict";
    Bm = E(N());
    Vh();
    $e();
    Cr();
    Be();
    Wr();
    jn();
    Md();
    pi();
    $l();
    B()
});

function Dz() {
    let [e, t] = (0, Fy.useState)(!1);

    function o(i) {
        t(!0);
        try {
            window.RM.constructorRouter.onCopyAnimation(i.nativeEvent), MP(!0), setTimeout(() => {
                t(!1)
            }, 1e3)
        } catch (n) {
            console.error(n)
        }
        De(Fe.AnimationSettings, {
            settingsType: "copy all settings"
        })
    }
    return r(ds, {
        leftButtonProps: {
            onClick: o
        },
        leftButtonSlot: x(Fy.Fragment, {
            children: [e ? "Copied" : "Copy all settings", r(Tf, {
                marginRight: 5
            })]
        })
    })
}
var Fy, Az = k(() => {
    "use strict";
    Fy = E(N());
    N0();
    qt();
    jn();
    Md();
    B()
});

function _c({
    value: e,
    ...t
}) {
    let o = Math.abs(e ? ? 0) >= 1e3 ? "regular" : "subheading";
    return r(fe, { ...t,
        textAlign: "inherit",
        textStyle: o,
        value: e ? ? 0,
        autoWidth: !0
    })
}

function Ete({
    children: e,
    availableEffects: t = []
}) {
    let [o, i] = (0, ln.useState)(() => t[0]), n = $f(t);
    (0, ln.useEffect)(() => {
        let l = n ? .length ? ? 0;
        if (!t.includes(o)) i(t[0]);
        else if (l && t.length > l) {
            let [c] = AC(t, n ? ? []);
            i(c)
        }
    }, [t, o, n]);
    let s = l => {
            i(l)
        },
        a = t.length <= 2;
    return r(zz.Provider, {
        value: {
            value: o,
            onChange: s,
            needToAllOpened: a
        },
        children: e
    })
}

function $z() {
    let {
        actions: e,
        selectedStepSettings: t,
        selectedInteractionSettings: o
    } = (0, ln.useContext)(Fo), {
        model: i
    } = (0, ln.useContext)(Y), n = o ? .selected ? ? 0, s = (0, ln.useMemo)(() => {
        if (o) {
            let c = o ? .trigger ? ? [];
            return Dte(o, t, c, i.block)
        }
        return !1
    }, [o, t, i]), a = n > 0, l = (0, ln.useMemo)(() => {
        let c = {
            use_move: "move",
            use_opacity: "opacity",
            use_rotate: "rotate",
            use_scale: "scale"
        };
        return Object.keys(c).reduce((d, p) => (t[p] && d.push(c[p]), d), [])
    }, [t]);
    return r(b, {
        minHeight: 200,
        marginTop: -6,
        children: x(Ete, {
            availableEffects: l,
            children: [t.use_move ? r(H, {
                dense: !0,
                children: r(Dy, {
                    value: "move",
                    label: "Move",
                    hidePostfixIcon: !0,
                    onRemove: () => e.updateStep({
                        use_move: !1,
                        use_bezier: !1
                    }),
                    children: c => x(b, {
                        display: "flex",
                        flexDirection: "column",
                        width: "100%",
                        children: [r(b, {
                            position: "relative",
                            top: 18,
                            children: r(ao, {
                                targetSteps: ["SetAnimationValue"],
                                position: "left",
                                indent: 24,
                                children: r("div", {})
                            })
                        }), r(Uu, {
                            StartInput: r(_c, {
                                id: c,
                                min: -99999,
                                max: 99999,
                                value: t.dx,
                                onChange: ({
                                    value: d
                                }) => {
                                    e.updateStep({
                                        dx: d
                                    }), d === -328 && st("SetAnimationValue")
                                }
                            }),
                            EndInput: r(_c, {
                                id: c,
                                min: -99999,
                                max: 99999,
                                autoFocus: !0,
                                value: t.dy,
                                onChange: ({
                                    value: d
                                }) => {
                                    e.updateStep({
                                        dy: d
                                    })
                                }
                            })
                        }), x(b, {
                            height: 40,
                            width: "100%",
                            display: "flex",
                            alignItems: "center",
                            justifyContent: "space-between",
                            children: [r($, {
                                textStyle: "small",
                                children: "B\xE9zier"
                            }), x(b, {
                                display: "flex",
                                alignItems: "center",
                                children: [r(et, {
                                    componentsProps: {
                                        tooltip: {
                                            width: 174,
                                            lineHeight: 1.33
                                        }
                                    },
                                    closeOnTargetClick: !0,
                                    text: r(Fte, {}),
                                    indent: 4,
                                    skidding: -16,
                                    children: r(b, {
                                        width: 24,
                                        display: "flex",
                                        justifyContent: "center",
                                        children: r(ed, {
                                            color: "gray"
                                        })
                                    })
                                }), r(Ve, {
                                    background: "gray",
                                    backgroundChecked: "#00A882",
                                    togglerBackground: "black",
                                    onChange: d => e.toggleBezierMode(d),
                                    checked: t.use_bezier ? ? !1
                                })]
                            })]
                        })]
                    })
                })
            }) : null, t.use_opacity ? x(ln.Fragment, {
                children: [r(H, {
                    dense: !0,
                    showBorder: !s,
                    children: r(Dy, {
                        hidePostfixIcon: !0,
                        label: "Opacity",
                        value: "opacity",
                        onRemove: () => e.updateStep({
                            use_opacity: !1
                        }),
                        children: c => r(Uu, {
                            hideStartInput: a,
                            StartInput: r(_c, {
                                id: c,
                                min: 0,
                                max: 100,
                                value: t.from_opacity,
                                onChange: ({
                                    value: d
                                }) => e.updateStep({
                                    from_opacity: d
                                })
                            }),
                            EndInput: r(_c, {
                                id: c,
                                min: 0,
                                max: 100,
                                autoFocus: !0,
                                value: t.opacity,
                                onChange: ({
                                    value: d
                                }) => e.updateStep({
                                    opacity: d
                                })
                            }),
                            onIconClick: () => {
                                e.updateStep({
                                    from_opacity: t.opacity ? ? 0,
                                    opacity: t.from_opacity ? ? 0
                                })
                            }
                        })
                    })
                }), s ? r(ao, {
                    eduTips: "eduTipUseHideWidget",
                    position: "left",
                    indent: 24,
                    leaveDelay: 100,
                    instance: !0,
                    closeOnTargetClick: !0,
                    children: r(H, {
                        leftSlot: "Hide in editor",
                        rightSlot: r(Ve, {
                            background: "gray",
                            backgroundChecked: "#00A882",
                            togglerBackground: "black",
                            onChange: c => e.updateStep({
                                hideInEditor: c
                            }),
                            checked: t.hideInEditor
                        })
                    })
                }) : null]
            }) : null, t.use_rotate ? r(H, {
                dense: !0,
                children: r(Dy, {
                    value: "rotate",
                    label: "Rotate",
                    hidePostfixIcon: !0,
                    onRemove: () => e.updateStep({
                        use_rotate: !1
                    }),
                    children: c => r(Uu, {
                        hideStartInput: a,
                        StartInput: r(_c, {
                            id: c,
                            min: -9999,
                            max: 9999,
                            value: t.from_rotate,
                            onChange: ({
                                value: d
                            }) => e.updateStep({
                                from_rotate: d
                            })
                        }),
                        EndInput: r(_c, {
                            id: c,
                            min: -9999,
                            max: 9999,
                            autoFocus: !0,
                            value: t.rotate,
                            onChange: ({
                                value: d
                            }) => e.updateStep({
                                rotate: d
                            })
                        }),
                        onIconClick: () => {
                            e.updateStep({
                                from_rotate: t.rotate ? ? 0,
                                rotate: t.from_rotate ? ? 0
                            })
                        }
                    })
                })
            }) : null, t.use_scale ? r(H, {
                dense: !0,
                children: r(Dy, {
                    value: "scale",
                    label: "Scale",
                    hidePostfixIcon: !0,
                    onRemove: () => e.updateStep({
                        use_scale: !1
                    }),
                    children: c => r(Uu, {
                        hideStartInput: a,
                        StartInput: r(_c, {
                            id: c,
                            min: 0,
                            max: 9999,
                            value: t.from_scale,
                            onChange: ({
                                value: d
                            }) => e.updateStep({
                                from_scale: d
                            })
                        }),
                        EndInput: r(_c, {
                            id: c,
                            min: 0,
                            autoFocus: !0,
                            max: 9999,
                            value: t.scale,
                            onChange: ({
                                value: d
                            }) => e.updateStep({
                                scale: d
                            })
                        }),
                        onIconClick: () => {
                            e.updateStep({
                                from_scale: t.scale ? ? 0,
                                scale: t.from_scale ? ? 0
                            })
                        }
                    })
                })
            }) : null]
        }, String(n))
    })
}

function Dy({
    label: e,
    children: t,
    onRemove: o,
    hidePostfixIcon: i = !1,
    disableRemoveButton: n = !1,
    value: s,
    labelColor: a
}) {
    let l = (0, ln.useId)(),
        {
            value: c,
            onChange: d,
            needToAllOpened: p
        } = (0, ln.useContext)(zz),
        {
            isHovered: h,
            ...u
        } = nr(),
        m = p || s === void 0 || c === s;

    function f() {
        m || d(s)
    }

    function g() {
        s && d(s)
    }
    return x(b, {
        display: "flex",
        flexDirection: "column",
        gap: 8,
        alignItems: "center",
        position: "relative",
        width: "100%",
        minHeight: 26,
        ...u,
        children: [x(b, {
            display: "flex",
            flexDirection: "column",
            alignItems: "center",
            width: "100%",
            children: [r(Ate, {
                htmlFor: l,
                as: "label",
                role: "button",
                cursor: "pointer",
                tabIndex: m ? -1 : 0,
                onFocus: f,
                onClick: g,
                children: r($, {
                    textStyle: "small",
                    color: a ? ? "orange",
                    width: "100%",
                    textAlign: "center",
                    children: e
                })
            }), r(wo, {
                initial: !1,
                children: m && x(Lz, {
                    width: "100%",
                    display: "flex",
                    overflow: "hidden",
                    alignItems: "center",
                    justifyContent: "center",
                    exit: {
                        height: 0
                    },
                    initial: {
                        height: 0
                    },
                    animate: {
                        height: "auto"
                    },
                    marginLeft: i ? 0 : 18,
                    children: [t(l), i ? null : r(W0, {
                        marginTop: 6,
                        width: 12,
                        height: 12,
                        color: "gray"
                    })]
                })
            })]
        }), n ? null : r(bo, {
            right: 0,
            top: 1,
            position: "absolute",
            onClick: o,
            children: r(Bi, {})
        })]
    })
}

function Uu({
    EndInput: e,
    StartInput: t,
    onIconClick: o,
    hideStartInput: i = !1
}) {
    return x(b, {
        display: "flex",
        gap: 8,
        position: "relative",
        width: "100%",
        height: 40,
        children: [i ? null : x(ln.Fragment, {
            children: [r(b, {
                position: "absolute",
                transform: "translateY(-50%)",
                top: "50%",
                right: "50%",
                textAlign: "right",
                marginRight: 10,
                children: t
            }), r(K, {
                top: "50%",
                left: "50%",
                color: "gray",
                variant: "clean",
                position: "absolute",
                onClick: o,
                transform: "translate(-50%, -50%)",
                tabIndex: -1,
                disabled: !o,
                children: r(Lz, {
                    whileHover: o ? {
                        rotate: 180
                    } : void 0,
                    children: r(Lt, {
                        transform: "rotate(-90deg)"
                    })
                })
            })]
        }), r(b, {
            top: "50%",
            left: "50%",
            textAlign: "left",
            position: "absolute",
            marginLeft: i ? 0 : 10,
            transform: `translate(${i?"-50%":"0"}, -50%)`,
            children: e
        })]
    })
}
var ln, Lz, zz, Fte, Dte, Ate, BS = k(() => {
    "use strict";
    ln = E(N());
    Li();
    oo();
    ie();
    je();
    zt();
    $e();
    Be();
    Jj();
    Nl();
    en();
    od();
    Hi();
    PI();
    Wr();
    ae();
    jn();
    La();
    ve();
    ir();
    Uv();
    Fs();
    jr();
    pi();
    B();
    Lz = wt(b);
    zz = (0, ln.createContext)({
        value: "",
        needToAllOpened: !1,
        onChange() {}
    });
    Fte = () => r($, {
        textStyle: "small",
        children: "In\xA0old browsers, B\xE9zier\xA0curves will fall\xA0back to\xA0straight\xA0lines."
    }), Dte = (e, t, o, i) => {
        let n = e.type,
            s = e.selected ? ? 0,
            a = o.length === 1 && o.includes(i.id),
            l = t.from_opacity === 0 && t.opacity === 100 || t.opacity === 0 && t.from_opacity === 100,
            c = s === 0 && l && AP.includes(n);
        return fd.includes(n) && (c = c && o.length > 0 && !a), c
    };
    Ate = ue(b)
    `
  height: 26px;
  width: 100%;
  display: flex;
  align-items: center;
  cursor: pointer;

  &:hover,
  &:focus {
    opacity: 0.8;
  }
`
});

function Oz() {
    let {
        actions: e,
        selectedInteractionSettings: t,
        openedPanel: o
    } = (0, Sc.useContext)(Fo), i = o === "steps", n = t ? .selected ? ? 0, s = (0, Sc.useMemo)(() => t ? .steps ? ? [], [t ? .steps]), a = (0, Sc.useMemo)(() => s.map((f, g) => ({
        id: g.toString()
    })), [s]), l = s.length > 1, c = md.map(f => ({
        closeOnClick: !0,
        title: f.label,
        onClick() {
            e.createStep(f.name)
        }
    })), d = (f, g, y) => {
        let S = parseInt(f),
            w = y;
        e.changeStepPosition(S, w)
    }, p = (f, g) => {
        let y = s.map(S => ({ ...S,
            loop: !1
        }));
        y[g].loop = f, e.updateInteraction({
            steps: y,
            loop: !1
        })
    }, h = (0, Sc.useMemo)(() => s.findIndex(f => f.loop === "repeat"), [s]), u = x(b, {
        width: "100%",
        display: "flex",
        alignItems: "center",
        marginLeft: l ? -7 : -24,
        color: l ? "white" : "gray",
        cursor: l ? "pointer" : "auto",
        onClick: l ? () => e.togglePanel("steps") : void 0,
        role: l ? "button" : void 0,
        children: [r(Lt, {
            transform: `rotate(${i?"0deg":"-90deg"})`
        }), r($, {
            textStyle: "small",
            children: l ? "Steps" : "Step"
        })]
    }), m = r(Ho, {
        width: 184,
        border: "none",
        zIndex: 9999,
        borderRadius: 8,
        popperOffset: [-55, 26],
        container: document.body,
        listItems: c,
        children: ({
            toggleDropdown: f
        }) => r(b, {
            display: "flex",
            alignItems: "center",
            children: r(bo, {
                display: "flex",
                justifyContent: "center",
                onClick: f,
                children: r(Qt, {})
            })
        })
    });
    return x(Sc.Fragment, {
        children: [r(H, {
            showBorder: !1,
            leftSlot: u,
            rightSlot: m
        }), x(wo, {
            initial: !1,
            onExitComplete: () => {
                !l && i && e.togglePanel("steps")
            },
            children: [!i && l ? r(Wz, {
                overflow: "hidden",
                initial: {
                    height: 0
                },
                animate: {
                    height: "auto"
                },
                exit: {
                    height: 0,
                    transition: {
                        duration: 0
                    }
                },
                children: r(H, {
                    showBorder: !1,
                    leftSlot: x(b, {
                        display: "flex",
                        alignItems: "center",
                        marginLeft: -6,
                        children: [r(bo, {
                            onClick: () => e.selectStep(n - 1),
                            children: r(yp, {})
                        }), x($, {
                            textStyle: "small",
                            color: "white",
                            lineHeight: "24px",
                            children: [n + 1, " /", " ", r(b, {
                                as: "span",
                                color: "gray",
                                children: s.length
                            })]
                        }), r(bo, {
                            onClick: () => e.selectStep(n + 1),
                            children: r(vp, {})
                        })]
                    }),
                    rightSlot: r(bo, {
                        onClick: () => e.removeStep(n),
                        children: r(Bi, {})
                    })
                })
            }, "initial") : null, i && l ? r(Wz, {
                maxHeight: 120,
                overflow: "hidden",
                exit: {
                    height: 0
                },
                initial: {
                    height: 40
                },
                animate: {
                    height: "auto"
                },
                children: r(ou, {
                    onDragEnd: d,
                    idList: a,
                    children: r(iu, {
                        dropableId: "0",
                        children: ({
                            dropElementRef: f,
                            dropableId: g
                        }) => r(xo, {
                            alwaysActiveBar: !0,
                            children: ({
                                ref: y
                            }) => r(b, {
                                ref: ep(y, f),
                                children: s.map((S, w) => r(nu, {
                                    draggableId: w.toString(),
                                    dropableId: g,
                                    children: ({
                                        ref: v
                                    }) => r(H, {
                                        ref: v,
                                        showBorder: !1,
                                        leftSlot: x(K, {
                                            width: "100%",
                                            display: "flex",
                                            variant: "clean",
                                            paddingLeft: 18,
                                            position: "relative",
                                            onClick: C => {
                                                C.defaultPrevented || e.selectStep(w)
                                            },
                                            children: [n === w ? r(Lte, {}) : null, x($, {
                                                textStyle: "small",
                                                color: "white",
                                                children: [w + 1, " /", " ", r(b, {
                                                    as: "span",
                                                    color: "gray",
                                                    children: s.length
                                                })]
                                            })]
                                        }),
                                        rightSlot: x(b, {
                                            display: "flex",
                                            gap: 4,
                                            alignItems: "center",
                                            children: [r(j0, {
                                                color: "gray",
                                                cursor: "grab",
                                                paddingRight: S.loop === "repeat" ? 28 : 0
                                            }), r(zte, {
                                                looped: S.loop === "repeat",
                                                opacity: h === -1 || h >= w ? 1 : 0,
                                                pointerEvents: h === -1 || h >= w ? "auto" : "none",
                                                height: S.loop === "repeat" ? 40 * (s.length - h) - 16 : 24,
                                                color: S.loop === "repeat" ? "white" : "gray",
                                                onClick: () => p(S.loop === "repeat" ? !1 : "repeat", w),
                                                children: S.loop === "repeat" ? r(gz, {}) : r(ju, {})
                                            }), r(bo, {
                                                onClick: () => e.removeStep(w),
                                                children: r(Bi, {})
                                            })]
                                        })
                                    }, w)
                                }, w))
                            })
                        })
                    })
                })
            }, "collapsed") : null]
        })]
    })
}
var Sc, Wz, Lte, zte, jz = k(() => {
    "use strict";
    Sc = E(N());
    ve();
    ie();
    je();
    ts();
    $e();
    Be();
    L0();
    z0();
    Nl();
    Cr();
    en();
    qj();
    or();
    Sv();
    Li();
    Wr();
    jn();
    db();
    La();
    Tm();
    Ht();
    B();
    Wz = wt(b), Lte = ue(b)
    `
  left: 3px;
  top: 50%;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  position: absolute;
  background-color: white;
  transform: translateY(-50%);
`, zte = ue(bo)
    `
  ${e=>e.looped&&Z`
      display: inline-flex;
      position: absolute;
      top: 10px;
      right: 28px;
      z-index: 1;

      &:after,
      &:before {
        content: '';
        position: absolute;
        top: 8px;
        width: 2px;
        height: calc(100% - 22px);
        background-color: white;
      }

      &:after {
        left: 0;
      }

      &:before {
        right: 0;
      }
    `}
`
});

function $te({
    referenceElement: e,
    children: t,
    isOpened: o,
    container: i,
    placement: n = "bottom",
    offset: s,
    onClickOutside: a
}) {
    let [l, c] = (0, Vu.useState)(null), d = (0, Vu.useMemo)(() => e ? e.getBoundingClientRect() : {}, [e]), {
        styles: p,
        attributes: h
    } = xa(e, l, {
        placement: n,
        modifiers: [{
            name: "offset",
            options: {
                offset: [0 + (s && s.length === 2 ? s[0] : 0), (d.height * -1 || 0) + (s && s.length ? s[1] : 0)]
            }
        }]
    }), u = f => {
        !(f.target && e && e.contains(f.target)) && a && a()
    };
    (0, Vu.useEffect)(() => (o ? window.addEventListener("click", u) : window.removeEventListener("click", u), () => {
        window.removeEventListener("click", u)
    }), [o]);
    let m = r(b, {
        backgroundColor: "white",
        width: "calc(100% + 8px + 8px)",
        paddingTop: "16px",
        paddingBottom: "16px",
        borderRadius: 4,
        borderColor: "#F0F0F0",
        boxShadow: "0 1px 2px 1px rgba(184, 184, 184, 0.16)",
        zIndex: 105,
        ref: c,
        style: p.popper,
        ...h.popper,
        children: t
    });
    return o ? i ? (0, Hz.createPortal)(m, i) : m : null
}
var Vu, Hz, Ay, MS = k(() => {
    "use strict";
    Vu = E(N()), Hz = E(gi());
    wp();
    ie();
    B();
    Ay = $te
});

function Vs({
    step: e,
    type: t,
    children: o
}) {
    let {
        selectedInteractionSettings: i
    } = (0, Nz.useContext)(Fo), n = i ? .selected || 0, s = i ? .type, a = Array.isArray(t) ? t : [t];
    return (!s || a.includes(s)) && (e === void 0 || n === e) ? r(Q, {
        children: o
    }) : null
}
var Nz, Gu = k(() => {
    "use strict";
    Nz = E(N());
    Wr();
    B()
});

function Uz() {
    let {
        selectedStepSettings: e,
        selectedInteractionSettings: t,
        actions: o
    } = (0, ps.useContext)(Fo), {
        model: i
    } = (0, ps.useContext)(Y), [n, s] = (0, ps.useState)(!1), a = (0, ps.useRef)(null), l = t ? .selected ? ? 0, c = i.block.isFixed(), d = (0, ps.useMemo)(() => mw.find(h => h.name === e.start_point), [e.start_point]), p = l === 0;
    return r(H, {
        dense: !0,
        showBorder: !1,
        children: x(b, {
            margin: "-6px -16px -8px -16px",
            ref: a,
            children: [r(Vs, {
                type: ["click", "hover", "load"],
                children: x(b, {
                    display: "flex",
                    gap: 2,
                    children: [r(Mm, {
                        postfix: "s",
                        title: "Delay",
                        threshold: 4,
                        value: e.delay ? ? 0,
                        children: h => r(fe, {
                            autoWidth: !0,
                            min: 0,
                            max: 99,
                            step: .1,
                            labelRef: h,
                            moveSpeed: 8,
                            textStyle: "subheading",
                            value: e.delay ? ? 0,
                            onChange: ({
                                value: u
                            }) => o.updateStep({
                                delay: u
                            })
                        })
                    }), r(Mm, {
                        postfix: "s",
                        title: "Duration",
                        threshold: 4,
                        value: e.duration ? ? 0,
                        children: h => r(fe, {
                            autoWidth: !0,
                            min: 0,
                            max: 99,
                            step: .1,
                            moveSpeed: 8,
                            labelRef: h,
                            title: "Duration",
                            textStyle: "subheading",
                            value: e.duration ? ? 0,
                            onChange: ({
                                value: u
                            }) => o.updateStep({
                                duration: u
                            })
                        })
                    })]
                })
            }), r(Vs, {
                type: "scroll",
                children: x(b, {
                    display: "flex",
                    gap: 2,
                    children: [p && !c ? r(Mm, {
                        title: "Start Point",
                        cursor: "pointer",
                        onClick: () => s(h => !h),
                        children: h => x(ps.Fragment, {
                            children: [r($, {
                                textStyle: "subheading",
                                letterSpacing: "-0.8px",
                                children: d ? .label ? ? "Bottom"
                            }), r(jte, {
                                offset: [0, 35],
                                isOpened: n,
                                referenceElement: h.current,
                                activePoint: d ? .name,
                                container: a.current || void 0,
                                onClickOutside: () => s(!1),
                                offsetValue: e.start_offset ? ? 0,
                                onChangeOffset: u => o.updateStep({
                                    start_offset: u
                                }),
                                onSelect: u => o.updateStep({
                                    start_point: u
                                })
                            })]
                        })
                    }) : r(Mm, {
                        title: "Delay",
                        postfix: "px",
                        threshold: 900,
                        value: e.delay_px ? ? 0,
                        children: h => r(fe, {
                            autoWidth: !0,
                            min: 0,
                            max: 9999,
                            labelRef: h,
                            moveSpeed: 1,
                            textStyle: "subheading",
                            value: e.delay_px ? ? 0,
                            onChange: ({
                                value: u
                            }) => o.updateStep({
                                delay_px: u
                            })
                        })
                    }), r(Mm, {
                        postfix: "x",
                        title: "Speed",
                        threshold: 10,
                        value: e.speed ? ? 0,
                        children: h => r(fe, {
                            autoWidth: !0,
                            min: .1,
                            max: 99,
                            step: .1,
                            moveSpeed: 8,
                            labelRef: h,
                            textStyle: "subheading",
                            value: e.speed ? ? 0,
                            onChange: ({
                                value: u
                            }) => o.updateStep({
                                speed: u
                            })
                        })
                    })]
                })
            })]
        })
    })
}

function Mm({
    title: e,
    postfix: t,
    children: o,
    threshold: i = 100,
    value: n = 100,
    ...s
}) {
    let a = (0, ps.useRef)(null),
        l = Math.min(n / i * 100, 100);
    return x(b, {
        height: 68,
        width: "100%",
        display: "flex",
        ref: a,
        alignItems: "center",
        position: "relative",
        justifyContent: "center",
        backgroundColor: "#4E4E4E",
        ...s,
        children: [x(b, {
            gap: 4,
            zIndex: 1,
            display: "flex",
            alignItems: "center",
            width: "min-content",
            flexDirection: "column",
            children: [r($, {
                textStyle: "small",
                whiteSpace: "nowrap",
                children: e
            }), x(b, {
                display: "flex",
                alignItems: "baseline",
                marginLeft: t ? 16 : 0,
                children: [typeof o == "function" ? o(a) : o, t ? r($, {
                    textStyle: "subheading",
                    opacity: .4,
                    children: t
                }) : null]
            })]
        }), r(b, {
            bottom: 0,
            width: "100%",
            position: "absolute",
            backgroundColor: "#0AAB87",
            height: `${l}%`
        })]
    })
}

function jte({
    activePoint: e,
    onChangeOffset: t,
    onSelect: o,
    offsetValue: i,
    ...n
}) {
    let s = (0, ps.useRef)(null),
        a = e === "center" ? (-i + RS / 2) / RS : i / RS;
    e === "top" && (a = -a);
    let l = `${Math.max(Math.min(a*100,e==="center"?130:116),e==="center"?-20:-30)}%`;
    return e === "bottom" ? l = `calc(${l} + 6.75px)` : e === "top" && (l = `calc(${l} + 8.75px)`), r(Ay, { ...n,
        children: x(b, {
            display: "flex",
            color: "black",
            width: 184,
            padding: "0 23px",
            flexDirection: "column",
            onClick: c => c.stopPropagation(),
            children: [x(b, {
                as: "ul",
                gap: 8,
                display: "flex",
                flexDirection: "column",
                alignItems: "center",
                position: "relative",
                marginBottom: 20,
                children: [mw.map(c => r(Wte, {
                    as: "li",
                    active: e === c.name,
                    disableLine: i !== 0,
                    children: r(Ote, {
                        textStyle: "small",
                        variant: "unstyled",
                        onClick: () => o(c.name),
                        children: c.label
                    })
                }, c.name)), i !== 0 ? r(b, {
                    left: 0,
                    height: 1,
                    width: "100%",
                    position: "absolute",
                    backgroundColor: "#0aab87",
                    top: e !== "bottom" ? l : void 0,
                    bottom: e === "bottom" ? l : void 0
                }) : null]
            }), x(b, {
                display: "flex",
                marginTop: 10,
                justifyContent: "space-between",
                color: i === 0 ? "gray" : "#0aab87",
                children: [r($, {
                    textStyle: "small",
                    children: "Offset"
                }), x(b, {
                    display: "flex",
                    children: [r(fe, {
                        autoWidth: !0,
                        max: 9999,
                        min: -9999,
                        textStyle: "small",
                        value: i,
                        labelRef: s,
                        onChange: ({
                            value: c
                        }) => t(c)
                    }), r($, {
                        ref: s,
                        textStyle: "small",
                        children: "px"
                    })]
                })]
            })]
        })
    })
}
var ps, Wte, Ote, RS, Vz = k(() => {
    "use strict";
    ps = E(N());
    ie();
    Be();
    zt();
    $e();
    MS();
    je();
    ve();
    Ht();
    Wr();
    ae();
    Gu();
    jn();
    B();
    Wte = ue(b, {
        excludeProps: ["disableLine", "active"]
    })
    `
  padding: 0 8px;
  background-color: white;
  position: relative;
  width: 100%;
  text-align: center;

  ${e=>e.active&&Z`
      color: #0aab87;
    `}

  ${e=>e.active&&!e.disableLine&&Z`
      &:before {
        content: '';
        width: 100%;
        height: 1px;
        left: 0;
        top: 10px;
        opacity: 0.24;
        position: absolute;
        background-color: ${e.theme.colors.gray};
      }
    `}
`, Ote = ue(K)
    `
  position: relative;
  z-index: 1;
  padding: 0 8px;
  background-color: white;

  &:hover {
    color: #0aab87;
  }
`, RS = 900
});

function Gz() {
    let {
        actions: e,
        selectedInteractionSettings: t,
        openedPanel: o
    } = (0, Ly.useContext)(Fo), i = o === "display-settings", s = (t ? .steps ? ? [])[0].startWhenInView, a = t ? .selected ? ? 0, l = s ? "white" : "gray";
    return s && a !== 0 && (l = "orange"), x(Ly.Fragment, {
        children: [r(H, {
            showBorder: !i,
            leftSlot: x(K, {
                width: "100%",
                color: "white",
                display: "flex",
                variant: "clean",
                textStyle: "small",
                alignItems: "center",
                justifyContent: "space-between",
                onClick: () => e.togglePanel("display-settings"),
                children: ["Display settings", i ? r(D0, {}) : r(A0, {})]
            })
        }), r(wo, {
            initial: !1,
            children: i ? x(Hte, {
                overflow: "hidden",
                animate: {
                    height: "auto"
                },
                initial: {
                    height: 0
                },
                exit: {
                    height: 0
                },
                children: [r(Vs, {
                    type: ["load"],
                    children: r(H, {
                        showBorder: !1,
                        leftSlot: r($, {
                            textStyle: "small",
                            color: l,
                            children: "Start in sight"
                        }),
                        rightSlot: r(Ve, {
                            background: "gray",
                            togglerBackground: "black",
                            backgroundChecked: "#00A882",
                            disabled: a !== 0,
                            checked: s ? ? !1,
                            onChange: c => e.updateStep({
                                startWhenInView: c
                            })
                        })
                    })
                }), x(Vs, {
                    type: ["click"],
                    children: [r(H, {
                        showBorder: !1,
                        leftSlot: r($, {
                            textStyle: "small",
                            color: t ? .resetWhenOutOfView ? "white" : "gray",
                            children: "Reset"
                        }),
                        rightSlot: x(b, {
                            display: "flex",
                            alignItems: "center",
                            children: [r(et, {
                                closeOnTargetClick: !0,
                                componentsProps: {
                                    tooltip: {
                                        width: "250px",
                                        textAlign: "center"
                                    }
                                },
                                text: "Reset the animation every time user returns to the widget, so that it starts again",
                                indent: 4,
                                children: r(b, {
                                    width: 24,
                                    display: "flex",
                                    justifyContent: "center",
                                    children: r(ed, {
                                        color: "gray"
                                    })
                                })
                            }), r(Ve, {
                                background: "gray",
                                backgroundChecked: "#00A882",
                                togglerBackground: "black",
                                checked: t ? .resetWhenOutOfView,
                                onChange: c => e.updateInteraction({
                                    resetWhenOutOfView: c,
                                    playOnce: !1
                                })
                            })]
                        })
                    }), r(H, {
                        leftSlot: r($, {
                            textStyle: "small",
                            color: t ? .playOnce ? "white" : "gray",
                            children: "Once/user"
                        }),
                        rightSlot: x(b, {
                            display: "flex",
                            alignItems: "center",
                            children: [r(et, {
                                closeOnTargetClick: !0,
                                text: "Perform animation only once per user",
                                indent: 4,
                                children: r(b, {
                                    width: 24,
                                    display: "flex",
                                    justifyContent: "center",
                                    children: r(ed, {
                                        color: "gray"
                                    })
                                })
                            }), r(Ve, {
                                background: "gray",
                                backgroundChecked: "#00A882",
                                togglerBackground: "black",
                                checked: t ? .playOnce,
                                onChange: c => e.updateInteraction({
                                    playOnce: c,
                                    resetWhenOutOfView: !1
                                })
                            })]
                        })
                    })]
                })]
            }) : null
        })]
    })
}
var Ly, Hte, Yz = k(() => {
    "use strict";
    Ly = E(N());
    ie();
    je();
    $e();
    Hi();
    Be();
    ir();
    Uv();
    Xj();
    Zj();
    Li();
    Wr();
    Gu();
    B();
    Hte = wt(b)
});

function $y({
    showBorder: e = !1,
    hoverColor: t = "white"
}) {
    let {
        current: o
    } = (0, zy.useRef)(BP());

    function i(n) {
        try {
            window.RM.constructorRouter.onPasteAnimation(n.nativeEvent)
        } catch (s) {
            console.error(s)
        }
    }
    return o ? r(ds, {
        panelProps: {
            showBorder: e
        },
        leftButtonProps: {
            onClick: i,
            hoverColor: t
        },
        leftButtonSlot: x(zy.Fragment, {
            children: ["Paste settings", r(Tf, {
                marginRight: 5
            })]
        })
    }) : null
}
var zy, ES = k(() => {
    "use strict";
    zy = E(N());
    N0();
    Md();
    jn();
    B()
});

function AS({
    point: e,
    anchorPoint: t,
    lineColor: o,
    dotColor: i,
    draggableLine: n,
    shift45: s,
    setValue: a,
    onChangeStop: l
}) {
    let c = (0, Rm.useRef)(null),
        d = (0, Rm.useRef)(0),
        p = (0, Rm.useRef)(0),
        h = (0, Rm.useRef)({
            x: 0,
            y: 0
        }),
        {
            moving: u,
            start: m
        } = Of({
            onMoveStart(f) {
                if (!c.current) return;
                let {
                    clientX: g,
                    clientY: y
                } = f, {
                    left: S,
                    top: w,
                    width: v,
                    height: C
                } = c.current.getBoundingClientRect(), {
                    x: I,
                    y: T
                } = {
                    x: t.x < e.x ? S : S + v,
                    y: t.y < e.y ? w : w + C
                }, P = DS({
                    x: g,
                    y
                }, {
                    x: I,
                    y: T
                }), M = DS(e, t);
                h.current = {
                    x: I,
                    y: T
                }, p.current = FS(P).radius, d.current = FS(M).radius
            },
            onMove: ({
                event: f
            }) => {
                let {
                    clientX: g,
                    clientY: y,
                    shiftKey: S
                } = f, w = DS({
                    x: g,
                    y
                }, h.current), v = FS(w);
                if (v.radius <= 5) return;
                s && S && (v.degrees = Math.round(v.degrees / 45) * 45);
                let C = v.radius / p.current,
                    I = {
                        degrees: v.degrees,
                        radius: Math.max(d.current, 5) * C
                    },
                    {
                        x: T,
                        y: P
                    } = Nte(I),
                    M = Ute({
                        x: T,
                        y: P
                    }, t);
                a(M)
            },
            onMoveEnd: l
        });
    return x(Q, {
        children: [u ? r(Wf, {
            children: r(Sp, {
                role: "presentation",
                backgroundColor: "transparent",
                zIndex: 99999,
                cursor: "grabbing",
                userSelect: "none"
            })
        }) : null, x("g", {
            children: [r("line", {
                x1: t.x,
                y1: t.y,
                x2: e.x,
                y2: e.y,
                stroke: o || "black",
                strokeWidth: 2,
                strokeLinecap: "round",
                shapeRendering: "geometricPrecision",
                ref: c
            }), n ? r("line", {
                x1: t.x,
                y1: t.y,
                x2: e.x,
                y2: e.y,
                stroke: "transparent",
                strokeWidth: 14,
                strokeLinecap: "round",
                shapeRendering: "geometricPrecision",
                cursor: "grab",
                onMouseDown: m
            }) : void 0, r("circle", {
                cx: e.x,
                cy: e.y,
                r: "3",
                stroke: i || "black",
                strokeWidth: 2,
                fill: "white",
                cursor: "grab",
                shapeRendering: "geometricPrecision",
                "aria-label": "Bezier curve control point",
                onMouseDown: m
            })]
        })]
    })
}
var Rm, FS, Nte, DS, Ute, Zz = k(() => {
    "use strict";
    MI();
    Vv();
    TI();
    Rm = E(N());
    B();
    FS = e => {
        let t = Math.sqrt(Math.pow(e.x, 2) + Math.pow(e.y, 2)),
            o = Math.atan2(e.y, e.x) * 180 / Math.PI;
        return {
            radius: t,
            degrees: o
        }
    }, Nte = e => {
        let t = e.degrees * Math.PI / 180;
        return {
            x: e.radius * Math.cos(t),
            y: e.radius * Math.sin(t)
        }
    }, DS = (e, t) => ({
        x: e.x - t.x,
        y: e.y - t.y
    }), Ute = (e, t) => ({
        x: e.x + t.x,
        y: e.y + t.y
    })
});

function Vte(e, t, o) {
    let i = o.x - t.x,
        n = o.y - t.y,
        s = (e.x - t.x) * i + (e.y - t.y) * n;
    if (s <= 0) return (e.x - t.x) ** 2 + (e.y - t.y) ** 2;
    if (s >= i * i + n * n) return (e.x - o.x) ** 2 + (e.y - o.y) ** 2;
    let a = {
        x: t.x + s / (i * i + n * n) * i,
        y: t.y + s / (i * i + n * n) * n
    };
    return (e.x - a.x) ** 2 + (e.y - a.y) ** 2
}

function LS(e, t, o, i) {
    let n = Vte(o, e, t),
        s = (t.x - e.x) ** 2 + (t.y - e.y) ** 2;
    if (n <= i ** 2) {
        let a = Math.max(0, Math.min(1, ((o.x - e.x) * (t.x - e.x) + (o.y - e.y) * (t.y - e.y)) / s));
        return {
            x: parseFloat((e.x + a * (t.x - e.x)).toFixed(1)),
            y: parseFloat((e.y + a * (t.y - e.y)).toFixed(1))
        }
    }
    return !1
}

function Xz(e, t, o) {
    return `M ${e.x} ${e.y} C ${t[0].x} ${t[0].y}, ${t[1].x} ${t[1].y}, ${o.x} ${o.y}`
}

function Kz(e, t) {
    let o = Math.min(e.x, t.x),
        i = Math.min(e.y, t.y),
        n = Math.abs(t.x - e.x),
        s = Math.abs(t.y - e.y);
    return {
        left: o,
        top: i,
        width: n,
        height: s
    }
}

function Wy(e, t) {
    let o = t.left + t.width,
        i = t.top + t.height;
    return e.x < t.left ? e.x = t.left : e.x > o && (e.x = o), e.y < t.top ? e.y = t.top : e.y > i && (e.y = i), e
}
var Jz = k(() => {
    "use strict"
});

function zS({
    startPoint: e,
    endPoint: t,
    curveColor: o,
    controlDotColor: i,
    controlLineColor: n,
    stickToCenter: s,
    shift45: a,
    stickThreshold: l = 4,
    lockInBox: c,
    controlPoints: d,
    draggableHandleLines: p,
    disableControlPoint: h = !1,
    onChange: u,
    onChangeStop: m,
    getFactor: f = () => 1
}) {
    let [g, y] = (0, ua.useState)(d), S = (0, ua.useMemo)(() => typeof c == "object" ? c : Kz(e, t), [c, e, t]), w = (0, ua.useMemo)(() => {
        let P = !1,
            M = !1;
        return c && (P = Wy(g[0], S), M = Wy(g[1], S)), s && (P = LS(e, t, P || g[0], l), M = LS(e, t, M || g[1], l)), [P, M]
    }, [g, e, t]);
    (0, ua.useLayoutEffect)(() => {
        y(P => Rl(d, P) ? P : d)
    }, [d]);

    function v(P, M) {
        y(F => {
            let R = [...F],
                A = f();
            return R[P] = {
                x: parseFloat((M.x / A).toFixed(1)),
                y: parseFloat((M.y / A).toFixed(1))
            }, R
        })
    }
    let C = (0, ua.useCallback)(() => {
            typeof m == "function" && m([w[0] || g[0], w[1] || g[1]])
        }, [m, w, g]),
        I = (0, ua.useCallback)(P => {
            let M = qz(P, f(), S);
            v(0, M), u ? .([M, w[1] || g[1]])
        }, [u, w[1], g[1], f, S]),
        T = (0, ua.useCallback)(P => {
            let M = qz(P, f(), S);
            v(1, M), u ? .([w[0] || g[0], M])
        }, [u, w[0], g[0], f, S]);
    return x("svg", {
        width: "100%",
        height: "100%",
        xmlns: "http://www.w3.org/2000/svg",
        overflow: "visible",
        "aria-label": "Bezier curve",
        children: [r("path", {
            d: Xz(e, [w[0] || g[0], w[1] || g[1]], t),
            fill: "transparent",
            stroke: o || "black",
            strokeWidth: 2,
            strokeLinecap: "round",
            shapeRendering: "geometricPrecision"
        }), h ? null : x(Q, {
            children: [r(AS, {
                anchorPoint: e,
                point: w[0] || g[0],
                setValue: I,
                lineColor: n,
                dotColor: i,
                draggableLine: p,
                shift45: a,
                onChangeStop: C
            }), r(AS, {
                anchorPoint: t,
                point: w[1] || g[1],
                setValue: T,
                lineColor: n,
                dotColor: i,
                draggableLine: p,
                shift45: a,
                onChangeStop: C
            })]
        })]
    })
}
var ua, qz, Qz = k(() => {
    "use strict";
    oo();
    ua = E(N());
    Zz();
    Jz();
    B();
    qz = (e, t, o) => {
        let {
            x: i,
            y: n
        } = o ? Wy(e, o) : e;
        return {
            x: parseFloat((i / t).toFixed(1)),
            y: parseFloat((n / t).toFixed(1))
        }
    }
});

function qte(e, t, o, i, n, s, a) {
    let l = e.value,
        c = Ed(l, t),
        d = e$(e, c);
    if (d === -1) return;
    let {
        start: p,
        end: h
    } = c[d], u = Number(l.substring(p, h)), m = i(s ? u - o : u + o, d).toFixed(n), f = Number(m);
    if (a) {
        let g = Rd(l, t);
        g[d] = f;
        let y = a(g),
            S = Ed(y, t)[d];
        return {
            value: y,
            numbers: g,
            ...S
        }
    } else {
        let g = l.substring(0, p) + f + l.substring(h);
        return {
            value: g,
            numbers: Rd(g, t),
            start: p,
            end: p + m.length
        }
    }
}

function eoe({
    value: e = "",
    placeholder: t,
    textStyle: o = "regular",
    mask: i = Oy.floating,
    formatter: n,
    step: s = [.01, .1],
    limits: a = {
        min: -1 / 0,
        max: 1 / 0
    },
    onChange: l,
    ...c
}, d) {
    let [p, h] = (0, ha.useState)(e), u = Array.isArray(s) ? s[0] : s, m = Array.isArray(s) ? s[1] ? ? s[0] : s, f = u % 1 !== 0 ? u.toString().split(".").pop() ? .length ? ? 0 : 0, g = Ed(p, i), y = (0, ha.useRef)(null), S = (0, ha.useRef)(void 0), w = typeof a == "function" ? a : v => Math.min(a.max, Math.max(a.min, v));
    if (y.current && !S.current) {
        let {
            selectionStart: v,
            selectionEnd: C,
            value: I
        } = y.current;
        S.current = {
            start: v,
            end: C,
            value: I
        }
    }
    return (0, ha.useLayoutEffect)(function() {
        if (!y.current || !S.current) return;
        let {
            value: v,
            ...C
        } = S.current;
        S.current = void 0;
        let I = Qte(v, p, i, C);
        I && y.current.setSelectionRange(I.start, I.end)
    }, [p]), (0, ha.useEffect)(function() {
        e !== p && h(e)
    }, [e]), x(Gte, {
        as: "span",
        textStyle: o,
        ...c,
        children: [r(Yte, {
            as: "span",
            children: p || t
        }), r(Zte, {
            value: p,
            placeholder: t,
            onKeyDown: v => {
                if (y.current) {
                    if (v.key === "Tab" && g.length > 0) v.preventDefault(), Xte(y.current, g, v.shiftKey);
                    else if (["ArrowUp", "ArrowDown"].includes(v.key) && g.length > 0) {
                        let C = v.shiftKey ? m : u,
                            I = v.key === "ArrowDown",
                            T = qte(y.current, i, C, w, f, I, n);
                        if (!T) return;
                        v.preventDefault();
                        let {
                            value: P,
                            numbers: M,
                            start: F,
                            end: R
                        } = T;
                        P !== p && (S.current = {
                            start: F,
                            end: R,
                            value: P
                        }, h(P), l({
                            value: P,
                            numbers: M
                        }))
                    } else if (["ArrowLeft", "ArrowRight"].includes(v.key) && !v.metaKey && g.length > 0) Kte(y.current, g, v.key === "ArrowLeft");
                    else if (v.key === "Enter" && n) {
                        let C = Rd(p, i),
                            I = n(C);
                        S.current = {
                            start: I.length,
                            end: I.length,
                            value: I
                        }, h(I), l({
                            value: I,
                            numbers: C
                        })
                    }
                }
            },
            onChange: ({
                currentTarget: {
                    value: v,
                    selectionStart: C,
                    selectionEnd: I
                }
            }) => {
                S.current = {
                    start: C,
                    end: I,
                    value: v
                }, h(v), l({
                    value: v,
                    numbers: Rd(v, i)
                })
            },
            onBlur: () => {
                if (S.current = void 0, typeof a != "function" && a.min === -1 / 0 && a.max === 1 / 0 && !n) return;
                let v = Jte(p, i, w, n);
                v !== p && (h(v), l({
                    value: v,
                    numbers: Rd(v, i)
                }))
            },
            onPaste: v => {
                if (!n) return;
                v.preventDefault();
                let C = v.clipboardData.getData("Text"),
                    I = Rd(C, i),
                    T = n(I);
                S.current = {
                    start: T.length,
                    end: T.length,
                    value: T
                }, h(T), l({
                    value: T,
                    numbers: I
                })
            },
            ref: ep(y, d)
        })]
    })
}
var ha, Oy, Gte, Yte, Zte, Ed, Rd, e$, Xte, Kte, Jte, Qte, $S, WS = k(() => {
    "use strict";
    ve();
    ie();
    Be();
    ha = E(N());
    Sv();
    B();
    Oy = {
        floating: /-?\d+(\.\d+)?/g,
        integer: /-?\d+/g
    }, Gte = ue(Bo, {
        label: "input-wrapper"
    })
    `
  box-sizing: content-box;
  display: block;
  position: relative;
  // Same whitespace rule as in inputs. Preserves spaces and does not wrap lines on overflow.
  white-space: pre;
`, Yte = ue(b, {
        label: "mirror"
    })
    `
  color: transparent;
  &:after {
    // NOTE: This is to ensure the hidden text takes up at least one line, even if it is empty
    content: ' ';
  }
`, Zte = ue("input", {
        label: "input"
    })
    `
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
  border: none;
  padding: 0;
  margin: 0;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
  text-align: inherit;
  color: inherit;
  background: none;
  appearance: none;
  resize: none;
  outline: none;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
  white-space: inherit;
  text-overflow: inherit;
  overflow: inherit;

  &::placeholder {
    color: ${({theme:e})=>e.colors.gray};
  }
`, Ed = (e, t) => {
        let o, i = [];
        for (; o = t.exec(e);) {
            let {
                0: n,
                index: s
            } = o;
            i.push({
                start: s,
                end: s + n.length
            })
        }
        return i
    }, Rd = (e, t) => Ed(e, t).map(({
        start: o,
        end: i
    }) => Number(e.substring(o, i))), e$ = (e, t) => {
        let {
            selectionStart: o
        } = e;
        return typeof o != "number" ? -1 : t.findIndex(i => o >= i.start && o <= i.end)
    }, Xte = (e, t, o) => {
        let i, n = e$(e, t);
        o ? i = n === 0 || n === -1 ? t[t.length - 1] : t[n - 1] : i = n < t.length - 1 ? t[n + 1] : t[0];
        let {
            start: s,
            end: a
        } = i;
        e.setSelectionRange(s, a)
    }, Kte = (e, t, o = !1) => {
        let {
            selectionStart: i,
            selectionEnd: n
        } = e;
        if (typeof i != "number" || i !== n) return -1;
        let s = t.findIndex(l => o ? i > l.start && i <= l.end : i >= l.start && i < l.end);
        if (s === -1) return;
        let a = t[s];
        setTimeout(() => e.setSelectionRange(a.start, a.end))
    }, Jte = (e, t, o, i) => {
        if (i) {
            let n = Rd(e, t).map(o);
            return i(n)
        } else return Ed(e, t).reduce((n, {
            start: s,
            end: a
        }, l) => {
            let c = Number(n.substring(s, a)),
                d = o(c, l);
            return n.substring(0, s) + d + n.substring(a)
        }, e)
    };
    Qte = (e, t, o, i) => {
        let {
            start: n,
            end: s
        } = i;
        if (typeof n != "number" || n === s) return {
            start: n,
            end: s
        };
        let a = Ed(e, o).findIndex(l => l.start === n && l.end === s);
        return a === -1 ? {
            start: n,
            end: s
        } : Ed(t, o)[a]
    };
    $S = (0, ha.forwardRef)(eoe)
});
var t$ = k(() => {
    "use strict";
    WS();
    WS()
});

function roe({
    x1: e,
    y1: t,
    x2: o,
    y2: i,
    onChange: n,
    ...s
}, a) {
    let [l, c] = (0, fl.useState)(Em([e, t, o, i]));
    (0, fl.useEffect)(() => {
        let p = ioe(l);
        Em(p) !== Em([e, t, o, i]) && c(Em([e, t, o, i]))
    }, [l, e, t, o, i]);
    let d = (0, fl.useCallback)(({
        value: p,
        numbers: [h = 0, u = 0, m = 0, f = 0]
    }) => {
        c(p), n([h, u, m, f])
    }, []);
    return r(toe, {
        height: "32px",
        ...s,
        children: r(ooe, {
            value: l,
            step: [.01, .1],
            limits: noe,
            mask: Oy.floating,
            placeholder: "0, 0, 0, 0",
            formatter: Em,
            onChange: d,
            ref: a
        })
    })
}
var fl, toe, ooe, Em, ioe, noe, o$, i$ = k(() => {
    "use strict";
    ve();
    ie();
    t$();
    fl = E(N());
    B();
    toe = ue(b, {
        label: "input-grid"
    })
    `
  display: flex;
  flex-direction: row;
  align-items: center;
  gap: 4px;
  font-size: 12px;
`, ooe = ue((0, fl.forwardRef)((e, t) => r($S, {
        textStyle: "small",
        ref: t,
        ...e
    })))
    `
  color: ${({theme:e})=>e.colors.black};
  width: 100%;
  // This overrides the reset.less input:focus::-webkit-input-placeholder rule.
  & > input:focus::placeholder {
    color: ${({theme:e})=>e.colors.gray} !important;
  }
`, Em = e => {
        let [t = 0, o = 0, i = 0, n = 0] = e;
        return [t, o, i, n].join(", ")
    }, ioe = e => {
        let [t = 0, o = 0, i = 0, n = 0] = (e.match(Oy.floating) || []).map(s => Number(s) || 0);
        return [t, o, i, n]
    }, noe = (e, t) => {
        let {
            max: o,
            min: i
        } = t === 1 || t === 3 ? {
            min: -5,
            max: 5
        } : {
            min: 0,
            max: 1
        };
        return Math.min(o, Math.max(i, e))
    };
    o$ = (0, fl.forwardRef)(roe)
});

function d$() {
    let e = (0, Ei.useRef)(),
        t = (0, Ei.useRef)(null),
        o = (0, Ei.useRef)([]),
        [i, n] = (0, Ei.useState)(null),
        [s, a] = (0, Ei.useState)(!1),
        [l, c] = (0, Ei.useState)({
            preview: "line",
            acceleration: void 0,
            preset: void 0
        }),
        {
            actions: d,
            selectedStepSettings: p
        } = (0, Ei.useContext)(Fo),
        h = () => a(!s),
        u = (C, I) => {
            e.current && clearTimeout(e.current), c({
                preview: I,
                acceleration: C,
                preset: typeof C == "string" ? C : void 0
            }), e.current = setTimeout(() => c({
                preview: "line",
                acceleration: void 0,
                preset: void 0
            }), c$ * 1e3 * 2)
        },
        m = (0, Ei.useCallback)(C => {
            let I = soe(C);
            u(I, "line"), d.updateStep({
                acceleration: I
            })
        }, [d.updateStep]),
        f = C => {
            C.preventDefault(), t.current ? .blur(), o.current.forEach(I => I.blur())
        },
        g = fw.find(C => C.name === p.acceleration),
        y = (0, Ei.useMemo)(() => a$(g ? .name || p.acceleration), [g ? .name, p.acceleration]),
        S = g ? .label ? ? "None";
    Array.isArray(p.acceleration) && (S = "Custom");
    let w = by(C => {
            u(C, "line"), d.updateStep({
                acceleration: C
            })
        }, 100),
        v = OS(g ? .name || p.acceleration);
    return x(Ei.Fragment, {
        children: [r(H, {
            ref: n,
            leftSlot: r(K, {
                textStyle: "small",
                variant: "clean",
                textAlign: "center",
                width: "100%",
                onClick: h,
                children: S
            })
        }), r(Ay, {
            referenceElement: i,
            isOpened: s,
            onClickOutside: () => a(!1),
            offset: [0, 35],
            children: r(b, {
                onClick: C => C.stopPropagation(),
                children: x(b, {
                    display: "flex",
                    padding: "0 24px",
                    flexDirection: "column",
                    children: [r(b, {
                        display: "flex",
                        flexDirection: "column",
                        width: "100%",
                        children: fw.map((C, I) => r(bo, {
                            height: 32,
                            textAlign: "left",
                            hoverColor: "black",
                            textStyle: "small",
                            onMouseEnter: () => u(C.name, "editor-and-line"),
                            color: C.name === p.acceleration ? "black" : "darkGray",
                            ref: T => o.current[I] = T,
                            onClick: () => d.updateStep({
                                acceleration: C.name
                            }),
                            children: C.label
                        }, C.name))
                    }), x(uoe, {
                        margin: "0 -24px",
                        onMouseDown: f,
                        children: [x(b, {
                            position: "relative",
                            margin: "40px 24px",
                            children: [r(b, {
                                height: 80,
                                border: "1px solid #EEE",
                                children: r(zS, {
                                    lockInBox: {
                                        left: 0,
                                        top: -1 / 0,
                                        width: Yu,
                                        height: 1 / 0
                                    },
                                    shift45: !0,
                                    stickToCenter: !0,
                                    endPoint: s$,
                                    startPoint: r$,
                                    controlPoints: y,
                                    draggableHandleLines: !0,
                                    onChange: m
                                })
                            }), l.preview === "editor-and-line" ? r(b, {
                                position: "absolute",
                                top: 1,
                                left: 1,
                                opacity: .3,
                                pointerEvents: "none",
                                children: r(zS, {
                                    disableControlPoint: !0,
                                    endPoint: s$,
                                    startPoint: r$,
                                    controlPoints: a$(l.acceleration)
                                })
                            }) : null, r(poe, {
                                cssEasing: loe(l.acceleration)
                            }, l.preset || "custom")]
                        }), r(l$, {
                            direction: "in",
                            bottom: "0"
                        }), r(l$, {
                            direction: "out",
                            top: "0"
                        })]
                    }), r(o$, {
                        x1: v[0],
                        y1: v[1],
                        x2: v[2],
                        y2: v[3],
                        onChange: w,
                        ref: t
                    })]
                })
            })
        })]
    })
}
var Ei, n$, Yu, Fd, r$, s$, jy, soe, aoe, loe, OS, a$, c$, coe, doe, poe, l$, uoe, p$ = k(() => {
    "use strict";
    Ei = E(N());
    ie();
    je();
    $e();
    MS();
    Qz();
    ve();
    Ht();
    La();
    Wr();
    jn();
    c0();
    i$();
    Q_();
    qo();
    B();
    n$ = {
        none: [0, 0, 1, 1],
        "ease-in": [.42, 0, 1, 1],
        "ease-out": [0, 0, .58, 1],
        "ease-both": [.42, 0, .58, 1],
        "ease-in-back": [.6, -.28, .74, .05],
        "ease-out-back": [.18, .89, .32, 1.27],
        "ease-both-back": [.68, -.55, .27, 1.55]
    }, Yu = 135, Fd = 80, r$ = {
        x: 0,
        y: Fd
    }, s$ = {
        x: Yu,
        y: 0
    }, jy = e => Number(e.toFixed(2)), soe = e => [jy(e[0].x / Yu), jy(1 - e[0].y / Fd), jy(e[1].x / Yu), jy(1 - e[1].y / Fd)], aoe = e => [{
        x: e[0] * Yu,
        y: Fd - e[1] * Fd
    }, {
        x: e[2] * Yu,
        y: Fd - e[3] * Fd
    }], loe = e => {
        if (e) {
            if (Array.isArray(e)) return vh.createCubicBezierFunction(e);
            if (e === "ease-in" || e === "ease-out") return e;
            if (e === "none") return "linear";
            if (e === "ease-both") return "ease-in-out";
            if (["ease-in-back", "ease-out-back", "ease-both-back"].includes(e)) {
                let t = OS(e);
                return vh.createCubicBezierFunction(t)
            }
        }
    }, OS = e => Array.isArray(e) ? e : n$[e] || n$.none, a$ = e => {
        let [t, o, i, n] = OS(e);
        return aoe([t, o, i, n])
    }, c$ = 1.3, coe = ws `
	0% {
		transform: translateY(0);
	}
	100% {
		transform: translateY(-80px);
	}
`, doe = ue(b)
    `
  position: absolute;
  width: 8px;
  height: 2px;
  right: -16px;
  bottom: 0;
  border-radius: 2px;
  background-color: ${e=>e.theme.colors.black};
  pointer-events: none;

  ${e=>e.easing&&Z`
      animation: ${coe} ${c$}s 2 ${e.easing} alternate;
    `}
`, poe = ({
        cssEasing: e
    }) => {
        let [t, o] = (0, Ei.useState)(e), {
            callback: i,
            cancel: n
        } = Je(o, 300), s = (0, Ei.useRef)(!0);
        return (0, Ei.useEffect)(() => {
            if (s.current) {
                s.current = !1;
                return
            }
            return o(void 0), i(e), n
        }, [e]), r(doe, {
            easing: t
        })
    }, l$ = ue(b, {
        label: "fade"
    })
    `
    background: ${e=>e.direction==="in"?"linear-gradient(180deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 1) 100%);":"linear-gradient(0deg, rgba(255, 255, 255, 0) 0, rgba(255, 255, 255, 1) 100%);"}
    height: 20px;
    width: 100%;
    position: absolute;
    left: 0;
    pointer-events: none;
`, uoe = ue(b, {
        label: "curve-editor"
    })
    `
  position: relative;
  overflow: hidden;
`
});

function u$() {
    let {
        actions: e,
        selectedStepSettings: t,
        selectedInteractionSettings: o
    } = (0, Fm.useContext)(Fo), i = o ? .selected ? ? 0, n = h => {
        let u = s.map(m => ({ ...m,
            loop: !1
        }));
        u[i].loop = h, e.updateInteraction({
            steps: u,
            loop: !1
        })
    }, s = (0, Fm.useMemo)(() => o ? .steps ? ? [], [o ? .steps]), a = (0, Fm.useMemo)(() => s.findIndex(h => h.loop !== !1), [s]), l = s[a], c = i > a, d = c && l ? .loop === "swing", p = c && l ? .loop === "repeat";
    return r(Vs, {
        type: ["load", "hover", "click"],
        children: r(H, {
            leftSlot: r($, {
                textStyle: "small",
                color: d || p || t.loop ? "white" : "gray",
                children: "Loop"
            }),
            rightSlot: x(b, {
                display: "flex",
                gap: 8,
                alignItems: "center",
                children: [r(et, {
                    closeOnTargetClick: !0,
                    text: "Circle",
                    indent: 4,
                    children: r(bo, {
                        height: 24,
                        disabled: p,
                        color: t.loop === "repeat" ? "white" : "gray",
                        onClick: () => {
                            n(t.loop === "repeat" ? !1 : "repeat")
                        },
                        children: r(ju, {
                            color: p ? "orange" : "inherit"
                        })
                    })
                }), r(et, {
                    closeOnTargetClick: !0,
                    text: "Reverse",
                    indent: 4,
                    children: r(bo, {
                        height: 24,
                        disabled: d,
                        color: t.loop === "swing" ? "white" : "gray",
                        onClick: () => {
                            n(t.loop === "swing" ? !1 : "swing")
                        },
                        children: r(mz, {
                            color: d ? "orange" : "inherit"
                        })
                    })
                })]
            })
        })
    })
}
var Fm, h$ = k(() => {
    "use strict";
    Fm = E(N());
    ie();
    $e();
    Be();
    ir();
    Ht();
    Tm();
    Wr();
    Gu();
    La();
    B()
});

function m$() {
    let {
        actions: e,
        selectedStepSettings: t,
        selectedInteractionSettings: o,
        preview: i
    } = (0, Hy.useContext)(Fo), n = o ? .type, s = md.map(c => {
        let d = t[c.name] === !0;
        return {
            disabled: d,
            closeOnClick: !0,
            title: c.label + (d ? " (used)" : ""),
            onClick(p) {
                p.stopPropagation(), e.addStepEffect(c.name)
            }
        }
    }), a = [t.use_move, t.use_opacity, t.use_rotate, t.use_scale].some(Boolean), l = n === "scroll" ? "Scroll to preview" : "Preview animation";
    return i && (l = "Disable preview"), x(Ql, {
        dark: !0,
        disableBorders: !0,
        children: [r(Oz, {}), r(Uz, {}), r(d$, {}), r($z, {}), r(Ho, {
            width: 184,
            border: "none",
            zIndex: 9999,
            placement: "top",
            popperOffset: [0, 30],
            container: document.body,
            listItems: s,
            children: ({
                toggleDropdown: c
            }) => r(H, {
                leftSlot: r(hoe, {
                    variant: "clean",
                    textStyle: "small",
                    color: a ? "orange" : "gray",
                    onClick: c,
                    children: r(Qt, {})
                })
            })
        }), r(u$, {}), r(Vs, {
            type: ["click", "load"],
            children: r(Gz, {})
        }), r(Dz, {}), r($y, {
            showBorder: !0
        }), r(ds, {
            panelProps: {
                showBorder: !1
            },
            leftButtonProps: {
                onClick: () => e.togglePreviewMode(),
                color: i ? "orange" : "gray"
            },
            leftButtonSlot: x(Hy.Fragment, {
                children: [l, r(xI, {})]
            })
        })]
    })
}
var Hy, hoe, f$ = k(() => {
    "use strict";
    Hy = E(N());
    je();
    Vh();
    ts();
    $e();
    Cr();
    kH();
    ve();
    Wr();
    jn();
    Az();
    BS();
    jz();
    Vz();
    Yz();
    Gu();
    ES();
    Md();
    p$();
    h$();
    B();
    hoe = ue(K)
    `
  width: 100%;
  display: flex;
  justify-content: center;
  transition: transform 0.1s ease-in-out;

  &:hover {
    transform: scale(1.2);
  }
`
});

function g$() {
    let {
        selectedInteractionSettings: e,
        actions: t,
        triggerStatus: o,
        openedPanel: i
    } = (0, gl.useContext)(Fo), {
        model: n
    } = (0, gl.useContext)(Y), s = (0, gl.useRef)(), a = ft.normalizeAnimationTriggers(e ? .trigger ? ? []), l = i === "triggers", c = o === "pending";
    Gl(() => {
        a.length > moe && s.current && s.current.scrollTo({
            top: s.current.scrollHeight,
            behavior: "smooth"
        }), a.length > 0 && st("ClickOnBurgerMenuIcon")
    }, [a.length]);
    let d = (0, gl.useMemo)(() => a.map(g => {
            let y = n.workspace.findBlock(g),
                S = y ? null : n.workspace.mag.getWidgetPage(g),
                w = S ? .id !== n.workspace.page.id,
                v = g === n.block.id,
                C;
            return v ? C = "Self" : y ? C = y.model.get("name") || y.getStandardName() : w && S ? C = `Trigger on p. ${S.attributes.num}` : C = "Trigger", {
                label: C,
                page: S ? .attributes ? .num,
                id: g
            }
        }), [a, n.block.id, n.workspace]),
        p = a.length > 0,
        h = () => {
            st(["SetAnimationTrigger"]), c ? t.leavePickTriggerMode() : t.enterPickTriggerMode()
        },
        u = (g, y) => {
            window.RM.constructorRouter.once("pageChange", S => {
                let w = S.blocks.find(v => v.id === g);
                w && w.onClick()
            }), window.RM.constructorRouter.showWorkspace({
                num: y
            })
        },
        m = x(bo, {
            width: "100%",
            display: "flex",
            textStyle: "small",
            alignItems: "center",
            hoverColor: "black",
            justifyContent: "space-between",
            color: c ? "blue" : "darkGray",
            onClick: () => h(),
            children: [c ? "Choose widget" : p ? "Add" : "Trigger", c ? r(Bi, {}) : r(Qt, {})]
        });
    return x(gl.Fragment, {
        children: [r(H, {
            showBorder: !1,
            leftSlot: p ? x(b, {
                role: "button",
                display: "flex",
                cursor: "pointer",
                marginLeft: -6,
                alignItems: "center",
                onClick: () => t.togglePanel("triggers"),
                children: [r(Lt, {
                    transform: `rotate(${l?"0deg":"-90deg"})`,
                    color: "black"
                }), r($, {
                    textStyle: "small",
                    children: "Triggers"
                })]
            }) : m
        }), r(wo, {
            initial: !1,
            children: l ? x(foe, {
                exit: {
                    height: 0
                },
                initial: {
                    height: 0
                },
                animate: {
                    height: "auto"
                },
                children: [r(b, {
                    maxHeight: 96,
                    children: r(xo, {
                        alwaysActiveBar: !0,
                        onFirstRender: g => s.current = g,
                        children: ({
                            ref: g
                        }) => r(b, {
                            ref: g,
                            children: d.map(({
                                label: y,
                                id: S,
                                page: w
                            }) => r(H, {
                                dense: !0,
                                showBorder: !1,
                                leftSlot: r(goe, {
                                    variant: "clean",
                                    textStyle: "small",
                                    role: w ? "button" : void 0,
                                    cursor: w ? "pointer" : "auto",
                                    ...t.getTriggerHoverProps(S),
                                    onClick: () => w ? u(S, w) : void 0,
                                    children: y
                                }),
                                rightSlot: r(bo, {
                                    hoverColor: "black",
                                    onClick: () => {
                                        a.length === 1 && t.togglePanel("triggers"), t.removeInteractionTrigger(S)
                                    },
                                    ...t.getTriggerHoverProps(S, !0),
                                    children: r(Bi, {})
                                })
                            }, S))
                        })
                    })
                }), a.length < DP ? r(H, {
                    dense: !0,
                    showBorder: !1,
                    leftSlot: m
                }) : null]
            }) : null
        })]
    })
}
var gl, moe, foe, goe, b$ = k(() => {
    "use strict";
    gl = E(N());
    Li();
    sd();
    ve();
    ie();
    $e();
    or();
    Be();
    Nl();
    Cr();
    en();
    wa();
    Wr();
    ae();
    La();
    jn();
    pi();
    B();
    moe = 3, foe = wt(b), goe = ue($)
    `
  width: 100%;
  &:hover {
    color: ${e=>e.theme.colors.blue};
  }
`
});

function jS({
    name: e,
    label: t,
    id: o
}) {
    let {
        selectedInteraction: i,
        actions: n,
        selectedInteractionSettings: s,
        interactions: a
    } = (0, bl.useContext)(Fo), {
        model: l
    } = (0, bl.useContext)(Y), c = e === "none", d = o ? i === e : !1;
    (0, bl.useEffect)(() => {
        e === "click" && t === "Tap" && o && st("AddTapAnimations")
    }, [e, t]);
    let p = hd(!1, l.workspace.viewport).map(h => {
        let u = !!Object.values(a).find(({
            type: m
        }) => m === h.name);
        return {
            disabled: !!u,
            closeOnClick: !0,
            title: h.label + (u ? " (used)" : ""),
            onClick() {
                n.updateInteraction({
                    type: h.name
                }, o), o && n.setSelectedInteraction(h.name)
            }
        }
    });
    return x(bl.Fragment, {
        children: [t === "Tap" && x(Q, {
            children: [r(pp, {
                position: "relative",
                top: 18,
                children: r(ao, {
                    targetSteps: ["AddTapAnimations"],
                    position: "left",
                    indent: 16,
                    children: r("div", {})
                })
            }), r(pp, {
                position: "relative",
                top: 100,
                children: r(ao, {
                    targetSteps: ["AddTapMoveAnimations"],
                    position: "left",
                    indent: 16,
                    children: r("div", {})
                })
            })]
        }), r(Ho, {
            width: 184,
            border: "none",
            zIndex: 9999,
            popperOffset: [0, 30],
            container: document.body,
            listItems: p,
            containerProps: {
                width: "100%"
            },
            children: ({
                toggleDropdown: h
            }) => r(ds, {
                panelProps: {
                    showBorder: !1
                },
                leftButtonProps: {
                    color: "black",
                    textStyle: "regular",
                    hoverColor: "black",
                    variant: "clean",
                    onClick: () => {
                        d || c ? h() : o ? n.setSelectedInteraction(e) : n.createInteraction(e), window.RM.constructorRouter.trigger("notice:triggerEduTipClose")
                    }
                },
                rightButtonProps: {
                    hoverColor: "black",
                    variant: "clean",
                    onClick: o ? () => n.removeInteraction(o) : void 0
                },
                leftButtonSlot: ({
                    isHovered: u
                }) => x(bl.Fragment, {
                    children: [t, u || !o ? d || c ? r(Lt, {
                        color: u ? "black" : "gray"
                    }) : o ? null : r(Qt, {
                        color: u ? "black" : "gray"
                    }) : null]
                }),
                rightButtonSlot: ({
                    isHovered: u
                }) => o && u ? r(Bi, {}) : null
            })
        }), d ? s ? .steps ? .length ? x(bl.Fragment, {
            children: [x(Vs, {
                type: fd,
                children: [r(pp, {
                    position: "relative",
                    top: 18,
                    children: r(ao, {
                        targetSteps: ["SetAnimationTrigger"],
                        position: "left",
                        indent: 8,
                        children: r("div", {})
                    })
                }), r(g$, {})]
            }), r(m$, {})]
        }) : r(Ez, {}) : null]
    })
}
var bl, y$ = k(() => {
    "use strict";
    bl = E(N());
    Cr();
    Nl();
    en();
    ts();
    Fz();
    f$();
    Wr();
    jn();
    b$();
    Gu();
    Md();
    ae();
    Fs();
    pi();
    m0();
    B()
});
var Xn, boe, yoe, v$, w$ = k(() => {
    "use strict";
    Xn = E(N());
    nt();
    ts();
    ie();
    Vn();
    Cr();
    jn();
    y$();
    Md();
    Wr();
    ES();
    ae();
    Fs();
    jr();
    $l();
    B();
    boe = (0, Xn.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o
        } = (0, Xn.useContext)(Y), i = hd(!1, o.workspace.viewport);
        return window.RM.constructorRouter.trigger("notice:triggerMetrics", "animationPanelOpened"), r(ao, {
            eduTips: "eduTipUseAnimation",
            position: "left",
            indent: 8,
            leaveDelay: 100,
            closeOnTargetClick: !0,
            children: x(Me, {
                enableFocusLock: !0,
                ref: t,
                style: e,
                isShowed: !0,
                children: [r(co, {
                    title: "Animate on"
                }), i.map(({
                    name: n,
                    label: s
                }) => r(jS, {
                    name: n,
                    label: s
                }, n)), r($y, {
                    hoverColor: "black"
                })]
            })
        })
    }), yoe = (0, Xn.forwardRef)(({
        style: e,
        interactions: t
    }, o) => {
        let {
            model: i
        } = (0, Xn.useContext)(Y), {
            actions: n
        } = (0, Xn.useContext)(Fo), s = (0, Xn.useMemo)(() => hd(!1, i.workspace.viewport), [i.workspace.viewport]), a = (0, Xn.useMemo)(() => s.map(d => {
            let p = Object.values(t).find(h => h.type === d.name);
            return {
                disabled: !!p,
                closeOnClick: !0,
                title: d.label + (p ? " (used)" : ""),
                onClick() {
                    n.createInteraction(d.name)
                }
            }
        }), [t, n, s]), l = hd(!0, i.workspace.viewport).reduce((d, p) => (d[p.name] = p.label, d), {}), c = (0, Xn.useMemo)(() => t.length === hd(!1, "default").length, [t.length]);
        return r(Me, {
            enableFocusLock: !0,
            clean: !0,
            ref: o,
            style: e,
            isShowed: !0,
            children: x(b, {
                display: "flex",
                gap: 2,
                flexDirection: "column",
                children: [c ? null : r(b, {
                    backgroundColor: "lightGray",
                    borderRadius: 8,
                    children: r(Ho, {
                        width: 184,
                        border: "none",
                        zIndex: 9999,
                        popperOffset: [0, 35],
                        listItems: a,
                        container: document.body,
                        children: ({
                            toggleDropdown: d
                        }) => r(ds, {
                            panelProps: {
                                showBorder: !1
                            },
                            leftButtonProps: {
                                color: "gray",
                                hoverColor: "black",
                                onClick: d,
                                textStyle: "regular"
                            },
                            leftButtonSlot: x(Xn.Fragment, {
                                children: ["Add", r(Qt, {})]
                            })
                        })
                    })
                }), t.map(({
                    UUID: d,
                    type: p
                }) => r(b, {
                    backgroundColor: "lightGray",
                    borderRadius: 8,
                    children: r(jS, {
                        id: d,
                        label: l[p],
                        name: p
                    })
                }, d))]
            })
        })
    }), v$ = (0, Xn.forwardRef)(({
        style: e
    }, t) => {
        let {
            interactions: o
        } = (0, Xn.useContext)(Fo), i = Object.values(o), n = i.length > 0;
        return r(Xn.Fragment, {
            children: n ? r(yoe, {
                ref: t,
                style: e,
                interactions: i
            }) : r(boe, {
                ref: t,
                style: e
            })
        })
    })
});

function x$(e) {
    return e.get("fixed_position") ? "fixed" : e.get("sticked") ? "sticked" : e.get("is_full_width") ? "is_full_width" : e.get("is_full_height") ? "is_full_height" : "normal"
}

function voe() {
    let {
        model: e
    } = (0, us.useContext)(Y), {
        model: t
    } = (0, us.useContext)(ge), o = $f(e.selected), i = (0, us.useRef)(!1), n = (0, us.useMemo)(() => {
        if (!e.selected || e.blocks.length === 1) return "normal";
        let l = e.blocks.reduce((c, d) => {
            let p = d.model,
                h = x$(p);
            return c === h ? c : "mixed"
        }, x$(e.blocks[0].model));
        return l === "normal" && (l = e.blocks.reduce((d, p) => d === (ft.getUuidHash(p.model.getAnimations()) || "none") ? d : "mixed", ft.getUuidHash(e.blocks[0].model.getAnimations()) || "none") === "mixed" ? "mixed-animations" : l), l
    }, [e.blocks, t.animation, e.selected]), s = (0, us.useCallback)(l => {
        l.preventDefault(), !e.disabled && (st("AddAnimations"), i.current = !1, e.select())
    }, [e.disabled]);
    (0, us.useEffect)(() => {
        function l() {
            e.selected || e.select()
        }
        return mn(["AddTapAnimations", "AddTapMoveAnimations", "SetAnimationValue", "SetAnimationTrigger"], {
            show: !e.selected
        }), e.workspace.on("paste-animation", l), () => {
            e.workspace.off("paste-animation", l)
        }
    }, [e.workspace, e.selected]), (0, us.useEffect)(() => {
        if (o && !e.selected && n === "normal" && i.current) {
            let l = ft.normalizeAnimations(t.animation ? ? []);
            e.groupSetAndSave({
                animation: l.map(c => ({ ...c,
                    UUID: be.generateUUID()
                }))
            })
        }
    }, [o, e.selected, t.animation, n]);
    let a = (0, us.useMemo)(() => ft.normalizeAnimations(t.animation ? ? []), [t.animation]);
    return r(Ie, {
        centerPanel: !0,
        control: ({
            ref: l
        }) => r(ke, {
            helpTourSteps: ["AddAnimations"],
            ref: l,
            isActive: (t.animation ? .length ? ? 0) > 0,
            label: "Animation",
            onClick: s,
            children: r(bz, {
                color: "white"
            })
        }),
        panel: ({
            ref: l,
            style: c
        }) => e.selected ? n !== "normal" ? r(Me, {
            ref: l,
            style: c,
            isShowed: e.selected,
            children: r(Mz, {
                messageType: n,
                blocks: e.blocks,
                onMerge: d => {
                    e.groupSetAndSave({
                        animation: d.model.getAnimations()
                    })
                }
            })
        }) : r(Bz, {
            value: a,
            blocks: e.blocks,
            workspace: e.workspace,
            injectedRefs: e.injectedRefs,
            onChange: d => {
                e.groupSetAndSave({
                    animation: d
                }), i.current = !0
            },
            children: r(v$, {
                ref: l,
                style: c
            })
        }) : null
    })
}
var us, _$, S$ = k(() => {
    "use strict";
    us = E(N());
    nt();
    wa();
    ae();
    Le();
    ht();
    Tm();
    Wr();
    Rz();
    w$();
    Wt();
    PI();
    pi();
    B();
    _$ = voe
});
var C$, k$ = k(() => {
    "use strict";
    ae();
    S$();
    C$ = Ce.extend({
        name: "common_interactions",
        component: _$,
        rolePermission: "BaseWidgetCanChangeAnimation"
    })
});
var I$, P$ = k(() => {
    "use strict";
    ae();
    ey();
    I$ = Ce.extend({
        name: "lottie_settings",
        component: M9
    })
});

function M$({
    manager: e,
    children: t
}) {
    return r(B$.Provider, {
        value: e,
        children: t
    })
}

function hs() {
    let e = (0, Uy.useContext)(B$);
    if (!e) throw new Error("useLottieInteractionsManager hook must be used inside LottieInteractionsProvider");
    let t = Hr(e);
    return [e, t]
}

function woe(e) {
    let t = {
        type: e,
        direction: 1,
        speed: 1
    };
    switch (t.type) {
        case "click":
        case "hover":
        case "load":
            t.delay = 0, t.loop = !1
    }
    return t
}
var Uy, Ny, B$, Cc = k(() => {
    "use strict";
    Tp();
    Uy = E(N());
    rh();
    qt();
    B();
    Ny = class {
        constructor(t) {
            _e(this, "interactions", []);
            _e(this, "currentInteraction");
            this.interactions = t || [], this.setLastInteractionAsCurrent()
        }
        setInteractions(t) {
            let o = this.currentInteraction ? .type;
            this.interactions.splice(0);
            for (let i of t) this.interactions.push(i);
            o && this.hasInteraction(o) ? this.setCurrentInteraction(o) : this.setLastInteractionAsCurrent()
        }
        createInteraction(t) {
            if (this.hasInteraction(t)) throw new Error(`Interaction of type ${t} already exists`);
            this.interactions.push(woe(t)), this.setCurrentInteraction(t), De(Fe.WidgetLottie, {
                action: "play on select",
                playOn: t
            })
        }
        deleteInteraction(t) {
            let o = this.getInteraction(t);
            if (!o) return;
            let i = this.interactions.indexOf(o);
            if (this.interactions.splice(i, 1), this.interactions.length && this.isInteractionActive(o.type)) {
                let n = this.interactions[i] || this.interactions[i - 1] || this.interactions[0];
                this.setCurrentInteraction(n.type)
            }
        }
        getInteraction(t) {
            return this.interactions.find(o => o.type === t)
        }
        setCurrentInteraction(t) {
            let o = this.getInteraction(t);
            o && (this.currentInteraction = o)
        }
        sendInteractionToTail(t) {
            let o = this.getInteraction(t);
            if (o && this.interactions.length) {
                let i = this.interactions.indexOf(o);
                this.interactions.splice(i, 1), this.interactions.push(o)
            }
        }
        setLastInteractionAsCurrent() {
            this.interactions.length && this.setCurrentInteraction(this.interactions[this.interactions.length - 1].type)
        }
        hasInteraction(t) {
            return this.interactions.some(o => o.type === t)
        }
        isInteractionActive(t) {
            return this.currentInteraction ? .type === t
        }
        changeCurrentInteractionType(t) {
            if (this.currentInteraction) {
                if (this.hasInteraction(t)) throw new Error(`Cannot change current interaction to type: ${t}. Other interaction of this type already exists.`);
                this.currentInteraction.type = t
            }
        }
        addTrigger(t) {
            if (!this.currentInteraction) return;
            Array.isArray(this.currentInteraction.triggers) || (this.currentInteraction.triggers = []), this.currentInteraction.triggers.indexOf(t) === -1 && this.currentInteraction.triggers.push(t);
            let o = this.interactions.reduce((i, n) => i + (n.triggers ? .length || 0), 0);
            De(Fe.WidgetLottie, {
                action: "add trigger",
                triggersTotal: o
            })
        }
        deleteTrigger(t) {
            if (!this.currentInteraction ? .triggers) return;
            let o = this.currentInteraction.triggers.indexOf(t);
            o > -1 && this.currentInteraction.triggers.splice(o, 1)
        }
    }, B$ = (0, Uy.createContext)(void 0)
});

function E$({
    loop: e,
    onChange: t
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: e ? "white" : "gray",
            children: "Loop"
        }),
        rightSlot: x(b, {
            display: "flex",
            gap: 8,
            alignItems: "center",
            children: [r(et, {
                closeOnTargetClick: !0,
                text: "Circle",
                indent: 4,
                children: r(K, {
                    variant: "clean",
                    color: e === "loop" ? "white" : "gray",
                    marginRight: 4,
                    onClick: () => {
                        t(e === "loop" ? !1 : "loop")
                    },
                    children: r(ju, {
                        color: e === "loop" ? "white" : "inherit"
                    })
                })
            }), r(et, {
                closeOnTargetClick: !0,
                text: "Reverse",
                indent: 4,
                children: r(K, {
                    variant: "clean",
                    color: e === "swing" ? "white" : "gray",
                    onClick: () => {
                        t(e === "swing" ? !1 : "swing")
                    },
                    children: r(fz, {
                        color: e === "swing" ? "white" : "inherit"
                    })
                })
            })]
        })
    })
}

function F$({
    count: e,
    allowInfinity: t,
    loopInfinite: o,
    onCountChange: i,
    onInfinityChange: n
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "white",
            children: "Loop count"
        }),
        rightSlot: x(b, {
            display: "flex",
            gap: 0,
            alignItems: "center",
            children: [t && r(K, {
                variant: "clean",
                color: o ? "white" : "gray",
                onClick: () => {
                    n(!o)
                },
                children: r(GI, {
                    color: "inherit"
                })
            }), r(fe, {
                autoWidth: !0,
                minWidth: 37,
                textAlign: "right",
                min: 2,
                max: 99,
                step: 1,
                moveSpeed: 8,
                textStyle: "subheading",
                value: e ? ? 2,
                color: o ? "gray" : "white",
                onChange: ({
                    value: l
                }) => {
                    i(l), n(!1)
                },
                onClick: () => n(!1)
            })]
        })
    })
}

function D$({
    direction: e = 1,
    onChange: t
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "white",
            children: "Direction"
        }),
        rightSlot: r(K, {
            variant: "clean",
            color: "white",
            transform: `scaleX(${e.toString()})`,
            onClick: () => {
                t(-e)
            },
            children: r(jI, {
                color: "white"
            })
        })
    })
}

function Gy({
    speed: e = 1,
    onChange: t
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "white",
            children: "Speed"
        }),
        rightSlot: x(b, {
            display: "flex",
            gap: 0,
            alignItems: "center",
            children: [r(fe, {
                autoWidth: !0,
                min: .1,
                max: 50,
                step: .1,
                moveSpeed: 8,
                textStyle: "subheading",
                value: e,
                onChange: ({
                    value: o
                }) => t(o)
            }), r($, {
                textStyle: "subheading",
                marginLeft: -3,
                children: "\xD7"
            })]
        })
    })
}

function A$({
    delay: e = 0,
    onChange: t
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "white",
            children: "Start delay"
        }),
        rightSlot: x(b, {
            display: "flex",
            gap: 0,
            alignItems: "center",
            children: [r(fe, {
                autoWidth: !0,
                min: 0,
                max: 99,
                step: .1,
                moveSpeed: 8,
                textStyle: "subheading",
                value: e,
                onChange: ({
                    value: o
                }) => t(o)
            }), r($, {
                textStyle: "subheading",
                marginLeft: -3,
                children: "s"
            })]
        })
    })
}

function L$({
    zone: e = "widget",
    onChange: t
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            children: "Area"
        }),
        rightSlot: r(K, {
            variant: "clean",
            onClick: () => {
                t(e === "viewport" ? "widget" : "viewport")
            },
            children: r($, {
                as: "div",
                textStyle: "small",
                whiteSpace: "nowrap",
                children: e === "viewport" ? "Whole viewport" : "Widget borders"
            })
        })
    })
}

function Soe(e) {
    let t = (HS.indexOf(e) + 1) % HS.length;
    return HS[t]
}

function z$({
    direction: e = "horizontal",
    onChange: t
}) {
    let [o, i] = (0, Dd.useState)(() => e === "radial" ? "horizontal" : e || "horizontal"), n = e === "descending" ? 45 : e === "vertical" ? 90 : e === "ascending" ? 135 : 0, [s, a] = (0, Dd.useState)(() => n), l = s % 180;
    (0, Dd.useEffect)(() => {
        n !== l && a(p => p + (n > l ? n - l : 180 - (l - n)))
    }, [n]);
    let c = (0, Dd.useRef)(null),
        d = Uf(c);
    return x(Q, {
        children: [r(H, {
            showBorder: !1,
            leftSlot: r($, {
                textStyle: "small",
                color: "white",
                children: "Move axis"
            }),
            rightSlot: r(K, {
                variant: "clean",
                onClick: () => {
                    t(e === "radial" ? o : "radial")
                },
                children: r($, {
                    as: "div",
                    textStyle: "small",
                    whiteSpace: "nowrap",
                    children: e === "radial" ? "Circular" : "Linear"
                })
            })
        }), e === "radial" ? r(b, {
            display: "flex",
            justifyContent: "center",
            paddingBottom: 8,
            children: r(YI, {})
        }) : r(b, {
            display: "flex",
            justifyContent: "center",
            paddingBottom: 8,
            children: r(b, {
                ref: c,
                width: 136,
                height: 136,
                borderRadius: "50%",
                backgroundColor: "#4E4E4E",
                display: "flex",
                justifyContent: "center",
                alignItems: "center",
                cursor: "pointer",
                onClick: () => {
                    let p = Soe(o);
                    t(p), i(p)
                },
                children: r(b, {
                    height: 34,
                    width: "100%",
                    position: "relative",
                    children: r(Coe, {
                        angle: s,
                        scale: d ? .8 : 1
                    })
                })
            })
        })]
    })
}

function Coe({
    angle: e,
    scale: t,
    ...o
}) {
    return r(b, {
        position: "absolute",
        top: 0,
        left: 0,
        height: 34,
        transform: `rotate(${e}deg) scale(${t});`,
        transition: "transform 0.1s linear, scale 0.1s linear",
        ...o,
        children: r(ZI, {})
    })
}

function Dm({
    label: e,
    percent: t,
    defaultPercent: o,
    max: i,
    min: n,
    onChange: s
}) {
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: t === o ? "gray" : "white",
            children: e
        }),
        rightSlot: x(b, {
            display: "flex",
            gap: 0,
            alignItems: "center",
            color: t === o ? "gray" : "white",
            children: [r(fe, {
                autoWidth: !0,
                min: n ? ? 0,
                max: i ? ? 100,
                step: 1,
                moveSpeed: 8,
                textStyle: "subheading",
                value: t,
                color: "inherit",
                onChange: ({
                    value: a
                }) => s(a)
            }), r($, {
                textStyle: "subheading",
                marginLeft: -3,
                color: "inherit",
                children: "%"
            })]
        })
    })
}

function $$({
    interactionType: e,
    action: t,
    onChange: o
}) {
    let i = t || i1();
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "white",
            children: o1(e)
        }),
        rightSlot: r(b, {
            display: "flex",
            gap: 0,
            alignItems: "center",
            children: r(K, {
                variant: "clean",
                onClick: () => {
                    o(i === "pause" ? "reverse" : "pause")
                },
                children: r($, {
                    as: "div",
                    textStyle: "small",
                    color: "white",
                    children: be.capitalize(i)
                })
            })
        })
    })
}
var Dd, Vy, R$, HS, Am = k(() => {
    "use strict";
    Be();
    ie();
    ir();
    je();
    $e();
    Tp();
    Tm();
    zt();
    Wt();
    Ih();
    ad();
    Dd = E(N());
    Zd();
    sd();
    B();
    Vy = ue(b)
    `
  cursor: pointer;
  &:hover {
    color: white;
  }
`, R$ = ue(b)
    `
  height: 0;
  margin: 0 16px;
  border-bottom: 2px solid rgba(162, 162, 162, 0.24);
`;
    HS = ["horizontal", "descending", "vertical", "ascending"]
});

function kc({
    allowedTypes: e,
    type: t,
    children: o,
    condition: i
}) {
    return e.includes(t) && (!(typeof i < "u") || i) ? r(Q, {
        children: o
    }) : null
}
var W$ = k(() => {
    "use strict";
    B()
});

function O$() {
    let {
        model: e
    } = (0, ms.useContext)(Y), [{
        player: t
    }] = e.useSharedState(), o = t || koe, i = Hr(o.state), [n, s] = hs(), {
        currentInteraction: a
    } = s, [l, c] = (0, ms.useState)();
    if (!a || !n.currentInteraction) return null;
    let d = a.range ? e1(a.range) : void 0;
    return (0, ms.useEffect)(() => {
        o.setRange(a.range), typeof l == "number" && o.seek(l)
    }, [a.range, l]), x(Q, {
        children: [r(Ioe, {
            player: o,
            range: a.range
        }), r(Poe, {
            totalFrames: o.state.totalFrames,
            range: d,
            onNew: () => {
                n.currentInteraction && (n.currentInteraction.range = [0, i.currentFrame === 0 ? 1 : i.currentFrame], De(Fe.WidgetLottie, {
                    action: "crop timeline"
                }))
            },
            onChange: p => {
                if (n.currentInteraction) {
                    let h = t1(p);
                    n.currentInteraction.range = h, h[1] !== a ? .range ? .[1] ? c(h[1] - h[0]) : h[0] !== a ? .range ? .[0] && c(0)
                }
            },
            onDelete: () => {
                n.currentInteraction && (n.currentInteraction.range = void 0)
            }
        }), r(NS, {
            player: o,
            range: a.range
        })]
    })
}

function j$({
    player: e,
    onCaptionClick: t,
    isActive: o
}) {
    let i = Hr(e.state);
    return r(H, {
        showBorder: !1,
        leftSlot: r(Vy, {
            onClick: t,
            color: o ? "white" : "gray",
            variant: "clean",
            children: r($, {
                color: "inherit",
                textStyle: "subheading",
                children: "Animation"
            })
        }),
        rightSlot: r(K, {
            variant: "clean",
            color: "#0AAB87",
            onClick: () => {
                i.isComplete && e.stop(), e.toggle()
            },
            children: r(b, {
                display: "flex",
                children: i.isPlaying ? r(UI, {
                    color: "inherit"
                }) : r(NI, {
                    color: "inherit"
                })
            })
        })
    })
}

function Ioe({
    player: e,
    range: t
}) {
    let [o, i] = (0, ms.useState)(!0), n = Hr(e.state), s = t ? t[0] : 0, a = o ? n.totalFrames : t ? t[1] - t[0] + 1 : n.totalFrames, l = o ? n.currentFrame + s : n.currentFrame;
    return r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "white",
            children: "Frame"
        }),
        rightSlot: x($, {
            textStyle: "small",
            color: "white",
            children: [l + 1, "/", a]
        }),
        onClick: () => {
            i(!o)
        }
    })
}

function NS({
    player: e,
    range: t,
    inactive: o = !1
}) {
    let i = Hr(e.state),
        n = 0,
        s = Math.max(i.totalFrames - 1, 0),
        a = t || [n, s],
        l = Math.max(Math.min(a[0], a[1]), n),
        c = Math.min(Math.max(a[0], a[1]), s),
        d = Math.min(Math.max(i.currentFrame + l, l), c),
        p = Math.min(l / s * 100, 100),
        h = Math.min(c / s * 100, 100),
        u = "#4E4E4E",
        m = p,
        f = Math.min(d / s * 100, 100),
        g = "#0AAB87",
        y = "rgba(112, 112, 112, 0.2)",
        S = t ? Math.min(l / s * 100, 100) : 0,
        w = t ? Math.min(c / s * 100, 100) : 0,
        v = (0, ms.useRef)(null),
        [C, I] = (0, ms.useState)(!1),
        T = (0, ms.useCallback)(P => {
            if (!C || !v.current || !P.buttons) return;
            let M = v.current.getBoundingClientRect(),
                F = M.width,
                R = P.clientX - M.left,
                A = Math.round(R / F * s) - l;
            A = Math.max(Math.min(A, c - l), 0), e.seek(A)
        }, [C, s, l, c, e]);
    return o ? r(b, {
        top: 0,
        left: 0,
        width: "100%",
        height: "40px",
        borderRadius: 8,
        position: "absolute",
        background: `linear-gradient(to right, transparent 0%, transparent ${S}%, ${y} ${S}%, ${y} ${w}%, transparent ${w}%, transparent 100%)`
    }) : x(b, {
        ref: v,
        height: 40,
        width: "100%",
        position: "relative",
        overflow: "hidden",
        marginTop: -4,
        onPointerDown: () => {
            e.pause(), I(!0)
        },
        onPointerUp: () => I(!1),
        onPointerMove: T,
        onPointerEnter: P => {
            P.buttons || I(!1)
        },
        children: [r(b, {
            top: 0,
            width: "100%",
            height: "100%",
            position: "absolute",
            background: `linear-gradient(to right, transparent 0%, transparent ${p}%, ${u} ${p}%, ${u} ${h}%, transparent ${h}%, transparent 100%)`
        }), r(b, {
            top: 0,
            width: "100%",
            height: "100%",
            position: "absolute",
            background: `linear-gradient(to right, transparent 0%, transparent ${m}%, ${g} ${m}%, ${g} ${f}%, transparent ${f}%, transparent 100%)`
        })]
    })
}

function Poe({
    range: e,
    onNew: t,
    onChange: o,
    totalFrames: i,
    onDelete: n
}) {
    let s = e || [0, i],
        a = s[0],
        l = s[1];
    return (0, ms.useEffect)(() => {
        l > i && o ? .([a, i])
    }, [i]), e ? x(H, {
        dense: !0,
        showBorder: !1,
        children: [r(b, {
            display: "flex",
            flexDirection: "column",
            gap: 8,
            alignItems: "center",
            position: "relative",
            width: "100%",
            minHeight: 26,
            children: x(b, {
                height: 26,
                width: "100%",
                display: "flex",
                alignItems: "center",
                children: [r($, {
                    textStyle: "small",
                    color: "white",
                    width: "100%",
                    textAlign: "left",
                    children: "Crop timeline"
                }), r(bo, {
                    right: 0,
                    top: 1,
                    position: "absolute",
                    onClick: n,
                    children: r(Bi, {})
                })]
            })
        }), r(b, {
            height: 40,
            display: "flex",
            children: r(Uu, {
                StartInput: r(fe, {
                    min: 1,
                    max: l - 1,
                    value: a,
                    onChange: ({
                        value: c
                    }) => o ? .([c, l])
                }),
                EndInput: r(fe, {
                    min: a + 1,
                    max: i,
                    value: l,
                    autoFocus: !0,
                    textAlign: "right",
                    onChange: ({
                        value: c
                    }) => o ? .([a, c])
                })
            })
        })]
    }) : r(H, {
        showBorder: !1,
        leftSlot: r($, {
            textStyle: "small",
            color: "gray",
            children: "Crop timeline"
        }),
        rightSlot: r(b, {
            display: "flex",
            gap: 8,
            alignItems: "center",
            children: r(K, {
                variant: "unstyled",
                color: "gray",
                onClick: t,
                css: Z `
              &:hover {
                color: white;
              }
            `,
                children: r(HI, {
                    color: "inherit"
                })
            })
        })
    })
}
var ms, koe, US = k(() => {
    "use strict";
    ie();
    ms = E(N());
    $e();
    Be();
    je();
    Cc();
    ae();
    zt();
    BS();
    La();
    Nl();
    Jf();
    rh();
    Ih();
    ad();
    Am();
    ve();
    qt();
    B();
    koe = new Yl
});

function N$({
    isFixed: e,
    isAbove: t
}) {
    let [o, i] = hs(), {
        currentInteraction: n
    } = i;
    if (!n || !o.currentInteraction) return null;
    let s = n.scrollRange ? .[0] ? ? 0,
        a = n.scrollRange ? .[1] ? ? 100,
        l = n.scrollDelay ? ? 0;
    return x(b, {
        width: "100%",
        position: "relative",
        children: [r(b, {
            padding: "0 16px 8px 16px",
            children: x($, {
                textStyle: "small",
                color: "gray",
                children: ["Sync animation with ", e ? "page" : "viewport", " height"]
            })
        }), x(hc, {
            labels: [x($, {
                textStyle: "small",
                color: "inherit",
                children: ["Counting from ", t ? "project" : "page", " top"]
            }, 0), x($, {
                textStyle: "small",
                color: "inherit",
                children: ["Relative to", r("br", {}), t ? "project" : "page", " height"]
            }, 1)],
            padding: "0 8px 8px 8px",
            initialIndex: n.scrollType === "relative" ? 1 : 0,
            backgroundColor: "rgba(112, 112, 112, 0.4)",
            activeTabColor: "rgba(112, 112, 112, 0.6)",
            textColor: "gray",
            activeTextColor: "white",
            onTabChange: c => {
                o.currentInteraction && (o.currentInteraction.scrollType = c === 1 ? "relative" : "absolute")
            },
            children: [x(Hs, {
                index: 0,
                children: [r(H, {
                    showBorder: !1,
                    leftSlot: r($, {
                        textStyle: "small",
                        color: "white",
                        children: "Start delay"
                    }),
                    rightSlot: x(b, {
                        display: "flex",
                        gap: 0,
                        alignItems: "center",
                        children: [r(fe, {
                            autoWidth: !0,
                            min: 0,
                            max: 9999,
                            step: 1,
                            moveSpeed: 4,
                            textStyle: "subheading",
                            value: l,
                            onChange: ({
                                value: c
                            }) => {
                                o.currentInteraction && (o.currentInteraction.scrollDelay = c)
                            }
                        }), r($, {
                            textStyle: "subheading",
                            marginLeft: -3,
                            children: "px"
                        })]
                    })
                }), r(Gy, {
                    speed: n.speed,
                    onChange: c => {
                        o.currentInteraction && (o.currentInteraction.speed = c)
                    }
                })]
            }), r(Hs, {
                index: 1,
                children: e ? x(Q, {
                    children: [r(Dm, {
                        label: "Trim top",
                        percent: s,
                        defaultPercent: 0,
                        min: 0,
                        max: a - 1,
                        onChange: c => {
                            o.currentInteraction && (o.currentInteraction.scrollRange = [c, a])
                        }
                    }), r(H$, {
                        range: [s, a],
                        total: 100,
                        height: 80,
                        rangeLabel: "Animation page portion"
                    }), r(Dm, {
                        label: "Trim bottom",
                        percent: 100 - a,
                        defaultPercent: 0,
                        min: 0,
                        max: 100 - s - 1,
                        onChange: c => {
                            o.currentInteraction && (o.currentInteraction.scrollRange = [s, 100 - c])
                        }
                    })]
                }) : x(Q, {
                    children: [r(Dm, {
                        label: "Trim top",
                        percent: 100 - a,
                        defaultPercent: 0,
                        min: 0,
                        max: 100 - s - 1,
                        onChange: c => {
                            o.currentInteraction && (o.currentInteraction.scrollRange = [s, 100 - c])
                        }
                    }), r(H$, {
                        range: [s, a],
                        total: 100,
                        height: 80,
                        rangeLabel: "Animation viewport",
                        inverse: !0
                    }), r(Dm, {
                        label: "Trim bottom",
                        percent: s,
                        defaultPercent: 0,
                        min: 0,
                        max: a - 1,
                        onChange: c => {
                            o.currentInteraction && (o.currentInteraction.scrollRange = [c, a])
                        }
                    })]
                })
            })]
        })]
    })
}

function H$({
    range: e,
    total: t,
    rangeLabel: o,
    inverse: i,
    children: n,
    ...s
}) {
    let a = e[0],
        l = e[1],
        c = l - a,
        d = Math.min(a / t * 100, 100),
        p = Math.min(l / t * 100, 100),
        h = "#4E4E4E";
    return r(b, {
        position: "relative",
        top: 0,
        overflow: "hidden",
        margin: "auto 8px",
        borderRadius: 8,
        backgroundColor: "#373737",
        background: `linear-gradient(${i?"to top":"to bottom"}, transparent 0%, transparent ${d}%, ${h} ${d}%, ${h} ${p}%, transparent ${p}%, transparent 100%)`,
        ...s,
        children: x(Q, {
            children: [o && c > 20 && r(b, {
                display: "flex",
                width: "100%",
                alignItems: "center",
                justifyContent: "center",
                position: "absolute",
                left: 0,
                top: `${i?100-l:a}%`,
                bottom: `${i?100-a:l}%`,
                height: `${c}%`,
                children: r($, {
                    textStyle: "small",
                    color: "rgba(255,255,255,0.4)",
                    children: o
                })
            }), n]
        })
    })
}
var U$ = k(() => {
    "use strict";
    Cc();
    Am();
    ie();
    mm();
    $e();
    Be();
    zt();
    Tp();
    B()
});

function G$() {
    let [e, t] = hs(), {
        currentInteraction: o
    } = t, {
        model: i
    } = (0, yl.useContext)(Y), {
        model: n
    } = (0, yl.useContext)(ge), [{
        player: s,
        openedInteractionSection: a = "playback"
    }, l] = i.useSharedState(), c = s || Boe, d = o ? Moe.includes(o.type) : !1;

    function p(u) {
        l({
            openedInteractionSection: u
        })
    }
    if ((0, yl.useEffect)(() => {
            o ? .loop !== void 0 && c.setPlaybackOptions({
                loop: o.loop
            })
        }, [o ? .loop]), (0, yl.useEffect)(() => {
            o ? .direction && c.setPlaybackOptions({
                direction: o.direction
            })
        }, [o ? .direction]), (0, yl.useEffect)(() => {
            o ? .speed && c.setPlaybackOptions({
                speed: o.speed
            })
        }, [o ? .speed, c]), (0, yl.useEffect)(() => {
            o && c.setPlaybackOptions({
                loopCount: o.loopInfinite ? void 0 : o.loopCount
            })
        }, [o ? .loopCount, o ? .loopInfinite, c]), !o || !e.currentInteraction) return null;
    let h = o.type === "cursor" || o.type === "scroll" && o.scrollType === "relative";
    return (0, yl.useEffect)(() => {
        e.currentInteraction && h && o.loopInfinite && (e.currentInteraction.loopInfinite = !1)
    }, [h, o.loopInfinite]), x(Ql, {
        dark: !0,
        disableBorders: !0,
        children: [r(j$, {
            player: c,
            isActive: a === "playback",
            onCaptionClick: () => p("playback")
        }), r(wo, {
            initial: !1,
            children: a === "playback" && x(VS, {
                overflow: "hidden",
                animate: {
                    height: "auto"
                },
                initial: {
                    height: 0
                },
                exit: {
                    height: 0
                },
                children: [r(O$, {}), r(kc, {
                    allowedTypes: ["click", "hover", "load", "cursor", "scroll"],
                    type: o.type,
                    children: r(D$, {
                        direction: o.direction,
                        onChange: u => {
                            e.currentInteraction && (e.currentInteraction.direction = u)
                        }
                    })
                })]
            }, "playback")
        }), x(Q, {
            children: [r(R$, {}), r(H, {
                showBorder: !1,
                leftSlot: r(Vy, {
                    variant: "clean",
                    onClick: () => p(a === "interaction" ? "playback" : "interaction"),
                    color: a === "interaction" ? "white" : "gray",
                    children: r($, {
                        color: "inherit",
                        textStyle: "subheading",
                        children: "Interaction"
                    })
                })
            })]
        }), x(wo, {
            initial: !1,
            children: [a === "interaction" && x(VS, {
                overflow: "hidden",
                animate: {
                    height: "auto"
                },
                initial: {
                    height: 0
                },
                exit: {
                    height: 0
                },
                children: [r(kc, {
                    allowedTypes: ["scroll"],
                    type: o.type,
                    children: r(N$, {
                        isFixed: !!n.fixed_position,
                        isAbove: !!n.is_above
                    })
                }), r(kc, {
                    allowedTypes: ["load"],
                    type: o.type,
                    children: r(A$, {
                        delay: o.delay,
                        onChange: u => {
                            e.currentInteraction && (e.currentInteraction.delay = u)
                        }
                    })
                }), r(kc, {
                    allowedTypes: ["click", "hover", "load"],
                    type: o.type,
                    children: r(Gy, {
                        speed: o.speed,
                        onChange: u => {
                            e.currentInteraction && (e.currentInteraction.speed = u)
                        }
                    })
                }), r(kc, {
                    allowedTypes: ["hover", "click"],
                    type: o.type,
                    children: r($$, {
                        interactionType: o.type,
                        action: o.secondAction,
                        onChange: u => {
                            e.currentInteraction && (e.currentInteraction.secondAction = u)
                        }
                    })
                }), r(kc, {
                    allowedTypes: ["cursor"],
                    type: o.type,
                    children: r(z$, {
                        direction: o.cursorDirection,
                        onChange: u => {
                            e.currentInteraction && (e.currentInteraction.cursorDirection = u)
                        }
                    })
                }), x(kc, {
                    allowedTypes: ["click", "hover", "load", "scroll", "cursor"],
                    condition: !d || o.secondAction !== "reverse",
                    type: o.type,
                    children: [r(E$, {
                        loop: o.loop,
                        onChange: u => {
                            e.currentInteraction && (e.currentInteraction.loop = u, u && (o.loopCount || (e.currentInteraction.loopInfinite = !0), (!o.loopCount || o.loopCount < 2) && (e.currentInteraction.loopCount = 2)))
                        }
                    }), o.loop && r(F$, {
                        count: o.loopCount,
                        loopInfinite: o.loopInfinite,
                        allowInfinity: !h,
                        onCountChange: u => {
                            e.currentInteraction && (e.currentInteraction.loopCount = u)
                        },
                        onInfinityChange: u => {
                            e.currentInteraction && (e.currentInteraction.loopInfinite = u)
                        }
                    })]
                })]
            }, "interaction"), r(VS, {
                overflow: "hidden",
                animate: {
                    height: "auto"
                },
                initial: {
                    height: 0
                },
                exit: {
                    height: 0
                },
                children: a !== "interaction" && r(b, {
                    height: 8
                })
            }, "spacer")]
        })]
    })
}
var yl, Boe, VS, Moe, Y$ = k(() => {
    "use strict";
    Cc();
    Vh();
    Am();
    W$();
    Tp();
    US();
    yl = E(N());
    Le();
    U$();
    Li();
    Jf();
    ae();
    ie();
    $e();
    Be();
    B();
    Boe = new Yl, VS = wt(b), Moe = ["hover", "click"]
});

function Z$() {
    let t = (0, Ic.useRef)(tf({
            isOpened: !1
        })).current,
        o = Hr(t),
        {
            model: i,
            modelSet: n
        } = (0, Ic.useContext)(Y),
        [s, a] = hs(),
        {
            currentInteraction: l
        } = a,
        {
            status: c,
            setStatus: d,
            getTriggerHoverProps: p,
            removeTrigger: h,
            getTriggerData: u
        } = Tu({
            block: i.block,
            workspace: i.workspace,
            triggers: l ? .triggers || [],
            onTriggerClick: I => {
                s.addTrigger(I)
            }
        }),
        m = c === "pending";

    function f() {
        d(m ? "idle" : "pending")
    }
    if ((0, Ic.useEffect)(() => {
            n({
                preventClose: m
            })
        }, [m]), !l) return null;
    let g = !!l.triggers ? .length;

    function y(I, T) {
        window.RM.constructorRouter.once("pageChange", P => {
            let M = P.blocks.find(F => F.id === I);
            M && M.onClick()
        }), window.RM.constructorRouter.showWorkspace({
            num: T
        })
    }
    let S = h(I => {
            s.deleteTrigger(I), i.model.trigger("animation:trigger:remove")
        }),
        w = (0, Ic.useMemo)(() => l.triggers ? .map(I => u(I)) || [], [l.triggers, u]),
        v = x(bo, {
            width: "100%",
            display: "flex",
            textStyle: "small",
            alignItems: "center",
            hoverColor: "black",
            justifyContent: "space-between",
            color: m ? "blue" : "darkGray",
            onClick: () => f(),
            children: [m ? "Choose widget" : g ? "Add" : "Trigger", m ? r(Bi, {}) : r(Qt, {})]
        }),
        C = g ? x(b, {
            role: "button",
            display: "flex",
            cursor: "pointer",
            marginLeft: -6,
            alignItems: "center",
            onClick: () => t.isOpened = !t.isOpened,
            children: [r(Lt, {
                transform: `rotate(${t.isOpened?"0deg":"-90deg"})`,
                color: "black"
            }), r($, {
                textStyle: "small",
                children: "Triggers"
            })]
        }) : v;
    return x(Q, {
        children: [r(H, {
            showBorder: !1,
            leftSlot: C
        }), r(wo, {
            initial: !1,
            children: o.isOpened && g ? x(Roe, {
                exit: {
                    height: 0
                },
                initial: {
                    height: 0
                },
                animate: {
                    height: "auto"
                },
                children: [r(b, {
                    maxHeight: 96,
                    children: r(xo, {
                        alwaysActiveBar: !0,
                        children: ({
                            ref: I
                        }) => r(b, {
                            ref: I,
                            children: w.map(({
                                label: T,
                                id: P,
                                page: M
                            }) => r(H, {
                                dense: !0,
                                showBorder: !1,
                                leftSlot: r(Eoe, {
                                    variant: "clean",
                                    textStyle: "small",
                                    role: M ? "button" : void 0,
                                    cursor: M ? "pointer" : "auto",
                                    ...p(P),
                                    onClick: () => M ? y(P, M) : void 0,
                                    children: T
                                }),
                                rightSlot: r(bo, {
                                    hoverColor: "black",
                                    onClick: () => {
                                        S(P)
                                    },
                                    ...p(P, !0),
                                    children: r(Bi, {})
                                })
                            }, P))
                        })
                    })
                }), r(H, {
                    dense: !0,
                    showBorder: !1,
                    leftSlot: v
                })]
            }) : null
        })]
    })
}
var Ic, Roe, Eoe, X$ = k(() => {
    "use strict";
    Cc();
    La();
    Nl();
    Cr();
    ie();
    en();
    Be();
    Ic = E(N());
    $e();
    oy();
    rh();
    ae();
    Li();
    or();
    ve();
    B();
    Roe = wt(b), Eoe = ue($)
    `
  width: 100%;
  &:hover {
    color: ${e=>e.theme.colors.blue};
  }
`
});

function YS({
    interaction: e,
    label: t
}) {
    let [o, i] = hs(), {
        model: n
    } = (0, K$.useContext)(Y), [{
        player: s,
        viewport: a,
        openedInteractionSection: l
    }] = n.useSharedState({
        partial: !0
    }), c = s || Foe, d = e ? .type, p = d === "load" || d === "scroll" || d === "cursor" && e ? .cursorZone === "viewport", h = Kf(a || "default").map(([y, S]) => {
        let w = i.interactions.find(v => S === v.type);
        return {
            disabled: !!w,
            closeOnClick: !0,
            title: y + (w ? " (used)" : ""),
            onClick() {
                d && !w ? o.changeCurrentInteractionType(S) : w || o.createInteraction(S)
            }
        }
    }), u = r(Ho, {
        width: 184,
        border: "none",
        zIndex: 9999,
        popperOffset: [i.isInteractionActive(d) ? 12 : 0, 30],
        container: document.body,
        listItems: h,
        containerProps: {
            width: "100%"
        },
        children: ({
            toggleDropdown: y
        }) => x(GS, {
            variant: "clean",
            color: d ? "black" : "gray",
            onClick: () => {
                !d || i.isInteractionActive(d) ? y() : i.hasInteraction(d) && o.setCurrentInteraction(d)
            },
            children: [r($, {
                children: t
            }), d ? i.isInteractionActive(d) && r(Lt, {
                color: "gray"
            }) : r(Qt, {
                color: "gray"
            })]
        })
    }), m = d ? r(K, {
        variant: "clean",
        onClick: () => o.deleteInteraction(d),
        children: r(Bi, {
            color: "gray"
        })
    }) : null, f = i.isInteractionActive(d), g = e && (!f || l !== "playback");
    return r(Q, {
        children: x(b, {
            position: "relative",
            children: [g && r(NS, {
                player: c,
                range: e ? .range,
                inactive: !0
            }), r(H, {
                showBorder: !1,
                leftSlot: u,
                rightSlot: m
            }), f ? x(Q, {
                children: [e ? .type === "cursor" && r(L$, {
                    zone: e.cursorZone,
                    onChange: y => {
                        o.currentInteraction && (o.currentInteraction.cursorZone = y)
                    }
                }), !p && r(Z$, {}), r(G$, {})]
            }) : null]
        })
    })
}
var K$, Foe, GS, J$ = k(() => {
    "use strict";
    Tp();
    ve();
    je();
    Cc();
    ts();
    Be();
    en();
    Cr();
    Nl();
    $e();
    Y$();
    X$();
    K$ = E(N());
    ae();
    Jf();
    US();
    ie();
    Am();
    Ih();
    B();
    Foe = new Yl, GS = ue(K)
    `
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
`
});
var Zu, q$, Q$, e6 = k(() => {
    "use strict";
    Zu = E(N());
    nt();
    Vn();
    Be();
    Cr();
    $e();
    Cc();
    J$();
    ie();
    ae();
    Ih();
    B();
    q$ = (0, Zu.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o
        } = (0, Zu.useContext)(Y), [{
            viewport: i
        }] = o.useSharedState(), [n] = hs();
        return x(Me, {
            ref: t,
            style: e,
            isShowed: !0,
            children: [r(co, {
                title: "Play on"
            }), Kf(i || "default").map(([s, a]) => r(H, {
                showBorder: !1,
                leftSlot: x(GS, {
                    variant: "clean",
                    color: "black",
                    onClick: () => {
                        n.createInteraction(a)
                    },
                    children: [r($, {
                        children: s
                    }), r(Qt, {
                        color: "gray"
                    })]
                })
            }, a))]
        })
    }), Q$ = (0, Zu.forwardRef)(({
        style: e
    }, t) => {
        let {
            model: o
        } = (0, Zu.useContext)(Y), [{
            viewport: i
        }] = o.useSharedState(), [, n] = hs();
        return r(Me, {
            clean: !0,
            ref: t,
            style: e,
            isShowed: !0,
            children: x(b, {
                display: "flex",
                gap: 2,
                flexDirection: "column",
                userSelect: "none",
                children: [n.interactions.length && r(b, {
                    backgroundColor: "lightGray",
                    borderRadius: 8,
                    children: r(YS, {
                        label: "Add"
                    }, "add")
                }), n.interactions.map(s => r(b, {
                    backgroundColor: "lightGray",
                    borderRadius: 8,
                    children: r(YS, {
                        interaction: s,
                        label: r1(s.type, i || "default") || ""
                    })
                }, s.type))]
            })
        })
    })
});

function Doe() {
    let {
        model: e
    } = (0, ja.useContext)(Y), [{
        player: t
    }] = e.useSharedState(), {
        model: o
    } = (0, ja.useContext)(ge), [i] = (0, ja.useState)(() => tf(new Ny(rt(o.interactions)))), {
        interactions: n
    } = Hr(i);
    (0, ja.useEffect)(() => {
        let l = pk(i.interactions, () => {
            e.groupSetAndSave({
                interactions: uk(i.interactions)
            })
        });
        return () => l()
    }, []), Va(() => {
        o.interactions && i.setInteractions(o.interactions)
    }, [o.interactions]), (0, ja.useEffect)(() => {
        e.selected || t ? .stop()
    }, [e.selected, t]);
    let s = (0, ja.useCallback)(l => {
            l.preventDefault(), !e.disabled && e.select()
        }, [e.disabled]),
        a = !!n ? .length;
    return r(M$, {
        manager: i,
        children: r(Ie, {
            control: ({
                ref: l
            }) => r(ke, {
                ref: l,
                label: "Lottie playback",
                onClick: s,
                isActive: a,
                children: r(Zf, {
                    color: "white"
                })
            }),
            panel: ({
                ref: l,
                style: c
            }) => e.selected ? n.length ? r(Q$, {
                style: c,
                ref: l
            }) : r(q$, {
                ref: l,
                style: c
            }) : null
        })
    })
}
var ja, t6, o6 = k(() => {
    "use strict";
    ja = E(N());
    ae();
    Le();
    ht();
    e6();
    Cc();
    rh();
    oo();
    sh();
    ad();
    B();
    t6 = Doe
});
var i6, n6 = k(() => {
    "use strict";
    ae();
    o6();
    i6 = Ce.extend({
        name: "lottie_interactions",
        component: t6
    })
});
var vl, Aoe, r6, s6 = k(() => {
    "use strict";
    vl = E(N());
    qo();
    ae();
    il();
    Le();
    vr();
    B();
    Aoe = (0, vl.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, vl.useContext)(Y), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, vl.useContext)(ge), c = (0, vl.useMemo)(() => i.project.get("_id"), [i]), d = (0, vl.useMemo)(() => i.user.get("_id"), [i]), {
            callback: p
        } = Je(l, 200), h = g => n({
            preventClose: g
        }), u = () => {
            a({
                anchor_link_pos: null,
                clickLink: null,
                clickPage: null,
                clickTarget: ""
            }), p()
        }, m = (0, vl.useMemo)(() => Xo(s), [s]);
        return r(cr, {
            ref: o,
            onHeightChanged: t,
            currentLinkData: m,
            projectId: c,
            userId: d,
            style: e,
            onRemoveUrl: u,
            onChange: g => {
                a(Is(g)), p()
            },
            onAnchorToggle: h,
            onToggleDropdown: h,
            onToggleSelectPanel: h,
            canShowAnchorSelector: !0,
            showStyles: !1
        })
    }), r6 = Aoe
});

function Loe() {
    let {
        model: e
    } = (0, Ad.useContext)(Y), {
        model: t
    } = (0, Ad.useContext)(ge), o = (0, Ad.useMemo)(() => Xo(t), [t.anchor_link_pos, t.clickLink, t.clickPage, t.clickTarget]), i = (0, Ad.useCallback)(n => {
        n.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: n
        }) => r(ke, {
            ref: n,
            isActive: !!o,
            label: "Link",
            onClick: i,
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: n,
            style: s,
            update: a
        }) => e.selected ? r(r6, {
            ref: n,
            style: s,
            onHeightChanged: a
        }) : null
    })
}
var Ad, a6, l6 = k(() => {
    "use strict";
    Ad = E(N());
    ae();
    ht();
    Qc();
    s6();
    Le();
    vr();
    B();
    a6 = Loe
});
var c6, d6 = k(() => {
    "use strict";
    ae();
    l6();
    c6 = Ce.extend({
        name: "lottie_link",
        component: a6,
        rolePermission: "ButtonCanChangeLink"
    })
});
var wl, zoe, p6, u6 = k(() => {
    "use strict";
    wl = E(N());
    qo();
    ae();
    il();
    Le();
    vr();
    B();
    zoe = (0, wl.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, wl.useContext)(Y), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, wl.useContext)(ge), c = (0, wl.useMemo)(() => i.project.get("_id"), [i]), d = (0, wl.useMemo)(() => i.user.get("_id"), [i]), {
            callback: p
        } = Je(l, 200), h = g => n({
            preventClose: g
        }), u = () => {
            a({
                anchor_link_pos: null,
                clickLink: null,
                clickPage: null,
                clickTarget: ""
            }), p()
        }, m = (0, wl.useMemo)(() => Xo(s), [s]);
        return r(cr, {
            ref: o,
            onHeightChanged: t,
            currentLinkData: m,
            projectId: c,
            userId: d,
            style: e,
            onRemoveUrl: u,
            onChange: g => {
                a(Is(g)), p()
            },
            onAnchorToggle: h,
            onToggleDropdown: h,
            onToggleSelectPanel: h,
            canShowAnchorSelector: !0,
            showStyles: !1
        })
    }), p6 = zoe
});

function $oe() {
    let {
        model: e
    } = (0, Pc.useContext)(Y), {
        model: t
    } = (0, Pc.useContext)(ge), o = (0, Pc.useMemo)(() => Xo(t), [t.anchor_link_pos, t.clickLink, t.clickPage, t.clickTarget]), i = (0, Pc.useCallback)(s => {
        s.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]), n = (0, Pc.useMemo)(() => e.disabled ? x(Q, {
        children: ["The link is available ", r("br", {}), "only when video controls ", r("br", {}), "are disabled"]
    }) : "Link", [e.disabled]);
    return r(Ie, {
        control: ({
            ref: s
        }) => r(ke, {
            ref: s,
            isActive: !!o,
            label: n,
            onClick: i,
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: s,
            style: a,
            update: l
        }) => e.selected ? r(p6, {
            ref: s,
            style: a,
            onHeightChanged: l
        }) : null
    })
}
var Pc, h6, m6 = k(() => {
    "use strict";
    Pc = E(N());
    ae();
    ht();
    Qc();
    u6();
    Le();
    vr();
    B();
    h6 = $oe
});
var f6, g6 = k(() => {
    "use strict";
    ae();
    m6();
    f6 = Ce.extend({
        name: "video_link",
        component: h6,
        rolePermission: "ButtonCanChangeLink"
    })
});
var xl, Woe, b6, y6 = k(() => {
    "use strict";
    xl = E(N());
    qo();
    ae();
    il();
    Le();
    vr();
    B();
    Woe = (0, xl.forwardRef)(({
        style: e,
        onHeightChanged: t
    }, o) => {
        let {
            model: i,
            modelSet: n
        } = (0, xl.useContext)(Y), {
            model: s,
            modelSet: a,
            modelSave: l
        } = (0, xl.useContext)(ge), c = (0, xl.useMemo)(() => i.project.get("_id"), [i]), d = (0, xl.useMemo)(() => i.user.get("_id"), [i]), {
            callback: p
        } = Je(l, 200), h = g => n({
            preventClose: g
        }), u = () => {
            a({
                anchor_link_pos: null,
                clickLink: null,
                clickPage: null,
                clickTarget: ""
            }), p()
        }, m = (0, xl.useMemo)(() => Xo(s), [s]);
        return r(cr, {
            ref: o,
            onHeightChanged: t,
            currentLinkData: m,
            projectId: c,
            userId: d,
            style: e,
            onRemoveUrl: u,
            onChange: g => {
                a(Is(g)), p()
            },
            onAnchorToggle: h,
            onToggleDropdown: h,
            onToggleSelectPanel: h,
            canShowAnchorSelector: !0,
            showStyles: !1
        })
    }), b6 = Woe
});

function Ooe() {
    let {
        model: e
    } = (0, Ld.useContext)(Y), {
        model: t
    } = (0, Ld.useContext)(ge), o = (0, Ld.useMemo)(() => Xo(t), [t.anchor_link_pos, t.clickLink, t.clickPage, t.clickTarget]), i = (0, Ld.useCallback)(n => {
        n.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);
    return r(Ie, {
        control: ({
            ref: n
        }) => r(ke, {
            ref: n,
            isActive: !!o,
            label: "Link",
            onClick: i,
            children: r(Sr, {
                color: "white"
            })
        }),
        panel: ({
            ref: n,
            style: s,
            update: a
        }) => e.selected ? r(b6, {
            ref: n,
            style: s,
            onHeightChanged: a
        }) : null
    })
}
var Ld, v6, w6 = k(() => {
    "use strict";
    Ld = E(N());
    ae();
    ht();
    Qc();
    y6();
    Le();
    vr();
    B();
    v6 = Ooe
});
var x6, _6 = k(() => {
    "use strict";
    ae();
    w6();
    x6 = Ce.extend({
        name: "shots_link",
        component: v6,
        rolePermission: "ButtonCanChangeLink"
    })
});

function S6(e) {
    return r("svg", {
        width: "32",
        height: "32",
        viewBox: "0 0 32 32",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        ...e,
        children: r("path", {
            d: "M24.6812 14.1859C25.141 12.824 24.9827 11.3321 24.2473 10.0933C23.1413 8.19326 20.9181 7.21574 18.7468 7.67575C17.7808 6.60198 16.393 5.99134 14.9381 6.00009C12.7186 5.99509 10.7493 7.40512 10.0665 9.48892C8.6407 9.77705 7.40998 10.6577 6.6898 11.9058C5.57563 13.8009 5.82963 16.1897 7.31814 17.8147C6.85828 19.1766 7.01664 20.6685 7.75202 21.9073C8.85796 23.8073 11.0812 24.7849 13.2526 24.3249C14.2179 25.3986 15.6063 26.0093 17.0612 25.9999C19.282 26.0055 21.2519 24.5942 21.9347 22.5086C23.3605 22.2204 24.5912 21.3398 25.3114 20.0916C26.4243 18.1966 26.1697 15.8097 24.6818 14.1846L24.6812 14.1859ZM17.0625 24.693C16.1738 24.6942 15.313 24.3874 14.6309 23.8255C14.6619 23.8092 14.7157 23.7798 14.7506 23.7586L18.7867 21.4585C18.9931 21.3429 19.1198 21.126 19.1186 20.8917V15.2772L20.8243 16.2491C20.8427 16.2578 20.8547 16.2753 20.8573 16.2953V20.9448C20.8547 23.0123 19.1578 24.6886 17.0625 24.693ZM8.90166 21.2535C8.45638 20.4948 8.29612 19.6054 8.44878 18.7422C8.47855 18.7597 8.53112 18.7916 8.56849 18.8129L12.6046 21.1129C12.8092 21.231 13.0625 21.231 13.2678 21.1129L18.1951 18.3054V20.2491C18.1963 20.2691 18.1868 20.2885 18.171 20.301L14.0912 22.6254C12.2739 23.658 9.95312 23.0442 8.9023 21.2535H8.90166ZM7.83943 12.5602C8.28282 11.8002 8.98274 11.219 9.81631 10.9171C9.81631 10.9514 9.81441 11.0121 9.81441 11.0546V15.6553C9.81314 15.8891 9.93982 16.1059 10.1457 16.2216L15.073 19.0285L13.3672 20.0004C13.3501 20.0116 13.3286 20.0135 13.3096 20.0054L9.22914 17.6791C7.41568 16.6428 6.79368 14.3534 7.8388 12.5609L7.83943 12.5602ZM21.8543 15.7784L16.927 12.9709L18.6327 11.9996C18.6498 11.9883 18.6714 11.9865 18.6904 11.9946L22.7708 14.319C24.5874 15.3547 25.2101 17.6478 24.1605 19.4404C23.7165 20.1991 23.0172 20.7804 22.1843 21.0829V16.3447C22.1862 16.1109 22.0601 15.8947 21.8549 15.7784H21.8543ZM23.5518 13.2571C23.522 13.239 23.4695 13.2077 23.4321 13.1865L19.396 10.8864C19.1914 10.7683 18.938 10.7683 18.7328 10.8864L13.8055 13.694V11.7502C13.8043 11.7302 13.8138 11.7108 13.8296 11.6983L17.9094 9.37579C19.7266 8.34139 22.05 8.95703 23.0976 10.7508C23.5404 11.5083 23.7006 12.3952 23.5505 13.2571H23.5518ZM12.8782 16.7216L11.1718 15.7497C11.1534 15.7409 11.1414 15.7234 11.1389 15.7034V11.054C11.1401 8.98391 12.8421 7.30637 14.94 7.30762C15.8274 7.30762 16.6863 7.61513 17.3685 8.17514C17.3374 8.19139 17.2842 8.22077 17.2487 8.24202L13.2126 10.5421C13.0062 10.6577 12.8795 10.8739 12.8807 11.1083L12.8782 16.7203V16.7216ZM13.8049 14.7503L15.9997 13.4996L18.1944 14.7497V17.2503L15.9997 18.5004L13.8049 17.2503V14.7503Z",
            fill: "currentColor"
        })
    })
}
var C6 = k(() => {
    "use strict";
    B()
});
async function Act(e) {
    return Gt.post("/api/ai-seo", {
        text: e
    })
}
async function k6(e) {
    return Gt.post("/api/ai-seo-optimize", {
        text: e
    })
}
async function I6(e, t) {
    return Gt.post("/api/ai-translate-blocks", {
        blocks: e,
        language: t
    })
}
async function P6(e, t) {
    return Gt.post("/api/ai-adjust-length", {
        text: e,
        change: t
    })
}
var ZS, T6 = k(() => {
    "use strict";
    Xd();
    ZS = (l => (l.English = "English", l.French = "French", l.German = "German", l.Italian = "Italian", l.Portuguese = "Portuguese", l.Russian = "Russian", l.Spanish = "Spanish", l))(ZS || {})
});

function joe() {
    let {
        model: e
    } = (0, fs.useContext)(Y), [t, o] = (0, fs.useState)(), [i, n] = (0, fs.useState)(), [s] = (0, fs.useState)(() => h().map(w => ({
        id: w.model.attributes._id,
        text: mg(w.model)
    }))), [a, l] = (0, fs.useState)(), c = (0, fs.useRef)(!0), d = e.blocks.length > 1;
    (0, fs.useEffect)(() => () => {
        c.current = !1
    }, []);
    let p = (0, fs.useCallback)(w => {
        w.preventDefault(), !e.disabled && e.select()
    }, [e.disabled]);

    function h() {
        return e.blocks.filter(w => w.model.attributes.type === "text") || []
    }

    function u() {
        i && i()
    }

    function m(w) {
        if (!c.current) return;
        let v = [],
            C = [];
        e.groupSetAndSave(I => {
            let T = I.model.attributes.blocks,
                P = w.find(M => M.id === I.model.attributes._id);
            return !P || I.model.attributes.type !== "text" ? {} : (v.push({
                id: I.model.attributes._id,
                attributes: rt(I.model.attributes)
            }), I.model.set("blocks", [{ ...T[0],
                text: P.text
            }], {
                skipHistory: !0,
                toHistory: !1
            }), C.push(I), {
                blocks: [{ ...T[0],
                    text: P.text
                }],
                h: Hoe(I)
            })
        });
        for (let I of C) I.refreshState();
        l(I => I || v)
    }

    function f() {
        if (!a || !e.block ? .model) return;
        let w = [];
        e.groupSetAndSave(v => {
            let C = a.find(I => I.id === v.model.attributes._id);
            return !C || v.model.attributes.type !== "text" ? {} : (w.push(v), C.attributes)
        });
        for (let v of w) v.refreshState();
        l(void 0)
    }
    async function g() {
        if (s) {
            o("optimize");
            try {
                let w = s[0],
                    v = await k6(w.text);
                m([{
                    id: w.id,
                    text: v.optimizedText
                }]), n(() => g)
            } catch (w) {
                console.error(w)
            } finally {
                o(void 0)
            }
        }
    }
    async function y(w) {
        if (s) {
            o("translate");
            try {
                let v = await I6(s, w);
                m(v), n(() => () => y(w))
            } catch (v) {
                console.error(v)
            } finally {
                o(void 0)
            }
        }
    }
    async function S(w) {
        if (s) {
            o(w);
            try {
                let v = s[0],
                    C = await P6(v.text, w);
                m([{
                    id: v.id,
                    text: C.adjustedText
                }]), n(() => () => S(w))
            } catch (v) {
                console.error(v)
            } finally {
                o(void 0)
            }
        }
    }
    return r(Ie, {
        control: ({
            ref: w
        }) => r(ke, {
            ref: w,
            label: "Edit with AI",
            onClick: p,
            children: r(S6, {
                color: "white"
            })
        }),
        panel: ({
            ref: w,
            style: v
        }) => x(Me, {
            ref: w,
            style: v,
            isShowed: e.selected,
            children: [r(H, {
                leftSlot: r($, {
                    children: "Edit with AI"
                })
            }), r(Yy, {
                label: "Make shorter",
                disabled: !!t || d,
                inProgress: t === "shorter",
                onClick: () => S("shorter")
            }), r(Yy, {
                label: "Make longer",
                disabled: !!t || d,
                inProgress: t === "longer",
                onClick: () => S("longer")
            }), r(Yy, {
                label: "Optimize for SEO",
                onClick: g,
                disabled: !!t || d,
                inProgress: t === "optimize"
            }), r(Yy, {
                label: "Fit text container",
                disabled: !0,
                inProgress: t === "fit"
            }), r(es, {
                text: "Translate to",
                showBorder: !1,
                disabled: !!t,
                items: Object.keys(ZS).map(C => ({
                    label: C,
                    value: C
                })),
                value: void 0,
                onSelect: C => {
                    y(C.value)
                },
                rightIcon: t === "translate" ? r(_o, {
                    bgColor: "transparent",
                    color: "gray",
                    size: 16
                }) : void 0
            }), a && x(b, {
                padding: 8,
                children: [r(B6, {
                    variant: "clean",
                    disabled: !i || t,
                    onClick: u,
                    children: r($, {
                        textStyle: "small",
                        children: "Try again"
                    })
                }), r(B6, {
                    variant: "clean",
                    marginTop: 8,
                    disabled: !a || t,
                    onClick: f,
                    children: r($, {
                        textStyle: "small",
                        children: "Reset"
                    })
                })]
            }), r($, {
                display: "block",
                textStyle: "small",
                color: "gray",
                padding: 16,
                paddingBottom: 8,
                children: "Remember that ChatGPT is just an AI"
            })]
        })
    })
}

function Yy({
    onClick: e,
    label: t,
    noBorder: o,
    disabled: i,
    inProgress: n
}) {
    return r(H, {
        showBorder: !o,
        leftSlot: r(K, {
            variant: "clean",
            display: "block",
            onClick: e,
            disabled: i || n,
            children: r($, {
                textStyle: "small",
                children: t
            })
        }),
        rightSlot: n ? r(_o, {
            bgColor: "transparent",
            color: "gray",
            size: 16
        }) : null
    })
}

function Hoe(e) {
    return e.isAutosizeEnabled() ? e.getRealContentHeight(!0) : e.model.attributes.h
}
var fs, B6, M6, R6 = k(() => {
    "use strict";
    fs = E(N());
    nt();
    ht();
    Be();
    ae();
    C6();
    $e();
    je();
    yd();
    ie();
    Zd();
    Bs();
    $p();
    T6();
    oo();
    B();
    B6 = ue(K)
    `
  border: 1px solid rgba(162, 162, 162, 0.24);
  height: 40px;
  width: 100%;
  border-radius: 8px;
`;
    M6 = joe
});
var E6, F6 = k(() => {
    "use strict";
    ae();
    R6();
    E6 = Ce.extend({
        name: "text_ai",
        component: M6
    })
});

function D6(e) {
    return e[XS] = !0, e
}

function rdt(e, t) {
    e[XS] && (t.scrollIntoView({
        behavior: "smooth"
    }), delete e[XS])
}
var XS, A6 = k(() => {
    "use strict";
    XS = "__scrollable"
});

function Noe() {
    let {
        model: e
    } = (0, Xu.useContext)(Y), [t, o] = (0, Xu.useState)(!1), i = e.workspace, n = (0, Xu.useCallback)(async a => {
        if (a.preventDefault(), !window.RM.constructorRouter.me ? .get("permissions") ? .can_add_my_presets) {
            Jo("add-preset");
            return
        }
        let l = i.getSelectedBlocks();
        o(!0);
        let c = Qg({
            blocks: l,
            mag: i.mag,
            page: i.page,
            workspace: i,
            indexController: s.indexController,
            type: "project"
        });
        if (c) try {
            let d = await I2(c, {
                projectId: i.mag.get("_id"),
                ownerId: i.mag.user.get("_id")
            });
            Gg("project", [D6(d)]), o(!1), rx({
                name: "widget-selector",
                payload: {
                    nestedPanel: "presets",
                    addedPreset: d._id
                }
            }), De(Fe.PresetSave)
        } catch {
            o(!1)
        }
    }, [e.disabled, e.selected]), s = window.RM.constructorRouter;
    return r(Ie, {
        control: ({
            ref: a
        }) => r(ke, {
            ref: a,
            label: "Save to Presets",
            onClick: n,
            children: t ? r(_o, {
                color: "white",
                size: 16,
                bgColor: "transparent"
            }) : r(E0, {})
        })
    })
}
var Xu, L6, z6 = k(() => {
    "use strict";
    Xu = E(N());
    Ht();
    Bs();
    td();
    qt();
    ae();
    Vg();
    Qw();
    ht();
    vx();
    ax();
    Xs();
    A6();
    B();
    L6 = Noe
});
var $6, W6 = k(() => {
    "use strict";
    ae();
    z6();
    $6 = Ce.extend({
        name: "my_preset",
        rolePermission: "CanUsePresets",
        component: L6
    })
});
var O6 = {};
EC(O6, {
    default: () => Uoe
});
var Uoe, j6 = k(() => {
    "use strict";
    UP();
    ZP();
    qP();
    FM();
    a4();
    m4();
    v4();
    $4();
    H4();
    J4();
    oE();
    sE();
    pE();
    bE();
    xE();
    $E();
    jE();
    VE();
    MF();
    AF();
    $F();
    HF();
    gA();
    wA();
    RA();
    VA();
    i9();
    l9();
    u9();
    f9();
    T9();
    z9();
    o3();
    n3();
    s3();
    l3();
    d3();
    u3();
    b3();
    v3();
    x3();
    S3();
    k3();
    H3();
    U3();
    G3();
    Z3();
    lL();
    SL();
    DL();
    OL();
    YL();
    QL();
    l5();
    u5();
    y5();
    C5();
    E5();
    z5();
    U5();
    t8();
    C8();
    tz();
    uz();
    k$();
    P$();
    n6();
    d6();
    g6();
    _6();
    F6();
    W6();
    Uoe = {
        common_layer: NP,
        common_pack: YP,
        common_unpack: JP,
        common_rotation: pz,
        common_position: S8,
        readymag_preset: EM,
        text_typography: s4,
        text_align: h4,
        anchor_picker: y4,
        text_link: z4,
        text_color: j4,
        text_columns: K4,
        text_edit: tE,
        picture_crop: rE,
        picture_fwpos: dE,
        picture_link: gE,
        picture_color: wE,
        picture_settings: zE,
        slideshow_manager: OE,
        shape_color: UE,
        shape_settings: BF,
        shape_1x1: DF,
        shape_icon: zF,
        gmaps_edit: jF,
        gmaps_settings: fA,
        button_edit: vA,
        button_settings: MA,
        hotspot_pin_settings: UA,
        hotspot_tip_settings: o9,
        form_content: a9,
        form_captcha: p9,
        form_endpoints: m9,
        form_styles: P9,
        video_settings: L9,
        video_controls: t3,
        video_link: f6,
        twitter_settings: i3,
        facebook_settings: r3,
        iframe_edit: a3,
        cart_connections: c3,
        cart_settings: p3,
        cart_add_product_widget: g3,
        product_selector: y3,
        add_to_cart_settings: w3,
        slideshow_settings: _3,
        slideshow_transitions: C3,
        picture_alt: j3,
        shape_alt: N3,
        slideshow_alt: V3,
        rmheader_settings: Y3,
        text_advanced_typography: aL,
        shots_settings: _L,
        playback_settings: FL,
        text_insert: WL,
        icon_settings: GL,
        button_link: qL,
        common_shadow: a5,
        text_shadow: p5,
        shape_link: b5,
        audio_settings: S5,
        common_cursor: R5,
        common_draggable: L5,
        lightbox: N5,
        common_align: e8,
        common_arrange: ez,
        common_interactions: C$,
        lottie_settings: I$,
        lottie_interactions: i6,
        lottie_link: c6,
        text_ai: E6,
        my_preset: $6,
        shots_link: x6
    }
});
var H6, Yi, N6, Pe, U6, Voe, Zy, me, Ro = k(() => {
    "use strict";
    H6 = E(N()), Yi = E(Ze());
    Oc();
    N6 = E(To()), Pe = E(ze());
    G1();
    ag();
    lP();
    Wt();
    Yd();
    wa();
    fP();
    On();
    Pj();
    yr();
    En();
    Or();
    $p();
    Nc();
    Zr();
    U6 = E(gi());
    wv();
    Nr();
    Ml();
    pi();
    $l();
    Ya();
    bg();
    Ht();
    jn();
    yw();
    Voe = {
        addToSelection: function() {},
        onDragStart: function() {},
        onDragMove: function() {},
        moveBottomBlocks: function() {},
        resizeBlocks: function() {},
        moveBlocks: function() {},
        onDragEnd: function() {},
        clone: function() {}
    }, Zy = N6.default.View.extend({
        SUPER_SMALL_TRESHOLD: 10,
        SMALL_TRESHOLD: 16,
        PIXELS_TO_ACTIVATE_DRAG: 3,
        MAX_Z_INDEX: 2e3,
        TOOLTIP_OFFSET: 16,
        outofbox: !1,
        excludedFromLib: !1,
        immortal: !1,
        template: null,
        events: {},
        controls: ["common_interactions", "common_position", "common_layer"],
        settingsOnCreate: !0,
        defaults: void 0,
        _showFrameBorder: !0,
        initialize: function(e, t) {
            this.initBlock(e, t)
        },
        initBlock: function(e, t) {
            window.RM.constructorRouter.me ? .get("permissions") ? .can_add_preset && (this.initial_controls && !this.initial_controls.includes("readymag_preset") ? this.initial_controls.push("readymag_preset") : this.controls.includes("readymag_preset") || this.controls.push("readymag_preset")), so.isPermissionAllowed("BaseWidgetCanChangeCoordinates") || Pe.default.extend(this, {}, Voe), Pe.default.bindAll(this), this.model = e, this.workspace = t, Object.defineProperty(this, "attributes", {
                value: this.attributes,
                configurable: !1
            });
            let [o, i, n, s] = er(this.initialSharedState || this.getInitialSharedState());
            this._useSharedState = o, this.nonReactGetSharedState = n, this.nonReactSetSharedState = (a, l = {
                partial: !1
            }) => {
                l.partial ? i({ ...n(),
                    ...a
                }) : i(a)
            }, this.unsubscribeSharedState = s(this.onSharedStateChange), this.isLoading = !1, this.selected = !1, this.forbidVisualRotation = !1, this.triggerAssets = {}, e.get("hidden") && this.triggerReady(), this.workspace.on("deselect", this.deselect.bind(this)), this.model.on("change", this.onModelChange), this.model.on("change:pack_id", this.onPackChange), this.model.on("change:is_locked", this.updateLockDragState), this.model.on("change:hidden", this.onBlockVisibilityChange), this.model.on("change:fixed_position", this.onFixPosition), bt.on("index:changed", this.onIndexChange), this.workspace.page.on("change:viewport", this.onIndexChange), this.on("select", this.onIndexChange), this.on("deselect", this.onIndexChange), this.listenTo(this.model, "animation:trigger:add", this.onAnimationTriggerAdd), this.listenTo(this.model, "animation:trigger:remove", this.onAnimationTriggerRemove), this.listenTo(this.model, "animation:type:change", this.resetAnimationTriggers), this.latestPosSizeAngle = this.getModelBox(), this.getStickedSide() && (this.latestPosSizeAngle.sticked_margin = this.calcStickedMargin(this.latestPosSizeAngle)), this.$document = (0, Yi.default)(document), Pe.default.extend(this.latestPosSizeAngle, Rt.calcBoundingBox(this.latestPosSizeAngle)), this.has_parent_block = !!this.model.get("parent_wid"), this.hide_rotate_controls = ["hotspot"].includes(this.model.get("type")), this.saveBoxDebounced = Pe.default.debounce(this.saveBox, 300)
        },
        initialSharedState: null,
        getInitialSharedState: function() {
            return {}
        },
        useSharedState: function({
            partial: e = !0,
            group: t = !1
        } = {}) {
            let [o] = this._useSharedState(), i = a => {
                let l = t ? a[0] : a,
                    c = this.nonReactGetSharedState(),
                    d = { ...c,
                        ...l
                    };
                return this.nonReactSetSharedState(this.beforeSharedStateUpdate ? this.beforeSharedStateUpdate({
                    oldState: c,
                    newState: d
                }) : d)
            }, n = a => {
                let l = t ? a[0] : a,
                    c = this.nonReactGetSharedState();
                return this.nonReactSetSharedState(this.beforeSharedStateUpdate ? this.beforeSharedStateUpdate({
                    oldState: c,
                    newState: l
                }) : l)
            };
            return [(0, H6.useMemo)(() => t ? [o] : o, [o, t]), e ? i : n]
        },
        render: function() {
            this.create()
        },
        triggerReady: function() {
            this.model.triggerReady()
        },
        onSharedStateChange: function(e) {
            bt.trigger("block:sharedStateChange", {
                block: this,
                sharedState: e
            }), this.trigger("sharedStateChange", e)
        },
        init_as_child_block: function() {
            this.$el.addClass("no-transitions").addClass("has-parent-block"), (this.workspace.block.model.get("flags") ? .tipFreePosition || !1) && this.$el.addClass("use-free-position")
        },
        onModelChange: function(e, t) {
            if (t.viewportChange && (t.skipTriggerRedraw = !0), this.redraw(e, t), this.checkDisabledControls(e), e.get("type") !== "text") {
                let o = this.model.get("pack_id"),
                    i = this.workspace.packs ? .[o];
                !this.isSelected() && !i ? .isSelected() && this.checkNeedChangeVisibility()
            }
        },
        create: function() {
            this.setElement((0, Yi.default)(this.template({
                block: this.model.attributes,
                has_parent_block: this.has_parent_block,
                hide_rotate_controls: this.hide_rotate_controls,
                hardwareAcceleration: Modernizr.safari,
                templates: { ...Dp
                }
            }))), this.has_parent_block ? this.$el.appendTo(this.workspace.$blocksWrapper) : this.isStandalone ? this.$el.appendTo(this.$standaloneContainer) : this.$el.appendTo(this.workspace.$el.children().first()), this.$content = this.$(".content");
            let e = this.frameClass || $t;
            this.frame = new e({
                block: this
            }), this.frameColor && this.$(".frameborder").css({
                "border-color": this.frameColor
            }), this.bindEvents(), this.rendered = !0, this.checkRetargetScroll(), this.workspace.on("workspace-resize", this.onWorkspaceResize), this.model.get("is_full_width") && this.$el.addClass("full-width"), this.model.get("is_full_height") && this.$el.addClass("full-height"), this.has_parent_block && this.init_as_child_block(), this.checkDisabledControls(this.model, !0), this.onIndexChange(), this.checkNeedChangeVisibility()
        },
        triggerMouseEnter: function(e) {
            this.onMouseEnter(e)
        },
        triggerMouseLeave: function() {
            this.onMouseLeave()
        },
        onMouseEnter: function(e) {
            let t = this.model.get("pack_id"),
                o = this.workspace.packs ? .[t];
            if (!(this.isSelected() && !o ? .isSelected())) {
                if (o && !o.frame.canShowFrameBorder()) {
                    this.frame.show({
                        mode: Wn.Highlight,
                        force: e.metaKey
                    });
                    return
                }!o || e.metaKey ? this.frame.show({
                    mode: Wn.Highlight,
                    force: e.metaKey
                }) : o.hasSelectedBlocks() || o.frame.show({
                    mode: Wn.Highlight
                })
            }
        },
        onMouseLeave: function() {
            let e = this.model.get("pack_id"),
                t = this.workspace.packs ? .[e];
            this.isSelected() && !t ? .isSelected() || (this.frame.frameVisible && this.frame.hide(), t && t.frame.frameVisible && !t.hasSelectedBlocks() && t.frame.frameVisible && t.frame.hide())
        },
        isSelected: function() {
            return !!this.selected
        },
        onIndexChange: function() {
            if (this.model.get("type") === "background" || !this.rendered) return;
            let e = this.$fixed_svg,
                t = window.RM.constructorRouter.indexController.getZIndex(this.id, this.workspace.page.id, this.workspace.viewport);
            if (e && e.css({
                    "z-index": t
                }), this.currentZ !== t) {
                this.currentZ = t;
                let o = this.model.get("fixed_position") ? t : "",
                    i = o ? "" : t,
                    n = o ? "fixed" : "";
                this.$el.css({
                    "z-index": o,
                    position: n
                }), this.$content.css({
                    "z-index": i
                })
            }
        },
        css: function(e) {
            e = e || {};
            let t = e.clone ? this.$cloneEl : this.$el,
                o;
            if (e["z-index"]) {
                let c = this.model.get("fixed_position") ? e["z-index"] : "",
                    d = c ? "" : e["z-index"];
                var i = c ? "fixed" : "";
                t.css({
                    "z-index": c,
                    position: i
                }), this.$content.css({
                    "z-index": d
                })
            }
            let n = Pe.default.extend(Pe.default.clone(this.latestPosSizeAngle), e);
            (n.angle || n.flip_v || n.flip_h) && !this.forbidVisualRotation && !this.isFullWidth() && !this.isFullHeight() ? o = (n.angle ? " rotateZ(" + n.angle + "deg)" : "") + (n.flip_v ? "scaleY(-1)" : "") + (n.flip_h ? "scaleX(-1)" : "") : o = "", be.applyTransform(t.children("div:not(.skip-rotate)"), o), e.clone || (Pe.default.extend(this.latestPosSizeAngle, Pe.default.pick(e, "width", "height", "left", "top", "angle", "flip_v", "flip_h", "z-index")), e.angle != null && (this.latestPosSizeAngle.sinAngle = Math.sin(e.angle * Math.PI / 180), this.latestPosSizeAngle.cosAngle = Math.cos(e.angle * Math.PI / 180)), (e.angle != null || e.flip_v != null || e.flip_h != null) && this.frame && this.frame.recalcPointsDirections(), Pe.default.extend(this.latestPosSizeAngle, Rt.calcBoundingBox(this.latestPosSizeAngle)));
            let s = {};
            if (this.latestPosSizeAngle.angle && this.latestPosSizeAngle.angle % 90 == 0 && Math.round(this.latestPosSizeAngle.height) % 2 !== Math.round(this.latestPosSizeAngle.width) % 2 ? s = Pe.default.extend(Pe.default.pick(e, "width", "height", "left", "top", "margin-top", "margin-left"), {
                    height: Math.round(this.latestPosSizeAngle.height),
                    width: Math.round(this.latestPosSizeAngle.width) + 1
                }) : s = Pe.default.pick(e, "width", "height", "left", "top", "margin-top", "margin-left"), this.model.get("fixed_position") && this.model.get("type") !== "pack" && !Pe.default.isEmpty(s)) {
                let c = Pe.default.pick(this.latestPosSizeAngle, "width", "height");
                Pe.default.extend(s, c), this.model.getViewport() !== "default" && (i = this.workspace.position, ["n", "c", "s"].indexOf(this.model.get("fixed_position")) == -1 && (s.left += i.left), ["e", "c", "w"].indexOf(this.model.get("fixed_position")) == -1 && (s.top += i.top)), Pe.default.extend(s, be.getFixedPositionCSS(this.model.get("fixed_position"), s, 1))
            }
            this.getStickedSide() && (this.latestPosSizeAngle.sticked_margin = this.calcStickedMargin(this.latestPosSizeAngle)), t.css(s), !this.has_parent_block && !this.isStandalone && (e.doNotRedrawPacksFrames || this.workspace.redrawPacksFrames({
                tp: "css"
            }), e.doNotRedrawBottomShiftLine || this.workspace.redrawBottomShiftLine({
                tp: "css"
            }));
            let a = this.latestPosSizeAngle,
                l = a.width >= 0 && a.width <= this.SUPER_SMALL_TRESHOLD && a.height >= 0 && a.height <= this.SUPER_SMALL_TRESHOLD;
            this.$el.toggleClass("super-small", l), this.$el.toggleClass("no-default-h-dots", a.height < this.SMALL_TRESHOLD), this.$el.toggleClass("no-default-v-dots", a.width < this.SMALL_TRESHOLD)
        },
        onWorkspaceResize: function() {
            this.model.get("is_full_width") && (this.model.set(this.getFullWidthDims()), this.redrawPosition()), this.model.get("is_full_height") && this.model.set(this.getFullHeightDims()), this.model.get("sticked") && this.setStickedDims(), this.frame.sizes && (this.frame.sizes.zoom = RM.constructorRouter.zoom.getZoom(), this.frame.sizes.applyPosition())
        },
        getFullWidthDims(e) {
            let t = this.model.get("fixed_position"),
                o = this.model.getViewport(),
                i = RM.constructorRouter.zoom.getZoom(),
                n = this.workspace.getWorkspaceBox(),
                s = this.workspace.getOriginBox(),
                a = e !== void 0 ? e : this.model.get("full_width_margin") ? parseInt(this.model.get("full_width_margin"), 10) : 0,
                l = {
                    width: window.innerWidth,
                    height: window.innerHeight
                },
                c = this.workspace.getClientSize(),
                d = vo.mapDeviceToWindow(n, {
                    viewport: o,
                    windowSize: l,
                    zoom: i
                }),
                p = Bt.mapFromViewportToDocument(d, 1, i),
                h = t || this.restoreFixed || p.width > n.width ? p : n,
                u = { ...h,
                    left: h.left + a,
                    width: h.width - a * 2
                };
            if (t) {
                let m = {
                    width: l.width - c.width,
                    height: l.height - c.height
                };
                this ? .fwposmode && this ? .restoreScrollBarSize && (m.width = this.restoreScrollBarSize.width, m.height = this.restoreScrollBarSize.height);
                let {
                    width: f
                } = Bt.mapFromViewportToDocument(m, 1, i), g = ["s", "c", "n"].includes(t), y = g ? -(f / 2) : u.left, S = g ? u.width - f : u.width;
                return {
                    x: y,
                    w: S
                }
            } else {
                let {
                    width: m,
                    left: f
                } = Bt.absoluteToRelative(u, s);
                if (this ? .restoreFixed && this ? .restoreScrollBarSize) {
                    let g = this.workspace.$container.scrollLeft() / RM.constructorRouter.zoom.getZoom(),
                        {
                            width: y
                        } = Bt.mapFromViewportToDocument(this.restoreScrollBarSize, 1, i),
                        S = ["s", "c", "n"].includes(this.restoreFixed);
                    f = f + u.left + g, m = S ? u.width - y : u.width
                }
                return {
                    x: f,
                    w: m
                }
            }
        },
        getFullHeightDims: function(e) {
            let t = this.model.get("fixed_position"),
                o = {},
                n = this.workspace.getCachedSizes().height,
                s = this.workspace.page.getViewportParam(this.model.getViewport(), "height"),
                a, l = RM.constructorRouter.zoom.getZoom();
            return e == null && (e = parseInt(this.model.get("full_height_margin"), 10) || 0), t ? this ? .restoreFixed ? (o.y = -this.workspace.position.top + e, o.h = n / l - e * 2) : (a = ["w", "c", "e"].indexOf(t) > -1, o.y = a ? 0 : e, o.h = n / l - e * 2) : this ? .restoreFixed ? (o.y = Math.floor(this.workspace.getViewportPosition().top + e), o.h = n / l - e * 2) : (o.y = -this.workspace.position.top + e, o.h = Math.max(Math.max(n, s) / l, s) - e * 2), o
        },
        getStickedDims: function(e = void 0, t = void 0) {
            let o = e || this.model.get("sticked"),
                i = t !== void 0 ? t : parseInt(this.model.get("sticked_margin"), 10) || 0,
                n = this.model.getViewport(),
                {
                    x: s,
                    y: a,
                    w: l,
                    h: c
                } = this.model.attributes,
                d = {
                    left: s,
                    top: a,
                    width: l,
                    height: c
                },
                p = this.workspace.getOriginBox();
            if ((o === "left" || o === "right") && n === "default") {
                let h = this.workspace.getDocumentBox(),
                    u = o === "left" ? { ...d,
                        left: i
                    } : Bt.normalizePosition({ ...d,
                        right: i
                    }, h);
                return {
                    x: Bt.absoluteToRelative(u, p).left,
                    y: a
                }
            } else if (o === "left" || o === "right") {
                let h = this.workspace.getWorkspaceBox(),
                    u = o === "left" ? { ...d,
                        left: i
                    } : Bt.normalizePosition({ ...d,
                        right: i
                    }, h),
                    m = Bt.absoluteToRelative(p, h);
                return {
                    x: Bt.absoluteToRelative(u, m).left,
                    y: a
                }
            } else if (o === "top" || o === "bottom") {
                let h = o === "top" ? {
                    widgetBox: d,
                    top: i
                } : Bt.normalizePosition({ ...d,
                    bottom: i
                }, p);
                return {
                    x: s,
                    y: h.top
                }
            } else return {
                x: 0,
                y: 0
            }
        },
        setStickedDims: function() {
            this.model.get("sticked") && this.model.set(this.getStickedDims())
        },
        calcStickedMargin: function(e = {
            left: 0,
            top: 0,
            width: 0,
            height: 0
        }) {
            let t = this.model.get("sticked"),
                o = this.model.getViewport(),
                i = this.workspace.getOriginBox();
            if ((t === "left" || t === "right") && o === "default") {
                let n = this.workspace.getDocumentBox(),
                    s = Bt.relativeToAbsolute(e, i);
                return t === "left" ? s.left : Bt.invertPosition(s, n).right
            } else if (t === "left" || t === "right") {
                let n = this.workspace.getWorkspaceBox(),
                    s = Bt.relativeToAbsolute(e, i);
                return t === "left" ? Bt.absoluteToRelative(s, n).left : Bt.invertPosition(s, n).right
            } else return t === "top" || t === "bottom" ? t === "top" ? e.top : Bt.invertPosition(e, { ...i,
                left: 0,
                top: 0
            }).bottom : 0
        },
        getIconStyle: function(e = {}) {
            let t = {},
                o = "./constructor/widgetbar/icons/";
            return e.small && this.icon_color ? (t["background-color"] = this.icon_color, t) : (t["background-image"] = `url(${G(o+this.model.get("type")+".svg")})`, t)
        },
        bindEvents: function() {
            if (this.$el.on("click", this.onClick), this.$el.on("dblclick", this.onDblClick), !this.has_parent_block) {
                let e = {
                    not: ".no-drag, :input:not([readonly]), .size-tool"
                };
                this.model.get("type") === "text" && (e = { ...e,
                    distance: this.PIXELS_TO_ACTIVATE_DRAG
                }), (0, Yi.default)(this.$el).drag("start", this.onDragStart, { ...e
                }).drag(this.onDragMove, {
                    delay: 100
                }).drag("end", this.onDragEnd), this.workspace.on("select", this.onWorkspaceBlocksSelect), this.updateLockDragState()
            }
        },
        updateControls: function(e) {
            e = e || {};
            let t, o;
            if (this.has_parent_block ? (t = this.workspace && this.workspace.page_workspace && this.workspace.page_workspace.controls, o = this.workspace.page_workspace) : (t = this.workspace && this.workspace.controls, o = this.workspace), !t || !t.selectedBlocks || t.selectedBlocks.length != 1 || t.selectedBlocks[0].id != this.id) return;
            let i = Pe.default.pluck(t.controls, "name"),
                n = (j6(), uv(O6)).default,
                s = Pe.default.filter(this.controls, function(l) {
                    return !n[l].prototype.restrictions || !!n[l].prototype.restrictions.call(this, o, o.getSelectedBlocks())
                }.bind(this));
            (Pe.default.difference(s, i).length || Pe.default.difference(i, s).length) && t.setControls(this.controls, this, e)
        },
        scrollTo: function() {
            let e = this.$el.offset().top > document.body.clientHeight;
            if (this.$el.offset().top < 0 || e) {
                let o = (0, Yi.default)("#main");
                o.stop().animate({
                    scrollTop: o.scrollTop() + this.$el.offset().top - 100
                }, "200", "swing", function() {
                    Pe.default.delay(function() {
                        this.frame.sizes && this.frame.sizes.applyPosition()
                    }.bind(this), 400)
                }.bind(this))
            }
        },
        selectFromWidgetBar: function(e, t) {
            if (e || (e = {
                    shiftKey: !1,
                    ctrlKey: !1
                }), this.workspace.trigger("block:click", this, e), !e.shiftKey && !(e.ctrlKey || e.metaKey) && this.workspace.trigger("deselect", this), (e.ctrlKey || e.metaKey) && this.selected && !Pe.default.isEmpty(this.workspace.getSelectedBlocks())) {
                this.deselect(), Pe.default.isEmpty(this.workspace.getSelectedBlocks()) ? this.workspace.trigger("deselect", this) : this.workspace.trigger("select", this.workspace.getSelectedBlocks(), [this], !0);
                return
            }
            if (this.select(!t), !Pe.default.isEmpty(this.workspace.getSelectedBlocks())) {
                let o = {
                    selected: this.workspace.getSelectedBlocks(),
                    deselected: []
                };
                t && (o = this.workspace.redefineSelection(this.workspace.getSelectedBlocks())), this.workspace.trigger("select", o.selected, o.deselected, !0)
            }
        },
        onDblClick: function() {
            this.isStandalone || !this.has_parent_block && this.model.get("pack_id") && this.selectFromWidgetBar()
        },
        blockBoxToCommonCoords: function() {
            let e = this.getBoxData({
                    includeBoundingBox: !0
                }),
                t = this.workspace.getViewportPosition(),
                o = this.model.get("fixed_position"),
                i = e.bb_x,
                n = e.bb_y,
                s = e.bb_w,
                a = e.bb_h;
            switch (o) {
                case "nw":
                case "n":
                case "ne":
                    n += t.top;
                    break;
                case "e":
                case "c":
                case "w":
                    n += t.top + t.height / 2 - a / 2;
                    break;
                case "sw":
                case "s":
                case "se":
                    n = t.top + t.height - n - a;
                    break
            }
            switch (o) {
                case "nw":
                case "w":
                case "sw":
                    i -= (t.viewportWidth - t.width) / 2;
                    break;
                case "n":
                case "c":
                case "s":
                    i += t.width / 2 - s / 2;
                    break;
                case "ne":
                case "e":
                case "se":
                    i = t.width + (t.viewportWidth - t.width) / 2 - i - s;
                    break
            }
            return {
                x: i,
                y: n,
                w: s,
                h: a
            }
        },
        onClick: function(e, t) {
            e || (e = {
                shiftKey: !1
            });
            let o = e.metaKey || e.ctrlKey;
            if (this.workspace.trigger("block:click", this, e), !this.workspace.disableBlocksInteractive && !this.isStandalone)
                if (this.has_parent_block) {
                    if (window.suppressClick && window.suppressClick > +new Date || !t && this.workspace.page_workspace.controls && !this.workspace.page_workspace.controls.canControlsBeClosed()) return;
                    this.workspace.trigger("deselect", this), this.select(), this.workspace.trigger("select")
                } else {
                    if (this.outofbox || window.suppressClick && window.suppressClick > +new Date || this.model.get("hidden") || this.frame && this.frame.rotationState) return;
                    let i = this.workspace.packs ? .[this.model.get("pack_id")] ? .blocks ? ? [],
                        n = i.filter(a => a.isSelected()),
                        s = n.length && n.length !== i.length;
                    if (o && !this.model.get("pack_id")) {
                        let a = this.workspace.getViewportPosition(),
                            l = e.clientX - (a.viewportWidth - a.width) / 2,
                            c = e.clientY + a.top,
                            d = Pe.default.chain(this.workspace.blocks).filter(h => {
                                if (h.outofbox) return !1;
                                let u = h.blockBoxToCommonCoords();
                                return u.x < l && u.x + u.w > l && u.y < c && u.y + u.h > c
                            }).sortBy(h => -RM.constructorRouter.indexController.getZIndex(h.id, h.workspace.page.id, h.workspace.viewport)).value(),
                            p = Pe.default.find(d, h => h.selected);
                        if (p) {
                            let h = (d.indexOf(p) + 1) % d.length;
                            if (d[h]) {
                                d[h].onClick();
                                return
                            }
                        }
                    }
                    if (this.selected && !e.shiftKey && this.workspace.getSelectedBlocks().length == 1 || !t && this.workspace.controls && !this.workspace.controls.canControlsBeClosed({
                            closeSelected: !0
                        })) return;
                    if (e.shiftKey && this.selected && !Pe.default.isEmpty(this.workspace.getSelectedBlocks())) {
                        this.cutFromSelection({
                            ignorePacks: o
                        });
                        return
                    }
                    if (e.shiftKey || this.workspace.trigger("deselect", this), this.select(!!(this.model.get("pack_id") && o || s), {
                            noFrame: !1,
                            noResize: this.workspace.getSelectedBlocks().length > 0 || this.model.get("pack_id") && !(e.metaKey || e.ctrlKey)
                        }), !Pe.default.isEmpty(this.workspace.getSelectedBlocks()))
                        if (!o && !s) {
                            let a = this.workspace.redefineSelection(this.workspace.getSelectedBlocks());
                            this.workspace.trigger("select", a.selected, a.deselected)
                        } else this.workspace.trigger("select", this.workspace.getSelectedBlocks(), [], !0)
                }
        },
        cutFromSelection: function({
            ignorePacks: e = !1
        } = {}) {
            if (!this.isStandalone && this.selected && this.workspace) {
                if (this.deselect(), this.workspace.getSelectedBlocks().length == 0) this.workspace.controls.hide(), this.workspace.trigger("deselect");
                else if (this.workspace.redefineSelection) {
                    let t = this.workspace.redefineSelection(this.workspace.getSelectedBlocks(), this, {
                        ignorePacks: e
                    });
                    Pe.default.isEmpty(t.selected) || this.workspace.trigger("select", t.selected, t.deselected, t.selected.length === 1), Pe.default.isEmpty(t.selected) && this.workspace.trigger("deselect")
                }
            }
        },
        checkNeedChangeVisibility: function(e) {
            let t = this.getAnimatedBlocks(),
                o = this.getTriggerBlocks();
            o.length > 0 && (this.checkTriggerBlocks(o, e), Pe.default.each(o, i => {
                this.checkBothTypesOfBlocks(i, e)
            })), t.length > 0 && (this.checkAnimatedBlocks(t, e), Pe.default.each(t, i => {
                this.checkBothTypesOfBlocks(i, e)
            })), this.model.getAnimations().find(i => i.steps && i.steps[0]) && this.changeVisibility(this, e)
        },
        checkBothTypesOfBlocks: function(e, t) {
            e.getTriggerBlocks().length > 0 && this.checkTriggerBlocks(e.getTriggerBlocks(), t), e.getAnimatedBlocks().length > 0 && this.checkAnimatedBlocks(e.getAnimatedBlocks(), t)
        },
        checkTriggerBlocks: function(e, t) {
            Pe.default.each(e, o => {
                o.model.getAnimations().find(i => i.steps && i.steps[0]) && this.changeVisibility(o, t)
            })
        },
        checkAnimatedBlocks: function(e, t) {
            Pe.default.each(e, o => {
                this.changeVisibility(o, t)
            })
        },
        changeVisibility: function(e, t) {
            if (t === "select") e.$el.removeClass("hidden-by-trigger");
            else {
                let o = e.model.getAnimations().find(n => n.steps && n.steps[0] && n.steps[0].hideInEditor),
                    i = !!o;
                if (o && fd.includes(o.type)) {
                    let n = o.trigger ? ? [],
                        s = e.getTriggerBlocks().map(a => a.model.get("_id"));
                    i = n.length && n.some(a => s.includes(a))
                }
                e.$el.toggleClass("hidden-by-trigger", i)
            }
        },
        isAllBlocksInMyPackSelected: function() {
            let e = this.getPack();
            return !!e && e.blocks.every(t => t.isSelected())
        },
        select: function(e, t) {
            t = t || {}, this.isSelectable() && (this.has_parent_block || this.recalcFixedLine(!0), this.setupAnimationTriggers(e), this.listenTo(this.workspace, "paste-animation", this.resetAnimationTriggers), !this.selected && (t.noFrame || this.frame && this.frame.show({
                fromWidgetBar: e,
                mode: t.noResize ? Wn.NormalNoResize : void 0
            }), this.selected = !0, this.workspace.restoreFocusForCopyPasteDebounced(), this.trigger("select"), this.workspace.checkBundleDragAbility && this.workspace.checkBundleDragAbility(), this.checkNeedChangeVisibility("select"), so.isPermissionAllowed("BaseWidgetCanSelectMultiple") || typeof this.workspace.deselectBlocksExcept == "function" && this.workspace.deselectBlocksExcept(this)))
        },
        addToSelection: function() {
            this.workspace.disableBlocksInteractive || (this.selected = !0, this.frame && this.frame.show())
        },
        deselect: function(e) {
            e != this && this.selected && (this.frame && this.frame.hide(), this.hidePanel(), this.frame && this.frame.removeRotationState(), this.selected = !1, this.removeFixedLine(), this.teardownAnimationTriggers(), this.stopListening(this.workspace, "paste-animation", this.resetAnimationTriggers), this.has_parent_block && !this.igonreParentBlockDeselect && this.workspace ? .block.model.get("type") === "hotspot" && (e || Pe.default.defer(function() {
                this.workspace ? .block ? .workspace ? .trigger("deselect")
            }.bind(this))), this.trigger("deselect"), this.checkNeedChangeVisibility())
        },
        isSelectable: function() {
            return !this.outofbox
        },
        isLocked: function() {
            return !!this.model.get("is_locked")
        },
        isFullWidth: function() {
            return !!this.model.get("is_full_width")
        },
        isFullHeight: function() {
            return !!this.model.get("is_full_height")
        },
        isFixed: function() {
            return !!this.model.get("fixed_position")
        },
        onDragStart: function(e, t) {
            if (this.workspace.disableDragging || (this.workspace.freezeDeltaX = void 0, t.blocks = this.isStandalone ? [this] : this.workspace.getSelectedBlocks(), Pe.default.any(t.blocks, function(n) {
                    return n.disableDragging
                }))) return;
            let o = this.model.get("pack_id") ? this.workspace.getPackBlocks(this.model.get("pack_id")) : [this];
            if ((0, Yi.default)("html").addClass("blocks-is-moving"), this.workspace.isBlockMovementActive = !0, Pe.default.isEmpty(t.blocks)) t.blocks = o;
            else if (!this.selected) {
                let n = this.workspace.$container.scrollTop(),
                    s = this.workspace.position;
                Pe.default.any(t.blocks, function(a) {
                    return a.contains({
                        x: t.startX - s.left,
                        y: t.startY - s.top + n
                    })
                }) || (t.blocks = o)
            }
            let i = !1;
            Pe.default.each(t.blocks, function(n) {
                n.initialBoxData = n.getBoxData({
                    includeBoundingBox: !0
                }), n._maxShift = 0, i = i || !!n.selected
            }), i || this.workspace.redrawBottomShiftLine({
                tp: "move-unselected-start",
                blocks: t.blocks
            }), RM.constructorRouter.gg.snap && RM.constructorRouter.gg.handleMoveStart(t.blocks, e.altKey), t.scrollTop = this.workspace.$container.scrollTop(), this.isDragging = !0, this.workspace.bottomBlocksToMove && !this.workspace.bottomBlocksToMove.active && delete this.workspace.bottomBlocksToMove
        },
        onDragMove: function(e, t) {
            let o;
            if (Pe.default.any(t.blocks, function(a) {
                    return a.disableDragging
                }) || this.workspace.disableDragging) return;
            !t.isClone && !this.isStandalone && (t.isClone = e.altKey, t.isClone && Pe.default.each(t.blocks, function(a) {
                a.clone()
            })), o = Pe.default.filter(t.blocks, function(a) {
                return !a.isLocked()
            });
            let i = t.startY + t.scrollTop,
                n = e.pageY + this.workspace.$container.scrollTop();
            t.deltaY = n - i, t.deltaY > 0 && o.length > 1 && RM.constructorRouter.trigger("notice:triggerMetrics", "groupMovedDown");
            let s = RM.constructorRouter.zoom.getZoom();
            t.deltaX = t.deltaX / s, t.deltaY = t.deltaY / s, this.moveBlocks(this.workspace, o, t, e), this.workspace.distance.update(o), this.isStandalone || (this.workspace.redrawPacksFrames({
                tp: "move"
            }), this.workspace.redrawBottomShiftLine({
                tp: "move"
            })), be.autoWindowScroll(e, this.workspace.$container, Pe.default.bind(function() {
                this.onDragMove(e, t)
            }, this))
        },
        moveBottomBlocks: function(e, t, o, i) {
            let n = e.bottomBlocksToMove;
            if (n) {
                let s = t + i.y - (n.deltaYcorrection || 0);
                o && (s = Math.max(s, 0)), n.active && (Pe.default.each(n.list, function(a, l) {
                    let c = n.initial[l],
                        d = s + c.y;
                    a.css({
                        doNotRedrawPacksFrames: !0,
                        doNotRedrawBottomShiftLine: !0,
                        left: c.x,
                        top: d
                    }), a.trigger("move", {
                        left: c.x,
                        top: d,
                        width: c.w,
                        height: c.h
                    })
                }), n.list && n.list.length && (e.page.setViewportParam(e.viewport, "type", "scroll"), e.page.setViewportParam(e.viewport, "height", Math.ceil(Math.max(n.initPageHeight + s, n.minPageHeight))))), n.prevDeltaY = t
            }
            e.checkBundleDragAbility()
        },
        collectBottomBlo\ u0441ks: function(e, t, o) {
            let i = e.bottomBlocksToMove;
            i && (i.kbActivate && o.type == "keydown" || o.type == "drag") && (i.list || (Pe.default.extend(i, e.calcBottomBlocksToMove(t, i)), i.tosave = Pe.default.uniq((i.tosave || []).concat(i.list)), i.deltaYcorrection = i.prevDeltaY || 0))
        },
        resizeBlocks: function(e, t, o, i, n = {}) {
            if (e.disableBlocksInteractive) return;
            Pe.default.each(t, a => {
                let l = a.model.get("h"),
                    c = a.model.get("w");
                a.onResizeStart && a.onResizeStart(i, o);
                let d = a.getModelBox();
                if (a.proportional) {
                    let p = c / l;
                    d.width = o.deltaX ? c + o.deltaX : (l + o.deltaY) * p, d.height = o.deltaY ? l + o.deltaY : (c + o.deltaX) / p
                } else d.height = l + o.deltaY, d.width = c + o.deltaX, (a.model.get("tp") === "line" || a.model.get("tp") === "rectangle") && (d = Rt.calculateResizedShapeBox(d, o, {
                    height: l,
                    width: c
                }));
                a.frame.doResize(d, !1, "se", !1), n.hideFrameMs && a.hideFrameTemporary(n.hideFrameMs), a.onResizeEnd && a.onResizeEnd(i, o)
            });
            let s = Pe.default.map(t, function(a) {
                return Pe.default.extend({}, a.getSaveBoxData(), {
                    _id: a.id
                })
            }.bind(this));
            e.set_group(s, Pe.default.extend({
                isGroupResize: !0
            })), e.saveGroupDebounced(s, Pe.default.extend(pt("widget.putNotPatch") ? {
                isGroupResize: !0,
                patch: !0
            } : {
                isGroupResize: !0
            }))
        },
        hideFrameTemporary: function(e) {
            clearTimeout(this.hideFrameTimeout), this.$el.addClass("no-frame");
            let t = this.getPack() || this.workspace.getPack("selected");
            t && t.$el.addClass("no-frame"), this.hideFrameTimeout = setTimeout(() => {
                !this.destroyed && this.$el.removeClass("no-frame"), t && !t.destroyed && t.$el.removeClass("no-frame")
            }, e)
        },
        moveBlocks: function(e, t, o, i) {
            if (e ? .disableBlocksInteractive) return;
            let n = 1 / 0,
                s = 1 / 0,
                a = -1 / 0,
                l = -1 / 0,
                c = 1 / 0,
                d = 1 / 0,
                p = [],
                h = null,
                u = i && i.type === "keydown",
                m = Pe.default.any(t, function(P) {
                    return P.isFullWidth()
                }),
                f = Pe.default.any(t, function(P) {
                    return !!P.constraintHorzMove
                }),
                g = Pe.default.any(t, function(P) {
                    return P.isFullHeight()
                }),
                y = Pe.default.any(t, function(P) {
                    return !!P.constraintVertMove
                });
            e && Zy.prototype.collectBottomBlo\ u0441ks(e, t, i);
            let S = e && e.spacesController && e.spacesController.checkAllBlocksNear(t),
                w = !1,
                v = 0,
                C = e && e.getViewportPosition();
            Pe.default.each(t, function(P) {
                let M = e && e.freezeDeltaX !== void 0 ? e.freezeDeltaX : Math.round(o.deltaX),
                    F = o.deltaY - (P.resetDelta || 0),
                    R = P.initialBoxData || P.getBoxData({
                        includeBoundingBox: !0
                    });
                e && e._inTriangleBundleDrag && (M = 0);
                let A = P.model.get("fixed_position");
                if (e && e.spacesController && !A) {
                    let L = e.spacesController.getRestriction(P.model, S ? t : []),
                        W = F + R.bb_y,
                        z = F + R.bb_y + R.bb_h,
                        V = F;
                    W < L.top ? (F = Math.floor(L.top - R.bb_y), e.freezeDeltaX === void 0 && S && e.spacesController.needFreeze(P) && (e.freezeDeltaX = M)) : z > L.bottom ? (F = Math.floor(L.bottom - (R.bb_y + R.bb_h)), e.freezeDeltaX === void 0 && S && e.spacesController.needFreeze(P) && (e.freezeDeltaX = M)) : e.freezeDeltaX = void 0, Math.abs(V - F) && i.type === "drag" && S && (w = !0, v = V - F)
                }
                if (F > 0 && t.length > 1 && RM.constructorRouter.trigger("notice:triggerMetrics", "groupMovedDown"), e && !i.altKey) {
                    let L = e.page.get("wids");
                    L && (L.length === 3 ? RM.constructorRouter.trigger("notice:triggerMetrics", "secondWidgetMoved") : RM.constructorRouter.trigger("notice:triggerMetrics", "widgetMoved"))
                }
                A && (i && i.type !== "keydown" && (F = (i.pageY - o.startY) / RM.constructorRouter.zoom.getZoom()), A.indexOf("e") > -1 && (M = -M), A.indexOf("s") > -1 && (F = -F)), A = {
                    x: M + R.x,
                    y: F + R.y,
                    w: R.w,
                    h: R.h
                };
                let D = {
                    x: M + R.bb_x,
                    y: F + R.bb_y
                };
                if (i && i.shiftKey) {
                    let L = Math.abs(M),
                        W = Math.abs(F);
                    if (!P._shiftDirection && !u && (L >= 4 && (P._shiftDirection = "horz"), W >= 4 && (P._shiftDirection = "vert"), (L >= 4 || W >= 4) && M / F < 2 && M / F > .5 && (P._shiftDirection = "diag1"), (L >= 4 || W >= 4) && M / F > -2 && M / F < -.5 && (P._shiftDirection = "diag2"), P._maxShift = Math.max(L, W)), (m || f) && (P._shiftDirection = "vert"), (g || y) && (P._shiftDirection = "horz"), P._shiftDirection && !u) {
                        let z = M;
                        (P._shiftDirection == "horz" || P._shiftDirection == "vert") && (Math.abs(M) > P._maxShift && (P._maxShift = Math.abs(M), P._shiftDirection = "horz"), Math.abs(F) > P._maxShift && (P._maxShift = Math.abs(F), P._shiftDirection = "vert")), e.spacesController || (P._shiftDirection == "horz" && (A.y = R.y, D.y = R.bb_y), P._shiftDirection == "vert" && (A.x = R.x, D.x = R.bb_x), P._shiftDirection == "diag1" && (A.x = R.x + z, A.y = R.y + z, D.x = R.bb_x + z, D.y = R.bb_y + z), P._shiftDirection == "diag2" && (A.x = R.x + z, A.y = R.y - z, D.x = R.bb_x + z, D.y = R.bb_y - z)), h = P._shiftDirection
                    }
                }
                let O = P.model.get("fixed_position");
                if (O && C) {
                    p.push(O);
                    let L = D.x,
                        W = D.y,
                        z = RM.constructorRouter.zoom.getZoom(),
                        V = e.viewport,
                        X = e.$container[0],
                        {
                            x: q,
                            y: ne
                        } = vo.fixedToOrigin({
                            boxCoordinates: {
                                x: L,
                                y: W,
                                w: R.bb_w,
                                h: R.bb_h,
                                fixed_position: O
                            },
                            scroller: {
                                scrollTop: X.scrollTop,
                                scrollLeft: X.scrollLeft
                            },
                            workspaceBox: {
                                left: C.left,
                                top: C.top,
                                width: C.width,
                                height: C.pageHeight
                            },
                            windowSize: {
                                width: C.viewportWidth,
                                height: C.height
                            },
                            viewportType: V,
                            zoom: z
                        });
                    L = q, W = ne, n = Math.min(n, L), s = Math.min(s, W), a = Math.max(a, L + R.bb_w), l = Math.max(l, W + R.bb_h), c = Math.min(c, P._position ? .x_fixed || n), d = Math.min(d, P._position ? .y_fixed || s), A.x_fixed = n, A.y_fixed = s
                } else n = Math.min(n, D.x), s = Math.min(s, D.y), a = Math.max(a, D.x + R.bb_w), l = Math.max(l, D.y + R.bb_h), c = Math.min(c, P._position ? .x || n), d = Math.min(d, P._position ? .y || s);
                (m || f) && (A.x = R.x), (g || y) && (A.y = R.y), P._position = A
            }), w && !i.altKey ? e && e.spacesController.updateGhost(t, v, o.deltaX - e.freezeDeltaX, e.$el, i) : e && e.spacesController && e.spacesController.clearAll();
            let I = {
                x: 0,
                y: 0
            };
            RM.constructorRouter.gg.snap && (p = Array.from(new Set(p)), I = RM.constructorRouter.gg.handleSnapMove({
                position: {
                    x: n,
                    y: s,
                    fixeds: p
                },
                prevBlockPostion: {
                    x: c,
                    y: d
                },
                width: a - n,
                height: l - s,
                duplicateMode: o.isClone,
                fromKeyboard: i.type === "keydown",
                workspacePosition: C
            }), h == "horz" && (I.y = 0), h == "vert" && (I.x = 0), (m || f) && (I.x = 0), (g || y) && (I.y = 0), i.type === "keydown" && (I.x = 0, I.y = 0, RM.constructorRouter.gg.hideLinesWithDelay()));
            let T = {};
            if (o.isClone && (T.clone = !0), Pe.default.each(t, function(P) {
                    let M = P.model.get("fixed_position"),
                        F = M in {
                            ne: 1,
                            e: 1,
                            se: 1
                        } ? -I.x : I.x,
                        R = M in {
                            se: 1,
                            s: 1,
                            sw: 1
                        } ? -I.y : I.y;
                    P.css(Pe.default.extend({
                        doNotRedrawPacksFrames: !0,
                        doNotRedrawBottomShiftLine: !0,
                        left: P._position.x + F,
                        top: P._position.y + R
                    }, T)), P.recalcFixedLine(), P.recalcStickedLine(), P.trigger("move", {
                        left: Math.ceil(P._position.x + F),
                        top: P._position.y + R,
                        width: Math.ceil(P._position.w),
                        height: Math.ceil(P._position.h)
                    }), kg.onMoveBlock(P.model.toJSON()), u && P.hideFrameTemporary(500)
                }), e) {
                let P = o.isCloneByKeys ? o.deltaYOrig : o.deltaY;
                Zy.prototype.moveBottomBlocks(e, P, o.isClone, I), i.type === "keydown" && (e.afterbundleDragSave && clearTimeout(e.afterbundleDragSave), e.afterbundleDragSave = setTimeout(() => {
                    e.page.saveHeight({
                        silent: !0,
                        parse: !1,
                        skipHistory: !0,
                        patch: !0
                    }), e.afterbundleDragSave = null
                }, 1e3))
            }
        },
        onDragEnd: function(e, t) {
            if (be.autoWindowScrollClear(), this.workspace.distance.hide(), Pe.default.any(t.blocks, function(i) {
                    return i.disableDragging
                }) || this.workspace.disableDragging) return;
            let o = !1;
            if (Pe.default.each(t.blocks, function(i) {
                    i.initialBoxData = null, i.resetDelta = null, i._shiftDirection = null, o = o || !!i.selected
                }), o || this.workspace.redrawBottomShiftLine({
                    tp: "move-unselected-end"
                }), t.isClone) this.workspace.cloneBlocks(Pe.default.filter(t.blocks, function(i) {
                return !i.isLocked()
            }));
            else if (this.isStandalone) Pe.default.first(t.blocks).saveBox();
            else {
                this.workspace.spacesController && this.workspace.spacesController.moveBlocksToHighlighted(t.blocks), this.workspace.spacesController && this.workspace.spacesController.clearAll();
                let i = this.workspace.bottomBlocksToMove,
                    n = this.workspace.spacesController && this.workspace.spacesController.getBlocksToSave() || [],
                    s = Pe.default.map([].concat(t.blocks, i && i.tosave || [], n), function(a) {
                        return Pe.default.extend({
                            _id: a.id
                        }, a.getBoxData({
                            includeFreeze: t.deltaX - this.workspace.freezeDeltaX
                        }))
                    }.bind(this));
                i && i.initPageHeight != this.workspace.page.getViewportParam(this.workspace.viewport, "height") && i.tosave && i.tosave.length && this.workspace.page.saveHeight(), this.workspace.save_group(s, pt("widget.putNotPatch") ? {
                    patch: !0
                } : void 0)
            }(0, Yi.default)("html").removeClass("blocks-is-moving"), this.workspace.isBlockMovementActive = !1, RM.constructorRouter.gg.snap && RM.constructorRouter.gg.handleMoveEnd(), t.isClone || this.triggerRedraw(), this.isDragging = !1, this.model.get("type") === "hotspot" && (0, Yi.default)(e.target).one("click", function(i) {
                i.stopImmediatePropagation()
            }), this.workspace.clearBottomBlocksToMove(), this.workspace.checkBundleDragAbility(), this.handleNextHelpTourStep()
        },
        handleNextHelpTourStep: function() {
            st(["TextWidgetDrag", "PictureWidgetPlace", "AdjustSizes", "ButtonWidgetDrag", "ArrangeWidgetsInTheGrid"])
        },
        triggerRedraw: function() {
            this.isStandalone || this.workspace.trigger("redraw", {
                is_global: this.model.get("is_global")
            })
        },
        recalcFixedLine: function(e) {
            let t = this.model.get("fixed_position") || this.restoreFixed,
                o = this.model.get("pack_id"),
                i = o && this.workspace.packs && this.workspace.packs[o],
                n = e ? ? this.selected;
            t && !i && n ? this.updateFixedLine(t) : this.removeFixedLine()
        },
        updateFixedLine: function(e) {
            if (!this.$fixed_svg) {
                let g = window.RM.constructorRouter.indexController.getZIndex(this.id, this.workspace.page.id, this.workspace.viewport);
                this.$fixed_svg = (0, Yi.default)(`<svg class="fixed-line" style="z-index: ${g};"><line /></svg>`), this.workspace.$el.append(this.$fixed_svg)
            }
            let t = this.$fixed_svg.find("line").get(0),
                o = RM.constructorRouter.zoom.getZoom(),
                i = this.frame.$el.offset(),
                n = this.getBoxData(),
                s, a, l, c, d, p, h = this.isFullHeight(),
                u = this.workspace.getCachedSizes(),
                m = u.width / o,
                f = u.height / o;
            d = p = 0, this.model.getViewport() != "default" && (d = this.workspace.position.left, p = this.workspace.position.top), s = d, l = p, a = i.left, c = i.top, e.indexOf("s") > -1 && (l = f - p, c += n.h), e.indexOf("e") > -1 && (s = m - d, a += n.w), ["n", "c", "s"].indexOf(e) > -1 && (s = m / 2, a += n.w / 2), ["w", "c", "e"].indexOf(e) > -1 && (l = f / 2, c += n.h / 2), h && (c = l), t.setAttributeNS(null, "x1", s), t.setAttributeNS(null, "x2", a), t.setAttributeNS(null, "y1", l), t.setAttributeNS(null, "y2", c)
        },
        removeFixedLine: function() {
            this.$fixed_svg && this.$fixed_svg.remove(), delete this.$fixed_svg
        },
        recalcStickedLine: function() {
            let e = this.model.get("sticked"),
                t = {
                    left: "",
                    right: "",
                    top: "",
                    bottom: "",
                    width: "",
                    height: ""
                };
            if (!e) this.$stickedLine && (this.$stickedLine.remove(), delete this.$stickedLine);
            else {
                let o = e == "left" || e == "right";
                this.$stickedLine || (this.$stickedLine = (0, Yi.default)("<div>").addClass("sticked-line skip-rotate").appendTo(this.$el)), this.$stickedLine.removeClass("line-horizontal line-vertical"), this.$stickedLine.addClass(o ? "line-horizontal" : "line-vertical"), o ? (t.width = this.calcStickedMargin(this.latestPosSizeAngle), t[e] = -t.width) : (t.height = this.calcStickedMargin(this.latestPosSizeAngle), t[e] = -t.height), this.$stickedLine.css(t)
            }
        },
        clone: function() {
            this.workspace.disableBlocksInteractive || (this.isLocked() || (this.$cloneEl = (0, Yi.default)(Yi.default.clone(this.$el.get(0))), this.$cloneEl.data("id", this.$cloneEl.data("id") + "-clone"), this.$cloneEl.insertAfter(this.$el)), this.deselect())
        },
        blink: function(e = !1) {
            let t = this.$el;
            t.addClass("frame-blink"), e && t.addClass("danger"), be.waitForTransitionEnd(t, 2500, "opacity", function() {
                t.removeClass("frame-blink danger")
            })
        },
        getStandardName: function() {
            let e = this.model.get("type"),
                t = {
                    ellipse: "oval"
                };
            if (e === "text") return this.model.get("version") === 3 ? mg(this.model) : (0, Yi.default)(this.model.get("text")).text();
            if (e === "shape") {
                let o = this.model.get("tp");
                return be.capitalize(t[o] || o)
            }
            return e === "button" && this.model.get("tp") === "text" ? this.model.get("text") : this.name ? this.name : be.capitalize(e)
        },
        highlight: function(e, t) {
            let o = this.animationMode ? (this.workspace.animationSteps.currentStep || this.workspace.animationSteps.initialStep).$el : this.$el;
            t && o && o.toggleClass(t, !!e)
        },
        getTriggerBlocks: function() {
            return this.getAllTriggers().reduce((e, t) => {
                let o = this.workspace.findBlock(t);
                return o ? e.push(o) && e : e
            }, [])
        },
        getAnimationTriggers: function(e) {
            let t = this.model.getAnimations().find(o => o.UUID === e);
            return ft.normalizeAnimationTriggers(t && t.trigger)
        },
        getAllAnimationTriggers() {
            return this.model.getAnimations().reduce((e, t) => t.type !== "none" && t.trigger ? [...e, ...ft.normalizeAnimationTriggers(t && t.trigger)] : e, [])
        },
        getAllTriggers() {
            return Pe.default.unique([...this.getAllAnimationTriggers(), ...this.model.get("triggers") || []])
        },
        setAnimationTriggers: function(e, t) {
            let o = this.model.getAnimations().map(i => i.UUID === e ? { ...i,
                trigger: t && !Pe.default.isArray(t) ? [t] : t || []
            } : i);
            this.model.set("animation", o)
        },
        removeAllAnimationTriggers() {
            this.model.getAnimations().forEach(e => {
                this.getAnimationTriggers(e.UUID).forEach(t => this.removeAnimationTrigger(e.UUID, t))
            })
        },
        removeAnimationTrigger: function(e, t) {
            let o = this.getAnimationTriggers(e);
            o.indexOf(t) !== -1 && (this.setAnimationTriggers(e, Pe.default.without(o, t)), this.model.trigger("animation:trigger:remove", t))
        },
        isPackAlreadySetUp: function(e) {
            return !!(e && this.workspace.getPackBlocks && Pe.default.find(this.workspace.getPackBlocks(e), function(t) {
                return t.ownTooltip
            }))
        },
        getAnimatedBlocks: function() {
            let e = Pe.default.reduce(this.workspace.blocks, function(t, o) {
                if (o.getAllTriggers().includes(this.id)) {
                    let i = this.model.get("pack_id") || o.id;
                    t[i] = t[i] || o
                }
                return t
            }.bind(this), {});
            return Pe.default.values(e)
        },
        getTooltipTarget: function(e) {
            let t = this.model.get("pack_id"),
                o = t && this.workspace.$("#pack_" + t);
            return this.animationMode ? this.workspace.animationSteps.initialStep.$el : o && o.length && !e ? o : this.$el
        },
        setupAnimationTriggers: function(e) {
            let t = this.getAnimatedBlocks(),
                o = this.getTriggerBlocks();
            Pe.default.each(t, this.setupAnimationTrigger.bind(this, !0)), Pe.default.each(o, this.setupAnimationTrigger.bind(this, !1)), (t.length && (t.length > 1 || t[0].id !== this.id) || o.length) && !this.isPackAlreadySetUp(this.model.get("pack_id")) && !this.ownTooltip && (this.ownTooltip = this.getTooltipTarget(e).RMAltText({
                text: t.length && o.length ? "Animated / Trigger" : t.length ? "Trigger" : "Animated",
                offset: this.TOOLTIP_OFFSET,
                manual: !0,
                cssClass: "animation-trigger-tooltip animation-trigger-own-tooltip skip-rotate",
                container: this.getTooltipTarget(e),
                keepInBounds: !0,
                targetZoom: RM.constructorRouter.zoom.getZoom()
            }), this.ownTooltip.show(), this.bindAnimationTriggerHandlers())
        },
        teardownAnimationTriggers: function() {
            let e = Pe.default.keys(this.triggerAssets);
            Pe.default.each(e, this.teardownAnimationTrigger.bind(this)), this.ownTooltip && this.ownTooltip.destroy(), delete this.ownTooltip, this.unbindAnimationTriggerHandlers()
        },
        setupAnimationTrigger: function(e, t) {
            if (t) {
                let o = this.model.get("pack_id"),
                    i = t.id,
                    n = t.model.get("pack_id"),
                    s = n && this.workspace.$("#pack_" + n);
                this.triggerAssets[i] = this.triggerAssets[i] || {}, !this.triggerAssets[i].tooltip && i !== this.id && (!o || n !== o) && !t.ownTooltip && (this.triggerAssets[i].tooltip = (s || t.$content).RMAltText({
                    text: s || e ? "Animated" : "Trigger",
                    offset: this.TOOLTIP_OFFSET,
                    manual: !0,
                    cssClass: "animation-trigger-tooltip skip-rotate",
                    container: s || t.$el,
                    keepInBounds: !0,
                    targetZoom: RM.constructorRouter.zoom.getZoom()
                }), this.triggerAssets[i].tooltip.show(), s ? s.addClass(ft.ACTIVE_TRIGGER_CLASS) : t.highlight(!0, ft.ACTIVE_TRIGGER_CLASS), this.triggerAssets[i].updateLinkedTooltipBound = this.updateLinkedTooltip.bind(this, i), this.listenTo(t, "move resize", this.triggerAssets[i].updateLinkedTooltipBound), this.listenTo(t && t.model, "change:x change:y change:w change:h", this.triggerAssets[i].updateLinkedTooltipBound))
            }
        },
        teardownAnimationTrigger: function(e) {
            let t = this.workspace.findBlock(e);
            t && t.highlight(!1, ft.ACTIVE_TRIGGER_CLASS), this.workspace.$("." + ft.ACTIVE_TRIGGER_CLASS).removeClass(ft.ACTIVE_TRIGGER_CLASS), this.triggerAssets[e] && (this.triggerAssets[e].tooltip && this.triggerAssets[e].tooltip.destroy(), this.stopListening(t, "move resize", this.triggerAssets[e].updateLinkedTooltipBound), this.stopListening(t && t.model, "change:x change:y change:w change:h", this.triggerAssets[e].updateLinkedTooltipBound), delete this.triggerAssets[e])
        },
        bindAnimationTriggerHandlers: function() {
            this.animationTriggerHandlersBound || (this.listenTo(this, "move resize", this.updateOwnTooltip), this.listenTo(this, "animationMode", this.resetAnimationTriggers), this.listenTo(this, "animation:stepsPopup:open", this.onStepsPopupOpen), this.listenTo(this, "animation:stepsPopup:closed", this.onStepsPopupClosed), this.listenTo(this.model, "change:angle change:x change:y change:w change:h change:sticked change:fixed_position change:is_full_width change:is_full_height", this.updateOwnTooltip), bt.on("zoom", this.updateTooltips), (0, Yi.default)("#main").on("scroll", this.updateTooltips), this.animationTriggerHandlersBound = !0)
        },
        unbindAnimationTriggerHandlers: function() {
            this.stopListening(this, "move resize", this.updateOwnTooltip), this.stopListening(this, "animationMode", this.resetAnimationTriggers), this.stopListening(this, "animation:stepsPopup:open", this.onStepsPopupOpen), this.stopListening(this, "animation:stepsPopup:closed", this.onStepsPopupClosed), this.stopListening(this.model, "change:angle change:x change:y change:w change:h change:sticked change:fixed_position change:is_full_width change:is_full_height", this.updateOwnTooltip), this.stopListening(this.workspace, "workspace-resize", this.updateTooltips), (0, Yi.default)("#main").off("scroll", this.updateTooltips), delete this.animationTriggerHandlersBound
        },
        updateTooltips: function() {
            window.requestAnimationFrame(function() {
                Pe.default.each(this.getAllTriggers(), this.recalcLinkedTooltip), this.recalcOwnTooltip()
            }.bind(this))
        },
        updateLinkedTooltip: function(e) {
            window.requestAnimationFrame(this.recalcLinkedTooltip.bind(this, e))
        },
        updateOwnTooltip: function() {
            window.requestAnimationFrame(() => {
                this.recalcOwnTooltip()
            })
        },
        recalcLinkedTooltip: function(e) {
            this.triggerAssets[e] && this.triggerAssets[e].tooltip && (this.triggerAssets[e].tooltip.setTargetZoom(RM.constructorRouter.zoom.getZoom()), this.triggerAssets[e].tooltip.update())
        },
        recalcOwnTooltip: function() {
            this.ownTooltip && (this.ownTooltip.setTargetZoom(RM.constructorRouter.zoom.getZoom()), this.ownTooltip.update())
        },
        onStepsPopupOpen: function(e) {
            let t = this.ownTooltip && this.ownTooltip.getElement(),
                o = t && t[0] && t[0].getBoundingClientRect(),
                i;
            if (e) {
                let n = e.find(".js-add-step-popup");
                i = n && n.length && n[0].getBoundingClientRect()
            }
            o && i && Rt.doBoundingBoxesIntersect(o, i) && this.ownTooltip.hide()
        },
        onStepsPopupClosed: function() {
            this.ownTooltip && !this.ownTooltip.getElement() && this.ownTooltip.show()
        },
        getSaveBoxData: function() {
            let e = this.getBoxData();
            return this.model.get("is_full_width") && (e = Pe.default.omit(e, "x")), this.model.get("is_full_height") && (e = Pe.default.omit(e, "y")), e
        },
        getSaveBoxOptions: function(e) {
            let t = e || {};
            return t.savebox = !0, t
        },
        saveBox: function(e) {
            this._saveXHR && this._saveXHR.abort(), this._saveXHR = this.model.save(this.getSaveBoxData(e), this.getSaveBoxOptions(e))
        },
        getBoxData: function(e) {
            e = e || {};
            let t = this.latestPosSizeAngle,
                o = this.model.get("is_full_width"),
                i = this.model.get("is_full_height"),
                n = {
                    w: t.width,
                    h: t.height,
                    x: t.left,
                    y: t.top
                };
            if (e.includeFreeze && (n.x += e.includeFreeze), e.includeRotationData && (n.angle = t.angle, n.flip_v = t.flip_v, n.flip_h = t.flip_h), e.includeBoundingBox && (n.bb_w = t.bb_width, n.bb_h = t.bb_height, n.bb_x = t.bb_left, n.bb_y = t.bb_top), this.model.get("fixed_position") && e.checkFixedPosition) {
                let s = Pe.default.clone(n),
                    a = this.$el.offset(),
                    l = this.workspace.position;
                n.y = a.top - l.top, n.x = a.left - l.left, e.includeBoundingBox && (n.bb_x = n.x + (n.bb_x - s.x), n.bb_y = n.y + (n.bb_y - s.y))
            }
            if (o) {
                let s = this.getFullWidthDims();
                n.x = s.x, n.w = s.w
            }
            if (i) {
                let s = this.getFullHeightDims();
                n.y = s.y, n.h = s.h
            }
            return this.model.get("sticked") && (n.sticked_margin = t.sticked_margin), n
        },
        getModelBox: function() {
            let e = this.model.get("angle") || 0,
                t = e ? e * Math.PI / 180 : 0;
            return {
                left: this.model.get("x"),
                top: this.model.get("y"),
                width: this.model.get("w"),
                height: this.model.get("h"),
                angle: e,
                flip_v: !!this.model.get("flip_v"),
                flip_h: !!this.model.get("flip_h"),
                sinAngle: Math.sin(-t),
                cosAngle: Math.cos(-t)
            }
        },
        getPack: function() {
            let e = this.model.get("pack_id");
            return e && this.workspace.packs[e]
        },
        onPackChange: function(e, t, o) {
            Pe.default.isEmpty(this.workspace.getSelectedBlocks()) || this.workspace.trigger("select", this.workspace.getSelectedBlocks()), this.workspace.redrawPacksFrames({
                tp: "pack-change"
            }), this.isLocked() && (o.undo || o.redo) && e.save({
                is_locked: !1
            }, {
                patch: !0,
                skipHistory: !0
            }), this.recalcFixedLine(), this.selected && this.resetAnimationTriggers()
        },
        checkNeedRedraw: function(e, t) {
            t = t || {};
            let o = e.changedAttributes();
            return !(t.pid && this.workspace && this.workspace.page.id !== t.pid || !this.workspace.rendered || Pe.default.keys(o).length == 1 && o.animation)
        },
        redraw: function(e, t) {
            t = t || {}, this.checkNeedRedraw(e, t) && this.redrawPosition(e, Pe.default.extend(t, {
                forceRedraw: !1
            }))
        },
        updateLockDragState: function() {
            this.$el.toggleClass("no-drag", this.isLocked())
        },
        redrawPosition: function(e, t) {
            if (!this.rendered) return;
            t = t || {}, e = e || this.model, this.redrawShadow(e);
            let o = {},
                i = t.forceRedraw ? {} : this.getBoxData({
                    includeRotationData: !0
                }),
                n = this.model.changedAttributes(),
                s = Pe.default.has(n, "is_full_width"),
                a = Pe.default.has(n, "is_full_height");
            s && this.$el.toggleClass("full-width", !!this.model.get("is_full_width")), a && this.$el.toggleClass("full-height", !!this.model.get("is_full_height"));
            let l = e.get("fixed_position"),
                c = !!e.get("is_full_width"),
                d = !!e.get("is_full_height");
            if ((e.get("x") != i.x || l) && (o.left = e.get("x")), (e.get("y") != i.y || l) && (o.top = e.get("y")), d) {
                var p = this.getFullHeightDims();
                o.top = p.y
            }
            if ((e.get("w") != i.w || l) && (o.width = e.get("w")), c) {
                let {
                    x: h,
                    w: u
                } = this.getFullWidthDims();
                o.left = h, o.width = u
            }
            if (Xt.isIncomingUpdate(t) && d && (o.height = p.h), (e.get("h") != i.h || l || d) && (o.height = e.get("h")), (e.get("angle") || 0) != i.angle && (o.angle = e.get("angle") || 0), !!e.get("flip_v") != i.flip_v && (o.flip_v = !!e.get("flip_v")), !!e.get("flip_h") != i.flip_h && (o.flip_h = !!e.get("flip_h")), Pe.default.isEmpty(o) || (t.doNotRedrawPacksFrames && (o.doNotRedrawPacksFrames = !0), t.doNotRedrawBottomShiftLine && (o.doNotRedrawBottomShiftLine = !0), this.css(o)), (l || t.undo || t.redo) && this.recalcFixedLine(), (e.get("sticked") || Pe.default.has(n, "sticked")) && (this.recalcStickedLine(), (n.x || n.y) && !Pe.default.has(n, "sticked") && this.workspace.page.getPreviousViewport() === this.workspace.viewport)) {
                let h = this.getBoxData().sticked_margin;
                h && !isNaN(h) && this.model.get("sticked_margin") != h && this.model.set({
                    sticked_margin: h
                }, {
                    first: !0
                })
            }!t.skipTriggerRedraw && !t.forceRedraw && this.triggerRedraw()
        },
        showPanel: function() {
            this.workspace.controls.selectFirst()
        },
        hidePanel: function() {
            this.panel && this.panel.hide()
        },
        inArea: function(e) {
            if (this.model.get("hidden")) return;
            let t = this.model.get("fixed_position"),
                o = this.getBoxData({
                    includeBoundingBox: !0,
                    includeRotationData: !0,
                    checkFixedPosition: !0
                });
            if (t) {
                let n = RM.constructorRouter.zoom.getZoom();
                o.bb_y += this.workspace.$container.scrollTop() / n, o.bb_x += this.workspace.$container.scrollLeft() / n
            }
            let i = Math.max(e.x, o.bb_x) < Math.min(e.x + e.w, o.bb_x + o.bb_w) && Math.max(e.y, o.bb_y) < Math.min(e.y + e.h, o.bb_y + o.bb_h);
            if (i && o.angle) {
                let n;
                if (t) {
                    let a = RM.constructorRouter.zoom.getZoom();
                    n = {
                        top: o.y + this.workspace.$container.scrollTop() / a,
                        left: o.x + this.workspace.$container.scrollLeft() / a,
                        width: o.w,
                        height: o.h,
                        sinAngle: this.latestPosSizeAngle.sinAngle,
                        cosAngle: this.latestPosSizeAngle.cosAngle
                    }
                }
                let s = Rt.calcRotatedBox(n || this.latestPosSizeAngle);
                i = Rt.isConvexPolygonsIntersects(s, [{
                    x: e.x,
                    y: e.y
                }, {
                    x: e.x + e.w,
                    y: e.y
                }, {
                    x: e.x + e.w,
                    y: e.y + e.h
                }, {
                    x: e.x,
                    y: e.y + e.h
                }])
            }
            return i
        },
        contains: function(e) {
            if (this.model.get("hidden")) return;
            let t = this.getBoxData({
                    includeBoundingBox: !0,
                    includeRotationData: !0
                }),
                o = t.bb_x < e.x && t.bb_x + t.bb_w > e.x && t.bb_y < e.y && t.bb_y + t.bb_h > e.y;
            if (o && t.angle) {
                let i = Rt.calcRotatedBox(this.latestPosSizeAngle);
                o = Rt.isConvexPolygonContainsPoint(i, e)
            }
            return o
        },
        showIconLoader: function() {
            this.isLoading = !0
        },
        hideIconLoader: function() {
            this.isLoading = !1
        },
        onBlockVisibilityChange: function(e, t, o = {}) {
            let i = !!e.get("hidden");
            this.$el.toggleClass("invisible", i), i && (!o.viewportChange && this.triggerRedraw(), this.cutFromSelection()), this.workspace.trigger("blockHidden", e, i), e.get("pack_id") && this.workspace.redrawPacksFrames({
                tp: "css"
            })
        },
        storeFixedPosition: function() {
            if (this.model.get("fixed_position")) {
                let e = {
                        width: window.innerWidth,
                        height: window.innerHeight
                    },
                    t = this.workspace.getClientSize();
                this.restoreFixed = this.model.get("fixed_position"), this.restoreScrollBarSize = {
                    width: e.width - t.width,
                    height: e.height - t.height
                };
                let o = this.workspace.viewport,
                    i = RM.constructorRouter.zoom.getZoom(),
                    n = this.getBoxData({
                        checkFixedPosition: !0
                    });
                if (n.y = n.y + this.workspace.$container.scrollTop() / i, n.x = n.x + this.workspace.$container.scrollLeft() / i, ["default", "phone_portrait"].includes(o)) {
                    let s = hg.getViewportSetting("width", o),
                        a = this.workspace.getWorkspaceBox() ? .width || s;
                    n.x -= (a - s) / 2
                }
                this.model.set(Pe.default.extend(n, {
                    fixed_position: ""
                }), {
                    skipHistory: !0
                })
            }
        },
        restoreFixedPosition: function() {
            if (this.restoreFixed) {
                let e = this.getBoxData(),
                    t = this.$el.offset(),
                    o = this.model.getViewport() != "default" ? this.workspace.position.left : 0,
                    i = this.model.getViewport() != "default" ? this.workspace.position.top : 0,
                    n = RM.constructorRouter.zoom.getZoom(),
                    s = {
                        x: (this.restoreFixed.indexOf("e") > -1 ? (0, Yi.default)(window).width() / n - t.left - e.w : t.left) - o,
                        y: (this.restoreFixed.indexOf("s") > -1 ? (0, Yi.default)(window).height() / n - t.top - e.h : t.top) - i,
                        w: e.w,
                        h: e.h,
                        fixed_position: this.restoreFixed
                    };
                ["n", "c", "s"].indexOf(this.restoreFixed) > -1 && (s.x -= (0, Yi.default)("#main").width() / 2 / n - e.w / 2 - o), ["e", "c", "w"].indexOf(this.restoreFixed) > -1 && (s.y -= (0, Yi.default)("#main").height() / 2 / n - e.h / 2 - i), this.model.set(s, {
                    skipHistory: !0
                }), delete this.restoreFixed, delete this.restoreScrollBarSize
            }
        },
        resetFullWidth: function() {
            this.model.get("is_full_width") && this.model.set({
                is_full_width: !1,
                x: this.model.get("full_width_initial_x") || this.model.get("x"),
                w: this.model.get("full_width_initial_w") || this.model.get("w")
            })
        },
        resetFullHeight: function() {
            this.model.get("is_full_height") && this.model.set({
                is_full_height: !1,
                y: this.model.get("full_height_initial_y") || this.model.get("y"),
                h: this.model.get("full_height_initial_h") || this.model.get("h")
            })
        },
        onFixPosition: function(e, t, o) {
            this.css({
                "z-index": RM.constructorRouter.indexController.getZIndex(this.model.id, this.workspace.page.id, this.workspace.viewport),
                width: this.model.get("w"),
                height: this.model.get("h"),
                top: this.model.get("y"),
                left: this.model.get("x"),
                "margin-left": 0,
                "margin-top": 0
            }), o && (o.redo || o.undo) && !Pe.default.isEmpty(this.workspace.getSelectedBlocks()) && this.workspace.trigger("select", this.workspace.getSelectedBlocks()), this.checkRetargetScroll(), this.recalcFixedLine()
        },
        onAnimationTriggerAdd: function() {
            this.resetAnimationTriggers()
        },
        onAnimationTriggerRemove: function() {
            this.resetAnimationTriggers()
        },
        resetAnimationTriggers: function() {
            this.teardownAnimationTriggers(), window.requestAnimationFrame(() => {
                this.selected && this.setupAnimationTriggers()
            })
        },
        checkRetargetScroll: function() {
            this.retargetScroll && this.retargetScroll.restore && this.retargetScroll.restore(), this.model.get("fixed_position") && (this.retargetScroll = p0(this.$el.get(0), this.workspace.$container.get(0)))
        },
        onWorkspaceBlocksSelect: function(e, t, o) {
            if (this.isStandalone) return;
            e && e.length === 1 && e[0] === this ? this.frame && this.frame.show({
                fromWidgetbar: o
            }) : this.frame && this.frame.removeRotationState()
        },
        isRealChangeByMe: function(e) {
            return e = e || {}, !!(!Xt.isIncomingUpdate(e) && this.workspace == RM.constructorRouter.workspace && RM.constructorRouter.workspace.page && RM.constructorRouter.isPageLockedByMe(RM.constructorRouter.workspace.page.get("_id")))
        },
        toggleAnimationMode: function(e) {
            this.$el.toggleClass("animation-mode", !!e), this.animationMode = !!e, this.model.get("pack_id") && (this.isPackFrameHidden = e, this.workspace.redrawPacksFrames({
                tp: "animation-mode"
            })), this.workspace.redrawBottomShiftLine({
                tp: "animation-mode"
            }), this.trigger("animationMode", e)
        },
        getStickedSide: function() {
            return this.model.get("sticked") || void 0
        },
        checkDisabledControls: function() {
            return []
        },
        destroyReact: function() {
            !this.$content || !this.$content[0] || U6.default.unmountComponentAtNode(this.$content[0])
        },
        destroy: function() {
            this.frame && this.frame.removeRotationState(), this.frame && this.frame.destroy(), this.workspace.off("select", this.onWorkspaceBlocksSelect), this.destroyed = !0, this.destroyReact(), this.cutFromSelection(), this.$el.remove(), this.stopListening(this.model, "change"), this.model.isGlobal && !this.model.isGlobal() && this.triggerRedraw(), this.rendered = !1, this.workspace.off("deselect", this.deselect), this.model.off("change", this.onModelChange), this.model.off("change:pack_id", this.onPackChange), this.model.off("change:is_locked", this.updateLockDragState), this.model.off("change:fixed_position", this.onFixPosition), this.model.off("change:hidden", this.onBlockVisibilityChange), bt.off("index:changed", this.onIndexChange), this.workspace.page.off("change:viewport", this.onIndexChange), this.stopListening(this.model, "animation:trigger:add"), this.stopListening(this.model, "animation:trigger:remove"), this.stopListening(this.model, "animation:type:change"), this.stopListening(this, "move resize", this.updateTriggerBezier), this.workspace.off("workspace-resize", this.onWorkspaceResize), typeof this.unsubscribeSharedState == "function" && this.unsubscribeSharedState(), this.$el.off(), this.panel && (this.panel.destroy ? .(), delete this.panel), this.trigger("destroy")
        },
        redrawShadow: function(e) {
            let t = e.get("shadow"),
                o = e.get("isShadowEnabled");
            window.requestAnimationFrame(() => {
                this.$content.css({ ...tk(o ? t : void 0),
                    ...o ? {
                        willChange: "filter"
                    } : {}
                })
            })
        }
    }, {
        getViewportDefaults: function(e, t, o) {
            o = o || {};
            let i = hg.getViewportSetting("width", "default"),
                n = hg.getViewportSetting("width", t),
                s = Math.round((n - i) / 2),
                a = e.get("is_full_width"),
                l = a && t !== "default",
                c = e.get("is_full_height"),
                d = c && t !== "default",
                p = e.get("fixed_position"),
                h;
            if (h = {
                    x: e.get("x"),
                    y: e.get("y")
                }, (o.clone || o.copy) && (s = 0), p) {
                let u = e.get("pid"),
                    m = {
                        width: window.innerWidth,
                        height: window.innerHeight
                    },
                    f = RM.constructorRouter.mag.toJSON(),
                    g = RM.constructorRouter.mag.pages.find(F => F.id === u) ? .toJSON(),
                    y = vg(),
                    S = e.get("fixed_position"),
                    w = vo.getWorkspaceSize(f, g, "default"),
                    v = vo.getWorkspaceSize(f, g, t),
                    C = {
                        workspaceSize: w,
                        windowSize: m,
                        viewport: "default"
                    },
                    I = {
                        workspaceSize: v,
                        windowSize: m,
                        viewport: t,
                        device: y
                    },
                    T = vo.mapWidgetToWindow([e.toJSON()], C),
                    {
                        x: P,
                        y: M
                    } = vo.mapWidgetToWorkspace(T, S, I);
                h.x = P, h.y = M, ["n", "c", "s"].indexOf(o.fixed || S) > -1 && delete h.x, ["w", "c", "e"].indexOf(o.fixed || S) > -1 && delete h.y
            } else h.x = h.x + s;
            return l && (h.is_full_width = !1, h.w = e.get("full_width_initial_w") || e.get("w"), p || (h.x = (e.get("full_width_initial_x") || e.get("x")) + s)), d && (h.is_full_height = !1, h.h = e.get("full_height_initial_h") || e.get("h"), p || (h.y = e.get("full_height_initial_y") || e.get("y"))), e.get("triggers") && (h.triggers = [...e.get("triggers")]), h
        }
    });
    Zy.prototype.template = V1["template-constructor-block"];
    RM.vue = RM.vue || {};
    RM.vue.Sizes = Qn.extend(aP);
    me = Zy
});
var V6, G6, Y6, Z6, KS = k(() => {
    "use strict";
    Dn();
    WH();
    Dn();
    Mj();
    uh();
    EH();
    V6 = (e, t) => b1.switchTextToViewport(e, t), G6 = (e, t) => {
        let o = { ...e
            },
            {
                entityMap: i
            } = o;
        return i && Object.values(i).forEach(n => {
            let s = n;
            s && s.type === Qd && s.data && !s.data.pageId && s.data.type === "Page" && (s.data.pageId = t.getPageId(s.data.pageUri || s.data.pageNum))
        }), { ...o,
            flags: { ...o.flags || {},
                updatedLinks: !0
            }
        }
    }, Y6 = e => {
        let t = { ...e
            },
            o = t.text,
            {
                blocks: i,
                styles: n,
                entityMap: s,
                blocksMeta: a
            } = wh({
                str: o
            }),
            l = i.map(p => p.key),
            c = Object.values(s).map(p => p.data.id),
            d = {
                blocks: i,
                styles: n,
                entityMap: s,
                blocksMeta: a
            };
        if (t.viewport_phone_portrait) {
            let p = V6(o, "phone_portrait"),
                {
                    styles: h,
                    blocksMeta: u,
                    entityMap: m
                } = wh({
                    str: p,
                    blockKeys: l,
                    entityKeys: c
                });
            d.viewport_phone_portrait = {
                blocksMeta: u,
                entityMap: m,
                styles: h,
                bgColor: Hf(t.viewport_phone_portrait.bg_color, t.viewport_phone_portrait.bg_opacity * 100),
                columns: {
                    count: t.viewport_phone_portrait.column_count,
                    gap: t.viewport_phone_portrait.column_gap
                }
            }, t.viewport_phone_portrait = { ...t.viewport_phone_portrait,
                ...d.viewport_phone_portrait
            }, t.viewport_phone_portrait.hasOwnProperty("hidden") || (t.viewport_phone_portrait.hidden = !1), delete t.viewport_phone_portrait.column_count, delete t.viewport_phone_portrait.column_gap, delete t.viewport_phone_portrait.bg_color, delete t.viewport_phone_portrait.bg_opacity
        }
        if (t.viewport_tablet_portrait) {
            let p = V6(o, "tablet_portrait"),
                {
                    styles: h,
                    blocksMeta: u,
                    entityMap: m
                } = wh({
                    str: p,
                    blockKeys: l,
                    entityKeys: c
                });
            d.viewport_tablet_portrait = {
                blocksMeta: u,
                entityMap: m,
                styles: h,
                bgColor: Hf(t.viewport_tablet_portrait.bg_color, t.viewport_tablet_portrait.bg_opacity * 100),
                columns: {
                    count: t.viewport_tablet_portrait.column_count,
                    gap: t.viewport_tablet_portrait.column_gap
                }
            }, t.viewport_tablet_portrait = { ...t.viewport_tablet_portrait,
                ...d.viewport_tablet_portrait
            }, t.viewport_tablet_portrait.hasOwnProperty("hidden") || (t.viewport_tablet_portrait.hidden = !1), delete t.viewport_tablet_portrait.column_count, delete t.viewport_tablet_portrait.column_gap, delete t.viewport_tablet_portrait.bg_color, delete t.viewport_tablet_portrait.bg_opacity
        }
        return t = { ...t,
            autosize: t.autosize,
            verticalAlign: "top",
            blocks: d.blocks,
            styles: d.styles,
            entityMap: d.entityMap,
            blocksMeta: d.blocksMeta,
            bgColor: Hf(t.bg_color, t.bg_opacity * 100),
            columns: {
                count: t.column_count,
                gap: t.column_gap
            },
            version: 3,
            column_count: void 0,
            column_gap: void 0,
            bg_color: void 0,
            bg_opacity: void 0,
            text: void 0
        }, t
    }, Z6 = (e, t) => {
        /px/i.test(String(t["font-size"])) || (t["font-size"] += "px"), /px/i.test(String(t["letter-spacing"])) || (t["letter-spacing"] += "px"), /px/i.test(String(t["line-height"])) || (t["line-height"] += "px"), /#/i.test(String(t.color)) || (t.color = "#" + t.color), t.opacity = parseInt(String(t.opacity)) / 100, t.padding = "10px 37px 0px";
        let i = `<p style="${Object.keys(t).reduce((n,s)=>[...n,`${s}: ${t[s]}`],[]).join(";")}">${e}</p>`;
        return wh({
            str: i
        })
    }
});
var X6 = un((But, Ku) => {
    "use strict";
    var Se = function() {
            this.Diff_Timeout = 1, this.Diff_EditCost = 4, this.Match_Threshold = .5, this.Match_Distance = 1e3, this.Patch_DeleteThreshold = .5, this.Patch_Margin = 4, this.Match_MaxBits = 32
        },
        Io = -1,
        Do = 1,
        xt = 0;
    Se.Diff = function(e, t) {
        return [e, t]
    };
    Se.prototype.diff_main = function(e, t, o, i) {
        typeof i > "u" && (this.Diff_Timeout <= 0 ? i = Number.MAX_VALUE : i = new Date().getTime() + this.Diff_Timeout * 1e3);
        var n = i;
        if (e == null || t == null) throw new Error("Null input. (diff_main)");
        if (e == t) return e ? [new Se.Diff(xt, e)] : [];
        typeof o > "u" && (o = !0);
        var s = o,
            a = this.diff_commonPrefix(e, t),
            l = e.substring(0, a);
        e = e.substring(a), t = t.substring(a), a = this.diff_commonSuffix(e, t);
        var c = e.substring(e.length - a);
        e = e.substring(0, e.length - a), t = t.substring(0, t.length - a);
        var d = this.diff_compute_(e, t, s, n);
        return l && d.unshift(new Se.Diff(xt, l)), c && d.push(new Se.Diff(xt, c)), this.diff_cleanupMerge(d), d
    };
    Se.prototype.diff_compute_ = function(e, t, o, i) {
        var n;
        if (!e) return [new Se.Diff(Do, t)];
        if (!t) return [new Se.Diff(Io, e)];
        var s = e.length > t.length ? e : t,
            a = e.length > t.length ? t : e,
            l = s.indexOf(a);
        if (l != -1) return n = [new Se.Diff(Do, s.substring(0, l)), new Se.Diff(xt, a), new Se.Diff(Do, s.substring(l + a.length))], e.length > t.length && (n[0][0] = n[2][0] = Io), n;
        if (a.length == 1) return [new Se.Diff(Io, e), new Se.Diff(Do, t)];
        var c = this.diff_halfMatch_(e, t);
        if (c) {
            var d = c[0],
                p = c[1],
                h = c[2],
                u = c[3],
                m = c[4],
                f = this.diff_main(d, h, o, i),
                g = this.diff_main(p, u, o, i);
            return f.concat([new Se.Diff(xt, m)], g)
        }
        return o && e.length > 100 && t.length > 100 ? this.diff_lineMode_(e, t, i) : this.diff_bisect_(e, t, i)
    };
    Se.prototype.diff_lineMode_ = function(e, t, o) {
        var i = this.diff_linesToChars_(e, t);
        e = i.chars1, t = i.chars2;
        var n = i.lineArray,
            s = this.diff_main(e, t, !1, o);
        this.diff_charsToLines_(s, n), this.diff_cleanupSemantic(s), s.push(new Se.Diff(xt, ""));
        for (var a = 0, l = 0, c = 0, d = "", p = ""; a < s.length;) {
            switch (s[a][0]) {
                case Do:
                    c++, p += s[a][1];
                    break;
                case Io:
                    l++, d += s[a][1];
                    break;
                case xt:
                    if (l >= 1 && c >= 1) {
                        s.splice(a - l - c, l + c), a = a - l - c;
                        for (var h = this.diff_main(d, p, !1, o), u = h.length - 1; u >= 0; u--) s.splice(a, 0, h[u]);
                        a = a + h.length
                    }
                    c = 0, l = 0, d = "", p = "";
                    break
            }
            a++
        }
        return s.pop(), s
    };
    Se.prototype.diff_bisect_ = function(e, t, o) {
        for (var i = e.length, n = t.length, s = Math.ceil((i + n) / 2), a = s, l = 2 * s, c = new Array(l), d = new Array(l), p = 0; p < l; p++) c[p] = -1, d[p] = -1;
        c[a + 1] = 0, d[a + 1] = 0;
        for (var h = i - n, u = h % 2 != 0, m = 0, f = 0, g = 0, y = 0, S = 0; S < s && !(new Date().getTime() > o); S++) {
            for (var w = -S + m; w <= S - f; w += 2) {
                var v = a + w,
                    C;
                w == -S || w != S && c[v - 1] < c[v + 1] ? C = c[v + 1] : C = c[v - 1] + 1;
                for (var I = C - w; C < i && I < n && e.charAt(C) == t.charAt(I);) C++, I++;
                if (c[v] = C, C > i) f += 2;
                else if (I > n) m += 2;
                else if (u) {
                    var T = a + h - w;
                    if (T >= 0 && T < l && d[T] != -1) {
                        var P = i - d[T];
                        if (C >= P) return this.diff_bisectSplit_(e, t, C, I, o)
                    }
                }
            }
            for (var M = -S + g; M <= S - y; M += 2) {
                var T = a + M,
                    P;
                M == -S || M != S && d[T - 1] < d[T + 1] ? P = d[T + 1] : P = d[T - 1] + 1;
                for (var F = P - M; P < i && F < n && e.charAt(i - P - 1) == t.charAt(n - F - 1);) P++, F++;
                if (d[T] = P, P > i) y += 2;
                else if (F > n) g += 2;
                else if (!u) {
                    var v = a + h - M;
                    if (v >= 0 && v < l && c[v] != -1) {
                        var C = c[v],
                            I = a + C - v;
                        if (P = i - P, C >= P) return this.diff_bisectSplit_(e, t, C, I, o)
                    }
                }
            }
        }
        return [new Se.Diff(Io, e), new Se.Diff(Do, t)]
    };
    Se.prototype.diff_bisectSplit_ = function(e, t, o, i, n) {
        var s = e.substring(0, o),
            a = t.substring(0, i),
            l = e.substring(o),
            c = t.substring(i),
            d = this.diff_main(s, a, !1, n),
            p = this.diff_main(l, c, !1, n);
        return d.concat(p)
    };
    Se.prototype.diff_linesToChars_ = function(e, t) {
        var o = [],
            i = {};
        o[0] = "";

        function n(c) {
            for (var d = "", p = 0, h = -1, u = o.length; h < c.length - 1;) {
                h = c.indexOf(`
`, p), h == -1 && (h = c.length - 1);
                var m = c.substring(p, h + 1);
                (i.hasOwnProperty ? i.hasOwnProperty(m) : i[m] !== void 0) ? d += String.fromCharCode(i[m]): (u == s && (m = c.substring(p), h = c.length), d += String.fromCharCode(u), i[m] = u, o[u++] = m), p = h + 1
            }
            return d
        }
        var s = 4e4,
            a = n(e);
        s = 65535;
        var l = n(t);
        return {
            chars1: a,
            chars2: l,
            lineArray: o
        }
    };
    Se.prototype.diff_charsToLines_ = function(e, t) {
        for (var o = 0; o < e.length; o++) {
            for (var i = e[o][1], n = [], s = 0; s < i.length; s++) n[s] = t[i.charCodeAt(s)];
            e[o][1] = n.join("")
        }
    };
    Se.prototype.diff_commonPrefix = function(e, t) {
        if (!e || !t || e.charAt(0) != t.charAt(0)) return 0;
        for (var o = 0, i = Math.min(e.length, t.length), n = i, s = 0; o < n;) e.substring(s, n) == t.substring(s, n) ? (o = n, s = o) : i = n, n = Math.floor((i - o) / 2 + o);
        return n
    };
    Se.prototype.diff_commonSuffix = function(e, t) {
        if (!e || !t || e.charAt(e.length - 1) != t.charAt(t.length - 1)) return 0;
        for (var o = 0, i = Math.min(e.length, t.length), n = i, s = 0; o < n;) e.substring(e.length - n, e.length - s) == t.substring(t.length - n, t.length - s) ? (o = n, s = o) : i = n, n = Math.floor((i - o) / 2 + o);
        return n
    };
    Se.prototype.diff_commonOverlap_ = function(e, t) {
        var o = e.length,
            i = t.length;
        if (o == 0 || i == 0) return 0;
        o > i ? e = e.substring(o - i) : o < i && (t = t.substring(0, o));
        var n = Math.min(o, i);
        if (e == t) return n;
        for (var s = 0, a = 1;;) {
            var l = e.substring(n - a),
                c = t.indexOf(l);
            if (c == -1) return s;
            a += c, (c == 0 || e.substring(n - a) == t.substring(0, a)) && (s = a, a++)
        }
    };
    Se.prototype.diff_halfMatch_ = function(e, t) {
        if (this.Diff_Timeout <= 0) return null;
        var o = e.length > t.length ? e : t,
            i = e.length > t.length ? t : e;
        if (o.length < 4 || i.length * 2 < o.length) return null;
        var n = this;

        function s(f, g, y) {
            for (var S = f.substring(y, y + Math.floor(f.length / 4)), w = -1, v = "", C, I, T, P;
                (w = g.indexOf(S, w + 1)) != -1;) {
                var M = n.diff_commonPrefix(f.substring(y), g.substring(w)),
                    F = n.diff_commonSuffix(f.substring(0, y), g.substring(0, w));
                v.length < F + M && (v = g.substring(w - F, w) + g.substring(w, w + M), C = f.substring(0, y - F), I = f.substring(y + M), T = g.substring(0, w - F), P = g.substring(w + M))
            }
            return v.length * 2 >= f.length ? [C, I, T, P, v] : null
        }
        var a = s(o, i, Math.ceil(o.length / 4)),
            l = s(o, i, Math.ceil(o.length / 2)),
            c;
        if (!a && !l) return null;
        l ? a ? c = a[4].length > l[4].length ? a : l : c = l : c = a;
        var d, p, h, u;
        e.length > t.length ? (d = c[0], p = c[1], h = c[2], u = c[3]) : (h = c[0], u = c[1], d = c[2], p = c[3]);
        var m = c[4];
        return [d, p, h, u, m]
    };
    Se.prototype.diff_cleanupSemantic = function(e) {
        for (var t = !1, o = [], i = 0, n = null, s = 0, a = 0, l = 0, c = 0, d = 0; s < e.length;) e[s][0] == xt ? (o[i++] = s, a = c, l = d, c = 0, d = 0, n = e[s][1]) : (e[s][0] == Do ? c += e[s][1].length : d += e[s][1].length, n && n.length <= Math.max(a, l) && n.length <= Math.max(c, d) && (e.splice(o[i - 1], 0, new Se.Diff(Io, n)), e[o[i - 1] + 1][0] = Do, i--, i--, s = i > 0 ? o[i - 1] : -1, a = 0, l = 0, c = 0, d = 0, n = null, t = !0)), s++;
        for (t && this.diff_cleanupMerge(e), this.diff_cleanupSemanticLossless(e), s = 1; s < e.length;) {
            if (e[s - 1][0] == Io && e[s][0] == Do) {
                var p = e[s - 1][1],
                    h = e[s][1],
                    u = this.diff_commonOverlap_(p, h),
                    m = this.diff_commonOverlap_(h, p);
                u >= m ? (u >= p.length / 2 || u >= h.length / 2) && (e.splice(s, 0, new Se.Diff(xt, h.substring(0, u))), e[s - 1][1] = p.substring(0, p.length - u), e[s + 1][1] = h.substring(u), s++) : (m >= p.length / 2 || m >= h.length / 2) && (e.splice(s, 0, new Se.Diff(xt, p.substring(0, m))), e[s - 1][0] = Do, e[s - 1][1] = h.substring(0, h.length - m), e[s + 1][0] = Io, e[s + 1][1] = p.substring(m), s++), s++
            }
            s++
        }
    };
    Se.prototype.diff_cleanupSemanticLossless = function(e) {
        function t(m, f) {
            if (!m || !f) return 6;
            var g = m.charAt(m.length - 1),
                y = f.charAt(0),
                S = g.match(Se.nonAlphaNumericRegex_),
                w = y.match(Se.nonAlphaNumericRegex_),
                v = S && g.match(Se.whitespaceRegex_),
                C = w && y.match(Se.whitespaceRegex_),
                I = v && g.match(Se.linebreakRegex_),
                T = C && y.match(Se.linebreakRegex_),
                P = I && m.match(Se.blanklineEndRegex_),
                M = T && f.match(Se.blanklineStartRegex_);
            return P || M ? 5 : I || T ? 4 : S && !v && C ? 3 : v || C ? 2 : S || w ? 1 : 0
        }
        for (var o = 1; o < e.length - 1;) {
            if (e[o - 1][0] == xt && e[o + 1][0] == xt) {
                var i = e[o - 1][1],
                    n = e[o][1],
                    s = e[o + 1][1],
                    a = this.diff_commonSuffix(i, n);
                if (a) {
                    var l = n.substring(n.length - a);
                    i = i.substring(0, i.length - a), n = l + n.substring(0, n.length - a), s = l + s
                }
                for (var c = i, d = n, p = s, h = t(i, n) + t(n, s); n.charAt(0) === s.charAt(0);) {
                    i += n.charAt(0), n = n.substring(1) + s.charAt(0), s = s.substring(1);
                    var u = t(i, n) + t(n, s);
                    u >= h && (h = u, c = i, d = n, p = s)
                }
                e[o - 1][1] != c && (c ? e[o - 1][1] = c : (e.splice(o - 1, 1), o--), e[o][1] = d, p ? e[o + 1][1] = p : (e.splice(o + 1, 1), o--))
            }
            o++
        }
    };
    Se.nonAlphaNumericRegex_ = /[^a-zA-Z0-9]/;
    Se.whitespaceRegex_ = /\s/;
    Se.linebreakRegex_ = /[\r\n]/;
    Se.blanklineEndRegex_ = /\n\r?\n$/;
    Se.blanklineStartRegex_ = /^\r?\n\r?\n/;
    Se.prototype.diff_cleanupEfficiency = function(e) {
        for (var t = !1, o = [], i = 0, n = null, s = 0, a = !1, l = !1, c = !1, d = !1; s < e.length;) e[s][0] == xt ? (e[s][1].length < this.Diff_EditCost && (c || d) ? (o[i++] = s, a = c, l = d, n = e[s][1]) : (i = 0, n = null), c = d = !1) : (e[s][0] == Io ? d = !0 : c = !0, n && (a && l && c && d || n.length < this.Diff_EditCost / 2 && a + l + c + d == 3) && (e.splice(o[i - 1], 0, new Se.Diff(Io, n)), e[o[i - 1] + 1][0] = Do, i--, n = null, a && l ? (c = d = !0, i = 0) : (i--, s = i > 0 ? o[i - 1] : -1, c = d = !1), t = !0)), s++;
        t && this.diff_cleanupMerge(e)
    };
    Se.prototype.diff_cleanupMerge = function(e) {
        e.push(new Se.Diff(xt, ""));
        for (var t = 0, o = 0, i = 0, n = "", s = "", a; t < e.length;) switch (e[t][0]) {
            case Do:
                i++, s += e[t][1], t++;
                break;
            case Io:
                o++, n += e[t][1], t++;
                break;
            case xt:
                o + i > 1 ? (o !== 0 && i !== 0 && (a = this.diff_commonPrefix(s, n), a !== 0 && (t - o - i > 0 && e[t - o - i - 1][0] == xt ? e[t - o - i - 1][1] += s.substring(0, a) : (e.splice(0, 0, new Se.Diff(xt, s.substring(0, a))), t++), s = s.substring(a), n = n.substring(a)), a = this.diff_commonSuffix(s, n), a !== 0 && (e[t][1] = s.substring(s.length - a) + e[t][1], s = s.substring(0, s.length - a), n = n.substring(0, n.length - a))), t -= o + i, e.splice(t, o + i), n.length && (e.splice(t, 0, new Se.Diff(Io, n)), t++), s.length && (e.splice(t, 0, new Se.Diff(Do, s)), t++), t++) : t !== 0 && e[t - 1][0] == xt ? (e[t - 1][1] += e[t][1], e.splice(t, 1)) : t++, i = 0, o = 0, n = "", s = "";
                break
        }
        e[e.length - 1][1] === "" && e.pop();
        var l = !1;
        for (t = 1; t < e.length - 1;) e[t - 1][0] == xt && e[t + 1][0] == xt && (e[t][1].substring(e[t][1].length - e[t - 1][1].length) == e[t - 1][1] ? (e[t][1] = e[t - 1][1] + e[t][1].substring(0, e[t][1].length - e[t - 1][1].length), e[t + 1][1] = e[t - 1][1] + e[t + 1][1], e.splice(t - 1, 1), l = !0) : e[t][1].substring(0, e[t + 1][1].length) == e[t + 1][1] && (e[t - 1][1] += e[t + 1][1], e[t][1] = e[t][1].substring(e[t + 1][1].length) + e[t + 1][1], e.splice(t + 1, 1), l = !0)), t++;
        l && this.diff_cleanupMerge(e)
    };
    Se.prototype.diff_xIndex = function(e, t) {
        var o = 0,
            i = 0,
            n = 0,
            s = 0,
            a;
        for (a = 0; a < e.length && (e[a][0] !== Do && (o += e[a][1].length), e[a][0] !== Io && (i += e[a][1].length), !(o > t)); a++) n = o, s = i;
        return e.length != a && e[a][0] === Io ? s : s + (t - n)
    };
    Se.prototype.diff_prettyHtml = function(e) {
        for (var t = [], o = /&/g, i = /</g, n = />/g, s = /\n/g, a = 0; a < e.length; a++) {
            var l = e[a][0],
                c = e[a][1],
                d = c.replace(o, "&amp;").replace(i, "&lt;").replace(n, "&gt;").replace(s, "&para;<br>");
            switch (l) {
                case Do:
                    t[a] = '<ins style="background:#e6ffe6;">' + d + "</ins>";
                    break;
                case Io:
                    t[a] = '<del style="background:#ffe6e6;">' + d + "</del>";
                    break;
                case xt:
                    t[a] = "<span>" + d + "</span>";
                    break
            }
        }
        return t.join("")
    };
    Se.prototype.diff_text1 = function(e) {
        for (var t = [], o = 0; o < e.length; o++) e[o][0] !== Do && (t[o] = e[o][1]);
        return t.join("")
    };
    Se.prototype.diff_text2 = function(e) {
        for (var t = [], o = 0; o < e.length; o++) e[o][0] !== Io && (t[o] = e[o][1]);
        return t.join("")
    };
    Se.prototype.diff_levenshtein = function(e) {
        for (var t = 0, o = 0, i = 0, n = 0; n < e.length; n++) {
            var s = e[n][0],
                a = e[n][1];
            switch (s) {
                case Do:
                    o += a.length;
                    break;
                case Io:
                    i += a.length;
                    break;
                case xt:
                    t += Math.max(o, i), o = 0, i = 0;
                    break
            }
        }
        return t += Math.max(o, i), t
    };
    Se.prototype.diff_toDelta = function(e) {
        for (var t = [], o = 0; o < e.length; o++) switch (e[o][0]) {
            case Do:
                t[o] = "+" + encodeURI(e[o][1]);
                break;
            case Io:
                t[o] = "-" + e[o][1].length;
                break;
            case xt:
                t[o] = "=" + e[o][1].length;
                break
        }
        return t.join("	").replace(/%20/g, " ")
    };
    Se.prototype.diff_fromDelta = function(e, t) {
        for (var o = [], i = 0, n = 0, s = t.split(/\t/g), a = 0; a < s.length; a++) {
            var l = s[a].substring(1);
            switch (s[a].charAt(0)) {
                case "+":
                    try {
                        o[i++] = new Se.Diff(Do, decodeURI(l))
                    } catch {
                        throw new Error("Illegal escape in diff_fromDelta: " + l)
                    }
                    break;
                case "-":
                case "=":
                    var c = parseInt(l, 10);
                    if (isNaN(c) || c < 0) throw new Error("Invalid number in diff_fromDelta: " + l);
                    var d = e.substring(n, n += c);
                    s[a].charAt(0) == "=" ? o[i++] = new Se.Diff(xt, d) : o[i++] = new Se.Diff(Io, d);
                    break;
                default:
                    if (s[a]) throw new Error("Invalid diff operation in diff_fromDelta: " + s[a])
            }
        }
        if (n != e.length) throw new Error("Delta length (" + n + ") does not equal source text length (" + e.length + ").");
        return o
    };
    Se.prototype.match_main = function(e, t, o) {
        if (e == null || t == null || o == null) throw new Error("Null input. (match_main)");
        return o = Math.max(0, Math.min(o, e.length)), e == t ? 0 : e.length ? e.substring(o, o + t.length) == t ? o : this.match_bitap_(e, t, o) : -1
    };
    Se.prototype.match_bitap_ = function(e, t, o) {
        if (t.length > this.Match_MaxBits) throw new Error("Pattern too long for this browser.");
        var i = this.match_alphabet_(t),
            n = this;

        function s(C, I) {
            var T = C / t.length,
                P = Math.abs(o - I);
            return n.Match_Distance ? T + P / n.Match_Distance : P ? 1 : T
        }
        var a = this.Match_Threshold,
            l = e.indexOf(t, o);
        l != -1 && (a = Math.min(s(0, l), a), l = e.lastIndexOf(t, o + t.length), l != -1 && (a = Math.min(s(0, l), a)));
        var c = 1 << t.length - 1;
        l = -1;
        for (var d, p, h = t.length + e.length, u, m = 0; m < t.length; m++) {
            for (d = 0, p = h; d < p;) s(m, o + p) <= a ? d = p : h = p, p = Math.floor((h - d) / 2 + d);
            h = p;
            var f = Math.max(1, o - p + 1),
                g = Math.min(o + p, e.length) + t.length,
                y = Array(g + 2);
            y[g + 1] = (1 << m) - 1;
            for (var S = g; S >= f; S--) {
                var w = i[e.charAt(S - 1)];
                if (m === 0 ? y[S] = (y[S + 1] << 1 | 1) & w : y[S] = (y[S + 1] << 1 | 1) & w | ((u[S + 1] | u[S]) << 1 | 1) | u[S + 1], y[S] & c) {
                    var v = s(m, S - 1);
                    if (v <= a)
                        if (a = v, l = S - 1, l > o) f = Math.max(1, 2 * o - l);
                        else break
                }
            }
            if (s(m + 1, o) > a) break;
            u = y
        }
        return l
    };
    Se.prototype.match_alphabet_ = function(e) {
        for (var t = {}, o = 0; o < e.length; o++) t[e.charAt(o)] = 0;
        for (var o = 0; o < e.length; o++) t[e.charAt(o)] |= 1 << e.length - o - 1;
        return t
    };
    Se.prototype.patch_addContext_ = function(e, t) {
        if (t.length != 0) {
            if (e.start2 === null) throw Error("patch not initialized");
            for (var o = t.substring(e.start2, e.start2 + e.length1), i = 0; t.indexOf(o) != t.lastIndexOf(o) && o.length < this.Match_MaxBits - this.Patch_Margin - this.Patch_Margin;) i += this.Patch_Margin, o = t.substring(e.start2 - i, e.start2 + e.length1 + i);
            i += this.Patch_Margin;
            var n = t.substring(e.start2 - i, e.start2);
            n && e.diffs.unshift(new Se.Diff(xt, n));
            var s = t.substring(e.start2 + e.length1, e.start2 + e.length1 + i);
            s && e.diffs.push(new Se.Diff(xt, s)), e.start1 -= n.length, e.start2 -= n.length, e.length1 += n.length + s.length, e.length2 += n.length + s.length
        }
    };
    Se.prototype.patch_make = function(e, t, o) {
        var i, n;
        if (typeof e == "string" && typeof t == "string" && typeof o > "u") i = e, n = this.diff_main(i, t, !0), n.length > 2 && (this.diff_cleanupSemantic(n), this.diff_cleanupEfficiency(n));
        else if (e && typeof e == "object" && typeof t > "u" && typeof o > "u") n = e, i = this.diff_text1(n);
        else if (typeof e == "string" && t && typeof t == "object" && typeof o > "u") i = e, n = t;
        else if (typeof e == "string" && typeof t == "string" && o && typeof o == "object") i = e, n = o;
        else throw new Error("Unknown call format to patch_make.");
        if (n.length === 0) return [];
        for (var s = [], a = new Se.patch_obj, l = 0, c = 0, d = 0, p = i, h = i, u = 0; u < n.length; u++) {
            var m = n[u][0],
                f = n[u][1];
            switch (!l && m !== xt && (a.start1 = c, a.start2 = d), m) {
                case Do:
                    a.diffs[l++] = n[u], a.length2 += f.length, h = h.substring(0, d) + f + h.substring(d);
                    break;
                case Io:
                    a.length1 += f.length, a.diffs[l++] = n[u], h = h.substring(0, d) + h.substring(d + f.length);
                    break;
                case xt:
                    f.length <= 2 * this.Patch_Margin && l && n.length != u + 1 ? (a.diffs[l++] = n[u], a.length1 += f.length, a.length2 += f.length) : f.length >= 2 * this.Patch_Margin && l && (this.patch_addContext_(a, p), s.push(a), a = new Se.patch_obj, l = 0, p = h, c = d);
                    break
            }
            m !== Do && (c += f.length), m !== Io && (d += f.length)
        }
        return l && (this.patch_addContext_(a, p), s.push(a)), s
    };
    Se.prototype.patch_deepCopy = function(e) {
        for (var t = [], o = 0; o < e.length; o++) {
            var i = e[o],
                n = new Se.patch_obj;
            n.diffs = [];
            for (var s = 0; s < i.diffs.length; s++) n.diffs[s] = new Se.Diff(i.diffs[s][0], i.diffs[s][1]);
            n.start1 = i.start1, n.start2 = i.start2, n.length1 = i.length1, n.length2 = i.length2, t[o] = n
        }
        return t
    };
    Se.prototype.patch_apply = function(e, t) {
        if (e.length == 0) return [t, []];
        e = this.patch_deepCopy(e);
        var o = this.patch_addPadding(e);
        t = o + t + o, this.patch_splitMax(e);
        for (var i = 0, n = [], s = 0; s < e.length; s++) {
            var a = e[s].start2 + i,
                l = this.diff_text1(e[s].diffs),
                c, d = -1;
            if (l.length > this.Match_MaxBits ? (c = this.match_main(t, l.substring(0, this.Match_MaxBits), a), c != -1 && (d = this.match_main(t, l.substring(l.length - this.Match_MaxBits), a + l.length - this.Match_MaxBits), (d == -1 || c >= d) && (c = -1))) : c = this.match_main(t, l, a), c == -1) n[s] = !1, i -= e[s].length2 - e[s].length1;
            else {
                n[s] = !0, i = c - a;
                var p;
                if (d == -1 ? p = t.substring(c, c + l.length) : p = t.substring(c, d + this.Match_MaxBits), l == p) t = t.substring(0, c) + this.diff_text2(e[s].diffs) + t.substring(c + l.length);
                else {
                    var h = this.diff_main(l, p, !1);
                    if (l.length > this.Match_MaxBits && this.diff_levenshtein(h) / l.length > this.Patch_DeleteThreshold) n[s] = !1;
                    else {
                        this.diff_cleanupSemanticLossless(h);
                        for (var u = 0, m, f = 0; f < e[s].diffs.length; f++) {
                            var g = e[s].diffs[f];
                            g[0] !== xt && (m = this.diff_xIndex(h, u)), g[0] === Do ? t = t.substring(0, c + m) + g[1] + t.substring(c + m) : g[0] === Io && (t = t.substring(0, c + m) + t.substring(c + this.diff_xIndex(h, u + g[1].length))), g[0] !== Io && (u += g[1].length)
                        }
                    }
                }
            }
        }
        return t = t.substring(o.length, t.length - o.length), [t, n]
    };
    Se.prototype.patch_addPadding = function(e) {
        for (var t = this.Patch_Margin, o = "", i = 1; i <= t; i++) o += String.fromCharCode(i);
        for (var i = 0; i < e.length; i++) e[i].start1 += t, e[i].start2 += t;
        var n = e[0],
            s = n.diffs;
        if (s.length == 0 || s[0][0] != xt) s.unshift(new Se.Diff(xt, o)), n.start1 -= t, n.start2 -= t, n.length1 += t, n.length2 += t;
        else if (t > s[0][1].length) {
            var a = t - s[0][1].length;
            s[0][1] = o.substring(s[0][1].length) + s[0][1], n.start1 -= a, n.start2 -= a, n.length1 += a, n.length2 += a
        }
        if (n = e[e.length - 1], s = n.diffs, s.length == 0 || s[s.length - 1][0] != xt) s.push(new Se.Diff(xt, o)), n.length1 += t, n.length2 += t;
        else if (t > s[s.length - 1][1].length) {
            var a = t - s[s.length - 1][1].length;
            s[s.length - 1][1] += o.substring(0, a), n.length1 += a, n.length2 += a
        }
        return o
    };
    Se.prototype.patch_splitMax = function(e) {
        for (var t = this.Match_MaxBits, o = 0; o < e.length; o++)
            if (!(e[o].length1 <= t)) {
                var i = e[o];
                e.splice(o--, 1);
                for (var n = i.start1, s = i.start2, a = ""; i.diffs.length !== 0;) {
                    var l = new Se.patch_obj,
                        c = !0;
                    for (l.start1 = n - a.length, l.start2 = s - a.length, a !== "" && (l.length1 = l.length2 = a.length, l.diffs.push(new Se.Diff(xt, a))); i.diffs.length !== 0 && l.length1 < t - this.Patch_Margin;) {
                        var d = i.diffs[0][0],
                            p = i.diffs[0][1];
                        d === Do ? (l.length2 += p.length, s += p.length, l.diffs.push(i.diffs.shift()), c = !1) : d === Io && l.diffs.length == 1 && l.diffs[0][0] == xt && p.length > 2 * t ? (l.length1 += p.length, n += p.length, c = !1, l.diffs.push(new Se.Diff(d, p)), i.diffs.shift()) : (p = p.substring(0, t - l.length1 - this.Patch_Margin), l.length1 += p.length, n += p.length, d === xt ? (l.length2 += p.length, s += p.length) : c = !1, l.diffs.push(new Se.Diff(d, p)), p == i.diffs[0][1] ? i.diffs.shift() : i.diffs[0][1] = i.diffs[0][1].substring(p.length))
                    }
                    a = this.diff_text2(l.diffs), a = a.substring(a.length - this.Patch_Margin);
                    var h = this.diff_text1(i.diffs).substring(0, this.Patch_Margin);
                    h !== "" && (l.length1 += h.length, l.length2 += h.length, l.diffs.length !== 0 && l.diffs[l.diffs.length - 1][0] === xt ? l.diffs[l.diffs.length - 1][1] += h : l.diffs.push(new Se.Diff(xt, h))), c || e.splice(++o, 0, l)
                }
            }
    };
    Se.prototype.patch_toText = function(e) {
        for (var t = [], o = 0; o < e.length; o++) t[o] = e[o];
        return t.join("")
    };
    Se.prototype.patch_fromText = function(e) {
        var t = [];
        if (!e) return t;
        for (var o = e.split(`
`), i = 0, n = /^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/; i < o.length;) {
            var s = o[i].match(n);
            if (!s) throw new Error("Invalid patch string: " + o[i]);
            var a = new Se.patch_obj;
            for (t.push(a), a.start1 = parseInt(s[1], 10), s[2] === "" ? (a.start1--, a.length1 = 1) : s[2] == "0" ? a.length1 = 0 : (a.start1--, a.length1 = parseInt(s[2], 10)), a.start2 = parseInt(s[3], 10), s[4] === "" ? (a.start2--, a.length2 = 1) : s[4] == "0" ? a.length2 = 0 : (a.start2--, a.length2 = parseInt(s[4], 10)), i++; i < o.length;) {
                var l = o[i].charAt(0);
                try {
                    var c = decodeURI(o[i].substring(1))
                } catch {
                    throw new Error("Illegal escape in patch_fromText: " + c)
                }
                if (l == "-") a.diffs.push(new Se.Diff(Io, c));
                else if (l == "+") a.diffs.push(new Se.Diff(Do, c));
                else if (l == " ") a.diffs.push(new Se.Diff(xt, c));
                else {
                    if (l == "@") break;
                    if (l !== "") throw new Error('Invalid patch mode "' + l + '" in: ' + c)
                }
                i++
            }
        }
        return t
    };
    Se.patch_obj = function() {
        this.diffs = [], this.start1 = null, this.start2 = null, this.length1 = 0, this.length2 = 0
    };
    Se.patch_obj.prototype.toString = function() {
        var e, t;
        this.length1 === 0 ? e = this.start1 + ",0" : this.length1 == 1 ? e = this.start1 + 1 : e = this.start1 + 1 + "," + this.length1, this.length2 === 0 ? t = this.start2 + ",0" : this.length2 == 1 ? t = this.start2 + 1 : t = this.start2 + 1 + "," + this.length2;
        for (var o = ["@@ -" + e + " +" + t + ` @@
`], i, n = 0; n < this.diffs.length; n++) {
            switch (this.diffs[n][0]) {
                case Do:
                    i = "+";
                    break;
                case Io:
                    i = "-";
                    break;
                case xt:
                    i = " ";
                    break
            }
            o[n + 1] = i + encodeURI(this.diffs[n][1]) + `
`
        }
        return o.join("").replace(/%20/g, " ")
    };
    Ku.exports = Se;
    Ku.exports.diff_match_patch = Se;
    Ku.exports.DIFF_DELETE = Io;
    Ku.exports.DIFF_INSERT = Do;
    Ku.exports.DIFF_EQUAL = xt
});
var K6, Ju, Yoe, Zoe, Xoe, J6, q6 = k(() => {
    "use strict";
    K6 = E(X6()), Ju = E(hn());
    Dn();
    Yoe = (e, t, o) => {
        let i = Zoe(e, t, o),
            n = i.chars1,
            s = i.chars2,
            a = i.groupArray,
            l = new K6.diff_match_patch,
            c = l.diff_main(n, s, !1);
        return l.diff_charsToLines_(c, a), c
    }, Zoe = (e, t, o) => {
        let i = [""],
            n = {},
            s = c => {
                let d = "",
                    p = 0,
                    h = -1,
                    u = i.length;
                for (; h < c.length - 1;) {
                    h = Xoe(c, o, p), h === -1 && (h = c.length - 1);
                    let m = c.substring(p, h + 1);
                    p = h + 1, n.hasOwnProperty(m) ? d += String.fromCharCode(n[m]) : (d += String.fromCharCode(u), n[m] = u, i[u++] = m)
                }
                return d
            },
            a = s(e),
            l = s(t);
        return {
            chars1: a,
            chars2: l,
            groupArray: i
        }
    }, Xoe = (e, t, o) => {
        let i = e.substring(o || 0).search(t);
        return i >= 0 ? i + (o || 0) : i
    }, J6 = (e, t) => {
        let o = Yoe(e, t, /\s/);
        if (!o || !o.length) return [];
        let i = [];
        return o.forEach((s, a) => {
            if (s) {
                let [l] = s;
                if (l === 0) i.push(s);
                else {
                    let c = o[a + 1];
                    c && l === -1 && c[0] === 1 ? (i.push([s, c]), o[a + 1] = null) : i.push(s)
                }
            }
        }), (0, Ju.flatten)(i.map(s => {
            if ((0, Ju.isArray)(s) && (0, Ju.isArray)(s[0]) && (0, Ju.isArray)(s[1])) {
                let [a, l] = s[0], [c, d] = s[1];
                return {
                    type: "Replaced",
                    textBefore: a === -1 ? l : d,
                    textAfter: c === 1 ? d : l
                }
            } else {
                let [a, l] = s;
                return {
                    type: a === 1 ? "Added" : a === 0 ? "NotChanged" : "Removed",
                    text: l
                }
            }
        }))
    }
});

function Koe({
    blocks: e,
    minifiedStyles: t
}) {
    let o = t.map(n => ({ ...n,
            inlineStyles: Uk(n.inlineStyles)
        })),
        i = e;
    return e.forEach(n => {
        if (n) {
            let s = n.getKey(),
                a = n.getCharacterList(),
                l = o.find(h => h.key === s),
                c = (0, eW.default)(n.getText(), l ? .inlineStyles),
                d = a.map((h, u) => h && (typeof u == "number" ? h.set("style", c[u]) : h)),
                p = n.set("characterList", d);
            i = i.set(s, p)
        }
    }), Lm.ContentState.createFromBlockArray(i.toArray())
}

function Joe(e) {
    let t = [];
    return e.map(o => {
        o && t.push({
            key: o ? .getKey(),
            type: o ? .getType(),
            inlineStyles: Nk((0, Q6.default)(o))
        })
    }), t
}

function tW({
    model: e,
    oldState: t,
    newState: o,
    currentViewport: i
}) {
    let n = o.getCurrentContent(),
        s = mf(n),
        a = Wk(n);
    qoe({
        model: e,
        currentViewport: i,
        currentEntityMap: s || {}
    }), eie({
        model: e,
        currentViewport: i,
        currentMeta: a || []
    }), tie({
        oldState: t,
        newState: o,
        model: e,
        currentViewport: i
    })
}

function qoe({
    model: e,
    currentViewport: t,
    currentEntityMap: o
}) {
    let i = "viewport_default";
    t !== i && !e[i] ? .entityMap && (e[i].entityMap = o), Oe.viewport_listall.forEach(n => {
        if (t !== n && e[n]) {
            let s = e[n].entityMap;
            if (s) {
                let a = Object.values(s).map(c => c.data ? .id),
                    l = Object.values(o).map(c => c.data ? .id);
                if (l.length > a.length) {
                    let c = Object.keys(o).reduce((d, p) => {
                        let h = o[p],
                            u = Object.keys(s).find(m => s[m].data ? .id === h.data ? .id);
                        return u ? Object.assign(d, {
                            [p]: s[u]
                        }) : Object.assign(d, {
                            [p]: o[p]
                        }), d
                    }, {});
                    e[n].entityMap = c
                } else if (l.length < a.length) {
                    let c = Object.keys(o).reduce((d, p) => {
                        let h = o[p],
                            u = Object.keys(s).find(m => s[m].data ? .id === h.data ? .id);
                        return u && Object.assign(d, {
                            [p]: s[u]
                        }), d
                    }, {});
                    e[n].entityMap = c
                } else e[n].entityMap = Qoe({
                    source: o,
                    destination: s
                })
            }
        }
    })
}

function Qoe({
    source: e,
    destination: t
}) {
    return Object.keys(t).reduce((o, i) => {
        let n = t[i];
        if (n.type === Qd && Object.keys(n.data).length) {
            let s = e[i];
            if (s) {
                let a = s.data,
                    l = n.data.type === a.type && a.type === "Anchor";
                a && !l && (n.data = { ...n.data,
                    url: a.url,
                    target: a.target,
                    type: a.type,
                    anchorPosition: a.anchorPosition,
                    pageNum: a.pageNum,
                    pageId: a.pageId
                })
            }
        }
        return o[i] = n, o
    }, {})
}

function eie({
    model: e,
    currentViewport: t,
    currentMeta: o
}) {
    let i = "viewport_default";
    t !== i && !e[i] ? .blocksMeta && (e[i].blocksMeta = o), Oe.viewport_listall.forEach(n => {
        if (t !== n && e[n]) {
            let s = e[n].blocksMeta;
            if (s) {
                let a = s.map(c => c.key),
                    l = o.map(c => c.key);
                if (l.length > a.length) {
                    let c = (0, JS.difference)(l, a),
                        d = o.filter(p => c.includes(p.key));
                    e[n].blocksMeta = [...e[n].blocksMeta, ...d]
                } else if (l.length < a.length) {
                    let c = (0, JS.difference)(a, l),
                        d = s.filter(p => !c.includes(p.key));
                    e[n].blocksMeta = d
                } else {
                    let c = s;
                    o.forEach(d => {
                        if (d && d.data) {
                            let p = d.key,
                                h = d.data[Av];
                            if (typeof h == "number") {
                                let u = c.findIndex(m => m.key === p);
                                u > -1 && c[u] ? .data && (c[u].data = { ...c[u].data,
                                    [Av]: h
                                })
                            }
                        }
                    }), e[n].blocksMeta = c
                }
            }
        }
    })
}

function tie({
    oldState: e,
    newState: t,
    model: o,
    currentViewport: i
}) {
    let s = e.getCurrentContent().getBlockMap(),
        a = s.toArray(),
        d = t.getCurrentContent().getBlockMap().toArray(),
        p = d.filter(y => {
            if (!y) return !1;
            let S = a.find(w => w.getKey() === y.getKey());
            return S ? y.getLength() !== S.getLength() : !1
        }),
        h = a.map(y => y.getKey()),
        u = d.length > a.length ? d.filter(y => !h.includes(y.getKey())) : [],
        m = u.length ? u.map(y => y.getKey()) : [],
        f = u.length ? d.findIndex(y => y.getKey() === u[0].getKey()) : -1,
        g = f > -1 && a[f - 1] || null;
    if (p.length) {
        for (let y of Oe.viewport_listall)
            if (i !== y && o[y]) {
                let S = o[y].styles,
                    w = o[y].entityMap,
                    v = o[y].blocksMeta;
                if (S && v && w) {
                    let C = Lm.EditorState.createWithContent(Koe({
                            blocks: s,
                            minifiedStyles: S
                        })),
                        T = p.reduce((M, F) => {
                            let R = F.getKey(),
                                A = F.getText(),
                                D = a.find(O => O.getKey() === R);
                            if (D) {
                                let O = J6(D.getText(), A);
                                if (O.length) {
                                    let L = 0;
                                    return O.reduce((W, z) => {
                                        if (z.type === "NotChanged") L += z.text.length;
                                        else if (z.type === "Added") {
                                            let V = W.getSelection().merge({
                                                anchorKey: R,
                                                anchorOffset: L,
                                                focusOffset: L,
                                                focusKey: R
                                            });
                                            return L += z.text.length, Yc({
                                                editorState: At(W, V),
                                                text: z.text,
                                                selection: V
                                            })
                                        } else if (z.type === "Removed") {
                                            let V = W.getSelection().merge({
                                                anchorKey: R,
                                                anchorOffset: L,
                                                focusOffset: L + z.text.length,
                                                focusKey: R
                                            });
                                            return Lk({
                                                editorState: W,
                                                selection: V
                                            })
                                        } else if (z.type === "Replaced") {
                                            let V = z.textBefore.length,
                                                X = z.textAfter.length,
                                                q = W.getSelection().merge({
                                                    anchorKey: R,
                                                    anchorOffset: L,
                                                    focusOffset: L + V,
                                                    focusKey: R
                                                });
                                            return L += X - V, Yc({
                                                editorState: At(W, q),
                                                text: z.textAfter,
                                                selection: q
                                            })
                                        }
                                        return W
                                    }, M)
                                }
                            }
                            return M
                        }, C).getCurrentContent();
                    if (u.length && g) {
                        let M = g ? T.getBlockForKey(g.getKey()).getCharacterList().last().getStyle() : null;
                        if (M) {
                            let R = Xk({
                                originStyles: M,
                                blockMap: t.getCurrentContent().getBlockMap().filter(A => !!(A && m.includes(A.getKey()))),
                                forceOverride: !0
                            }).reduce((A, D) => A && D ? A.set(D.getKey(), D) : A, T.getBlockMap());
                            T = Lm.ContentState.createFromBlockArray(R.toArray())
                        }
                    }
                    let P = Joe(T.getBlockMap());
                    o[y].styles = P
                }
            }
    }
}
var JS, Lm, Q6, eW, oW = k(() => {
    "use strict";
    JS = E(hn()), Lm = E(yv()), Q6 = E(uj()), eW = E(hj());
    Yt();
    Wo();
    Bj();
    uh();
    Dn();
    q6()
});
var iW, Ha, nW, _l, qu, zd, oie, $d, Xy = k(() => {
    "use strict";
    iW = E(gi()), Ha = E(hn()), nW = E(To());
    oo();
    _l = E(N()), qu = E(Ze());
    Ro();
    Le();
    g1();
    Dn();
    Wo();
    Yt();
    $p();
    $p();
    yj();
    On();
    zd = E(yv());
    Cj();
    Or();
    KS();
    lh();
    ih();
    nf();
    Zr(); of ();
    Mt();
    cw();
    _s();
    Ss();
    qi();
    mp();
    _k();
    oW();
    pi();
    En();
    wc();
    Ht();
    dk();
    FC();
    yw();
    B();
    oie = me.extend({
        name: "Text",
        thumb: "text",
        icon_color: "#fff",
        sort_index: 1,
        titleShortcut: "T",
        controls: ["text_edit", "text_align", "common_rotation", pt("constructor.ai") ? "text_ai" : null, "common_interactions", "common_cursor", "common_draggable", "common_align", "common_position", "common_layer", "my_preset"].filter(Boolean),
        edit_controls: ["text_typography", "text_align", "text_advanced_typography", "text_insert", "text_link", "text_columns", "text_color", "text_shadow"],
        controlsDividers: [pt("constructor.ai") ? "text_ai" : "common_rotation", "common_draggable"],
        groupControlsDividers: ["common_shadow", pt("constructor.ai") ? "text_ai" : "text_color"].filter(Boolean),
        groupControls: Object.assign({
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            7: "common_arrange",
            8: "common_interactions",
            9: "common_cursor",
            10: "common_draggable",
            11: "common_shadow",
            12: "common_position",
            13: "common_layer",
            14: "readymag_preset",
            15: "my_preset"
        }, pt("constructor.ai") ? {
            6: "text_ai"
        } : {}),
        iconData: {
            $svg: (0, qu.default)('<svg width="32" height="38" viewBox="0 0 32 38" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 2C0 3.10457 0.895431 4 2 4L14 4V36C14 37.1046 14.8954 38 16 38C17.1046 38 18 37.1046 18 36V4L30 4C31.1046 4 32 3.10457 32 2C32 0.89543 31.1046 0 30 0H2C0.89543 0 0 0.895431 0 2Z" fill="black"/></svg>')
        },
        initialize: function(e, t) {
            let o = e;
            this.migrateOldData(o, t), this.setEditorZoom(window.RM.constructorRouter.zoom.getZoom());
            try {
                this.initialSharedState = Ll(o)
            } catch (i) {
                throw console.error(i), new Error("Cannot create Text widget model")
            }
            if (this.isJustCreated = o.created, this.has_parent_block = !!o.get("parent_wid"), this.isJustCreated) {
                if (this.has_parent_block) {
                    let a = Ah({
                        text: "Text"
                    });
                    o.set("blocks", a.blocks), this.initialSharedState = Ll(o)
                }
                let i = At(this.initialSharedState, hf({
                        content: this.initialSharedState.getCurrentContent(),
                        selection: this.initialSharedState.getSelection()
                    })),
                    n = t.mag.edit_params.get(de.textWidget.cachedTextStyleKey),
                    s = gf(i, n);
                this.initialSharedState = zd.EditorState.set(i, {
                    currentContent: s.getCurrentContent()
                }), this.has_parent_block && (this.initialSharedState = dh({
                    editorState: this.initialSharedState,
                    paddings: {
                        top: 16,
                        left: 16,
                        right: 16,
                        bottom: 16
                    }
                }), this.initialSharedState = qd({
                    editorState: this.initialSharedState,
                    align: "align-center"
                })), o.save(wr(this.initialSharedState.getCurrentContent()), {
                    skipHistory: !0,
                    silent: !0,
                    toHistory: !1
                })
            }
            this.initBlock(o, t), this.page = t.page, this.propsModel = new nW.default.Model({
                useTextWidgetStore: this.useSharedState,
                viewport: this.page.getCurrentViewport(),
                isEditMode: !1,
                fontStyles: [],
                isResizing: !1,
                selected: !1,
                workspace: t,
                isJustCreated: this.isJustCreated,
                disableSelectionHighlight: !1,
                setCurrentLinkStyle: i => {
                    this.propsModel.set("currentLinkStyle", i)
                },
                leaveEditMode: () => {
                    this.leaveEditMode()
                },
                canControlsBeClosed: () => this.canControlsBeClosed(),
                onIframeLoaded: () => {
                    this.onIframeLoaded()
                }
            }), this.page.on("change:viewport", this.onViewportChange), this.page.on("change-height-start", this.onResizeStart), this.page.on("change-height-end", this.onResizeEnd), this.model.on("change", this.modelChangeCallback), this.model.on("change:autosize", this.onAutosizeChanged), this.model.on("change:columns", this.onAutosizeChanged), this.workspace.on("autoLayout", this.onRestoreLayout), window.RM.constructorRouter.on("font-added", this.onFontsChanged), bt.on("zoom", this.setEditorZoom), this.onFontsChanged(), this.validateViewportTextData(), this.validateViewportHeightDebounced = Ha.default.debounce(this.validateViewportHeight, 500), this.saveEditParams = Ha.default.debounce(this.workspace.mag.edit_params.save, 500), this.groupControls[3] = "text_typography", this.groupControls[4] = "text_align", this.groupControls[5] = "text_color"
        },
        render: function() {
            this.create(), this.$el.addClass("text-v3"), this.onAutosizeChanged({
                disableHeightCheck: !0
            }), An({
                component: () => r(va, {
                    context: Sk,
                    model: this.propsModel,
                    children: r(f1, {})
                }),
                domElement: this.$content[0],
                model: this.model,
                onDestroy: () => {
                    let t = this.$content[0];
                    iW.default.unmountComponentAtNode(t), t && t.parentNode && t.parentNode.removeChild(t)
                }
            }), this.reactContainer = this.$content.find("div").first().get(0), this.rendered = !0, this.triggerReady(), this.isJustCreated && setTimeout(() => {
                this.enterEditMode()
            }, 200)
        },
        migrateOldData(e, t) {
            let o = {
                    silent: !0,
                    toHistory: !1,
                    skipHistory: !0
                },
                i = e.get("version"),
                n = e.get("flags");
            if (i !== 3) {
                let s = Y6(e.toJSON());
                if (!s) throw console.error(s), new Error("Text widget migration error");
                e.save(s, o), this.fixViewportsAfterMigration(e)
            } else if (!n || !n.updatedLinks) {
                let s = G6(e.toJSON(), t.mag);
                e.save(s, o)
            }
        },
        startRedirectIframeEvents: function() {
            let e = this.iframe ? .contentWindow ? .document ? .querySelector("body");
            e && (e.addEventListener("mousemove", this.onRedirectIframeEvents), e.addEventListener("mouseup", this.onRedirectIframeEvents), e.addEventListener("click", this.onRedirectIframeEvents))
        },
        onRedirectIframeEvents: function(e) {
            let t = new MouseEvent(e.type, {
                clientX: this.$el.offset().left * this.zoom + e.clientX * this.zoom - Mp * this.zoom,
                clientY: this.$el.offset().top * this.zoom + e.clientY * this.zoom - Mp * this.zoom,
                button: e.button,
                buttons: e.buttons,
                movementX: e.movementX,
                movementY: e.movementY,
                relatedTarget: e.relatedTarget,
                bubbles: !0,
                cancelable: !0
            });
            Object.defineProperty(t, "target", {
                value: e.target,
                enumerable: !0
            }), Object.defineProperty(t, "screenX", {
                value: e.screenX,
                enumerable: !0
            }), Object.defineProperty(t, "screenY", {
                value: e.screenY,
                enumerable: !0
            }), this.disableMouseEventsRedirection || (window.dispatchEvent(t), document.dispatchEvent(t))
        },
        stopRedirectIframeEvents: function() {
            let e = this.iframe ? .contentWindow ? .document ? .querySelector("body");
            e && (e.removeEventListener("mousemove", this.onRedirectIframeEvents), e.removeEventListener("mouseup", this.onRedirectIframeEvents), e.removeEventListener("click", this.onRedirectIframeEvents))
        },
        setEditorZoom(e) {
            this.zoom = e
        },
        destroy: function() {
            return this.leaveEditMode(), this.page.off("change:viewport", this.onViewportChange), this.page.off("change-height-start", this.onResizeStart), this.page.off("change-height-end", this.onResizeEnd), this.model.off("change", this.modelChangeCallback), this.model.off("change:autosize", this.onAutosizeChanged), this.model.off("change:columns", this.onAutosizeChanged), this.workspace.off("autoLayout", this.onRestoreLayout), window.RM.constructorRouter.off("font-added", this.onFontsChanged), bt.off("zoom", this.setEditorZoom), this.stopRedirectIframeEvents(), me.prototype.destroy.apply(this)
        },
        select: function(e, t) {
            me.prototype.select.apply(this, [e, t]), this.propsModel.set({
                selected: this.selected
            })
        },
        deselect: function(e) {
            this.clearJustCreatedState(), this.selected && this.validateViewportHeightDebounced(), me.prototype.deselect.apply(this, [e]), this.propsModel.set({
                selected: this.selected
            }), this.propsModel.get("isEditMode") && this.leaveEditMode()
        },
        clearJustCreatedState: function() {
            this.isJustCreated && (this.isJustCreated = !1, this.model.created = !1, this.propsModel.set({
                isJustCreated: !1
            }))
        },
        storeCopiedStyles: function() {
            let e = this.model.get("styles"),
                t = Ha.default.map(e, l => {
                    let c = {};
                    return l.inlineStyles && Ha.default.each(l.inlineStyles.styles, d => {
                        Ha.default.each(d.styles, p => {
                            let [h, u] = p.split(np);
                            c[l.inlineStyles.keys[Number(h)]] = l.inlineStyles.values[Number(u)]
                        })
                    }), c
                }),
                o = l => Ha.default.chain(this.model.attributes.blocksMeta).map(c => c.data && c.data[l]).filter(c => c).value()[0],
                i = o("textStyle"),
                n = o("listStyle"),
                s = Ha.default.chain(this.model.attributes.entityMap).map(l => l && l.type === "LINK" && l.data && l.data.linkStyle).filter(l => l).value()[0],
                a = this.model.attributes.blocksMeta[0] ? .data;
            localStorage.setItem("copiedStyle", JSON.stringify({
                textStyle: i,
                linkStyle: s,
                listStyle: n,
                inlineStyles: { ...t[0],
                    [Fl]: a && a.hasOwnProperty(Fl) ? a[Fl] : void 0,
                    [Vc]: a && a.hasOwnProperty(Vc) ? a[Vc] : void 0,
                    [hh]: a && a.hasOwnProperty(hh) ? a[hh] : void 0
                }
            }))
        },
        applyCopiedStyles: function() {
            if (this.propsModel.get("isEditMode")) return;
            let e;
            try {
                e = JSON.parse(localStorage.getItem("copiedStyle") || "")
            } catch {
                return
            }
            let t = Ll(this.model);
            t = At(t, hf({
                content: t.getCurrentContent()
            }));
            let {
                inlineStyles: o,
                textStyle: i,
                listStyle: n,
                linkStyle: s
            } = e || {};
            if (i) {
                let p = xv(),
                    u = [...p.global, ...p.project].find(m => m.name === i);
                u && (t = sp({
                    style: u,
                    editorState: t
                }))
            }
            if (n) {
                let p = bk(),
                    u = [...p.global, ...p.project].find(m => m.name === n);
                u && (t = hp({
                    style: u,
                    editorState: t
                }))
            }
            if (s) {
                let p = gk(),
                    u = [...p.global, ...p.project].find(f => f.name === s),
                    m = t.getCurrentContent();
                if (u) {
                    let f = [];
                    m.getBlockMap().forEach(g => {
                        g ? .findEntityRanges(() => !0, y => {
                            y && f.push(g.getEntityAt(y))
                        })
                    }), f = f.filter(g => g), f.forEach(g => {
                        let y = m.getEntity(g);
                        y && (m = m.replaceEntityData(g, { ...y.getData(),
                            linkStyle: s
                        }))
                    })
                }
                t = zd.EditorState.set(t, {
                    currentContent: m
                })
            }
            o && (t = Ha.default.reduce(Object.keys(o), (p, h) => h === Fl ? ah({
                editorState: p,
                lineHeight: o[h]
            }) : h === Vc ? qd({
                editorState: p,
                align: o[h]
            }) : h === hh ? rf({
                editorState: p,
                linkedStatus: o[h]
            }) : yi({
                editorState: p,
                key: h,
                value: o[h]
            }), t)), this.nonReactSetSharedState(t);
            let {
                blocks: a,
                blocksMeta: l,
                entityMap: c,
                styles: d
            } = wr(t.getCurrentContent());
            this.model.set({
                blocks: a,
                blocksMeta: l,
                entityMap: c,
                styles: d
            }), setTimeout(() => {
                this.model.save({
                    h: this.getRealContentHeight()
                })
            }, 500)
        },
        onDblClick: function() {
            this.selected && (!this.model.get("pack_id") || this.workspace.getSelectedBlocks().length === 1 ? this.enterEditMode() : me.prototype.onDblClick.apply(this))
        },
        enterEditMode: function() {
            if (this.frame && (this.frame.setEditorState(), this.frame.removeRotationState(), this.frame.resetRotation()), this.workspace && this.workspace.controls && this.workspace.controls.setControls(this.edit_controls, this), !this.has_parent_block) {
                let e = qu.default.event.special.drag;
                e.toggle.call((0, qu.default)("#main")[0], !1), e.toggle.call(this.$el[0], !1)
            }
            window.RM.common.disableShortcuts["text-v3"] = !0, this.workspace.trigger("w-text-entered-edit-mode"), this.propsModel.set({
                isEditMode: !0
            }), this.cacheLastStyle(this.nonReactGetSharedState()), this.iframe && (this.startRedirectIframeEvents(), this.frame.checkHeightOfTextWidget())
        },
        onIframeLoaded: function() {
            this.reactContainer && (this.iframe = this.reactContainer.querySelector("iframe"), this.startRedirectIframeEvents(), this.frame.checkHeightOfTextWidget())
        },
        leaveEditMode: function() {
            if (this.propsModel.get("isEditMode")) {
                if (st(["TextWidgetSelect"]), window.RM.constructorRouter.trigger("notice:triggerEduTipClose"), this.clearJustCreatedState(), this.workspace.trigger("w-text-before-leave-edit-mode"), this.frame && (this.frame.removeEditorState(), this.frame.restoreRotation()), this.workspace && this.workspace.controls && this.workspace.controls.setControls(this.controls, this), !this.has_parent_block) {
                    let e = {
                            distance: this.PIXELS_TO_ACTIVATE_DRAG
                        },
                        t = qu.default.event.special.drag;
                    t.toggle.call((0, qu.default)("#main")[0], !0), t.toggle.call(this.$el[0], !0, e)
                }
                delete window.RM.common.disableShortcuts["text-v3"], this.propsModel.set({
                    isEditMode: !1
                }), th(), this.stopRedirectIframeEvents(), this.workspace.trigger("w-text-leaved-edit-mode")
            }
        },
        onWorkspaceBlocksSelect: function(e, t, o) {
            if (me.prototype.onWorkspaceBlocksSelect.apply(this, [e, t, o]), !this.rendered) return;
            let i = e && e.length === 1 && e[0] === this;
            this.propsModel.get("isEditMode") && !i && this.leaveEditMode()
        },
        validateViewportTextData: function() {
            if (!this.model.get("blocksMeta")) {
                let e = { ...this.model.toJSON()
                };
                for (let t of Oe.viewport_listall)
                    if (t in e && e[t].blocksMeta) {
                        this.model.save({
                            blocksMeta: e[t].blocksMeta,
                            entityMap: e[t].entityMap,
                            styles: e[t].styles
                        }, {
                            silent: !0,
                            toHistory: !1,
                            skipHistory: !0
                        });
                        break
                    }
            }
        },
        onViewportChange: function() {
            let e = this.page.getCurrentViewport();
            this.propsModel.set({
                viewport: e
            }), this.validateViewportTextData()
        },
        isAutosizeEnabled: function() {
            let e = this.model.get("autosize"),
                t = this.model.get("columns");
            return !(t && t.count > 1) && e
        },
        getRealContentHeight: function(e = !1, t) {
            if (e && this.model.get("version") === 3) {
                let {
                    styles: o,
                    blocksMeta: i,
                    entityMap: n,
                    blocks: s,
                    w: a
                } = this.model.attributes, l = Gc({
                    styles: o,
                    blocksMeta: i,
                    entityMap: n,
                    blocks: s
                }), c = zd.EditorState.createWithContent(l, Tv);
                return dw({
                    width: t ? ? a,
                    model: this.model,
                    editorState: c
                })
            } else {
                let o = this.propsModel.get("isEditMode") ? this.iframe ? .contentWindow ? .document ? .querySelector('[data-contents="true"]') : this.$el.find(".text-viewer")[0];
                return o ? o.offsetHeight : void 0
            }
        },
        fitContentToBox: function() {
            let e = this.getRealContentHeight();
            typeof e == "number" && (this.model.set({
                h: e
            }), this.trigger("resize", void 0, {
                autosize: !0
            }))
        },
        redraw: function(e, t = {}) {
            return this.checkNeedRedraw(e, t) ? (t.viewportChange && this.refreshState(e), me.prototype.redraw.apply(this, [e, t])) : void 0
        },
        onFontsChanged: function() {
            this.propsModel.set("fontStyles", bf())
        },
        onResizeStart: function() {
            this.disableMouseEventsRedirection = !0, this.propsModel.set("isResizing", !0)
        },
        scaleContent: function(e, t, o = {
            resizeText: !0,
            resizePaddings: !0
        }) {
            let i = e.width / t.width,
                n = Ll(this.model),
                s = xv(),
                a = [...s.global, ...s.project],
                l = n.getCurrentContent();
            this.model.attributes.blocks.forEach(f => {
                let g = l.getBlockForKey(f.key),
                    y = this.model.attributes.blocksMeta ? .find(C => C.key === f.key),
                    S = y ? .data ? .textStyle,
                    w = a && S ? a.find(C => C.name === S) : null,
                    v = w ? .cssProperties || {};
                if (o.resizeText) {
                    let C = y ? .data ? .lineHeight || v.lineHeight || St.lineHeight,
                        I = C ? Math.floor(C * i) || 1 : null;
                    I && (n = At(n, hf({
                        content: n.getCurrentContent()
                    })), n = ah({
                        editorState: n,
                        block: g,
                        lineHeight: I
                    }))
                }
                if (o.resizePaddings) {
                    let {
                        paddingTop: C,
                        paddingRight: I,
                        paddingBottom: T,
                        paddingLeft: P
                    } = v, M = y ? .data ? .paddings || {}, F = {
                        top: C,
                        right: I,
                        bottom: T,
                        left: P,
                        ...M
                    }, R = Object.keys(F).reduce((A, D) => {
                        let O = F[D];
                        return O !== void 0 && (A[D] = Math.floor(O * i)), A
                    }, {});
                    n = dh({
                        editorState: n,
                        block: g,
                        paddings: R
                    })
                }
                o.resizeText && n.getBlockTree(f.key).toArray().forEach(I => {
                    I.leaves.toArray().forEach(T => {
                        let P = zd.SelectionState.createEmpty(f.key);
                        P = P.set("anchorOffset", T.get("start")), P = P.set("focusOffset", T.get("end")), n = At(n, P);
                        let M = fh(n),
                            F = Number((`${M.fontSize?M.fontSize:""}`.match(/\d+/) || [0])[0] || w ? .cssProperties ? .fontSize || St.fontSize),
                            R = M.letterSpacing && typeof M.letterSpacing == "string" ? Number((M.letterSpacing.match(/-?\d+/) || [0])[0]) : M.letterSpacing || w ? .cssProperties ? .letterSpacing,
                            A = F ? Math.floor(F * i) || 1 : null;
                        if (A && (n = yi({
                                editorState: n,
                                key: "FONT_SIZE",
                                value: A
                            }), R)) {
                            let D = Zs({
                                letterSpacing: R,
                                fontSize: F,
                                newFontSize: A
                            });
                            n = yi({
                                editorState: n,
                                key: "LETTER_SPACING",
                                value: D
                            })
                        }
                    })
                })
            }), this.nonReactSetSharedState(n);
            let {
                blocks: c,
                blocksMeta: d,
                entityMap: p,
                styles: h
            } = wr(n.getCurrentContent()), u = {
                blocks: c,
                blocksMeta: d,
                entityMap: p,
                styles: h
            }, m = this.model.get("columns");
            m ? .count > 1 && (u.columns = { ...m,
                gap: Math.floor(m.gap * i)
            }), this.model.set(u)
        },
        css: function(e) {
            if (this.propsModel.get("isResizing") && typeof e ? .width == "number" && typeof e ? .height == "number") {
                let t = this.getRealContentHeight();
                this.isAutosizeEnabled() && this.model.get("h") !== t && this.model.set("h", t, {
                    silent: !0,
                    skipHistory: !0
                })
            }
            return me.prototype.css.apply(this, [e])
        },
        onResizeEnd: function() {
            this.disableMouseEventsRedirection = !1, this.propsModel.set("isResizing", !1)
        },
        canChangeDimension: function(e) {
            return e === "height" && this.isAutosizeEnabled() ? !1 : $t.prototype.canChangeDimension.bind(this.frame, e)
        },
        onResizable(e) {
            e && !this.propsModel.get("isResizing") ? this.propsModel.set("isResizing", !0) : !e && this.propsModel.get("isResizing") && this.propsModel.set("isResizing", !1)
        },
        modelChangeCallback(e, t) {
            (t.undo || t.redo || t.reset || Xt.isIncomingUpdate(t)) && this.refreshState(e), t.viewportChange && this.getRealContentHeight() !== this.model.get("h") && setTimeout(() => {
                this.refreshState(e)
            }, 0), this.checkHotspotFit(), kg.onTextModelChange(e, this.nonReactGetSharedState())
        },
        getAllowableHeight() {
            let t = this.iframe ? .contentWindow ? .document ? .querySelector("body") ? .querySelector('[data-contents="true"]');
            if (t) return t.clientHeight
        },
        onAutosizeChanged({
            disableHeightCheck: e
        } = {}) {
            let t = this.isAutosizeEnabled();
            this.$el.toggleClass("text-autosize", t), t ? (this.$el.find(".frameborder .dot.lt, .frameborder .dot.lb").attr("data-ind", 7).attr("data-visual-direction", "w"), this.$el.find(".frameborder .dot.rt, .frameborder .dot.rb").attr("data-ind", 3).attr("data-visual-direction", "e")) : (this.$el.find(".frameborder .dot.lt").attr("data-ind", 0).attr("data-visual-direction", "nw"), this.$el.find(".frameborder .dot.rt").attr("data-ind", 2).attr("data-visual-direction", "ne"), this.$el.find(".frameborder .dot.lb").attr("data-ind", 6).attr("data-visual-direction", "sw"), this.$el.find(".frameborder .dot.rb").attr("data-ind", 4).attr("data-visual-direction", "se")), !e && t && (this.trigger("resize", void 0, {
                autosize: !0
            }), this.model.set({
                h: this.getRealContentHeight()
            }, {
                silent: !0,
                toHistory: !1,
                skipHistory: !0
            }), this.frame.checkHeightOfTextWidget())
        },
        onRestoreLayout() {
            this.refreshState()
        },
        refreshState(e) {
            let t = Ll(e || this.model);
            t && this.nonReactSetSharedState(t)
        },
        checkHotspotFit() {
            this.has_parent_block && (this.workspace.fit_text_to_content(), this.workspace.adjust_height_to_visible_content())
        },
        canControlsBeClosed() {
            return this.workspace.controls.canControlsBeClosed()
        },
        fixViewportsAfterMigration(e) {
            let t = Hc("text", 3, !1);
            Oe.viewport_listall.forEach(o => {
                e[o] = Ha.default.pick(e.get(o), t)
            })
        },
        useSharedState: function({
            group: e = !1
        } = {}) {
            let [t, o] = (0, _l.useState)({}), [i] = this._useSharedState();
            (0, _l.useEffect)(() => {
                function l() {
                    o({})
                }
                let c = Vd(l, 100);
                return bt.on("block:sharedStateChange", c), () => {
                    bt.off("block:sharedStateChange", c)
                }
            }, []);
            let n = (0, _l.useMemo)(() => this.workspace.getSelectedBlocks(), [i, t]),
                s = (0, _l.useMemo)(() => {
                    let l = n.map(c => c.nonReactGetSharedState());
                    return l.length === 0 ? [i] : l
                }, [n]),
                a = (0, _l.useCallback)(l => {
                    if (e) {
                        l.forEach((d, p) => {
                            let h = n[p];
                            h.nonReactSetSharedState(h.beforeSharedStateUpdate ? h.beforeSharedStateUpdate({
                                oldState: s[p],
                                newState: d
                            }) : d)
                        });
                        return
                    }
                    return this.nonReactSetSharedState(this.beforeSharedStateUpdate ? this.beforeSharedStateUpdate({
                        oldState: i,
                        newState: l
                    }) : l)
                }, [n, e]);
            return [e ? s : i, a]
        },
        beforeSharedStateUpdate({
            oldState: e,
            newState: t
        }) {
            let o = `viewport_${this.page.getCurrentViewport()}`;
            return ef(() => {
                e.getCurrentContent() !== t.getCurrentContent() && (tW({
                    model: this.model,
                    currentViewport: o,
                    oldState: e,
                    newState: t
                }), this.validateViewportHeightDebounced(), setTimeout(() => {
                    this.trigger("resize", void 0, {
                        autosize: !0
                    })
                }, 0), this.cacheLastStyle(t))
            }), t
        },
        validateViewportHeight() {
            let e = `viewport_${this.page.getCurrentViewport()}`,
                t = this.model;
            if (!this.isAutosizeEnabled()) return;
            let o = !1;
            Oe.types.forEach(i => {
                let n = `viewport_${i}`;
                if ((e !== n || !this.propsModel.get("isEditMode")) && t[n]) {
                    let a = t.get("blocks"),
                        l = t.clone({
                            viewport: i
                        }),
                        {
                            styles: c,
                            blocksMeta: d,
                            entityMap: p,
                            w: h,
                            h: u
                        } = l.attributes;
                    if (c && d && p && a) {
                        let m = dw({
                            width: h,
                            model: this.model,
                            editorState: zd.EditorState.createWithContent(Gc({
                                styles: c,
                                blocksMeta: d,
                                entityMap: p,
                                blocks: a
                            }), Tv)
                        });
                        m && u !== m && (l.set("h", m), o = !0)
                    }
                }
            }), this.workspace.getSelectedBlocks().length > 1 || o && this.model.save({}, {
                silent: !0,
                skipHistory: !0
            })
        },
        cacheLastStyle(e) {
            let t = this.workspace.mag.edit_params,
                o = t.get(de.textWidget.cachedTextStyleKey),
                i = Kk({
                    editorState: e,
                    lastStyle: o
                });
            Rl(i, o) || (t.set(de.textWidget.cachedTextStyleKey, i), this.saveEditParams())
        },
        toggleSelectionHighlight(e) {
            this.propsModel.set("disableSelectionHighlight", e)
        },
        getSaveBoxData(e) {
            let t = me.prototype.getSaveBoxData.apply(this, [e]);
            return this.isAutosizeEnabled() && !e ? .resizeContent && (t.h = this.getRealContentHeight()), t
        }
    }, {
        getViewportDefaults(e, t, o) {
            return me.getViewportDefaults(e, t, o)
        },
        "defaults.v2": {
            text: () => "<p>" + Dh() + "</p>",
            column_count: 1,
            column_gap: 16,
            bg_color: "ffffff",
            bg_opacity: 0,
            version: 2
        },
        defaults: {
            version: 3,
            verticalAlign: "top",
            textDirection: "LTR",
            autosize: !0,
            blocks: () => {
                let t = window.RM.constructorRouter.mag.edit_params.get(de.textWidget.cachedTextStyleKey),
                    {
                        blocks: o
                    } = Ah({
                        text: t && bP({
                            width: 480,
                            lineHeight: t[Fl] || St.lineHeight,
                            fontStyle: {
                                fontSize: t.FONT_SIZE || St.fontSize,
                                fontFamily: t.FONT_FAMILY || St.fontFamily,
                                fontWeight: t.FONT_WEIGHT || St.fontWeight,
                                fontStyle: t.FONT_STYLE || St.fontStyle
                            }
                        })
                    });
                return o
            },
            styles: [],
            entityMap: {},
            flags: {
                baseline: !0,
                calculatedLineHeight: !0,
                updatedLinks: !0,
                newListPosition: !0
            }
        }
    }), $d = oie
});
async function Uht(e, t) {
    let o = new FormData;
    return o.append("projectId", t), o.append("upload", e.slice(0, Math.min(e.size, de.VIDEOS_BACKGROUND_UPLOAD_SIZE_LIMIT))), await fetch("/api/videos/upload", {
        method: "post",
        body: o
    }).then(async i => {
        let n = await i.json();
        if (i.ok) return n;
        throw new Error(n.message || "Video uploading error")
    })
}
async function sW(e, t, o) {
    if (!e) return null;
    let i = await rr.validateVideoFile(e);
    if (!i.isValid) throw rW(i), new zm(i.errorMessage, i.errorType);
    let n = new FormData;
    n.append("widgetId", t), n.append("upload", e);
    try {
        let s = await fetch("/api/videos/stream-upload", {
                method: "post",
                body: n,
                signal: o
            }),
            a, l = s.headers.get("Content-Type");
        if (l && l.includes("application/json") ? a = await s.json() : a = {}, s.ok) return rW(i), a; {
            let c = a.statusCode ? ? s.status,
                d = a.message ? ? "Unknown error occurred";
            throw c === 500 || c === 504 ? new Error(de.VIDEO_WIDGET_GENERIC_ERROR_TEXT) : new Error(d)
        }
    } catch {
        throw new Error(de.VIDEO_WIDGET_GENERIC_ERROR_TEXT)
    }
}

function rW(e) {
    let t = {
            CodecDetectionError: "codec unidentified",
            InvalidCodecError: "codec unsupported",
            FileFormatError: "file format unsupported",
            TooLargeError: "size limit",
            SubscriptionLimitError: "size limit"
        },
        {
            isValid: o,
            errorType: i,
            metadata: {
                size: n = 0,
                duration: s = 0,
                width: a = 0,
                height: l = 0
            } = {}
        } = e,
        c = {
            videoType: "file",
            status: o ? "success" : "error",
            errorType: !o && i ? t[i] : "no errors",
            fileSize: Math.floor(n / (1e3 * 1e3)),
            fileDuration: Math.floor(s / 10) * 10,
            fileWidth: Math.floor(a / 100) * 100,
            fileHeight: Math.floor(l / 100) * 100
        };
    De(Fe.WidgetVideoUpload, c)
}
var zm, aW = k(() => {
    "use strict";
    Mt();
    Qv();
    KI();
    qt();
    zm = class extends Error {
        constructor(o, i) {
            super(o);
            this.type = i
        }
    }
});

function cW({
    useSharedState: e
}) {
    let {
        model: t,
        modelSave: o,
        modelSet: i
    } = (0, Tc.useContext)(ge), [{
        width: n,
        height: s,
        isUploading: a,
        aborted: l,
        fileToUpload: c,
        isSelected: d,
        isFileUploadVisible: p,
        viewport: h
    }, u] = e({
        partial: !0
    }), [m, f] = (0, Tc.useState)(!1);
    (0, Tc.useEffect)(() => {
        let S = new AbortController;
        return u({
            aborted: S
        }), () => {
            S.abort(), u({
                aborted: void 0
            })
        }
    }, []);
    async function g(S) {
        if (!a) {
            u({
                isUploading: !0,
                uploadError: void 0
            });
            try {
                let w = await sW(S, t._id, l ? .signal);
                if (w) {
                    let {
                        width: v,
                        height: C,
                        x: I,
                        y: T
                    } = sie({
                        widgetHeight: t.h,
                        widgetWidth: t.w,
                        x: t.x,
                        y: t.y,
                        fileHeight: w.height,
                        fileWidth: w.width
                    });
                    o({
                        provider_name: "File",
                        title: "",
                        thumbnail_url: w.posterPath,
                        video_styles: t.video_styles || zl,
                        url: w.videoPath,
                        file_meta: {
                            url: w.videoPath,
                            width: w.width,
                            height: w.height,
                            duration: w.duration,
                            totalSize: w.totalSize,
                            fileName: S.name
                        },
                        controls: t.controls ? ? !0,
                        controls_type: t.controls_type || "custom",
                        w: v,
                        h: C,
                        x: I,
                        y: T
                    })
                }
            } catch (w) {
                if (w instanceof zm) {
                    if (w.type === "SubscriptionLimitError") {
                        let {
                            video_upload_limit: v
                        } = Xf.getPermissions();
                        Jo("video-upload", {
                            currentLimit: v
                        });
                        return
                    }
                    p ? u({
                        uploadError: w.message
                    }) : alert(w.message)
                }
            } finally {
                u({
                    isUploading: !1
                })
            }
        }
    }

    function y(S) {
        S.preventDefault(), f(!1);
        let w = S.dataTransfer.files ? .[0];
        w && g(w)
    }
    return (0, Tc.useEffect)(() => {
        c && (u({
            fileToUpload: void 0
        }), g(c))
    }, [c]), (0, Tc.useEffect)(() => {
        h && h !== "default" && t.custom_controls ? .position === null && (i({
            custom_controls: { ...t.custom_controls,
                position: "c"
            }
        }), o())
    }, [h, t.custom_controls ? .position]), x(nie, {
        url: t.url,
        onDrop: y,
        onDragOver: () => f(!0),
        onDragLeave: () => f(!1),
        children: [!t.url && !a && r(rie, {
            width: n && Math.round(n),
            height: s && Math.round(s),
            children: r("svg", {
                viewBox: "0 0 65 66",
                fill: "none",
                xmlns: "http://www.w3.org/2000/svg",
                children: r("path", {
                    fillRule: "evenodd",
                    clipRule: "evenodd",
                    d: "M58.2139 25.9859C64.1406 28.9257 64.1406 37.3795 58.2139 40.3193L13.555 62.4719C8.23728 65.1097 2 61.2411 2 55.3052L2 11C2 5.06404 8.23729 1.19548 13.555 3.83327L58.2139 25.9859Z",
                    stroke: "#B8B8B8",
                    strokeWidth: "4"
                })
            })
        }), t.url && r(y1, {
            widget: t,
            isVisible: !0,
            width: n,
            height: s,
            autoplay: !1,
            outOfBoundsFloatPlaceholder: d ? "shake" : "still"
        }), (m || a) && r(b, {
            display: "flex",
            position: "absolute",
            top: "50%",
            left: "50%",
            cursor: "default",
            transform: "translate(-50%, -50%)",
            pointerEvents: "none",
            css: Z `
            & > div {
              width: ${60}px;
              height: ${60}px;
            }
          `,
            children: a ? r(_o, {
                bgColor: "gray"
            }) : r(nI, {
                color: "white"
            })
        }), r(b, {
            width: "100%",
            height: "100%",
            position: "absolute",
            left: 0,
            top: 0
        })]
    })
}
var Tc, lW, nie, rie, sie, dW = k(() => {
    "use strict";
    ie();
    Tc = E(N());
    Le();
    ve();
    Bs();
    KI();
    OH();
    aW();
    Zc();
    hH();
    Xs();
    Mt();
    l0();
    XI();
    B();
    lW = .2, nie = ue(b, {
        excludeProps: ["url"]
    })
    `
  position: absolute;
  width: ${e=>e.url?"unset":"100%"};
  height: ${e=>e.url?"unset":"100%"};
  top: 0;
  left: 0;
  pointer-events: all;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-wrap: wrap;
  background-color: ${e=>e.url?"transparent":"#f4f4f4"};
`, rie = ue(b, {
        excludeProps: ["width", "height"]
    })
    `
  display: flex;
  justify-content: center;
  align-items: center;
  & > svg {
    width: ${e=>e.width?yh(Math.round(e.width*lW)):"65px"};
    height: ${e=>e.height?yh(Math.round(e.height*lW)):"66px"};
  }
`;
    sie = ({
        widgetHeight: e,
        widgetWidth: t,
        x: o,
        y: i,
        fileWidth: n,
        fileHeight: s
    }) => {
        if (e !== de.widget.defaults.h || t !== de.widget.defaults.w || !s || !n) return {
            width: t,
            height: e,
            x: o,
            y: i
        };
        let a = n / s,
            l = 500,
            c = a > 1 ? l : l * a,
            d = a > 1 ? l / a : l,
            p = Math.abs(c - t),
            h = Math.abs(d - e),
            u = a > 1 ? o - p / 2 : o + p / 2,
            m = a > 1 ? i + h / 2 : i - h / 2;
        return {
            width: c,
            height: d,
            x: u,
            y: m
        }
    }
});
var pW, aie, lie, Sl, uW, hW = k(() => {
    "use strict";
    Ro();
    yr();
    pW = E(gi());
    dW();
    Le();
    Zc();
    Mt();
    B();
    aie = 8, lie = 8, Sl = class extends me {
        constructor(o, i) {
            super(o, i);
            _e(this, "page");
            _e(this, "initial_controls", ["video_settings", "video_controls", "common_rotation", "video_link", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset", window.RM.constructorRouter.me ? .get("permissions") ? .can_add_preset ? "readymag_preset" : ""].filter(Boolean));
            _e(this, "groupControls", {
                0: "common_pack",
                1: "common_unpack",
                2: "common_align",
                3: "common_arrange",
                5: "common_interactions",
                6: "common_shadow",
                7: "common_position",
                8: "common_layer",
                9: "readymag_preset",
                10: "my_preset"
            });
            _e(this, "controlsDividers", ["common_rotation", "video_link", "common_draggable"]);
            _e(this, "groupControlsDividers", ["common_draggable"]);
            _e(this, "disabledControls", []);
            this.controls = o.get("url") ? this.initial_controls : this.initial_controls.filter(n => n !== "video_controls" && n !== "video_link" && n !== "common_cursor" && n !== "common_draggable"), this.page = i.page, this.updateControls(), this.checkDisabledControls(o), this.model.get("info") === void 0 && this.model.set("info", !0, {
                silent: !0,
                skipHistory: !0
            }), this.listenTo(this.model, "change:url change:provider_name", this.updateControls), this.listenTo(this, "select", () => {
                this.nonReactSetSharedState({
                    isSelected: !0
                }, {
                    partial: !0
                })
            }), this.listenTo(this, "deselect", () => {
                this.nonReactSetSharedState({
                    isSelected: !1
                }, {
                    partial: !0
                })
            }), this.listenTo(i.page, "change:viewport", this.onViewportChange), this.onViewportChange()
        }
        checkDisabledControls(o) {
            let i = o.get("controls"),
                n = o.get("controls_type"),
                s = o.get("custom_controls");
            i ? (this.disabledControls.includes("video_link") || this.disabledControls.push("video_link"), n === "default" || s ? .position !== null ? this.disabledControls = this.disabledControls.filter(a => a !== "common_cursor") : this.disabledControls.includes("common_cursor") || this.disabledControls.push("common_cursor")) : this.disabledControls = [], this.trigger("disabledControls:changed")
        }
        updateControls() {
            let o = this.model.get("provider_name"),
                i = this.model.get("url"),
                n = this.initial_controls;
            i ? (o === "Vimeo" || o === "YouTube") && (n = n.filter(s => !["video_link", "common_cursor", "common_draggable"].includes(s))) : n = n.filter(s => !["video_controls", "video_link", "common_cursor", "common_draggable"].includes(s)), this.controls = n, super.updateControls()
        }
        onViewportChange() {
            let o = this.page.getCurrentViewport();
            this.nonReactSetSharedState({
                viewport: o
            }, {
                partial: !0
            })
        }
        render() {
            if (this.rendered) return;
            this.create(), this.frame.minwidth = aie, this.frame.minheight = lie, this.$el.addClass("video"), this.$el.addClass("can-drop");
            let o = this.useSharedState;
            An({
                component: () => r(cW, {
                    useSharedState: o
                }),
                domElement: this.$content[0],
                model: this.model,
                onDestroy: () => {
                    let n = this.$content[0];
                    pW.default.unmountComponentAtNode(n), n && n.parentNode && n.parentNode.removeChild(n)
                }
            }), this.rendered = !0, this.triggerReady()
        }
        uploadFile(o) {
            this.nonReactSetSharedState({
                fileToUpload: o
            })
        }
        css(o) {
            me.prototype.css.apply(this, [o]);
            let i = {};
            typeof o.width == "number" && (i.width = o.width), typeof o.height == "number" && (i.height = o.height), this.nonReactSetSharedState(i, {
                partial: !0
            })
        }
        getIconStyle(o = {}) {
            let i = {},
                n = "./constructor/widgetbar/icons/",
                s = this.model.get("provider_name") === "File" ? `${de.readymag_video_files_origin}/${this.model.get("thumbnail_url")}` : this.model.get("thumbnail_url");
            o.small && this.icon_color && (i["background-color"] = this.icon_color), o.small || (i["border-radius"] = "8px");
            let a = G(`${n}video.svg`);
            return s && (a = s, i["background-size"] = "auto 150%"), i["background-image"] = `url(${a})`, i
        }
        destroy() {
            return this.stopListening(), super.destroy()
        }
    };
    _e(Sl, "defaults", {
        thumbnail_url: "",
        color: ap,
        custom_controls: r0,
        video_styles: zl,
        autoplay: !1,
        mute: !1,
        loop: !1
    });
    Sl.prototype.name = "Video";
    Sl.prototype.sort_index = 4;
    Sl.prototype.thumb = "video";
    Sl.prototype.icon_color = "#1877F2";
    Sl.prototype.settingsOnCreate = !0;
    uW = Sl
});

function cie() {
    let {
        model: e
    } = (0, mW.useContext)(ge);
    return e.url ? x(b, {
        position: "relative",
        width: "100%",
        height: "100%",
        children: [r(b, {
            width: "100%",
            height: "100%",
            zIndex: 100,
            position: "absolute",
            top: 0,
            left: 0
        }), r(v1, {
            url: e.url,
            socials: e.socials,
            artwork: e.artwork,
            type: e.current_type,
            color: e.color,
            comments: e.comments
        })]
    }) : r(b, {
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        width: "100%",
        height: "100%",
        backgroundColor: "lightGray",
        children: r(SI, {
            color: "gray",
            height: 64,
            width: 64
        })
    })
}
var mW, fW, gW = k(() => {
    "use strict";
    mW = E(N());
    ie();
    PH();
    Le();
    jH();
    B();
    fW = cie
});
var bW, die, Bc, yW, vW = k(() => {
    "use strict";
    bW = E(gi());
    Ro();
    yr();
    Le();
    gW();
    l1();
    die = {
        visual: {
            minheight: 166,
            minwidth: 166
        },
        standard: {
            minheight: 116,
            minwidth: 166
        }
    }, Bc = class extends me {
        constructor() {
            super(...arguments);
            _e(this, "controls", ["audio_settings", "common_interactions", "common_align", "common_position", "common_layer", "my_preset"]);
            _e(this, "controlsDividers", ["audio_settings", "common_interactions"]);
            _e(this, "groupControlsDividers", ["common_interactions"]);
            _e(this, "groupControls", {
                0: "common_pack",
                1: "common_unpack",
                2: "common_align",
                3: "common_arrange",
                5: "common_interactions",
                9: "common_position",
                10: "common_layer",
                11: "readymag_preset",
                12: "my_preset"
            })
        }
        initialize(o, i) {
            this.initBlock(o, i), o.on("change:current_type", this.onChangeType.bind(this))
        }
        render() {
            this.create(), this.setFrameRestrictions(), An({
                component: fW,
                domElement: this.$content[0],
                model: this.model,
                onDestroy: () => {
                    let o = this.$content[0];
                    bW.default.unmountComponentAtNode(o), o && o.parentNode && o.parentNode.removeChild(o)
                }
            }), this.rendered = !0, this.triggerReady()
        }
        getIconStyle(o = {}) {
            let i = {},
                n = this.model.get("thumbnail_url"),
                s = n || G("./constructor/widgetbar/icons/audio.svg");
            return o.small && this.icon_color && (i["background-color"] = this.icon_color), o.small || (i["border-radius"] = "8px"), n && (i["background-size"] = "cover"), i["background-image"] = `url(${s})`, i
        }
        setFrameRestrictions() {
            let o = this.model.get("current_type"),
                i = die[o];
            i && (this.frame.minheight = i.minheight, this.frame.minwidth = i.minwidth)
        }
        onChangeType() {
            this.setFrameRestrictions(), this.model.get("h") < this.frame.minheight && this.model.save("h", this.frame.minheight)
        }
    };
    _e(Bc, "defaults", {
        current_type: "visual",
        comments: !1,
        artwork: !0,
        socials: !0,
        color: "ff5100",
        w: 400,
        h: 400,
        version: 2
    });
    Bc.prototype.name = "Music";
    Bc.prototype.sort_index = 13;
    Bc.prototype.thumb = "audio";
    Bc.prototype.icon_color = "#EC520B";
    yW = Bc
});
var Ao, Gs, pie, ma, Ky = k(() => {
    "use strict";
    Ao = E(Ze()), Gs = E(ze());
    Ro();
    Mt();
    Ip();
    wa();
    Wt();
    pie = me.extend({
        RESCALE_URL: "/api/imagescale",
        FINAL_URL: "/api/imagefinal",
        PREVIEW_URL: "/api/imagepreview",
        LAMBDA_FROM_URL: "/api/upload/lambda/fromurl",
        SVG_URL: "/api/imagesvg",
        allowedLambdaExt: function() {
            let e = this.model.get("picture");
            return e ? ii.allowedLambdaExt(e.type) : void 0
        },
        useLambdaUrl: function() {
            return ii.useLambdaUrl(this.model.get("picture"))
        },
        getLambdaUrl: function() {
            let e = ft.normalizeAnimations(this.model.get("animation")).reduce((i, n) => Math.max(i, ft.maxScaleAnimation(n)), 0),
                t = {};
            t = {
                cropH: this.model.get("originalCropH") ? ? this.model.get("cropH"),
                cropW: this.model.get("originalCropW") ? ? this.model.get("cropW"),
                cropX: this.model.get("originalCropX") ? ? this.model.get("cropX"),
                cropY: this.model.get("originalCropY") ? ? this.model.get("cropY")
            };
            let o = {
                useOriginalUrlForOldWidget: !0
            };
            return ii.getLambdaUrl(this.model.get("picture"), {
                width: this.model.get("w"),
                height: this.model.get("h"),
                originalW: this.model.get("originalW"),
                originalH: this.model.get("originalH"),
                scale: RM.constructorRouter.zoom.getZoom(),
                animationScale: e && e / 100,
                isStretched: !1,
                useLargerPictureSizeForBetterQuality: !0,
                ...t
            }, o)
        },
        getOriginalLambdaUrl: function() {
            return ii.getOriginalLambdaUrl(this.model.get("picture"))
        },
        getLqipUrl: function() {
            return ii.getLqipUrl(this.model.get("picture"), {
                cropX: this.model.get("cropX"),
                cropY: this.model.get("cropY"),
                cropW: this.model.get("cropW"),
                cropH: this.model.get("cropH"),
                originalW: this.model.get("originalW"),
                originalH: this.model.get("originalH")
            })
        },
        getThumbnailUrl: function() {
            return ii.getThumbnailUrl(this.model.get("picture"))
        },
        removePicture: function() {
            let e = this.model.collection.page.getCurrentViewport();
            this.model.unset("picture"), this.model.save({}, {
                silent: !0,
                toHistory: !0
            }), this._fromUrlXHR && this._fromUrlXHR.abort(), this._getFinalRequest && this._getFinalRequest[e] && this.has_parent_block ? this._getFinalRequest[e].abort() : this._getFinalRequest && !this.has_parent_block && this._getFinalRequest.abort()
        },
        getPictureUrl: function() {
            let e = this.model.get("picture");
            return e ? this.useLambdaUrl() ? this.getLambdaUrl() : Modernizr.retina && e.final2xUrl || e.finalUrl || e.unscaledOptimizedUrl || e.url : ""
        },
        getVectorUrl: function() {
            let e = this.model.get("picture");
            return e ? e.editedVectorUrl || e.url : ""
        },
        getOpacity: function() {
            let e = this.model.get("opacity");
            return Gs.default.isNumber(e) ? e : 1
        },
        getFinalImage: function(e, t = {}) {
            if (this.useLambdaUrl()) {
                let o = this.model.get("picture"),
                    i = this.model.isNested ? "default" : t.viewport || this.model.collection.page.getCurrentViewport();
                if (this.model.get("w") !== this.model.get("w")) return;
                this.isFullWidth() && this.model.set("w", this.getFullWidthDims().w, {
                    silent: !0
                }), this.isFullHeight() && this.model.set("h", this.getFullHeightDims().h, {
                    silent: !0
                }), this.model.save("picture", o, Gs.default.extend(t || {}, {
                    viewport: i
                })), e && e(null)
            } else {
                this.setIsPictureUpdating(!0);
                let o = this.model.get("picture");
                if (!o || !o.url || this.isVector(o.url, o.type)) return e && e(null);
                let i = t.viewport || this.model.collection.page.getCurrentViewport(),
                    n = this.model.get("w");
                this._getFinalRequest && this._getFinalRequest[i] && this.has_parent_block ? this._getFinalRequest[i].abort() : this._getFinalRequest && !this.has_parent_block && this._getFinalRequest.abort(), this.has_parent_block && this.updatePreloaderState({
                    viewport: i,
                    value: !0
                }), this.showTempPreloader && this.showTempPreloader();
                let s = null;
                s = Ao.default.ajax({
                    type: "POST",
                    data: this.model.attributes,
                    url: this.FINAL_URL,
                    success: function(a) {
                        this.has_parent_block && this.updatePreloaderState({
                            viewport: i,
                            value: !1
                        }), this.hideTempPreloader && this.hideTempPreloader(), n === this.model.get("w") && (this.isFullWidth() && this.model.set("w", this.getFullWidthDims().w, {
                            silent: !0
                        }), this.isFullHeight() && this.model.set("h", this.getFullHeightDims().h, {
                            silent: !0
                        }), this.model.save("picture", Gs.default.extend({}, o, a), Gs.default.extend(t || {}, {
                            viewport: i
                        })), e && e(null, a), this.setIsPictureUpdating(!1))
                    },
                    error: function(a) {
                        a ? .statusText !== "abort" && (this.has_parent_block && this.updatePreloaderState({
                            viewport: i,
                            value: !1
                        }), this.hideTempPreloader && this.hideTempPreloader(), this.setIsPictureUpdating(!1)), e && e(a.responseText, a ? .statusText)
                    },
                    context: this
                }), this.has_parent_block ? this._getFinalRequest = {
                    [i]: s
                } : this._getFinalRequest = s
            }
        },
        requestFinalImage: function(e, t) {
            return Ao.default.ajax({
                type: "POST",
                data: e,
                url: this.FINAL_URL,
                success: function(o) {
                    t && t(o)
                }
            })
        },
        loadPreviewUrl: function(e, t) {
            let o = this.model.get("picture");
            o && Ao.default.ajax({
                type: "GET",
                data: {
                    width: e.w,
                    height: e.h,
                    url: o.rasterUrl || o.url,
                    mid: this.workspace.mag.get("num_id")
                },
                url: this.PREVIEW_URL,
                success: Gs.default.bind(function(i) {
                    o.previewUrl = i && i.previewUrl, this.model.save({
                        picture: o
                    }, {
                        silent: !0,
                        toHistory: !0
                    }), t && t.success(i)
                }, this)
            })
        },
        loadFromUrl: function(e, t) {
            let o = t || {};
            return this._fromUrlXHR && this._fromUrlXHR.abort(), this._fromUrlXHR = Ao.default.ajax({
                type: "POST",
                data: {
                    url: e,
                    id: this.model.id,
                    name: this.name,
                    uploadType: "picture",
                    mid: this.workspace.mag.get("num_id")
                },
                url: this.LAMBDA_FROM_URL,
                context: this,
                success: function(i) {
                    this.changePicture(i, o), o.success && typeof o.success == "function" && o.success()
                },
                error: function(i, n) {
                    if (o.error && typeof o.error == "function" && o.error(), !(n && n === "abort")) {
                        if (i && i.status === 413) return alert(de.MSG_UPLOAD_IMAGE_SIZE_ERROR);
                        alert("There's something wrong with this picture. Please, try the different one.")
                    }
                }
            }), this._fromUrlXHR
        },
        isVector: function(e, t) {
            let o = this.model.get("picture"),
                i = e || o && o.url,
                n = t || this.tempPicture && this.tempPicture.type || o && o.type;
            return n ? n === "svg" : i && Gs.default.last(i.split(".")).indexOf("svg") === 0
        },
        isAnimated: function(e) {
            let t = this.model.get("picture");
            return (e || t && t.type || this.tempPicture && this.tempPicture.type) === "gif"
        },
        loadVector: function(e) {
            if (e = e || {}, this.svgAjax && this.svgAjax.abort(), this.$svg && this.$svg.remove(), delete this.$svg, delete this.$svgColoredElems, delete this.originalSvg, delete this.originalSize, !this.isVector()) return;
            let t = this.getVectorUrl();
            if (!t) return;
            (0, Ao.default)("body > #svg-container").get(0) || (0, Ao.default)('<div id="svg-container"></div>').appendTo("body"), this.svgAjax = Ao.default.get(t + "?c", Gs.default.bind(function(i) {
                let n = this.model.get("flags") ? .useOriginalViewBoxSVG,
                    s = (0, Ao.default)(be.cleanupSVG((0, Ao.default)(i).find("svg").get(0).cloneNode(!0))),
                    a = s.get(0).getAttribute("viewBox");
                this.originalSize = {
                    width: s.get(0).getAttribute("width"),
                    height: s.get(0).getAttribute("height")
                }, s.get(0).removeAttribute("width"), s.get(0).removeAttribute("height"), this.$svg = s;
                let l = s.get(0).cloneNode(!0),
                    c = new Image;
                (0, Ao.default)(c).on("load error", Gs.default.bind(function() {
                    (0, Ao.default)(c).appendTo("#svg-container").css({
                        width: "100%",
                        height: "100%"
                    });
                    let d = (0, Ao.default)(l);
                    n && a || d.get(0).setAttribute("viewBox", "0 0 " + (0, Ao.default)(c).width() + " " + (0, Ao.default)(c).height()), d.appendTo("#svg-container");
                    let p = d.get(0).getBBox();
                    this.$svg && (n && a || this.$svg.get(0).setAttribute("viewBox", p.x + " " + p.y + " " + p.width + " " + p.height), this.$svg.get(0).setAttribute("preserveAspectRatio", "xMidYMid meet")), (0, Ao.default)(c).remove(), d.remove()
                }, this)), c.src = this.getVectorUrl(), this.originalSvg = i, this.getVectorUrl() === t && (e.success && e.success(this.$svg), this.model.get("picture").editedVectorUrl || this.pickVectorColor(e))
            }, this)).always(Gs.default.bind(function() {
                delete this.svgAjax
            }, this)).fail(e.error || Ao.default.noop)
        },
        pickVectorColor: function() {
            if (!this.$svg) return;
            let e = [],
                t = [],
                o = [],
                i = function(l, c) {
                    let d = e.indexOf(l);
                    l && /^#\w+$/.test(l) && (d === -1 ? (e.push(l), t.push(1)) : t[d]++), o.push(c)
                },
                n = (0, Ao.default)("<div></div>");
            this.$svg.find("*").each(function() {
                n.attr("style", (0, Ao.default)(this).attr("style"));
                let l = n.css("fill");
                if (l) return i(l, (0, Ao.default)(this));
                if ((0, Ao.default)(this).attr("fill")) return i((0, Ao.default)(this).attr("fill"), (0, Ao.default)(this))
            });
            let s = t.indexOf(Gs.default.max(t)),
                a = e[s];
            a && /^#?\w\w\w$/.test(a) && (a = [a[0], a[1], a[1], a[2], a[2], a[3], a[3]].join("")), a || (a = "#ffffff"), a = a && a.toLowerCase(), o.length && (this.$svgColoredElems = o)
        },
        setVectorColor: function(e, t) {
            if (this.$svgColoredElems && this.$svgColoredElems.length) {
                let o = (0, Ao.default)("<div></div>");
                Gs.default.each(this.$svgColoredElems, function(i) {
                    o.attr("style", i.attr("style")), o.css({
                        fill: "",
                        "fill-opacity": ""
                    }), i.get(0).setAttributeNS(null, "style", o.attr("style")), i.get(0).setAttributeNS(null, "fill", ""), i.get(0).setAttributeNS(null, "fill-opacity", "")
                })
            }
            this.$svg.get(0).setAttributeNS(null, "fill", "#" + e), this.$svg.get(0).setAttributeNS(null, "fill-opacity", t)
        },
        saveSvg: function(e) {
            if (!this.originalSvg || !this.originalSize) return;
            let t = this.originalSvg.importNode(this.$svg[0], !0);
            return (0, Ao.default)(t).attr("width", this.originalSize.width).attr("height", this.originalSize.height).css("display", ""), Ao.default.ajax({
                url: this.SVG_URL,
                type: "POST",
                data: {
                    svg: new XMLSerializer().serializeToString(t),
                    mid: this.workspace.mag.get("num_id")
                },
                success: function(o) {
                    this.model.get("picture").editedVectorUrl = o && o.editedVectorUrl, delete this.model.get("picture").finalUrl, delete this.model.get("picture").final2xUrl, e && e()
                },
                context: this
            })
        }
    }), ma = pie
});
var Mc, ai, uie, wW, xW = k(() => {
    "use strict";
    Mc = E(Ze()), ai = E(ze());
    oo();
    Ro();
    Ky();
    Wo();
    HH();
    Qv();
    Wt();
    Ip();
    bg();
    NH();
    x1();
    Ya();
    uie = ma.extend({
        name: "Background",
        thumb: "bg",
        outofbox: !0,
        excludedFromLib: !0,
        immortal: !0,
        controls: [],
        defaultSlideshow: {
            delay: 4,
            crossfade: .5,
            pictures: []
        },
        initialize: function(e, t) {
            this.initBlock(e, t), this.model.get("mute") === void 0 && this.model.set("mute", !0, {
                silent: !0
            }), this.createEl(), this.hide(), this.workspace.on("show", this.show), this.workspace.on("hide", this.hide), this.workspace.$el.parent().on("scroll", this.onScroll), this.on("loadimage", this.onLoadImage), this.on("unloadimage", this.onUnloadImage);
            let o = this.model.get("video");
            if (o && (o.provider_name || "").toLowerCase() === "vimeo" && rr.brokenVimeoThumbnailRegexp.test(o.thumbnail_url)) {
                console.log("Broken video thumbnail_url detected.");
                let i = o.url;
                i && (console.log("Trying to fix..."), rr.getEmbedData(i, n => {
                    i = n.url ? n.url : i, rr.getHighResVideoThumbnail({
                        provider: rr.getVideoProvider(i),
                        thumbnail_url: n.thumbnail_url
                    }).then(s => {
                        this.model.save({
                            video: ai.default.extend(o, {
                                thumbnail_url: s
                            })
                        }, {
                            patch: !0
                        }), RM.constructorRouter.onPageRedraw(this.workspace.page.id), RM.constructorRouter.renewScreenshot(), console.log("Broken thumbnail_url fixed: ", s)
                    })
                }, n => {
                    console.error("Error fixing thumbnail_url: ", n)
                }))
            }
        },
        createEl: function() {
            this.setElement((0, Mc.default)('<div class="background">      <div class="picture smooth3d"></div>       <div class="slideshow-container"></div>      <div class="slideshow-preload"></div>      <div class="video">       <div class="overlay"></div>       <div class="container"></div>       </div></div></div>').appendTo((0, Mc.default)("#main-background"))), this.$picture = this.$(".picture"), this.$video = this.$(".video"), this.$color = this.$el, this.$slideshow = this.$(".slideshow-container"), this.$slideshowPreload = this.$(".slideshow-preload"), this.video = new _1({
                el: this.$video.get(0),
                model: this.model,
                attributes: {
                    thumbnailMode: !0
                }
            }), this.slideshowWidget = new w1({
                data: this.model.get("slideshow"),
                container: this.$slideshow,
                preloadContainer: this.$slideshowPreload
            })
        },
        validate: function() {
            let e = ai.default.difference(Oe.viewport_fields.background, Oe.viewport_fields_common);
            this.model.fillMissingFieldsFromDefaultViewport(e)
        },
        render: function() {
            this.updateBGColor(), this.model.get("selectedType") === "picture" && this.loadPic({
                success: this.showPic
            }), this.model.get("selectedType") === "video" && (this.video.render(), this.onResize()), this.model.get("selectedType") === "slideshow" && this.slideshowWidget.render(!0), this.rendered = !0, this.triggerReady()
        },
        updateBGColor: function() {
            let e = this.model.get("color") || "FFFFFF";
            this.$color.css({
                "background-color": "#" + e
            })
        },
        onViewportUpdate: function(e) {
            if (e.viewport === "default") {
                this.$el.removeClass("is-viewport");
                let t = {
                    width: "100%",
                    height: "100%",
                    top: "",
                    left: "",
                    "margin-left": "",
                    "margin-top": ""
                };
                this.$video.css(t), this.$picture.css(t), this.$slideshow.css(t)
            } else {
                let t = vo.fitToDevice(this.workspace.mag.getViewportWidth(e.viewport), e.viewport, vg()).height;
                this.$el.addClass("is-viewport");
                let o = {
                    width: e.width,
                    height: t,
                    top: "50%",
                    left: "50%",
                    "margin-left": -e.width / 2,
                    "margin-top": -t / 2
                };
                this.$video.css(o), this.$picture.css(o), this.$slideshow.css(o)
            }
            this.lastViewportParams = e
        },
        getPictureUrl: function() {
            let e = this.model.get("picture");
            return e ? ii.useLambdaUrl(e) ? ii.getLambdaUrl(e) : e.finalUrl || e.unscaledOptimizedUrl || e.url : ""
        },
        getThumbnailUrl: function(e) {
            return e ? ii.useLambdaUrl(e) ? ii.getThumbnailUrl(e) : e.thumbUrl : ""
        },
        getIconStyle: function(e = {}) {
            let t = this.model.get("selectedType"),
                o = {
                    background: `#${this.model.get("color")}`
                };
            if (e.small) return o;
            if (t === "picture") {
                let i = this.model.get("picture"),
                    n = this.getThumbnailUrl(i);
                if (n) return {
                    "background-image": `url(${n})`
                }
            } else if (t === "video") {
                let i = Qf(this.model.attributes);
                if (i) return {
                    "background-image": `url(${i})`
                }
            } else if (t === "slideshow") {
                let i = this.model.get("slideshow");
                if (i && i.pictures && Array.isArray(i.pictures) && i.pictures.length) return {
                    "background-image": `url(${this.getThumbnailUrl(ai.default.sortBy(i.pictures,"num")[0])})`
                }
            }
            return o
        },
        changePicture: function(e, t) {
            t = ai.default.defaults(t || {}, {
                save: !0
            });
            let o = {
                picture: e.picture
            };
            t.save ? this.model.save(o, t) : this.model.set(o, t)
        },
        onResize: function() {
            if (this.model.get("selectedType") !== "video") return;
            let e = this.model.get("video"),
                t = this.$el.find(".container");
            ai.default.isEmpty(e) || !e.provider_name || rr.setVideoPosition({
                $container: t,
                $media: t.find("iframe"),
                provider: e.provider_name,
                aspect_poster: e.aspect_poster,
                aspect_real: e.provider_name.toLowerCase() == "vimeo" ? e.aspect_real : e.aspect_poster,
                controls_remove: !0
            })
        },
        show: function() {
            let e = this.$el.parent();
            this.$el.detach().appendTo(e).stop().animate({
                opacity: 1
            }), this.onResize(), (0, Mc.default)(window).on("resize", this.onResize)
        },
        hide: function() {
            this.$el.stop().animate({
                opacity: 0
            }), this.model.get("selectedType") === "slideshow" && this.slideshowWidget && this.slideshowWidget.isAnimationRunning && this.slideshowWidget.stopAnimationLoop(), (0, Mc.default)(window).off("resize", this.onResize)
        },
        saveSlideshowPicture: function(e, t) {
            let o = this.model.get("slideshow"),
                i = o && o.pictures && Array.isArray(o.pictures) && o.pictures.length,
                n = Object.assign({}, e.picture, e.size),
                s = 1,
                a, l;
            i ? (l = rt(o), s = this.getMaxNum(o.pictures) + 1, a = Object.assign(n, {
                num: s,
                uuid: be.generateUUID()
            }), l.pictures.push(a), l.pictures = ai.default.sortBy(l.pictures, "num")) : (l = rt(this.defaultSlideshow), a = Object.assign(n, {
                num: s,
                uuid: be.generateUUID()
            }), l.pictures = [a]);
            let c = {
                slideshow: l
            };
            t.save ? this.model.save(c, t) : this.model.set(c, t), this.addPictureToSlideshow(a)
        },
        updateSlideshowPicture: function(e, t) {
            let o = this.model.get("slideshow"),
                i = o.pictures.findIndex(function(l) {
                    return l.uuid === t.id
                }),
                n = Object.assign({}, o.pictures[i], e.picture, e.size),
                s = rt(o);
            s.pictures[i] = n;
            let a = {
                slideshow: s
            };
            this.model.save(a, t), this.slideshowWidget.updatePicture(n)
        },
        selectSlideshowPicture: function(e) {
            this.slideshowWidget.selectSlide(e)
        },
        deleteSlideshowPicture: function(e) {
            this.slideshowWidget.removePicture(e)
        },
        updateSlideshowPicturePosition: function(e) {
            this.slideshowWidget.updatePicturePosition(e)
        },
        getMaxNum: function(e) {
            return ai.default.isEmpty(e) ? 0 : ai.default.max(ai.default.pluck(e, "num"))
        },
        addPictureToSlideshow: function(e) {
            this.slideshowWidget.addPicture(e)
        },
        updateSideshowDelay: function(e) {
            this.slideshowWidget.setDelay(e)
        },
        updateSideshowCrossfade: function(e) {
            this.slideshowWidget.setCrossfade(e)
        },
        runSlideshow: function() {
            this.slideshowWidget && this.slideshowWidget.runAnimation()
        },
        stopSlideshow: function() {
            this.slideshowWidget && this.slideshowWidget.stopAnimationLoop()
        },
        loadPic: function(e) {
            e = e || {}, this.cancelPictureLoading(), e.url || (e.url = this.getPictureUrl()), this.picUrl = e.url;
            let t = ai.default.isFunction(e.success) ? e.success : Mc.default.noop,
                o = ai.default.isFunction(e.error) ? e.error : Mc.default.noop;
            if (!this.picUrl) return t();
            var i = this._loadingPic = (0, Mc.default)("<img>").addClass("preload_image").appendTo("body").attr("src", this.picUrl).on("load", t).on("error", o).on("load", ai.default.bind(function() {
                this.trigger("loadimage", "main"), ai.default.defer(function() {
                    i == this._loadingPic && this.cancelPictureLoading(), i = null
                }.bind(this))
            }, this)).on("error", ai.default.bind(function() {
                ai.default.defer(function() {
                    i == this._loadingPic && this.cancelPictureLoading(), i = null
                }.bind(this))
            }, this))
        },
        cancelPictureLoading: function() {
            this._loadingPic && this._loadingPic.off("load").off("error").removeAttr("src").remove(), this._loadingPic = void 0
        },
        previewPic: function(e, t) {
            if (e && ai.default.last(e.split(".")) === "svg") return t && t.error && t.error();
            t = t || {}, this.loadPic({
                url: e,
                error: t.error,
                success: ai.default.bind(function() {
                    this.renewPic(), ai.default.isFunction(t.success) && t.success()
                }, this)
            })
        },
        onLoadImage: function(e) {
            e == "preview" && (this.previewLoaded = !0), e == "main" && (this.mainLoaded = !0), this.panel ? this.previewLoaded && this.mainLoaded && this.trigger("imagesReady") : this.mainLoaded && this.trigger("imagesReady")
        },
        onUnloadImage: function(e) {
            e == "preview" && (this.previewLoaded = !1), e == "main" && (this.mainLoaded = !1)
        },
        showPic: function() {
            this.$picture.stop().animate({
                opacity: this.model.get("opacity")
            }), this.$picture.css({
                "background-image": this.picUrl ? "url(" + this.picUrl + ")" : ""
            })
        },
        redraw: function(e, t) {
            t = t || {}, this.checkNeedRedraw(e, t) && (ai.default.isEmpty(e.changed) || (this.validate(), e.hasChanged("color") && this.updateBGColor(), t.viewportChange && !t.first && e.get("selectedType") === "slideshow" && this.slideshowWidget.rerender(e.get("slideshow")), e.hasChanged("picture") && this.getPictureUrl() != this.picUrl && e.get("selectedType") == "picture" && (this.getPictureUrl() ? (this.trigger("unloadimage", "main"), this.on("imagesReady", this.renewPic), this.loadPic()) : this.loadPic({
                success: this.showPic
            })), e.hasChanged("opacity") && this.$picture.css("opacity", this.model.get("opacity")), e.get("selectedType") === "video" && e.hasChanged("video") && this.onResize(), e.hasChanged("selectedType") && (this.model.get("selectedType") === "picture" ? this.loadPic({
                success: ai.default.bind(function() {
                    this.video.hide(), this.$slideshow.animate({
                        opacity: 0
                    }), this.slideshowWidget.stopAnimationLoop(), this.showPic()
                }, this)
            }) : this.model.get("selectedType") === "video" && t.viewportChange ? (this.$picture.stop().animate({
                opacity: 0
            }), this.$slideshow.animate({
                opacity: 0
            }), this.slideshowWidget.stopAnimationLoop(), this.video.show(), this.onResize()) : this.model.get("selectedType") === "slideshow" ? (this.$picture.stop().animate({
                opacity: 0
            }), this.video.hide(), this.$slideshow.animate({
                opacity: 1
            }), this.slideshowWidget.runAnimation()) : (this.video.hide(), this.$picture.stop().animate({
                opacity: 0
            }), this.slideshowWidget.stopAnimationLoop(), this.$slideshow.animate({
                opacity: 0
            }), this.model.get("selectedType") || this.model.set("selectedType", "color", {
                first: !0
            }))), t.skipTriggerRedraw || this.workspace.trigger("redraw")))
        },
        renewPic: function() {
            if (this.off("imagesReady", this.renewPic), this.skipRenew) {
                this.skipRenew = !1;
                return
            }
            let e = this.$el;
            this.createEl(), this.onViewportUpdate(this.lastViewportParams), this.updateBGColor(), this.$el.css({
                opacity: 0
            }), this.$el.find(".picture").css({
                "background-image": this.picUrl ? 'url("' + this.picUrl + '")' : "",
                opacity: this.model.get("opacity")
            });
            let t = this.workspace != RM.constructorRouter.workspace ? 0 : 1;
            this.$el.animate({
                opacity: t
            }, function() {
                e.remove()
            })
        },
        removePicture: function() {
            this.model.set("picture", null), this.model.save({}, {
                silent: !0,
                toHistory: !0
            }), this.$picture.stop().css("background-image", "")
        },
        preload: function() {
            this.preloaded || (this.preloaded = !0, this.loadPic({
                success: ai.default.bind(function() {
                    this.model.get("selectedType") === "picture" && ai.default.delay(this.showPic, 1e3)
                }, this)
            }))
        },
        onScroll: function() {
            if (!Modernizr.mac || !Modernizr.webkit) return !0;
            let e = this.$picture;
            e.removeClass("smooth3d"), clearTimeout(this._remove3dTimeout), this._remove3dTimeout = setTimeout(function() {
                e.addClass("smooth3d")
            }, 1e3)
        },
        setTempPicture: function(e) {
            !e || !e.content || this.loadPic({
                url: e.content,
                success: this.renewPic
            })
        }
    }, {
        getViewportDefaults: function(e, t, o) {
            return me.getViewportDefaults(e, t, o)
        },
        defaults: {
            slideshow: null
        }
    }), wW = uie
});
var Jy, qS = k(() => {
    "use strict";
    no();
    Jy = {
        "template-constructor-helpers-upload-input": Ae `

	<input class="rm-upload-input"
	       type="file"
	       name="upload"
	       data-url="/api/upload/" />

`
    }
});
var _W, SW = k(() => {
    "use strict";
    no();
    _W = {
        "template-constructor-helpers-upload-button": Ae `

	<div class="rm-upload-button">
		<div class="icon"></div>
	</div>

`
    }
});

function $m(e, t, o) {
    let i = e,
        n = t,
        s = o.split("!")[1],
        a = o.split("!")[0].split(":").sort(),
        l = n > i,
        c = n > i && s === "h" || i > n && s === "v";
    (l || c) && !(l && c) && (i = i + n, n = i - n, i = i - n);
    let d = i,
        p = i * (Number(a[1]) / Number(a[0]));
    (p > n || c && p > i) && (p = n, d = n * (Number(a[1]) / Number(a[0])), d > i && (d = i, p = i * (Number(a[0]) / Number(a[1]))));
    let h = Math.floor((i - d) / 2),
        u = Math.floor((n - p) / 2);
    return (l || c) && !(l && c) ? {
        cropX: u,
        cropY: h,
        cropW: n - u * 2,
        cropH: i - h * 2
    } : s === "h" ? {
        cropX: h,
        cropY: u,
        cropW: i - h * 2,
        cropH: n - u * 2
    } : {
        cropX: u,
        cropY: h,
        cropW: n - u * 2,
        cropH: i - h * 2
    }
}
var QS = k(() => {
    "use strict"
});

function CW({
    scale: e,
    currentSizes: t,
    originalCrop: o
}) {
    let i = c => Number(c.toFixed(3)),
        n = {
            width: i(o.w * e),
            height: i(o.h * e)
        },
        s = {
            width: n.width,
            height: n.height
        },
        a = {
            left: 0,
            top: 0
        },
        l = Bt.center(t, {
            width: o.w * e,
            height: o.h * e
        });
    return a.left = -i(l.left), a.top = -i(l.top), {
        top: a.top < 0 ? a.top : 0,
        left: a.left < 0 ? a.left : 0,
        width: s.width,
        height: s.height
    }
}
var kW = k(() => {
    "use strict";
    Ml()
});

function eC({
    scale: e,
    currentSizes: t,
    originalCrop: o
}) {
    let i = CW({
        scale: e,
        currentSizes: t,
        originalCrop: o
    });
    return {
        cropX: Math.round(Math.max(0, -i.left / e)) + o.x,
        cropY: Math.round(Math.max(0, -i.top / e)) + o.y,
        cropH: Math.round(t.height / e),
        cropW: Math.round(t.width / e)
    }
}
var IW = k(() => {
    "use strict";
    kW()
});

function Rc({
    scale: e,
    currentSizes: t,
    originalCrop: o
}) {
    let i = Bt.center({
            width: t.width / e,
            height: t.height / e
        }, {
            width: o.w,
            height: o.h
        }),
        n = {
            cropX: Math.max(0, Math.round(o.x + i.left)),
            cropY: Math.max(0, Math.round(o.y + i.top))
        };
    return {
        cropX: n.cropX,
        cropY: n.cropY,
        cropW: Math.round(i.width),
        cropH: Math.round(i.height)
    }
}
var PW = k(() => {
    "use strict";
    Ml()
});

function TW({
    scale: e,
    currentSizes: t,
    initialCrop: o,
    fwpos: i,
    fhpos: n
}) {
    if (n === void 0 && i === void 0) return { ...o,
        originalCropX: Math.round(o.cropX),
        originalCropY: Math.round(o.cropY),
        originalCropW: Math.round(o.cropW),
        originalCropH: Math.round(o.cropH)
    };
    let s = Bt.center({
            width: t.width / e,
            height: t.height / e
        }, {
            width: o.cropW,
            height: o.cropH
        }),
        a = {
            cropX: Math.round(Math.max(0, s.left)),
            cropY: Math.round(Math.max(0, s.top)),
            cropW: Math.round(s.width),
            cropH: Math.round(s.height)
        };
    i !== void 0 && !Number.isNaN(i) && (a.cropY = Math.round(Math.max(0, a.cropY * i / 50))), n !== void 0 && !Number.isNaN(n) && (a.cropX = Math.round(Math.max(0, a.cropX * n / 50))), a.cropX = o.cropX + a.cropX, a.cropY = o.cropY + a.cropY;
    let l = {
        originalCropX: Math.round(a.cropX),
        originalCropY: Math.round(a.cropY),
        originalCropW: Math.round(a.cropW),
        originalCropH: Math.round(a.cropH)
    };
    return { ...a,
        ...l
    }
}
var BW = k(() => {
    "use strict";
    Ml()
});
var Go, We, MW, _i, tC, hie, qy, oC = k(() => {
    "use strict";
    Go = E(Ze()), We = E(ze());
    oo();
    Ky();
    On();
    Ro();
    Wo();
    qS();
    SW();
    Ib();
    ug();
    Bh();
    yr();
    Zr();
    ko();
    h1();
    Ip();
    wc();
    QS();
    IW();
    Yx();
    PW();
    Ml();
    BW();
    pd();
    MW = { ..._W,
        ...Jy
    }, _i = {
        url: "url",
        unscaledUrl: "unscaledUrl",
        unscaledOptimizedUrl: "unscaledOptimizedUrl",
        finalUrl: "finalUrl",
        final2xUrl: "final2xUrl",
        lambdaUrl: "lambdaUrl",
        lambdaUrlForOldWidget: "lambdaUrlForOldWidget"
    }, tC = ma.extend({
        name: "Picture",
        sort_index: 2,
        thumb: "picture",
        icon_color: "#009274",
        proportional: !1,
        dontSaveOnResize: !0,
        tempPicture: null,
        $preloader: null,
        $borderContainerDuringResize: null,
        isPictureUpdating: !1,
        isPictureResizing: !1,
        sizesBeforeCrop: {
            width: 0,
            height: 0
        },
        cropBoxWithoutScaleBeforeCrop: null,
        originalCropBoxBeforeCrop: null,
        preloader_is_activated: {
            default: !1,
            tablet_portrait: !1,
            phone_portrait: !1
        },
        _requestFinalImage: {
            default: null,
            tablet_portrait: null,
            phone_portrait: null
        },
        initial_controls: ["picture_settings", "picture_fwpos", "picture_crop", "common_rotation", "picture_link", "picture_alt", "common_interactions", "lightbox", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset"],
        animated_controls: ["picture_settings", "common_rotation", "picture_link", "picture_alt", "lightbox", "common_interactions", "common_draggable", "common_align", "common_shadow", "common_cursor", "common_position", "common_layer", "my_preset"],
        vector_controls: ["picture_settings", "picture_color", "common_rotation", "picture_link", "picture_alt", "common_interactions", "lightbox", "common_cursor", "common_draggable", "common_align", "common_shadow", "common_position", "common_layer", "my_preset"],
        initialControlsDividers: ["common_rotation", "picture_link", "common_shadow"],
        loadedControlsDividers: ["common_rotation", "picture_alt", "common_shadow"],
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            6: "common_interactions",
            7: "lightbox",
            8: "common_cursor",
            9: "common_draggable",
            10: "common_shadow",
            11: "common_position",
            12: "common_layer",
            13: "readymag_preset",
            14: "my_preset"
        },
        initialize: function(e, t) {
            this.migrateOldData(e), this.initBlock(e, t), this._imgsPreload = [], this._actualPreload = [], this.frameClass = hie, this._css = function(o) {
                return parseInt(this.css(o), 10)
            }, this.setControls(), this.picloaded = {}, this.setScaledImage.__debounced = We.default.debounce(this.setScaledImage, 500), this.setFinal.__debounced = We.default.debounce(this.setFinal, 1e3), this.loadVectorDebounced = We.default.debounce(this.loadVector.bind(this), 300), this.updatePictureDebounced = We.default.debounce(this.updatePicture.bind(this), 500), this.saveCurrentPositionAsCropParamsDebounced = We.default.debounce(this.saveCurrentPositionAsCropParams, 500), this.setIsPictureResizingDebounced = We.default.debounce(this.setIsPictureResizing, 1e3), this.updateCropParamsAfterUpdatePictureParamsDebounced = We.default.debounce(this.updateCropParamsAfterUpdatePictureParams, 200), this.sendEventToHoneycombDebounced = We.default.debounce(this.sendEventToHoneycomb, 200), this.model.skipResponse = !0, this.listenTo(t, "workspace-resize", this.onWorkspaceResizePicture), this.listenTo(t.page, "change:viewport", this.onChangeViewport), this.listenTo(this.model, "change:picture", (o, i, n) => n ? .socketUpdate && i && this.setPreviewImage(i.url)), this.listenTo(this.model, "change:full_width_margin change:full_height_margin", this.updateCropParamsAfterUpdatePictureParamsDebounced), this.listenTo(t.page, "change:height", this.onPageHeightChanged), this.listenTo(this.model, "change:fixed_position", this.onFixedPositionChanged), this.groupControlsDividers = ["picture_settings", "common_shadow"], this.groupControls[4] = "picture_settings"
        },
        initVector: function() {
            this.setControls(), this.updateControls(), this.loadVectorDebounced()
        },
        checkLambdaUrlSetCorrectly: function(e) {
            if (!this.useLambdaUrl()) return;
            let t = this.model.viewport_default ? .picture ? .lambdaUrl,
                o = this.model.viewport_phone_portrait ? .picture ? .lambdaUrl,
                i = this.model.viewport_tablet_portrait ? .picture ? .lambdaUrl;
            (o && t !== o || i && t !== i) && this.sendEventToHoneycombDebounced({ ...e,
                attributes: this.model.toJSON()
            })
        },
        sendEventToHoneycomb: function(e) {
            sr.sendEvent({
                type: "pictureWidgetHasDifferentImagesOnViewports",
                widget: this.model.toJSON(),
                payload: e
            })
        },
        setIsPictureUpdating: function(e) {
            this.isPictureUpdating = e
        },
        setIsPictureResizing: function(e) {
            this.setIsPictureResizingDebounced.cancel(), this.isPictureResizing = e, e || this.useLambdaUrl() && this.resetBorderStyles()
        },
        getActualScaleOfPictureFrame: function() {
            let e = this.workspace.page.getViewport() === "default",
                t = RM.constructorRouter.zoom.getZoom(),
                o = this.workspace.mag.get("opts").scalableviewer && e ? RM.constructorRouter.zoom.getScaleRatio() : 1;
            return Number((t / o).toFixed(5))
        },
        getScaleBasedCurrentSizes: function({
            currentSizes: e,
            cropH: t,
            cropW: o,
            overridedOriginalCrop: i
        }) {
            let n = this.getActualScaleOfPictureFrame(),
                s = this.getOriginalCrop();
            return Cb({
                currentSizes: e,
                actualZoomOfPictureFrame: n,
                cropH: t,
                cropW: o,
                originalCropW: i ? .w ? ? s.w,
                originalCropH: i ? .h ? ? s.h,
                isFullHeight: this.isFullHeight(),
                isFullWidth: this.isFullWidth()
            })
        },
        getCrop: function(e = {}, t) {
            let o = t || this.workspace.page.getCurrentViewport(),
                i = e[`viewport_${o}`] || this.model[`viewport_${o}`];
            return i ? {
                cropX: i.cropX,
                cropY: i.cropY,
                cropW: i.cropW,
                cropH: i.cropH
            } : {}
        },
        getOriginalCrop: function(e = {}, t) {
            let o = t || this.workspace.page.getCurrentViewport(),
                i = e[`viewport_${o}`] || this.model[`viewport_${o}`],
                n = this.getCrop(e, t);
            return i ? {
                x: i.originalCropX ? ? n.cropX,
                y: i.originalCropY ? ? n.cropY,
                w: i.originalCropW ? ? n.cropW,
                h: i.originalCropH ? ? n.cropH
            } : {}
        },
        getSizesForDefaultZoom: function() {
            let e = this.getActualScaleOfPictureFrame(),
                t = RM.constructorRouter.zoom.getZoom(),
                o = this.restoreFixed || this.model.get("fixed_position"),
                i = this.model.get("w"),
                n = this.model.get("h");
            return (this.isFullWidth() || this.isFullHeight()) && (e < 1 || o && e > 1) && (i = this.isFullWidth() ? i * e : i, n = this.isFullHeight() ? n * (o ? e : t) : n), {
                width: i,
                height: n
            }
        },
        isOriginalCropExist: function(e = {}, t) {
            let o = t || this.workspace.page.getCurrentViewport() || "default",
                i = e[`viewport_${o}`] || this.model[`viewport_${o}`];
            return i ? ![i.originalCropH, i.originalCropW, i.originalCropX, i.originalCropY].includes(void 0) : !1
        },
        onSingleColumnLayout: function(e) {
            let t = this.isOriginalCropExist();
            if (this.model.get("version") !== 2 && !t) return;
            let o = this.isOriginalCropExist(this.model, "default"),
                i = this.getOriginalCrop(this.model, "default"),
                n = this.model["viewport_default"],
                s = n ? .is_full_width,
                a = n ? .is_full_height,
                l = 0;
            s || a ? l = Math.max(e.width / i.w, e.height / i.h) : l = this.getScaleBasedCurrentSizes({
                currentSizes: { ...e
                },
                cropH: n.cropH,
                cropW: n.cropW,
                overridedOriginalCrop: {
                    w: n.originalCropW ? ? n.cropW,
                    h: n.origignalCropH ? ? n.cropH
                }
            });
            let c = eC({
                currentSizes: { ...e
                },
                scale: l,
                originalCrop: { ...i
                }
            });
            o && (c.originalCropW = c.cropW, c.originalCropH = c.cropH, c.originalCropX = c.cropX, c.originalCropY = c.cropY), this.model.set({
                scale: l,
                ratio: Number((e.width / (e.height || 1)).toFixed(5)),
                ...c
            })
        },
        updateCropParamsAfterUpdatePictureParams: function(e = {}) {
            let t = this.isOriginalCropExist();
            if (this.model.get("version") !== 2 && !t) return;
            let {
                saveDimensions: o = !0
            } = e, i = this.getCrop();
            if (!!([i.cropX, i.cropY, i.cropH, i.cropW].includes(void 0) || this.isFullWidth() && this.model.get("fwpos") || this.isFullHeight() && this.model.get("fhpos") || this.fwposmode || this ? .restoreFixed || this.isPictureResizing || this._modeTransition)) return;
            let s = this.getOriginalCrop(),
                a = this.getSizesForDefaultZoom(),
                l = this.getScaleBasedCurrentSizes({
                    currentSizes: a,
                    cropH: s.h,
                    cropW: s.w
                }),
                d = { ...eC({
                        scale: l,
                        currentSizes: a,
                        originalCrop: s
                    }),
                    scale: l
                };
            o && (d = { ...d,
                w: a.width,
                h: a.height
            }), (i.cropX !== d.cropX || i.cropY !== d.cropY || i.cropW !== d.cropW || i.cropH !== d.cropH) && (this.model.set(d, {
                silent: !0,
                toHistory: !1,
                skipHistory: !0
            }), this.model.save(null, {
                silent: !0,
                toHistory: !1,
                skipHistory: !0
            }), this.useLambdaUrl() || this.getFinalImage(null, {
                silent: !0,
                skipHistory: !0
            }))
        },
        updatePicture: function(e) {
            this.setIsPictureUpdating(!0);
            let t = this.isFullWidth() || this.isFullHeight();
            e = e || {}, !e.load && !this.has_parent_block && (e.load = _i.finalUrl), Modernizr.retina && e.load === _i.finalUrl && (e.load = _i.final2xUrl), !this.useLambdaUrl() && !this.cropmode && (e.load = _i.lambdaUrlForOldWidget), !e.load && !this.cropmode && RM.constructorRouter.zoom.getZoom() > 1 && !this.has_parent_block && (e.load = _i.unscaledUrl), this.has_parent_block && !e.load && (e.load = _i.url), (this.isVector() || this.isAnimated()) && (e.load = "editedVectorUrl", this.model.get("picture")[e.load] || (e.load = _i.url)), this.useLambdaUrl() && (e.load = _i.lambdaUrl), !this.cropmode && !this.fakingMode && !this.fwposmode && this.changeControls({
                viewportChange: e.viewportChange,
                noSelect: e.noSelect
            });
            let o;
            if (this.useLambdaUrl() ? o = this.cropmode || this.in_constrained_crop_mode || this.fwposmode ? this.getOriginalLambdaUrl() : this.getLambdaUrl() : (o = e.load === _i.lambdaUrlForOldWidget ? this.getLambdaUrl() : this.model.get("picture") && this.model.get("picture")[e.load], t && !o && (o = this.model.get("picture") && this.model.get("picture")[_i.url])), !o && !this.model.get("picture")) {
                this.$picture && this.$picture.remove(), this.model.get("hiddenBeforeUpload") ? (this.$el.addClass("hidden"), this.model.unset("hiddenBeforeUpload", {
                    skipHistory: !0,
                    silent: !0
                })) : this.$el.addClass("empty"), this.setIsPictureUpdating(!1);
                return
            }
            if (e.renewRatio) {
                We.default.defer(function() {
                    this.fixSize(e)
                }.bind(this)), this.setIsPictureUpdating(!1);
                return
            }
            if (this.model.get("picture") && !o && (o = this.model.get("picture").unscaledUrl || this.model.get("picture").url, !o)) {
                this.setIsPictureUpdating(!1);
                return
            }
            let i = this,
                n = this.$content;
            this.$el.removeClass("empty"), this.$el.removeClass("hidden"), e.skipAnimation && n.children().remove(), this._preload(e.load, function(s) {
                if (!s) {
                    this.setIsPictureUpdating(!1);
                    return
                }
                if (!i.isVector && (i.cropmode || i.in_constrained_crop_mode) && e.load !== _i.url) {
                    this.setIsPictureUpdating(!1);
                    return
                }
                if (i.fakingMode) {
                    this.setIsPictureUpdating(!1);
                    return
                }
                if (i.useLambdaUrl() && o !== i._actualPreload[_i.lambdaUrl]) {
                    this.setIsPictureUpdating(!1);
                    return
                }
                let a = function() {
                    i.$picture = s, e.complete && e.complete.call(), i.setIsPictureUpdating(!1), s.css({
                        opacity: 1
                    }), n.children().not(":last").not(".tempBorderContainer").remove(), i.updateSettings()
                };
                if (n.children().stop(!1, !0).css({
                        opacity: 1
                    }), e.prepare && e.prepare(s), i.$picture && !e.skipAnimation && s.css("opacity", 0), i.isVector()) {
                    let l = document.importNode(s.get(0), !0),
                        c = (0, Go.default)('<div class="svg-scale-wrapper"></div>');
                    c.append(l), n.append(c), i.$svg = (0, Go.default)(l), s = i.$svg
                } else s.appendTo(n);
                this.isPictureResizing || this.cropmode || n.css("border-radius", ""), i.unsetTempPicture(), i.updateSettings(s), i.$picture && !e.skipAnimation ? s.animate({
                    opacity: 1
                }, 200, a) : a(), i.hideIconLoader(), !e.toggledHidden && (i.cropmode || We.default.defer(We.default.bind(function() {
                    RM.constructorRouter.workspace.hideLoader()
                }, i)))
            })
        },
        render: function() {
            this.create(), this.$el.addClass("picture"), this.useLambdaUrl() && ((this.model.get("border_radius") || this.model.get("border_radius_max") || this.model.get("border_radius_independent")) && this.$content.css("border-radius", this.getBorderRadius()), (0, Go.default)("<div/>").addClass("lqip").css({
                "background-image": `url(${this.getLqipUrl()})`,
                opacity: this.model.get("opacity") === void 0 ? 1 : this.model.get("opacity")
            }).appendTo(this.$content));
            let e = this.model.changed && this.model.changed.hidden === !1;
            !this.has_parent_block && this.updatePicture({
                isNew: this.model.created,
                isFirst: !0,
                toggledHidden: e,
                renewRatio: !this.model.get("ratio")
            }), this.triggerReady(), !e && (this.frame.recalcPointsDirections(), this.updateSettings(), this.has_parent_block && (this.init_file_uploading(), this.enter_constrained_crop_mode()))
        },
        css: function(e = {}) {
            if (e.resizeContent && (e.width < this.model.attributes.w || e.height < this.model.attributes.h)) {
                let t = Math.min(e.width / this.model.attributes.w, e.height / this.model.attributes.h);
                this.model.get("border_size") && this.model.set("border_size", Math.floor(this.model.get("border_size") * t) || 1)
            }
            me.prototype.css.apply(this, arguments)
        },
        init_file_uploading: function() {
            let e, t;
            this.has_parent_block ? this.$upload_input = this.workspace.$picture_upload_input : (e = MW["template-constructor-helpers-upload-input"], this.$upload_input = (0, Go.default)(e())), t = MW["template-constructor-helpers-upload-button"], this.$upload_button = (0, Go.default)(t()), this.uploader = new pu(this, {
                fileInput: this.$upload_input
            }), this.bindUploader(this.uploader), this.$upload_button.on("click", function() {
                this.$upload_input.trigger("click", "stop")
            }.bind(this)), this.model.on("change:picture", this.toggle_loaded), this.$upload_input.add(this.$upload_button).appendTo(this.$el)
        },
        bindUploader: function(e) {
            e.on("start", this.on_start_upload), e.on("done", this.on_done_upload), e.on("fail", this.on_fail_upload)
        },
        on_start_upload: function() {
            this.showIconLoader(), this.originalLoaded = !1
        },
        on_done_upload: function(e, t) {
            if (!t || !t.result) {
                console.error("error file upload!");
                return
            }
            this.changePicture(t.result, {
                toHistory: this.model.get("picture")
            }), this.workspace.trigger("loading_original_picture")
        },
        on_fail_upload: function() {
            this.hideIconLoader()
        },
        toggle_loaded: function() {
            this.model.get("picture") && (this.isNew = !1), this.model.get("picture") && (this.$upload_button.removeClass("uploading"), this.in_constrained_crop_mode = !1, this.enter_constrained_crop_mode())
        },
        getIconData: function() {
            return this.isVector() ? this : null
        },
        getIconStyle: function(e = {}) {
            let t = {},
                o = "./constructor/widgetbar/icons/";
            this.icon_color && (t["background-color"] = this.icon_color);
            let i = "";
            return this.model.get("picture") ? (this.isVector() || (i = this.useLambdaUrl() ? this.getThumbnailUrl() : this.model.get("picture").thumbUrl, t["background-size"] = "cover"), e.small || (t["border-radius"] = "8px")) : i = G(o + "picture.svg"), t["background-image"] = `url(${i})`, t
        },
        enterCropMode: function(e = {}) {
            let t = !1;
            for (let n in this._imgsPreload) this._imgsPreload.hasOwnProperty(n) && this._imgsPreload[n] !== void 0 && this._imgsPreload[n] !== !1 && (t = !0);
            if (this.isPictureResizing || t) {
                this.showTempPreloader(), setTimeout(() => {
                    this.enterCropMode(e)
                }, 100);
                return
            } else this.deleteBorderContainerDurngResize(), this.hideTempPreloader();
            if (this.isFullHeight() || this.isFullWidth()) {
                let n = RM.constructorRouter.zoom.getZoom(),
                    s = RM.constructorRouter.zoom.getScaleRatio();
                n < s && this.$el.toggleClass("no-resize", !0)
            }
            if (this.isFullWidth() || this.isFullHeight() ? this.migrateFWPosToCropParams() : this.migrateCropParamsToOriginalCropParams(), this.updateWidgetVersion(), this.cropmode || !this.model.get("picture")) return;
            let {
                fwposmode: o
            } = e;
            this.$content.css({
                "border-radius": this.getBorderRadius()
            });
            let i = this.model.get("fixed_position");
            if (this.sizesBeforeCrop = {
                    width: i && this.isFullWidth() ? this.getFullWidthDims().w : this.model.get("w"),
                    height: i && this.isFullHeight() ? this.getFullHeightDims().h : this.model.get("h")
                }, this.cropBoxWithoutScaleBeforeCrop = {
                    cropX: this.model.get("cropX"),
                    cropY: this.model.get("cropY"),
                    cropW: this.model.get("cropW"),
                    cropH: this.model.get("cropH")
                }, this.originalCropBoxBeforeCrop = { ...this.getOriginalCrop()
                }, o && (this.fwposmode = !0), this.in_constrained_crop_mode) {
                if (!this.originalLoaded) return;
                this._beforeCropAttrs = We.default.clone(this.model.attributes), this.cropmode = !0, this.disableDragging = !0, this.$el.addClass("crop"), jo.setEmptyHandlers(), (0, Go.default)("#main").css("overflow-y", "hidden"), this._modeTransition = !1;
                let n = this.workspace.get_box_data();
                this.initialCrop = {
                    left: n.left_abs + parseInt(this.$el.css("left")) - Math.round(this.model.get("cropX") * this.model.get("scale")),
                    top: n.top_abs + parseInt(this.$el.css("top")) - Math.round(this.model.get("cropY") * this.model.get("scale"))
                };
                let s = We.default.clone(this.$picture);
                s.css({
                    width: Math.round(this.model.get("originalW") * this.model.get("scale")),
                    height: Math.round(this.model.get("originalH") * this.model.get("scale")),
                    top: -Math.round(this.model.get("cropY") * this.model.get("scale")),
                    left: -Math.round(this.model.get("cropX") * this.model.get("scale"))
                }), this.frame.constraints = {
                    top: this.initialCrop.top,
                    left: this.initialCrop.left,
                    width: Math.round(this.model.get("originalW") * this.model.get("scale")),
                    height: Math.round(this.model.get("originalH") * this.model.get("scale"))
                }, this.showBackPic(s), this.bindPictureDrag(), this.trigger("modechanged transitionmode", this.cropmode, this._modeTransition)
            } else this.storeFixedPosition(), this._beforeCropAttrs = We.default.clone(this.model.attributes), this._getFinalRequest && this._getFinalRequest.abort(), this.transitionMode(!0), this.frame.removeRotationState(), this.frame.resetRotation(), this.updatePicture({
                load: _i.url,
                prepare: We.default.bind(function(n) {
                    let s = this.getOriginalCrop(),
                        a = {
                            x: this.model.get("cropX"),
                            y: this.model.get("cropY"),
                            w: this.model.get("cropW"),
                            h: this.model.get("cropH")
                        },
                        l = {
                            width: this.model.get("originalW"),
                            height: this.model.get("originalH")
                        },
                        c = {
                            width: this.model.get("w"),
                            height: this.model.get("h")
                        },
                        d = this.getScaleBasedCurrentSizes({
                            currentSizes: c,
                            cropH: a.h,
                            cropW: a.w
                        }),
                        p = Rc({
                            currentSizes: c,
                            scale: d,
                            originalCrop: s
                        }),
                        h = {
                            width: l.width * d,
                            height: l.height * d,
                            top: p.cropY * d,
                            left: p.cropX * d
                        };
                    this.initialCrop = {
                        top: Math.round(parseInt(this.$el.css("top")) - h.top),
                        left: Math.round(parseInt(this.$el.css("left")) - h.left)
                    }, n.css({
                        width: Math.round(h.width),
                        height: Math.round(h.height),
                        top: -Math.round(h.top),
                        left: -Math.round(h.left)
                    }), this.showBackPic(n)
                }, this),
                complete: We.default.bind(function() {
                    this.frame.enableMouseProceeding(), this.proportional = !1, this.isLocked() && this.$el.removeClass("no-drag"), this.bindPictureDrag(), this.frame.setConstraints(this.$backpic), this.originalLoaded = !0, this._modeTransition = !1, this.trigger("modechanged transitionmode", this.cropmode, this._modeTransition)
                }, this)
            })
        },
        enter_constrained_crop_mode: function() {
            if (this.in_constrained_crop_mode || !this.model.get("picture")) return;
            this.in_constrained_crop_mode = !0, this.proportional = !1, this.originalLoaded = !1, this.$upload_button.addClass("uploading");
            let e = this.workspace.block.model.get("flags") ? .tipFreePosition || !1;
            this.updatePicture({
                load: _i.url,
                skipAnimation: !0,
                prepare: function(t) {
                    let o = this.workspace.get_box_data();
                    this.initialCrop = {
                        left: o.left_abs + parseInt(this.$el.css("left")) - Math.round(this.model.get("cropX") * this.model.get("scale")),
                        top: o.top_abs + parseInt(this.$el.css("top")) - Math.round(this.model.get("cropY") * this.model.get("scale"))
                    }, e ? t.css({
                        top: 0,
                        left: 0,
                        width: this.model.get("w"),
                        height: this.model.get("h"),
                        backgroundSize: "cover"
                    }) : t.css({
                        top: 0,
                        left: 0,
                        width: this.model.get("w"),
                        height: this.model.get("h")
                    }), this.frame.constraints = {
                        top: this.initialCrop.top,
                        left: this.initialCrop.left,
                        width: Math.round(this.model.get("originalW") * this.model.get("scale")),
                        height: Math.round(this.model.get("originalH") * this.model.get("scale"))
                    }
                }.bind(this),
                complete: function() {
                    this.originalLoaded = !0, this.workspace.trigger("loading_original_picture"), this.$upload_button.removeClass("uploading")
                }.bind(this)
            })
        },
        leaveCropMode: function({
            fwposmode: e,
            noSave: t,
            viewportChange: o
        } = {}) {
            if (this.hideBackPic(), !this.cropmode || !this.model.get("picture")) return;
            if (this.$content.css({
                    "border-radius": ""
                }), this.in_constrained_crop_mode) {
                this.leave_crop_mode_to_constrained_crop_mode(t);
                return
            }
            this.isLocked() && this.$el.addClass("no-drag"), this.unbindPictureDrag();
            let i = this.model.get("fixed_position");
            this.disableDragging = !1, this.sizesBeforeCrop = {
                width: i && this.isFullWidth() ? this.getFullWidthDims().w : this.model.get("w"),
                height: i && this.isFullHeight() ? this.getFullHeightDims().h : this.model.get("h")
            }, this.cropBoxWithoutScaleBeforeCrop = null, this.originalCropBoxBeforeCrop = null, this.$el.toggleClass("no-resize", !1), this.frame.constraints = null, this.transitionMode(!1), this.frame.restoreRotation();
            let n = {
                top: this.$picture.position().top,
                left: this.$picture.position().left,
                width: this.$picture.width(),
                height: this.$picture.height()
            };
            if (this.$picture.css({
                    width: "100%",
                    height: "100%",
                    left: 0,
                    top: 0,
                    "background-size": n.width + "px " + n.height + "px",
                    "background-position": n.left + "px " + n.top + "px"
                }), this.restoreFixedPosition(!0), (e || this.fwposmode) && (this.fwposmode = !1), t) this.onLeavingCropMode();
            else {
                let s = this;
                if (this.ratio = this.model.get("cropW") / this.model.get("cropH"), We.default.isEqual(this._beforeCropAttrs, this.model.attributes)) {
                    this.updatePicture({
                        noSelect: !0,
                        complete: We.default.bind(function() {
                            this.onLeavingCropMode()
                        }, this)
                    });
                    return
                }
                this.getFinalImage(function(a, l) {
                    if (o && s.useLambdaUrl()) {
                        s.onLeavingCropMode();
                        return
                    }
                    l !== "abort" ? s.updatePicture({
                        noSelect: !0,
                        complete: s.onLeavingCropMode
                    }) : (s.onLeavingCropMode(), s.updateSettings())
                }, {
                    silent: !this.useLambdaUrl()
                })
            }
        },
        leave_crop_mode_to_constrained_crop_mode: function(e) {
            this.unbindPictureDrag(), this._modeTransition = !1, this.disableDragging = !0, this.cropmode = !1, this.trigger("modechanged transitionmode", this.cropmode, this._modeTransition), jo.removeCustomHandlers(), (0, Go.default)("#main").css("overflow-y", "auto"), this.$el.removeClass("crop"), this.hideBackPic(), e || (this.ratio = this.model.get("cropW") / this.model.get("cropH"), this.isAnimated() || this.useLambdaUrl() ? this.model.save({}, {
                silent: !0,
                skipHistory: !0
            }) : this.getFinalImage(function(t) {
                t && console.error("w-picture getFinalImage error: ", t)
            }, {
                silent: !0,
                skipHistory: !0
            }))
        },
        onLeavingCropMode: function() {
            this.$picture.css({
                width: "100%",
                height: "100%",
                left: 0,
                top: 0
            }), this._modeTransition = !1, this._waitingForRescale && (this._waitingForRescale = !1, this.setScaledImage())
        },
        onLeavingCropResize: function(e) {
            if (this.cropmode) return;
            let t = e.width / this.model.get("cropW");
            this.$picture.css({
                left: -this.model.get("cropX") * t,
                top: -this.model.get("cropY") * t,
                width: this.model.get("originalW") * t,
                height: this.model.get("originalH") * t
            })
        },
        toggleCropMode: function() {
            this.isVector() || this.isAnimated() || this.trigger("crop_click")
        },
        toggleFWPosMode: function() {
            this.isVector() || this.isAnimated() || this.getActualScaleOfPictureFrame() < 1 && this.isFullHeight() && this.isFullWidth() || this.trigger("fwpos_click")
        },
        onDblClick: function() {
            this.selected && (!this.model.get("pack_id") || this.workspace.getSelectedBlocks().length === 1 ? this.model.get("is_full_width") || this.model.get("is_full_height") ? this.toggleFWPosMode() : this.toggleCropMode() : me.prototype.onDblClick.apply(this, arguments))
        },
        enterFWPosMode: function() {
            this.fwposmode || !this.model.get("picture") || (this.disableDragging = !0, this.enterCropMode({
                fwposmode: {
                    active: !0
                }
            }))
        },
        leaveFWPosMode: function() {
            !this.fwposmode || !this.model.get("picture") || (this.disableDragging = !1, this.leaveCropMode({
                fwposmode: {
                    active: !1
                }
            }))
        },
        dragFWPosPictureStart: function(e, t) {
            let o = this.model.get("is_full_height"),
                i = this.model.get("is_full_width");
            this.frame.disableMouseProceeding(), this.$el.addClass("grabbing"), i && (t.prev_offsetY = t.offsetY), o && (t.prev_offsetX = t.offsetX)
        },
        dragFWPosPicture: function(e, t) {
            let o = this.model.get("is_full_height"),
                i = this.model.get("is_full_width"),
                n = this.model.get("fwpos"),
                s = this.model.get("fhpos");
            i && t.prev_offsetY === void 0 && this.dragFWPosPictureStart(e, t), o && t.prev_offsetX === void 0 && this.dragFWPosPictureStart(e, t), i && (n = n ? ? 50, n -= (t.offsetY - t.prev_offsetY) / 5, n = Math.min(Math.max(n, 0), 100), this.model.set({
                fwpos: n
            }), t.prev_offsetY = t.offsetY, t.last_fwpos = n), o && (s = s ? ? 50, s -= (t.offsetX - t.prev_offsetX) / 5, s = Math.min(Math.max(s, 0), 100), this.model.set({
                fhpos: s
            }), t.prev_offsetX = t.offsetX, t.last_fhpos = s)
        },
        dragFWPosPictureStop: function(e, t) {
            let o = this.model.get("is_full_height"),
                i = this.model.get("is_full_width"),
                n = {
                    width: this.model.get("w"),
                    height: this.model.get("h")
                };
            if (this.frame.enableMouseProceeding(), i && t.last_fwpos != null) {
                let s = {
                    originalCropX: 0,
                    originalCropY: 0,
                    originalCropH: this.model.get("cropH"),
                    originalCropW: this.model.get("originalW")
                };
                s.originalCropY = this.model.get("originalH") * t.last_fwpos / 100, s.originalCropY -= n.height * (t.last_fwpos / 100);
                let a = this.getScaleBasedCurrentSizes({
                    currentSizes: n,
                    cropH: s.originalCropH,
                    cropW: s.originalCropW
                });
                s.originalCropH = n.height / a, this.model.save({
                    fwpos: t.last_fwpos,
                    ...s
                })
            }
            o && t.last_fhpos != null && this.model.save({
                fhpos: t.last_fhpos
            }), this.$el.removeClass("grabbing")
        },
        transitionMode: function(e) {
            let t = this.model.get("fixed_position") || this ? .restoreFixed;
            this._modeTransition = !0, this.disableDragging = e, this.cropmode = e, this.trigger("modechanged transitionmode", this.cropmode, this._modeTransition), e ? (this._scaledimageXHR && this._scaledimageXHR.abort(), this.frame.disableMouseProceeding(), this.$el.addClass("crop"), this.model.off("change", this.onModelChange), jo.setEmptyHandlers(), (t || !this.isFullHeight() && !this.isFullWidth()) && (0, Go.default)("#main").css("overflow-y", "hidden")) : (this.$el.removeClass("crop"), this.model.on("change", this.onModelChange), jo.removeCustomHandlers(), (0, Go.default)("#main").css("overflow-y", "auto"))
        },
        onCropResizeUsingKeyboard: function(e, t) {
            let o = this.getModelBox();
            if ((this.isFullWidth() || this.isFullHeight()) && (this.getActualScaleOfPictureFrame() < 1 || this ? .restoreFixed)) return;
            let i = this.model.get("scale");
            i = this.getScaleBasedCurrentSizes({
                currentSizes: {
                    width: this.sizesBeforeCrop.width,
                    height: this.sizesBeforeCrop.height
                },
                cropH: this.cropBoxWithoutScaleBeforeCrop.cropH,
                cropW: this.cropBoxWithoutScaleBeforeCrop.cropW
            });
            let n = function(l) {
                    return Math.round(l * i)
                },
                s = {
                    cropX: n(this.model.get("cropX")),
                    cropY: n(this.model.get("cropY")),
                    cropW: n(this.model.get("cropW")),
                    cropH: n(this.model.get("cropH"))
                },
                a = {
                    width: n(this.model.get("originalW")),
                    height: n(this.model.get("originalH"))
                };
            s.cropX + s.cropW + t.deltaX > a.width ? t.deltaX = a.width - (s.cropX + s.cropW) : s.cropW + t.deltaX < 0 && (t.deltaX = -s.cropW), s.cropY + s.cropH + t.deltaY > a.height ? t.deltaY = a.height - (s.cropY + s.cropH) : s.cropH + t.deltaY < 0 && (t.deltaY = -s.cropH), o.width = n(this.model.get("cropW")) + t.deltaX, o.height = n(this.model.get("cropH")) + t.deltaY, this.onResizeStart && this.onResizeStart(e, t), this.frame.doResize(o, !1), this.onCropResize(o), this.onResizeEnd && this.onResizeEnd(e, t)
        },
        onCropResize: function(e) {
            if (!this.cropmode && !this.in_constrained_crop_mode || this._modeTransition) return;
            let t = this.initialCrop,
                o, i = this.model.get("scale");
            i = this.getScaleBasedCurrentSizes({
                currentSizes: {
                    width: this.sizesBeforeCrop.width,
                    height: this.sizesBeforeCrop.height
                },
                cropH: this.cropBoxWithoutScaleBeforeCrop.cropH,
                cropW: this.cropBoxWithoutScaleBeforeCrop.cropW,
                overridedOriginalCrop: { ...this.originalCropBoxBeforeCrop
                }
            });
            let n = function(u) {
                return u / i
            };
            if (this.in_constrained_crop_mode) {
                let u = this.workspace.get_box_data();
                o = {
                    left: u.left_abs + e.left - t.left,
                    top: u.top_abs + e.top - t.top
                }
            } else o = {
                left: e.left - t.left,
                top: e.top - t.top
            };
            this.$picture.css({
                left: -o.left,
                top: -o.top
            });
            let s = Math.max(0, Math.round(n(o.left))),
                a = Math.max(0, Math.round(n(o.top))),
                l = this.fixCropDimensions(s, Math.round(n(e.width)), this.model.get("originalW")),
                c = this.fixCropDimensions(a, Math.round(n(e.height)), this.model.get("originalH")),
                d = {
                    cropX: s,
                    cropY: a,
                    cropW: l,
                    cropH: c
                },
                p = (e.width / e.height).toFixed(5),
                h = {
                    originalCropX: d.cropX,
                    originalCropY: d.cropY,
                    originalCropW: d.cropW,
                    originalCropH: d.cropH
                };
            this.model.set({
                scale: i,
                ...d,
                ...h,
                ratio: p
            })
        },
        showBackPic: function(e) {
            this.hideBackPic(), e = e || this.$picture, this.$backpic = e.clone().css({
                position: "absolute",
                opacity: .5,
                "z-index": (this.$content.css("z-index") || this.model.get("z")) - 1
            }).css(this.initialCrop).addClass("backpic").hide().appendTo(this.workspace.$origin).fadeIn(200), this.$backpic.on("dblclick", this.toggleCropMode)
        },
        hideBackPic: function() {
            this.workspace.$(".backpic").animate({
                opacity: 0
            }, 200, function() {
                (0, Go.default)(this).remove()
            })
        },
        bindPictureDrag: function() {
            this.$el.add(this.$backpic).on("dragend", this.dragCropPictureStop), this.$el.add(this.$backpic).on("dragstart", this.dragCropPictureStart), this.$el.add(this.$backpic).on("drag", this.dragCropPicture)
        },
        unbindPictureDrag: function() {
            this.$el.add(this.$backpic).off("dragend", this.dragCropPictureStop), this.$el.add(this.$backpic).off("dragstart", this.dragCropPictureStart), this.$el.add(this.$backpic).off("drag", this.dragCropPicture)
        },
        dragCropPictureStart: function(e, t) {
            let o = We.default.bind(this._css, this.$el),
                i = We.default.bind(this._css, this.$backpic);
            if (t.offset = {
                    back: {
                        top: i("top"),
                        left: i("left"),
                        width: i("width"),
                        height: i("height")
                    },
                    el: {
                        top: o("top"),
                        left: o("left"),
                        width: o("width"),
                        height: o("height")
                    }
                }, this.has_parent_block) {
                let n = this.workspace.get_box_data();
                t.offset.el.top += n.top_abs, t.offset.el.left += n.left_abs
            }
            this.frame.disableMouseProceeding(), this.$el.add(this.$backpic).addClass("grabbing")
        },
        dragCropPicture: function(e, t) {
            t.offset || this.dragCropPictureStart(e, t);
            let o = {
                top: t.offset.back.top + t.deltaY,
                left: t.offset.back.left + t.deltaX
            };
            o.top > t.offset.el.top && (o.top = t.offset.el.top), o.left > t.offset.el.left && (o.left = t.offset.el.left), o.left + t.offset.back.width < t.offset.el.left + t.offset.el.width && (o.left = t.offset.el.left + t.offset.el.width - t.offset.back.width), o.top + t.offset.back.height < t.offset.el.top + t.offset.el.height && (o.top = t.offset.el.top + t.offset.el.height - t.offset.back.height);
            let i = {
                    top: t.offset.el.top,
                    left: t.offset.el.left,
                    height: t.offset.el.height,
                    width: t.offset.el.width
                },
                n = {
                    height: t.offset.back.height,
                    width: t.offset.back.width
                },
                s = this.getScaleBasedCurrentSizes({
                    currentSizes: {
                        width: this.sizesBeforeCrop.width,
                        height: this.sizesBeforeCrop.height
                    },
                    cropH: this.cropBoxWithoutScaleBeforeCrop.cropH,
                    cropW: this.cropBoxWithoutScaleBeforeCrop.cropW,
                    overridedOriginalCrop: { ...this.originalCropBoxBeforeCrop
                    }
                }),
                a = Bt.center({
                    width: this.sizesBeforeCrop.width,
                    height: this.sizesBeforeCrop.height
                }, {
                    width: this.cropBoxWithoutScaleBeforeCrop.cropW * s,
                    height: this.cropBoxWithoutScaleBeforeCrop.cropH * s
                }),
                l = i.top - a.top,
                c = i.top + i.height + a.top,
                d = i.left - a.left,
                p = i.left + i.width + a.left;
            this.isFullWidth() && (o.top > l && (o.top = l), o.top + n.height < c && (o.top = c - n.height)), this.isFullHeight() && (o.left > d && (o.left = d), o.left + n.width < p && (o.left = p - n.width)), this.$backpic.css({
                top: o.top,
                left: o.left
            }), this.$picture.css({
                top: o.top - t.offset.el.top,
                left: o.left - t.offset.el.left
            })
        },
        dragCropPictureStop: function() {
            this.initialCrop = {
                top: parseInt(this.$backpic.css("top")),
                left: parseInt(this.$backpic.css("left"))
            }, this.frame.enableMouseProceeding(), this.frame.setConstraints(this.$backpic);
            let e = We.default.bind(this._css, this.$picture),
                t = parseFloat(this.model.get("scale"), 10);
            t = this.getScaleBasedCurrentSizes({
                currentSizes: {
                    width: this.sizesBeforeCrop.width,
                    height: this.sizesBeforeCrop.height
                },
                cropH: this.cropBoxWithoutScaleBeforeCrop.cropH,
                cropW: this.cropBoxWithoutScaleBeforeCrop.cropW,
                overridedOriginalCrop: { ...this.originalCropBoxBeforeCrop
                }
            });
            let o = {
                    left: -e("left"),
                    top: -e("top")
                },
                i = {
                    cropW: this.model.get("cropW"),
                    cropH: this.model.get("cropH")
                };
            if (this.isFullWidth() || this.isFullHeight()) {
                let u = Bt.center({
                    width: this.sizesBeforeCrop.width,
                    height: this.sizesBeforeCrop.height
                }, {
                    width: this.cropBoxWithoutScaleBeforeCrop.cropW * t,
                    height: this.cropBoxWithoutScaleBeforeCrop.cropH * t
                });
                o.left -= this.isFullHeight() ? u.left : 0, o.top -= this.isFullWidth() ? u.top : 0, i.cropW = this.isFullWidth() ? this.sizesBeforeCrop.width / t : i.cropW, i.cropH = this.isFullHeight() ? this.sizesBeforeCrop.height / t : i.cropH
            }
            let n = Math.max(0, Math.round(o.left / t)),
                s = Math.max(0, Math.round(o.top / t)),
                a = this.fixCropDimensions(n, i.cropW, this.model.get("originalW")),
                l = this.fixCropDimensions(s, i.cropH, this.model.get("originalH")),
                c = {
                    cropX: Math.round(n),
                    cropY: Math.round(s),
                    cropW: Math.round(a),
                    cropH: Math.round(l)
                },
                d = this.getSizesForDefaultZoom(),
                p = this.getScaleBasedCurrentSizes({
                    currentSizes: { ...d
                    },
                    cropH: this.cropBoxWithoutScaleBeforeCrop.cropH,
                    cropW: this.cropBoxWithoutScaleBeforeCrop.cropW,
                    overridedOriginalCrop: {
                        x: c.cropX,
                        y: c.cropY,
                        w: c.cropW,
                        h: c.cropH
                    }
                }),
                h = {
                    originalCropX: c.cropX,
                    originalCropY: c.cropY,
                    originalCropW: c.cropW,
                    originalCropH: c.cropH
                };
            this.model.set({
                scale: p,
                ...c,
                ...h
            }), this.$el.add(this.$backpic).removeClass("grabbing")
        },
        fixCropDimensions: function(e, t, o) {
            let i = e + t - o;
            return i > 0 ? t - i : t
        },
        setScale: function(e) {
            this.storeFixedPosition();
            let t = e || 1;
            this._preload(_i.url, We.default.bind(function(o) {
                let i = {
                        picture: this.model.get("picture")
                    },
                    n = {
                        x: parseInt(this.$el.css("left")) + this.model.get("w") / 2 - this.model.get("originalW") / 2 / t,
                        y: parseInt(this.$el.css("top")) + this.model.get("h") / 2 - this.model.get("originalH") / 2 / t,
                        w: this.model.get("originalW") / t,
                        h: this.model.get("originalH") / t
                    },
                    s = {
                        x: 0,
                        y: 0
                    };
                i.picture.finalUrl = this.model.get("picture").url, i.picture.final2xUrl = i.picture.finalUrl, i.picture.unscaledUrl = i.picture.finalUrl;
                let a = {};
                a.w = this.model.get("originalW"), a.h = this.model.get("originalH");
                let l = this.$picture.parent();
                this.updateSettings(o), o.css({
                    opacity: 0
                }).appendTo(l).animate({
                    opacity: 1
                }, 200, We.default.bind(function() {
                    this.$picture = o, l.children().not(":last").remove(), this.updateSettings()
                }, this)), this.$el.animate({
                    top: n.y,
                    left: n.x,
                    width: n.w,
                    height: n.h
                }, We.default.bind(function() {
                    this.model.set(We.default.extend({
                        cropX: s.x,
                        cropY: s.y,
                        cropW: n.w * t,
                        cropH: n.h * t,
                        scale: 1 / t,
                        ratio: n.w / n.h
                    }, n, i)), this.restoreFixedPosition(), this.model.save()
                }, this))
            }, this))
        },
        rescale: function(e, t) {
            t = t || {};
            let o = parseFloat(e);
            if (isNaN(o)) throw new Error(`Wrong scale: ${e}`);
            let i = We.default.bind(this._css, this.$el),
                n = t.smooth ? "animate" : "css",
                s = this.model.get("originalW") * o,
                a = this.model.get("originalH") * o;
            s < i("width") && (s = i("width"), o = s / this.model.get("originalW"), a = this.model.get("originalH") * o), a < i("height") && (a = i("height"), o = a / this.model.get("originalH"), s = this.model.get("originalW") * o);
            let l = i("width") / 2,
                c = i("height") / 2,
                d = this.model.get("scale");
            d = this.getScaleBasedCurrentSizes({
                currentSizes: {
                    width: this.model.get("w"),
                    height: this.model.get("h")
                },
                cropH: this.model.get("originalCropH") || this.model.get("originalH"),
                cropW: this.model.get("originalCropW") || this.model.get("originalW")
            });
            let p = (this.model.get("cropX") * d + l) * o / d - l,
                h = (this.model.get("cropY") * d + c) * o / d - c;
            p + 2 * l > s && (p = s - 2 * l), p < 0 && (p = 0), h + 2 * c > a && (h = a - 2 * c), h < 0 && (h = 0);
            let u, m;
            if (this.in_constrained_crop_mode) {
                let C = this.workspace.get_box_data();
                u = C.left_abs + i("left") - p, m = C.top_abs + i("top") - h
            } else u = i("left") - p, m = i("top") - h;
            this.$backpic[n]({
                left: u,
                top: m,
                width: s,
                height: a
            }), this.initialCrop = {
                left: u,
                top: m
            }, this.$picture[n]({
                left: -p,
                top: -h,
                width: s,
                height: a
            });
            let f = Math.max(0, Math.round(p / o)),
                g = Math.max(0, Math.round(h / o)),
                y = this.fixCropDimensions(f, Math.round(this.model.get("w") / o), this.model.get("originalW")),
                S = this.fixCropDimensions(g, Math.round(this.model.get("h") / o), this.model.get("originalH")),
                w = {
                    cropX: f,
                    cropY: g,
                    cropW: y,
                    cropH: S
                },
                v = {
                    originalCropW: w.cropW,
                    originalCropH: w.cropH,
                    originalCropX: w.cropX,
                    originalCropY: w.cropY
                };
            this.cropBoxWithoutScaleBeforeCrop = { ...w
            }, this.originalCropBoxBeforeCrop = {
                x: w.cropX,
                y: w.cropY,
                h: w.cropH,
                w: w.cropW
            }, this.sizesBeforeCrop = {
                width: this.model.get("w"),
                height: this.model.get("h")
            }, this.model.set({ ...v,
                ...w,
                scale: o
            }, t), this.frame.setConstraints(this.$backpic)
        },
        fill: function() {
            if (!this.cropmode || this._modeTransition) return;
            let e = parseInt(this.$el.css("left")),
                t = parseInt(this.$el.css("top")),
                o = parseInt(this.$el.height()),
                i = parseInt(this.$el.width()),
                n = {},
                s = null,
                a = {},
                l = this.model.get("originalW") / this.model.get("originalH");
            this.model.get("ratio") > l ? (s = i / this.model.get("originalW"), n = {
                cropX: 0,
                cropY: Math.round((this.model.get("originalH") - o / s) / 2),
                cropW: this.model.get("originalW"),
                cropH: Math.round(o / s)
            }, a = {
                width: i,
                height: Math.round(i / l),
                top: -Math.round(n.cropY * s),
                left: 0
            }) : (s = o / this.model.get("originalH"), n = {
                cropX: Math.round((this.model.get("originalW") - i / s) / 2),
                cropY: 0,
                cropW: Math.round(i / s),
                cropH: this.model.get("originalH")
            }, a = {
                width: Math.round(o * l),
                height: o,
                top: 0,
                left: -Math.round(n.cropX * s)
            });
            let c = {
                    x: e,
                    y: t,
                    w: i,
                    h: o,
                    scale: s
                },
                d = {
                    originalCropW: n.cropW,
                    originalCropH: n.cropH,
                    originalCropX: n.cropX,
                    originalCropY: n.cropY
                };
            this.model.set(We.default.extend(c, n, d)), this.redrawPosition(this.model, {
                forceRedraw: !1
            }), this.$picture.animate(a), this.$backpic.animate({
                width: a.width,
                height: a.height,
                top: t + a.top,
                left: e + a.left
            }, We.default.bind(function() {
                let p = We.default.bind(this._css, this.$backpic);
                this.initialCrop = {
                    top: p("top"),
                    left: p("left")
                }, this.frame.setConstraints(this.$backpic)
            }, this))
        },
        fit: function() {
            if (!this.cropmode || this._modeTransition) return;
            let e = parseInt(this.$el.css("left")),
                t = parseInt(this.$el.css("top")),
                o = parseInt(this.$el.height()),
                i = parseInt(this.$el.width()),
                n = {
                    cropX: 0,
                    cropY: 0,
                    cropW: this.model.get("originalW"),
                    cropH: this.model.get("originalH")
                },
                s = {
                    left: e,
                    top: t,
                    width: i,
                    height: o
                },
                a = null,
                l = {},
                c = this.model.get("originalW") / this.model.get("originalH");
            this.model.get("ratio") < c ? (a = i / this.model.get("originalW"), l = {
                width: i,
                height: Math.round(i / c),
                top: Math.round((o - i / c) / 2),
                left: 0
            }, s.top = t + l.top, s.height = l.height) : (a = o / this.model.get("originalH"), l = {
                width: Math.round(o * c),
                height: o,
                top: 0,
                left: Math.round((i - o * c) / 2)
            }, s.left = e + l.left, s.width = l.width), this.$picture.animate(l), this.$backpic.animate({
                width: l.width,
                height: l.height,
                top: t + l.top,
                left: e + l.left
            }, We.default.bind(function() {
                let d = We.default.bind(this._css, this.$backpic);
                this.initialCrop = {
                    top: d("top"),
                    left: d("left")
                }, this.$el.css(s), this.$picture.css({
                    top: 0,
                    left: 0
                });
                let p = {
                        x: s.left,
                        y: s.top,
                        w: s.width,
                        h: s.height,
                        ratio: c,
                        scale: a
                    },
                    h = {
                        originalCropW: n.cropW,
                        originalCropH: n.cropH,
                        originalCropX: n.cropX,
                        originalCropY: n.cropY
                    };
                this.model.set(We.default.extend(p, n, h)), this.frame.setConstraints(this.$backpic)
            }, this))
        },
        setControls: function() {
            this.isVector() ? this.controls = this.vector_controls : this.isAnimated() ? this.controls = this.animated_controls : this.controls = this.initial_controls, this.controlsDividers = this.isPictureEmpty() ? this.initialControlsDividers : this.loadedControlsDividers
        },
        changePicWithoutRescale: function(e, t = {}) {
            let o = [],
                i = {
                    originalW: e.size.width,
                    originalH: e.size.height
                };
            if (e.picture && (i.picture = e.picture), this.model.set(i, {
                    silent: !0
                }), this.trigger("picture_added"), t.first = !0, this.fixSize(t), We.default.each(Oe.viewport_list, function(n) {
                    We.default.isEmpty(this.model.get(n)) && We.default.isEmpty(this.model[n]) || (this.model.set(i, {
                        viewport: n.split("viewport_")[1],
                        silent: !0
                    }), o.push(n))
                }, this), this.has_parent_block) {
                this.model.save();
                let n = {};
                n.tip_w = this.workspace.block.model.get("tip_w"), n.tip_h = this.workspace.block.model.get("tip_h"), this.workspace.block.model.save(n, {
                    patch: !0,
                    skipHistory: !0
                }), this.workspace.blocks.forEach(function(s) {
                    s.saveBox({
                        patch: !0,
                        skipHistory: !0
                    })
                })
            }
            this.checkLambdaUrlSetCorrectly({
                func: "changePicWithoutRescale",
                allViewports: Oe.viewport_list,
                updatedViewports: o
            })
        },
        setTempPicture: function(e, t = {}) {
            this.$el.removeClass("hidden");
            let o = this.$el.find(".content");
            if (!(!e || !e.content || !o)) {
                if (this.$el.removeClass("empty"), this.tempPicture = {
                        $el: (0, Go.default)("<div>").css({
                            "background-image": `url("${e.content}")`,
                            "background-position": "50% 50%",
                            ...t.withoutResize ? {
                                "background-size": "cover"
                            } : {}
                        }).appendTo(o),
                        type: e.ext
                    }, this.model.get("picture") && (o.children().not(":last").remove(), this.$picture && this.$picture.remove(), this.$picture = null, this.model.unset("picture", {
                        skipHistory: !0,
                        silent: !0
                    })), !t.withoutResize) {
                    let i = {
                        size: {
                            width: e.width,
                            height: e.height
                        }
                    };
                    this.changePicWithoutRescale(i)
                }
                this.showTempPreloader(), this.changeControls()
            }
        },
        unsetTempPicture: function() {
            this.tempPicture && this.tempPicture.$el && this.tempPicture.$el.remove(), this.tempPicture = null
        },
        removeTempPicture: function() {
            this.unsetTempPicture(), this.$picture && this.$picture.remove(), this.$content.children().remove(), this.$el.addClass("empty"), this.$el.removeClass("hidden"), this.hideTempPreloader(), this.removePicture(), this.changeControls()
        },
        onChangeViewport: function(e) {
            let t = e.get("viewport");
            this.has_parent_block && (this.preloader_is_activated[t] ? this.showTempPreloader(t) : this.preloader_is_activated[t] || this.hideTempPreloader())
        },
        updatePreloaderState: function({
            value: e,
            viewport: t = null,
            updateAllViewports: o = !1
        }) {
            let i = this.workspace.page.getCurrentViewport(),
                n = t || i;
            o ? (this.preloader_is_activated.default = e, this.preloader_is_activated.tablet_portrait = e, this.preloader_is_activated.phone_portrait = e) : this.preloader_is_activated[n] = e
        },
        showTempPreloader: function(e) {
            let t = () => {
                this.$preloader || (this.$preloader = (0, Go.default)("<div/>", {
                    class: "rmpreloader",
                    html: (0, Go.default)("<div/>", {
                        class: "arc"
                    })
                }), this.$el.addClass("preloader"), this.$preloader.appendTo(this.$el))
            };
            if (this.has_parent_block) {
                let o = this.workspace.page.getCurrentViewport();
                if (this.preloader_is_activated[o]) {
                    let i = e || o,
                        n = this.model[`viewport_${i}`];
                    t(), this.$preloader.css({
                        top: (n ? .h || this.model.get("h")) / 2 + "px"
                    })
                }
            } else t()
        },
        hideTempPreloader: function() {
            if (!this.$preloader || this.preloaderTimeout) return;
            let e = () => {
                this.$el.removeClass("preloader"), this.$preloader.css("opacity", 0), this.preloaderTimeout = setTimeout(function() {
                    this.$preloader.remove(), this.$preloader = null, this.preloaderTimeout = null
                }.bind(this), 200)
            };
            if (this.has_parent_block) {
                let t = this.workspace.page.getCurrentViewport();
                this.preloader_is_activated[t] || e()
            } else e()
        },
        generatePreviewHash: async function(e) {
            try {
                let t = await ii.encodeBlurHash(e);
                this.model.set({
                    blurHash: t
                }, {
                    silent: !0,
                    skipHistory: !0
                })
            } catch (t) {
                console.error("Cannot create blurhash", t)
            }
        },
        changePicture: function(e, t) {
            let o = this.model.attributes,
                i = this.model.getViewport(),
                n = this.isFullWidth(),
                s = this.isFullHeight();
            if (t = We.default.extend(t || {}, {
                    isNew: !0
                }), this.generatePreviewHash(e.picture.url), e.picture && (this.has_parent_block || this.hideTempPreloader()), !o.picture && !o.scale) return this.changePicWithoutRescale(e, t);
            let a = this,
                l = function(d) {
                    d.ratio = d.ratio || d.w / d.h;
                    let p, h, u;
                    if (n ? (p = a.getFullWidthDims().w, h = d.h) : s ? (h = a.getFullHeightDims().h, p = d.w) : (p = d.w, h = d.h), u = {
                            originalW: e.size.width,
                            originalH: e.size.height,
                            w: p,
                            h,
                            ratio: d.ratio,
                            x: d.x,
                            y: d.y
                        }, e.size.width / e.size.height > parseFloat(d.ratio))
                        if (n || s) {
                            let m = a.getSizesForDefaultZoom();
                            u.scale = m.height / u.originalH;
                            let f = Rc({
                                currentSizes: {
                                    width: m.width,
                                    height: m.height
                                },
                                scale: u.scale,
                                originalCrop: {
                                    x: 0,
                                    y: 0,
                                    w: u.originalW,
                                    h: u.originalH
                                }
                            });
                            u = { ...u,
                                ...f
                            }
                        } else u.scale = u.h / u.originalH, u.cropY = 0, u.cropH = u.originalH, u.cropX = Math.max(0, (u.originalW - u.w / u.scale) / 2), u.cropW = u.w / u.scale;
                    else if (e.size.width / e.size.height < parseFloat(d.ratio))
                        if (n || s) {
                            let m = a.getSizesForDefaultZoom();
                            u.scale = s ? m.height / u.originalH : m.width / u.originalW;
                            let f = Rc({
                                currentSizes: {
                                    width: m.width,
                                    height: m.height
                                },
                                scale: u.scale,
                                originalCrop: {
                                    x: 0,
                                    y: 0,
                                    w: u.originalW,
                                    h: u.originalH
                                }
                            });
                            u = { ...u,
                                ...f
                            }
                        } else u.scale = u.w / u.originalW, u.cropX = 0, u.cropY = Math.max(0, (u.originalH - u.h / u.scale) / 2), u.cropW = u.originalW, u.cropH = u.h / u.scale;
                    else u.scale = u.w / u.originalW, u.cropX = 0, u.cropY = 0, u.cropW = u.originalW, u.cropH = u.originalH;
                    return u.picture = We.default.clone(e.picture), u.originalCropW = u.cropW, u.originalCropH = u.cropH, u.originalCropX = u.cropX, u.originalCropY = u.cropY, a.isVector(e.picture.url, e.picture.type) || (u.picture.unscaledUrl = e.picture.coalesceUrl || e.picture.url), u
                },
                c = l(o);
            if (this.model.set(c, {
                    silent: !(this.isFullHeight() || this.isFullWidth()),
                    toHistory: t.toHistory
                }), this.isVector(c.picture.url, c.picture.type) && (this.model.set({
                    pic_color: "",
                    pic_opacity: 1
                }, {
                    silent: !0
                }), this.fixSize()), this.isAnimated()) {
                let d = [...Oe.viewport_list, "viewport_default"],
                    p = this ? .workspace ? .page ? .getCurrentViewport(),
                    h = this.model;
                for (let u of d) {
                    let m = u.split("viewport_")[1];
                    m !== p && h[u] && (h[u] && !h[u].picture || this.model.set({
                        picture: c.picture
                    }, {
                        viewport: m,
                        silent: !0
                    }))
                }
                this.changeControls(), this.model.save({}, t), this.model.trigger("change:picture", this.model, c.picture)
            } else t.viewport = i, this.has_parent_block ? We.default.each(["default", "tablet_portrait", "phone_portrait"], function(d) {
                if (d !== "default" && We.default.isEmpty(this.model.get(`viewport_${d}`)) && We.default.isEmpty(this.model[`viewport_${d}`])) return;
                let p = this.model[`viewport_${d}`],
                    h = `${p.w}:${p.h}!${p.w>p.h?"h":"v"}`,
                    {
                        cropX: u,
                        cropY: m,
                        cropW: f,
                        cropH: g
                    } = $m(c.originalW, c.originalH, h),
                    y = {};
                y.cropH = g, y.cropW = f, y.cropX = u, y.cropY = m, y.originalW = c.originalW, y.originalH = c.originalH, y.originalCropW = y.cropW, y.originalCropH = y.cropH, y.originalCropX = y.cropX, y.originalCropY = y.cropY;
                let S = {
                    picture: { ...c.picture
                    },
                    w: p.w,
                    h: p.h,
                    originalW: y.originalW,
                    originalH: y.originalH,
                    cropX: y.cropX,
                    cropY: y.cropY,
                    cropW: y.cropW,
                    cropH: y.cropH
                };
                this.model.set({
                    picture: c.picture,
                    ...y
                }, {
                    viewport: d,
                    silent: !0
                }), this.updatePreloaderState({
                    value: !0,
                    viewport: d
                }), this.showTempPreloader(), this._requestFinalImage[d] && this._requestFinalImage[d] ? .abort(), this._requestFinalImage[d] = this.requestFinalImage(We.default.extend({}, this.model.attributes, S), We.default.bind(function(w) {
                    let v = { ...c.picture,
                        ...w
                    };
                    this.model.set({
                        picture: v
                    }, {
                        viewport: d,
                        silent: !0
                    }), this.model.save({}, {
                        skipHistory: !0,
                        first: !0,
                        silent: !0
                    }), this.updatePreloaderState({
                        value: !1,
                        viewport: d
                    }), this.hideTempPreloader(d)
                }, this))
            }, this) : this.getFinalImage(We.default.bind(function() {
                this.isVector(c.picture.url, c.picture.type) || this.updatePicture.apply(this, arguments);
                let d = [],
                    p = !1,
                    h = this.model,
                    u = function(f) {
                        d[f] = !0, We.default.all(d) && p && (h.save({}, {
                            skipHistory: !0,
                            first: !0
                        }), this.model.getViewport() !== i && !this.isVector(c.picture.url, c.picture.type) && this.updatePicture())
                    }.bind(this),
                    m = We.default.without(We.default.union(zp.viewports, ["viewport_default"]), "viewport_" + this.model.getViewport());
                We.default.each(m, (f, g) => d[g] = !1), We.default.each(m, function(f, g) {
                    if (d[g] = !1, We.default.isEmpty(this.model[f])) return u(g);
                    let y = l(We.default.extend({}, this.model.attributes, this.model[f]));
                    if (this.useLambdaUrl() || this.isVector(c.picture.url, c.picture.type)) {
                        if (f !== "viewport_default" && this.model.getViewport() === "default") {
                            let S = this.model.get("picture");
                            S && We.default.extend(y.picture, S)
                        }
                        this.model.set(y, {
                            viewport: f.split("viewport_")[1],
                            silent: !0
                        }), p = !0, u(g)
                    } else this.requestFinalImage(We.default.extend({}, this.model.attributes, y), We.default.bind(function(S) {
                        We.default.extend(y.picture, S), this.model.set(y, {
                            viewport: f.split("viewport_")[1],
                            silent: !0
                        }), p = !0, u(g)
                    }, this))
                }, this), this.checkLambdaUrlSetCorrectly({
                    func: "getFinalImage",
                    allViewports: m,
                    updatedViewports: d
                })
            }, this), t), this.model.trigger("change:picture", this.model, c.picture), this.workspace.trigger("redraw")
        },
        redraw: function(e, t) {
            if (t = t || {}, !this.checkNeedRedraw(e, t)) return;
            let o = e.hasChanged("is_full_width") && e.get("is_full_width") && !t.viewportChange,
                i = e.hasChanged("is_full_width") && !e.get("is_full_width") && !t.viewportChange,
                n = e.hasChanged("is_full_height") && e.get("is_full_height") && !t.viewportChange,
                s = e.hasChanged("is_full_height") && !e.get("is_full_height") && !t.viewportChange,
                a = function() {
                    if (i || o || s || n) {
                        let h = (this ? .workspace ? .page ? .getCurrentViewport() || "default") === "default";
                        this.migrateCropParamsToOriginalCropParams({
                            ignoreFhFwCheck: !0
                        }), h && this.unsetFwFhPositions(), this.updateWidgetVersion()
                    }
                    let l = this.getOriginalCrop(),
                        c = this.getSizesForDefaultZoom(),
                        d = {
                            w: this.model.get("w"),
                            h: this.model.get("h"),
                            scale: this.model.get("scale") || this.model.get("w") / this.model.get("originalW"),
                            ratio: this.model.get("ratio") || this.model.get("w") / this.model.get("h"),
                            cropY: this.model.get("cropY"),
                            cropX: this.model.get("cropX"),
                            cropH: this.model.get("cropH"),
                            cropW: this.model.get("cropW")
                        };
                    if ([d.cropH, d.cropW, d.cropX, d.cropY].includes(void 0)) return;
                    (i || o) && (i ? d.ratio = d.w / d.h : o && (d.w = c.width)), (s || n) && (s ? d.ratio = d.w / d.h : n && (d.h = c.height)), d.scale = this.getScaleBasedCurrentSizes({
                        currentSizes: {
                            width: c.width,
                            height: c.height
                        },
                        cropH: l.h,
                        cropW: l.w
                    });
                    let p = Rc({
                        currentSizes: {
                            width: c.width,
                            height: c.height
                        },
                        scale: d.scale,
                        originalCrop: l
                    });
                    We.default.extend(d, p), this.ratio = d.ratio, this.model.set({ ...d
                    }, {
                        silent: !0
                    })
                }.bind(this);
            !this.isDragging && !this.isScaling && (this.redrawPosition(e, We.default.extend(t, {
                forceRedraw: !1
            })), (o || i || n || s) && (a(), this.updatePicture(), this.changeControls()), i || s ? this.useLambdaUrl() ? this.setScaledImage(null, {
                skipHistory: !0
            }) : this.getFinalImage(null, {
                silent: !0,
                skipHistory: !0
            }) : (o || n) && (this.useLambdaUrl() || this.getFinalImage(null, {
                silent: !0,
                skipHistory: !0
            }))), e.hasChanged("picture") || e.hasChanged("cropX") || e.hasChanged("cropY") || e.hasChanged("cropW") || e.hasChanged("cropH") ? t.undo || t.redo ? this.onHistoryPictureChange(e, t) : t.viewportChange || Xt.isIncomingUpdate(t) ? (this.hideBackPic(), this.updatePicture({
                skipAnimation: !0,
                viewportChange: !0,
                complete: this.onLeavingCropMode
            })) : (this.updatePicture({
                skipAnimation: !0,
                viewportChange: !0,
                complete: this.onLeavingCropMode
            }), this.onPictureChange(e, t), this.isVector() && this.initVector()) : this.has_parent_block && (t.undo || t.redo) ? (this.in_constrained_crop_mode = !1, this.enter_constrained_crop_mode()) : t.viewportChange && this.useLambdaUrl() && this.updatePicture({
                skipAnimation: !0,
                viewportChange: !0
            }), this.ratio = e.get("ratio")
        },
        redrawPosition: function(e) {
            e = e || this.model, ma.prototype.redrawPosition.apply(this, arguments), (e.hasChanged("border_size") || e.hasChanged("border_color") || e.hasChanged("border_color_opacity") || e.hasChanged("border_radius") || e.hasChanged("border_radius_max") || e.hasChanged("border_radius_tl") || e.hasChanged("border_radius_tr") || e.hasChanged("border_radius_bl") || e.hasChanged("border_radius_br") || e.hasChanged("border_radius_independent") || e.hasChanged("opacity") || e.hasChanged("fwpos") || e.hasChanged("fhpos") || e.hasChanged("pic_color") || e.hasChanged("pic_opacity")) && this.updateSettings()
        },
        setPreviewImage: function(e, t) {
            t = t || {};
            let o = t.success || Go.default.noop,
                i = t.error || Go.default.noop,
                n = this;
            if (this.previewUrl = e, this._loadingPic && this._loadingPic.off("load").off("error").removeAttr("src").remove(), this._loadingPic = void 0, !e) {
                this.$preview && this.$preview.detach(), o();
                return
            }
            this._loadingPic = (0, Go.default)("<img>").addClass("preload_image").appendTo("body").attr("src", e).on("load", function() {
                n.previewUrl === e && (n.$preview || (n.$preview = (0, Go.default)("<div>")), n.$preview.css({
                    "background-image": 'url("' + e + '")',
                    "background-size": "cover",
                    "background-position": "50% 50%"
                }).appendTo(n.$el.find(".content"))), o(), (0, Go.default)(this).remove()
            }).on("error", function() {
                i(), (0, Go.default)(this).remove()
            })
        },
        getBorderRadius: function() {
            return this.model.get("border_radius_independent") ? `${this.model.get("border_radius_tl")||0}px ${this.model.get("border_radius_tr")||0}px ${this.model.get("border_radius_br")||0}px ${this.model.get("border_radius_bl")||0}px` : `${this.model.get("border_radius_max")?"9999":this.model.get("border_radius")||0}px`
        },
        updateSettings: function(e) {
            let t = (this ? .workspace ? .page ? .getCurrentViewport() || "default") === "default";
            if (e = e || this.$picture, !e) return;
            let o = this.model,
                i = o.get("fwpos"),
                n = o.get("fhpos");
            if (i = !t || i === void 0 ? 50 : i, n = !t || n === void 0 ? 50 : n, this.isVector()) e.css({
                "box-shadow": "none",
                "border-radius": "0"
            }), this.$content.css("opacity", 1);
            else {
                let s = o.get("border_color_opacity"),
                    a = Qm(o.get("border_color") || "000000", typeof s > "u" ? 1 : s / 100),
                    l = `rgba(${a.r}, ${a.g}, ${a.b}, ${a.a})`,
                    c = o.get("border_size");
                e.css({
                    "border-radius": this.getBorderRadius(),
                    "background-position": n + "% " + i + "%",
                    "-webkit-mask-image": c > 0 ? "url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)" : ""
                }), this.isPictureResizing && this.$borderContainerDuringResize ? e.css({
                    "box-shadow": ""
                }) : e.css({
                    "box-shadow": c > 0 ? `inset 0 0 0 ${c}px ${l}` : "none"
                }), this.$content.css("opacity", typeof o.get("opacity") > "u" ? 1 : o.get("opacity"))
            }
        },
        onPictureChange: function(e, t) {
            let o = this.model.previous("picture"),
                i = this.model.get("picture"),
                n = t && t.isNew;
            (!i || !o || i.url == o.url) && !n || this.model.set({
                pic_color: "",
                pic_opacity: 1
            }, {
                silent: !0
            })
        },
        onHistoryPictureChange: function() {
            let e = {},
                t = this.model.previous("picture"),
                o = this.model.get("picture");
            if (!o) return this.updatePicture();
            !t && o && this.trigger("picture_added"), this._modeTransition && !this.cropmode && (e.complete = this.onLeavingCropMode), this.has_parent_block ? (this.in_constrained_crop_mode = !1, this.enter_constrained_crop_mode()) : this.useLambdaUrl() ? this.updatePicture(e) : (this._getFinalRequest && this._getFinalRequest.abort, this.getFinalImageAfterResize())
        },
        setFinal: function() {
            this.fakingMode = !1, this.getFinalImage(this.updatePicture, {
                silent: !0
            })
        },
        changeControls: function({
            viewportChange: e,
            noSelect: t
        } = {}) {
            this.setControls(), this.updateControls({
                noSelect: t || e || this._deselectOnViewportChange
            }), this._deselectOnViewportChange = !1
        },
        _preload: function(e, t) {
            let o = this.model.get("picture");
            if (!o) return;
            let i = this,
                n;
            if (this.useLambdaUrl() ? n = i.cropmode || i.in_constrained_crop_mode || i.fwposmode ? this.getOriginalLambdaUrl() : this.getLambdaUrl() : (n = _i.lambdaUrlForOldWidget === e ? this.getLambdaUrl() : o[e], !n && e === _i.unscaledUrl && (n = o[_i.unscaledOptimizedUrl] || o[_i.url])), !n) return t && t.apply(this);
            if (this.isVector()) return this.loadVectorDebounced({
                success: t
            });
            this._actualPreload[e] = n, this._imgsPreload[e] = (0, Go.default)(new Image).attr({
                src: n
            }).one("load", function() {
                if (i._imgsPreload[e] = !1, t) {
                    let s = (0, Go.default)("<div/>").css("background-image", "url(" + n + ")");
                    if (s.css("background-size", "cover"), !i.rendered) return;
                    t.apply(i, [s, n])
                }(0, Go.default)(this).remove()
            })
        },
        updateWidgetVersion: function() {
            if (this.model.get("version") !== 2) {
                let t = this.getWidgetVersionBasedOnDataFields();
                t !== void 0 && this.model.set({
                    version: t
                }, {
                    silent: !0,
                    skipHistory: !0,
                    toHistory: !1
                })
            }
        },
        migrateCropParamsToOriginalCropParams: function({
            ignoreFhFwCheck: e
        } = {}) {
            let t = this.workspace.page.getCurrentViewport(),
                o = t === "default" ? ["default", "tablet_portrait", "phone_portrait"] : [t];
            this.isOriginalCropExist() || this.model.get("version") !== 2 && o.forEach(s => {
                let a = this.model,
                    l = `viewport_${s}`;
                if (a[l]) {
                    let c = a[l],
                        d = ![c.originalCropH, c.originalCropW, c.originalCropX, c.originalCropY].includes(void 0),
                        p = c.is_full_height,
                        h = c.is_full_width;
                    if (!e && (p || h) || d) return;
                    this.model.set({
                        originalCropX: c.cropX,
                        originalCropY: c.cropY,
                        originalCropW: c.cropW,
                        originalCropH: c.cropH
                    }, {
                        silent: !0,
                        toHistory: !1,
                        skipHistory: !0,
                        viewport: s
                    })
                }
            })
        },
        unsetFwFhPositions: function() {
            if (this.model.get("version") === 2) return;
            let t = this.model["viewport_default"];
            t && (t.fwpos !== void 0 && this.model.unset("fwpos", {
                skipHistory: !0,
                toHistory: !1,
                silent: !0
            }), t.fhpos !== void 0 && this.model.unset("fhpos", {
                skipHistory: !0,
                toHistory: !1,
                silent: !0
            }))
        },
        migrateFWPosToCropParams: function() {
            let e = this.model.get("version"),
                t = this.isOriginalCropExist();
            if (!(this.workspace.page.getCurrentViewport() === "default") || e === 2 || t) return;
            let i = this.model.get("fwpos") === void 0 ? 50 : this.model.get("fwpos"),
                n = this.model.get("fhpos") === void 0 ? 50 : this.model.get("fhpos");
            this.migrateCropParamsToOriginalCropParams();
            let s = this.getSizesForDefaultZoom(),
                a = this.getCrop(),
                l = this.getScaleBasedCurrentSizes({
                    currentSizes: { ...s
                    },
                    cropW: a.cropW,
                    cropH: a.cropH
                }),
                c = TW({
                    currentSizes: { ...s
                    },
                    scale: l,
                    initialCrop: a,
                    fwpos: i,
                    fhpos: n
                });
            this.unsetFwFhPositions(), this.model.set({ ...c,
                scale: l
            }, {
                silent: !0,
                toHistory: !1,
                skipHistory: !0
            }), this.updatePicture()
        },
        setContentBorderRadius: function() {
            this.$content && this.$picture && this.$content.css({
                "border-radius": this.$picture.css("border-radius"),
                "mask-image": this.$picture.css("mask-image")
            })
        },
        resetContentBorderRadius: function() {
            this.$content && this.$content.css({
                "border-radius": "",
                "mask-image": ""
            })
        },
        createBorderContainerDurngResize: function() {
            if (!this.isVector() && this.$content) {
                if (this.$borderContainerDuringResize) return;
                let e = this.model.get("border_size");
                e && e > 0 && (this.$borderContainerDuringResize = (0, Go.default)('<div class="tempBorderContainer"/>').css({
                    "border-radius": this.$picture.css("border-radius"),
                    "mask-image": this.$picture.css("mask-image"),
                    "box-sizing": "border-box",
                    "z-index": 1,
                    "box-shadow": this.$picture.css("box-shadow"),
                    position: "absolute",
                    top: "0",
                    left: "0"
                }), this.$picture.css({
                    "box-shadow": ""
                }), this.$picture.before(this.$borderContainerDuringResize))
            }
        },
        deleteBorderContainerDurngResize: function() {
            this.$borderContainerDuringResize && (this.$borderContainerDuringResize.remove(), this.$borderContainerDuringResize = null)
        },
        resetBorderStyles: function() {
            this.deleteBorderContainerDurngResize(), this.resetContentBorderRadius(), this.updateSettings()
        },
        onResizeStart: function(e, t) {
            this.cropmode || this.isVector() || (this._scaledimageXHR && this._scaledimageXHR.abort(), this._modeTransition || (this._getFinalRequest && this._getFinalRequest.abort(), this.setContentBorderRadius(), this.createBorderContainerDurngResize(), !this.isPictureResizing && !this.isAnimated() && (this.isFullWidth() || this.isFullHeight() ? this.migrateFWPosToCropParams() : this.migrateCropParamsToOriginalCropParams(), this.updateWidgetVersion()), this.setIsPictureResizing(!0)), this.isScaling = !0)
        },
        onResizeEnd: function(e, t, o) {
            this.isScaling = !1;
            let i = null,
                n = this.getBoxData();
            if (i = We.default.extend(this.isVector() ? {
                    ratio: n.w / n.h
                } : {}, n), this.model.set(i, o), this.getPictureUrl() || this.setIsPictureResizing(!1), !this.getPictureUrl() || this.isVector() || this.isAnimated()) return this.saveBoxDebounced();
            if (!this.cropmode)
                if (this._modeTransition) this._waitingForRescale = !0;
                else {
                    let s = We.default.bind(this._css, this.$picture),
                        a = {
                            left: s("left"),
                            top: s("top")
                        };
                    this.useLambdaUrl() && this.setIsPictureResizingDebounced(!1), this.saveCurrentPositionAsCropParamsDebounced(a, We.default.omit(o, "skipPersist"))
                }
        },
        saveCurrentPositionAsCropParams: function(e, t) {
            let o = this.useLambdaUrl(),
                i = this.getSizesForDefaultZoom(),
                n = this.getOriginalCrop(),
                s = this.getScaleBasedCurrentSizes({
                    currentSizes: i,
                    cropH: n.h,
                    cropW: n.w
                }),
                a = Number((i.width / i.height).toFixed(5));
            this.ratio = a;
            let l = Rc({
                scale: s,
                currentSizes: i,
                originalCrop: n
            });
            this ? .workspace ? .page ? .getCurrentViewport() === "default" && this.unsetFwFhPositions(), this.model.set({ ...l,
                ratio: a,
                scale: s
            }, {
                silent: !0,
                skipHistory: !0
            }), this.model.save(null, {
                skipHistory: t.isGroupResize
            }), o ? (this._scaledimageXHR && this._scaledimageXHR.abort(), this.setScaledImage(null, {
                silent: !0,
                skipHistory: !0
            })) : (this._getFinalRequest && this._getFinalRequest.abort(), this.getFinalImageAfterResize())
        },
        getFinalImageAfterResize: function() {
            this.getFinalImage((e, t) => {
                !e && t !== "abort" ? this.updatePicture({
                    prepare: o => {
                        this.updateSettings(o)
                    },
                    complete: () => {
                        this.deleteBorderContainerDurngResize(), this.resetContentBorderRadius(), this.setIsPictureResizingDebounced(!1)
                    }
                }) : this.setIsPictureResizingDebounced(!1)
            }, {
                silent: !0,
                skipHistory: !0
            })
        },
        restoreFixedPosition: function(e) {
            !e && this.cropmode || ma.prototype.restoreFixedPosition.apply(this, arguments)
        },
        getBoxData: function() {
            let e = ma.prototype.getBoxData.apply(this, arguments);
            return this.getPictureUrl() || (e.scale = 1.toFixed(5)), e
        },
        setScaledImage: function(e, t = {}) {
            let o = We.default.clone(this.model.attributes),
                i = function(s) {
                    if (this.model.getViewport() === "default" || !We.default.isEmpty(this.model.viewport_default.picture)) return;
                    let a = ["cropW", "cropH", "cropX", "cropY", "originalW", "originalH", "ratio", "scale", "w", "h"],
                        l = rt(We.default.extend({}, We.default.pick(this.model.attributes, a), {
                            picture: s
                        }));
                    this.model.clone({
                        viewport: "default"
                    }).set(l)
                }.bind(this);
            if (this.tempPicture && !this.model.get("picture")) return;
            if (t.viewport = this.model.getViewport(), this.isVector() || this.isAnimated() || this.useLambdaUrl()) return i(o.picture), this.model.save("picture", o.picture, t), this.has_parent_block && (this.updatePreloaderState({
                value: !1,
                updateAllViewports: !0
            }), this.hideTempPreloader()), this.updatePicture({
                complete: e
            });
            let n = this.model.get("w");
            this.has_parent_block && this.updatePreloaderState({
                value: !0,
                updateAllViewports: !0
            }), this.showTempPreloader(), this._scaledimageXHR = Go.default.ajax({
                type: "POST",
                data: o,
                url: this.RESCALE_URL,
                success: We.default.bind(function(s) {
                    if (this.has_parent_block && this.updatePreloaderState({
                            value: !1,
                            updateAllViewports: !0
                        }), this.hideTempPreloader(), n !== this.model.get("w")) return;
                    let a = We.default.extend({}, this.model.get("picture"), s);
                    a.url && (i(a), this.model.save("picture", a, t), this.updatePicture({
                        complete: e
                    }))
                }, this)
            })
        },
        fixSize: function(e) {
            if (!this.model.get("originalW")) return;
            let t = parseInt(this.model.get("originalW"), 10),
                o = parseInt(this.model.get("originalH"), 10),
                i = this.model.get("w"),
                n = this.model.get("h"),
                s = i / t,
                a = n / o,
                l = i,
                c = n,
                d = {
                    x: this.model.get("x"),
                    y: this.model.get("y")
                },
                p = {
                    cropX: 0,
                    cropY: 0,
                    cropW: t,
                    cropH: o
                };
            if (this.has_parent_block) c = o * s;
            else if (this.isVector() && this.isFullWidth()) l = this.getFullWidthDims().w;
            else if (this.isVector() && this.isFullHeight()) c = this.getFullHeightDims().h;
            else if (!this.isVector() && this.isFullWidth()) {
                let u = this.getSizesForDefaultZoom(),
                    m = Number((u.width / t).toFixed(5));
                l = this.getFullWidthDims().w, o < c && (c = o, d.y += n / 2 - o / 2), p = Rc({
                    currentSizes: {
                        width: u.width,
                        height: c
                    },
                    scale: m,
                    originalCrop: {
                        x: p.cropX,
                        y: p.cropY,
                        h: p.cropH,
                        w: p.cropW
                    }
                })
            } else if (!this.isVector() && this.isFullHeight()) {
                let u = this.getSizesForDefaultZoom(),
                    m = Number((u.height / o).toFixed(5));
                c = this.getFullHeightDims().h, o < c && (l = t, d.x += i / 2 - t / 2), p = Rc({
                    currentSizes: {
                        width: l,
                        height: u.height
                    },
                    scale: m,
                    originalCrop: {
                        x: p.cropX,
                        y: p.cropY,
                        h: p.cropH,
                        w: p.cropW
                    }
                })
            } else Math.abs(1 - s) < .05 && Math.abs(1 - a) < .05 || s > 1.05 && a > 1.05 ? (l = t, c = o, d.x += i / 2 - t / 2, d.y += n / 2 - o / 2) : s > a ? (l = t * a, d.x += i / 2 - l / 2) : (c = o * s, d.y += n / 2 - c / 2);
            this.isOriginalCropExist() || (this.isFullHeight() || this.isFullWidth() ? (p.originalCropH = this.model.get("originalH"), p.originalCropW = this.model.get("originalW"), p.originalCropX = 0, p.originalCropY = 0) : (p.originalCropH = p.cropH, p.originalCropW = p.cropW, p.originalCropX = p.cropX, p.originalCropY = p.cropY)), this.model.set({
                w: l,
                h: c,
                x: d.x,
                y: d.y,
                ratio: t / o,
                scale: l / t,
                ...p
            }, {
                first: e && e.first
            }), this.setScaledImage(We.default.bind(function() {
                this.isVector() && this.fixVectorScale()
            }, this), e), this.model.created = !1
        },
        fixVectorScale: function() {
            let e, t = this.$svg[0] ? .viewBox,
                o = this.$svg.get(0).getBBox(),
                i = this.getBoxData(),
                n;
            if (t) try {
                n = t.baseVal && t.baseVal.width ? t.baseVal.width / t.baseVal.height : t.width ? t.width / t.height : 1
            } catch {
                n = 1
            } else o.width && o.height && (n = o.width / o.height);
            let s = i.w / i.h;
            Math.abs(n - s) < .05 || (this.isFullWidth() ? e = {
                h: i.w / n,
                originalW: this.model.get("full_width_initial_w"),
                originalH: this.model.get("full_width_initial_w") / n
            } : n > 1 ? e = {
                h: i.h / n,
                originalH: i.h / n,
                ratio: n
            } : e = {
                w: i.w * n,
                originalW: i.w * n,
                ratio: n
            }, this.model.save(e, {
                skipHistory: !0
            }))
        },
        showIconLoader: function() {
            this.has_parent_block ? (this.$upload_button.addClass("uploading"), this.updatePreloaderState({
                value: !0
            })) : me.prototype.showIconLoader.apply(this, arguments), this.showTempPreloader()
        },
        hideIconLoader: function() {
            this.has_parent_block ? this.$upload_button ? .removeClass("uploading") : (me.prototype.hideIconLoader.apply(this, arguments), this.hideTempPreloader())
        },
        deselect: function(e = {}) {
            e.deselectOnViewportChange && (this._deselectOnViewportChange = !0), me.prototype.deselect.apply(this, arguments), this.leaveCropMode({
                viewportChange: this._deselectOnViewportChange
            }), this.leaveFWPosMode()
        },
        onWorkspaceBlocksSelect: function(e) {
            me.prototype.onWorkspaceBlocksSelect.apply(this, arguments), e && e.length == 1 && e[0] == this || (this.leaveCropMode(), this.leaveFWPosMode())
        },
        onPageHeightChanged: function() {
            (this.isFullHeight() || this.isFullWidth() && this.isFullHeight()) && this.updateCropParamsAfterUpdatePictureParamsDebounced({
                saveDimensions: !1
            })
        },
        onFixedPositionChanged: function() {
            (this.isFullHeight() || this.isFullWidth()) && this.updateCropParamsAfterUpdatePictureParamsDebounced()
        },
        onWorkspaceResizePicture: function() {
            if (!this.rendered) return;
            let e = RM.constructorRouter.zoom.getZoom();
            this.cropmode && (this.isFullWidth() || this.isFullHeight()) && this.toggleFWPosMode(), e > 1 && !this.tempPicture && !this.originalLoaded && this.updatePicture({
                load: this.useLambdaUrl() ? _i.url : _i.lambdaUrlForOldWidget,
                complete: () => this.originalLoaded = !0
            })
        },
        isPictureEmpty: function() {
            return We.default.isEmpty(this.model.get("picture")) && !this.tempPicture
        },
        migrateOldData: function(e) {
            let t = {
                    silent: !0,
                    toHistory: !1,
                    skipHistory: !0
                },
                o = u1(e.get("preview_enabled"), e.get("preview_overlay_color"));
            o && e.save(o, t)
        },
        getWidgetVersionBasedOnDataFields: function(e) {
            let t = e ? ? this.model,
                o = this.isOriginalCropExist(e),
                i = t["viewport_default"] ? .fwpos !== void 0 || t["viewport_default"] ? .fhpos !== void 0,
                n = ![t.get("preview_enabled"), t.get("preview_overlay_color")].includes(void 0),
                s = !!(t.get("picture") ? .effectUrl ? ? t.get("picture") ? .finalUrl ? ? t.get("picture") ? .final2xUrl ? ? t.get("picture") ? .thumbUrl);
            if (o && !i && !n && !s) return 2
        },
        destroy: function() {
            this.uploader && this.uploader.destroy(), this.leaveCropMode(), this.leaveFWPosMode(), me.prototype.destroy.apply(this, arguments), this.hideIconLoader(), this.model.off("change:picture", this.toggle_loaded), this.stopListening(this.model), this.$upload_button && this.$upload_button.off("click"), this.off(), this.$el.off()
        }
    });
    tC.defaults = {
        version: 2,
        flags: {
            useOriginalViewBoxSVG: !0
        }
    };
    tC["defaults.with-image"] = {
        version: 2,
        picture: {
            lambdaUrl: void 0,
            type: void 0,
            unscaledUrl: void 0,
            url: void 0
        },
        cropW: void 0,
        cropH: void 0,
        cropX: void 0,
        cropY: void 0,
        originalCropW: void 0,
        originalCropH: void 0,
        originalCropX: void 0,
        originalCropY: void 0,
        originalW: void 0,
        originalH: void 0,
        ratio: void 0,
        scale: void 0
    };
    hie = $t.extend({
        maxwidth: 9999,
        maxheight: 9999,
        onResize: function() {
            let e = $t.prototype.onResize.apply(this, arguments);
            e && (this.block._getFinalRequest && this.block._getFinalRequest.abort(), this._scaledimageXHR && this._scaledimageXHR.abort(), this.block.hideTempPreloader(), this.block.cropmode || (this.block.setIsPictureResizing(!0), this.block.setContentBorderRadius(), this.block.useLambdaUrl() && this.block.createBorderContainerDurngResize())), this.block.cropmode ? this.block.onCropResize(e) : this.block._modeTransition && this.block.onLeavingCropResize(e)
        },
        setConstraints: function(e) {
            let t = {
                top: parseInt(e.css("top")),
                left: parseInt(e.css("left")),
                width: parseInt(e.css("width")),
                height: parseInt(e.css("height"))
            };
            this.constraints = { ...t
            }
        }
    }), qy = tC
});
var RW, EW = k(() => {
    "use strict";
    no();
    RW = {
        "template-constructor-block-slideshow": Ae `
	<input class="uploadInput" type="file" name="upload" multiple="multiple" data-url="/api/upload/lambda/" />
	<div class="slideshow-overlay jsSlideshowOverlay"></div>

	<div class="drop-text"></div>

`
    }
});
var Cl, Ne, FW, mie, fie, DW, AW = k(() => {
    "use strict";
    Cl = E(Ze()), Ne = E(ze());
    Ky();
    On();
    Ro();
    UH();
    EW();
    Ib();
    Wt();
    yu();
    Ip();
    Mt();
    ug();
    Xy();
    Yt();
    $p();
    ih();
    KS();
    nf();
    Ss(); of ();
    Or();
    g1();
    oo();
    FW = 1.25, mie = ma.extend({
        name: "Slideshow",
        sort_index: 7,
        thumb: "slideshow",
        icon_color: "#0052A8",
        initial_controls: ["slideshow_manager", "slideshow_settings", "text_typography", "text_color", "text_link", "slideshow_alt", "slideshow_transitions", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["slideshow_settings", "slideshow_alt", "common_shadow"],
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            5: "common_interactions",
            6: "common_cursor",
            7: "common_draggable",
            8: "common_shadow",
            9: "common_position",
            10: "common_layer",
            11: "readymag_preset",
            12: "my_preset"
        },
        MIN_IMAGES_WIDTH: 40,
        MIN_IMAGES_HEIGHT: 40,
        MIN_CAPTIONS_HEIGHT: 16,
        ARROW_NOUN_ICON_WIDTH: 18,
        ARROW_NOUN_ICON_HEIGHT: 18,
        DEFAULT_ARROWS_CONTAINER: {
            LEFT: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40"><path d="M23.5 11.5 L15.5 19.5 L23.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path></svg>',
            RIGHT: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40"><path d="M16.5 11.5 L24.5 19.5 L16.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path></svg>'
        },
        MAX_ICON_CACHE_SIZE: 30,
        params: {
            multipleName: "multiple values",
            tabIndent: 28,
            fontSizeLineHeightRatio: FW,
            minFontSize: de.minFontSize,
            maxFontSize: 999,
            minLineHeight: 10,
            maxLineHeight: 999,
            minLetterSpacing: -99,
            maxLetterSpacing: 999
        },
        initialize: function(e, t) {
            this.migrateOldData(e), this.initialSharedState = this.createTextState(), this.setEditorZoom(window.RM.constructorRouter.zoom.getZoom()), this.initBlock(e, t), this.inner_template = RW["template-constructor-block-slideshow"], this.cur_selection_styles = {}, this.cur_selection_styles_all = {}, this.queue = [], this.frameClass = fie, this._imgsPreload = [], this.picloaded = {}, this.model.on("change:theme_data", this.onThemeParamsChange), this.currentIconsData = {}, this.workspace.on("main-dragover", this.highlightDropZone), this.model.skipResponse = !0, this.fillTextStyles(), this.workspace.on("deselect", this.showOverlay), this.workspace.on("deselect", this.setToDefaultArrows), this.workspace.on("select", this.hideOverlay), bt.on("zoom", this.setEditorZoom), this.saveDebounced = Ne.default.debounce(() => {
                this.model.save()
            }, 400), this.renderCorrectIconsDebounced = Ne.default.debounce(this.renderCorrectIcons, 10), this.updateCaptionDebounced = Ne.default.debounce(this.updateCaption, 200)
        },
        render: function() {
            this.create(), (0, Cl.default)(this.inner_template(this.model.attributes)).appendTo(this.$content), this.$el.addClass("slideshow can-drop"), this.model.get("theme_data") && (this.setControls(), this.propsModel = new Backbone.Model({
                useTextWidgetStore: this.useSharedState,
                viewport: this.workspace.viewport,
                isEditMode: !1,
                fontStyles: [],
                isResizing: !1,
                selected: !1,
                workspace: this.workspace,
                isJustCreated: !1,
                disableSelectionHighlight: !1,
                setCurrentLinkStyle: () => {},
                leaveEditMode: () => {},
                onIframeLoaded: () => {
                    this.onIframeLoaded()
                },
                canControlsBeClosed: () => this.workspace.controls.canControlsBeClosed()
            }), this.slideshowPlayer = new S1({
                params: Ne.default.clone(this.model.attributes),
                $container: this.$content,
                environment: "constructor",
                block: this,
                mag: this.workspace && this.workspace.mag,
                viewport: this.workspace ? .viewport,
                textParams: {
                    propsModel: this.propsModel,
                    model: this.textModel
                }
            }), window.RM.constructorRouter.on("font-added", this.onFontsChanged), this.onFontsChanged(), this.onThemeParamsChange(), this.uploader = new pu(this, {
                fileInput: this.$(".uploadInput"),
                unique: !0
            }), this.bindUploader(this.uploader), this.on("changeStyleSpan", this.textStyleChanged), this.on("changeStyleParagraph", this.textStyleChanged), this.model.get("theme_data").arrows_type !== "default" && this.renderCorrectIcons(), this.listenTo(this, "arrow_type_changed", this.renderCorrectIconsDebounced), this.listenTo(this, "captions_changed", this.onCaptionsStatusChange), this.triggerReady())
        },
        renderCorrectIcons: function() {
            let e = this.model.get("theme_data"),
                t = e.arrows_type,
                o, i;
            t === "default" ? (o = e.controls_color, i = e.controls_opacity, this.renderIcon({
                $svg: (0, Cl.default)(this.DEFAULT_ARROWS_CONTAINER.LEFT),
                activeArrow: "left_arrow_default"
            }), this.renderIcon({
                $svg: (0, Cl.default)(this.DEFAULT_ARROWS_CONTAINER.RIGHT),
                activeArrow: "right_arrow_default"
            }), this.slideshowPlayer.colorArrows(o, i)) : (t === "library" || t === "noun") && this.getNounArrows()
        },
        select: function() {
            ma.prototype.select.apply(this, arguments), this.propsModel && this.propsModel.set({
                selected: !0,
                isEditMode: !0
            })
        },
        deselect: function() {
            ma.prototype.deselect.apply(this, arguments), this.propsModel && this.propsModel.set({
                selected: !1,
                isEditMode: !1
            })
        },
        hideOverlay: function() {
            this.$(".jsSlideshowOverlay").hide()
        },
        showOverlay: function() {
            this.$(".jsSlideshowOverlay").show()
        },
        setToDefaultArrows: function() {
            let e = this.model.get("theme_data"),
                t = e.arrows_type,
                o = e.left_icon_noun,
                i = e.right_icon_noun;
            Ne.default.defer(() => {
                (t === "library" || t === "noun") && Ne.default.isEmpty(o) && Ne.default.isEmpty(i) && this.model.save({
                    theme_data: Ne.default.extend(this.model.get("theme_data"), {
                        arrows_type: "default"
                    })
                })
            })
        },
        bindUploader: function(e) {
            e.on("add", this.onAddUpload), e.on("send", this.onSendUpload), e.on("done", this.onDoneUpload), e.on("fail", this.onFailUpload)
        },
        getNounArrows: function() {
            let e = this.model.get("theme_data").left_icon_noun,
                t = this.model.get("theme_data").right_icon_noun;
            Ne.default.isEmpty(e) && Ne.default.isEmpty(t) || (Ne.default.isEmpty(e) || this.getIconSVG(e.noun_id || e.rm_id, e.noun_url, "left_arrow_noun", function(o, i) {
                o || i.$svg
            }.bind(this)), Ne.default.isEmpty(t) || this.getIconSVG(t.noun_id || t.rm_id, t.noun_url, "right_arrow_noun", function(o, i) {
                o || i.$svg
            }.bind(this)))
        },
        rasterizeIconsBeforeDestroy: function() {
            let e = this.model.get("theme_data"),
                t = {
                    theme_data: e
                };
            if (!Ne.default.isEmpty(this.currentIconsData.left_arrow_noun)) {
                let {
                    b64url: i
                } = Sn.getNormalizedSvg(this.get\ u0421oloredIconSVG("left_arrow_noun")[0]);
                t.theme_data.left_icon_noun = { ...e.left_icon_noun,
                    b64url: i
                }, t.left_arrow_noun = {
                    rasterUrl: "",
                    raster2xUrl: "",
                    raster3xUrl: ""
                }
            }
            if (!Ne.default.isEmpty(this.currentIconsData.right_arrow_noun)) {
                let {
                    b64url: i
                } = Sn.getNormalizedSvg(this.get\ u0421oloredIconSVG("right_arrow_noun")[0]);
                t.theme_data.right_icon_noun = { ...e.right_icon_noun,
                    b64url: i
                }, t.right_arrow_noun = {
                    rasterUrl: "",
                    raster2xUrl: "",
                    raster3xUrl: ""
                }
            }
            this.model.save(t, {
                silent: !0,
                skipHistory: !0,
                patch: !0
            }), !Ne.default.isEmpty(this.currentIconsData.left_arrow_noun) && this.rasterizeIconSVG({
                activeArrow: "left_arrow_noun",
                onSuccess: o(this.model, "left_arrow_noun")
            }), !Ne.default.isEmpty(this.currentIconsData.right_arrow_noun) && this.rasterizeIconSVG({
                activeArrow: "right_arrow_noun",
                onSuccess: o(this.model, "right_arrow_noun")
            });

            function o(i, n) {
                return function(s) {
                    i.set(n, s, {
                        skipHistory: !0,
                        silent: !0
                    })
                }
            }
        },
        renderIcon: function(e) {
            let t = e.$svg,
                o = e.activeArrow;
            ["left_arrow_noun", "left_arrow_default"].includes(o) && (this.$el.find(".prev-picture-arrow-bottom").empty().html(t.clone()).toggleClass("noun", o === "left_arrow_noun"), this.$el.find(".prev-picture-arrow-middle").empty().html(t.clone()).toggleClass("noun", o === "left_arrow_noun")), ["right_arrow_noun", "right_arrow_default"].includes(o) && (this.$el.find(".next-picture-arrow-bottom").empty().html(t.clone()).toggleClass("noun", o === "right_arrow_noun"), this.$el.find(".next-picture-arrow-middle").empty().html(t.clone()).toggleClass("noun", o === "right_arrow_noun"))
        },
        prepareIconSVG: function(e) {
            let t = e.clone().appendTo((0, Cl.default)("body")),
                o = e.clone();
            t.get(0).setAttributeNS(null, "viewBox", "0 0 " + t.width() + " " + t.height());
            let i = t.get(0).getBBox();
            return t.remove(), o.data("aspect_ratio", i.width / i.height), o.removeAttr("width"), o.removeAttr("height"), o.get(0).setAttributeNS(null, "viewBox", i.x + " " + i.y + " " + i.width + " " + i.height), o.get(0).setAttributeNS(null, "preserveAspectRatio", "xMidYMid meet"), o.css({
                width: "100%",
                height: "100%"
            }), o
        },
        get\ u0421oloredIconSVG: function(e) {
            let t = this.model.get("theme_data").controls_color,
                o = this.model.get("theme_data").controls_opacity,
                i, n = this.currentIconsData[e].$svg.clone();
            return i = be.getRGBA(t, 1), n.find("*:not(.fixed-color)").each(function() {
                let s = (0, Cl.default)(this);
                s.css({
                    fill: "",
                    "fill-opacity": ""
                }), s.get(0).removeAttribute("fill"), s.get(0).removeAttribute("fill-opacity")
            }), n.get(0).setAttribute("fill", i), n.get(0).setAttribute("fill-opacity", o), n
        },
        rasterizeIconSVG: function(e) {
            this.rasterizeXhr = Sn.rasterize({
                widgets: [this.model],
                svg: this.get\ u0421oloredIconSVG(e.activeArrow),
                mid: this.workspace.mag.get("_id"),
                viewport: this.model.getViewport(),
                size: {
                    width: this.ARROW_NOUN_ICON_WIDTH,
                    height: this.ARROW_NOUN_ICON_HEIGHT
                },
                activeArrow: e.activeArrow,
                noPresave: !0,
                onSuccess: e.onSuccess
            })
        },
        getIconSVG: function(e, t, o, i) {
            let n = o.includes("left"),
                s = n ? "iconXhrLeft" : "iconXhrRight",
                a = n ? "iconLeftRequestInProgress" : "iconRightRequestInProgress",
                l;
            this[s] && this[s].abort();
            let c = function(d) {
                let p = (0, Cl.default)("<div></div>").append((0, Cl.default)(d.svg)).find("svg");
                if (p.length) return p = this.prepareIconSVG(p), l = {
                    id: e,
                    $svg: p,
                    noun_url: d.new_url,
                    aspect_ratio: p.data("aspect_ratio")
                }, this.currentIconsData[o] = l, this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG(o),
                    activeArrow: o
                }), i(null, {
                    $svg: p,
                    noun_url: d.new_url
                })
            }.bind(this);
            this[s] = typeof AbortController < "u" ? new AbortController : void 0, Sn.fetchSvgIcon(e, t, this[s] ? .signal).then(({
                svg: d,
                new_url: p
            }) => c({
                svg: d,
                new_url: p
            })).catch(d => i(d)).finally(() => this[a] = !1), this[a] = !0
        },
        fillTextStyles: function() {
            let e = {
                "size-leading-linked": !0,
                "size-leading-ratio": this.params.fontSizeLineHeightRatio
            };
            this.cur_selection_styles = Ne.default.defaults(Ne.default.clone(this.model.get("text_style")), e), this.cur_selection_styles_all = [Ne.default.defaults(Ne.default.clone(this.model.get("text_style")), e)]
        },
        onCaptionsStatusChange: function(e) {
            this.setControls(e), this.updateControls()
        },
        setControls: function(e) {
            e = typeof e > "u" ? this.model.get("theme_data").captions : e, e ? this.controls = this.initial_controls : this.controls = Ne.default.without(this.initial_controls, "text_typography", "text_color", "text_link")
        },
        onAddUpload: function(e, t) {
            let o = null;
            if (!this.replacingPic) o = {
                num: this.getMaxNum() + 1,
                name: t.files && t.files[0].name,
                uploadData: t
            }, this.trigger("addUpload", o);
            else {
                this.queue.indexOf(this.replacingPic) > -1 && this.cancelUpload(this.replacingPic);
                for (let i in this.replacingPic) i != "num" && i != "id" && i != "text" && delete this.replacingPic[i];
                this.replacingPic.name = t.files && t.files[0] && t.files[0].name, this.replacingPic.uploadData = t, o = this.replacingPic, this.replacingPic = null, this.trigger("replaceUpload", o)
            }
            this.queue.push(o)
        },
        onSendUpload: function() {
            this.trigger("nowUploading", this.queue[0])
        },
        onDoneUploadFinish: function(e) {
            let t = this.queue.shift();
            if (!e) {
                this.trigger("failUpload", t);
                return
            }
            let o = Ne.default.clone(this.model.get("pictures")) || [],
                i = !o.length,
                n = o.findIndex(a => a.id === t.id),
                s = Ne.default.extend({
                    num: t.num
                }, e.picture, e.size);
            n > -1 ? o[n] = Ne.default.extend(s, {
                id: o[n].id,
                caption: o[n].caption
            }) : o.push(Ne.default.extend(s, {
                id: be.generateUUID()
            })), this.tempSave({
                pictures: o
            }), this.queue = this.queue || [], this.trigger("doneUpload", s), i && this.updateControls()
        },
        onDoneUpload: function(e, t) {
            if (!t.result) return this.onDoneUploadFinish(null);
            let {
                result: o
            } = t, i = Ne.default.clone(this.model.attributes);
            if (ii.useLambdaUrl(o && o.picture)) return this.onDoneUploadFinish(o);
            if (!i || !i._id || !o.picture.type || !["jpg", "png"].includes(o.picture.type.toLowerCase())) return this.onDoneUploadFinish(o);
            this._optimizedImageXHR = Cl.default.ajax({
                type: "POST",
                data: {
                    _id: i._id,
                    picture: o.picture
                },
                url: "/api/imageoptimize",
                success: n => {
                    o.picture = Ne.default.extend(o.picture, n), this.onDoneUploadFinish(o)
                },
                error: () => {
                    this.onDoneUploadFinish(o)
                }
            })
        },
        onFailUpload: function(e, t, o) {
            let i = this.queue.shift(),
                n = Ne.default.clone(this.model.get("pictures")) || [],
                s = Ne.default.indexOf(n, i);
            i.error = !0, i.errorText = o, s > -1 ? n[s] = Ne.default.omit(Ne.default.extend(i, {
                id: n[s].id,
                text: n[s].text
            }), "uploadData") : n.push(Ne.default.omit(Ne.default.extend(i, {
                id: be.generateUUID()
            }), "uploadData")), this.model.set("pictures", n), this.queue = this.queue || [], this.updateControls(), this.trigger("failUpload", i, o), this.tempSave({
                pictures: n
            })
        },
        deletePic: function(e) {
            let t = Ne.default.findWhere(this.queue, {
                num: e
            });
            t ? this.cancelUpload(t) : (t = Ne.default.findWhere(this.model.get("pictures"), {
                num: e
            }), this.model.set("pictures", Ne.default.without(this.model.get("pictures"), t))), Ne.default.each(this.getAllPics(), function(o) {
                o.num > t.num && (o.num -= 1)
            }), this.trigger("reorder"), this.model.save({}, {
                silent: !Ne.default.isEmpty(this.queue)
            }), (this.model.get("pictures") || []).length == 0 && this.updateControls()
        },
        updatePic: function(e) {
            this.replacingPic = Ne.default.clone((0, Ne.default)(this.getAllPics()).findWhere({
                num: e
            })), this.uploader.$uploader.trigger("click", "stop")
        },
        cancelUpload: function(e) {
            this.queue.indexOf(e) === 0 && (e.uploadData.abort(), this.queue[1] && this.trigger("nowUploading", this.queue[1])), this._optimizedImageXHR && this._optimizedImageXHR.abort(), e.uploadData.files[0].skipped = !0, this.queue = Ne.default.without(this.queue, e)
        },
        removePictures: function() {
            this.uploader.abort(), this.model.unset("pictures"), this.model.save({}, {
                silent: !0
            }), this.queue = [], this.trigger("clear")
        },
        swapPictures: function(e, t) {
            let o = (0, Ne.default)(this.getAllPics()).sortBy(function(n) {
                    return n.num
                }),
                i = Ne.default.findWhere(o, {
                    num: e
                });
            for (let n = e; n != t + (e < t ? 1 : -1); e < t ? n++ : n--) n != e && (o[n - 1].num = e < t ? o[n - 1].num - 1 : o[n - 1].num + 1);
            i.num = t, this.trigger("reorder"), this.fixPicturesOrder(o), this.saveXHR && this.saveXHR.abort(), this.saveXHR = this.model.save({}, {
                silent: !Ne.default.isEmpty(this.queue)
            }), this.workspace.trigger("redraw"), this.slideshowPlayer.applyPictures(Ne.default.clone(this.model.attributes))
        },
        tempSave: function(e) {
            this.tempSaveXHR && (this.tempSaveXHR.abort(), delete this.tempSaveXHR), e && e.pictures && this.fixPicturesOrder(e.pictures), this.tempSaveXHR = this.model.save(e, {
                patch: !0,
                skipHistory: !Ne.default.isEmpty(this.queue)
            }).success(Ne.default.bind(function() {
                delete this.tempSaveXHR
            }, this))
        },
        fixPicturesOrder: function(e) {
            let t = Ne.default.sortBy(e, "num");
            for (let o = 0; o < t.length; o++) t[o].num = o + 1
        },
        getMaxNum: function() {
            let e = this.getAllPics();
            return Ne.default.isEmpty(e) ? 0 : Ne.default.max(Ne.default.pluck(e, "num"))
        },
        getAllPics: function() {
            return Ne.default.union(this.model.get("pictures") || [], this.queue)
        },
        updateDropZone: function() {
            let e = this.$el;
            this.manager && (e = e.add(this.manager.$uploadDropZone)), this.settingsPanel && this.settingsPanel.canUpload() && (e = e.add(this.settingsPanel.$el)), this.uploader.setOptions({
                dropZone: e
            })
        },
        getThemeData: function() {
            let e = {
                theme: this.model.get("current_theme"),
                thumbnails: this.model.get("theme_data").thumbnails,
                counters: this.model.get("theme_data").counters,
                images_h: this.model.get("images_h"),
                captions_h: this.model.get("captions_h"),
                left_arrow_noun: this.model.get("left_arrow_noun"),
                right_arrow_noun: this.model.get("right_arrow_noun"),
                current_mode: this.model.get("current_mode"),
                arrows_type: this.model.get("theme_data").arrows_type,
                captions: this.model.get("theme_data").captions,
                counters_type: this.model.get("theme_data").counters_type,
                counters_position: this.model.get("theme_data").counters_position,
                active_arrows: this.model.get("active_arrows")
            };
            return e.showThumbnails = e.thumbnails, e.showCounters = e.counters, e.showCaptions = e.captions || e.theme === "theme_captions", e.showBottomDots = e.counters && ((e.active_arrows === "middle" || e.counters_position === "outside") && e.counters_type === "dots" || e.theme === "theme_captions"), e
        },
        getNewBlockHeight: function() {
            let e = this.getThemeData(),
                t = 0;
            return t = e.images_h + (e.thumbnails ? this.slideshowPlayer.THUMBNAILS_HEIGHT : 0) + (e.showCaptions ? e.captions_h : 0) + (e.showBottomDots ? this.slideshowPlayer.COUNTERS_HEIGHT : 0), t
        },
        getNewInnerElementsHeight: function(e, t, o = !1) {
            let i = this.getThemeData(),
                n = i.images_h,
                s = i.captions_h;
            if (o && e && i.captions) {
                let a = n / (n + s),
                    l = e * a,
                    c = e - l;
                return {
                    images_h: l,
                    captions_h: c
                }
            }
            return t === "s" && i.captions ? s = e - i.images_h - (i.showBottomDots ? this.slideshowPlayer.COUNTERS_HEIGHT : 0) : n = e - (i.thumbnails ? this.slideshowPlayer.THUMBNAILS_HEIGHT : 0) - (i.showCaptions ? i.captions_h : 0) - (i.showBottomDots ? this.slideshowPlayer.COUNTERS_HEIGHT : 0), {
                images_h: n,
                captions_h: s
            }
        },
        getNestedWidgetsJSON: function() {
            let t = this.model.get("pictures") || [],
                o = [],
                i = [];
            for (let n of t) {
                if (n.caption) {
                    let a = {
                        type: "text",
                        ...$d.defaults,
                        ...n.caption
                    };
                    o.push(rt(a))
                }
                let s = rt(n);
                delete s ? .caption, i.push(s)
            }
            return [...i, ...o]
        },
        getSaveBoxData: function(e) {
            e = e || {};
            let t = me.prototype.getSaveBoxData.apply(this, arguments);
            if (e.resizeContent) return t;
            let o = this.getNewInnerElementsHeight(t.h, e.resizePoint, !!e.resizeContent);
            return t.images_h = o.images_h, t.captions_h = o.captions_h, t
        },
        saveBox: function() {
            me.prototype.saveBox.apply(this, arguments), this.setSizeConstraints()
        },
        textStyleChanged: function(e, t) {
            let o = Ne.default.clone(this.model.get("text_style")),
                i = Ne.default.extend(o, e);
            t && (i = Ne.default.extend(i, t)), this.model.set({
                text_style: i
            }), this.saveDebounced()
        },
        redraw: function(e, t) {
            if (t = t || {}, !this.checkNeedRedraw(e, t)) return;
            me.prototype.redraw.apply(this, arguments);
            let o = this.model.changedAttributes();
            if (!Ne.default.isObject(o)) return;
            let i = ["captions_h", "images_h", "w", "h", "theme_data", "left_arrow_noun", "right_arrow_noun", "transition_type", "play_method"];
            if (Ne.default.intersection(Ne.default.keys(o), i).length && this.slideshowPlayer.applyVisualState(this.model.attributes), this.model.hasChanged("pictures") && this.slideshowPlayer.applyPictures(this.model.attributes), this.model.hasChanged("text_style") && (this.slideshowPlayer.applyTextStyles(this.model.attributes), this.fillTextStyles(), this.trigger("selection_styles_changed", this.cur_selection_styles), this.trigger("selection_styles_all_changed", this.cur_selection_styles_all), this.initiatorControl = null), "theme_data" in e.changed) {
                let n = this.getNewBlockHeight();
                n !== this.model.get("h") && this.model.set("h", n)
            }
        },
        scaleContent: function(e) {
            let t = this.getNewInnerElementsHeight(e.height, null, !0);
            this.slideshowPlayer.applyVisualState(Ne.default.clone(this.model.attributes), {
                w: e.width,
                h: e.height,
                images_h: t.images_h,
                captions_h: t.captions_h
            }), this.model.set({
                images_h: t.images_h,
                captions_h: t.captions_h
            })
        },
        css: function(e = {}, t) {
            if (me.prototype.css.apply(this, arguments), !e.resizeContent && (e.height != null || e.width != null)) {
                let o = this.getNewInnerElementsHeight(e.height || this.model.get("h"), t);
                this.slideshowPlayer.applyVisualState(Ne.default.clone(this.model.attributes), {
                    w: e.width,
                    h: e.height,
                    images_h: o.images_h,
                    captions_h: o.captions_h
                })
            }
        },
        onThemeParamsChange: function() {
            let e = this.getThemeData();
            this.model.set("h", this.getNewBlockHeight()), this.setSizeConstraints(), this.frame && this.frame.setResizeBottomPlus(e.showBottomDots || e.captions)
        },
        setSizeConstraints: function() {
            let e = this.getThemeData(),
                t = (e.showBottomDots ? this.slideshowPlayer.COUNTERS_HEIGHT : 0) + (e.thumbnails ? this.slideshowPlayer.THUMBNAILS_HEIGHT : 0) + (e.captions ? this.MIN_CAPTIONS_HEIGHT : 0),
                o, i;
            o = (e.captions ? e.images_h : this.MIN_IMAGES_HEIGHT) + t, i = this.MIN_IMAGES_HEIGHT + t, Ne.default.extend(this.frame, {
                minwidth: this.MIN_IMAGES_WIDTH,
                maxwidth: 9999,
                minheight: 0,
                maxheight: 9999,
                minheight_on_south_resize: o,
                minheight_on_other_resize: i
            })
        },
        highlightDropZone: function() {
            this.$el.addClass("show-dropzone"), clearTimeout(this.highlightTimeout), this.highlightTimeout = setTimeout(Ne.default.bind(function() {
                this.$el.removeClass("show-dropzone")
            }, this), 500)
        },
        toggleSelectionHighlight(e) {
            this.textParams && this.textParams.propsModel && this.textParams.propsModel.set("disableSelectionHighlight", e)
        },
        createTextState({
            rawModel: e,
            lastStyle: t
        } = {}) {
            try {
                this.textModel = new zp(e || { ...$d.defaults,
                    ...Ah({
                        text: "Type image caption here"
                    })
                });
                let o = Ll(this.textModel);
                return e || (o = gf(o, t || {
                    [Vc]: "align-center",
                    FONT_SIZE: 10,
                    [Fl]: 12
                }), o = dh({
                    editorState: o,
                    paddings: {
                        left: 37,
                        right: 37,
                        top: 10,
                        bottom: 0
                    }
                })), o
            } catch (o) {
                throw console.error(o), new Error("Cannot create Text model for Slideshow")
            }
        },
        migrateOldData(e) {
            let t = {
                silent: !0,
                toHistory: !1,
                skipHistory: !0
            };
            if (e.get("version") !== 2) {
                let i = e.get("text_style"),
                    s = [...e.get("pictures") || []].reduce((a, l) => {
                        if (l && l.text) {
                            let c = Z6(l.text, i);
                            return [...a, { ...l,
                                text: void 0,
                                caption: c
                            }]
                        }
                        return [...a, l]
                    }, []);
                e.save({
                    pictures: s,
                    text_style: void 0,
                    version: 2
                }, t)
            }
        },
        updateCaption(e, t) {
            let o = [...this.model.get("pictures") || []],
                i = o.findIndex(n => n.id === e);
            if (i > -1 && o[i]) {
                let n = { ...o[i]
                    },
                    s = wr(t.getCurrentContent());
                o[i] = { ...n,
                    caption: s
                }, this.model.set({
                    pictures: o
                }, {
                    toHistory: !1,
                    silent: !0
                }), this.saveDebounced()
            }
        },
        beforeSharedStateUpdate({
            newState: e
        }) {
            let t = this.slideshowPlayer.currentImageID;
            return this.updateCaptionDebounced(t, e), e
        },
        setEditorZoom(e) {
            this.zoom = e
        },
        onIframeLoaded: function() {
            this.iframe = this.slideshowPlayer ? .textWidgetWrapper[0].querySelector("iframe"), this.startRedirectIframeEvents()
        },
        startRedirectIframeEvents: function() {
            let e = this.iframe ? .contentWindow ? .document ? .querySelector("body");
            e && (e.addEventListener("mousemove", this.onRedirectIframeEvents), e.addEventListener("mouseup", this.onRedirectIframeEvents), e.addEventListener("click", this.onRedirectIframeEvents))
        },
        onRedirectIframeEvents: function(e) {
            let t = this.slideshowPlayer.textWidgetWrapper,
                o = new MouseEvent(e.type, {
                    clientX: t.offset().left * this.zoom + e.clientX * this.zoom - Mp * this.zoom,
                    clientY: t.offset().top * this.zoom + e.clientY * this.zoom - Mp * this.zoom,
                    button: e.button,
                    buttons: e.buttons,
                    movementX: e.movementX,
                    movementY: e.movementY,
                    relatedTarget: e.relatedTarget,
                    bubbles: !0,
                    cancelable: !0
                });
            Object.defineProperty(o, "target", {
                value: e.target,
                enumerable: !0
            }), Object.defineProperty(o, "screenX", {
                value: e.screenX,
                enumerable: !0
            }), Object.defineProperty(o, "screenY", {
                value: e.screenY,
                enumerable: !0
            }), this.disableMouseEventsRedirection || (window.dispatchEvent(o), document.dispatchEvent(o))
        },
        stopRedirectIframeEvents: function() {
            let e = this.iframe ? .contentWindow ? .document ? .querySelector("body");
            e && (e.removeEventListener("mousemove", this.onRedirectIframeEvents), e.removeEventListener("mouseup", this.onRedirectIframeEvents), e.removeEventListener("click", this.onRedirectIframeEvents))
        },
        onFontsChanged: function() {
            this.propsModel.set("fontStyles", bf())
        },
        destroy: function() {
            this.workspace.off("main-dragover", this.highlightDropZone), this.off("changeStyleSpan", this.textStyleChanged), this.off("changeStyleParagraph", this.textStyleChanged), bt.off("zoom", this.setEditorZoom), window.RM.constructorRouter.off("font-added", this.onFontsChanged), this.stopRedirectIframeEvents(), this.model.off(), this.slideshowPlayer && this.slideshowPlayer.destroy(), this.slideshowPlayer = null, me.prototype.destroy.apply(this, arguments)
        }
    }, {
        defaults: {
            captions_h: 76,
            images_h: 360,
            current_mode: "default",
            transition_type: "slider",
            play_method: "click",
            theme_data: {
                arrows: !0,
                arrows_type: "default",
                arrows_position: "sides",
                arrows_view_mode: "normal",
                counters_type: "numbers",
                counters_position: "inside",
                slider_transition: .5,
                crossfade: 2,
                autoplay_delay: 4,
                hover_delay: .8,
                scroll_delay: 1,
                start_offset: 200,
                hover_frame_rate: .8,
                captions: !1,
                fullscreen: !1,
                controls_bg: !0,
                show_on_hover: !1,
                thumbnails: !1,
                counters: !1,
                fill: !0,
                radius: 0,
                controls_color: "ffffff",
                controls_opacity: 1,
                background_color: "000000",
                background_opacity: 1,
                left_icon_noun: {},
                right_icon_noun: {}
            },
            text_style: {
                color: "000000",
                "font-family": "Arial",
                "font-size": 8,
                "font-style": "normal",
                "font-weight": "400",
                "letter-spacing": 0,
                "line-height": 10,
                opacity: 100,
                "text-align": "center",
                "text-decoration": "none",
                "text-transform": "none",
                "vertical-align": "baseline",
                "size-leading-linked": !0,
                "size-leading-ratio": FW
            }
        }
    }), fie = $t.extend({
        applyExtraConstraints: function(e, t) {
            return this.block.setSizeConstraints(), t == "s" ? e.height < this.minheight_on_south_resize && (e.height = this.minheight_on_south_resize) : e.height < this.minheight_on_other_resize && (e.height = this.minheight_on_other_resize), e
        },
        setResizeBottomPlus: function(e) {
            this.$el.toggleClass("resize-bottom-plus-slideshow", e)
        }
    }), DW = mie
});
var LW, li, gie, bie, zW, $W = k(() => {
    "use strict";
    LW = E(Ze()), li = E(ze());
    On();
    Ro();
    VH();
    mv();
    Mt();
    Zr();
    gie = me.extend({
        excludedFromLib: !0,
        name: "Twitter",
        thumb: "twitter",
        icon_color: "#1DA1F2",
        initialize: function(e, t) {
            let o = this;
            this.mag = t.mag, this.initBlock(e, t), this.frameClass = bie, this.model.validate = function(i) {
                let n = o.model.get("current_type");
                i[n].url && (i[n].url = o.fixUrl(i[n].url)), i.type_hashtag && i.type_hashtag.hash && (i.type_hashtag.hash = i.type_hashtag.hash.replace(/\s/g, "")), i.type_follow && i.type_follow.username && (i.type_follow.username = i.type_follow.username.replace(/\s/g, ""))
            }, this.model.on("change:current_type", this.onParamsChange), this.model.on("change:type_timeline", this.onParamsChange), this.model.on("change:type_embed", this.onParamsChange), this.model.on("change:type_tweet", this.onParamsChange), this.model.on("change:type_follow", this.onParamsChange), this.model.on("change:type_hashtag", this.onParamsChange), this.controls = ["twitter_settings", "common_position", "common_layer"]
        },
        render: function() {
            this.create(), this.$el.addClass("twitter"), this.redraw(this.model, {
                skipHistory: !0,
                skipTriggerRedraw: !0,
                doNotRedrawPacksFrames: !0,
                doNotRedrawBottomShiftLine: !0,
                firstRender: !0
            }), this.onParamsChange(), this.triggerReady()
        },
        redraw: function(e, t) {
            if (t = t || {}, !this.checkNeedRedraw(e, t)) return;
            let o = this.model.get("current_type"),
                i = this.model.changedAttributes(),
                n = li.default.isObject(i) && li.default.without(li.default.keys(i), "x", "y", "z", "pack_id").length == 0,
                s = li.default.isObject(i) && (li.default.has(i, "w") || li.default.has(i, "h")) && !i.current_type,
                a = t.firstRender || !(n || s && (o === "type_timeline" || o === "type_embed"));
            me.prototype.redraw.apply(this, arguments), o === "type_embed" && this.adjustTweetHeight({
                skipHistory: t && (t.undo || t.redo || t.skipHistory)
            }), a && this.redrawTwitter(e.get("w"), e.get("h"), t)
        },
        css: function() {
            let e = this.$el.find("iframe"),
                t, o, i;
            me.prototype.css.apply(this, arguments), this.model.get("current_type") === "type_timeline" && e.length == 1 && e.hasClass("twitter-timeline") && (t = e.contents().find("body .timeline-header").outerHeight(), o = e.contents().find("body .timeline-footer").outerHeight(), i = e.height() - t - o, t && o && e.contents().find("body .stream").height(i))
        },
        onParamsChange: function() {
            let e = this.model.get("current_type"),
                t = ["type_timeline", "type_embed", "type_tweet", "type_follow", "type_hashtag"];
            li.default.contains(["type_timeline", "type_embed"], e) ? this.validateCode(e) : li.default.contains(["type_tweet", "type_follow", "type_hashtag"], e), this.$el.removeClass(t.join(" ")), this.$el.addClass(e), this.setSizeConstraints()
        },
        setSizeConstraints: function(e) {
            let t = this.model.get("current_type"),
                o;
            li.default.contains(["type_tweet", "type_follow", "type_hashtag"], t) ? (o = this.$el.find("iframe"), o.length > 0 ? li.default.extend(this.frame, {
                minwidth: o.width() || 120,
                maxwidth: o.width() || 120,
                minheight: o.height() || 20,
                maxheight: o.height() || 20
            }) : li.default.extend(this.frame, {
                minwidth: 120,
                maxwidth: 120,
                minheight: 20,
                maxheight: 20
            })) : t === "type_timeline" ? li.default.extend(this.frame, {
                minwidth: 180,
                maxwidth: 520,
                minheight: 200,
                maxheight: 9999
            }) : t === "type_embed" && (o = this.$el.find("twitterwidget.twitter-tweet"), li.default.extend(this.frame, {
                minwidth: 220,
                maxwidth: 500,
                minheight: o.length && o.height() > 1 ? o.height() : 163,
                maxheight: o.length && o.height() > 1 ? o.height() : 163
            })), e && li.default.extend(this.frame, e)
        },
        doResize: function(e) {
            e = e || {};
            let t = this.model.get("current_type");
            this.model.get("w") < this.frame.minwidth && this.model.set("w", this.frame.minwidth, {
                silent: !0
            }), this.model.get("w") > this.frame.maxwidth && this.model.set("w", this.frame.maxwidth, {
                silent: !0
            }), this.model.get("h") < this.frame.minheight && this.model.set("h", this.frame.minheight, {
                silent: !0
            }), this.model.get("h") > this.frame.maxheight && this.model.set("h", this.frame.maxheight, {
                silent: !0
            }), li.default.contains(["type_tweet", "type_follow", "type_hashtag"], t) && (this.model.set("w", this.frame.minwidth, {
                silent: !0
            }), this.model.set("h", this.frame.minheight, {
                silent: !0
            })), li.default.isEmpty(li.default.pick(this.model.changed, "w", "h")) || this.model.save({}, {
                skipHistory: e.skipHistory,
                noSocketUpdate: Xt.isIncomingUpdate(e)
            }), this.frame.doResize({
                left: this.model.get("x"),
                top: this.model.get("y"),
                width: this.model.get("w"),
                height: this.model.get("h")
            })
        },
        redrawTwitter: function(e, t, o) {
            let i = this.model.get("current_type"),
                n = li.default.clone(this.model.get(i)),
                s = C1["template-constructor-block-twitter-" + i],
                a, l;
            n.use_own_url === "mag" ? n.url = this.getMagUrl() : (n.use_own_url === "page" || !n.url) && (n.url = this.getPageUrl()), a = s(n), this.$content.html(a), this.$overlay = this.$content.find(".overlay"), i === "type_timeline" && this.$content.find("a").attr({
                width: this.model.get("w"),
                height: this.model.get("h")
            }), l = this.frame.isFrameVisible(), this.frame.hide(), jc.initTwitterAPI(function() {
                var c = function(d) {
                    let p = d.target;
                    (0, LW.default)(p).closest(".block").attr("data-id") === this.model.get("_id") && (window.twttr.events.unbind("rendered", c), this.waitForIframe(this.$content, 20, 100, function() {
                        let u = o && (o.undo || o.redo);
                        i === "type_timeline" && this.$content.find("iframe").css({
                            width: "100%",
                            height: "100%",
                            "max-width": "100%"
                        }), i === "type_embed" ? this.adjustTweetHeight({
                            skipHistory: u
                        }) : (this.setSizeConstraints(), this.doResize(li.default.extend({}, o, {
                            skipHistory: i === "type_embed" || u
                        }))), l && this.frame.show()
                    }.bind(this)))
                }.bind(this);
                window.twttr.events.bind("rendered", c), window.twttr && window.twttr.widgets && li.default.isFunction(window.twttr.widgets.load) && window.twttr.widgets.load(this.$el[0])
            }.bind(this))
        },
        validateCode: function(e) {
            let t, o, i, n = {
                type_timeline: /^\<a.*\>.*\<\/a\>/i,
                type_embed: /^\<blockquote.*\>.*\<\/blockquote\>/i
            };
            i = this.model.get(e).code, t = i.match(n[e]), o = li.default.clone(this.model.get(e)), o.code = t ? t[0] : "", this.model.set(e, o)
        },
        waitForIframe: function(e, t, o, i) {
            let n;
            n = setInterval(function() {
                let s = e.find("iframe, twitterwidget");
                s.length && (parseInt(s[0].style.width) > 0 || parseInt(s[0].style.height)) > 0 && (clearInterval(n), li.default.delay(function() {
                    i()
                }.bind(this), 100))
            }, t)
        },
        adjustTweetHeight: function(e) {
            let t = this,
                o = this.$content.find("twitterwidget.twitter-tweet, iframe.twitter-tweet");
            t.model.get("current_type") === "type_embed" && (o.css({
                margin: 0,
                "max-width": "100%",
                "-webkit-transform": "none",
                width: "100%"
            }), o.contents().find("body *").css({
                "-webkit-transition-duration": "0s",
                "transition-duration": "0s"
            }), t.setSizeConstraints(), t.doResize(e))
        },
        getMagUrl: function() {
            let e = de.readymag_viewer_host;
            return this.mag && e + "/" + this.mag.get("num_id") + "/"
        },
        getPageUrl: function() {
            return de.readymag_viewer_host + "/p" + this.workspace.page.get("num_id") + "/"
        },
        fixUrl: function(e) {
            let t = e;
            return e && (t = (/^http(s?):\/\//i.test(e) ? "" : "http://") + e), t
        }
    }, {
        defaults: {
            current_type: "type_timeline",
            type_timeline: {
                code: '<a class="twitter-timeline" href="https://twitter.com/readymag" data-widget-id="324216476359852033">Tweets by @readymag</a>',
                widget_id: ""
            },
            type_embed: {
                code: '<blockquote class="twitter-tweet"><p>Here we go: <a href="http://t.co/yY6jqsSg" title="https://readymag.com/">readymag.com</a></p>&mdash; Readymag (@readymag) <a href="https://twitter.com/readymag/status/225550067766005760">July 18, 2012</a></blockquote>'
            },
            type_tweet: {
                url: "",
                use_own_url: "mag",
                show_count: !0,
                large_button: !1
            },
            type_follow: {
                username: "Readymag",
                show_name: !0,
                large_button: !1
            },
            type_hashtag: {
                hash: "Readymag",
                large_button: !1
            }
        }
    }), bie = $t.extend({
        customResizeHandler: function(e) {
            return this.block.setSizeConstraints(), e
        }
    }), zW = gie
});
var WW, fr, yie, vie, OW, jW = k(() => {
    "use strict";
    WW = E(Ze()), fr = E(ze());
    On();
    Ro();
    GH();
    mv();
    Mt();
    Zr();
    yie = me.extend({
        excludedFromLib: !0,
        name: "Facebook",
        thumb: "facebook",
        icon_color: "#1877F2",
        initialize: function(e, t) {
            let o = this,
                i, n;
            this.mag = t.mag, this.initBlock(e, t), this.model.get("current_type") == "type_like_button" && this.model.get("type_like_button").send_button && (i = fr.default.clone(this.model.get("type_like_button")), i.share_button = i.send_button, delete i.send_button, this.model.set("type_like_button", i, {
                silent: !0
            })), fr.default.isEmpty(this.model.get("type_like_box")) || (n = fr.default.clone(this.model.get("type_like_box")), n.small_header = !n.show_header, delete n.show_header, this.model.unset("type_like_box", {
                silent: !0
            }), this.model.set({
                type_page: n
            }, {
                silent: !0
            }), this.model.get("current_type") == "type_like_box" && this.model.set({
                current_type: "type_page"
            }, {
                silent: !0
            })), this.frameClass = vie, this.model.validate = function(s) {
                let a = o.model.get("current_type");
                s[a].url && (s[a].url = o.fixUrl(s[a].url))
            }, this.controls = ["facebook_settings", "common_position", "common_layer"]
        },
        render: function() {
            this.create(), this.$el.addClass("facebook"), this.redraw(this.model, {
                skipTriggerRedraw: !0,
                doNotRedrawPacksFrames: !0,
                doNotRedrawBottomShiftLine: !0,
                firstRender: !0
            }), this.triggerReady()
        },
        redraw: function(e, t) {
            if (t = t || {}, !this.checkNeedRedraw(e, t)) return;
            let o = this.model.get("current_type"),
                i = this.model.get(o),
                n = this.model.changedAttributes(),
                s = fr.default.isObject(n) && fr.default.without(fr.default.keys(n), "x", "y", "z", "pack_id").length == 0,
                a = t.firstRender || !s,
                l = ["type_like_button", "type_page", "type_comments"];
            me.prototype.redraw.apply(this, arguments), this.$el.removeClass(l.join(" ")), this.$el.addClass(o), o === "type_like_button" && this.$el.removeClass("standard box_count button_count").addClass(i.layout), this.$el.toggleClass("no-v-resize", o === "type_page" && !i.show_stream && !i.show_faces), (0, fr.default)(["type_page", "type_comments"]).contains(o) && (this.setSizeConstraints(), (!t || !(t.undo || t.redo)) && this.doResize()), a && this.redrawFacebook(e.get("w"), e.get("h"), t)
        },
        setSizeConstraints: function(e) {
            let t = this.model.get("current_type"),
                o = this.model.get(t),
                i, n, s, a;
            if (i = this.$el.find("iframe"), t === "type_like_button") {
                if (i.length !== 1) return;
                n = o.layout === "button_count" || o.layout === "box_count", fr.default.extend(this.frame, {
                    minwidth: n ? i.width() : 285,
                    maxwidth: n ? i.width() : 900,
                    minheight: i.height(),
                    maxheight: i.height()
                })
            } else t === "type_page" ? (s = 63, s += o.show_faces ? 122 : 0, s += o.show_header && (o.show_faces || o.show_stream) ? 30 : 0, s += o.show_stream ? 300 : 0, a = !o.show_faces & !o.show_stream ? 63 : 9999, fr.default.extend(this.frame, {
                minwidth: 292,
                maxwidth: 900,
                minheight: s,
                maxheight: a
            })) : t === "type_comments" && fr.default.extend(this.frame, {
                minwidth: 400,
                maxwidth: 900,
                minheight: 250,
                maxheight: 9999
            });
            e && fr.default.extend(this.frame, e)
        },
        doResize: function(e) {
            this.model.get("w") < this.frame.minwidth && this.model.set("w", this.frame.minwidth, {
                silent: !0
            }), this.model.get("w") > this.frame.maxwidth && this.model.set("w", this.frame.maxwidth, {
                silent: !0
            }), this.model.get("h") < this.frame.minheight && this.model.set("h", this.frame.minheight, {
                silent: !0
            }), this.model.get("h") > this.frame.maxheight && this.model.set("h", this.frame.maxheight, {
                silent: !0
            }), fr.default.isEmpty(fr.default.pick(this.model.changed, "w", "h")) || this.model.save({}, {
                skipHistory: !0,
                noSocketUpdate: Xt.isIncomingUpdate(e)
            }), this.frame.doResize({
                left: this.model.get("x"),
                top: this.model.get("y"),
                width: this.model.get("w"),
                height: this.model.get("h")
            })
        },
        redrawFacebook: function(e, t, o) {
            let i = this.model.get("current_type"),
                n = fr.default.clone(this.model.get(i)),
                s = k1["template-constructor-block-facebook-" + i],
                a, l;
            n.w = this.model.get("w"), n.h = this.model.get("h"), n.use_own_url === "mag" ? n.url = this.getMagUrl() : (n.use_own_url === "page" || !n.url) && (n.url = this.getPageUrl()), n.url = this.fixUrl(n.url), a = s({
                data: n
            }), this.$content.html(a), this.$overlay = this.$content.find(".overlay"), this.$content.toggleClass("scrollable", i === "type_comments"), jc.initFacebookAPI(function() {
                window.FB.XFBML.parse(this.$el.get(0), function() {
                    if (i === "type_comments" && this.$(".fb-comments").append((0, WW.default)('<div class="overlay"></div>')), i === "type_like_button") {
                        l = this.$el.find("iframe");
                        let d = 0,
                            p = 20;
                        var c = setInterval(function() {
                            d++, (l.height() > 0 || d > p) && (clearInterval(c), this.setSizeConstraints(), this.doResize(o))
                        }.bind(this), 100)
                    }
                }.bind(this))
            }.bind(this))
        },
        getMagUrl: function() {
            let e = de.readymag_viewer_host;
            return this.mag && e + "/" + this.mag.get("num_id") + "/"
        },
        getPageUrl: function() {
            return de.readymag_viewer_host + "/p" + this.workspace.page.get("num_id") + "/"
        },
        fixUrl: function(e) {
            let t = e;
            return e && (t = (/^http(s?):\/\//i.test(e) ? "" : "http://") + e), t
        }
    }, {
        defaults: {
            current_type: "type_like_button",
            x: "center",
            w: 61,
            h: 20,
            type_like_button: {
                url: "",
                use_own_url: "mag",
                layout: "button_count",
                share_button: !1,
                show_faces: !1,
                theme: "light"
            },
            type_page: {
                url: "https://www.facebook.com/readymag",
                show_stream: !0,
                small_header: !1,
                show_faces: !1,
                theme: "light"
            },
            type_comments: {
                url: "",
                use_own_url: "mag",
                num_posts: 5,
                theme: "light"
            }
        }
    }), vie = $t.extend({}), OW = yie
});

function Ec({
    iconSizes: e,
    blockSizes: t,
    blockPosition: o,
    scaleBySmall: i = !1,
    blockFixedPosition: n,
    prevIconSizes: s = null
}) {
    let a = e.width / e.height,
        l = s ? Math.max(s.width / t.width, s.height / t.height) : 1,
        c = s ? {
            width: s.width / l,
            height: s.height / l
        } : {
            width: t.width,
            height: t.height
        },
        d = i ? Math.min(c.height, c.width) : Math.max(c.height, c.width),
        p = { ...c
        };
    if ((i ? e.width < e.height : e.width > e.height) ? (p.height = Math.round(d / a), p.width = Math.round(d)) : (p.height = Math.round(d), p.width = Math.round(d * a)), o && o ? .left !== void 0 && o ? .top !== void 0) {
        let h = { ...o
            },
            u = {
                left: (t.width - p.width) / 2,
                top: (t.height - p.height) / 2
            };
        return n ? (["n", "c", "s"].includes(n) ? h.left = o.left : ["nw", "w", "sw", "ne", "e", "se"].includes(n) && (h.left = o.left + u.left), ["w", "c", "e"].includes(n) ? h.top = o.top : ["nw", "n", "ne", "sw", "s", "se"].includes(n) && (h.top = o.top + u.top)) : (h.left = o.left + u.left, h.top = o.top + u.top), h.left = Number(h.left.toFixed(1)), h.top = Number(h.top.toFixed(1)), {
            x: h.left,
            y: h.top,
            h: p.height,
            w: p.width
        }
    } else return {
        h: p.height,
        w: p.width
    }
}
var Qy = k(() => {
    "use strict"
});
var Qu, Tn, wie, HW, NW = k(() => {
    "use strict";
    Qu = E(Ze()), Tn = E(ze());
    Ro();
    I1();
    yu();
    yr();
    Qy();
    En();
    wie = me.extend(eg.prototype).extend({
        currentIconData: null,
        name: "Shape",
        sort_index: 3,
        thumb: "shape",
        prevSVGSizes: null,
        icon_color: "#FFCB00",
        dontSaveOnResize: !0,
        autoRasterize: !0,
        LINE_BLOCK_HEIGHT: 24,
        initial_controls: ["shape_settings", "shape_1x1", "common_rotation", "shape_color", "shape_link", "shape_alt", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["shape_color", "shape_alt", "common_shadow"],
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            7: "common_interactions",
            8: "common_cursor",
            9: "common_draggable",
            10: "common_shadow",
            11: "common_position",
            12: "common_layer",
            13: "readymag_preset",
            14: "my_preset"
        },
        initialize: function(e, t) {
            this.mag = t.mag, this.initBlock(e, t), this.renderSVGContent.__debounced = Tn.default.debounce(this.renderSVGContent, 0), this.rasterizeSVGDebounced = Tn.default.debounce(this.rasterizeSVG, 600), this.iconData = null, this.groupControlsDividers = ["shape_color", "common_shadow"], this.groupControls[4] = "shape_settings", this.groupControls[5] = "shape_color", this.saveDebounced = Tn.default.debounce(this.saveModel, 200)
        },
        saveModel: function(e, t) {
            this.model.save(e, t)
        },
        render: function() {
            this.create(), this.$el.addClass("shape"), this.setControls(), this.redraw(this.model, {
                skipTriggerRedraw: !0,
                doNotRedrawPacksFrames: !0,
                doNotRedrawBottomShiftLine: !0,
                firstRender: !0
            }), this.model.on("change:tp", this.onTypeChange), this.model.on("change:is_full_width", this.onStrechBlockChange), this.model.on("change:is_full_height", this.onStrechBlockChange), this.onTypeChange(), this.triggerReady()
        },
        onDblClick: function(e) {
            this.selected && (0, Qu.default)(e.target).closest(".content").length && (!this.model.get("pack_id") || this.workspace.getSelectedBlocks().length === 1 ? this.showControl("shape_settings") : me.prototype.onDblClick.apply(this, arguments))
        },
        onStrechBlockChange: function() {
            this.setControls(), this.updateControls()
        },
        showControl: function(e) {
            let t = this.workspace && this.workspace.controls,
                o;
            t && (o = t.findControl(e), o && !o.selected && o.onClick())
        },
        setControls: function() {
            let e = this.model.get("tp");
            e == "line" || e == "icon" ? this.controls = Tn.default.without(this.initial_controls, "shape_1x1") : this.controls = this.initial_controls
        },
        onTypeChange: function(e, t, o) {
            let i = this.model.get("tp"),
                n = e && Tn.default.without(Tn.default.keys(e.changedAttributes()), "tp").length === 0;
            this.proportional = !1, i === "icon" && (this.isRealChangeByMe(o) && Tn.default.delay(function() {
                this.showControl("shape_icon")
            }.bind(this), 300), t === "icon" && this.makeSquare(), this.resetFullWidth(), this.resetFullHeight()), i === "line" && n !== void 0 && this.fixLineHeight(), this.setControls(), this.updateControls()
        },
        redraw: function(e, t) {
            if (t = t || {}, !this.checkNeedRedraw(e, t)) return;
            me.prototype.redraw.apply(this, arguments);
            let o = this.model.changedAttributes(),
                i = !1,
                n, s, a, l = this.model.previous("rm_id") !== this.model.get("rm_id"),
                c = this.model.previous("noun_id") !== this.model.get("noun_id");
            if (Tn.default.isObject(o) && (i = Tn.default.without(Tn.default.keys(o), "x", "y", "z", "sticked_margin", "sticked").length == 0, a = Tn.default.without(Tn.default.keys(o), "rasterUrl", "raster2xUrl", "raster3xUrl").length == 0, n = !!o.tp, s = !!(l || c)), !a && (!i || this.model.isGlobal() || t.firstRender))
                if (e.get("tp") === "icon") {
                    let d = { ...t,
                            viewport: this.model.getViewport(),
                            skipHistory: t.isGroupResize
                        },
                        p = this.autoRasterize && this.model.attributes.checksum !== this.calculateChecksum(this.model.attributes),
                        h = n || s,
                        u = this.redrawIcon.bind(this, e, d, h, p);
                    t.isGroupResize ? Tn.default.delay(u) : Tn.default.delay(u)
                } else this.redrawShape(e.get("w"), e.get("h")), n && e.get("tp") === "ellipse" && this.makeSquare(), t.viewportChange && e.get("tp") !== "icon" && e.get("rasterUrl") && e.save({
                    rasterUrl: null,
                    raster2xUrl: null,
                    raster3xUrl: null
                }, {
                    skipHistory: !0,
                    silent: !0
                })
        },
        redrawIcon: function(e, t, o, i) {
            this.$content.find("svg").get(0) && (this.prevSVGSizes = this.$content.find("svg").get(0).getBBox()), this.getIconSVG(e.get("noun_id") || e.get("rm_id"), e.get("noun_url"), function(n, s) {
                n || !s.$svg || this.destroyed || (this.updateIconSVGData(s, o, t), i && !t.socketUpdate && this.rasterizeSVGDebounced())
            }.bind(this))
        },
        getIconStyle: function(e = {}) {
            let t = {},
                o = "./constructor/widgetbar/icons/";
            if (e.small && this.icon_color && (t["background-color"] = this.icon_color), this.model.get("tp") === "icon") t["background-color"] = this.icon_color, (!e || !e.small) && (t["border-radius"] = "8px");
            else {
                let i = G(`${o}shape-${this.model.get("tp")}.svg`);
                t["background-image"] = `url(${i})`
            }
            return t
        },
        getIconData: function() {
            return this.model.get("tp") === "icon" ? this.iconData : null
        },
        updateIconSVGData: function(e, t, o = {}) {
            let i = this.model.changedAttributes(),
                n;
            Tn.default.isObject(i) && (n = !!(i.noun_id || i.rm_id)), this.iconData = e, this.redrawShape(this.model.get("w"), this.model.get("h")), t && this.fixIconSVGSize({ ...o,
                iconChanged: n
            })
        },
        scaleContent: function(e, t) {
            let o = Math.min(e.width / t.width, e.height / t.height);
            this.model.get("borders") && this.model.set("borders", Math.floor(this.model.get("borders") * o) || 1)
        },
        css: function(e = {}) {
            me.prototype.css.apply(this, arguments), (e.width !== void 0 && this.model.get("is_full_width") || e.height !== void 0 && this.model.get("is_full_height") || e.width !== void 0 && e.height !== void 0) && this.redrawShape(e.width ? ? this.model.get("w"), e.height ? ? this.model.get("h"))
        },
        redrawShape: function(e, t) {
            let o = this.generateShapeSVG("constructor", this.model, e, t);
            this.renderSVGContent(o), Modernizr.firefox && this.renderSVGContent.__debounced(o)
        },
        renderSVGContent: function(e) {
            this.$content.html(e)
        },
        fixIconSVGSize: function(e) {
            let t = this.$content.find("svg");
            if (!t.length) return;
            let o = this.getBoxData(),
                i = t.get(0).getBBox(),
                n = this.model.get("fixed_position"),
                s = {
                    width: i.width,
                    height: i.height
                },
                a = {
                    width: o.w,
                    height: o.h
                },
                l = {
                    left: o.x,
                    top: o.y
                },
                c = Ec({
                    iconSizes: s,
                    blockSizes: a,
                    blockPosition: l,
                    blockFixedPosition: n,
                    prevIconSizes: e ? .iconChanged && this.prevSVGSizes && !this.isFullWidth() && !this.isFullHeight() ? {
                        width: this.prevSVGSizes.width,
                        height: this.prevSVGSizes.height
                    } : null
                }),
                d;
            e ? .iconChanged && !e ? .undo && !e ? .redo ? d = c : d = o, this.model.set(d, Tn.default.extend({
                skipHistory: !1
            }, e))
        },
        rasterizeSVG: function() {
            let e = this,
                t = this.$content.find("svg");
            t.length && (this.rasterizeXhr && this.rasterizeXhr.abort(), this.rasterizeXhr = Sn.rasterize({
                noPresave: !0,
                widgets: [this.model],
                svg: t,
                mid: this.workspace.mag.get("_id"),
                checksum: this.calculateChecksum(this.model.attributes),
                viewport: this.model.getViewport(),
                size: {
                    width: this.model.get("w"),
                    height: this.model.get("h")
                },
                onSuccess: function(o) {
                    if (!o || !o.rasterUrl) return;
                    let i = pt("widget.transactionalRasterize") ? { ...o,
                        b64url: null
                    } : o;
                    e.model.getViewport() === "default" && (e.model.viewport_phone_portrait && e.model.viewport_phone_portrait.rasterUrl === null && e.model.clone({
                        viewport: "phone_portrait"
                    }).set(i, {
                        skipHistory: !0,
                        silent: !0
                    }), e.model.viewport_tablet_portrait && e.model.viewport_tablet_portrait.rasterUrl === null && e.model.clone({
                        viewport: "tablet_portrait"
                    }).set(i, {
                        skipHistory: !0,
                        silent: !0
                    })), (e.model.getViewport() !== "default" || pt("widget.transactionalRasterize")) && e.model.save(i, {
                        skipHistory: !0,
                        silent: !0
                    })
                }
            }))
        },
        onResizeStart: function() {
            this.rasterizeXhr && this.rasterizeXhr.abort()
        },
        onResizeEnd: function(e, t, o) {
            if (this.model.get("tp") !== "icon") return this.saveBoxDebounced(o);
            this.fixIconSVGSize(o), this.model.save(null, {
                skipHistory: !1,
                silent: !0
            })
        },
        saveBox: function() {
            me.prototype.saveBox.apply(this, arguments)
        },
        getDefaultIconSVG: function() {
            return this.prepareIconSVG((0, Qu.default)('<svg xmlns="http://www.w3.org/2000/svg" width="246" height="245"><path fill="#282828" fill-rule="evenodd" d="M117.858 210.495L56.34 243.02c-5.37 2.84-12.026.788-14.865-4.583a11 11 0 01-1.12-6.99l11.837-69.404a11 11 0 00-2.76-9.31L3.823 103.326c-4.12-4.464-3.843-11.423.621-15.544a11 11 0 015.756-2.784l63.95-10.035a11 11 0 008.17-6.021l30.804-62.768c2.677-5.454 9.267-7.705 14.721-5.029a11 11 0 015.029 5.029l30.804 62.768a11 11 0 008.17 6.02l63.95 10.036c6.001.942 10.103 6.57 9.161 12.572a11 11 0 01-2.784 5.756l-45.609 49.406a11 11 0 00-2.76 9.31l11.836 69.404c1.022 5.988-3.005 11.67-8.994 12.692a11 11 0 01-6.99-1.119l-61.518-32.524a11 11 0 00-10.282 0z"/></svg>'))
        },
        getIconSVG: function(e, t, o, i) {
            if (arguments.length < 4 && (i = o, o = {}), this.iconXhr && this.iconXhr.abort(), !e || !t) return i(null, {
                $svg: this.getDefaultIconSVG(),
                noun_url: null
            });
            if (!o.noCache && this.currentIconData && this.currentIconData.id === e) return i(null, this.currentIconData);
            this.iconRequestInProgress = !0;
            let n = function(s) {
                let a = this.processNounIcon(s);
                return this.currentIconData = { ...a,
                    id: e
                }, i(null, a)
            }.bind(this);
            this.iconXhr = typeof AbortController < "u" ? new AbortController : void 0, Sn.fetchSvgIcon(e, t, this.iconXhr ? .signal).then(({
                svg: s,
                new_url: a
            }) => n({
                svg: s,
                new_url: a
            })).catch(s => i(s))
        },
        processNounIcon: function(e) {
            let t = (0, Qu.default)("<div></div>").append((0, Qu.default)(e.svg)).find("svg");
            if (t.length) return t = this.prepareIconSVG(t), {
                $svg: t,
                noun_url: e.new_url
            }
        },
        prepareIconSVG: function(e) {
            let t = e.clone().appendTo((0, Qu.default)("body")),
                o = e.clone();
            t.get(0).setAttributeNS(null, "viewBox", "0 0 " + t.width() + " " + t.height());
            let i = t.get(0).getBBox();
            return t.remove(), this.currenIconSVGAcpectRatio = i.width / i.height, o.removeAttr("width"), o.removeAttr("height"), o.get(0).setAttributeNS(null, "viewBox", i.x + " " + i.y + " " + i.width + " " + i.height), o.get(0).setAttributeNS(null, "preserveAspectRatio", "xMidYMid meet"), o.css({
                width: "100%",
                height: "100%"
            }), o
        },
        fixLineHeight: function() {
            let e = this.getBoxData(),
                t = this.model.get("weight"),
                o = t > this.LINE_BLOCK_HEIGHT ? t : this.LINE_BLOCK_HEIGHT,
                i = this.model.get("fixed_position"),
                n = {
                    width: Math.max(e.w, e.h),
                    height: o
                },
                s = {
                    width: e.w,
                    height: e.h
                },
                a = {
                    left: e.x,
                    top: e.y
                },
                l = Ec({
                    iconSizes: n,
                    blockSizes: s,
                    blockPosition: a,
                    blockFixedPosition: i
                });
            this.model.set(l)
        },
        makeSquare: function() {
            let e = this.getBoxData(),
                t = this.model.get("fixed_position"),
                o = {
                    width: Math.max(e.w, e.h),
                    height: Math.max(e.w, e.h)
                },
                i = {
                    width: e.w,
                    height: e.h
                },
                n = {
                    left: e.x,
                    top: e.y
                },
                s = Ec({
                    iconSizes: o,
                    blockSizes: i,
                    blockPosition: n,
                    blockFixedPosition: t
                });
            this.model.set(s)
        },
        calculateChecksum(e = {}) {
            return `${e.tp}|${e.w}|${e.h}|${e.bg_color||""}|${e.bg_opacity||""}|${e.rm_id||e.noun_id||""}`
        },
        destroy: function() {
            this.model.off("change:tp", this.onTypeChange), this.model.off("change:is_full_width", this.onStrechBlockChange), this.model.off("change:is_full_height", this.onStrechBlockChange), me.prototype.destroy.apply(this, arguments), this.stopListening(this), this.$el.off()
        }
    }, {
        defaults: {
            tp: "rectangle",
            bg_color: "000000",
            bg_opacity: 1,
            color: "ffffff",
            opacity: 1,
            borders: 0,
            radius: 0,
            radius_rect_tl: 0,
            radius_rect_tr: 0,
            radius_rect_bl: 0,
            radius_rect_br: 0,
            radius_rect_independent: !1,
            sides: 3,
            weight: 1,
            stroke: "solid"
        }
    }), HW = wie
});
var iC, Wd, xie, _ie, UW, VW = k(() => {
    "use strict";
    iC = E(Ze()), Wd = E(ze());
    On();
    Ro();
    YH();
    Nr();
    xie = me.extend({
        name: "Code",
        sort_index: 15,
        thumb: "iframe",
        icon_color: "#8B228C",
        iframe_controls: ["iframe_edit"],
        initial_controls: ["iframe_edit", "common_interactions", "common_cursor", "common_draggable", "common_align", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["iframe_edit", "common_draggable"],
        groupControlsDividers: ["common_draggable"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            4: "common_interactions",
            5: "common_cursor",
            6: "common_draggable",
            7: "common_position",
            8: "common_layer",
            9: "readymag_preset",
            10: "my_preset"
        },
        initialize: function(e, t) {
            this.mag = t.mag, this.frameClass = _ie, this.controls = this.filterControls(e), this.initBlock(e, t)
        },
        onCreate: function() {
            this.showPanel()
        },
        configurePlugin: function() {
            let e = P1.findPlugin(this.model.toJSON()),
                t;
            return e ? (t = new e({
                block: this
            }), t) : null
        },
        render: function() {
            me.prototype.render.apply(this, arguments), this.$el.addClass("iframe"), this.redraw(this.model, {
                skipTriggerRedraw: !0,
                doNotRedrawPacksFrames: !0,
                doNotRedrawBottomShiftLine: !0,
                initialRender: !0
            }), this.bindModelEvents(), this.triggerReady()
        },
        redraw: function(e, t = {}) {
            if (t = t || {}, !this.checkNeedRedraw(e, t)) return;
            let o, i, n = this.model.changedAttributes(),
                s = !1,
                a = !0,
                l = !1;
            if (me.prototype.redraw.apply(this, arguments), Wd.default.isObject(n) && (s = Wd.default.without(Wd.default.keys(n), "x", "y", "z", "w", "h").length === 0, a = t.initialRender || !s, l = Wd.default.contains(Wd.default.keys(n), "code")), !!a) {
                if (this.$content.empty(), this.$container = (0, iC.default)('<div class="container"></div>'), this.$content.append(this.$container), this.$content.append((0, iC.default)('<div class="overlay"></div>')), this.$el.removeAttr("data-plugin"), i = e.get("code"), this.plugin = null, i) {
                    if (this.plugin = this.configurePlugin(i), !this.plugin) return;
                    this.plugin.parse(i, function(c) {
                        o = this.plugin.sanitize(c), o && o.length && this.plugin.draw(o, this.$container, function(d, p) {
                            this.$el.attr("data-plugin", this.plugin.embed_type), (l || this.plugin.forceFrameSize) && (d && !this.isFullWidth() && e.set("w", d), p && !this.isFullHeight() && e.set("h", p)), this.proportional = this.plugin.proportional, this.plugin.resizable && this.$content.find(this.plugin.containerSelector).css({
                                width: "100%",
                                height: "100%",
                                "max-width": "",
                                "max-height": ""
                            })
                        }.bind(this))
                    }.bind(this))
                }
                this.$el.toggleClass("empty", !i)
            }
        },
        filterControls(e) {
            return this.initial_controls.filter(o => o !== "common_draggable" || o === "common_draggable" && !e.get("use_iframe") && !/^<iframe[\s\S]+<\/iframe>$/g.test(e.get("code"))) || []
        },
        bindModelEvents() {
            this.model.on("change:use_iframe change:code", e => {
                let t = this.filterControls(e);
                this.workspace ? .controls ? .setControls(t, this, {
                    noSelect: !0
                }), this.controls = t
            })
        },
        showPanel: function() {
            this.openCodeEditor({
                model: this.model
            })
        },
        hidePanel: function() {
            this.closeCodeEditor()
        },
        openCodeEditor: function(e) {
            so.isPermissionAllowed("CodeCanEditCode") && RM.constructorRouter.openCodeEditor(e)
        },
        closeCodeEditor: function() {
            RM.constructorRouter.closeCodeEditor()
        },
        onDblClick: function() {
            so.isPermissionAllowed("CodeCanEditCode") && this.selected && (!this.model.get("pack_id") || this.workspace.getSelectedBlocks().length === 1 ? RM.constructorRouter.isCodeEditorVisible || this.trigger("editCodeClick") : me.prototype.onDblClick.apply(this, arguments))
        },
        deselect: function() {
            RM.constructorRouter.closeCodeEditor(), me.prototype.deselect.apply(this, arguments)
        },
        destroy: function() {
            RM.constructorRouter.closeCodeEditor(!0), this.model.off(null, null, this), me.prototype.destroy.apply(this, arguments)
        }
    }, {
        defaults: {
            use_iframe: !1
        }
    }), _ie = $t.extend({
        customResizeHandler: function(e) {
            return this.block.plugin && Wd.default.isFunction(this.block.plugin.customResizeHandler) ? this.block.plugin.customResizeHandler.apply(this, arguments) : e
        }
    }), UW = xie
});
var nC, GW = k(() => {
    "use strict";
    no();
    nC = {
        "template-constructor-block-gmaps": Ae `
    <div class="rm-search-block">
        <div class="map-container"></div>
        <div class="map-overlay"></div>
        <div class="message-overlay invisible"></div>
    </div>
    <div class="rm-gmaps-key hidden">
        <div class="key-wrapper">
            <div>
                <div class="key-legend">To use Google Maps widget you need a Google Maps API key. Learn how to get an API key <a href="http://help.readymag.com/hc/en-us/articles/360020526932-Google-Maps" rel="noreferrer noopener" target="_blank">here</a>.</div>
                <div class="key-input-wrap">
                    <input type="text" class="key-input" placeholder="Paste Google Maps API Key here" required minlength="39" maxlength="39">
                    <button>Apply</button>
                </div>
            </div>
        </div>
    </div>
`,
        "template-constructor-block-gmaps-search-control": Ae `
    <div class="rm-search-block">
        <input type="text" class="rm-search source">
        <input type="text" class="rm-search destination">;
    </div>
`
    }
});
var rC, kl, Sie, Cie, YW, ZW = k(() => {
    "use strict";
    rC = E(Ze()), kl = E(ze());
    On();
    Ro();
    GW();
    mv();
    Or();
    Sie = me.extend({
        name: "Maps",
        sort_index: 12,
        thumb: "gmaps",
        icon_color: "#8E5B12",
        initial_controls: ["gmaps_settings", "gmaps_edit", "common_interactions", "common_align", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["gmaps_edit", "common_interactions"],
        groupControlsDividers: ["common_interactions"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            4: "common_interactions",
            5: "common_position",
            6: "common_layer",
            7: "readymag_preset",
            8: "my_preset"
        },
        initialize: function(e, t) {
            this.mag = t.mag, this.frameClass = Cie, this.initBlock(e, t), this.initOpts()
        },
        render: function() {
            me.prototype.render.apply(this, arguments), this.triggerReady(), this.$el.addClass("gmaps"), this.$content.html(nC["template-constructor-block-gmaps"]()), this.$search = (0, rC.default)(nC["template-constructor-block-gmaps-search-control"]()), this.search = this.$search.get(0), this.$source = this.$search.find(".rm-search.source"), this.$destination = this.$search.find(".rm-search.destination"), this.$apiKeyBlock = this.$content.find(".rm-gmaps-key"), this.$apiKeyInput = this.$apiKeyBlock.find("input"), this.$apiKeyApply = this.$apiKeyBlock.find("button"), kl.default.extend(this.frame, {
                minwidth: 240,
                minheight: 210
            }), this.setControls(), this.generateMap(this.bindLogic)
        },
        generateMap: function(e) {
            let t = this.model.get("api_key");
            this.$apiKeyBlock[t ? "addClass" : "removeClass"]("hidden"), jc.initGMapsAPI(t, function() {
                let o = this.model.get("current_type"),
                    i, n, s, a, l, c, d;
                kl.default.defer(function() {
                    this.map = new google.maps.Map(this.$(".map-container").get(0), {
                        zoom: this.model.get("map_zoom"),
                        center: new google.maps.LatLng(this.model.get("center_lat"), this.model.get("center_lng")),
                        mapTypeId: this.model.get("map_type_id") || google.maps.MapTypeId.ROADMAP,
                        streetViewControl: !1
                    }), this.marker = new google.maps.Marker({
                        map: this.map,
                        draggable: !0
                    }), this.sourceAutocomplete = new google.maps.places.Autocomplete(this.$source.get(0), {}), this.destinationAutocomplete = new google.maps.places.Autocomplete(this.$destination.get(0), {}), this.directionsService = new google.maps.DirectionsService, this.directionsDisplay = new google.maps.DirectionsRenderer, i = this.model.get("marker_lat"), n = this.model.get("marker_lng"), i && n && o != "directions" && this.dropMarker(new google.maps.LatLng(i, n)), s = this.model.get("direction_start_lat"), a = this.model.get("direction_start_lng"), l = this.model.get("direction_end_lat"), c = this.model.get("direction_end_lng"), d = this.model.get("direction_route_type"), s && a && l && c && d && (this.source = new google.maps.LatLng(s, a), this.destination = new google.maps.LatLng(l, c)), this.onMapTypeChange(), this.onShowControlsChange(), this.redraw(this.model, {
                        skipTriggerRedraw: !0,
                        doNotRedrawPacksFrames: !0,
                        doNotRedrawBottomShiftLine: !0
                    }), e && e()
                }.bind(this))
            }.bind(this))
        },
        redraw: function(e, t) {
            t = t || {}, this.checkNeedRedraw(e, t) && me.prototype.redraw.apply(this, arguments)
        },
        onMapTypeChange: function(e) {
            let t = this.model.get("current_type");
            this.$destination.toggleClass("hidden", t !== "directions"), this.marker.setVisible(t !== "directions"), t !== "directions" ? this.clearRoute() : this.drawRoute(!e), t == "custom" && this.model.get("custom_json") ? this.applyCustomStyle() : this.clearCustomStyle()
        },
        onSourceChage: function() {
            let e = this.sourceAutocomplete.getPlace();
            if (e.geometry) {
                if (this.source = e.geometry.location, this.model.get("current_type") == "directions") return this.drawRoute();
                this.marker.setVisible(!1), e.geometry.viewport ? this.map.fitBounds(e.geometry.viewport) : (this.map.setCenter(e.geometry.location), this.map.setZoom(17)), this.model.set("formatted_address", e.formatted_address), this.dropMarker(e.geometry.location)
            }
        },
        onDestinationChange: function() {
            let e = this.destinationAutocomplete.getPlace();
            e.geometry && (this.destination = e.geometry.location, this.drawRoute())
        },
        drawRoute: function(e) {
            let t = this.model.get("direction_route_type");
            this.source && this.destination && t && (this.directionsDisplay.setMap(null), this.directionsService.route({
                origin: this.source,
                destination: this.destination,
                travelMode: google.maps.TravelMode[t.toUpperCase()]
            }, function(o, i) {
                let n;
                if (i == google.maps.DirectionsStatus.OK) this.directionsDisplay.setDirections(o), this.directionsDisplay.setOptions({
                    preserveViewport: e || !1
                }), this.directionsDisplay.setMap(this.map), this.model.set({
                    direction_start_lat: this.source.lat(),
                    direction_start_lng: this.source.lng(),
                    direction_end_lat: this.destination.lat(),
                    direction_end_lng: this.destination.lng()
                }), google.maps.event.trigger(this.map, "resize"), kl.default.defer(function() {
                    n = this.map.getCenter(), this.model.set({
                        center_lat: n.lat(),
                        center_lng: n.lng(),
                        map_zoom: this.map.getZoom()
                    })
                }.bind(this));
                else {
                    if (!this.model.get("api_key")) return;
                    this.showMessage("Sorry, there's no route for selected directions.")
                }
            }.bind(this)))
        },
        clearRoute: function() {
            this.directionsDisplay.setMap(null)
        },
        dropMarker: function(e) {
            this.marker.setPosition(e), this.marker.setAnimation(google.maps.Animation.DROP), this.marker.setVisible(!0), this.markerDropped = !0
        },
        setControls: function() {
            this.controls = this.initial_controls
        },
        bindLogic: function() {
            this.listenTo(this.model, "change:current_type", this.onMapTypeChange), this.listenTo(this.model, "change:custom_json", this.applyCustomStyle), this.listenTo(this.model, "change:direction_route_type", this.onRouteTypeChange), this.listenTo(this.model, "change:show_controls", this.onShowControlsChange), this.listenTo(this.model, "change:api_key", this.onApiKeyChange), this.listenTo(this.model, "change", this.hideMessage), google.maps.event.addListener(this.sourceAutocomplete, "place_changed", this.onSourceChage), google.maps.event.addListener(this.destinationAutocomplete, "place_changed", this.onDestinationChange), google.maps.event.addListener(this.marker, "dragend", this.onMarkerDragEnd), google.maps.event.addListener(this.map, "maptypeid_changed", this.onMapTypeIdChange), this.$source.on("click", this.onInputClick), this.$destination.on("click", this.onInputClick), this.$el.on("dblclick", function() {
                this.inEditState || this.trigger("editMapClick")
            }.bind(this)), bt.on("gmaps:update_key", this.updateKey), this.$apiKeyInput.on("click", this.onApiKeyInputClick), this.$apiKeyApply.on("click", this.onApiKeyApply)
        },
        unbindLogic: function() {
            this.stopListening(this.model), window.google && window.google.maps && (google.maps.event.clearListeners(this.sourceAutocomplete, "place_changed"), google.maps.event.clearListeners(this.destinationAutocomplete, "place_changed"), google.maps.event.clearListeners(this.marker, "dragend")), this.$source.off("click", this.onInputClick), this.$destination.off("click", this.onInputClick), this.$el.off("dblclick"), bt.off("gmaps:update_key", this.updateKey), this.$apiKeyInput.off("click", this.onApiKeyInputClick), this.$apiKeyApply.off("click", this.onApiKeyApply)
        },
        enterEditState: function() {
            this.inEditState = !0, this.disableDragging = !0, this.$(".map-overlay").hide(), this.$el.addClass("edit-map"), this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(this.search), kl.default.delay(function() {
                this.$source.focus()
            }.bind(this), 300), this.onShowControlsChange()
        },
        exitEditState: function() {
            let e, t, o = {};
            this.inEditState && (this.disableDragging = !1, this.$(".map-overlay").show(), this.$el.removeClass("edit-map"), this.map.controls[google.maps.ControlPosition.TOP_LEFT].pop(), this.inEditState = !1, this.onShowControlsChange(), e = this.map.getCenter(), kl.default.extend(o, {
                center_lat: e.lat(),
                center_lng: e.lng(),
                map_zoom: this.map.getZoom()
            }), this.markerDropped && (t = this.marker.getPosition(), kl.default.extend(o, {
                marker_lat: t.lat(),
                marker_lng: t.lng()
            })), this.model.set(o))
        },
        onMarkerDragEnd: function() {
            let e = this.marker.getPosition();
            this.model.set({
                marker_lat: e.lat(),
                marker_lng: e.lng(),
                formatted_address: ""
            })
        },
        onMapTypeIdChange: function() {
            let e = this.map.getMapTypeId();
            this.model.set({
                map_type_id: e
            })
        },
        onInputClick: function(e) {
            let t = (0, rC.default)(e.currentTarget);
            kl.default.defer(function() {
                t.select()
            })
        },
        applyCustomStyle: function() {
            let e = this.model.get("custom_json");
            e ? this.map.setOptions({
                styles: JSON.parse(e)
            }) : this.map.setOptions({
                styles: null
            })
        },
        clearCustomStyle: function() {
            this.map.setOptions({
                styles: null
            })
        },
        onRouteTypeChange: function() {
            this.drawRoute()
        },
        onShowControlsChange: function() {
            let e = this.inEditState || this.model.get("show_controls");
            e != this.isControlsVisible && (this.map.setOptions({
                panControl: e,
                zoomControl: e,
                mapTypeControl: e,
                scaleControl: e
            }), this.isControlsVisible = e)
        },
        onApiKeyChange: function(e, t) {
            this.model.save(), bt.trigger("gmaps:update_key", this.model.get("api_key"), this.model.get("_id")), this.regenerateMap(), this.viewOpts.saveOpts({
                gmaps_key: t
            })
        },
        updateKey: function(e, t) {
            this.model.get("_id") !== t && this.model.get("api_key") !== e && (this.model.set("api_key", e, {
                silent: !0
            }), this.model.save(), this.regenerateMap())
        },
        regenerateMap: function() {
            jc.destroyGMapsAPI(), kl.default.defer(function() {
                this.generateMap()
            }.bind(this))
        },
        onApiKeyInputClick: function(e) {
            e.stopImmediatePropagation()
        },
        onApiKeyApply: function(e) {
            e.stopImmediatePropagation();
            let t = this.$apiKeyInput.val();
            t && t.length === 39 && (this.model.set("api_key", t), this.$apiKeyInput.val(""), this.$apiKeyApply.addClass("hidden"))
        },
        initOpts: function() {
            let e = this,
                t = Backbone.Model.extend({
                    url: "/api/mag/opts/" + this.mag.get("num_id")
                });
            this.viewOpts = new t(this.mag.get("opts") || {}), this.viewOpts.saveOpts = function() {
                this.save.apply(this, arguments), e.mag.set("opts", this.toJSON())
            }
        },
        showMessage: function(e) {
            this.$(".message-overlay").text(e).removeClass("invisible")
        },
        hideMessage: function() {
            this.$(".message-overlay").addClass("invisible")
        },
        deselect: function() {
            me.prototype.deselect.apply(this, arguments), this.exitEditState()
        },
        destroy: function() {
            this.unbindLogic(), me.prototype.destroy.apply(this, arguments)
        }
    }, {
        defaults: {
            current_type: "standard",
            center_lat: 30,
            center_lng: -47,
            map_zoom: 2,
            show_controls: !0,
            scrollwheel: !0
        }
    }), Cie = $t.extend({
        onResize: function() {
            $t.prototype.onResize.apply(this, arguments), this.block.map && window.google && window.google.maps && google.maps.event.trigger(this.block.map, "resize")
        }
    }), YW = Sie
});
var Na, Pt, ev, kie, Zi, tv = k(() => {
    "use strict";
    Na = E(Ze()), Pt = E(ze());
    Ro();
    T1();
    Wt();
    Mt();
    bh();
    yu();
    g_();
    Zr();
    Yt();
    Nr();
    Qy();
    ev = "c80000", kie = me.extend({
        name: "Button",
        sort_index: 8,
        thumb: "button",
        icon_color: "#c80000",
        initial_controls: ["button_settings", "button_edit", "icon_settings", "common_rotation", "button_link", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["common_rotation", "button_link", "common_shadow"],
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            6: "common_interactions",
            7: "common_cursor",
            8: "common_draggable",
            9: "common_shadow",
            10: "common_position",
            11: "common_layer",
            12: "readymag_preset",
            13: "my_preset"
        },
        individualStyleKeys: ["background-color", "background-color-opacity", "border-radius", "border-width", "border-color", "border-color-opacity", "font-family", "font-style", "font-weight", "color", "color-opacity", "font-size", "letter-spacing", "baselineShift", "hover-background-color", "hover-background-color-opacity", "hover-border-radius", "hover-border-width", "hover-border-color", "hover-border-color-opacity", "hover-color", "hover-color-opacity", "current-background-color", "current-background-color-opacity", "current-border-radius", "current-border-width", "current-border-color", "current-border-color-opacity", "current-color", "current-color-opacity", "current-font-family", "current-font-style", "current-font-weight", "current-baselineShift", "current-font-size", "current-letter-spacing", "current-text_w", "current-text_h"],
        MIN_FONT_SIZE: de.minFontSize,
        MAX_FONT_SIZE: 999,
        MIN_LETTER_SPACING: -99,
        MAX_LETTER_SPACING: 999,
        DEFAULT_BACKGROUND_COLOR: ev,
        RASTERIZE_MULTIPLIER: 2,
        settingsOnCreate: !1,
        autoRasterize: !0,
        initialize: function(e, t) {
            this.mag = t.mag, this.initBlock(e, t), this.isEditMode = !1, this.buttonState = "default", this._oldAttrs = Pt.default.clone(this.model.attributes), this.onTextInput.__debounced = Pt.default.debounce(this.onTextInput, 20), this.onIconChange.__debounced = Pt.default.debounce(this.onIconChange, 20), this.onIconColorChange.__debounced = Pt.default.debounce(this.onIconColorChange, 20), this.recalcIconContainerSize.__debounced = Pt.default.debounce(this.recalcIconContainerSize, 20), this.onTextContainerSizeChange.__debounced = Pt.default.debounce(this.onTextContainerSizeChange, 20), this.rasterizeSVG.__debounced_default = Pt.default.debounce(this.rasterizeSVG, 100), this.rasterizeSVG.__debounced_hover = Pt.default.debounce(this.rasterizeSVG, 100), this.rasterizeSVG.__debounced_current = Pt.default.debounce(this.rasterizeSVG, 100), this.rasterizeSVG.__debounced_both = Pt.default.debounce(this.rasterizeSVG, 100), this.groupControlsDividers = ["button_settings", "common_shadow"], this.groupControls[4] = "button_settings"
        },
        render: function() {
            let e, t = Pt.default.clone(this.model.attributes),
                o = t.tp;
            this.create(), this.$el.addClass("button"), e = {
                model: t,
                $container: this.$content,
                environment: "constructor",
                mag: this.mag,
                block: this,
                viewport: this.model.viewport
            }, this.buttonWidget = new tg(e), this.$button = this.$(".common-button"), this.$textInput = this.$button.children(".text"), this.$buttonIcon = this.$button.children(".icon"), (o === "icon" || o === "text_and_icon") && this.getIconSVG(this.model.get("icon_noun_id") || this.model.get("icon_rm_id"), this.model.get("icon_noun_url"), function(i, n) {
                i || !n.$svg || (this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG()
                }), this.model.get("icon_rasterUrl") || this.rasterizeSVG({
                    default: !0,
                    hover: !0,
                    current: !0
                }))
            }.bind(this)), this.recalcButtonSize({
                firstRender: !0
            }), this.disableTextInput(), this.handleSelectionColor(), this.bindDOMEvents(), this.bindModelEvents(), this.controls = this.initial_controls, this.frame.recalcPointsDirections(), this.model.created && setTimeout(function() {
                this.enterEditMode({
                    selectText: !0
                })
            }.bind(this), 500), this.triggerReady()
        },
        redraw: function(e) {
            return this.proportional && e.get("w") != e.get("h") && this.recalcButtonSize(), me.prototype.redraw.apply(this, arguments)
        },
        bindDOMEvents: function() {
            this.$el.on("mousedown", this.onButtonMousedown), this.$textInput.on("input", this.onTextInput)
        },
        unbindDOMEvents: function() {
            this.$el.off("mousedown", this.onButtonMousedown), this.$textInput.off("input", this.onTextInput)
        },
        bindModelEvents: function() {
            this.model.on("change:tp", this.onTypeChange, this), this.model.on("change:em_w", this.onPaddingChange, this), this.model.on("change:form", function(e, t, o) {
                this.onFormChange(e, t, o)
            }, this), this.model.on("change:icon_enabled", this.determineButtonType, this), this.model.on("change:text", function(e, t, o) {
                (o.undo || o.redo || Xt.isIncomingUpdate(o)) && this.$textInput.val(this.model.get("text"))
            }, this), this.model.on("change:icon_h", function(e, t, o) {
                this.recalcIconContainerSize(e, t, o)
            }, this), this.model.on("change:icon_pos", function() {
                this.onIconPositionChange(), this.recalcButtonSize()
            }, this), this.model.on("change", (e, t) => {
                let o = i => Pt.default.intersection(Object.keys(this.model.changedAttributes()), i).length > 0;
                o(["text_w", "text_h", "current-text_w", "current-text_h"]) && this.onTextContainerSizeChange(), o(this.individualStyleKeys) && (this.buttonWidget.generateIndividualStyleCSS({
                    env: "constructor",
                    model: Pt.default.clone(this.model.attributes),
                    viewport: this.model.getViewport()
                }), o(["current-font-family", "current-font-weight", "current-font-style", "font-family", "font-weight", "font-style"]) ? this.waitOnExactWebFontLoaded() : this.onTextInput(t)), o(["icon_enabled", "icon_noun_id", "icon_rm_id", "icon_noun_url"]) && this.onIconChange.__debounced(e, void 0, t), o(["icon_color", "icon_color_opacity"]) && this.onIconColorChange(e, void 0, t), o(["hover-icon_color", "hover-icon_color_opacity"]) && this.onIconColorChange(e, void 0, t, "hover"), o(["current-icon_color", "current-icon_color_opacity"]) && this.onIconColorChange(e, void 0, t, "current")
            }, this)
        },
        changeStylingState: function(e = "default") {
            this.onIconColorChange(this.model, null, {}, e)
        },
        proportionalResizeText: function(e) {
            let t = Math.floor(Number(this.model.get("font-size")) * e) || 1,
                o = this.model.get("letter-spacing");
            this.model.set({
                "font-size": t,
                "letter-spacing": o ? Zs({
                    letterSpacing: o,
                    fontSize: this.model.get("font-size"),
                    newFontSize: t
                }) : 0
            })
        },
        proportionalResizeIcon: function(e) {
            this.model.set({
                icon_h: Math.floor(Number(this.model.get("icon_h")) * e) || 1
            })
        },
        scaleContent: function(e, t) {
            let o = e.width !== t.width ? e.width / t.width : 1;
            if (o !== 1) switch (this.model.get("border-width") && this.model.set("border-width", Math.floor(this.model.get("border-width") * o) || 1), this.model.attributes.tp) {
                case "text":
                    this.proportionalResizeText(o);
                    break;
                case "icon":
                    this.proportionalResizeIcon(o);
                    break;
                case "text_and_icon":
                    this.proportionalResizeText(o), this.proportionalResizeIcon(o);
                    break;
                default:
                    break
            }
        },
        onFormChange: function(e, t, o) {
            let i = !1;
            o.undo || o.redo || (i = !0), this.recalcButtonSize({
                onFormChange: !0,
                adjust_height_to_content_for_rectangle: i
            })
        },
        onIconPositionChange: function() {
            this.buttonWidget.applyIconContainerSize(Pt.default.clone(this.model.attributes)), this.buttonWidget.applyIconPosition(Pt.default.clone(this.model.attributes))
        },
        onTextContainerSizeChange: function() {
            this.buttonWidget.applyTextContainerSize(Pt.default.clone(this.model.attributes), this.buttonState === "current")
        },
        onIconColorChange: function(e, t, o, i) {
            if (i = i || "default", this.model.get("tp") !== "text" && (this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG({
                        buttonState: i
                    })
                }), this.autoRasterize && this.model.attributes.checksum !== this.calculateChecksum(this.model.attributes))) {
                let s = this.rasterizeSVG["__debounced_" + i];
                if (Pt.default.isFunction(s) && !o.socketUpdate) {
                    let a = {};
                    a[i] = !0, s(a)
                }
            }
        },
        get\ u0421oloredIconSVG: function(e) {
            e = e || {};
            let t = Pt.default.clone(this.model.attributes),
                o, i, n, s, a = this.currentIconData.$svg.clone();
            return e.buttonState === "default" ? o = "default" : e.buttonState === "hover" || this.buttonState === "hover" ? o = "hover" : e.buttonState === "current" || this.buttonState === "current" ? o = "current" : o = "default", o === "hover" ? (i = t["hover-icon_color"], n = t["hover-icon_color_opacity"] / 100) : o === "current" ? (i = t["current-icon_color"] || t.icon_color, n = (Pt.default.isUndefined(t["current-icon_color_opacity"]) ? t.icon_color_opacity : t["current-icon_color_opacity"]) / 100) : (i = t.icon_color, n = t.icon_color_opacity / 100), s = be.getRGBA(i, 1), a.find("*:not(.fixed-color)").each(function() {
                let l = (0, Na.default)(this);
                l.css({
                    fill: "",
                    "fill-opacity": ""
                }), l.get(0).removeAttribute("fill"), l.get(0).removeAttribute("fill-opacity")
            }), a.get(0).setAttribute("fill", s), a.get(0).setAttribute("fill-opacity", n), a
        },
        onWorkspaceBlocksSelect: function(e) {
            if (me.prototype.onWorkspaceBlocksSelect.apply(this, arguments), !this.rendered) return;
            let t = e && e.length == 1 && e[0] == this;
            this.isEditMode && !t && (this.leaveEditMode({
                deselectControl: !0,
                saveWidgetData: !0
            }), this.workspace.trigger("redraw"))
        },
        onButtonMousedown: function(e) {
            this.isEditMode && !(0, Na.default)(e.target).is(".text") && this.leaveEditMode({
                deselectControl: !0,
                saveWidgetData: !0
            })
        },
        onDblClick: function() {
            this.selected && (!this.model.get("pack_id") || this.workspace.getSelectedBlocks().length === 1 ? this.isEditMode || this.enterEditMode({
                selectText: !0
            }) : me.prototype.onDblClick.apply(this))
        },
        enterEditMode: function(e) {
            e = e || {}, this.isEditMode = !0, this.determineButtonType({
                enter_edit_mode: !0
            }), this.enableTextInput(), e.selectText ? this.$textInput.select() : (0, Na.default)(this.$textInput).focus().setCursorPos(0);
            let t = this.workspace && this.workspace.controls,
                o;
            t && (o = t.findControl("button_edit"), o && o.master.select(o))
        },
        leaveEditMode: function(e) {
            if (e = e || {}, this.model.set("text", this.$textInput.val()), this.isEditMode = !1, this.$textInput.blur(), this.disableTextInput(), this.determineButtonType(), e.saveWidgetData && this.saveWidgetData(), e.deselectControl) {
                let t = this.workspace && this.workspace.controls,
                    o;
                if (!t || (o = t.findControl("button_edit"), !o)) return;
                o.master.deselect()
            }
        },
        disableTextInput: function() {
            this.$textInput.attr("readonly", !0)
        },
        enableTextInput: function() {
            this.$textInput.removeAttr("readonly")
        },
        onTextInput: function(e = {}) {
            so.isPermissionAllowed("BaseWidgetChangeSize") && (this.recalcTextInputSize(e), this.recalcButtonSize(e))
        },
        getTextInputSize: function(e, t) {
            let o = gh({
                    text: e,
                    style: t,
                    useCache: !1
                }),
                i = {
                    width: o.width,
                    height: o.height
                };
            if (this.$textInput.val().trim().length === 0) {
                let n = gh({
                    text: "M",
                    style: { ...t,
                        letterSpacing: 0
                    },
                    cacheForText: !0
                });
                i.width = n.width, i.height = n.height
            }
            return i.width = Math.ceil(i.width / 2) * 2, i.height = Math.ceil(i.height / 2) * 2, i
        },
        recalcTextInputSize: function(e = {}) {
            let t = Pt.default.clone(this.model.attributes),
                o = this.$textInput.val(),
                i = this.getTextInputSize(o, {
                    fontSize: t["font-size"],
                    letterSpacing: t["letter-spacing"],
                    fontFamily: t["font-family"],
                    fontStyle: t["font-style"],
                    fontWeight: t["font-weight"]
                }),
                n = this.getTextInputSize(o, {
                    fontSize: t["current-font-size"],
                    letterSpacing: t["current-letter-spacing"],
                    fontFamily: t["current-font-family"],
                    fontStyle: t["current-font-style"],
                    fontWeight: t["current-font-weight"]
                });
            this.model.set({
                text_h: i.height,
                text_w: i.width,
                "current-text_w": n.width,
                "current-text_h": n.height
            }, e)
        },
        recalcButtonSize: function(e) {
            e = e || {};
            let t = Pt.default.clone(this.model.attributes),
                o = t.tp,
                i = t.form,
                n = t.w,
                s = t.h,
                a = t.x,
                l = t.y,
                c = this.buttonState === "current" ? t["current-text_w"] : t.text_w,
                d = this.buttonState === "current" ? t["current-text_h"] : t.text_h,
                p = t.em_w,
                h = t.icon_w,
                u = t.icon_h,
                m = t.icon_pos,
                f, g, y, S, w, v = {};
            o === "text_and_icon" ? (g = c + h, g = g + p * 2, g = g + this.buttonWidget.calcIconMarginFromText(h), (m === "left" || m === "right") && (u > d ? (y = u, y = y + this.buttonWidget.calcIconTopBottomMargin(u) * 2) : (y = d, y = y + this.buttonWidget.calcTextTopBottomMargin(t["font-size"]) * 2))) : o === "text" ? (g = c, g = g + p * 2, y = d, y = y + this.buttonWidget.calcTextTopBottomMargin(t["font-size"])) : o === "icon" && (f = this.buttonWidget.calcIconMarginFromText(h), g = h + f, y = u + f), g > n && (S = g), y > s && (w = y), n = S || n, s = w || s;
            let C = Math.floor((n - s) / 2);
            i === "circle" || i === "square" ? (n > s ? Pt.default.extend(v, {
                w: n,
                h: n,
                y: l - C,
                x: a - Math.floor((n - this.model.get("w")) / 2)
            }) : Pt.default.extend(v, {
                w: s,
                h: s,
                x: a + C,
                y: l - (s - this.model.get("h")) / 2
            }), this.proportional = !0) : i === "rectangle" && (S && Pt.default.extend(v, {
                w: S,
                x: a - Math.floor((S - this.model.get("w")) / 2)
            }), w ? Pt.default.extend(v, {
                h: w,
                y: l - (w - this.model.get("h")) / 2
            }) : e.adjust_height_to_content_for_rectangle && Pt.default.extend(v, {
                h: y,
                y: l + Math.floor(((S || n) - y) / 2)
            }), this.proportional = !1), e.onFormChange && this.$el.addClass("resize-transition"), v.w && i === "circle" ? this.buttonWidget.applyCircleRadius() : this.$button.css("border-radius", ""), this.model.set(v, {
                skipTriggerRedraw: e.changeViewport || e.firstRender
            }), setTimeout(function() {
                window.requestAnimationFrame(function() {
                    this.$el.removeClass("resize-transition")
                }.bind(this))
            }.bind(this), 450), this.setSizeConstraints(g, y)
        },
        setSizeConstraints: function(e, t) {
            Pt.default.extend(this.frame, {
                minwidth: e,
                maxwidth: 9999,
                minheight: t,
                maxheight: 9999
            })
        },
        determineButtonType: function(e) {
            e = e || {};
            let t = this.model.get("icon_enabled"),
                o = e.enter_edit_mode ? !0 : this.$textInput.val().trim().length,
                i;
            t && o ? i = "text_and_icon" : t && !o ? i = "icon" : i = "text", this.model.set("tp", i)
        },
        onPaddingChange: function() {
            this.recalcButtonSize()
        },
        onTypeChange: function() {
            this.buttonWidget.applyIconContainerSize(Pt.default.clone(this.model.attributes)), this.buttonWidget.applyButtonType(this.model.get("tp")), this.recalcButtonSize()
        },
        waitOnExactWebFontLoaded: function() {
            let e = Pt.default.clone(this.model.attributes);
            if (!e["font-family"] || Pt.default.indexOf(de.systemFontsList, e["font-family"] ? .toLowerCase()) > -1) {
                this.onTextInput();
                return
            }
            Ln.exactWaitForFontLoad(e["font-family"], e["font-weight"], e["font-style"], () => this.onTextInput())
        },
        saveWidgetData: function() {
            Pt.default.isEqual(this.model.toJSON(), this._oldAttrs) || (this.saveXHR && this.saveXHR.abort(), this._oldAttrs = Pt.default.clone(this.model.toJSON()), this.saveXHR = this.model.save())
        },
        deselect: function(e) {
            me.prototype.deselect.apply(this, arguments), e != this && this.isEditMode && (this.leaveEditMode({
                saveWidgetData: !0
            }), this.workspace.trigger("redraw"))
        },
        getSaveBoxOptions: function(e) {
            return Pt.default.extend({
                patch: !0
            }, e)
        },
        destroy: function() {
            this.buttonWidget && this.buttonWidget.destroy(), this.buttonWidget = null, this.rendered && this.unbindDOMEvents(), this.model.off(null, null, this), me.prototype.destroy.apply(this, arguments)
        },
        MAX_ICON_CACHE_SIZE: 30,
        onIconChange: function(e, t, o) {
            e = Pt.default.clone(this.model.attributes), this.getIconSVG(e.icon_noun_id || e.icon_rm_id, e.icon_noun_url, function(i, n) {
                i || !n.$svg || (o.undo || o.redo || this.recalcIconContainerSize(null, null, {
                    onIconChange: !0
                }), this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG()
                }), o.undo || o.redo || o.socketUpdate || this.rasterizeSVG({
                    default: !0,
                    hover: !0,
                    current: !0
                }))
            }.bind(this))
        },
        areValuesLinked: function(e, t, o, i) {
            let n = Pt.default.clone(this.model.attributes),
                s = e === "default" ? "" : e + "-",
                a = t === "default" ? "" : t + "-";
            return n[s + o] == n[a + (i || o)]
        },
        isTextAndIconColorLinked: function(e, t) {
            return e = e || "default", t = t || {}, t.compare_only_color ? this.areValuesLinked(e, e, "color", "icon_color") : this.areValuesLinked(e, e, "color", "icon_color") && this.areValuesLinked(e, e, "color-opacity", "icon_color_opacity")
        },
        isTextAndIconSizeLinked: function(e) {
            return e = e || "default", this.areValuesLinked(e, e, "font-size", "icon_h")
        },
        recalcIconContainerSize: function() {
            if (this.model.get("tp") !== "text") {
                if (this.currentIconData) {
                    let t = {
                            width: Math.max(this.currentIconData.width, this.currentIconData.height),
                            height: Math.max(this.currentIconData.width, this.currentIconData.height)
                        },
                        o = {
                            width: 0,
                            height: this.model.get("icon_h")
                        },
                        i = Ec({
                            iconSizes: t,
                            blockSizes: o
                        });
                    this.model.set({
                        icon_w: i.w
                    })
                }
                this.recalcButtonSize(), this.buttonWidget.applyIconContainerSize(Pt.default.clone(this.model.attributes)), this.autoRasterize && this.model.attributes.checksum !== this.calculateChecksum(this.model.attributes) && this.rasterizeSVG.__debounced_both({
                    default: !0,
                    hover: !0,
                    current: !0
                })
            }
        },
        rasterizeSVG: function(e) {
            if (e = e || {}, !(e.default || e.hover || e.current)) return;
            let t = function(o) {
                o = o || "default";
                let i = this.get\ u0421oloredIconSVG({
                    buttonState: o
                });
                if (!(i || i.length)) return;
                let n = {
                        default: "icon",
                        hover: "hover-icon",
                        current: "current-icon"
                    },
                    s = Pt.default.isUndefined(n[o]) ? n.default : n[o],
                    a = {
                        width: this.model.get("icon_w") * this.RASTERIZE_MULTIPLIER,
                        height: this.model.get("icon_h") * this.RASTERIZE_MULTIPLIER
                    },
                    l = o + "_icon_SVG_rasterize_Xhr";
                this[l] && this[l].abort();
                let c = e[o + "Callback"];
                this[l] = Sn.rasterize({
                    widgets: [this.model],
                    svg: i,
                    mid: this.workspace.mag.get("_id"),
                    checksum: this.calculateChecksum(this.model.attributes),
                    viewport: this.model.getViewport(),
                    size: a,
                    prefix: s,
                    onSuccess: function(d) {
                        c && c(null, d)
                    },
                    onError: function(d) {
                        c && c(d)
                    }
                })
            }.bind(this);
            e.default && t("default"), e.hover && t("hover"), e.current && t("current")
        },
        renderIcon: function(e) {
            e = e || {};
            let t;
            e.$svg ? t = e.$svg : t = this.get\ u0421oloredIconSVG(), this.$buttonIcon.empty().html(t.clone())
        },
        getDefaultIconSVG: function() {
            return this.prepareIconSVG((0, Na.default)('<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="283.5px" height="283.5px" viewBox="0 0 283.5 283.5" enable-background="new 0 0 283.5 283.5" xml:space="preserve"><g><g><path fill-rule="evenodd" clip-rule="evenodd" fill="#231F20" d="M258.3,114.1c-14.1,0-23.1,25-30.1,33.8 c-7,8.8-33.3,2.7-44.1,0.7c-10.7-2.1-38.7-3.9-38.7-3.9s47.4-18,47.4-65c0-47.7-54.9-75.3-73.5-78.1c-17-2.8-23.8,5.6-25.4,7.8 c-1.6,2.2-4.2,4.1-8,5.9c-3.9,1.8-1.5-0.1-15.4,9.8c-13.9,9.8-41.8-4-44.1-4.6c-2.3-0.5-6.8-1.8-8,4.6c-1.5,9.6,6.7,25.4,6.7,25.4 s-2.2,0.2-8,3.3c-5.8,3.1-2.8,7.7-1.3,9.1c1.4,1.4,27.9,16.3,32.1,18.9c10.6,5.3,20.3,31.6-7.3,51.4C-3.1,163,0.4,198.7,0.4,198.7 s-12,85.2,126.9,85.2c139,0,155.6-96.1,155.6-124.2C283,131.5,272.4,114.1,258.3,114.1z M89.5,50.2c-7.1,6.5-15.7,8-19.3,3.5 c-3.6-4.6-0.7-13.5,6.3-20c7.1-6.5,15.7-8,19.3-3.5C99.4,34.7,96.6,43.7,89.5,50.2z M76.1,38.9c-4.7,4.3-6.6,10.3-4.2,13.3 c2.4,3,8.1,2,12.9-2.3c4.7-4.3,6.6-10.3,4.2-13.3C86.6,33.6,80.9,34.6,76.1,38.9z"/></g></g></svg>'))
        },
        getIconSVG: function(e, t, o) {
            this.iconXhr && this.iconXhr.abort();
            let i;
            if (!e) {
                let s = this.getDefaultIconSVG();
                return i = {
                    id: e,
                    $svg: s,
                    noun_url: null,
                    aspect_ratio: s.data("aspect_ratio"),
                    width: s.data("bbWidth"),
                    height: s.data("bbHeight")
                }, this.currentIconData = i, o(null, i)
            }
            if (this.currentIconData && this.currentIconData.id === e) return o(null, this.currentIconData);
            let n = function(s) {
                let a = (0, Na.default)("<div></div>").append((0, Na.default)(s.svg)).find("svg");
                if (a.length) return a = this.prepareIconSVG(a), i = {
                    id: e,
                    $svg: a,
                    noun_url: s.new_url,
                    aspect_ratio: a.data("aspect_ratio"),
                    width: a.data("bbWidth"),
                    height: a.data("bbHeight")
                }, this.currentIconData = i, o(null, {
                    $svg: a,
                    noun_url: s.new_url
                })
            }.bind(this);
            this.iconXhr = typeof AbortController < "u" ? new AbortController : void 0, Sn.fetchSvgIcon(e, t, this.iconXhr ? .signal).then(({
                svg: s,
                new_url: a
            }) => n({
                svg: s,
                new_url: a
            })).catch(s => o(s)).finally(() => this.iconRequestInProgress = !1), this.iconRequestInProgress = !0
        },
        prepareIconSVG: function(e) {
            let t = e.clone().appendTo((0, Na.default)("body")),
                o = e.clone();
            t.get(0).setAttributeNS(null, "viewBox", "0 0 " + t.width() + " " + t.height());
            let i = t.get(0).getBBox();
            return t.remove(), o.data("aspect_ratio", i.width / i.height), o.data("bbWidth", i.width), o.data("bbHeight", i.height), o.removeAttr("width"), o.removeAttr("height"), o.get(0).setAttributeNS(null, "viewBox", i.x + " " + i.y + " " + i.width + " " + i.height), o.get(0).setAttributeNS(null, "preserveAspectRatio", "xMidYMid meet"), o.css({
                width: "100%",
                height: "100%"
            }), o
        },
        handleSelectionColor: function(e) {
            e = e || _u.prototype.hex2rgb(this.model.get("background-color")).concat(1);
            let t = _u.prototype.hex2rgb(this.DEFAULT_BACKGROUND_COLOR).concat(1);
            this.$button.toggleClass("is-contrast-selection", _u.prototype.areColorsClose(e, t))
        },
        onChangeButtonState(e) {
            this.buttonState = e, (0, Na.default)(".common-button", this.$el).toggleClass("hovered", e === "hover"), (0, Na.default)(".common-button", this.$el).toggleClass("current", e === "current"), this.onTextContainerSizeChange()
        },
        calculateChecksum(e = {}) {
            return `${e.tp}|${e.icon_w}|${e.icon_h}|${e.icon_color||""}|${e["hover-icon_color"]||""}|${e["current-icon_color"]||""}|${e.icon_color_opacity||""}|${e["hover-icon_color_opacity"]||""}|${e["current-icon_color_opacity"]||""}|${e.icon_rm_id||e.icon_noun_id||""}`
        }
    }, {
        defaults: {
            tp: "text",
            form: "rectangle",
            text: "Edit",
            w: 134,
            h: 50,
            x: "center",
            transition: !1,
            transitionTime: 0,
            text_w: 32,
            text_h: 26,
            "current-text_w": 32,
            "current-text_h": 26,
            em_w: 16,
            "background-color": ev,
            "background-color-opacity": 100,
            "border-radius": 5,
            "border-width": 0,
            "border-color": "000000",
            "border-color-opacity": 100,
            "font-family": "Arial",
            "font-style": "normal",
            "font-weight": 400,
            color: "ffffff",
            "color-opacity": 100,
            "font-size": 18,
            "letter-spacing": 0,
            "hover-background-color": ev,
            "hover-background-color-opacity": 80,
            "hover-border-width": 0,
            "hover-border-color": "000000",
            "hover-border-color-opacity": 100,
            "hover-color": "ffffff",
            "hover-color-opacity": 100,
            "current-background-color": ev,
            "current-background-color-opacity": 100,
            "current-border-radius": 5,
            "current-border-width": 0,
            "current-border-color": "000000",
            "current-border-color-opacity": 100,
            "current-font-family": "Arial",
            "current-font-style": "normal",
            "current-font-weight": 400,
            "current-color": "ffffff",
            "current-color-opacity": 100,
            "current-font-size": 18,
            "current-letter-spacing": 0,
            icon_enabled: !1,
            icon_h: 18,
            icon_w: 18,
            icon_pos: "left",
            icon_noun_id: null,
            icon_rm_id: null,
            icon_noun_url: null,
            icon_color: "ffffff",
            icon_color_opacity: 100,
            "hover-icon_color": "ffffff",
            "hover-icon_color_opacity": 100,
            "current-icon_color": "ffffff",
            "current-icon_color_opacity": 100,
            icon_rasterUrl: null,
            icon_raster2xUrl: null,
            "hover-icon_rasterUrl": null,
            "hover-icon_raster2xUrl": null,
            "current-icon_rasterUrl": null,
            "current-icon_raster2xUrl": null,
            baselineShift: 0,
            "current-baselineShift": 0
        }
    }), Zi = kie
});
var XW, KW = k(() => {
    "use strict";
    no();
    XW = {
        "template-constructor-workspace-inside-block": Ae `

	<div class="workspace-inside-block">
		<div class="blocks-wrapper"></div>
		<div class="border-wrapper"></div>
		<div class="hotspot-frameborder"></div>
	</div>

`
    }
});

function Wm(e) {
    let {
        nextPosition: t,
        prevPosition: o,
        tipX: i,
        workspacePosition: n,
        windowWidth: s,
        hotspotWidth: a,
        viewportWidth: l,
        viewportLeft: c,
        tipWidth: d,
        workspaceWidth: p,
        zoom: h,
        scroller: u
    } = e, m = u.scrollLeft / h, f = p - l, g = s / h;
    if (o) {
        if (["nw", "w", "sw"].includes(o) && !["nw", "w", "sw"].includes(t)) {
            let y = i - n.left - f * .5 + m;
            return ["n", "c", "s", "ne", "e", "se"].includes(t) ? Wm({ ...e,
                prevPosition: void 0,
                tipX: y
            }) : y
        }
        if (["n", "c", "s"].includes(o) && !["n", "c", "s"].includes(t)) {
            let y = i + g * .5 - a * .5 - n.left - f * .5 + m;
            return ["nw", "w", "sw", "ne", "e", "se"].includes(t) ? Wm({ ...e,
                prevPosition: void 0,
                tipX: y
            }) : y
        }
        if (["ne", "e", "se"].includes(o) && !["ne", "e", "se"].includes(t)) {
            let S = c + g - d - i - f * .5;
            return ["nw", "w", "sw", "n", "c", "s"].includes(t) ? Wm({ ...e,
                prevPosition: void 0,
                tipX: S
            }) : S
        }
    } else {
        if (["nw", "w", "sw"].includes(t)) return i + n.left + f * .5 - m;
        if (["n", "c", "s"].includes(t)) return i - g * .5 + a * .5 + n.left + f * .5 - m;
        if (["ne", "e", "se"].includes(t)) return c + g - d - i - f * .5
    }
    return i
}

function Om(e) {
    let {
        nextPosition: t,
        prevPosition: o,
        tipY: i,
        workspacePosition: n,
        windowHeight: s,
        hotspotHeight: a,
        tipHeight: l,
        scroller: c,
        zoom: d
    } = e, p = s / d, h = c.scrollTop / d;
    if (o) {
        if (["nw", "n", "ne"].includes(o) && !["nw", "n", "ne"].includes(t)) {
            let u = i - n.top + h;
            return ["w", "c", "e", "sw", "s", "se"].includes(t) ? Om({ ...e,
                prevPosition: void 0,
                tipY: u
            }) : u
        }
        if (["w", "c", "e"].includes(o) && !["w", "c", "e"].includes(t)) {
            let u = i + p * .5 - a * .5 - n.top + h;
            return ["nw", "n", "ne", "sw", "s", "se"].includes(t) ? Om({ ...e,
                prevPosition: void 0,
                tipY: u
            }) : u
        }
        if (["sw", "s", "se"].includes(o) && !["sw", "s", "se"].includes(t)) {
            let u = p - n.top - l - i + h;
            return ["nw", "n", "ne", "w", "c", "e"].includes(t) ? Om({ ...e,
                prevPosition: void 0,
                tipY: u
            }) : u
        }
    } else {
        if (["nw", "n", "ne"].includes(t)) return i + n.top - h;
        if (["w", "c", "e"].includes(t)) return i - p * .5 + a * .5 + n.top - h;
        if (["sw", "s", "se"].includes(t)) return p - n.top - l - i + h
    }
    return i
}
var JW = k(() => {
    "use strict"
});

function jm(e) {
    let {
        nextPosition: t,
        prevPosition: o,
        tipX: i,
        workspacePosition: n,
        windowWidth: s,
        hotspotWidth: a,
        viewportWidth: l,
        tipWidth: c,
        workspaceWidth: d,
        zoom: p,
        scroller: h
    } = e, u = h.scrollLeft / p, m = d - l, f = s / p;
    if (o) {
        if (["nw", "w", "sw"].includes(o) && !["nw", "w", "sw"].includes(t)) {
            let g = i - m * .5 + u;
            return ["n", "c", "s", "ne", "e", "se"].includes(t) ? jm({ ...e,
                prevPosition: void 0,
                tipX: g
            }) : g
        }
        if (["n", "c", "s"].includes(o) && !["n", "c", "s"].includes(t)) {
            let g = i + f * .5 - a * .5 - n.left - m * .5 + u;
            return ["nw", "w", "sw", "ne", "e", "se"].includes(t) ? jm({ ...e,
                prevPosition: void 0,
                tipX: g
            }) : g
        }
        if (["ne", "e", "se"].includes(o) && !["ne", "e", "se"].includes(t)) {
            let y = (d < f ? d - c : f - c) - i - m * .5 + u;
            return ["nw", "w", "sw", "n", "c", "s"].includes(t) ? jm({ ...e,
                prevPosition: void 0,
                tipX: y
            }) : y
        }
    } else {
        if (["nw", "w", "sw"].includes(t)) return i + m * .5 - u;
        if (["n", "c", "s"].includes(t)) return i - f * .5 + a * .5 + n.left + m * .5 - u;
        if (["ne", "e", "se"].includes(t)) return (d < f ? d - c : f - c) - i - m * .5 + u
    }
    return i
}

function Hm(e) {
    let {
        nextPosition: t,
        prevPosition: o,
        tipY: i,
        workspacePosition: n,
        windowHeight: s,
        hotspotHeight: a,
        tipHeight: l,
        scroller: c,
        workspaceTopMargin: d,
        zoom: p
    } = e, h = s / p, u = c.scrollTop / p;
    if (o) {
        if (["nw", "n", "ne"].includes(o) && !["nw", "n", "ne"].includes(t)) {
            let m = i + u;
            return ["w", "c", "e", "sw", "s", "se"].includes(t) ? Hm({ ...e,
                prevPosition: void 0,
                tipY: m
            }) : m
        }
        if (["w", "c", "e"].includes(o) && !["w", "c", "e"].includes(t)) {
            let m = i + h * .5 - a * .5 - n.top + u;
            return ["nw", "n", "ne", "sw", "s", "se"].includes(t) ? Hm({ ...e,
                prevPosition: void 0,
                tipY: m
            }) : m
        }
        if (["sw", "s", "se"].includes(o) && !["sw", "s", "se"].includes(t)) {
            let m = h - d * 2 - l - i + u;
            return ["nw", "n", "ne", "w", "c", "e"].includes(t) ? Hm({ ...e,
                prevPosition: void 0,
                tipY: m
            }) : m
        }
    } else {
        if (["nw", "n", "ne"].includes(t)) return i - u;
        if (["w", "c", "e"].includes(t)) return i - h * .5 + a * .5 + n.top - u;
        if (["sw", "s", "se"].includes(t)) return h - d * 2 - l - i + u
    }
    return i
}
var qW = k(() => {
    "use strict"
});

function sC({
    fixedPosition: e,
    deltaX: t,
    deltaY: o,
    tipX: i,
    tipY: n
}) {
    let s = {
        x: 0,
        y: 0
    };
    return e === "sw" || e === "s" ? (s.x = i + t, s.y = n - o) : e === "se" ? (s.x = i - t, s.y = n - o) : e === "e" || e === "ne" ? (s.x = i - t, s.y = n + o) : (s.x = i + t, s.y = n + o), s
}

function ov(e) {
    let {
        viewportType: t
    } = e;
    if (["default"].includes(t)) return {
        tipX: Wm(e),
        tipY: Om(e)
    };
    if (["phone_portrait", "tablet_portrait"].includes(t)) return {
        tipX: jm(e),
        tipY: Hm(e)
    }
}

function QW(e) {
    let t = {
            w: e.newWidth,
            h: e.newHeight
        },
        o = ["w", "c", "e"].includes(e.fixedPosition),
        i = ["c", "s"].includes(e.fixedPosition);
    if (o) {
        let n = (e.newHeight - e.oldHeight) / 2;
        t.y = e.oldY + n
    }
    if (i) {
        let n = (e.newWidth - e.oldWidth) / 2;
        t.x = e.oldX + n
    }
    return !o && !i && (t.x = e.newX, t.y = e.newY), t
}
var aC = k(() => {
    "use strict";
    JW();
    qW()
});

function eO(e, t) {
    let o = e / Rp;
    if (t) {
        let i = {
                w: t.model.get("w"),
                h: t.model.get("h")
            },
            n = e / i.w,
            s = {
                w: Rp,
                h: t.model.get("h") / o
            };
        return o !== n ? s : i
    } else return null
}
var tO = k(() => {
    "use strict";
    Ep()
});

function iv({
    currentTipSizes: e,
    childWorkspace: t
}) {
    let o = {
            width: Rp,
            height: e.height,
            contentWidth: Rp
        },
        i = t.get_visible_blocks(),
        n = 0,
        s = 0;
    for (let a of i) {
        if (a && a.model.get("type") === "picture") {
            let l = eO(e.width, a),
                c = l ? .w || 0;
            s = Math.max(c, s), n += l ? .h || 0
        }
        if (a && a.model.get("type") === "text") {
            let l = a.model.get("w");
            s = Math.max(l, s), a && a.getRealContentHeight && (n += a.getRealContentHeight(!0, o.width))
        }
    }
    return o.height = n, o.contentWidth = s, o
}
var lC = k(() => {
    "use strict";
    Ht();
    Ep();
    tO()
});

function Nm({
    workspace: e,
    childWorkspace: t,
    currentTipSizes: o,
    tipBox: i
}) {
    let n = window.RM.constructorRouter.zoom.getZoom(),
        s = e.getViewportPosition(),
        a = e.viewport,
        l = e.getWorkspaceBox(),
        c = {
            top: s.top,
            left: s.left,
            width: (s ? .viewportWidth || 1) / n,
            height: (s.height || 1) / n
        },
        d = t ? Number(t.get_visible_blocks().length) : null,
        p = (l.width - Xm[a].width) / 2,
        h = {
            width: 0,
            height: 0,
            contentWidth: 0
        };
    d === null || d > 0 ? o && t ? h = iv({
        currentTipSizes: o,
        childWorkspace: t
    }) : i && (h = {
        width: i.tip_w,
        height: i.tip_h,
        contentWidth: i.tip_w
    }) : (h.width = Gr.WIDTH_OF_BLOCK_WITHOUT_WIDGET / n, h.contentWidth = Gr.WIDTH_OF_BLOCK_WITHOUT_WIDGET / n, h.height = Gr.HEIGHT_OF_BLOCK_WITHOUT_WIDGET / n);
    let u = vo.getHeightOfVisiblePartOfWorkspace({
            viewportTopAndHeight: {
                top: c.top,
                height: c.height
            },
            workspaceHeight: l.height
        }),
        m = 0;
    m = u / 2 - h.height / 2, m = m < 0 ? 0 : m;
    let f = l.height,
        g = {
            tip_x: l.width / 2 - p - h.width / 2,
            tip_y: m,
            tip_w: h.width,
            tip_h: h.height,
            contentWidth: h.contentWidth
        };
    return l.height > g.tip_h ? s.top > 0 && f >= s.top + g.tip_h ? g.tip_y = s.top + g.tip_y : f < s.top + g.tip_h && (g.tip_y = f - g.tip_h) : g.tip_y = l.height / 2 - g.tip_h / 2, g
}
var cC = k(() => {
    "use strict";
    Wo();
    Ep();
    lC();
    Ya()
});

function Il({
    pinBox: e,
    workspace: t,
    scroller: o,
    fixedPosition: i,
    currentTipSizes: n,
    childWorkspace: s,
    tipSizes: a
}) {
    let l = window.RM.constructorRouter.zoom.getZoom(),
        c = t.getViewportPosition(),
        d = t.getWorkspaceBox(),
        p = {
            top: c.top,
            left: c.left,
            width: (c ? .viewportWidth || 1) / l,
            height: (c.height || 1) / l
        },
        h = {
            left: o.scrollLeft / l
        },
        u = s ? Number(s.get_visible_blocks().length) : null,
        m = d.height,
        f = {
            width: 0,
            height: 0,
            contentWidth: 0
        };
    u === null || u > 0 ? n && s ? f = iv({
        currentTipSizes: n,
        childWorkspace: s
    }) : a && (f = {
        width: a.tip_w,
        height: a.tip_h,
        contentWidth: a.tip_w
    }) : (f.width = Gr.WIDTH_OF_BLOCK_WITHOUT_WIDGET / l, f.contentWidth = Gr.WIDTH_OF_BLOCK_WITHOUT_WIDGET / l, f.height = Gr.HEIGHT_OF_BLOCK_WITHOUT_WIDGET / l);
    let g = p.top < 0 ? Math.abs(p.top) : 0,
        y = vo.getHeightOfVisiblePartOfWorkspace({
            viewportTopAndHeight: {
                top: p.top,
                height: p.height
            },
            workspaceHeight: d.height
        }),
        S = 0,
        w = 0;
    if (["nw", "w", "sw"].includes(i)) S = d.width / 2 - f.width / 2, S -= p.left + d.left;
    else if (["n", "c", "s"].includes(i)) {
        let T = p.width - d.width;
        S = -f.width / 2 + e.width / 2, S -= h.left + (T < 0 ? T / 2 : 0)
    } else if (["ne", "e", "se"].includes(i)) {
        let T = p.width - d.width;
        S = d.width / 2 - f.width / 2, S += h.left + (T < 0 ? T : 0)
    }
    if (["nw", "n", "ne"].includes(i)) w = y / 2 - f.height / 2, w = w < 0 ? 0 : w;
    else if (["w", "c", "e"].includes(i)) w = -p.height / 2 + e.height / 2 + d.top + y / 2 - f.height / 2, y / 2 - f.height / 2 < 0 && (w = -(y / 2 - d.top / 2 - e.height / 2));
    else if (["sw", "s", "se"].includes(i)) {
        let T = p.height - d.top * 2 - f.height;
        w = p.height - d.top * 2 - f.height / 2 - y / 2, w > T && (w = T)
    }
    let v = {
            tip_x: S,
            tip_y: w,
            tip_w: f.width,
            tip_h: f.height,
            contentWidth: f.contentWidth
        },
        C = d.top - g,
        I = p.top + d.top;
    if (["nw", "n", "ne"].includes(i)) {
        let T = m - p.top - d.top,
            P = T - v.tip_h < v.tip_y - C;
        v.tip_h < d.height ? P ? v.tip_y = T - v.tip_h : v.tip_y = v.tip_y - C : v.tip_y = d.height / 2 - v.tip_h / 2 - I
    } else if (["w", "c", "e"].includes(i)) {
        let T = m - p.top + e.height / 2 - p.height / 2,
            P = T - v.tip_h < v.tip_y - C;
        if (v.tip_h < d.height) P ? v.tip_y = T - v.tip_h : v.tip_y = v.tip_y - C;
        else {
            let M = v.tip_h - d.height,
                F = -p.height / 2 + d.top + e.height / 2;
            v.tip_y = F - M / 2 - I
        }
    } else if (["sw", "s", "se"].includes(i)) {
        let T = -(m - p.top - (p.height - d.top)),
            P = T > v.tip_y + C;
        if (v.tip_h < d.height) P ? v.tip_y = T : v.tip_y = v.tip_y + C;
        else {
            let M = v.tip_h - d.height,
                F = p.height - d.top * 2;
            v.tip_y = F - v.tip_h + M / 2 + I
        }
    }
    return v
}
var dC = k(() => {
    "use strict";
    Ep();
    Ya();
    lC()
});

function pC({
    pinBox: e,
    tipBox: t,
    deltaBox: o,
    workspace: i
}) {
    let n = i.getViewportPosition(),
        s = window.RM.constructorRouter.zoom.getZoom(),
        a = {
            top: n.top,
            left: n.left,
            width: (n ? .viewportWidth || 1) / s,
            height: (n ? .height || 1) / s
        },
        l = i.getWorkspaceBox(),
        c = vo.getHeightOfVisiblePartOfWorkspace({
            viewportTopAndHeight: {
                top: a.top,
                height: a.height
            },
            workspaceHeight: l.height
        }),
        d = {
            tip_w: t.tip_w,
            tip_h: t.tip_h + o.tip_h,
            tip_x: t.tip_x,
            tip_y: Math.floor(o.tip_y) !== 0 ? t.tip_y + o.tip_y / 2 : t.tip_y + o.tip_y - o.tip_h / 2
        };
    if (t.fixed_position) {
        let p = {
                scrollLeft: i.$container[0].scrollLeft,
                scrollTop: i.$container[0].scrollTop
            },
            h = {
                tip_w: d.tip_w,
                tip_h: d.tip_h
            },
            u = {
                pinBox: e,
                workspace: i,
                scroller: p,
                fixedPosition: t.fixed_position,
                tipSizes: { ...h
                }
            };
        if (["nw", "n", "ne"].includes(t.fixed_position)) d.tip_y < 0 || d.tip_h > c ? l.height > d.tip_h && a.top < l.top ? d.tip_y = 0 : d = Il(u) : d = Il(u);
        else if (["w", "c", "e"].includes(t.fixed_position)) {
            let m = -a.height / 2 + e.height / 2 + l.top;
            d.tip_y < m || d.tip_h > c ? l.height > d.tip_h && a.top < l.top ? d.tip_y = m : d = Il(u) : d = Il(u)
        } else if (["sw", "s", "se"].includes(t.fixed_position)) {
            let m = a.height - l.top * 2;
            m < d.tip_y + d.tip_h || d.tip_h > c ? l.height > d.tip_h && a.top < l.top ? d.tip_y = m - d.tip_h : d = Il({ ...u,
                tipSizes: { ...d
                }
            }) : d = Il({ ...u,
                tipSizes: { ...d
                }
            })
        }
    } else if (d.tip_y < 0 || d.tip_h > c) l.height > d.tip_h && a.top < l.top ? d.tip_y = 0 : d = Nm({
        workspace: i,
        tipBox: { ...d
        }
    });
    else {
        let p = Nm({
            workspace: i,
            tipBox: { ...d
            }
        });
        d.tip_y = p.tip_y
    }
    return d
}
var oO = k(() => {
    "use strict";
    cC();
    dC();
    Ya()
});
var Um, iO, fa, Iie, nO, rO = k(() => {
    "use strict";
    Um = E(Ze()), iO = E(To()), fa = E(ze());
    ag();
    On();
    Ht();
    aC();
    Wo();
    QS();
    wc();
    oO();
    Iie = iO.default.View.extend({
        initialize: function(e = {}) {
            fa.default.bindAll(this), (e.positions || e.positions.length) && (this.block = e.block, this.positions = e.positions, this.workspace_inside_block = e.workspace_inside_block, this.workspace_inside_block.useFreePosition ? (this.setElement(this.workspace_inside_block.$frameborderContainer), this.render(), this.frame = new $t({
                standalone: !0,
                block: {
                    $el: this.$el,
                    $parentElement: this.workspace_inside_block.block.$el.parent(),
                    $workspaceContainer: this.workspace_inside_block.page_workspace.$container,
                    has_parent_block: !0,
                    getModelBox: this.getModelBox,
                    getBoxData: this.getBoxData,
                    onResizeStart: this.onResizeStart,
                    onFrameResize: this.onResize,
                    onResizeEnd: this.onResizeEnd,
                    storeFixedPosition: this.workspace_inside_block.block.storeFixedPosition,
                    restoreFixedPosition: this.workspace_inside_block.block.restoreFixedPosition,
                    isFixed: () => !!this.workspace_inside_block.block.model.get("fixed_position")
                }
            })) : this.render(), this.bind_events(), this.workspace_inside_block.useFreePosition && this.toggleHeightResizing())
        },
        render: function() {
            if (this.workspace_inside_block.useFreePosition) {
                let e = Dp["template-block-frame"];
                this.$el.append(e({
                    has_parent_block: !0
                }))
            } else this.resize_handles_fragment = window.document.createDocumentFragment(), this.positions.forEach(fa.default.bind(function(e) {
                (0, Um.default)("<div/>").addClass("resize-handle").addClass(e).attr("data-pos", e).appendTo(this.resize_handles_fragment)
            }, this)), this.workspace_inside_block.$el.append(this.resize_handles_fragment), this.$resize_handles = this.workspace_inside_block.$el.children(".resize-handle"), this.apply_resize_handles_visual_state()
        },
        apply_resize_handles_visual_state: function() {
            if (this.workspace_inside_block.useFreePosition) return;
            let e = this.workspace_inside_block.block.model.get("tip_pos"),
                t = this.workspace_inside_block.get_visible_blocks();
            if (!t.length) {
                this.$resize_handles.addClass("hidden");
                return
            }
            let o = fa.default.find(t, function(i) {
                return i.model.get("type") === "picture"
            });
            if (this.$resize_handles.removeClass("hidden"), o && o.originalLoaded === !1) this.$resize_handles.addClass("hidden");
            else if (t.length === 1) {
                let n = t[0].model.get("type");
                n === "text" && (this.$resize_handles.filter('[data-pos="bottom"]').addClass("hidden"), this.$resize_handles.filter('[data-pos="top"]').addClass("hidden"))
            }
            e === "top" ? this.$resize_handles.filter('[data-pos="bottom"]').addClass("hidden") : e === "right" ? this.$resize_handles.filter('[data-pos="left"]').addClass("hidden") : e === "bottom" ? this.$resize_handles.filter('[data-pos="top"]').addClass("hidden") : e === "left" && this.$resize_handles.filter('[data-pos="right"]').addClass("hidden")
        },
        bind_events: function() {
            (0, Um.default)(this.$resize_handles).drag("start", this.on_resize_start).drag(this.on_resize).drag("end", this.on_resize_end), this.listenTo(this.workspace_inside_block.block.model, "change:tip_pos", this.apply_resize_handles_visual_state), this.listenTo(this.workspace_inside_block.block.model, "change:tip_box-fullscreen", this.toggleHeightResizing), this.listenTo(this.workspace_inside_block.block.model, "change:wids", this.onInnerWidgetsChanged), this.workspace_inside_block.blocks ? .forEach(e => {
                this.listenTo(e.model, "change:hidden", this.onInnerWidgetsChanged)
            }), this.listenTo(this.workspace_inside_block, "loading_original_picture", this.apply_resize_handles_visual_state)
        },
        on_resize_start: function(e, t) {
            let o = (0, Um.default)(e.currentTarget),
                i = o.data("pos"),
                n = this.workspace_inside_block.get_box_data(),
                s = this.workspace_inside_block.min_width,
                a = this.workspace_inside_block.min_height,
                l = 9999,
                c = 9999,
                d = null,
                p = this.workspace_inside_block.get_visible_blocks();
            t.scrollTop = this.workspace_inside_block.page_workspace.$container.scrollTop();
            let h = fa.default.find(p, function(m) {
                    return m.model.get("type") === "picture"
                }),
                u = fa.default.find(p, function(m) {
                    return m.model.get("type") === "text"
                });
            if (!(u && u.isEditMode)) {
                if ((i === "top" || i === "bottom") && p.length > 1) {
                    u = fa.default.find(p, function(g) {
                        return g.model.get("type") === "text"
                    });
                    let m, f;
                    u && (m = u.getBoxData(), f = m.h, a = f + this.workspace_inside_block.min_height)
                }
                if (h) {
                    h.model.off("change", h.redraw);
                    let m = n,
                        f = h.model.get("scale"),
                        g = {
                            left: m.left_abs + parseInt(h.$el.css("left")) - Math.round(h.model.get("cropX") * f),
                            top: m.top_abs + parseInt(h.$el.css("top")) - Math.round(h.model.get("cropY") * f)
                        };
                    h.initialCrop = g;
                    let y = h.model.get("originalW"),
                        S = h.model.get("originalH");
                    h.frame.constraints = {
                        top: g.top,
                        left: g.left,
                        width: Math.round(y * f),
                        height: Math.round(S * f)
                    }, d = h.frame.constraints
                }
                this.resize_params = {
                    $handle: o,
                    handle_pos: i,
                    box_on_drag_start: n,
                    box_position: this.workspace_inside_block.block.model.get("tip_pos"),
                    min_height: a,
                    min_width: s,
                    max_width: l,
                    max_height: c,
                    constraints: d,
                    visible_blocks: p,
                    max_block_height: this.workspace_inside_block.block.model.get("tip_h"),
                    picture_block: h,
                    picture_initial_crop_on_drag_start: h && fa.default.clone(h.initialCrop),
                    text_block: u
                }
            }
        },
        calculateNewBoxAfterResizeOldWidget: function(e, t, o, i) {
            let n = { ...o
            };
            return ["top", "bottom"].includes(e) ? ["left", "right"].includes(t) ? (n.left += t === "left" ? i.x : -i.x, n.width += t === "left" ? -i.x * 2 : i.x * 2) : ["top", "bottom"].includes(t) && (["top"].includes(t) ? (n.top += i.y, n.height += -i.y) : n.height += i.y) : ["left", "right"].includes(e) && (["top", "bottom"].includes(t) ? (n.top += t === "top" ? i.y : -i.y, n.height += t === "top" ? -i.y * 2 : i.y * 2) : ["left", "right"].includes(t) && (["left"].includes(t) ? (n.left += i.x, n.width += -i.x) : n.width += i.x)), n
        },
        on_resize: function(e, t) {
            let o = this.workspace_inside_block,
                n = this.workspace_inside_block.block.model.get("tip_pos"),
                s = this.resize_params.handle_pos,
                a = fa.default.clone(this.resize_params.box_on_drag_start),
                l = {
                    x: t.deltaX,
                    y: t.deltaY
                },
                c = {
                    top: a.top_rel,
                    left: a.left_rel,
                    width: a.width,
                    height: a.height
                },
                d = this.calculateNewBoxAfterResizeOldWidget(n, s, c, l),
                p = o.get_visible_blocks();
            for (let h of p) {
                let u = h.getBoxData(),
                    m = h.model.get("type"),
                    f = p.find(y => y !== h),
                    g = {
                        left: u.x,
                        top: u.y,
                        width: d.width,
                        height: d.height - (f ? f.getBoxData().h : 0)
                    };
                h.frame.doResize(g, !1), m === "picture" ? (h.$picture && h.$picture.css({
                    top: 0,
                    left: 0,
                    width: g.width,
                    height: g.height
                }), h.$preloader && h.$preloader.css({
                    top: g.height / 2
                })) : m === "text" && h.$el.css({
                    top: f ? f.getBoxData().h : 0,
                    left: g.left,
                    width: g.width,
                    height: g.height
                })
            }
            o.$el.css({
                left: d.left,
                top: d.top,
                width: d.width,
                height: d.height
            })
        },
        on_resize_end: function(e, t) {
            let o = this.resize_params.handle_pos,
                i = fa.default.clone(this.resize_params.box_on_drag_start),
                n = {
                    x: t.deltaX,
                    y: t.deltaY
                },
                s = {
                    top: i.top_rel,
                    left: i.left_rel,
                    width: i.width,
                    height: i.height
                },
                a = this.workspace_inside_block.block,
                l = a.model.get("tip_pos"),
                c = this.workspace_inside_block.page_workspace,
                d = this.calculateNewBoxAfterResizeOldWidget(l, o, s, n),
                p = {
                    tip_w: d.width,
                    tip_h: d.height
                },
                h = [{
                    _id: a.model.get("_id"),
                    ...p
                }];
            this.workspace_inside_block.block.workspace.set_group(h, {
                viewport: this.workspace_inside_block.block.model.getViewport() || "default"
            });
            let u = this.workspace_inside_block.get_visible_blocks();
            for (let m of u) {
                let f = m.getBoxData(),
                    g = m.model.get("type"),
                    y = u.find(w => w !== m),
                    S = {
                        x: f.x,
                        y: f.y,
                        w: p.tip_w,
                        h: p.tip_h - (y ? y.getBoxData().h : 0)
                    };
                if (g === "picture") {
                    let w = `${S.w}:${S.h}!${S.w>S.h?"h":"v"}`,
                        {
                            cropX: v,
                            cropY: C,
                            cropW: I,
                            cropH: T
                        } = $m(m.model.get("originalW"), m.model.get("originalH"), w);
                    S.cropH = T, S.cropW = I, S.cropX = v, S.cropY = C, m.model.set(S, {
                        silent: !0
                    }), m.$picture && (m.$picture.css({
                        top: 0,
                        left: 0,
                        width: S.w,
                        height: S.h
                    }), m.$preloader && m.$preloader.css({
                        top: S.h / 2
                    })), !m.isAnimated() && !m.useLambdaUrl() && m.getFinalImage(P => {
                        P && console.error("w-picture getFinalImage error: ", P)
                    }, {
                        silent: !0,
                        patch: !0
                    })
                }
                h.push({
                    _id: m.model.get("_id"),
                    ...S
                })
            }
            a.workspace.save_group(h, {
                isHotspot: !0,
                viewport: c.viewport || "default"
            })
        },
        show: function() {
            this.workspace_inside_block.useFreePosition ? (this.frame.show(), this.$el.show()) : this.workspace_inside_block.$el.addClass("resize-handles-visible")
        },
        hide: function() {
            this.workspace_inside_block.useFreePosition ? (this.frame.hide(), this.$el.hide()) : this.workspace_inside_block.$el.removeClass("resize-handles-visible")
        },
        getBoxData: function() {
            return {
                h: this.workspace_inside_block.block.model.get("tip_h"),
                w: this.workspace_inside_block.block.model.get("tip_w"),
                x: this.workspace_inside_block.block.model.get("tip_x"),
                y: this.workspace_inside_block.block.model.get("tip_y"),
                angle: 0,
                flip_h: !1,
                flip_v: !1
            }
        },
        tipResizeData: {},
        deltaTipResizeData: {
            prevValue: {}
        },
        onResizeStart: function() {
            if (this.workspace_inside_block.useFreePosition) {
                let e = this.workspace_inside_block.block,
                    t = this.workspace_inside_block.get_visible_blocks();
                e.blockState.tipIsResizing = !0;
                for (let o of t) o.model.get("type") === "picture" && o.updatePicture({
                    load: "url",
                    prepare: n => {
                        n.css({
                            backgroundSize: "cover"
                        })
                    }
                })
            }
        },
        onResize: function(e) {
            if (this.workspace_inside_block.useFreePosition) {
                let t = this.workspace_inside_block.block,
                    o = t.isFullScreenEnabled,
                    i = t.getPositionOfCenteredBlock(),
                    n = {
                        tip_w: t.model.get("tip_w"),
                        tip_h: t.model.get("tip_h"),
                        tip_x: t.model.get("tip_x"),
                        tip_y: t.model.get("tip_y")
                    };
                this.tipResizeData = {
                    tip_w: e.width,
                    tip_h: e.height,
                    tip_x: e.left,
                    tip_y: e.top
                }, this.deltaTipResizeData.prevValue = {
                    tip_x: this.deltaTipResizeData.tip_x,
                    tip_y: this.deltaTipResizeData.tip_y,
                    tip_w: this.deltaTipResizeData.tip_w,
                    tip_h: this.deltaTipResizeData.tip_h
                }, this.deltaTipResizeData.tip_x = this.tipResizeData.tip_x - n.tip_x, this.deltaTipResizeData.tip_y = this.tipResizeData.tip_y - n.tip_y, this.deltaTipResizeData.tip_w = this.tipResizeData.tip_w - n.tip_w, this.deltaTipResizeData.tip_h = this.tipResizeData.tip_h - n.tip_h;
                let s = {
                        top: t.model.get("y"),
                        left: t.model.get("x"),
                        width: t.model.get("w"),
                        height: t.model.get("h")
                    },
                    a = pC({
                        pinBox: s,
                        tipBox: i,
                        deltaBox: this.deltaTipResizeData,
                        workspace: t.workspace
                    }),
                    l = o ? { ...a
                    } : { ...this.tipResizeData
                    };
                t.hotspotWidget.apply_tip_position({ ...t.model.attributes,
                    ...l
                }), t.hotspotWidget.apply_tip_container_size({
                    width: l.tip_w,
                    height: l.tip_h
                });
                let c = this.workspace_inside_block.get_visible_blocks();
                for (let d of c) {
                    let p = d.getBoxData(),
                        h = d.model.get("type"),
                        u = c.find(f => f !== d),
                        m = {
                            left: p.x,
                            top: p.y,
                            width: l.tip_w,
                            height: l.tip_h - (u ? u.getBoxData().h : 0)
                        };
                    d.frame.doResize(m, !1), h === "picture" && (d.$picture && d.$picture.css({
                        top: 0,
                        left: 0,
                        width: m.width,
                        height: m.height,
                        backgroundSize: "cover"
                    }), d.$preloader && d.$preloader.css({
                        top: m.height / 2
                    }))
                }
                t.calculateFullscreenWrapperPosition({ ...l
                }), t.updateConnectionLine()
            }
        },
        onResizeEnd: function() {
            if (this.workspace_inside_block.useFreePosition) {
                let e = this.workspace_inside_block.page_workspace,
                    t = this.workspace_inside_block.block,
                    o = t.model,
                    i = t.isFullScreenEnabled,
                    n = o.get("fixed_position"),
                    s = { ...t.getPositionOfCenteredBlock(),
                        fixed_position: n
                    },
                    a = {
                        top: t.model.get("y"),
                        left: t.model.get("x"),
                        width: t.model.get("w"),
                        height: t.model.get("h")
                    },
                    l = pC({
                        pinBox: a,
                        tipBox: s,
                        deltaBox: this.deltaTipResizeData,
                        workspace: t.workspace
                    }),
                    c = t.workspace,
                    d = c.getWorkspaceBox(),
                    p = t.model.getViewport(),
                    h = c.getViewportPosition(),
                    u = {
                        scrollLeft: c.$container[0].scrollLeft,
                        scrollTop: c.$container[0].scrollTop
                    },
                    m = window.RM.constructorRouter.zoom.getZoom(),
                    f = i ? { ...l
                    } : { ...this.tipResizeData
                    };
                if (n && !i) {
                    let {
                        tipX: S,
                        tipY: w
                    } = ov({
                        tipX: f.tip_x,
                        tipY: f.tip_y,
                        hotspotWidth: o.get("w"),
                        hotspotHeight: o.get("h"),
                        tipWidth: f.tip_w,
                        tipHeight: f.tip_h,
                        viewportWidth: Oe.dictionary[e.viewport].width,
                        viewportLeft: h.left,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight,
                        prevPosition: o.previous("fixed_position"),
                        nextPosition: o.get("fixed_position"),
                        viewportType: p,
                        workspacePosition: e.position,
                        workspaceWidth: d.width,
                        workspaceTopMargin: d.top,
                        zoom: m,
                        scroller: u
                    });
                    f.tip_x = S, f.tip_y = w
                }
                let g = [{
                        _id: t.model.get("_id"),
                        tip_x: f.tip_x,
                        tip_y: f.tip_y,
                        tip_w: f.tip_w,
                        tip_h: f.tip_h
                    }],
                    y = this.workspace_inside_block.get_visible_blocks();
                for (let S of y) {
                    let w = S.getBoxData(),
                        v = S.model.get("type"),
                        C = y.find(T => T !== S),
                        I = {
                            x: w.x,
                            y: w.y,
                            w: f.tip_w,
                            h: f.tip_h - (C ? C.getBoxData().h : 0)
                        };
                    if (v === "picture") {
                        let T = `${I.w}:${I.h}!${I.w>I.h?"h":"v"}`,
                            {
                                cropX: P,
                                cropY: M,
                                cropW: F,
                                cropH: R
                            } = $m(S.model.get("originalW"), S.model.get("originalH"), T);
                        I.cropH = R, I.cropW = F, I.cropX = P, I.cropY = M, S.model.set(I, {
                            silent: !0
                        }), S.$picture && (S.$picture.css({
                            top: 0,
                            left: 0,
                            width: I.w,
                            height: I.h
                        }), S.$preloader && S.$preloader.css({
                            top: I.h / 2
                        })), !S.isAnimated() && !S.useLambdaUrl() && S.getFinalImage(A => {
                            A && console.error("w-picture getFinalImage error: ", A)
                        }, {
                            silent: !0,
                            patch: !0
                        })
                    }
                    g.push({
                        _id: S.model.get("_id"),
                        ...I
                    })
                }
                t.workspace.save_group(g, {
                    isHotspot: !0,
                    viewport: e.viewport || "default"
                }), this.tipResizeData = {}, this.deltaTipResizeData = {}, fa.default.defer(() => {
                    t.blockState.tipIsResizing = !1
                })
            }
        },
        onInnerWidgetsChanged: function() {
            this.workspace_inside_block.useFreePosition ? this.toggleHeightResizing() : this.apply_resize_handles_visual_state()
        },
        toggleHeightResizing: function() {
            let e = this.workspace_inside_block.block,
                t = this.workspace_inside_block.get_visible_blocks(),
                i = (e.model.viewport || "default") === "phone_portrait",
                n = e.model.get("tip_box-fullscreen");
            n == null && (i ? n = !0 : n = !1), t.length > 0 ? (this.$el.removeClass("no-resize-tip"), n ? (this.$el.addClass("no-horizontal-resize"), this.$el.find(".frameborder .dot.lt, .frameborder .dot.rt").attr("data-ind", 1).attr("data-visual-direction", "n"), this.$el.find(".frameborder .dot.lb, .frameborder .dot.rb").attr("data-ind", 5).attr("data-visual-direction", "s")) : this.$el.removeClass("no-horizontal-resize"), t.length === 1 && t[0].model.get("type") === "text" ? (this.$el.addClass("no-vertical-resize"), this.$el.find(".frameborder .dot.lt, .frameborder .dot.lb").attr("data-ind", 7).attr("data-visual-direction", "w"), this.$el.find(".frameborder .dot.rt, .frameborder .dot.rb").attr("data-ind", 3).attr("data-visual-direction", "e")) : (this.$el.removeClass("no-vertical-resize"), this.$el.find(".frameborder .dot.lt").attr("data-ind", 0).attr("data-visual-direction", "nw"), this.$el.find(".frameborder .dot.rt").attr("data-ind", 2).attr("data-visual-direction", "ne"), this.$el.find(".frameborder .dot.lb").attr("data-ind", 6).attr("data-visual-direction", "sw"), this.$el.find(".frameborder .dot.rb").attr("data-ind", 4).attr("data-visual-direction", "se"))) : this.$el.addClass("no-resize-tip")
        },
        getModelBox: function() {
            return {
                height: this.workspace_inside_block.block.model.get("tip_h"),
                width: this.workspace_inside_block.block.model.get("tip_w"),
                left: this.workspace_inside_block.block.model.get("tip_x"),
                top: this.workspace_inside_block.block.model.get("tip_y"),
                angle: 0,
                flip_h: !1,
                flip_v: !1
            }
        },
        destroy: function() {
            this.resize_handles_fragment && (0, Um.default)(this.resize_handles_fragment).remove(), this.stopListening()
        }
    }), nO = Iie
});
var sO, aO = k(() => {
    "use strict";
    no();
    sO = {
        "template-constructor-workspace-inside-block-widget-selector": Ae `

    <div class="widget-selector">

        <div class="widget" data-block-type="picture" data-testid="nested-widget-picture">
	    	<div class="icon"></div>
	        <div class="caption">Image</div>
        </div>


	    <div class="widget" data-block-type="text" data-testid="nested-widget-text">
		    <div class="icon"></div>
		    <div class="caption">Text</div>
	    </div>

    </div>

`
    }
});
var nv, lO, Fc, Pie, cO, dO = k(() => {
    "use strict";
    nv = E(Ze()), lO = E(To()), Fc = E(ze());
    aO();
    wc();
    Or();
    Ep();
    Pie = lO.default.View.extend({
        events: {
            "click .widget": "on_widget_select"
        },
        initialize: function(e) {
            Fc.default.bindAll(this), this.workspace = e.workspace_inside_block, this.model = this.workspace.block.model, this.$container = e.$container || this.workspace.$el, this.template = sO["template-constructor-workspace-inside-block-widget-selector"], this.render(), this.bind_events()
        },
        render: function() {
            this.setElement((0, nv.default)(this.template())), this.$el.appendTo(this.$container), this.updateSelectorStateAndPos()
        },
        bind_events: function() {
            this.listenTo(this.model, "change:tip_pos", this.updateSelectorStateAndPos), this.listenTo(this.model, "change:tip_box-fullscreen", this.changeSelectorOrientation), this.listenTo(this.model, "change:wids", this.onChangeWids), this.listenTo(window.RM.constructorRouter.workspace, "workspace-resize", this.onWorkspaceResize), bt.on("zoom", this.updateSelectorStateAndPos), this.workspace.blocks.forEach(e => {
                e.model.on("change:hidden", this.onChangeHidden)
            })
        },
        onWorkspaceResize: function() {
            this.changeSelectorOrientation()
        },
        changeSelectorOrientation: function() {
            let e = this.workspace.get_visible_blocks(),
                t = !Fc.default.isEmpty(e),
                o = window.RM.constructorRouter.workspace.getWorkspaceBox(),
                n = (this.model.viewport || "default") === "phone_portrait",
                s = this.model.get("tip_box-fullscreen");
            s == null && (n ? s = !0 : s = !1), this.workspace.useFreePosition || (s = !1), o.width < Gr.MIN_WORKSPACE_SIZE_TO_DISPLAY_CONTROL_VERTICALLY && s && t ? this.$el.addClass("horizontal-selector") : this.$el.removeClass("horizontal-selector")
        },
        onChangeHidden: function() {
            this.$el.data("processing", !1), this.updateSelectorStateAndPos()
        },
        onChangeWids: function() {
            this.$el.data("processing", !1), this.workspace.blocks.forEach(e => {
                e.model.on("change:hidden", this.onChangeHidden)
            }), this.updateSelectorStateAndPos()
        },
        updateSelectorStateAndPos: function() {
            let e = this.$(".widget"),
                t = this.workspace.get_visible_blocks(),
                o = !Fc.default.isEmpty(t);
            e.removeClass("enabled"), Fc.default.each(t, Fc.default.bind(function(n) {
                e.filter("[data-block-type=" + n.model.get("type") + "]").addClass("enabled")
            }, this)), this.workspace.$el.toggleClass("no-widgets", !o), this.$el.toggleClass("compact", !!o).toggleClass("right-pos", !!(o && this.model.get("tip_pos") === "left"));
            let i = window.RM.constructorRouter.zoom.getZoom();
            this.$el.css({
                left: o ? "" : this.$el.width() / 2 / i - this.$el.width() / 2
            }), this.changeSelectorOrientation()
        },
        on_widget_select: function(e) {
            if (this.$el.data("processing")) return;
            this.$el.data("processing", !0);
            let t = (0, nv.default)(e.currentTarget),
                o = t.data("block-type"),
                i = Fc.default.filter(this.workspace.blocks, function(n) {
                    return n.model.get("type") === o
                })[0];
            if (i)
                if (i.model.get("hidden")) {
                    let n = i.frame.doResize({
                        left: i.model.get("x"),
                        top: i.model.get("y"),
                        width: this.workspace.get_box_data().width,
                        height: i.model.get("h")
                    }, !1);
                    if (i.model.get("type") === "picture") {
                        let s = n.width,
                            a = i.getBoxData().h,
                            l = {},
                            c = {},
                            d, p = i.model.get("originalW") / i.model.get("originalH");
                        i.model.get("ratio") > p ? (d = s / i.model.get("originalW"), l = {
                            cropX: 0,
                            cropY: Math.round((i.model.get("originalH") - a / d) / 2),
                            cropW: i.model.get("originalW"),
                            cropH: Math.round(a / d)
                        }, c = {
                            width: s,
                            height: Math.round(s / p),
                            top: -Math.round(l.cropY * d),
                            left: 0
                        }) : (d = a / i.model.get("originalH"), l = {
                            cropX: Math.round((i.model.get("originalW") - s / d) / 2),
                            cropY: 0,
                            cropW: Math.round(s / d),
                            cropH: i.model.get("originalH")
                        }, c = {
                            width: Math.round(a * p),
                            height: a,
                            top: 0,
                            left: -Math.round(l.cropX * d)
                        }), i.model.set(Fc.default.extend({
                            w: s,
                            h: a,
                            scale: d.toFixed(15),
                            ratio: (s / a).toFixed(5)
                        }, l), {
                            silent: !0
                        }), i.$picture && i.$picture.css(c)
                    } else if (i.model.get("type") === "text") {
                        let s = 0;
                        i.$el.find(".text-viewer").children().each(function() {
                            s += (0, nv.default)(this).outerHeight()
                        });
                        let a = i.getBoxData();
                        i.frame.doResize({
                            left: a.x,
                            top: a.y,
                            width: a.w,
                            height: s
                        }, !1), i.model.set(i.getBoxData(), {
                            silent: !0
                        })
                    }
                    i.model.save({
                        hidden: !1
                    }, {
                        toHistory: !0
                    }), i.model.get("type") === "picture" && (i.in_constrained_crop_mode = !1, i.enter_constrained_crop_mode())
                } else i.model.save({
                    hidden: !0
                }, {
                    toHistory: !0
                });
            else this.workspace.add_widget({
                type: o,
                w: this.model.get("tip_w"),
                h: o === "picture" ? 180 : o === "text" ? 54 : 400
            }), o === "picture" && this.workspace.$picture_upload_input.trigger("click")
        },
        destroy: function() {
            this.stopListening(this.model, "change:tip_pos", this.updateSelectorStateAndPos), this.stopListening(this.model, "change:tip_box-fullscreen", this.changeSelectorOrientation), this.stopListening(this.model, "change:wids", this.onChangeWids), this.stopListening(window.RM.constructorRouter.workspace, "workspace-resize", this.onWorkspaceResize), this.workspace.blocks.forEach(e => {
                e.model.off("change:hidden", this.onChangeHidden)
            }), this.remove()
        }
    }), cO = Pie
});
var uC, Pl, pO, Ybt, hC, gr, rv = k(() => {
    "use strict";
    uC = E(To()), Pl = E(Ze());
    no();
    Ip();
    ko();
    x1();
    pO = E(ze()), Ybt = (e, {
        width: t,
        height: o
    }) => {
        let {
            r: i,
            g: n,
            b: s
        } = nh(e.color || "ffffff"), a = `linear-gradient(rgba(${i}, ${n}, ${s}, ${1-e.opacity}) 0%, rgba(${i}, ${n}, ${s}, ${1-e.opacity}) 100%)`;
        if (e.selectedType === "picture" && e.picture && ii.useLambdaUrl(e.picture)) {
            let c = `url(${ii.getLambdaUrl(e.picture,{width:t,height:o})}) center center / cover`;
            return e.opacity < 1 ? `${a}, ${c}` : c
        } else {
            if (e.selectedType === "picture" && e.picture) return `url(${e.picture.previewUrl})`;
            if (e.selectedType === "video" && e.video) {
                let c = `url(${Qf(e)}) center center / cover`;
                return e.opacity < 1 ? `${a}, ${c}` : c
            } else return e.selectedType === "slideshow" && e.slideshow && e.slideshow.pictures.length ? `url(${ii.getLambdaUrl(e.slideshow.pictures[0],{width:t,height:o})})` : e.color ? `#${e.color}` : "#ffffff"
        }
    }, hC = class extends uC.default.View {
        constructor({
            page: o,
            mag: i,
            eCommerceManager: n,
            $container: s,
            background: a,
            width: l,
            height: c,
            viewport: d
        }) {
            super();
            _e(this, "page");
            _e(this, "mag");
            _e(this, "eCommerceManager");
            _e(this, "$container");
            _e(this, "distance");
            _e(this, "position", {
                left: 0,
                top: 0
            });
            _e(this, "template", Ae `<div></div>`);
            _e(this, "rendered", !0);
            _e(this, "disableDragging", !0);
            _e(this, "width", 100);
            _e(this, "height", 100);
            _e(this, "blocks", []);
            _e(this, "packs", {});
            _e(this, "$origin", (0, Pl.default)());
            _e(this, "$scroller", (0, Pl.default)());
            _e(this, "$frame", (0, Pl.default)());
            _e(this, "$border", (0, Pl.default)());
            _e(this, "$window", (0, Pl.default)(window));
            _e(this, "loader", (0, Pl.default)());
            _e(this, "$bottomShiftLine", (0, Pl.default)());
            _e(this, "workspaceContainer", document.createElement("div"));
            _e(this, "locked", !1);
            _e(this, "visible", !1);
            _e(this, "spacesController");
            _e(this, "controls");
            _e(this, "pagesize");
            _e(this, "block");
            _e(this, "common_layer");
            _e(this, "bottomBlocksToMove");
            _e(this, "movingBlocks");
            _e(this, "movingDelta");
            _e(this, "isDragActive", !1);
            _e(this, "isBlockMovementActive", !1);
            _e(this, "animationMode", !1);
            _e(this, "cachedSizes");
            _e(this, "animationSteps");
            _e(this, "disableBlocksInteractive");
            _e(this, "disabledSelectMultiple");
            _e(this, "viewport");
            _e(this, "commentsRoot");
            _e(this, "restoreFocusForCopyPasteDebounced");
            _e(this, "getTemplateJSON", (o = {}) => ({}));
            this.page = o, this.mag = i, this.eCommerceManager = n, this.$container = s, this.width = l, this.height = c, this.setElement((0, Pl.default)(this.template()).appendTo(this.$container)), this.$el.css({
                background: a
            }), this.$origin = this.$el, this.$scroller = this.$el.parent(), this.distance = new(uC.default.View.extend({
                hide() {}
            })), this.viewport = d, this.commentsRoot = {
                render() {},
                unmount() {}
            }, this.restoreFocusForCopyPasteDebounced = pO.default.debounce(this.restoreFocusForCopyPaste, 0)
        }
        getBlocksByAbsoluteCoords() {
            return []
        }
        getBlockPositionInWindow() {
            return {
                left: 0,
                top: 0,
                width: 0,
                height: 0
            }
        }
        widgets_in_widgets_deselected() {
            return !1
        }
        canEnterBundleDrag() {
            return !1
        }
        getAllBlocks() {
            return []
        }
        getAllPacks() {
            return []
        }
        getTriggeredBlocks() {
            return []
        }
        getMaxZIndex() {
            return 0
        }
        getDefaultY() {
            return 0
        }
        getCenterX() {
            return 0
        }
        getViewportPosition() {
            return {
                top: 0,
                left: 0,
                height: this.height,
                width: this.width,
                viewportWidth: this.width,
                pageHeight: this.page.get("height")
            }
        }
        getClientSize() {
            return {
                width: this.width,
                height: this.height
            }
        }
        getWorkspaceSize() {
            return {
                width: this.width,
                height: this.height
            }
        }
        getWorkspaceBox() {
            return { ...this.position,
                ...this.getWorkspaceSize()
            }
        }
        redefineSelection() {
            return {
                selected: [],
                deselected: []
            }
        }
        getPackBlocks() {
            return []
        }
        getSelectedBlocks() {
            return []
        }
        getActiveBlocks() {
            return []
        }
        getSelectableBlocks() {
            return []
        }
        getExistingWidgets() {
            return []
        }
        filterBlocks(o) {
            return o
        }
        collectBlocks() {
            return []
        }
        findBlockByFunction(o) {}
        getCachedSizes() {
            return {
                height: this.height,
                width: this.width,
                clientWidth: this.width,
                elHeight: this.height,
                elWidth: this.width,
                windowClientWidth: document.documentElement.clientWidth,
                windowClientHeight: document.documentElement.clientHeight
            }
        }
        getDocumentBox() {
            return {
                left: 0,
                top: 0,
                height: this.height,
                width: this.width
            }
        }
        getOriginBox() {
            return {
                left: 0,
                top: 0,
                height: this.height,
                width: this.width
            }
        }
        getParameters() {
            return {
                workspaceSize: this.getWorkspaceSize(),
                windowSize: this.getClientSize(),
                viewport: this.viewport,
                zoom: 1,
                scroller: this.$scroller[0]
            }
        }
        isBlocksHighlightActive() {
            return !1
        }
        convertX(o) {
            return o
        }
        convertY(o) {
            return o
        }
        getCommentModeState() {
            return !1
        }
        render() {
            return this
        }
        onChangeCommentMode() {}
        setTempPicture() {}
        createNestedBlocks() {}
        deleteCommentsFromBlock() {}
        scaleBlocksGroup() {}
        _enableCommentMode() {}
        _disableCommentMode() {}
        onMouseLeave() {}
        onMouseMove() {}
        updateBlocksHighlight() {}
        getTopmostBlock() {}
        listenToGuides() {}
        stopListeningToGuides() {}
        show() {}
        hide() {}
        onGlobalAppear() {}
        onGlobalDisappear() {}
        renderGlobalBlock() {}
        renderGlobalBlocks() {}
        removeGlobalBlock() {}
        removeGlobalBlocks() {}
        switchOnAnimationMode() {}
        switchOffAnimationMode() {}
        onclick() {}
        onBlockMouseEnter() {}
        onBlockMouseLeave() {}
        onDragStart() {}
        onDrag() {}
        onDragEnd() {}
        checkBundleDragMode() {}
        bindUploader() {}
        getFramePosition() {}
        getFirstSelectableBlock() {}
        getPack() {}
        onResize() {}
        moveSelected() {}
        changeBlocksOpacity() {}
        setViewport() {}
        showUsedViewport() {}
        isViewportEnabled() {}
        suspendAllBlocks() {}
        resumeAllBlocks() {}
        onChangeViewport() {}
        saveViewportScroll() {}
        saveScroll() {}
        restoreViewportScroll() {}
        restoreScroll() {}
        updateWorkspaceViewport() {}
        onWidgetsRemove() {}
        onWidgetsContextChange() {}
        createWidget() {}
        addWidget() {}
        createBlock() {}
        triggerSelectOnSelectedBlock() {}
        renderMissedWidgets() {}
        addBlock() {}
        renderBlock() {}
        removeBlock() {}
        selectAllBlocks() {}
        selectListBlocks() {}
        selectBlocks() {}
        onPackClick() {}
        redrawPacksFrames() {}
        _redrawPacksFrames() {}
        checkOneWidgetPacks() {}
        onSelect() {}
        onDeselect() {}
        restoreFocusForCopyPaste() {}
        preloadBlocks() {}
        deselectBlocksExcept() {}
        save_group() {}
        set_group() {}
        toggleWidgets() {}
        deleteSelectedBlocks() {}
        deleteBlocks() {}
        pasteBlocks() {}
        cloneBlocks() {}
        handleAnimationGroups() {}
        handleAnimationTriggerClone() {}
        onReturnFromPreview() {}
        clearBottomBlocksToMove() {}
        redrawBottomShiftLine() {}
        checkBundleDragAbility() {}
        calcBottomBlocksToMove() {}
        onSpecialKey() {}
        findBlock() {}
        getPageNum() {}
        getPageId() {}
        findPage() {}
        showLoader() {}
        insertLoaderToElem() {}
        hideLoader() {}
        toggleBorder() {}
        toggleBlocksEditParams() {}
        toggleBundleBlocks() {}
        updateLockState() {}
        scrollToTop() {}
        scrollToBottom() {}
        getViewports() {}
        restoreDesktopComposition() {}
        eliminateBlockIntersections() {}
        collapseEmptySpace() {}
        singleColumnLayout() {}
        desktopLayoutFitMobile() {}
        storeAutolayoutBlocks() {}
        destroyAllBlocks() {}
        destroy() {}
    }, gr = hC
});
var Dc, hO, Lo, uO, mC, Tie, mO, fO = k(() => {
    "use strict";
    Dc = E(Ze()), hO = E(To()), Lo = E(ze());
    oo();
    KW();
    qS();
    ZH();
    rO();
    dO();
    Xy();
    oC();
    Zr();
    Ht();
    qg();
    Wt();
    wc();
    rv();
    uO = {
        text: $d,
        picture: qy
    }, mC = { ...XW,
        ...Jy,
        ...B1
    }, Tie = hO.default.View.extend({
        template: mC["template-constructor-workspace-inside-block"],
        fullscreenWrapperTemplate: mC["template-common-hotspot-widget-mobile-wrapper-for-constructor"],
        initialize: function(e) {
            Lo.default.bindAll(this), this.block = e.block, this.isFullScreenEnabled = this.block.isFullScreenEnabled, this.page_workspace = e.page_workspace, this.controls = this.page_workspace.controls, this.mag = this.page_workspace.mag, this.page = this.page_workspace.page, this.blocks = [], this.$container = e.$container, this.useFreePosition = this.block.model.get("flags") ? .tipFreePosition || !1, this.block.child_workspace = this, this.resize_handles_positions = e.resize_handles_positions, this.min_width = e.min_width || 100, this.min_height = e.min_height || 10, this.block.model.widgets_collection.forEach(function(t) {
                this.block.model.get("wids").indexOf(t.get("_id")) > -1 && this.addBlock(t)
            }.bind(this)), this.trigger_select_on_selected_block.__debounced = Lo.default.debounce(this.trigger_select_on_selected_block, 0), this.restoreFocusForCopyPasteDebounced = Lo.default.debounce(this.restoreFocusForCopyPaste, 0), this.saveDebounced = Lo.default.debounce(this.save, 100), this.debouncedSetControls = Lo.default.debounce((t = []) => {
                this.block.workspace.controls.softUpdateControlsForBlocks(t)
            }, 10), this.render(), this.bind_events()
        },
        render: function() {
            this.rendered = !0, this.setElement((0, Dc.default)(this.template())), this.$blocksWrapper = this.$el.find(".blocks-wrapper"), this.$frameborderContainer = this.$el.find(".hotspot-frameborder"), this.block.workspace instanceof gr && this.block.$el.find(".frameborder").hide(), this.$el.addClass("tip");
            let e = mC["template-constructor-helpers-upload-input"];
            this.$picture_upload_input = (0, Dc.default)(e()), this.$picture_upload_input.appendTo(this.$el), this.$fullscreenWrapper = this.$fullscreenWrapper || (0, Dc.default)(this.fullscreenWrapperTemplate()), this.$fullscreenWrapper.css({
                position: "absolute",
                "z-index": -1,
                "transition-property": "none"
            }), this.$fullscreenWrapper.appendTo(this.$el), this.$el.appendTo(this.$container), this.block.apply_tip_container_size({
                width: this.block.model.get("tip_w"),
                height: this.block.model.get("tip_h")
            }), this.block.apply_tip_position(), this.block.apply_tip_bg_color(), this.block.apply_tip_box_shadow(), this.block.apply_tip_box_full_screen(), this.block.apply_tip_border_radius(), this.block.applyTipBorder(), this.blocks.map(this.renderBlock), this.resize_handles_manager = new nO({
                block: this.block,
                workspace_inside_block: this,
                positions: this.resize_handles_positions
            }), this.block.workspace instanceof gr || (this.widget_selector = new cO({
                workspace_inside_block: this,
                container: this.$el
            }))
        },
        bind_events: function() {
            this.listenTo(this, "deselect", this.deselect), this.listenTo(this.block.model, "change:w change:h change:tip_pos", this.block.apply_tip_position), this.listenTo(this.block.model, "change:tip_w change:tip_h", this.on_tip_size_change), this.listenTo(this.block.model, "widget:create", this.createBlock), this.listenTo(this.block.model, "widget:remove", this.removeBlock), this.listenTo(this.block.model, "change:wids", this.onChangeWids), this.listenTo(this.block.model.widgets_collection, "sync", () => {
                this.saveDebounced({}, {
                    skipHistory: !0
                })
            }), this.useFreePosition && this.listenTo(this, "loading_original_picture", this.handleLoadingOriginalPicture), this.blocks.forEach(e => {
                e.model.on("change:hidden", this.onChangeHidden)
            }), this.listenTo(this.page, "change:viewport", this.onChangeViewport), this.useFreePosition ? this.$el.on("dblclick", this.onDblClick) : this.on("select", this.onSelect), this.on("w-text-entered-edit-mode", this.on_text_entered_edit_mode), this.on("w-text-before-leave-edit-mode", this.on_text_leaved_edit_mode), this.on("w-text-leaved-edit-mode", this.onTextAfterLeavedEditMode), this.$el.on("click", this.onClick)
        },
        adjutMaxTipBorderSize: function() {
            let e = this.block.model,
                t = e.get("tip_w") || 0,
                o = e.get("tip_h") || 0,
                i = e.get("tipBorder") || 0,
                n = Math.floor(Math.min(t, o) / 2);
            n < i && e.set({
                tipBorder: n
            })
        },
        onChangeHidden: function() {
            this.adjust_height_to_visible_content(), this.useFreePosition || this.adjust_column_widgets_positioning(), this.blocks.forEach(e => {
                e.model.get("type") === "picture" && (e.model.get("hidden") || e.model.get("hidden") === void 0 ? e.$upload_button && e.$upload_button ? .css("display", "none") : e.$upload_button && e.$upload_button ? .css("display", ""))
            }), this.trigger("w-hotspsot-hidde-block"), this.adjutMaxTipBorderSize(), this.block.apply_tip_position(), this.debouncedSetControls([this.block])
        },
        restoreFocusForCopyPaste: function() {
            (0, Dc.default)(".copyhack").selectText()
        },
        handleLoadingOriginalPicture: function() {
            this.adjust_height_to_visible_content({
                viewports: ["default", "tablet_portrait", "phone_portrait"]
            })
        },
        onChangeWids: function(e, t, o) {
            let i = this.block.blockState.currentViewport !== this.block.model.getViewport() || this.block.blockState.viewportIsChanging;
            if (Xt.isIncomingUpdate(o) || i) return;
            let n = this.block,
                s = ["default", "tablet_portrait", "phone_portrait"];
            s.forEach(a => {
                this.blocks.forEach(function(l) {
                    if (l.model.get("type") === "text" && l.model[`viewport_${a}`]) {
                        let d = {
                            w: n.model[`viewport_${a}`].tip_w,
                            h: l.getRealContentHeight ? l.getRealContentHeight() : l.model.get("h"),
                            styles: l.model.get("styles"),
                            blocksMeta: l.model.get("blocksMeta")
                        };
                        a !== l.model.getViewport() ? (!l.model[`viewport_${a}`] ? .styles || l.model[`viewport_${a}`] ? .styles ? .length === 0) && l.model.save(d, {
                            viewport: a,
                            silent: !0,
                            skipHistory: !0
                        }) : l.model.save({
                            h: d.h
                        }, {
                            viewport: a,
                            silent: !0,
                            skipHistory: !0
                        })
                    }
                }, this)
            }, this), this.adjust_height_to_visible_content({
                viewports: s,
                changeWids: !0
            }), this.useFreePosition || this.adjust_column_widgets_positioning(), n.apply_tip_position(), o.undo || o.redo || (this.block.hotspotWidget.apply_tip_container_size({
                width: this.block.model.get("tip_w"),
                height: this.block.model.get("tip_h")
            }), this.block.model.save({
                wids: this.block.model.get("wids"),
                tip_h: this.block.model.get("tip_h")
            }, {
                patch: !0
            })), this.debouncedSetControls([this.block])
        },
        adjust_height_to_visible_content: function(e) {
            let t = this.block.blockState.currentViewport !== this.block.model.getViewport() || this.block.blockState.viewportIsChanging;
            if (e = e || {}, t && !e.force) return;
            e.force && delete e.force;
            let o = {};
            e.viewports || (e.viewports = [this ? .block ? .model ? .getViewport()]), e ? .viewports ? .forEach(i => {
                let n = this.get_visible_blocks(i),
                    s = 0;
                n.length > 0 && (n.forEach(function(a) {
                    i !== "default" ? s += a ? .model[`viewport_${i}`] ? .h || a.getBoxData().h : s += a ? .model ? .getDefaults() ? .h || a.getBoxData().h
                }), o = {
                    _id: this.block.model.get("_id"),
                    tip_h: s
                }, this.block.model.set(o, {
                    viewport: i,
                    skipHistory: !0
                }))
            }), e.save && this.saveDebounced({}, {
                skipHistory: !0
            })
        },
        adjust_column_widgets_positioning: function() {
            if (this.useFreePosition) return;
            let e = this.get_visible_blocks(),
                t = Lo.default.sortBy(e, function(i) {
                    return i.model.get("type") === "picture" ? 0 : 1
                }),
                o = 0;
            t.forEach(function(i) {
                i.model.set({
                    x: 0,
                    y: o
                }, {
                    skipHistory: !0
                }), o += i.getBoxData().h
            })
        },
        on_tip_size_change: function(e) {
            this.block.apply_tip_container_size({
                width: e.get("tip_w"),
                height: e.get("tip_h")
            }), this.useFreePosition || this.adjust_column_widgets_positioning(), this.block.apply_tip_position()
        },
        on_text_entered_edit_mode: function() {
            this.resize_handles_manager.hide()
        },
        on_text_leaved_edit_mode: function() {
            this.resize_handles_manager.show(), this.fit_text_to_content(!0), this.block.updateTipPosition(), this.block.calculateFullscreenWrapperPosition()
        },
        onTextAfterLeavedEditMode: function() {
            this.block.selected && this.block.workspace.controls.softUpdateControlsForBlocks([this.block]), this.setFocusForTip(!0)
        },
        fit_text_to_content: function(e = !0) {
            if (this.block.blockState.currentViewport !== this.block.model.getViewport() || this.block.blockState.viewportIsChanging) return;
            let o = this.get_visible_blocks(),
                i = Lo.default.find(o, function(a) {
                    return a.model.get("type") === "text"
                });
            if (!i) return;
            let n = i.model.get("h"),
                s = 0;
            s = i.getRealContentHeight(), s = Lo.default.max([s, 10]), n !== s && (i.model.set("h", s, {
                skipHistory: !0
            }), this.adjust_height_to_visible_content({
                save: e
            }))
        },
        createBlock: function(e, t) {
            let o = this.addBlock(e);
            this.useFreePosition ? this.blocks.length === 2 ? [...this.blocks].map(n => {
                !t.undo && !t.redo && !t.group && (n.igonreParentBlockDeselect = !0), this.removeBlock(n.model), n.deselect(n);
                let s = this.addBlock(n.model);
                this.renderBlock(s)
            }) : this.renderBlock(o) : this.renderBlock(o), !t.undo && !t.redo && !t.group && (this.blocks.length > 1 && this.blocks.forEach(i => {
                i.igonreParentBlockDeselect = !0
            }), o.select(), this.blocks.length > 1 && this.blocks.forEach(i => {
                i.igonreParentBlockDeselect = !1
            }), t.copy || this.trigger_select_on_selected_block.__debounced())
        },
        trigger_select_on_selected_block: function() {
            let e = this.getSelectedBlocks();
            !e || !e.length || this.trigger("select", e)
        },
        addBlock: function(e) {
            let t = e.get("type"),
                o = uO[t],
                i = Yh({
                    target: e,
                    viewport: this.block.model.getViewport() || "default",
                    pageId: this.page.id,
                    disposable: !1,
                    minimalViewports: be.canUseMinimalViewport()
                }),
                n = new o(i, this);
            return n.immortal = !0, e.get("type") === "text" ? (n.controls = [], n.edit_controls = Lo.default.without(n.edit_controls, "text_columns")) : e.get("type") === "picture" && (n.initial_controls = ["picture_link"], n.vector_controls = ["picture_link"], n.animated_controls = ["picture_link"]), this.listenTo(n, "all", this.passChildBlockEvent), e.get("type") === "picture" ? this.blocks.unshift(n) : this.blocks.push(n), n.model.on("change:hidden", this.onChangeHidden), n
        },
        passChildBlockEvent: function(e) {
            let t = Array.prototype.slice.call(arguments, 1);
            this.trigger("childBlockEvent", e, t)
        },
        renderBlock: function(e) {
            e.render(), e.model.get("type") === "picture" && e.$upload_button && e.$upload_button ? .appendTo(this.$el), e.redrawPosition(e.model, {
                forceRedraw: !0
            })
        },
        add_widget: function(e, t) {
            e = e || {};
            let o = uO[e.type.toLowerCase()];
            Lo.default.defaults(e, Lo.default.mapObject(rt(o.defaults), function(i) {
                return Lo.default.isFunction(i) ? i() : i
            })), this.block.model.addWidget(e, t)
        },
        removeBlock: function(e) {
            let t = this.findBlock(e.get("_id"));
            this.blocks = Lo.default.without(this.blocks, t), this.stopListening(t), t.model.get("type") === "picture" && t.$upload_button && t.$upload_button.remove(), t.destroy(), t.model.off("change:hidden", this.onChangeHidden), t.model.stopListening()
        },
        onClick: function(e) {
            e.stopPropagation(), !this.block.blockState.tipIsResizing && (this.block.debouncedSetFocusForPin(!1), this.useFreePosition && this.enterEditMode(), !(!(0, Dc.default)(e.target).hasClass("workspace-inside-block") && (0, Dc.default)(e.target).closest(".workspace-inside-block").length) && (!this.page_workspace.controls || this.page_workspace.controls.canControlsBeClosed()) && this.trigger("deselect"))
        },
        getVisiblePictureBlock: function() {
            let e = this.get_visible_blocks();
            return Lo.default.find(e, function(o) {
                return o.model.get("type") === "picture"
            })
        },
        adjustPictureSize: function(e, t = {}) {
            let o = this.getVisiblePictureBlock();
            o && o.model && o.model.set(e, t)
        },
        onChangeViewport: function() {
            let e = this.block ? .model.getViewport() || "default",
                t = this.get_visible_blocks(),
                o = this.block.model.get("tip_h"),
                i = 0;
            this.block.blockState.viewportIsChanging = !0, this.blocks ? .forEach(n => {
                n.model && (n.model.setViewport(e, {
                    save: !1
                }), n.model.set({
                    x: 0
                }, {
                    viewport: e
                }), n.model.save({}, {
                    silent: !0,
                    skipHistory: !0
                }))
            }), t.forEach(n => {
                let s = n.model.get("type");
                i += n.model.get("h"), s === "picture" && n.$picture && n.$picture.css({
                    backgroundSize: "cover"
                })
            }), o !== i && this.adjust_height_to_visible_content({
                force: !0
            }), this.block.debouncedFinishChangingViewport()
        },
        redrawPacksFrames: Lo.default.noop,
        redrawBottomShiftLine: Lo.default.noop,
        onSelect: function() {
            let e = this.getSelectedBlocks(),
                t = Lo.default.find(e, function(o) {
                    return o.model.get("type") === "text"
                });
            t && !t.propsModel.get("isEditMode") && t.enterEditMode()
        },
        deselect: function(e) {
            this.blocks.includes(e) || (this.setFocusForTip(!1), this.block.debouncedSetFocusForPin(!0))
        },
        onDblClick: function(e) {
            if ((0, Dc.default)(e.target).parents(".widget-selector").length) return;
            let t = this.getSelectedBlocks();
            !t.length && this.blocks[0] && (this.blocks[0].select(), t = this.getSelectedBlocks()), this.page_workspace.controls.softUpdateControlsForBlocks(t), this.useFreePosition ? t.length === 1 && t[0].model.get("type") === "text" && t[0].enterEditMode() : t.length === 1 && t[0].model.get("type") === "text" && !t[0].propsModel.get("isEditMode") && t[0].enterEditMode()
        },
        getSelectedBlocks: function() {
            return Lo.default.filter(this.blocks, function(e) {
                return e.selected
            })
        },
        getSelectableBlocks: function() {
            return (0, Lo.default)(this.blocks).filter(function(e) {
                return !e.model.get("hidden") && !e.outofbox
            })
        },
        get_visible_blocks: function(e = null) {
            return e ? Lo.default.filter(this.blocks, function(t) {
                return e !== "default" ? t ? .model[`viewport_${e}`] ? !t ? .model[`viewport_${e}`] ? .hidden : !!this.block ? .model[`viewport_${e}`] : !t ? .model.getDefaults() ? .hidden
            }.bind(this)) : Lo.default.filter(this.blocks, function(t) {
                return !t.model.get("hidden")
            })
        },
        get_visible_proportional_blocks: function() {
            return Lo.default.filter(this.get_visible_blocks(), function(e) {
                return e.proportional
            })
        },
        get_visible_nonproportional_blocks: function() {
            return Lo.default.filter(this.get_visible_blocks(), function(e) {
                return !e.proportional
            })
        },
        getExistingWidgets: function() {
            return (0, Lo.default)(this.blocks).chain().pluck("model").value()
        },
        findBlock: function(e) {
            return Lo.default.find(this.blocks, function(t) {
                return t.model.id === e
            })
        },
        get_box_data: function() {
            let e = this.block.getBoxData({
                    checkFixedPosition: !0
                }),
                t;
            t = this.block.hotspotWidget.apply_tip_position(this.block.model.attributes);
            let o = t.left,
                i = t.top,
                n = e.x + o,
                s = e.y + i;
            return this.block.model.get("fixed_position") && (s += this.block.workspace.$container.scrollTop()), {
                width: this.block.model.get("tip_w"),
                height: this.block.model.get("tip_h"),
                left_rel: o,
                top_rel: i,
                left_abs: n,
                top_abs: s
            }
        },
        onDeselect: function() {
            this.block && this.block.selected && this.block.deselect(), this.block && this.block.propsModel && this.block.propsModel.get("isEditMode") && this.block.leaveEditMode(), this.useFreePosition && this.leaveEditMode()
        },
        save: function(e, t) {
            this.block.model.save(e, t)
        },
        destroy: function() {
            this.useFreePosition && this.leaveEditMode(), this.resize_handles_manager && this.resize_handles_manager.destroy(), this.widget_selector && this.widget_selector.destroy(), this.blocks.forEach(e => {
                e.model.off("change:hidden", this.onChangeHidden)
            }), this.blocks.forEach(function(e) {
                e.destroy()
            }), delete this.blocks, this.off("select w-text-entered-edit-mode w-text-before-leave-edit-mode"), this.remove()
        },
        setFocusForTip: function(e) {
            e && this.block.setFocusForPin(!1), e ? this.enterEditMode() : this.leaveEditMode()
        },
        enterEditMode: function() {
            this.workspaceEditMode = !0, this.resize_handles_manager ? .show()
        },
        leaveEditMode: function() {
            this.workspaceEditMode = !1, this.resize_handles_manager ? .hide()
        }
    }), mO = Tie
});
var fC, Bie, Mie, gC, sv, bC = k(() => {
    "use strict";
    Yd();
    fC = "http://www.w3.org/2000/svg", Bie = 65, Mie = 7, gC = class {
        constructor({
            fromBlock: t,
            toBlock: o,
            cssClass: i,
            $el: n
        }) {
            _e(this, "root");
            _e(this, "curve");
            _e(this, "arrow");
            _e(this, "fromBlock");
            _e(this, "toBlock");
            this.fromBlock = t, this.toBlock = o, this.root = document.createElementNS(fC, "svg"), this.root.setAttributeNS(null, "class", i), this.curve = document.createElementNS(fC, "path"), this.root.appendChild(this.curve), this.arrow = document.createElementNS(fC, "polygon"), this.root.appendChild(this.arrow), n.append(this.root), this.update()
        }
        update() {
            let t = Rt.getBox(this.fromBlock),
                o = Rt.getBox(this.toBlock),
                i = Rt.getBestPoints(t, o),
                n = i.fromPoint,
                s = i.toPoint;
            s = Rt.getPerpendicularEnd(i.toSide, s, o, Mie);
            let a = Rt.getDistance(n, s),
                l = Math.max(a / 2, Bie),
                c = Rt.getPerpendicularEnd(i.fromSide, n, t, l),
                d = Rt.getPerpendicularEnd(i.toSide, s, o, l),
                p = "M" + n.x + " " + n.y + " C " + c.x + " " + c.y + ", " + d.x + " " + d.y + ", " + s.x + " " + s.y;
            this.curve.setAttributeNS(null, "d", p), this.updateArrow(i.toSide, s, o)
        }
        updateArrow(t, o, i) {
            let n = o.x,
                s = o.y,
                a = Math.round((i.angle + Rt.sideAngles[t]) * 180 / Math.PI);
            t === "left" && (n += 1), t === "bottom" && (s -= 1), t === "right" && (n -= 1), t === "top" && (s += 1);
            let l = 9,
                c = 5.5,
                d = n + " " + s + " " + (n - c) + " " + (s - l) + " " + (n + c) + " " + (s - l),
                p = "rotate(" + a + ", " + n + ", " + s + ")";
            this.arrow.setAttributeNS(null, "points", d), this.arrow.setAttributeNS(null, "transform", p)
        }
        remove() {
            this.root.parentNode ? .removeChild(this.root)
        }
    }, sv = gC
});

function gO({
    tipBox: e,
    workspaceBox: t,
    viewportBox: o,
    viewportType: i,
    fixedPosition: n
}) {
    let s = (t.width - Xm[i].width) / 2,
        a = 0,
        l = 0,
        c = 0;
    if (n) {
        let p = vo.getHeightOfVisiblePartOfWorkspace({
            viewportTopAndHeight: {
                top: o.top,
                height: o.height
            },
            workspaceHeight: t.height
        });
        if (c = p, (["nw", "w", "sw"].includes(n) || ["n", "c", "s"].includes(n) || ["ne", "e", "se"].includes(n)) && (a = e.tip_w / 2 - t.width / 2), ["nw", "n", "ne"].includes(n)) o.top < 0 ? l = -e.tip_y - (t.top + o.top) : l = -e.tip_y - t.top;
        else if (["w", "c", "e"].includes(n)) {
            let h = p / 2 - e.tip_h / 2 < 0,
                u = o.top + e.tip_h > t.height;
            t.height > e.tip_h ? (l = -(p / 2 - e.tip_h / 2), h && !u ? l = 0 : u && (l = l * 2)) : (l = (e.tip_h - t.height) / 2, c = t.height)
        } else if (["sw", "s", "se"].includes(n)) {
            let h = p / 2 - e.tip_h / 2 < 0,
                u = o.top + e.tip_h > t.height;
            if (t.height > e.tip_h) {
                if (l = -(p / 2 - e.tip_h / 2), h && !u) l = 0;
                else if (u) {
                    let m = t.height - e.tip_h;
                    l = o.top - m
                }
            } else l = (e.tip_h - t.height) / 2, c = t.height
        }
    } else l = e.tip_y > 0 ? -e.tip_y : Math.abs(e.tip_y), a = e.tip_x > 0 ? -e.tip_x - s : (e.tip_w - t.width) / 2, c = t.height;
    return {
        top: l,
        left: a,
        width: t.width,
        height: c
    }
}
var bO = k(() => {
    "use strict";
    Wo();
    Ya()
});
var Si, zo, po, yC, yO, vO = k(() => {
    "use strict";
    Si = E(Ze()), zo = E(ze());
    Ro();
    I1();
    Wo();
    XH();
    fO();
    yu();
    bC();
    Wt();
    Bh();
    Mt();
    aC();
    wc();
    cC();
    dC();
    En();
    bO();
    Ep();
    qv();
    rv();
    Ht();
    Qy();
    po = {
        hotspot_tip_settings: "hotspot_tip_settings",
        hotspot_pin_settings: "hotspot_pin_settings",
        interactions: "common_interactions",
        common_cursor: "common_cursor",
        common_draggable: "common_draggable",
        common_align: "common_align",
        common_position: "common_position",
        common_layer: "common_layer",
        common_pack: "common_pack",
        common_unpack: "common_unpack",
        common_arrange: "common_arrange",
        my_preset: "my_preset"
    }, yC = me.extend(eg.prototype).extend({
        name: "Hotspot",
        sort_index: 9,
        thumb: "hotspot",
        prevSVGSizes: null,
        icon_color: "#ff8888",
        default_icon_rm_id: "rm44",
        default_icon_noun_url: "/dist/img/constructor/blocks/hotspot/default-collection/44-ellipse.svg",
        dontSaveOnResize: !0,
        viewport_fields: Oe.viewport_fields.hotspot,
        TIP_CONTROLS: [po.hotspot_tip_settings],
        PIN_CONTROLS: [po.hotspot_pin_settings, po.interactions, po.common_cursor, po.common_draggable, po.common_align, po.common_position, po.common_layer],
        initial_controls: [po.hotspot_tip_settings, po.hotspot_pin_settings, po.interactions, po.common_cursor, po.common_draggable, po.common_align, po.common_position, po.common_layer, po.my_preset],
        controlsDividers: [po.hotspot_pin_settings, po.common_draggable],
        groupControlsDividers: [po.common_draggable],
        groupControls: {
            0: po.common_pack,
            1: po.common_unpack,
            2: po.common_align,
            3: po.common_arrange,
            5: po.interactions,
            6: po.common_cursor,
            7: po.common_draggable,
            9: po.common_position,
            10: po.common_layer,
            11: "readymag_preset",
            12: "my_preset"
        },
        settingsOnCreate: !1,
        pinControlPanelState: {
            isOpen: !1,
            isOnClickMode: !1
        },
        $tempMaxZIndexElement: null,
        tipDisplayedProperty: {
            active: !1,
            prevValue: null
        },
        pinFocusProperty: {
            active: !1,
            prevValue: null
        },
        blockState: {
            pinIsDragging: !1,
            tipIsResizing: !1,
            viewportIsChanging: !1,
            currentViewport: void 0
        },
        $pinFrameborder: null,
        rasterizeXhr: {
            default: {},
            tablet_portrait: {},
            phone_portrait: {}
        },
        initialize: function(e, t) {
            let o = t.page.getViewport(),
                n = (e.viewport || "default") === "phone_portrait";
            this.blockState.currentViewport = o, this.mag = t.mag, this._id = e.get("_id"), this.hotspots_group_id = e.get("hotspots_group_id"), this.current_icon_data = null, this.isFullScreenEnabled = e.get("tip_box-fullscreen"), this.useFreePosition = e.get("flags") ? .tipFreePosition || !1, (this.isFullScreenEnabled === null || this.isFullScreenEnabled === void 0) && (n ? this.isFullScreenEnabled = !0 : this.isFullScreenEnabled = !1), this.useFreePosition || (this.isFullScreenEnabled = !1), this.initBlock(e, t), this.initHotspotsCollection(), this.child_workspace = null, this.on_icon_change.__debounced = zo.default.debounce(this.on_icon_change, 20), this.rasterizeOnUndo.__debounced = zo.default.debounce(this.rasterizeOnUndo, 20), this.debouncedSave = zo.default.debounce(() => {
                this.model.save()
            }, 300), this.debouncedToggleTip = zo.default.debounce((s, a) => {
                this.toggleTip(s, a)
            }, 500), this.debouncedFinishChangingViewport = zo.default.debounce(() => {
                this.blockState.viewportIsChanging = !1
            }, 300), this.debouncedCheckOpenedControlsAndUpdateFocus = zo.default.debounce(() => {
                this.checkOpenedControlsAndUpdateFocus()
            }, 10), this.debouncedSetFocusForPin = zo.default.debounce(s => {
                this.setFocusForPin(s)
            }, 50), this.debouncedDeselectActions = zo.default.debounce(() => {
                this.setOpenPinControlPanel(!1), this.setFocusForPin(!0)
            }, 10), this.debouncedOnControlSelect = zo.default.debounce(() => {
                this.onControlSelect()
            }, 20), this.saveDebounced = zo.default.debounce(this.saveModel, 200), this.callRasterOnce = zo.default.once(this.rasterize_icon_SVG)
        },
        saveModel: function(e, t) {
            this.model.save(e, t)
        },
        initHotspotsCollection: function() {
            let e;
            if (this.hotspots_group_id) {
                if (e = `Hotspots_${this.workspace.page.get("_id")}_${this.hotspots_group_id}`, this.useFreePosition && this.model.get("tip_x") === null && this.model.get("tip_y") === null) {
                    let {
                        tip_x: t,
                        tip_y: o
                    } = yC.getDefaultTipPosition({
                        x: this.model.get("x"),
                        y: this.model.get("y"),
                        w: this.model.get("w"),
                        tip_h: this.model.get("tip_h"),
                        tip_w: this.model.get("tip_w")
                    });
                    this.model.save({
                        tip_x: t,
                        tip_y: o
                    }, {
                        skipHistory: !0,
                        silent: !0,
                        patch: !0
                    })
                }
            } else {
                let t = {
                    hotspots_group_id: this._id
                };
                if (t.type = this.model.get("type"), t.bg_color = this.model.get("bg_color"), t.color = this.model.get("color"), t.w = this.model.get("w"), t.h = this.model.get("h"), t.x = this.model.get("x"), t.y = this.model.get("y"), e = `Hotspots_${this.workspace.page.get("_id")}_${this._id}`, this.useFreePosition) {
                    let {
                        tip_x: o,
                        tip_y: i
                    } = yC.getDefaultTipPosition({
                        x: this.model.get("x"),
                        y: this.model.get("y"),
                        w: this.model.get("w"),
                        tip_h: this.model.get("tip_h"),
                        tip_w: this.model.get("tip_w")
                    });
                    t.tip_x = o, t.tip_y = i
                }
                this.model.save(t, {
                    skipHistory: !0,
                    silent: !0,
                    patch: !0
                })
            }
            window.RM.collections[e] = window.RM.collections[e] || new Backbone.Collection, this.hotspots_group_collection = window.RM.collections[e], this.hotspots_group_collection.add(this.model)
        },
        getGroupBlocks: function() {
            return this.workspace.blocks.filter(function(e) {
                return this.hotspots_group_collection.contains(e.model)
            }, this)
        },
        render: function() {
            let e = this.workspace instanceof gr,
                t = this.model.attributes;
            this.create(), this.$el.addClass("hotspot"), this.hotspotWidget = new R1({
                model: t,
                $container: this.$content,
                environment: "constructor",
                mag: this.mag,
                block: this
            }), this.$pinFrameborder = this.$el.children(".frameborder")[0], this.$pinFrameborder = this.$pinFrameborder ? (0, Si.default)(this.$pinFrameborder) : null, this.loadDefaultHotspotIcon(), this.on_icon_change(), this.tip_workspace = new mO({
                $container: this.$(".common-hotspot"),
                block: this,
                page_workspace: this.workspace,
                resize_handles_positions: ["top", "right", "left", "bottom"],
                min_width: 40,
                min_height: 64
            }), e && this.$el.find(".pin") ? .css("cursor", "default"), this.hotspotWidget.apply_tip_position(t), this.bind_model_events(), this.controls = this.initial_controls, this.frame.recalcPointsDirections(), this.listenTo(this.tip_workspace, "childBlockEvent", this.onChildBlockEvent), this.listenTo(this.tip_workspace, "w-text-entered-edit-mode", zo.default.bind(function() {
                this.tip_workspace.$el.addClass("text-edit-mode")
            }, this)), this.listenTo(this.tip_workspace, "w-text-before-leave-edit-mode", zo.default.bind(function() {
                this.tip_workspace.$el.removeClass("text-edit-mode")
            }, this)), this.triggerReady()
        },
        loadDefaultHotspotIcon: function() {
            let e = this.model.get("noun_url"),
                t = this.model.get("rm_id"),
                o = this.model.get("clickNounUrl"),
                i = this.model.get("clickRmId");
            !e && !t && (this.model.set({
                noun_url: this.default_icon_noun_url
            }, {
                silent: !0
            }), this.model.set({
                rm_id: this.default_icon_rm_id
            }, {
                silent: !0
            })), !o && !i && (this.model.set({
                clickNounUrl: this.default_icon_noun_url
            }, {
                silent: !0
            }), this.model.set({
                clickRmId: this.default_icon_rm_id
            }, {
                silent: !0
            }))
        },
        onChildBlockEvent: function(e, t) {
            if (e == "modechanged") {
                let o = t[0];
                this.disableDragging = o, this.$el.toggleClass("no-resize", o)
            }
        },
        setEditingPinInOnClickMode: function(e) {
            this.pinControlPanelState.isOnClickMode = e, this.on_icon_change()
        },
        setOpenPinControlPanel: function(e) {
            let t = !1;
            e !== void 0 ? t = e : t = !this.pinControlPanelState.isOpen, this.pinControlPanelState.isOpen = t, t || this.setEditingPinInOnClickMode(!1)
        },
        getNestedWidgetsJSON: function(e = !1) {
            let t = this.model.widgets_collection && this.model.widgets_collection.toJSON() || [];
            return t = zo.default.filter(t, function(o) {
                return this.model.get("wids").indexOf(o._id) > -1
            }.bind(this)), t.map(function(o) {
                return zo.default.omit(o || {}, "id", "__v", "pid", "parent_wid", e ? "_id" : void 0)
            })
        },
        getIconStyle: function() {
            return !this.current_icon_data || !this.current_icon_data.$svg ? me.prototype.getIconStyle.apply(this, arguments) : {
                "background-image": "",
                "background-color": this.icon_color
            }
        },
        getIconData: function() {
            if (!this.current_icon_data || !this.current_icon_data.$svg) return null;
            let e = this.current_icon_data.$svg.clone();
            return e.attr("fill", "#ffffff").attr("fill-opacity", "1"), {
                $svg: e,
                pinType: this.model.get("pin_type")
            }
        },
        processNounIcon: function(e) {
            let t = (0, Si.default)("<div></div>").append((0, Si.default)(e.svg)).find("svg");
            if (t.length) return t = this.prepareIconSVG(t), {
                $svg: t,
                noun_url: e.noun_url
            }
        },
        getIconSVG: function(e, t, o) {
            if (!e) return;
            let i;
            if (this.icon_XHR && this.icon_XHR.abort(), this.current_icon_data && this.current_icon_data ? .id === e) return o(null, this.current_icon_data);
            let n = function(s) {
                let a = (0, Si.default)("<div></div>").append((0, Si.default)(s.svg)).find("svg");
                if (a.length) return a = this.prepareIconSVG(a), i = {
                    id: e,
                    noun_url: s.new_url,
                    $svg: a
                }, this.current_icon_data = i, o(null, {
                    $svg: a,
                    noun_url: s.new_url
                })
            }.bind(this);
            this.icon_XHR = typeof AbortController < "u" ? new AbortController : void 0, Sn.fetchSvgIcon(e, t, this.icon_XHR ? .signal).then(({
                svg: s,
                new_url: a
            }) => n({
                svg: s,
                new_url: a
            })).catch(s => o(s))
        },
        prepareIconSVG: function(e) {
            let t = e.clone().appendTo((0, Si.default)("body")),
                o = e.clone();
            t.get(0).setAttributeNS(null, "viewBox", "0 0 " + t.width() + " " + t.height());
            let i = t.get(0).getBBox();
            return t.remove(), o.removeAttr("width"), o.removeAttr("height"), o.get(0).setAttributeNS(null, "viewBox", i.x + " " + i.y + " " + i.width + " " + i.height), o.get(0).setAttributeNS(null, "preserveaspect_ratio", "xMidYMid meet"), o.css({
                width: "100%",
                height: "100%"
            }), o
        },
        render_pin_shape: function(e) {
            let o = !(this.workspace instanceof gr) && this.pinControlPanelState.isOnClickMode;
            e = e || {};
            let i = {};
            o && (i.bg_color = this.model.get("clickBgColor") || this.model.get("bg_color"), i.bg_opacity = this.model.get("clickBgOpacity") || this.model.get("bg_opacity"), i.borders = this.model.get("clickBorders") || this.model.get("borders"), i.color = this.model.get("clickColor") || this.model.get("color"), i.opacity = this.model.get("clickOpacity") || this.model.get("opacity"), i.pin_type = this.model.get("clickPinType") || this.model.get("pin_type"));
            let n = this.generateShapeSVG("constructor", this.model, e.w || this.model.get("w"), e.h || this.model.get("h"), e.pin_type, i);
            this.$content.find(".pin").html(n)
        },
        setFocusForPin: function(e) {
            this.workspace instanceof gr || this.useFreePosition && (this.pinFocusProperty.prevValue === null ? this.pinFocusProperty.prevValue = e : this.pinFocusProperty.prevValue = this.pinFocusProperty.active, this.pinFocusProperty.active = e, this.pinFocusProperty.active && this.tip_workspace ? .setFocusForTip(!1), (this.model.get("pinPosRelativeTip") || "behind") === "behind" ? this.tipDisplayedProperty.active ? this.pinFocusProperty.active ? (this.frame.frameVisible && this.frame.showSizes(), this.$pinFrameborder && this.$pinFrameborder.css("display", ""), this.$el.removeClass("hotspot-pin-behind-popup")) : (this.$el.addClass("hotspot-pin-behind-popup"), this.frame.frameVisible && this.frame.hideSizes(), this.$pinFrameborder && this.$pinFrameborder.css("display", "none")) : (this.frame.frameVisible && this.frame.showSizes(), this.$pinFrameborder && this.$pinFrameborder.css("display", ""), this.$el.removeClass("hotspot-pin-behind-popup")) : (this.pinFocusProperty.active ? (this.$pinFrameborder && this.$pinFrameborder.css("display", ""), this.frame.frameVisible && this.frame.showSizes()) : (this.frame.frameVisible && this.frame.hideSizes(), this.$pinFrameborder && this.$pinFrameborder.css("display", "none")), this.$el.removeClass("hotspot-pin-behind-popup")))
        },
        getBoxAfterApplyingDefaultIcon: function() {
            let e = {
                    x: this.model.get("x"),
                    y: this.model.get("y"),
                    w: this.model.get("w"),
                    h: this.model.get("h")
                },
                t = { ...e
                };
            return t.w > t.h ? t.h = t.w : t.w = t.h, t.x = e.x - (t.w - e.w) / 2, t.y = e.y - (t.h - e.h) / 2, this.adjust_box_to_icon()
        },
        getChangesetForHotspotAfterChangingIcon: function(e, t) {
            let o = `viewport_${e}`;
            if (this.model[o]) {
                t === "icon" && this.render_pin_shape({
                    pin_type: "icon"
                });
                let i = [],
                    n = t === "icon" ? this.adjust_box_to_icon(!0) : this.getBoxAfterApplyingDefaultIcon(),
                    s = {
                        w: this.model.get("w"),
                        h: this.model.get("h")
                    },
                    a = {
                        w: s.w / (n.w > n.h ? n.w : n.h),
                        h: s.h / (n.w > n.h ? n.w : n.h)
                    },
                    l = {
                        x: this.model[o].x,
                        y: this.model[o].y,
                        w: this.model[o].w,
                        h: this.model[o].h
                    },
                    c = {
                        x: l.x,
                        y: l.y,
                        w: Math.round(l.w / a.w),
                        h: Math.round(l.h / a.h)
                    };
                c.x += l.w / 2 - c.w / 2, c.y += l.h / 2 - c.h / 2;
                let d = {
                    x: c.x - this.model[o].x,
                    y: c.y - this.model[o].y
                };
                return this.hotspots_group_collection.models.forEach(function(p) {
                    p[o] && i.push(zo.default.extend({
                        _id: p.get("_id")
                    }, c, {
                        x: p[o].x + d.x,
                        y: p[o].y + d.y
                    }))
                }.bind(this)), i
            } else return null
        },
        adjust_box_to_icon: function(e = !1, t = {}) {
            let o = this.$(".pin").find("svg");
            if (!o.length) return;
            let i = o.get(0).getBBox(),
                n = this.getBoxData(),
                s = {
                    width: i.width,
                    height: i.height
                },
                a = {
                    width: n.w,
                    height: n.h
                },
                l = {
                    left: n.x,
                    top: n.y
                },
                c = Ec({
                    iconSizes: s,
                    blockSizes: a,
                    blockPosition: l,
                    prevIconSizes: this.prevSVGSizes ? {
                        width: this.prevSVGSizes.width,
                        height: this.prevSVGSizes.height
                    } : null
                }),
                d;
            return this.saveDebounced(null, {
                silent: !0,
                ...t
            }), e && !t ? .undo && !t ? .redo ? d = c : d = n, d
        },
        abortRasterizeIconSVG: function(e) {
            let t = this.model.get("_id"),
                o = e || this.model.viewport;
            this.rasterizeXhr[o] && this.rasterizeXhr[o][t] && this.rasterizeXhr[o][t].abort()
        },
        getBgColorParamsForIcon: function(e) {
            let t = this.pinControlPanelState.isOnClickMode,
                o = this.model[`viewport_${e}`],
                i = this.model["viewport_default"],
                n = {
                    bgColor: t && o.clickBgColor || o.bg_color,
                    bgOpacity: t && o.clickBgOpacity || o.bg_opacity
                };
            return ["tablet_portrait", "phone_portrait"].includes(e) && (n.bgColor || (n.bgColor = t && i.clickBgColor || i.bg_color), n.bgOpacity || (n.bgOpacity = t && i.clickBgOpacity || i.bg_opacity)), n
        },
        getNormalizedSVG: function(e) {
            let t = e || this.model.viewport || "default",
                o = this.$(".pin").find("svg").clone();
            if (!o.length) return;
            let i = this.getBgColorParamsForIcon(t);
            o.css("fill", `#${i.bgColor}`), o.css("fill-opacity", i.bgOpacity);
            let n = Sn.getNormalizedSvg(o[0]);
            return o.remove(), n
        },
        getPinSvgForTargetViewport: function(e) {
            let t = this.pinControlPanelState.isOnClickMode,
                o = this.model[`viewport_${e}`];
            if (o) {
                let i = {},
                    n = {};
                return t ? (n.bg_color = o.clickBgColor || o.bg_color, n.bg_opacity = o.clickBgOpacity || o.bg_opacity, n.borders = o.clickBorders || o.borders, n.color = o.clickColor || o.color, n.opacity = o.clickOpacity || o.opacity, n.pin_type = o.clickPinType || o.pin_type) : (n.bg_color = o.bg_color, n.bg_opacity = o.bg_opacity, n.borders = o.borders, n.color = o.color, n.opacity = o.opacity, n.pin_type = o.pin_type), i.pin_type = o.pin_type, i.w = o.w, i.h = o.h, (0, Si.default)(this.generateShapeSVG("constructor", this.model, i.w, i.h, i.pin_type, n))
            } else return null
        },
        rasterize_icon_SVG: function(e = {}) {
            let t = e.viewport || this.model.viewport || "default",
                o = this.model[`viewport_${t}`];
            if (!o) return;
            let i = this.$(".pin").find("svg").clone();
            if (!i.length) return;
            let n = this.getBgColorParamsForIcon(t),
                s = this.model.get("_id");
            i.css("fill", `#${n.bgColor}`), i.css("fill-opacity", n.bgOpacity);
            let a = {
                widgets: this.hotspots_group_collection.models,
                svg: i,
                mid: this.workspace.mag.get("_id"),
                viewport: t,
                size: e.size || {
                    width: o.w,
                    height: o.h
                },
                noUnsetUrls: !0,
                ...e
            };
            return this.abortRasterizeIconSVG(t), this.rasterizeXhr[t][s] = Sn.rasterize({ ...a
            }), this.rasterizeXhr[t][s] && this.rasterizeXhr[t][s].always(l => (i.remove(), l)), this.rasterizeXhr[t][s]
        },
        getPeerIds: function() {
            return zo.default.map(this.hotspots_group_collection.models, function(e) {
                return e.get("_id")
            })
        },
        onResizeStart: function() {
            let e = this.model.viewport;
            this.abortRasterizeIconSVG(e), this.useFreePosition && this.restoreFixed ? this.toggleTip(!1) : this.toggleTip(!1, !0)
        },
        onResizeEnd: function(e, t, o = {}) {
            let i = this.workspace instanceof gr;
            this.useFreePosition && this.debouncedToggleTip(!0, !0);
            let n = [],
                s;
            this.hotspots_group_collection.models.forEach(a => {
                let l = a.get("_id"),
                    c = this.workspace.findBlock(l),
                    d = a.get("fixed_position");
                if (c) {
                    let p = c.adjust_box_to_icon(!1, o);
                    s = {
                        width: p.w,
                        height: p.h
                    }, l === this._id ? n.push({
                        _id: l,
                        ...p
                    }) : n.push({
                        _id: l,
                        ...QW({
                            fixedPosition: d,
                            oldWidth: a.get("w"),
                            oldHeight: a.get("h"),
                            newWidth: p.w,
                            newHeight: p.h,
                            oldX: a.get("x"),
                            oldY: a.get("y"),
                            newX: p.x,
                            newY: p.y
                        })
                    })
                }
            }), o.isGroupResize ? this.workspace.set_group(n, o) : this.workspace.saveGroupDebounced(n, o), this.model.get("pin_type") === "icon" && !i && this.rasterize_icon_SVG({
                size: s
            })
        },
        onIndexChange: function() {
            this.selected || me.prototype.onIndexChange.apply(this, arguments)
        },
        getBlockDataWithMaxZIndex: function() {
            let e = this.workspace.getAllBlocks(),
                t = window.RM.constructorRouter.indexController.getZIndex(this.id, this.workspace.page.id, this.workspace.viewport),
                o = !!this.model.get("fixed_position"),
                i = null,
                n = e.reduce((s, a) => {
                    if (!a.has_parent_block && !a.model.get("hidden") && a.model.get("type") !== "background" && (o && a.model.get("fixed_position") || !o && !a.model.get("fixed_position"))) {
                        let l = window.RM.constructorRouter.indexController.getZIndex(a.id, a.workspace.page.id, a.workspace.viewport);
                        if (s < l) return i = a, l
                    }
                    return s
                }, t);
            return i ? {
                block: i,
                zIndex: n
            } : {}
        },
        swapBlocks: function(e, t) {
            let o = (0, Si.default)("<span />").css({
                display: "none"
            });
            o.insertBefore(e), e.insertAfter(t), t.insertAfter(o), o.remove()
        },
        css: function(e = {}, t) {
            if (e.resizeContent && (e.width < this.model.attributes.w || e.height < this.model.attributes.h)) {
                let o = Math.min(e.width / this.model.attributes.w, e.height / this.model.attributes.h);
                this.model.get("borders") && this.model.set("borders", Math.floor(this.model.get("borders") * o) || 1)
            }
            if (this.selected)
                if (this.isFullScreenEnabled) e["z-index"] = this.MAX_Z_INDEX;
                else {
                    let o = this.getBlockDataWithMaxZIndex();
                    o.block && (this.$el.nextAll().is(o.block.$el) && (this.$tempMaxZIndexElement = o.block.$el, this.swapBlocks(this.$el, o.block.$el)), e["z-index"] = o.zIndex)
                }
            else this.$tempMaxZIndexElement && (this.swapBlocks(this.$el, this.$tempMaxZIndexElement), this.$tempMaxZIndexElement = null), e["z-index"] = window.RM.constructorRouter.indexController.getZIndex(this.id, this.workspace.page.id, this.workspace.viewport);
            me.prototype.css.apply(this, [e, t]), e.height !== void 0 && e.width !== void 0 && this.render_pin_shape({
                w: e.width,
                h: e.height
            }), (t || e.isGroupResize) && this.hotspots_group_collection.models.forEach(o => {
                let i = o.get("_id"),
                    n = e.groupedIds && e.groupedIds.indexOf(i) === -1;
                if (this.model.get("_id") !== i && (!e.isGroupResize || n)) {
                    let s = this.workspace.findBlock(i);
                    s && s.css({
                        width: e.width,
                        height: e.height,
                        doNotRedrawPacksFrames: e.doNotRedrawPacksFrames
                    })
                }
            })
        },
        bind_model_events: function() {
            this.model.on("change:tip_background-color change:tip_background-color-opacity", this.apply_tip_bg_color, this), this.model.on("change:tip_border-radius", this.apply_tip_border_radius, this), this.model.on("change:tipBorder change:tipBorderColor change:tipBorderOpacity", this.applyTipBorder, this), this.model.on("change:tip_box-shadow", this.apply_tip_box_shadow, this), this.model.on("change:tip_box-fullscreen", this.apply_tip_box_full_screen, this), this.model.on("change:pinPosRelativeTip", this.applyPinPosRelativeTip), this.model.on(`change:noun_id 
        change:rm_id 
        change:pin_type 
        change:borders
        change:color 
        change:opacity 
        change:bg_color 
        change:bg_opacity
        change:clickRmId
        change:clickNounId
        change:clickPinType
        change:clickColor
        change:clickOpacity
        change:clickBorders
        change:clickBgColor
        change:clickBgOpacity
        `, this.debouncedSetFocusForPin, this), this.model.on(`change:noun_id 
        change:rm_id 
        change:noun_url 
        change:pin_type 
        change:borders
        change:color 
        change:opacity 
        change:bg_color 
        change:bg_opacity
        change:clickRmId
        change:clickNounId
        change:clickPinType
        change:clickColor
        change:clickOpacity
        change:clickBorders
        change:clickBgColor
        change:clickBgOpacity
        change:clickRaster2xUrl
        change:clickRaster3xUrl
        change:clickRasterUrl
        `, this.on_icon_change.__debounced, this), this.model.on(`
        change:noun_id
        change:rm_id 
        change:noun_url 
        change:pin_type 
        change:bg_color 
        change:bg_opacity 
        change:w change:h
        change:clickRmId
        change:clickNounId
        change:clickPinType
        change:clickBgColor
        change:clickBgOpacity
        `, this.rasterizeOnUndo.__debounced, this), this.listenTo(this.workspace, "select", this.onSelect), this.listenTo(this.workspace, "controls-have-been-updated", this.debouncedOnControlSelect), this.listenTo(this.workspace.page, "change:viewport", this.onChangeViewport), this.model.on("change:x change:y change:sticked change:is_full_width change:is_full_height", this.handleChangePinPosition), this.useFreePosition && (this.listenTo(this.workspace, "workspace-resize", this.updateConnectionLine), (0, Si.default)("#main").on("scroll", this.updateConnectionLine), (0, Si.default)("#main").on("scroll", this.updateTipPosition), (0, Si.default)("#main").on("scroll", () => this.calculateFullscreenWrapperPosition()), this.listenTo(this.child_workspace, "w-hotspsot-hidde-block", () => this.calculateFullscreenWrapperPosition()), this.listenTo(this.child_workspace, "w-hotspsot-hidde-block", this.updatePositionOnFullscreenModeAfterHidden), this.child_workspace.$fullscreenWrapper.on("click", this.onClickWrapper), this.listenTo(this.workspace, "workspace-resize", this.updateTipPosition), this.listenTo(this.workspace, "workspace-resize", () => this.calculateFullscreenWrapperPosition()), (0, Si.default)(this.$el).on("dragstart", this.onPinDragStart), (0, Si.default)(this.$el).on("dragend", this.onPinDragEnd), this.on("move resize", this.updateTipOnHotspotUpdate), this.model.on("change:fixed_position", this.onFixedPositionChanged), this.tip_workspace.$el.on("mousedown", this.tipWorkspaceMousedown), this.tip_workspace.$el.on("mouseup", this.tipWorkspaceMouseup), (0, Si.default)(this.tip_workspace.$el).drag("start", this.onMoveTipStart).drag(this.onMoveTip, {
                delay: 100
            }).drag("end", this.onMoveTipEnd), this.model.on("change:x change:y change:tip_x change:tip_y change:sticked change:is_full_width change:is_full_height", this.handleChangeHotspotPosition), jo.on("undo", this.apply_tip_position), jo.on("redo", this.apply_tip_position), jo.on("undo", () => this.calculateFullscreenWrapperPosition()), jo.on("redo", () => this.calculateFullscreenWrapperPosition()), jo.on("redo", this.updateTipPosition), jo.on("undo", this.updateTipPosition))
        },
        rasterizeOnUndo: function(e, t, o) {
            !o.undo && !o.redo || this.model.get("pin_type") === "icon" && this.hotspots_group_collection.at(0) === this.model && (pt("constructor.newHotspotPinControl") ? this.rasterize_icon_SVG({
                noPresave: !0,
                noSaveUrls: !0
            }).then(i => {
                if (i ? .raster2xUrl && i ? .raster3xUrl && i ? .rasterUrl && this.hotspots_group_collection) {
                    let n = this.pinControlPanelState.isOnClickMode,
                        s = this.hotspots_group_collection.map(a => n ? {
                            _id: a.get("_id"),
                            clickRaster2xUrl: i.raster2xUrl,
                            clickRaster3xUrl: i.raster3xUrl,
                            clickRasterUrl: i.rasterUrl
                        } : {
                            _id: a.get("_id"),
                            ...i
                        });
                    this.workspace.set_group(s), this.workspace.save_group(this.hotspots_group_collection)
                }
            }) : this.rasterize_icon_SVG())
        },
        handlePinTypeIcon: function() {
            let t = !(this.workspace instanceof gr) && this.pinControlPanelState.isOnClickMode,
                o = t ? this.model.get("clickNounUrl") || this.model.get("noun_url") : this.model.get("noun_url"),
                i = null,
                n = null;
            t ? (i = this.model.get("clickNounId"), n = this.model.get("clickRmId"), !i && !n && (i = this.model.get("noun_id"), n = this.model.get("rm_id"))) : (i = this.model.get("noun_id"), n = this.model.get("rm_id")), this.getIconSVG(i || n, o, function(s, a) {
                s || !a.$svg || (this.render_pin_shape(), o === this.default_icon_noun_url && (this.workspace instanceof gr || this.callRasterOnce()))
            }.bind(this))
        },
        on_icon_change: function() {
            this.$content.find("svg").get(0) && (this.prevSVGSizes = this.$content.find("svg").get(0).getBBox());
            let t = !(this.workspace instanceof gr) && this.pinControlPanelState.isOnClickMode;
            if (!this.isSelected() && t) return;
            this.model.trigger("editMode", t), this.determine_is_block_proportional();
            let o = t ? this.model.get("clickPinType") || this.model.get("pin_type") : this.model.get("pin_type");
            o === "rectangle" ? this.render_pin_shape({
                pin_type: "rectangle"
            }) : o === "ellipse" ? (this.model.set({
                pin_type: "icon"
            }), this.model.set({
                clickPinType: "icon"
            }), this.handlePinTypeIcon()) : o === "icon" && this.handlePinTypeIcon()
        },
        applyPinPosRelativeTip: function() {
            (this.model.get("pinPosRelativeTip") || "behind") === "behind" ? this.tip_workspace.setFocusForTip(!0): this.debouncedSetFocusForPin(!0)
        },
        checkOpenedControlsAndUpdateFocus: function() {
            let e = !1;
            this.workspace.controls ? .controls.forEach(t => {
                let o = t.propsModel ? .get("controlName"),
                    i = t.propsModel ? .get("selected") || t.selected;
                o || (o = t.name), i && [...this.PIN_CONTROLS].includes(o) && (e = !0)
            }), this.debouncedSetFocusForPin(e), this.tip_workspace.setFocusForTip(!e)
        },
        onChangeControlSelect: function(e = {}) {
            let {
                control: t,
                state: o
            } = e;
            this.debouncedCheckOpenedControlsAndUpdateFocus(), t && t.name === po.hotspot_pin_settings && this.setOpenPinControlPanel(o)
        },
        onSelect: function() {
            this.workspace.getSelectedBlocks().length >= 2 && this.toggleTip(!1), this.debouncedOnControlSelect()
        },
        onControlSelect: function() {
            let e = this.workspace.getSelectedBlocks();
            this.selected && e.length < 2 && this.workspace.controls ? .controls.forEach(t => {
                t.on("selected", this.onChangeControlSelect)
            })
        },
        onDblClick: function() {
            this.useFreePosition && this.model.get("pack_id") && this.selected && this.tip_workspace.workspaceEditMode || me.prototype.onDblClick.apply(this, arguments)
        },
        apply_tip_bg_color: function() {
            this.hotspotWidget.apply_tip_bg_color(this.model.attributes)
        },
        apply_tip_border_radius: function() {
            this.hotspotWidget.apply_tip_border_radius(this.model.attributes)
        },
        applyTipBorder: function() {
            this.hotspotWidget.applyTipBorder(this.model.attributes)
        },
        apply_tip_box_shadow: function() {
            this.hotspotWidget.apply_tip_box_shadow(this.model.attributes)
        },
        apply_tip_box_full_screen: function() {
            let t = (this.model.viewport || "default") === "phone_portrait",
                o = this.useFreePosition,
                i = this.model.get("tip_box-fullscreen");
            i == null && (t ? i = !0 : i = !1), this.isFullScreenEnabled = i, i ? this.tipDisplayedProperty.active && this.$el.addClass("hotspot-fullscreen-enabled") : this.$el.removeClass("hotspot-fullscreen-enabled"), o || (this.isFullScreenEnabled = !1), this.delayedSwitchToFullscreenMode()
        },
        determine_is_block_proportional: function() {
            this.proportional = !1
        },
        apply_tip_container_size: function(e) {
            if (this.child_workspace.get_visible_blocks() ? .length === 0) {
                let o = this.getCurrentTipSizes();
                this.hotspotWidget.apply_tip_container_size(o)
            } else this.hotspotWidget.apply_tip_container_size(e)
        },
        apply_tip_position: function() {
            let e = this.model.attributes;
            this.hotspotWidget && (this.hotspotWidget.apply_tip_position(e), this.useFreePosition && setTimeout(() => {
                this.updateConnectionLine()
            }, 0))
        },
        clone: function() {
            this.useFreePosition && this.destroyConnectionLine(), me.prototype.clone.apply(this, arguments), this.useFreePosition && !this.isLocked() && this.$cloneEl && this.$cloneEl.find(".workspace-inside-block").remove()
        },
        select: function() {
            this.useFreePosition && this.apply_tip_position(), me.prototype.select.apply(this, arguments)
        },
        handleChangePinPosition: function() {
            zo.default.defer(() => {
                this.blockState.tipIsResizing || this.debouncedSetFocusForPin(!0)
            })
        },
        handleChangeHotspotPosition: function() {
            this.apply_tip_position(), this.isFullScreenEnabled && (this.tipDisplayedProperty.active || !this.tipDisplayedProperty.active && this.tipDisplayedProperty.prevValue === !0) && (this.updateTipPosition(), this.calculateFullscreenWrapperPosition())
        },
        onWorkspaceBlocksSelect: function(e) {
            if (me.prototype.onWorkspaceBlocksSelect.apply(this, arguments), !this.rendered) return;
            let t = e && e.length == 1 && e[0] == this;
            !window.RM.constructorRouter.isPageLocked(this.model.get("pid")) && t && (this.useFreePosition && (this.isFullScreenEnabled || this.createConnectionLine()), this.toggleTip(t))
        },
        deselect: function(e) {
            e !== this && (me.prototype.deselect.apply(this, arguments), this.toggleTip(!1), this.tipDisplayedProperty.prevValue = null, this.debouncedDeselectActions())
        },
        toggleTip: function(e, t = !1) {
            let o = this.workspace instanceof gr,
                i = this.isFullScreenEnabled,
                n = this.child_workspace.get_visible_blocks();
            if (!o) {
                if (!this.selected) {
                    this.tipDisplayedProperty.active = !1, this.tipDisplayedProperty.prevValue = null, this.destroyConnectionLine(), this.tip_workspace.$fullscreenWrapper.toggleClass("invisible", !0), this.$el.removeClass("hotspot-fullscreen-enabled"), this.$(".tip").css("visibility", "hidden"), this.css();
                    return
                }(!t || n.length === 0 || t && this.tipDisplayedProperty.prevValue !== null && this.tipDisplayedProperty.prevValue === e) && (this.tipDisplayedProperty.prevValue = this.tipDisplayedProperty.active, this.tipDisplayedProperty.active = !!e, this.calculateFullscreenWrapperPosition(), i && this.tip_workspace && this.tip_workspace.$fullscreenWrapper && this.tip_workspace.$fullscreenWrapper.toggleClass("invisible", !e), this.$(".tip").css("visibility", e ? "inherit" : "hidden"), this.css(), this.useFreePosition || this.tip_workspace && this.tip_workspace.resize_handles_manager && (this.tipDisplayedProperty.active ? this.tip_workspace.resize_handles_manager.show() : this.tip_workspace.resize_handles_manager.hide()), i ? (this.destroyConnectionLine(), this.tipDisplayedProperty.active && this.model.get("tip_box-fullscreen") === void 0 && this.useFreePosition && (this.model.set({
                    "tip_box-fullscreen": !0
                }, {
                    silent: !0
                }), this.switchToFullscreenMode()), e ? this.$el.addClass("hotspot-fullscreen-enabled") : this.$el.removeClass("hotspot-fullscreen-enabled")) : (this.tipDisplayedProperty.active ? this.useFreePosition && this.createConnectionLine() : this.destroyConnectionLine(), this.$el.removeClass("hotspot-fullscreen-enabled")))
            }
        },
        createConnectionLine: function() {
            this.workspace instanceof gr || !this.hotspotConnectionLine && this ? .$el && this ? .tip_workspace ? .$el && (this.hotspotConnectionLine = new sv({
                $el: this.$el,
                fromBlock: this,
                toBlock: this.tip_workspace.$el,
                cssClass: "animation-trigger-line"
            }))
        },
        updateConnectionLine: function() {
            this.useFreePosition && this.hotspotConnectionLine && this.hotspotConnectionLine.update()
        },
        destroyConnectionLine: function() {
            this.hotspotConnectionLine && this.hotspotConnectionLine.remove(), this.hotspotConnectionLine = null
        },
        updateTipOnHotspotUpdate: function(e) {
            this.useFreePosition && this.tip_workspace.workspaceEditMode && this.tip_workspace.setFocusForTip(!1), this.useFreePosition && (this.hotspotWidget.apply_tip_position({ ...this.model.attributes,
                x: e.left,
                y: e.top
            }), this.toggleTip(!1, !0), this.blockState.pinIsDragging || this.debouncedToggleTip(!0, !0))
        },
        tipWorkspaceMousedown: function() {
            this.disableDragging = !0, this.tip_workspace.enterEditMode()
        },
        tipWorkspaceMouseup: function() {
            this.disableDragging = !1
        },
        onPinDragStart: function() {
            this.toggleTip(!1, !0), this.blockState.pinIsDragging = !0
        },
        onPinDragEnd: function() {
            this.toggleTip(!0, !0), this.blockState.pinIsDragging = !1
        },
        onMoveTipStart: function(e, t) {
            this.isFullScreenEnabled || (t.scrollTop = this.workspace.$container.scrollTop(), this.debouncedSetFocusForPin(!1))
        },
        onMoveTip: function(e, t) {
            if (!this.isFullScreenEnabled) {
                let i = window.RM.constructorRouter.zoom.getZoom(),
                    n = t.startY + t.scrollTop,
                    s = e.pageY + this.workspace.$container.scrollTop(),
                    a = t.deltaX / i,
                    l = (s - n) / i,
                    {
                        x: c,
                        y: d
                    } = sC({
                        fixedPosition: this.model.get("fixed_position"),
                        tipX: this.model.get("tip_x"),
                        tipY: this.model.get("tip_y"),
                        deltaX: a,
                        deltaY: l
                    });
                t.resultX = c, t.resultY = d, this.hotspotWidget.apply_tip_position({ ...this.model.attributes,
                    tip_x: t.resultX,
                    tip_y: t.resultY
                }), this.updateConnectionLine(), be.autoWindowScroll(e, this.workspace.$container, this.onDragMove(e, t))
            }
        },
        onMoveTipEnd: function(e, t) {
            if (!this.isFullScreenEnabled) {
                this.checkOpenedControlsAndUpdateFocus();
                let i = {
                    tip_x: t.resultX,
                    tip_y: t.resultY
                };
                this.model.save(i, {
                    silent: !0,
                    patch: !0
                })
            }
        },
        onClickWrapper: function() {
            this.tipDisplayedProperty.active && (this.deselect(), this.workspace.trigger("deselect"))
        },
        calculateFullscreenWrapperPosition: function(e = null) {
            if (this.isFullScreenEnabled && this.tipDisplayedProperty.active) {
                let o = this.child_workspace.$fullscreenWrapper,
                    i = this.model,
                    n = this.workspace,
                    s = e || this.getPositionOfCenteredBlock(),
                    a = window.RM.constructorRouter.zoom.getZoom(),
                    l = i.getViewport(),
                    c = n.getWorkspaceBox(),
                    d = n.getViewportPosition(),
                    p = i.get("fixed_position"),
                    h = this.useFreePosition,
                    u = i.get("tip_pos"),
                    m = {
                        top: d.top,
                        left: d.left,
                        width: (d ? .viewportWidth || 1) / a,
                        height: (d ? .height || 1) / a
                    },
                    f = {
                        left: i.get("x"),
                        top: i.get("y"),
                        width: i.get("w"),
                        height: i.get("h")
                    },
                    g = gO({
                        pinBox: f,
                        tipBox: s,
                        workspaceBox: c,
                        viewportBox: m,
                        viewportType: l,
                        useFreePosition: h,
                        tipPosition: u,
                        fixedPosition: p
                    });
                o.css({ ...g
                })
            }
        },
        getPositionOfCenteredBlock: function() {
            let e = this.model,
                t = this.workspace,
                o = this.child_workspace,
                i = e.get("fixed_position"),
                n = this.useFreePosition,
                s = e ? .get("tip_pos"),
                a = {
                    left: e ? .get("x"),
                    top: e ? .get("y"),
                    width: e ? .get("w"),
                    height: e ? .get("h")
                },
                l = {
                    width: e.get("tip_w"),
                    height: e.get("tip_h")
                },
                c = {};
            return i ? c = Il({
                pinBox: a,
                workspace: t,
                fixedPosition: i,
                useFreePosition: n,
                tipPosition: s,
                currentTipSizes: l,
                childWorkspace: o,
                scroller: {
                    scrollLeft: t.$container[0].scrollLeft,
                    scrollTop: t.$container[0].scrollTop
                }
            }) : c = Nm({
                workspace: t,
                childWorkspace: o,
                currentTipSizes: l
            }), c
        },
        delayedSwitchToFullscreenMode: function() {
            setTimeout(() => {
                this.switchToFullscreenMode()
            }, 1)
        },
        getCurrentTipSizes: function() {
            let e = window.RM.constructorRouter.zoom.getZoom(),
                t = this.child_workspace.get_visible_blocks();
            return {
                width: t.length > 0 ? this.model.get("tip_w") : Gr.WIDTH_OF_BLOCK_WITHOUT_WIDGET / e,
                height: t.length > 0 ? this.model.get("tip_h") : Gr.HEIGHT_OF_BLOCK_WITHOUT_WIDGET / e
            }
        },
        switchToFullscreenMode: function(e) {
            let t = this.model.get("tip_box-fullscreen") === void 0 || !this.tipDisplayedProperty.active,
                o = this.isFullScreenEnabled;
            if (!t || e) {
                if (o) {
                    let i = this.getPositionOfCenteredBlock(),
                        n = {
                            tip_x: this.model.get("tip_x"),
                            tip_y: this.model.get("tip_y"),
                            tip_w: this.model.get("tip_w"),
                            tip_h: this.model.get("tip_h")
                        },
                        s = {
                            tip_x: i.tip_x,
                            tip_y: i.tip_y,
                            tip_w: i.tip_w,
                            tip_h: i.tip_h,
                            contentWidth: i.contentWidth
                        },
                        a = this.child_workspace.get_visible_blocks(),
                        l = 1 / 0;
                    for (let c of a) {
                        let d = c ? .model ? .get("w") || 0;
                        l = Math.min(d, l)
                    }(n.tip_h !== s.tip_h || n.tip_w !== s.tip_w || n.tip_w !== s.contentWidth || l !== s.tip_w) && this ? .tip_workspace ? .resize_handles_manager && (this.tip_workspace.resize_handles_manager.onResizeStart(), this.tip_workspace.resize_handles_manager.onResize({
                        width: s.tip_w,
                        height: s.tip_h,
                        left: s.tip_x,
                        top: s.tip_y
                    }), this.tip_workspace.resize_handles_manager.onResizeEnd()), this.calculateFullscreenWrapperPosition()
                }
                this.updateTipPosition(), this.tip_workspace ? .$fullscreenWrapper && this.tip_workspace.$fullscreenWrapper.toggleClass("invisible", !(o && this.tipDisplayedProperty.active)), o ? this.destroyConnectionLine() : this.tipDisplayedProperty.active ? this.useFreePosition && this.createConnectionLine() : this.destroyConnectionLine()
            }
        },
        updateTipPosition: function() {
            let e = this.isFullScreenEnabled;
            if (!this.blockState.tipIsResizing)
                if (e) {
                    let t = this.getPositionOfCenteredBlock(),
                        o = {
                            tip_x: this.model.get("tip_x"),
                            tip_y: this.model.get("tip_y"),
                            tip_w: this.model.get("tip_w"),
                            tip_h: this.model.get("tip_h")
                        },
                        i = {
                            tip_x: t.tip_x,
                            tip_y: t.tip_y,
                            tip_w: t.tip_w,
                            tip_h: t.tip_h
                        };
                    (o.tip_x !== i.tip_x || o.tip_y !== i.tip_y || o.tip_h !== i.tip_h || o.tip_w !== i.tip_w) && this.model.set(i, {
                        skipHistory: !0,
                        silent: !0
                    }), this.hotspotWidget.apply_tip_position({ ...this.model.attributes,
                        tip_x: t.tip_x,
                        tip_y: t.tip_y
                    }), this.hotspotWidget.apply_tip_container_size({
                        width: t.tip_w,
                        height: t.tip_h
                    })
                } else {
                    let t = this.getCurrentTipSizes();
                    this ? .hotspotWidget ? .apply_tip_position({ ...this.model.attributes
                    }), this.hotspotWidget.apply_tip_container_size(t)
                }
        },
        updatePositionOnFullscreenModeAfterHidden: function() {
            let e = this.isFullScreenEnabled;
            if (!this.blockState.tipIsResizing && (this.updateTipPosition(), e)) {
                let t = this.getPositionOfCenteredBlock(),
                    o = this.child_workspace.get_visible_blocks();
                if (o.length === 1) {
                    let i = o[0],
                        n = i.getBoxData(),
                        s = o.find(l => l !== i),
                        a = {
                            x: n.x,
                            y: n.y,
                            w: t.tip_w,
                            h: t.tip_h - (s ? s.getBoxData().h : 0)
                        };
                    i.model.set({ ...a
                    })
                }
            }
        },
        destroy: function() {
            this.stopListening(this.tip_workspace), this.tip_workspace && this.tip_workspace.destroy(), this.hotspotWidget && this.hotspotWidget.destroy(), this.hotspotWidget = null, this.useFreePosition && this.destroyConnectionLine();
            let e = this.model.viewport;
            this.abortRasterizeIconSVG(e), this.icon_XHR && this.icon_XHR.abort(), this.model.off(null, null, this), this.tip_workspace && this.tip_workspace.$el && (this.tip_workspace.$el.off("mousedown", this.tipWorkspaceMousedown), this.tip_workspace.$el.off("mouseup", this.tipWorkspaceMouseup)), this.stopListening(this.workspace, "select", this.onSelect), this.stopListening(this.workspace, "controls-have-been-updated", this.onControlSelect), this.stopListening(this.workspace.page, "change:viewport", this.onChangeViewport), this.model.off("change:x change:y change:sticked change:is_full_width change:is_full_height", this.handleChangePinPosition), this.useFreePosition && (this.stopListening(this.workspace, "workspace-resize", this.updateConnectionLine), (0, Si.default)("#main").off("scroll", this.updateConnectionLine), (0, Si.default)("#main").off("scroll", this.updateTipPosition), (0, Si.default)("#main").off("scroll", () => this.calculateFullscreenWrapperPosition()), this.stopListening(this.child_workspace, "w-hotspsot-hidde-block", () => this.calculateFullscreenWrapperPosition()), this.stopListening(this.child_workspace, "w-hotspsot-hidde-block", this.updatePositionOnFullscreenModeAfterHidden), this.child_workspace.$fullscreenWrapper.off("click", this.onClickWrapper), this.stopListening(this.workspace, "workspace-resize", this.updateTipPosition), this.stopListening(this.workspace, "workspace-resize", () => this.calculateFullscreenWrapperPosition()), (0, Si.default)(this.$el).off("dragstart", this.onPinDragStart), (0, Si.default)(this.$el).off("dragend", this.onPinDragEnd), this.off("move resize", this.updateTipOnHotspotUpdate), this.model.off("change:fixed_position", this.onFixedPositionChanged), jo.off("undo", this.apply_tip_position), jo.off("redo", this.apply_tip_position), jo.off("undo", () => this.calculateFullscreenWrapperPosition()), jo.off("redo", () => this.calculateFullscreenWrapperPosition()), jo.off("redo", this.updateTipPosition), jo.off("undo", this.updateTipPosition), this.model.off("change:x change:y change:tip_x change:tip_y change:sticked change:is_full_width change:is_full_height", this.handleChangeHotspotPosition)), this.hotspots_group_collection && this.hotspots_group_collection.remove(this.model), me.prototype.destroy.apply(this, arguments)
        },
        onClick: function(e) {
            this.useFreePosition && (0, Si.default)(e.target).parents(".pin").length && (this.debouncedSetFocusForPin(!0), this.tipDisplayedProperty.active ? this.pinFocusProperty.active ? (this.toggleTip(!1), this.tipDisplayedProperty.prevValue = null) : (this.tip_workspace.getSelectedBlocks().forEach(o => {
                o.leaveEditMode && o ? .leaveEditMode()
            }), zo.default.defer(function() {
                this.workspace.controls.softUpdateControlsForBlocks([this])
            }.bind(this))) : (this.tipDisplayedProperty.prevValue = null, this.toggleTip(!0))), me.prototype.onClick.apply(this, arguments)
        },
        moveTip: function(e) {
            if (!this.isFullScreenEnabled) {
                let {
                    x: t,
                    y: o
                } = sC({
                    fixedPosition: this.model.get("fixed_position"),
                    tipX: this.model.get("tip_x"),
                    tipY: this.model.get("tip_y"),
                    deltaX: e.deltaX,
                    deltaY: e.deltaY
                }), i = {
                    tip_x: t,
                    tip_y: o
                };
                this.hotspotWidget.apply_tip_position({ ...this.model.attributes,
                    ...i
                }), this.updateConnectionLine(), this.model.set(i), this.debouncedSave()
            }
        },
        onChangeViewport: function(e) {
            this.blockState.currentViewport = e.get("viewport") || this.block.model.getViewport();
            let t = this.model.viewport || "default",
                o = t === "default",
                i = t === "phone_portrait",
                n = this.model.get("tip_box-fullscreen");
            if (n == null && (i ? n = !0 : n = !1), this.useFreePosition || (n = !1), !o && this.model.get("tip_show_on") === "hover") {
                let s = this.hotspots_group_collection.map(a => ({
                    _id: a.get("_id"),
                    tip_show_on: "click"
                }));
                this.workspace.set_group(s), this.workspace.save_group(this.hotspots_group_collection)
            }
            this.isFullScreenEnabled = n, this.debouncedFinishChangingViewport()
        },
        onFixedPositionChanged: function() {
            let e = this.isFullScreenEnabled,
                t = this.workspace,
                o = this.workspace.getWorkspaceBox(),
                i = this.model.getViewport(),
                n = this.workspace.getViewportPosition(),
                s = {
                    scrollLeft: t.$container[0].scrollLeft,
                    scrollTop: t.$container[0].scrollTop
                },
                a = window.RM.constructorRouter.zoom.getZoom();
            if (!(i !== this.blockState.currentViewport))
                if (!e && !this.blockState.tipIsResizing) {
                    let {
                        tipX: c,
                        tipY: d
                    } = ov({
                        tipX: this.model.get("tip_x"),
                        tipY: this.model.get("tip_y"),
                        hotspotWidth: this.model.get("w"),
                        hotspotHeight: this.model.get("h"),
                        tipWidth: this.model.get("tip_w"),
                        tipHeight: this.model.get("tip_h"),
                        viewportWidth: Oe.dictionary[this.workspace.viewport].width,
                        viewportLeft: n.left,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight,
                        nextPosition: this.model.get("fixed_position"),
                        prevPosition: this.model.previous("fixed_position"),
                        viewportType: i,
                        workspacePosition: this.workspace.position,
                        workspaceWidth: o.width,
                        workspaceTopMargin: o.top,
                        zoom: a,
                        scroller: s
                    });
                    this.model.set({
                        tip_x: c,
                        tip_y: d
                    }, {
                        silent: !0
                    }), this.apply_tip_position()
                } else e && this.updateTipPosition()
        }
    }, {
        getDefaultTipPosition({
            x: e,
            y: t,
            w: o,
            tip_h: i,
            tip_w: n
        }) {
            return {
                tip_y: t - i - de.hotspot.tipGap,
                tip_x: e - n / 2 + o / 2
            }
        },
        filterSetAttributes(e) {
            let t = ["angle", "flip_v", "flip_h"],
                o = "viewport_phone_portrait",
                i = "viewport_tablet_portrait";
            return zo.default.intersection(Object.keys(e), t).length > 0 ? zo.default.omit(e, t) : e[o] && zo.default.intersection(Object.keys(e[o]), t).length > 0 ? (e[o] = zo.default.omit(e[o], t), e) : (e[i] && zo.default.intersection(Object.keys(e[i]), t).length > 0 && (e[i] = zo.default.omit(e[i], t)), e)
        },
        defaults: { ...M1
        }
    }), yO = yC
});
var wC, Bn, Rie, Eie, Fie, Die, vC, Aie, Lie, wO, xO = k(() => {
    "use strict";
    wC = E(Ze()), Bn = E(ze());
    On();
    Ro();
    Wo();
    KH();
    yr();
    jr();
    Yt();
    Wt();
    Mt();
    Rie = 48, Eie = 20, Fie = 286, Die = 200, vC = [{
        tp: "name",
        caption: "Name",
        optional: !1,
        sort: 0
    }, {
        tp: "email",
        caption: "Email",
        optional: !1,
        sort: 1
    }], Aie = me.extend({
        name: "Form",
        sort_index: 10,
        thumb: "form",
        icon_color: "#7232B4",
        DEFAULT_HORIZONTAL_SIZE: 40,
        DEFAULT_VERTICAL_SIZE: 300,
        MIN_FONT_SIZE: de.minFontSize,
        MAX_FONT_SIZE: 999,
        MIN_LETTER_SPACING: -99,
        MAX_LETTER_SPACING: 999,
        form_controls: ["form_styles", "form_content", "form_endpoints", "form_captcha", "common_rotation"],
        controls: ["common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["common_rotation", "common_shadow"],
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            6: "common_interactions",
            7: "common_cursor",
            8: "common_draggable",
            9: "common_shadow",
            10: "common_position",
            11: "common_layer",
            12: "readymag_preset",
            13: "my_preset"
        },
        initialize: function(e, t) {
            this.mag = t.mag, this.controls = Bn.default.union(this.form_controls, this.controls), this.frameClass = Lie, this.initBlock(e, t), this.saveThrottled = Bn.default.throttle(this.model.save.bind(this.model), 700, {
                leading: !1
            })
        },
        render: function() {
            this.create(), this.$el.addClass("form"), this.formWidget = new E1({
                data: this.model.attributes,
                environment: "constructor",
                $container: this.$content
            }), this.formWidget.render(), this.minimalDimensions = this.formWidget.getMinimalDimensions(), this.triggerReady()
        },
        getIconStyle: function(e = {}) {
            let t = {},
                o = "./constructor/widgetbar/icons/";
            if (e.small && this.icon_color) return t["background-color"] = this.icon_color, t;
            let i = G(`${o}form.svg`);
            return t["background-image"] = `url(${i})`, t["border-radius"] = "0", t
        },
        onCreate: function() {
            this.openContentControl()
        },
        bindEvents: function() {
            me.prototype.bindEvents.apply(this, arguments), this.$el.on("click", ".js-add-line", this.onAddLineClick), this.$el.on("click", ".js-remove-line", this.onRemoveLineClick)
        },
        getResizedStyles: function(e, t = 1) {
            let o = {};
            if (!e) return o;
            let i = this.model.get(e);
            if (!i) return o;
            if (i.gutter && (o.gutter = Math.floor(i.gutter * t) || 1), i["border-width"] && i["border-width"] !== "inherit" && (o["border-width"] = Math.floor(i["border-width"] * t) || 1), i["font-size"] && i["font-size"] !== "inherit") {
                let n = Math.floor(i["font-size"] * t) || 1;
                o["font-size"] = n, i["letter-spacing"] && i["letter-spacing"] !== "inherit" && (o["letter-spacing"] = Zs({
                    letterSpacing: i["letter-spacing"],
                    fontSize: i["font-size"],
                    newFontSize: n
                }))
            }
            return o
        },
        resizeFormStyles: function(e) {
            let t = `style-${this.model.get("style")}`,
                o = {},
                i = `${t}-fields`,
                n = this.getResizedStyles(i, e);
            Bn.default.isEmpty(n) || (o[i] = { ...this.model.get(i),
                ...n
            });
            let s = `${t}-button-default`,
                a = this.getResizedStyles(s, e);
            Bn.default.isEmpty(a) || (o[s] = { ...this.model.get(s),
                ...a
            });
            let l = `${t}-button-hover`,
                c = this.getResizedStyles(l, e);
            Bn.default.isEmpty(c) || (o[l] = { ...this.model.get(l),
                ...c
            }), Bn.default.isEmpty(o) || this.model.set(o)
        },
        scaleContent: function(e) {
            if (e.width < this.model.attributes.w || e.height < this.model.attributes.h) {
                let t = Math.min(e.width / this.model.attributes.w, e.height / this.model.attributes.h);
                this.resizeFormStyles(t)
            }
        },
        css: function(e = {}) {
            me.prototype.css.apply(this, arguments), (e.height != null || e.width != null) && this.formWidget.recalcStyles({
                h: e.height,
                w: e.width
            })
        },
        validate: function() {
            let e = Bn.default.difference(Oe.viewport_fields.form, Oe.viewport_fields_common);
            this.model.fillMissingFieldsFromDefaultViewport(e)
        },
        redraw: function(e, t) {
            if (t = t || {}, !this.checkNeedRedraw(e)) return;
            let o = t.undo || t.redo;
            this.validate();
            let i, n, s = this.model.get("layout"),
                a = this.model.get("style"),
                l = this.model.get("style-" + a + "-fields").gutter,
                c = this.model.changedAttributes(),
                d = this.model.previousAttributes(),
                p, h, u = s == "vertical" ? "h" : "w";
            o || c.layout && c.layout !== d.layout ? this.formWidget.render({
                force: !0
            }) : c.fields ? (p = c.fields.length - d.fields.length, h = this.formWidget.getRowsCount(c.fields) - this.formWidget.getRowsCount(d.fields), i = (0, wC.default)(this.formWidget.$(".input-wrapper").get(0)), s == "vertical" ? n = i.height() : n = i.width(), Bn.default.defer(function() {
                let m = (n + l) * p;
                !p && h && (m = h * this.formWidget.getLineHeight().input), this.model.set(u, this.model.get(u) + m), this.formWidget.render()
            }.bind(this))) : this.formWidget.recalcStyles(), this.minimalDimensions = this.formWidget.getMinimalDimensions(), me.prototype.redraw.apply(this, arguments)
        },
        onDblClick: function() {
            this.selected && (!this.model.get("pack_id") || this.workspace.getSelectedBlocks().length === 1 ? this.openContentControl() : me.prototype.onDblClick.apply(this, arguments))
        },
        onAddLineClick: function(e) {
            this.addOrRemoveLine(e, !0)
        },
        onRemoveLineClick: function(e) {
            this.addOrRemoveLine(e, !1)
        },
        addOrRemoveLine: function(e, t) {
            let n = (0, wC.default)(e.target).closest(".js-input-wrapper").find(".js-input").data("sort"),
                s = this.model.get("fields"),
                a = Bn.default.find(s, {
                    sort: n
                });
            if (a) {
                let l = a.rows || 1;
                t ? l = l + 1 : l = l > 1 ? l - 1 : 1, this.changeField({
                    sort: n
                }, {
                    rows: l
                })
            }
            this.trigger("resize"), this.saveThrottled()
        },
        openContentControl: function() {
            let e = this.workspace && this.workspace.controls,
                t = e && e.findControl("form_content");
            t && t.master.select(t)
        },
        setButtonHoverState: function() {
            this.formWidget.setButtonHoverState()
        },
        unsetButtonHoverState: function() {
            this.formWidget.unsetButtonHoverState()
        },
        toggleInputValue: function(e) {
            e ? this.formWidget.showInputPlaceholdersAsValues(!0) : this.formWidget.render()
        },
        getMinimalDimensions: function() {
            return this.minimalDimensions
        },
        getDefaultDimensions: function() {
            let e = this.getMinimalDimensions(),
                t = this.model.attributes,
                o = t["style-" + t.style + "-fields"],
                i = t["style-" + t.style + "-button-default"],
                n = this.model.get("fields");
            return this.model.get("layout") == "vertical" ? {
                width: this.DEFAULT_VERTICAL_SIZE,
                height: e.height
            } : {
                width: (n.length + 1) * Die + n.length * o.gutter + i.gutter,
                height: this.DEFAULT_HORIZONTAL_SIZE
            }
        },
        changeField: function(e, t) {
            let o = Bn.default.clone(this.model.get("fields")),
                i = Bn.default.findIndex(o, e),
                n = o[i],
                s = {};
            Bn.default.each(t, function(a, l) {
                s[l] = Bn.default.clone(n[l])
            }), n = Bn.default.extend(Bn.default.clone(n), t), n.items === null && delete n.items, o[i] = n, this.model.set("fields", o), Bn.default.each(t, function(a, l) {
                this.model.trigger("field:" + l + ":change", n, s[l])
            }.bind(this)), this.model.trigger("field:change", n)
        },
        canBeUsed: function() {
            return RM.constructorRouter.me.get("permissions").can_use_forms
        },
        deselect: function() {
            this.selected && !this.canBeUsed() && RM.constructorRouter.trigger("notice:hide"), me.prototype.deselect.apply(this, arguments)
        },
        select: function() {
            !this.selected && !this.canBeUsed() && RM.constructorRouter.trigger("notice:show", be.isSubscriptionPaused() ? "unpauseSubscriptionToUse" : "upgradeAccountToUse"), me.prototype.select.apply(this, arguments)
        }
    }, {
        defaults: {
            layout: "vertical",
            style: "colored",
            "button-caption": "Text",
            button_caption_after_submit: "",
            submit_mode: "textAfterSubmit",
            link_after_submit: null,
            fields: JSON.parse(JSON.stringify(vC)),
            h: Rie * (vC.length + 1) + Eie * vC.length,
            w: Fie,
            x: "center",
            "style-colored-fields": {
                gutter: 20,
                color: "f7f7f7",
                opacity: 100,
                "border-radius": 0,
                "border-width": 0,
                "border-color": "000000",
                "border-opacity": 100,
                "font-family": "Roboto",
                "font-style": "normal",
                "font-weight": 400,
                "text-color": "000000",
                "text-opacity": 100,
                "font-size": 18,
                "letter-spacing": 0,
                "text-align": "left",
                direction: "ltr"
            },
            "style-colored-button-default": {
                gutter: 0,
                color: "4c4c4c",
                opacity: 100,
                "border-radius": "inherit",
                "border-width": 0,
                "border-color": "000000",
                "border-opacity": 100,
                "font-family": "inherit",
                "font-style": "inherit",
                "font-weight": "inherit",
                "text-color": "ffffff",
                "text-opacity": 100,
                "font-size": "inherit",
                "letter-spacing": "inherit",
                "text-align": "center"
            },
            "style-colored-button-hover": {
                color: "inherit",
                opacity: 90,
                "border-width": "inherit",
                "border-color": "inherit",
                "border-opacity": "inherit",
                "text-color": "inherit",
                "text-opacity": "inherit",
                "text-align": "center",
                transition: !1
            },
            "style-outlined-fields": {
                gutter: 20,
                color: "ffffff",
                opacity: 0,
                "border-radius": 0,
                "border-width": 1,
                "border-color": "e5e5e5",
                "border-opacity": 100,
                "font-family": "Roboto",
                "font-style": "normal",
                "font-weight": 400,
                "text-color": "000000",
                "text-opacity": 100,
                "font-size": 18,
                "letter-spacing": 0,
                "text-align": "left",
                direction: "ltr"
            },
            "style-outlined-button-default": {
                gutter: 0,
                color: "e8e8e8",
                opacity: 60,
                "border-radius": "inherit",
                "border-width": 0,
                "border-color": "000000",
                "border-opacity": 100,
                "font-family": "inherit",
                "font-style": "inherit",
                "font-weight": "inherit",
                "text-color": "000000",
                "text-opacity": 60,
                "font-size": "inherit",
                "letter-spacing": "inherit",
                "text-align": "center"
            },
            "style-outlined-button-hover": {
                color: "inherit",
                opacity: 90,
                "border-width": "inherit",
                "border-color": "inherit",
                "border-opacity": "inherit",
                "text-color": "inherit",
                "text-opacity": 80,
                "text-align": "center",
                transition: !1
            },
            "style-underlined-fields": {
                gutter: 20,
                "underline-width": 1,
                "underline-color": "000000",
                "underline-opacity": 100,
                "font-family": "Roboto",
                "font-style": "normal",
                "font-weight": 400,
                "text-color": "000000",
                "text-opacity": 100,
                "font-size": 18,
                "letter-spacing": 0,
                "text-align": "left",
                direction: "ltr"
            },
            "style-underlined-button-default": {
                gutter: 0,
                color: "000000",
                opacity: 100,
                "border-radius": 0,
                "border-width": 0,
                "border-color": "000000",
                "border-opacity": 100,
                "font-family": "inherit",
                "font-style": "inherit",
                "font-weight": "inherit",
                "text-color": "ffffff",
                "text-opacity": 100,
                "font-size": "inherit",
                "letter-spacing": "inherit",
                "text-align": "center"
            },
            "style-underlined-button-hover": {
                color: "inherit",
                opacity: 80,
                "border-width": "inherit",
                "border-color": "inherit",
                "border-opacity": "inherit",
                "text-color": "inherit",
                "text-opacity": "inherit",
                "text-align": "center",
                transition: !1
            }
        }
    }), Lie = $t.extend({
        applyExtraConstraints: function(e) {
            let t = this.block.getMinimalDimensions();
            return e.height < t.height && (e.height = t.height), e.width < t.width && (e.width = t.width), e
        }
    }), wO = Aie
});
var _O, xC, zie, SO, CO = k(() => {
    "use strict";
    _O = E(ze());
    tv();
    T1();
    Mt();
    yr();
    jr();
    mS();
    Ht();
    xC = "f4f4f4", zie = Zi.extend({
        name: "Cart",
        title: "E-comm",
        blockName: "ecommercecart",
        sort_index: 11,
        thumb: "cart-button",
        individualStyleKeys: ["background-color", "background-color-opacity", "border-radius", "border-width", "border-color", "border-color-opacity", "font-family", "font-style", "font-weight", "color", "color-opacity", "font-size", "letter-spacing", "hover-background-color", "hover-background-color-opacity", "hover-border-width", "hover-border-radius", "hover-border-color", "hover-border-color-opacity", "hover-color", "hover-color-opacity", "hover-font-family", "hover-font-size", "hover-tansition-duration"],
        getBlockCreateParams(e) {
            return e.eCommerceManager && e.eCommerceManager.isCartWidgetExist ? {
                name: "Add to cart",
                title: "E-comm",
                blockName: "addtocart",
                thumb: "addtocart-button"
            } : {
                name: "Cart",
                title: "E-comm",
                blockName: "ecommercecart",
                thumb: "cart-button"
            }
        },
        icon_color: "#446E00",
        frameColor: "#0080FF",
        settingsOnCreate: !0,
        onCreate: function() {
            this.workspace.controls.selectFirst(), this.setWidgetGlobal()
        },
        setWidgetGlobal() {
            let e = this.workspace.getSelectedBlocks(),
                {
                    result: t
                } = Im(!0, e, this.workspace);
            this.workspace.set_group(t), window.RM.constructorRouter.indexController.updateIndex(this.workspace.page, e.map(s => s.model), !1);
            let o = [...e].map(s => s.model),
                i = this.workspace.viewport;
            this.workspace.save_group(o, {
                viewport: "default"
            });
            let n = window.RM.constructorRouter.indexController.getPagesToSave();
            this.workspace.syncManager.saveGroup(n, {
                patch: !0,
                silent: !0
            }), i !== "default" && o.forEach(s => {
                s.setViewport(i)
            })
        },
        initial_controls: ["cart_connections", "cart_add_product_widget", "cart_settings", "button_edit", "icon_settings", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer"],
        controlsDividers: function(e) {
            let t = [],
                o = e.workspace.eCommerceManager ? .getConnectedProvider();
            return t.push(o ? "cart_add_product_widget" : "cart_connections"), t.push(["icon_settings", "common_shadow"]), t
        },
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            6: "common_interactions",
            7: "common_cursor",
            8: "common_draggable",
            9: "common_shadow",
            10: "common_position"
        },
        DEFAULT_BACKGROUND_COLOR: xC,
        animationTriggerLine: null,
        getIconStyle: function(e = {}) {
            let t = {};
            return e.small && this.icon_color ? (t["background-color"] = this.icon_color, t) : (t["background-image"] = `url(${G(`./constructor/widgetbar/icons/${this.thumb}.svg`)})`, t)
        },
        initialize: function() {
            Zi.prototype.initialize.apply(this, arguments), this.workspace.eCommerceManager.setCartWidgetExistState(!0)
        },
        render: function() {
            let e, t = _O.default.clone(this.model.attributes),
                o = t.tp;
            this.create(), this.$el.addClass("button"), e = {
                model: t,
                $container: this.$content,
                environment: "constructor",
                mag: this.mag,
                block: this
            }, this.buttonWidget = new tg(e), this.$button = this.$(".common-button"), this.$textInput = this.$button.children(".text"), this.$buttonIcon = this.$button.children(".icon"), (o === "icon" || o === "text_and_icon") && this.getIconSVG(this.model.get("icon_noun_id") || this.model.get("icon_rm_id"), this.model.get("icon_noun_url"), function(i, n) {
                i || !n.$svg || (this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG()
                }), this.model.get("icon_rasterUrl") || this.rasterizeSVG({
                    default: !0,
                    hover: !0,
                    current: !0
                }))
            }.bind(this)), this.recalcButtonSize(), this.disableTextInput(), this.handleSelectionColor(), this.bindDOMEvents(), this.bindModelEvents(), this.controls = this.initial_controls, this.frame.recalcPointsDirections(), this.triggerReady()
        },
        deselect: function(e) {
            e !== this && this.selected && (this.validateWidgets(), Zi.prototype.deselect.apply(this, arguments))
        },
        destroy: function() {
            this.stopListeningForUpdateTrigger(), Zi.prototype.destroy.apply(this, arguments)
        },
        validateWidgets: function() {
            this.workspace.eCommerceManager.getInvalidAddToCartWidgets(this.workspace.mag.getAllWidgets()).length ? RM.constructorRouter.trigger("notice:show", "ecommHasInvalidAddToCartWidget", {
                canBeClosed: !0
            }) : RM.constructorRouter.trigger("notice:hide", "ecommHasInvalidAddToCartWidget")
        },
        onDragStart: function(e, t) {
            if (e.altKey || t.isClone) return !1;
            Zi.prototype.onDragStart.apply(this, arguments)
        },
        startListeningForUpdateTrigger: function(e) {
            this.animationTriggerLine = e, this.listenTo(this, "move resize", this.updateAnimationTrigger.bind(this))
        },
        stopListeningForUpdateTrigger: function() {
            this.updateAnimationTrigger && (this.stopListening(this, "move resize", this.updateAnimationTrigger), this.animationTriggerLine = null)
        },
        updateAnimationTrigger: function() {
            window.requestAnimationFrame(this.recalcAnimationTrigger.bind(this))
        },
        recalcAnimationTrigger: function() {
            this.animationTriggerLine && this.animationTriggerLine.update()
        }
    }, {
        yOffsetOnCreate: -80,
        defaults: {
            tp: "text",
            form: "rectangle",
            text: "Cart",
            w: 168,
            h: 50,
            hidden: !1,
            x: "center",
            text_w: 48,
            text_h: 26,
            em_w: 16,
            "background-color": xC,
            "background-color-opacity": 100,
            "border-radius": 4,
            "border-width": 0,
            "border-color": "000000",
            "border-color-opacity": 100,
            "font-family": "Arial",
            "font-style": "normal",
            "font-weight": 400,
            color: "282828",
            "color-opacity": 100,
            "font-size": 18,
            "letter-spacing": 0,
            "hover-background-color": xC,
            "hover-background-color-opacity": 80,
            "hover-border-width": 0,
            "hover-border-color": "000000",
            "hover-border-color-opacity": 100,
            "hover-border-radius": 4,
            "hover-color": "282828",
            "hover-color-opacity": 100,
            "hover-tansition-duration": 0,
            "hover-cursor": "pointer",
            icon_enabled: !1,
            icon_h: 18,
            icon_w: 18,
            icon_pos: "left",
            icon_noun_id: null,
            icon_rm_id: null,
            icon_noun_url: null,
            icon_color: "ffffff",
            icon_color_opacity: 100,
            "hover-icon_color": "ffffff",
            "hover-icon_color_opacity": 100,
            icon_rasterUrl: null,
            icon_raster2xUrl: null,
            "hover-icon_rasterUrl": null,
            "hover-icon_raster2xUrl": null,
            "bar-color": "ffffff",
            "bar-color-opacity": 100,
            "bar-background-color": "1a1a1a",
            "bar-background-color-opacity": 100,
            "bar-shadow": !1,
            "bar-auto-open": !1,
            "bar-font-family": "Arial",
            "bar-font-style": "normal",
            "bar-font-weight": 400,
            "bar-font-size-factor": 1,
            "bar-button-baseline": 0,
            "bar-letter-spacing": "inherit",
            "bar-title": de.defaultSidebarTexts.title,
            "bar-empty\u0421artTitle": de.defaultSidebarTexts.empty\ u0421artTitle,
            "bar-price": de.defaultSidebarTexts.price,
            "bar-quantity": de.defaultSidebarTexts.quantity,
            "bar-checkout": de.defaultSidebarTexts.checkout,
            "stripe-allow_promotion_codes": !1,
            "stripe-allowed_countries": [],
            "stripe-shipping_rates": []
        }
    }), SO = zie
});
var $ie, kO, IO = k(() => {
    "use strict";
    On();
    Wt();
    $ie = $t.extend({
        initialize: function() {
            $t.prototype.initialize.apply(this, arguments), this.listenTo(this.block, "addToCartChangeSelectionState", this.changeSelectionState), this.$frameBorder = this.$el.children(".frameborder")
        },
        destroy: function() {
            this.stopListening(this.block, "addToCartChangeSelectionState", this.changeSelectionState), $t.prototype.destroy.apply(this, arguments)
        },
        changeSelectionState: function(e) {
            e === "button" ? (this.$frameBorder.css({
                "border-color": be.getRGBA(this.block.frameColor.substring(1, 7), .5)
            }), this.block.$buttonWrap.css({
                "box-shadow": "0px 0px 0px 1px " + this.block.frameColor + " inset"
            })) : e === "selects" ? (this.$frameBorder.css({
                "border-color": be.getRGBA(this.block.frameColor.substring(1, 7), .5)
            }), this.block.$attributesBox.css({
                "box-shadow": "0px 0px 0px 1px " + this.block.frameColor + " inset"
            })) : e === "both" && (this.$frameBorder.css({
                "border-color": this.block.frameColor
            }), this.block.$attributesBox.css({
                "box-shadow": "none"
            }), this.block.$buttonWrap.css({
                "box-shadow": "none"
            }))
        }
    }), kO = $ie
});
var uo, Od, _C, Wie, Oie, PO, TO = k(() => {
    "use strict";
    uo = E(ze()), Od = E(Ze());
    Ro();
    JH();
    bC();
    tv();
    Zr();
    IO();
    yr();
    jr();
    Zr();
    Yt();
    Nr();
    kj();
    oo();
    Ht();
    _C = ["product_selector"], Wie = ["both", "button", "selects"], Oie = me.extend({
        name: "Add to cart",
        title: "E-commerce",
        blockName: "addtocart",
        sort_index: 10,
        thumb: "addtocart-button",
        excludedFromLib: !0,
        individualStyleKeys: ["background-color", "background-color-opacity", "attrs-background-color", "attrs-background-color-opacity", "border-radius", "attrs-border-radius", "border-width", "attrs-border-width", "border-color", "attrs-border-color", "border-color-opacity", "attrs-border-color-opacity", "font-family", "attrs-font-family", "font-style", "attrs-font-style", "font-weight", "attrs-font-weight", "font-size", "attrs-font-size", "letter-spacing", "attrs-letter-spacing", "color", "attrs-color", "color-opacity", "attrs-color-opacity", "icon_color", "icon_color_opacity", "text-align", "attrs-text-align", "attrs-icon-size", "hover-background-color", "hover-background-color-opacity", "attrs-hover-background-color", "attrs-hover-background-color-opacity", "hover-border-radius", "attrs-hover-border-radius", "hover-border-width", "attrs-hover-border-width", "hover-border-color", "attrs-hover-border-color", "hover-border-color-opacity", "attrs-hover-border-color-opacity", "hover-color", "attrs-hover-color", "hover-color-opacity", "attrs-hover-color-opacity", "hover-icon_color", "hover-icon_color_opacity", "hover-tansition-duration"],
        autoRasterize: !0,
        restrictions: function() {
            let e = RM.constructorRouter && RM.constructorRouter.me && RM.constructorRouter.me.get("permissions");
            return e && e.can_use_e_commerce
        },
        icon_color: "#446E00",
        MAX_ICON_CACHE_SIZE: 30,
        RASTERIZE_MULTIPLIER: 2,
        frameColor: "#0080FF",
        cartBlock: null,
        defaultProductId: "default",
        textPaddingSizePercentage: 12,
        initial_controls: ["product_selector", "add_to_cart_settings", "button_edit", "icon_settings", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_position", "common_layer", "my_preset"],
        controlsDividers: ["product_selector", "icon_settings", "common_shadow"],
        groupControlsDividers: ["common_shadow"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            6: "common_interactions",
            7: "common_cursor",
            8: "common_draggable",
            9: "common_shadow",
            10: "common_position",
            11: "common_layer",
            12: "readymag_preset",
            13: "my_preset"
        },
        disabledControls: _C,
        getIconStyle: function(e = {}) {
            let t = {};
            return e.small && this.icon_color ? (t["background-color"] = this.icon_color, t) : (t["background-image"] = `url(${G(`./constructor/widgetbar/icons/${this.thumb}.svg`)})`, t)
        },
        controlsClasses(e) {
            return {
                "panel-product-selector": this.getProductSelectorIconClass()
            }[e]
        },
        getProductSelectorIconClass: function() {
            return this.model && this.model.get("selected_product_id") !== "default" ? this.workspace.eCommerceManager.isProductActive(this.model.get("selected_product_id")) ? "active-product-selected" : "inactive-product-selected" : "product-not-selected"
        },
        checkDisabledControls: function(e, t) {
            if (t) {
                this.workspace.eCommerceManager ? .getConnectedProvider() ? this.disabledControls = [] : this.disabledControls = _C;
                return
            }
            e instanceof Xt || (e ? this.disabledControls = [] : this.disabledControls = _C, this.trigger("disabledControls:changed", this.blockName))
        },
        initialize: function(e, t) {
            this.mag = t.mag, this.frameClass = kO, this.isEditMode = !1, this.rendered = !1, this.stylingState = "default", this.selectionState = "both", this.initBlock(e, t), this._oldAttrs = uo.default.clone(this.model.attributes), this.onIconChange.__debounced = uo.default.debounce(this.onIconChange, 20), this.onTextInput.__debounced = uo.default.debounce(this.onTextInput, 20), this.rasterizeSVG.__debounced_both = uo.default.debounce(this.rasterizeSVG, 100), this.rasterizeSVG.__debounced_default = uo.default.debounce(this.rasterizeSVG, 100), this.rasterizeSVG.__debounced_hover = uo.default.debounce(this.rasterizeSVG, 100), this.setMinimalDimensions.__debounced = uo.default.debounce(this.setMinimalDimensions, 100), this.saveWidgetData.__debounced = uo.default.debounce(this.saveWidgetData, 100), this.validateWidgets.__debounced = uo.default.debounce(this.validateWidgets, 100)
        },
        render: function(e) {
            this.create(), this.$el.addClass("add-to-cart-block"), this.controls = this.initial_controls, this.addToCartWidget = new og({
                data: rt(this.model.attributes),
                environment: "constructor",
                $container: this.$content,
                block: this,
                eCommerceManager: this.workspace.eCommerceManager
            }), this.addToCartWidget.on("loaded", () => {
                this.$buttonIcon || (this.$buttonIcon = this.addToCartWidget.$buttonIcon), this.initIcon()
            }), this.addToCartWidget.render(e), this.$buttonWrap = this.$content.find(".button-wrap"), this.$button = this.addToCartWidget.$button, this.$buttonText = this.addToCartWidget.$buttonText, this.$buttonIcon = this.addToCartWidget.$buttonIcon, this.$attributesBox = this.addToCartWidget.$attrsContainer, this.$sizesCalculatingBlock = this.$el.find(".sizes-calculating-block"), this.bindLinkingLineEvents(), this.bindDOMEvents(), this.bindModelEvents(), this.rendered = !0, this.triggerReady()
        },
        destroy: function() {
            this.unbindDOMEvents(), this.unbindLinkingLineEvents(), this.model.off(null, null, this), me.prototype.destroy.apply(this, arguments)
        },
        bindDOMEvents: function() {
            this.$el.on("mousedown", this.onBlockMousedown), this.$button.on("dblclick", this.onButtonDoubleClick), this.$attributesBox.on("dblclick", this.onAttrsDoubleClick), this.$buttonText.on("input", this.onTextInput)
        },
        unbindDOMEvents: function() {
            this.$el.off("mousedown", this.onBlockMousedown), this.$button.off("dblclick", this.onButtonDoubleClick), this.$attributesBox.off("dblclick", this.onAttrsDoubleClick), this.$buttonText.off("input", this.onTextInput)
        },
        bindLinkingLineEvents: function() {
            this.listenTo(this, "move resize", this.updateAnimationTrigger.bind(this)), this.listenTo(this.model, "change:angle change:sticked change:fixed_position change:is_full_width change:is_full_height", this.updateAnimationTrigger), this.listenTo(this.workspace, "workspace-resize", this.updateAnimationTrigger.bind(this)), (0, Od.default)("#main").on("scroll", this.updateAnimationTrigger)
        },
        unbindLinkingLineEvents: function() {
            this.stopListening(this, "move resize", this.updateAnimationTrigger), this.stopListening(this.model, "change:angle change:sticked change:fixed_position change:is_full_width change:is_full_height", this.updateAnimationTrigger), this.stopListening(this.workspace, "workspace-resize", this.updateAnimationTrigger), (0, Od.default)("#main").off("scroll", this.updateAnimationTrigger)
        },
        bindModelEvents: function() {
            this.model.on("change:tp", this.onTypeChange, this), this.model.on("change:icon_enabled", this.determineButtonType, this), this.model.on("change:text", function(e, t, o) {
                (o.undo || o.redo || Xt.isIncomingUpdate(o)) && this.$buttonText.val(this.model.get("text"))
            }, this), this.model.on("change:icon_h", function(e, t, o) {
                this.recalcIconContainerSize(e, t, o)
            }, this), this.model.on("change:icon_pos", function() {
                this.onIconPositionChange()
            }, this), this.model.on("change:selected_product_id", this.onProductChange, this), this.model.on("change:layout", this.onLayoutChange, this), this.model.on("change", (e, t) => {
                let o = i => uo.default.intersection(Object.keys(this.model.changedAttributes()), i).length > 0;
                if (o(["icon_enabled", "icon_noun_id", "icon_rm_id", "icon_noun_url"])) {
                    let i = Object.values(this.model.changedAttributes());
                    this.onIconChange.__debounced(e, i.includes(!1) ? !1 : void 0, t)
                }
                if (o(["font-size", "font-family", "font-style", "font-weight", "letter-spacing"]) && this.recalcButtonTextSize(), o(["attrs-font-family", "attrs-font-style", "attrs-font-weight", "attrs-letter-spacing"]) && this.recalcSelectsTextSize(), o(["text_w", "text_h"]) && this.onButtonTextSizeChange(), o(["attrs-icon-h", "attrs-icon-w"]) && this.onAttrsIconSizeChange(e), o(["icon_color", "icon_color_opacity"])) {
                    let i = e.get("tp");
                    if (i === "icon" || i === "text_and_icon") {
                        let n = {
                            default: !0
                        };
                        (e.hasChanged("icon_color") && e.hasChanged("hover-icon_color") || e.hasChanged("icon_color_opacity") && e.hasChanged("hover-icon_color_opacity")) && (n.hover = !0), this.rasterizeSVG.__debounced_default(n)
                    }
                }
                if (o(["hover-icon_color", "hover-icon_color_opacity"])) {
                    let i = e.get("tp");
                    (i === "icon" || i === "text_and_icon") && !e.hasChanged("icon_color") && !e.hasChanged("icon_color_opacity") && this.rasterizeSVG.__debounced_hover({
                        hover: !0
                    })
                }
                o(this.individualStyleKeys) && this.addToCartWidget.generateIndividualStyleCSS(uo.default.clone(this.model.attributes), this.stylingState, this.selectionState)
            }, this)
        },
        changeStylingState: function(e) {
            this.stylingState = e;
            let t = uo.default.clone(this.model.attributes);
            this.addToCartWidget.generateIndividualStyleCSS(t, this.stylingState, this.selectionState)
        },
        haveProductAttributes: function() {
            return this.addToCartWidget ? this.addToCartWidget.showSelects : !1
        },
        setDefaultSelectionState: function() {
            if (this.selectionState !== "both") {
                this.selectionState = "both", this.trigger("addToCartChangeSelectionState", this.selectionState);
                let e = uo.default.clone(this.model.attributes);
                this.addToCartWidget.generateIndividualStyleCSS(e, this.stylingState, this.selectionState)
            }
        },
        setSelectionState: function(e) {
            if (Wie.indexOf(e) === -1) return;
            this.selectionState = e, this.trigger("addToCartChangeSelectionState", this.selectionState);
            let t = uo.default.clone(this.model.attributes);
            this.addToCartWidget.generateIndividualStyleCSS(t, this.stylingState, this.selectionState)
        },
        select: function() {
            this.selected || (this.checkDisabledControls(null, !0), this.cartBlock = s0(this.workspace), this.cartBlock && (this.animationTriggerLine = new sv({
                $el: this.workspace.$el,
                fromBlock: this,
                toBlock: this.cartBlock,
                cssClass: "animation-trigger-line"
            }), this.cartBlock.startListeningForUpdateTrigger(this.animationTriggerLine)), me.prototype.select.apply(this, arguments))
        },
        deselect: function(e) {
            e !== this && this.selected && (this.setDefaultSelectionState(), this.deleteAnimationTrigger(), this.isEditMode && (this.leaveEditMode({
                saveWidgetData: !0
            }), this.workspace.trigger("redraw")), this.addToCartWidget.checkOutOfStock(), this.validateWidgets.__debounced(), me.prototype.deselect.apply(this, arguments))
        },
        validateWidgets: function() {
            this.workspace.eCommerceManager.getInvalidAddToCartWidgets(this.workspace.mag.getAllWidgets()).length ? RM.constructorRouter.trigger("notice:show", "ecommHasInvalidAddToCartWidget", {
                canBeClosed: !0
            }) : RM.constructorRouter.trigger("notice:hide", "ecommHasInvalidAddToCartWidget")
        },
        updateAnimationTrigger: function() {
            this.selected && window.requestAnimationFrame(this.recalcAnimationTrigger.bind(this))
        },
        recalcAnimationTrigger: function() {
            this.animationTriggerLine && this.animationTriggerLine.update()
        },
        deleteAnimationTrigger: function() {
            this.animationTriggerLine && this.animationTriggerLine.remove(), delete this.animationTriggerLine, this.cartBlock && (this.cartBlock.stopListeningForUpdateTrigger(), this.cartBlock = null)
        },
        onWorkspaceBlocksSelect: function(e) {
            if (me.prototype.onWorkspaceBlocksSelect.apply(this, arguments), !this.rendered) return;
            let t = e && e.length === 1 && e[0] === this;
            this.isEditMode && !t && (this.leaveEditMode({
                deselectControl: !0,
                saveWidgetData: !0
            }), this.workspace.trigger("redraw")), t || this.deleteAnimationTrigger()
        },
        onButtonDoubleClick: function() {
            if (this.model.get("pack_id")) {
                me.prototype.onDblClick.apply(this, arguments);
                return
            }
            this.selected && (this.addToCartWidget.showSelects ? this.selectionState === "both" ? (this.setSelectionState("button"), this.workspace.controls.findControl("add_to_cart_settings").select()) : this.selectionState === "selects" ? this.setSelectionState("button") : !this.isEditMode && this.enterEditMode() : !this.isEditMode && this.enterEditMode())
        },
        onAttrsDoubleClick: function() {
            this.selected && this.addToCartWidget.showSelects && (this.selectionState === "both" ? (this.setSelectionState("selects"), this.workspace.controls.findControl("add_to_cart_settings").select()) : this.selectionState === "button" && this.setSelectionState("both"))
        },
        onBlockMousedown: function(e) {
            this.isEditMode && !(0, Od.default)(e.target).is(this.addToCartWidget.$buttonText) && this.leaveEditMode({
                deselectControl: !0,
                saveWidgetData: !0
            }), this.addToCartWidget.showSelects && (this.selectionState === "button" && !(0, Od.default)(e.target).is(this.addToCartWidget.$buttonText) && this.setDefaultSelectionState(), this.selectionState === "selects" && !(0, Od.default)(e.target).is(this.$attributesBox) && this.setDefaultSelectionState())
        },
        enterEditMode: function(e) {
            this.isEditMode = !0, this.addToCartWidget && this.addToCartWidget.enterEditMode(e), this.determineButtonType({
                enter_edit_mode: !0
            })
        },
        leaveEditMode: function(e = {}) {
            this.addToCartWidget && (this.addToCartWidget.leaveEditMode(e), this.model.set("text", this.addToCartWidget.getButtonText())), e.deselectControl && this.deselectEditControl(), this.isEditMode = !1, this.determineButtonType(), this.recalcButtonTextSize(), e.saveWidgetData && this.saveWidgetData()
        },
        selectEditControl: function() {
            let e = this.workspace && this.workspace.controls;
            if (!e) return;
            let t = e.findControl("button_edit");
            t && t.master.select(t)
        },
        deselectEditControl: function() {
            let e = this.workspace && this.workspace.controls;
            if (!e) return;
            let t = e.findControl("button_edit");
            t && t.master.deselect()
        },
        onTextInput: function() {
            this.recalcButtonTextSize()
        },
        scaleContent: function(e, t) {
            let o = e.width / t.width,
                i = {
                    attributes_margin: Math.floor(this.model.get("attributes_margin") * o) || 1,
                    select_btn_margin: Math.floor(this.model.get("select_btn_margin") * o) || 1,
                    "attrs-icon-h": Math.floor(this.model.get("attrs-icon-h") * o) || 1,
                    "attrs-icon-w": Math.floor(this.model.get("attrs-icon-w") * o) || 1,
                    "attrs-border-width": Math.floor(this.model.get("attrs-border-width") * o) || 0,
                    "border-width": Math.floor(this.model.get("border-width") * o) || 0,
                    "hover-border-width": Math.floor(this.model.get("hover-border-width") * o) || 0,
                    "attrs-font-size": Math.floor(this.model.get("attrs-font-size") * o) || 1,
                    "font-size": Math.floor(this.model.get("font-size") * o) || 1
                };
            this.model.get("icon_enabled") && (i.icon_h = Math.floor(this.model.get("icon_h") * o) || 1), this.model.get("letter-spacing") && (i["letter-spacing"] = Zs({
                letterSpacing: this.model.get("letter-spacing"),
                fontSize: this.model.get("font-size"),
                newFontSize: i["font-size"]
            })), this.model.get("attrs-letter-spacing") && (i["attrs-letter-spacing"] = Zs({
                letterSpacing: this.model.get("attrs-letter-spacing"),
                fontSize: this.model.get("attrs-font-size"),
                newFontSize: i["attrs-font-size"]
            })), this.model.set(i), this.setMinimalDimensions()
        },
        css: function(e = {}) {
            me.prototype.css.apply(this, arguments), this.addToCartWidget.recalcDimensions(e)
        },
        onResizeEnd: function() {
            let e = this.getSaveBoxData(),
                t = this.$button.outerWidth(),
                o = this.$button.outerHeight();
            (this.model.get("btn_w") !== t || this.model.get("btn_h") !== o) && (this.model.set({
                w: e.w,
                h: e.h,
                btn_w: t,
                btn_h: o
            }), this.addToCartWidget.setData(uo.default.clone(this.model.attributes)), this.saveWidgetData())
        },
        setSizeConstraints: function(e, t) {
            uo.default.extend(this.frame, {
                minwidth: e,
                maxwidth: 9999,
                minheight: t,
                maxheight: 9999
            })
        },
        setMinimalDimensions: function() {
            this.addToCartWidget && this.addToCartWidget.setMinimalDimensions()
        },
        changeSelectedProduct: function(e) {
            this.model.save({
                selected_product_id: e
            })
        },
        onProductChange: function(e) {
            this.addToCartWidget.onProductChange(uo.default.clone(e.attributes)), this.updateAnimationTrigger(), this.addToCartWidget.showSelects ? this.recalcSelectsTextSize(!0) : (this.model.set({
                "attrs-text_w": 0,
                "attrs-text_h": 0
            }), this.addToCartWidget.setData(uo.default.clone(this.model.attributes)), this.setMinimalDimensions())
        },
        onLayoutChange: function(e) {
            this.addToCartWidget.onLayoutChange(uo.default.clone(e.attributes)), this.updateAnimationTrigger()
        },
        determineButtonType: function(e = {}) {
            let t = this.model.get("icon_enabled"),
                o = e.enter_edit_mode ? !0 : this.addToCartWidget.getButtonText().length,
                i;
            t && o ? i = "text_and_icon" : t && !o ? i = "icon" : i = "text", this.model.set("tp", i)
        },
        onTypeChange: function() {},
        getRealTextSize: function(e, t = "") {
            let o, i, n = uo.default.clone(this.model.attributes),
                s = n[`${t}font-size`],
                a = n[`${t}letter-spacing`],
                l = n[`${t}font-family`],
                c = n[`${t}font-style`],
                d = n[`${t}font-weight`];
            return (!this.$textInputSizeAdjuster || !this.$textInputSizeAdjuster.length) && (this.$textInputSizeAdjuster = (0, Od.default)("<div/>"), this.$textInputSizeAdjuster.css({
                width: "auto",
                "white-space": "pre"
            }).appendTo(this.$sizesCalculatingBlock)), this.$textInputSizeAdjuster.text(e), this.$textInputSizeAdjuster.css({
                "font-family": l,
                "font-style": c,
                "font-weight": d,
                "font-size": s + "px",
                "letter-spacing": a + "px"
            }), o = this.$textInputSizeAdjuster.width(), i = this.$textInputSizeAdjuster.height(), this.$textInputSizeAdjuster.empty(), o = Math.ceil(o / 2) * 2, i = Math.ceil(i / 2) * 2, {
                width: o,
                height: i
            }
        },
        recalcSelectsTextSize: function(e) {
            if (this.selectionState === "selects" || e) {
                let t = this.addToCartWidget.getLongestAttribute(),
                    o = this.addToCartWidget.getSelectsPadding() * 2,
                    i = this.getRealTextSize(t, "attrs-"),
                    n = this.model.get("btn_w"),
                    s = this.model.get("btn_h"),
                    a = i.width + this.addToCartWidget.getHorizontalTextMargin(this.model.get("attrs-font-size")) * 2,
                    l = i.height + this.addToCartWidget.getVerticalTextMargin(this.model.get("attrs-font-size")) * 2,
                    c = {
                        "attrs-text_w": a,
                        "attrs-text_h": l
                    };
                a + o > n && (c.btn_w = a + o), l > s && (c.btn_h = l);
                let d = uo.default.clone(this.model.attributes);
                if (this.addToCartWidget.setData({ ...d,
                        ...c
                    }), c.btn_w || c.btn_h) {
                    let p = this.addToCartWidget.recalcDimensionsOnProductChange();
                    c.w = p.width, c.h = p.height, c.btn_w && (c.x = d.x - Math.floor((p.width - d.w) / 2)), c.btn_h && (c.y = d.y - Math.floor((p.height - d.h) / 2))
                }
                this.model.set(c), this.setMinimalDimensions.__debounced(), (c.btn_w || c.btn_h) && this.updateAnimationTrigger()
            }
        },
        onAttrsIconSizeChange: function(e) {
            let t = uo.default.clone(e.attributes);
            this.addToCartWidget.applySelectsIconSize(t), this.setMinimalDimensions.__debounced();
            let o = t["attrs-icon-h"] + this.addToCartWidget.getVerticalIconMargin(t["attrs-icon-h"]) * 2;
            if (o > t.btn_h) {
                let i = {
                    btn_h: o
                };
                this.addToCartWidget.setData({ ...t,
                    ...i
                });
                let n = this.addToCartWidget.recalcDimensionsOnProductChange();
                i.w = n.width, i.h = n.height, i.y = t.y - Math.floor((n.height - t.h) / 2), this.model.set(i), this.updateAnimationTrigger()
            }
        },
        recalcButtonTextSize: function() {
            if (!so.isPermissionAllowed("BaseWidgetChangeSize")) return;
            let e = uo.default.clone(this.model.attributes),
                t = this.addToCartWidget.getButtonText(),
                o = this.getRealTextSize(t),
                i = this.getRealTextSize("Out of stock"),
                n = {
                    width: o.width > i.width ? o.width : i.width,
                    height: o.height > i.height ? o.height : i.height
                },
                s = this.addToCartWidget.getHorizontalTextMargin(e["font-size"]),
                a = n.width + s * 2,
                l = n.height + this.addToCartWidget.getVerticalTextMargin(e["font-size"]) * 2,
                c = {
                    text_w: a,
                    text_h: l
                };
            if (e.tp === "text" || e.tp === "text_and_icon") {
                let d = e.tp === "text_and_icon" && e.icon_enabled ? a + e.icon_w + s : a;
                if (d > e.btn_w && (c.btn_w = d), l > e.btn_h && (c.btn_h = l), this.addToCartWidget.setData({ ...e,
                        ...c
                    }), c.btn_w || c.btn_h) {
                    let p = this.addToCartWidget.recalcDimensionsOnProductChange();
                    c.w = p.width, c.h = p.height, c.btn_w && (c.x = e.x - Math.floor((p.width - e.w) / 2)), c.btn_h && (c.y = e.y - Math.floor((p.height - e.h) / 2))
                }
                this.setMinimalDimensions.__debounced()
            }
            this.model.set(c), (c.btn_w || c.btn_h) && this.updateAnimationTrigger()
        },
        onButtonTextSizeChange: function() {
            this.addToCartWidget.applyButtonTextSize(uo.default.clone(this.model.attributes))
        },
        recalcButtonSizeOnIconChange: function(e) {
            let t, o = this.addToCartWidget.getVerticalIconMargin(e.icon_h) * 2,
                i = this.addToCartWidget.getHorizontalIconMargin(e.icon_w) * 2,
                n = e.icon_h + o,
                s = {};
            if (e.tp === "text_and_icon") t = e.text_w + e.icon_w + this.addToCartWidget.getHorizontalTextMargin(e["font-size"]);
            else if (e.tp === "icon") t = e.icon_w + i;
            else return;
            if (t > e.btn_w && (s.btn_w = t), n > e.btn_h && (s.btn_h = n), s.btn_w || s.btn_h) {
                this.addToCartWidget.setData({ ...e,
                    ...s
                });
                let a = this.addToCartWidget.recalcDimensionsOnProductChange();
                s.w = a.width, s.h = a.height, s.btn_w && (s.x = e.x - Math.floor((a.width - e.w) / 2)), s.btn_h && (s.y = e.y - Math.floor((a.height - e.h) / 2)), this.model.set(s), this.updateAnimationTrigger()
            }
        },
        recalcButtonSize: function() {},
        initIcon: function(e) {
            this.model.get("icon_enabled") && this.getIconSVG(this.model.get("icon_noun_id") || this.model.get("icon_rm_id"), this.model.get("icon_noun_url"), function(t, o) {
                t || !o.$svg || (this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG()
                }), this.model.get("icon_rasterUrl") || this.rasterizeSVG({
                    default: !0,
                    hover: !0
                }), e && typeof e == "function" && e(null, null, {
                    dontRasterize: !0
                }))
            }.bind(this))
        },
        renderIcon: function() {
            Zi.prototype.renderIcon.apply(this, arguments)
        },
        recalcIconContainerSize: function(e, t, o) {
            if (this.model.get("tp") === "text") {
                this.addToCartWidget.renderButtonIcon(uo.default.clone(this.model.attributes));
                return
            }
            if (!this.currentIconData) {
                this.initIcon(this.recalcIconContainerSize.bind(this));
                return
            }
            let n = this.model.get("icon_h"),
                s = Math.floor(n * this.currentIconData.aspect_ratio);
            this.model.set({
                icon_w: s
            });
            let a = uo.default.clone(this.model.attributes);
            this.recalcButtonSizeOnIconChange(a), this.addToCartWidget.renderButtonIcon(a), this.addToCartWidget.setData(a), this.setMinimalDimensions.__debounced(), o && o.dontRasterize || o && (o.onIconChange || o.undo || o.redo) || this.rasterizeSVG.__debounced_both({
                default: !0,
                hover: !0
            })
        },
        rasterizeSVG: function() {
            Zi.prototype.rasterizeSVG.apply(this, arguments)
        },
        onIconChange: function(e, t, o) {
            if (typeof t == "boolean" && t === !1) {
                this.$buttonIcon.empty(), this.recalcIconContainerSize(e, t, {
                    onIconChange: !0
                });
                return
            }
            this.getIconSVG(e.get("icon_noun_id") || e.get("icon_rm_id"), e.get("icon_noun_url"), function(i, n) {
                i || !n.$svg || (o.undo || o.redo || this.recalcIconContainerSize(null, null, {
                    onIconChange: !0
                }), this.renderIcon({
                    $svg: this.get\ u0421oloredIconSVG()
                }), o.undo || o.redo || this.rasterizeSVG({
                    default: !0,
                    hover: !0
                }))
            }.bind(this))
        },
        onIconPositionChange: function() {
            this.addToCartWidget.applyButtonIconPosition(uo.default.clone(this.model.attributes))
        },
        onIconColorChange: function() {
            Zi.prototype.onIconColorChange.apply(this, arguments)
        },
        get\ u0421oloredIconSVG: function() {
            return Zi.prototype.get\ u0421oloredIconSVG.apply(this, arguments)
        },
        getDefaultIconSVG: function() {
            return Zi.prototype.getDefaultIconSVG.apply(this, arguments)
        },
        getIconSVG: function() {
            return Zi.prototype.getIconSVG.apply(this, arguments)
        },
        prepareIconSVG: function() {
            return Zi.prototype.prepareIconSVG.apply(this, arguments)
        },
        cacheSVGData: function() {
            Zi.prototype.cacheSVGData.apply(this, arguments)
        },
        getSVGCacheItem: function() {
            return Zi.prototype.getSVGCacheItem.apply(this, arguments)
        },
        calculateChecksum: function() {
            return Zi.prototype.calculateChecksum.apply(this, arguments)
        },
        updateBlockSizes: function(e) {
            this.model.set({
                w: e.width,
                h: e.height
            })
        },
        saveWidgetData: function() {
            uo.default.isEqual(this.model.toJSON(), this._oldAttrs) || (this.saveXHR && this.saveXHR.abort(), this._oldAttrs = uo.default.clone(this.model.toJSON()), this.saveXHR = this.model.save())
        }
    }, {
        defaults: {
            h: og.DEFAULT_ROW_HEIGHT,
            w: og.DEFAULT_ROW_WIDTH,
            x: "center",
            selected_product_id: "default",
            layout: "vertical",
            tp: "text",
            btn_w: 168,
            btn_h: 50,
            text_w: 106,
            text_h: 24,
            hidden: !1,
            select_btn_margin: 10,
            attributes_margin: 10,
            text: "Add to cart",
            "background-color": "282828",
            "background-color-opacity": 100,
            "border-radius": 30,
            "border-width": 0,
            "border-color": "000000",
            "border-color-opacity": 100,
            "font-family": "Arial",
            "font-style": "normal",
            "font-weight": 400,
            "font-size": 18,
            "letter-spacing": 0,
            "text-align": "center",
            color: "ffffff",
            "color-opacity": 100,
            "hover-background-color": "282828",
            "hover-background-color-opacity": 100,
            "hover-border-radius": 30,
            "hover-border-width": 0,
            "hover-border-color": "000000",
            "hover-border-color-opacity": 100,
            "hover-color": "ffffff",
            "hover-color-opacity": 100,
            "hover-tansition-duration": 0,
            icon_color: "ffffff",
            icon_color_opacity: 100,
            icon_enabled: !1,
            icon_h: 18,
            icon_w: 18,
            icon_rm_id: null,
            icon_noun_id: null,
            icon_noun_url: null,
            icon_pos: "left",
            icon_raster2xUrl: null,
            icon_rasterUrl: null,
            "hover-icon_color": "ffffff",
            "hover-icon_color_opacity": 100,
            "hover-icon_raster2xUrl": null,
            "hover-icon_rasterUrl": null,
            "attrs-background-color": "282828",
            "attrs-background-color-opacity": 100,
            "attrs-border-radius": 30,
            "attrs-border-width": 0,
            "attrs-border-color": "000000",
            "attrs-border-color-opacity": 100,
            "attrs-font-family": "Arial",
            "attrs-font-style": "normal",
            "attrs-font-weight": 400,
            "attrs-font-size": 18,
            "attrs-letter-spacing": 0,
            "attrs-color": "ffffff",
            "attrs-color-opacity": 100,
            "attrs-hover-background-color": "282828",
            "attrs-hover-background-color-opacity": 100,
            "attrs-hover-border-radius": 30,
            "attrs-hover-border-width": 0,
            "attrs-hover-border-color": "000000",
            "attrs-hover-border-color-opacity": 100,
            "attrs-hover-color": "ffffff",
            "attrs-hover-color-opacity": 100,
            "attrs-icon-h": 16,
            "attrs-icon-w": 10,
            "attrs-text_w": 0,
            "attrs-text_h": 0
        }
    }), PO = Oie
});
var MO, RO, SC, BO, jie, EO, FO = k(() => {
    "use strict";
    MO = E(Ze()), RO = E(To()), SC = E(gi());
    Ro();
    qH();
    Le();
    Wo();
    B();
    BO = e => e === "default", jie = me.extend({
        name: "RM Header",
        thumb: "rm-header",
        icon_color: "#282828",
        initial_controls: ["rmheader_settings", "common_position"],
        restrictions: function() {
            let e = window.RM.constructorRouter && window.RM.constructorRouter.me && window.RM.constructorRouter.me.get("permissions");
            return e && e.can_use_rm_widgets
        },
        initialize: function(e, t) {
            this.initBlock(e, t)
        },
        render: function() {
            this.create(), this.$el.addClass("rm-header"), this.controls = this.initial_controls, (0, MO.default)('<div id="rm-header-mobile-portal">').appendTo("body"), this.propsModel = new RO.default.Model({
                isFullSize: BO(this.model.getViewport()),
                style: {
                    width: "100%",
                    zoom: "var(--workspace-inverse-zoom)"
                }
            }), this.$header = this.$content.get(0), An({
                component: () => r(va, {
                    context: F1,
                    model: this.propsModel,
                    children: r(D1, {})
                }),
                domElement: this.$header,
                model: this.model,
                onDestroy: () => {
                    let t = this.$header;
                    SC.default.unmountComponentAtNode(t), t && t.parentNode && t.parentNode.removeChild(t)
                }
            }), this.bindModelEvents(), this.listenTo(this.workspace.page, "change:viewport", this.onViewportChange), this.onViewportChange(), this.rendered = !0, this.triggerReady()
        },
        bindModelEvents: function() {
            this.model.on("change:activeLink", this.onActiveLinkChange, this)
        },
        unbindModelEvents: function() {
            this.model.off("change:activeLink", this.onActiveLinkChange, this)
        },
        onActiveLinkChange: function() {
            this.model.save()
        },
        destroy: function() {
            return this.unbindModelEvents(), this.stopListening(this.workspace.page, "change:viewport", this.onViewportChange), this.$header && SC.default.unmountComponentAtNode(this.$header), me.prototype.destroy.apply(this)
        },
        onViewportChange: function() {
            let e = this.model.getViewport(),
                t = BO(e),
                o = this.model.get("is_full_width");
            this.model.set({
                h: t ? 72 : 60,
                ...!o && {
                    w: this.workspace.mag.getViewportWidth(e)
                }
            }), this.propsModel.set({
                isFullSize: t
            }), this.redrawPosition()
        }
    }, {
        defaults: {
            activeLink: "none",
            full_width_initial_w: 480,
            full_width_initial_x: 0,
            full_width_margin: 0,
            is_full_width: !0,
            fixed_position: "n",
            is_above: !0,
            is_global: !0,
            h: 72,
            x: 0,
            y: 0,
            w: Oe.dictionary.default.width
        }
    }), EO = jie
});
var zO, CC, DO, AO, LO, Hie, $O, WO = k(() => {
    "use strict";
    zO = E(Ze()), CC = E(gi());
    Ro();
    Le();
    QH();
    Wo();
    DO = e => e ? 400 : 1405, AO = e => ({
        width: "100%",
        zoom: "var(--workspace-inverse-zoom)",
        height: `${e}px`,
        position: "absolute",
        bottom: 0
    }), LO = e => ["default", "tablet_portrait"].includes(e), Hie = me.extend({
        name: "RM Footer",
        thumb: "rm-footer",
        icon_color: "#282828",
        initial_controls: ["common_position"],
        restrictions: function() {
            let e = RM.constructorRouter && RM.constructorRouter.me && RM.constructorRouter.me.get("permissions");
            return e && e.can_use_rm_widgets
        },
        initialize: function(e, t) {
            this.initBlock(e, t)
        },
        render: function() {
            this.create(), this.$el.addClass("rm-footer"), this.controls = this.initial_controls, this.$footer = (0, zO.default)("<div>").appendTo(this.$content).get(0);
            let e = LO(this.model.getViewport()),
                t = DO(e);
            this.propsModel = new Backbone.Model({
                isFullSize: e,
                style: AO(t)
            }), An({
                component: A1,
                domElement: this.$footer,
                model: this.propsModel,
                onDestroy: () => {
                    let o = this.$footer;
                    CC.default.unmountComponentAtNode(o), o && o.parentNode && o.parentNode.removeChild(o)
                }
            }), this.listenTo(this.workspace.page, "change:viewport", this.onViewportChange), this.onViewportChange(), this.rendered = !0, this.triggerReady()
        },
        redraw: function() {
            return this.onViewportChange(), me.prototype.redraw.apply(this, arguments)
        },
        onViewportChange: function() {
            let e = this.model.getViewport(),
                t = this.model.get("is_full_width"),
                o = LO(e),
                i = DO(o);
            this.model.set({
                h: i,
                ...!t && {
                    w: this.workspace.mag.getViewportWidth(e)
                }
            }), this.propsModel.set({
                isFullSize: o,
                style: AO(i)
            }), this.redrawPosition()
        },
        destroy: function() {
            return CC.default.unmountComponentAtNode(this.$footer), me.prototype.destroy.apply(this, arguments)
        }
    }, {
        defaults: {
            full_width_initial_w: 480,
            full_width_initial_x: 0,
            full_width_margin: 0,
            is_above: !1,
            is_full_width: !0,
            modelType: "widget",
            sticked: "bottom",
            sticked_margin: 0,
            h: 400,
            x: 0,
            w: Oe.dictionary.default.width,
            y: 656
        }
    }), $O = Hie
});
var OO, jO, Nie, HO, NO = k(() => {
    "use strict";
    OO = E(gi());
    Ro();
    yr();
    Le();
    tw();
    eN();
    jO = E(To());
    jr();
    Wt();
    tN();
    B();
    Nie = me.extend({
        name: "Shots",
        thumb: "shots",
        icon_color: "#A4840D",
        sort_index: 5,
        initial_controls: ["shots_settings", "playback_settings", "common_rotation", "shots_link", "common_interactions", "common_cursor", "common_draggable", "common_align", "common_position", "common_layer", "my_preset"].filter(Boolean),
        controlsDividers: ["common_rotation", "shots_link", "common_draggable"],
        groupControlsDividers: ["common_draggable"],
        groupControls: {
            0: "common_pack",
            1: "common_unpack",
            2: "common_align",
            3: "common_arrange",
            5: "common_interactions",
            6: "common_cursor",
            7: "common_draggable",
            8: "common_position",
            9: "common_layer",
            10: "readymag_preset",
            11: "my_preset"
        },
        canBeUsed: function() {
            return window.RM.constructorRouter.me && window.RM.constructorRouter.me.get("permissions").can_use_shots
        },
        canDirectLinkBeUsed: function() {
            return window.RM.constructorRouter.me && window.RM.constructorRouter.me.get("permissions").can_use_shots_direct_link
        },
        initialize: function(e, t) {
            this.migrateOldData(e), this.controls = e.get("basePath") ? this.initial_controls : this.initial_controls.filter(o => o !== "playback_settings"), this.initBlock(e, t), this.page = t.page, this.listenTo(this.page, "change:viewport", this.onViewportChange), this.stateModel = new jO.default.Model({
                viewport: this.page.getCurrentViewport(),
                canBeUsed: this.canBeUsed(),
                canDirectLinkBeUsed: this.canDirectLinkBeUsed()
            }), this.onViewportChange(), this.listenTo(this, "select", () => {
                this.stateModel.set("isSelected", !0)
            }), this.listenTo(this, "deselect", () => {
                this.stateModel.set("isSelected", !1)
            }), this.listenTo(this.model, "change:triggers", () => this.resetAnimationTriggers()), this.listenTo(this.model, "change:basePath", o => {
                o && !this.controls.includes("playback_settings") && (this.controls = this.initial_controls, this.updateControls())
            })
        },
        render: function() {
            this.create(), this.$el.addClass("shots"), this.$el.addClass("can-drop"), An({
                component: () => r(va, {
                    context: L1,
                    model: this.stateModel,
                    children: r(z1, {
                        mode: "constructor",
                        useSharedState: this.useSharedState
                    })
                }),
                domElement: this.$content[0],
                model: this.model,
                onDestroy: () => {
                    let t = this.$content[0];
                    OO.default.unmountComponentAtNode(t), t && t.parentNode && t.parentNode.removeChild(t)
                }
            }), this.rendered = !0, this.triggerReady()
        },
        getIconStyle: function(e = {}) {
            return e.small && this.icon_color ? {
                "background-color": this.icon_color
            } : {
                "background-repeat": "no-repeat",
                "background-image": `url(${G(`./constructor/widgetbar/icons/${this.thumb}.svg`)})`,
                "border-radius": "0"
            }
        },
        deselect: function(e) {
            this.selected && !this.canBeUsed() && window.RM.constructorRouter.trigger("notice:hide"), me.prototype.deselect.apply(this, [e])
        },
        select: function(e, t) {
            !this.selected && !this.canBeUsed() && window.RM.constructorRouter.trigger("notice:show", be.isSubscriptionPaused() ? "unpauseSubscriptionToUse" : "upgradeAccountToUse"), me.prototype.select.apply(this, [e, t])
        },
        destroy: function() {
            return this.stopListening(), this.stateModel.set({
                isDestroyed: !0
            }), me.prototype.destroy.apply(this)
        },
        onViewportChange: function() {
            let e = this.page.getCurrentViewport();
            this.stateModel.set({
                viewport: e
            }), this.nonReactSetSharedState({
                viewport: e
            })
        },
        migrateOldData(e) {
            let t = {
                    silent: !0,
                    toHistory: !1,
                    skipHistory: !0
                },
                o = e.get("pausable"),
                i = e.get("playbackType"),
                n = i === "hover" && o === void 0,
                s = i === "scroll" && o === void 0;
            (n || s) && e.save({
                pausable: !0,
                byStepSpeed: 1,
                byStepLoop: !0,
                byStepSpringLoop: !1,
                ...n && {
                    playbackType: "mousemove"
                }
            }, t)
        }
    }, {
        getViewportDefaults(e, t, o) {
            let i = e.get("hoverDirection");
            return { ...me.getViewportDefaults(e, t, o),
                hoverDirection: t !== "default" && i === "vertically" ? "horizontally" : i
            }
        },
        defaults: {
            basePath: "",
            numberOfImages: 0,
            playbackType: "hover",
            scrollSpeed: 1,
            scrollStartPoint: "bottom",
            scrollDelay: 0,
            hoverDirection: "horizontally",
            triggers: [],
            startPointOffset: 0,
            pausable: !0,
            byStepSpeed: 1,
            byStepLoop: !0,
            byStepSpringLoop: !1,
            firstFrameLambdaUrl: ""
        }
    }), HO = Nie
});
var UO, av, Ac, VO, GO = k(() => {
    "use strict";
    UO = E(gi());
    Ro();
    Tp();
    yr();
    Wt();
    jr();
    rv();
    B();
    av = class av extends me {
        constructor(o, i) {
            super(o, i);
            _e(this, "project");
            _e(this, "page");
            _e(this, "initial_controls", ["lottie_settings", "lottie_interactions", "common_rotation", "lottie_link", "common_interactions", "common_cursor", "common_draggable", "common_shadow", "common_align", "common_position", "common_layer", "my_preset", window.RM.constructorRouter.me ? .get("permissions") ? .can_add_preset ? "readymag_preset" : ""].filter(Boolean));
            _e(this, "controlsDividers", ["common_rotation", "lottie_link", "common_draggable"]);
            _e(this, "groupControlsDividers", ["common_draggable"]);
            _e(this, "groupControls", {
                0: "common_pack",
                1: "common_unpack",
                2: "common_align",
                3: "common_arrange",
                5: "common_interactions",
                6: "common_cursor",
                7: "common_draggable",
                8: "common_position",
                9: "common_layer",
                10: "readymag_preset",
                11: "my_preset"
            });
            this.controls = o.get("uri") ? this.initial_controls : this.initial_controls.filter(n => n !== "lottie_interactions"), this.project = i.mag, this.page = i.page, this.listenTo(this.model, "change:uri", this.onUriChange), this.listenTo(this.page, "change:viewport", this.onViewportChange), this.onViewportChange()
        }
        getInitialSharedState() {
            return {
                isPlayerReady: !1,
                clickCount: 0,
                openedInteractionSection: "playback",
                isKeyhole: this.workspace instanceof gr
            }
        }
        async render() {
            this.create(), this.$el.addClass("lottie"), this.$el.addClass("can-drop");
            let {
                renderReact: o
            } = await
            import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-LKSFPTWI.js"), {
                LottieBlock: i
            } = await
            import ("https://st-p.rmcdn1.net/ae5fa58f/dist/c/c-NWJQGGKE.js"), n = this.project.attributes._id, s = this.useSharedState;
            o({
                component: () => r(i, {
                    projectId: n,
                    useSharedState: s,
                    widget: this.model
                }),
                domElement: this.$content[0],
                model: this.model,
                onDestroy: () => {
                    let l = this.$content[0];
                    UO.default.unmountComponentAtNode(l), l && l.parentNode && l.parentNode.removeChild(l)
                }
            }), this.rendered = !0, this.triggerReady()
        }
        canBeUsed() {
            return window.RM.constructorRouter.me ? .get("permissions").can_use_lottie
        }
        select(o, i) {
            this.nonReactSetSharedState({
                isSelected: !0
            }, {
                partial: !0
            }), !this.selected && !this.canBeUsed() && window.RM.constructorRouter.trigger("notice:show", be.isSubscriptionPaused() ? "unpauseSubscriptionToUse" : "upgradeAccountToUse"), super.select(o, i)
        }
        deselect(o) {
            this.nonReactSetSharedState({
                isSelected: !1
            }, {
                partial: !0
            }), this.selected && !this.canBeUsed() && window.RM.constructorRouter.trigger("notice:hide"), super.deselect(o)
        }
        destroy() {
            return this.stopListening(), super.destroy()
        }
        onUriChange(o, i) {
            i && (this.controls = this.initial_controls, this.updateControls())
        }
        getIconStyle(o = {}) {
            let i = {};
            return o.small ? i["background-color"] = av.prototype.icon_color : (i["background-repeat"] = "no-repeat", i["background-image"] = `url(${G(`./constructor/widgetbar/icons/${this.thumb}.svg`)})`, i["border-radius"] = "0"), i
        }
        onViewportChange() {
            let o = this.page.getCurrentViewport();
            this.nonReactSetSharedState({
                viewport: o
            }, {
                partial: !0
            })
        }
    };
    _e(av, "defaults", {
        w: 200,
        h: 200,
        x: "center"
    });
    Ac = av;
    Ac.prototype.name = "Lottie";
    Ac.prototype.thumb = "lottie";
    Ac.prototype.sort_index = 6;
    Ac.prototype.icon_color = "#63DAB5";
    Ac.prototype.proportional = !1;
    VO = Ac
});
var Uie, Ca, pg = k(() => {
    "use strict";
    Xy();
    hW();
    vW();
    xW();
    oC();
    AW();
    $W();
    jW();
    NW();
    VW();
    ZW();
    tv();
    vO();
    xO();
    CO();
    TO();
    FO();
    WO();
    NO();
    GO();
    Ht();
    Uie = {
        text: $d,
        picture: qy,
        shape: HW,
        video: uW,
        shots: HO,
        slideshow: DW,
        button: Zi,
        hotspot: yO,
        form: wO,
        ecommercecart: SO,
        addtocart: PO,
        gmaps: YW,
        audio: yW,
        iframe: UW,
        background: wW,
        twitter: zW,
        facebook: OW,
        rmheader: EO,
        rmfooter: $O,
        lottie: VO
    }, Ca = Uie
});
var YO, So, ZO, dg, zp, ug = k(() => {
    "use strict";
    YO = E(To()), So = E(ze());
    oo();
    Wo();
    Dv();
    Or();
    Zr();
    pg();
    wa();
    Mt();
    Wt();
    Ht();
    En();
    qg();
    $l();
    pd();
    ZO = Xt.extend({
        idAttribute: "_id",
        urlRoot: "/api/widget/",
        defaults: de.widget.defaults,
        name: "Widget",
        widgets_with_inner_widgets: ["hotspot"],
        nonUndoKeys: [],
        viewport_required_fields: ["x", "y", "w", "h"],
        onlyRootFields: ["_id", "modelType"].concat(Oe.viewport_list),
        initialize: function(e, t) {
            if (t = t || {}, this.Block = Ca[e.type], !this.Block) return;
            this.hasNested = So.default.contains(this.widgets_with_inner_widgets, e.type), this.isNested = !!e.parent_wid;
            let o = RM.constructorRouter && !RM.constructorRouter.previewMode;
            this.hasNested && this.init_inner_widgets_models(e, t), o && t.copy && (this.createdByCopy = !0), o && (t.copy || t.clone) && this.get("type") === "text" && window.RM.constructorRouter.trigger("notice:triggerMetrics", "textWidgetCopied"), this.on("change:is_global", this.onGlobalChange), pt("widget.anomalyMonitoring") && Oe.viewport_list.forEach(i => {
                let n = e[i];
                n && ["pid", "_id", "type", "parent_wid"].find(s => s in n) && sr.sendEvent({
                    type: "rootOnlyFieldsInViewport",
                    widget: e
                })
            })
        },
        init_inner_widgets_models: function(e, t) {
            let o, i;
            o = So.default.clone(e), i = o.widgets || o.wids || [], i = this.sanitizeWidgets(i), i = i.sort(n => n.type === "picture" ? -1 : 1), this.widgets_collection = new dg(i, {
                parent_widget: this,
                parse: t.parse,
                page: this.collection ? .page
            }), o.wids = So.default.pluck(i, "_id"), this.set(o, {
                silent: !0
            }), this.on("change:wids", this.onWidsChange)
        },
        parse: function(e, t) {
            return !this.collection || !this.collection.page ? e : (this.Block || (this.Block = Ca[e.type]), t && t.xhr && (t.xhr.skipResponse = !0), So.default.has(e, "w") && !So.default.isNumber(e.w) && (e.w = this.defaults.w), So.default.has(e, "h") && !So.default.isNumber(e.h) && (e.h = this.defaults.h), Xt.prototype.parse.apply(this, arguments))
        },
        triggerSocketUpdate(e, t) {
            let o = t ? .patch ? So.default.extend({}, t.attrs, this.pick("_id", "pid")) : So.default.isEmpty(e) ? this.attributes : e;
            o.pid = o.pid || this.getPageId(), RM.constructorRouter.trigger("update_from_server", "Widget", o, this.getViewport())
        },
        set: function(e, t, o) {
            let i;
            return typeof e == "object" ? (i = e, o = t) : (i = {})[e] = t, !this.isGlobal() || !this.collection || !this.collection.page || o && o.noSaveUnique ? (typeof this.Block ? .filterSetAttributes == "function" && (i = this.Block.filterSetAttributes(i, o)), Xt.prototype.set.apply(this, [i, o])) : (typeof this.Block ? .filterSetAttributes == "function" && (i = this.Block.filterSetAttributes(i, o)), Xt.prototype.set.apply(this, [i, o]))
        },
        get: function(e) {
            let t = Xt.prototype.get.apply(this, arguments);
            if (!this.attributes.is_global || this.attributes.is_above && e === "z" || !So.default.contains(Ai.GLOBAL_UNIQUE_KEYS, e) || !this.collection || !this.collection.page) return t;
            let o = Ai.getUniqueValue(e, this.attributes, this.collection.page.id);
            return o === void 0 ? t : o
        },
        validate: function(e) {
            if (!e.type) return "missing widget type"
        },
        triggerReady: function() {
            bt.trigger("ready:model", this)
        },
        toJSON: function() {
            if (!this.collection || !this.collection.page) return this.attributes;
            let e = So.default.clone(this.attributes);
            return So.default.each(Oe.viewport_list, function(t) {
                !So.default.isEmpty(this[t]) && !e[t] && (e[t] = this[t])
            }, this), e
        },
        initViewport: function(e) {
            let t = this.collection.page.getCurrentViewport(),
                o = this.attributes,
                i = Hc(this.attributes.type, this.attributes.version, !1);
            this["viewport_" + t] = So.default.extend(So.default.pick(o, i), this.Block.getViewportDefaults(this, t, e))
        },
        getOverrides(e) {
            let t = e !== "default" ? `viewport_${e}` : void 0,
                o = this.toJSON();
            return t ? o[t] : {}
        },
        isViewportInitialized(e) {
            let t = e !== "default" ? `viewport_${e}` : void 0,
                o = this.toJSON();
            return !t || !!o[t]
        },
        getViewport: function() {
            return this.isNested ? "default" : this.collection && this.collection.page && this.collection.page.getCurrentViewport()
        },
        setViewport(e) {},
        fillMissingFieldsFromDefaultViewport: function(e) {
            let t = {};
            So.default.each(e, function(o) {
                let i = this.viewport_default && this.viewport_default[o];
                this.get(o) === void 0 && i && (t[o] = rt(i))
            }.bind(this)), So.default.isEmpty(t) || this.set(t, {
                silent: !0
            })
        },
        setInViewports(e, t) {
            let o = this.get("pid");
            for (let i of Oe.types) {
                if (!this.isViewportInitialized(i)) continue;
                let n = Yh({
                    target: this,
                    viewport: i,
                    pageId: o,
                    minimalViewports: be.canUseMinimalViewport()
                });
                n.set(typeof e == "function" ? e(n.attributes, i) : e, t)
            }
        },
        unsetInViewports(e, t) {
            this.setInViewports(e, { ...t,
                unset: !0
            })
        },
        setInPrimary(e, t) {
            Yh({
                target: this,
                viewport: "default",
                pageId: this.get("pid"),
                minimalViewports: be.canUseMinimalViewport()
            }).set(e, t)
        },
        getPageId: function() {
            return this.collection && this.collection.getPageId()
        },
        addWidget: function(e, t) {
            if (t = t || {}, !e || !e.type) {
                console.error("Adding widget with no type into another widget.");
                return
            }
            if (!Ca[e.type]) {
                console.error("Adding unknown widget into another widget.");
                return
            }
            e.parent_wid = this.get("_id"), e.pid = this.get("pid");
            let o = e.type === "picture" ? this.widgets_collection.unshift(e, t) : this.widgets_collection.add(e, t);
            o.created = !t.copy && !t.clone, o.id ? o.fetch({
                success: this.getAddCallback(t),
                error: t.error
            }) : o.save({}, {
                success: this.getAddCallback(t),
                error: t.error
            })
        },
        onAddWidget: function(e, t) {
            if (!e.get("type")) return !1;
            let o;
            o = So.default.clone(this.get("wids")), e.get("type") === "picture" ? o.unshift(e.id) : o.push(e.id), o = (0, So.default)(o).chain().uniq().compact().value(), this.set({
                wids: o
            }, t)
        },
        getAddCallback: function(t) {
            var t = t || {},
                o = this;
            return function(i) {
                o.onAddWidget(i, t), t.success && t.success(i)
            }
        },
        onWidsChange: function(e, i, o) {
            var i = this.get("wids");
            if (i && So.default.isObject(i[0])) {
                let a = So.default.clone(i);
                a = this.sanitizeWidgets(a), this.widgets_collection.set(a, {
                    parent_widget: this,
                    page: this.collection ? .page
                }), i = So.default.pluck(i, "_id"), this.set("wids", i, {
                    silent: !0
                })
            }
            let n = this.get("wids"),
                s = e.previous("wids") || [];
            if (n) {
                let a = So.default.difference(n, s),
                    l = So.default.difference(s, n);
                So.default.each(a, function(c) {
                    let d = e.widgets_collection.get(c);
                    d && this.trigger("widget:create", d, o)
                }.bind(this)), So.default.each(l, function(c) {
                    let d = e.widgets_collection.get(c);
                    d && this.trigger("widget:remove", d, o)
                }.bind(this))
            }
        },
        sanitizeWidgets: function(e) {
            return So.default.filter(e, function(t) {
                return !!Ca[t.type]
            })
        },
        isGlobal: function() {
            return !!this.get("is_global")
        },
        onGlobalChange: function() {
            this.get("is_global") ? (this.setInViewports(t => Ai.ensurePageDefRecord(t)), this.triggerGlobalAppear()) : this.triggerGlobalDisappear()
        },
        triggerGlobalAppear: function() {
            bt.trigger("global_appear:widget", this)
        },
        triggerGlobalDisappear: function() {
            bt.trigger("global_disappear:widget", this)
        },
        getAnimations() {
            return ft.normalizeAnimations(this.get("animation"))
        },
        clearChanges() {
            this.changed = {}
        }
    }, {
        viewports: Oe.viewport_list
    }), dg = YO.default.Collection.extend({
        model: ZO,
        initialize: function(e, t) {
            t && t.page && (this.page = t.page), this.on("remove", function(o) {
                this.page && this.page.trigger("widget:remove", o, {})
            }, this)
        },
        getPageId: function() {
            return this.page.id
        }
    }), zp = ZO
});
var XO = E(ze());
rg();
var KO = cd.extend({
        id: "_params",
        isNew: function() {
            return !1
        },
        mag: {},
        name: "MagEditParams",
        initialize: function(e, t) {
            XO.default.bindAll(this), KO.prototype.mag = t, this.url = function() {
                return "/api/mag/" + this.mag.get("num_id") + "/edit_params"
            }, this.set(e)
        },
        getChangedAttributes: function() {
            return this.changedAttributes()
        },
        toggle: function(e) {
            this.save(e, !this.get(e))
        }
    }),
    zwt = KO;
var Hd = E(N()),
    ej = E(gi());
ve();
gH();
qc();
je();
ut();
Be();
var Kn = E(N()),
    BC = E(hn());
Hi();
zt();
$e();
Vn();
var jd = E(N());
ie();
Be();
Hi();
$e();
ry();
var zc = E(N()),
    IC = E(gi());
wp();
ie();
je();
Be();
or();
ew();
en();
ut();
var Lc = E(N());
ie();
Be();
Cr();
ut();
ve();
B();

function Vie(e, t = "0px 0px 0px 0px", o = !1) {
    let [i, n] = (0, Lc.useState)(!1), s = (0, Lc.useRef)(null);
    return (0, Lc.useEffect)(() => {
        let a = new IntersectionObserver(l => {
            let {
                isIntersecting: c
            } = l[0];
            c ? (n(!0), o === !1 && a.disconnect()) : o && n(!1)
        }, {
            root: e,
            rootMargin: t
        });
        return s ? .current && a.observe(s.current), () => {
            a && a.disconnect()
        }
    }, [e, s.current]), [i, s]
}

function JO({
    listContainer: e,
    option: t,
    isSelected: o,
    onSelect: i,
    onDeselect: n
}) {
    let [s, a] = Vie(e, "150px 0px 150px 0px"), l = (0, Lc.useCallback)(c => {
        c.stopPropagation(), o ? n(t) : i(t)
    }, [t.value, o]);
    return r(b, {
        ref: a,
        width: "100%",
        height: "24px",
        children: s && x(b, {
            display: "flex",
            justifyContent: "space-between",
            alignItems: "center",
            paddingTop: "4px",
            paddingBottom: "4px",
            paddingLeft: "6px",
            paddingRight: "10px",
            cursor: "default",
            "data-value": t.value,
            css: Z `
            &:hover {
              & > span {
                color: ${ce.black};
              }
            }
          `,
            children: [r($, {
                textStyle: "small",
                color: o ? "black" : "darkGray",
                title: t.caption,
                whiteSpace: "nowrap",
                overflow: "hidden",
                textOverflow: "ellipsis",
                children: t.caption
            }), r(b, {
                display: "flex",
                position: "relative",
                cursor: "pointer",
                onClick: l,
                css: Z `
              &:hover {
                & > svg {
                  color: ${o?ce.red:ce.black};
                }
              }
            `,
                children: r(Qt, {
                    style: {
                        transform: o ? "rotate(45deg)" : "rotate(0deg)"
                    },
                    color: o ? "black" : "darkGray"
                })
            })]
        })
    })
}
ie();
je();
Be();
Ts();
ve();
B();

function Gie({
    selectedOption: e,
    onDeselect: t
}) {
    let o = i => {
        i.stopPropagation(), t(e)
    };
    return x(b, {
        display: "flex",
        justifyContent: "space-between",
        alignItems: "center",
        cursor: "default",
        marginTop: 24,
        css: Z `
        &:first-child {
          margin-top: 0;
        }
      `,
        children: [r($, {
            textStyle: "small",
            color: "black",
            whiteSpace: "nowrap",
            overflow: "hidden",
            textOverflow: "ellipsis",
            children: e.caption
        }), r(K, {
            display: "flex",
            variant: "clean",
            onClick: o,
            children: r(Nt, {
                color: "gray"
            })
        })]
    })
}

function Yie({
    selectedOptions: e,
    onDeselect: t
}) {
    return r(b, {
        paddingTop: "12px",
        paddingBottom: "12px",
        paddingLeft: "8px",
        paddingRight: "14px",
        backgroundColor: "white",
        borderRadius: "8px",
        children: e.map(o => r(Gie, {
            selectedOption: o,
            onDeselect: t
        }, o.value))
    })
}
var kC = Yie;
ve();
B();

function Zie({
    initialValue: e = [],
    options: t,
    onChange: o,
    labelText: i,
    labelStyle: n,
    container: s,
    containerForSelected: a,
    width: l,
    height: c,
    onToggleDropDown: d
}) {
    let [p, h] = (0, zc.useState)(!1), [u, m] = (0, zc.useState)(null), [f, g] = (0, zc.useState)(null), {
        styles: y,
        attributes: S,
        update: w
    } = xa(u, f, {
        placement: "bottom"
    });
    (0, zc.useEffect)(() => {
        p && w && w(), d && d(p)
    }, [p]);
    let C = Bp({
            watchingClick: p,
            callback: () => p && h(!1)
        }),
        [I, T] = (0, zc.useState)(e),
        P = R => {
            T(A => {
                if (!!!I.find(O => O.value === R.value)) {
                    let O = [...A];
                    return O.push(R), O
                }
                return A
            })
        },
        M = R => {
            T(A => {
                let D = I.findIndex(O => O.value === R.value);
                if (D > -1) {
                    let O = [...A];
                    return O.splice(D, 1), O
                }
                return A
            })
        };
    (0, zc.useEffect)(() => {
        o && o(I)
    }, [I]);
    let F = r(b, {
        ref: g,
        width: l || "calc(100% + 8px + 8px)",
        height: c || 304,
        backgroundColor: "white",
        opacity: .98,
        borderRadius: "8px",
        border: "1px solid",
        borderColor: "lightGray",
        zIndex: 102,
        style: { ...y.popper,
            display: p ? "block" : "none"
        },
        ...S.popper,
        children: r(xo, {
            children: ({
                ref: R
            }) => r(b, {
                ref: R,
                width: "100%",
                paddingLeft: "18px",
                paddingRight: "18px",
                marginTop: "-1px",
                children: r(b, {
                    ref: C,
                    children: p && t.map(A => r(JO, {
                        listContainer: f || void 0,
                        option: A,
                        onSelect: P,
                        onDeselect: M,
                        isSelected: !!I.find(D => D.value === A.value)
                    }, A.value))
                })
            })
        })
    });
    return x(Q, {
        children: [I.length ? a ? IC.default.createPortal(r(kC, {
            selectedOptions: I,
            onDeselect: M
        }), a) : r(kC, {
            selectedOptions: I,
            onDeselect: M
        }) : null, x(b, {
            ref: m,
            height: 40,
            paddingLeft: "16px",
            paddingRight: "16px",
            display: "flex",
            justifyContent: "space-between",
            alignItems: "center",
            position: "relative",
            cursor: "pointer",
            onClick: R => {
                R.stopPropagation(), h(!p)
            },
            css: Z `
          &:hover {
            & svg {
              color: ${ce.black};
            }
          }
        `,
            children: [r(K, {
                display: "block",
                variant: "clean",
                lineHeight: 1,
                children: r($, {
                    textStyle: "small",
                    display: "block",
                    css: Z `
              ${n||""}
            `,
                    children: i
                })
            }), r(b, {
                position: "relative",
                left: "-1px",
                top: "-2px",
                children: r(K, {
                    variant: "clean",
                    onClick: R => {
                        R.stopPropagation(), h(!p)
                    },
                    verticalAlign: "middle",
                    children: r(Lt, {
                        color: "gray"
                    })
                })
            })]
        }), s ? IC.default.createPortal(F, s) : F]
    })
}
var PC = Zie;
var lv = E(N());
ie();
Ur();
je();
Jr();
Ts();
en();
ut();
ve();
B();

function Xie({
    value: e = "",
    placeholder: t,
    validate: o,
    onSubmit: i,
    width: n,
    height: s,
    m: a
}) {
    let [l, c] = (0, lv.useState)(e), [d, p] = (0, lv.useState)(() => o ? o(e) : !0), [h, u] = (0, lv.useState)(!1), m = () => {
        u(!0)
    }, f = () => {
        u(!1)
    }, g = v => {
        v.key === "Enter" && (v.target ? .blur(), S())
    }, y = v => {
        c(v.target.value.trim()), o && p(o(v.target.value.trim()))
    }, S = () => {
        d && l !== e && i(l)
    }, w = () => {
        c(""), o && p(o("")), i("")
    };
    return x(b, {
        position: "relative",
        marginLeft: "2rm",
        marginRight: "2rm",
        borderTop: "1px solid",
        borderBottom: "1px solid",
        borderColor: "transparent",
        children: [r(Mo, {
            width: n || "100%",
            height: s || 38,
            padding: "0 36px 0 8px",
            margin: a || 0,
            border: "none !important",
            textStyle: "small",
            boxSizing: "border-box",
            backgroundColor: h || e && d ? ce.white : "transparent",
            borderRadius: "8px",
            textOverflow: "ellipsis",
            transition: "background 0.2s ease-in",
            css: Z `
          &::placeholder {
            color: ${ce.black};
          }
        `,
            placeholder: t,
            onFocus: m,
            onBlur: f,
            value: l,
            onKeyUp: g,
            onChange: y
        }), r(b, {
            position: "absolute",
            top: "50%",
            right: 0,
            marginRight: "2rm",
            transform: "translateY(-50%)",
            children: e && d && e === l ? r(b, {
                marginRight: "6px",
                children: r(K, {
                    type: "button",
                    onClick: w,
                    variant: "clean",
                    children: r(Nt, {
                        color: "gray"
                    })
                })
            }) : d ? r(b, {
                children: r(dt, {
                    height: 24,
                    width: 24,
                    onClick: S,
                    color: "gray",
                    hoverColor: "blue",
                    display: "block",
                    transform: "rotate(-90deg)",
                    marginRight: 0,
                    children: r(Lt, {
                        color: "white",
                        display: "inline"
                    })
                })
            }) : null
        })]
    })
}
var TC = Xie;
ae();
B();

function Kie({
    dropdownContainer: e
}) {
    let {
        model: t,
        modelSet: o
    } = (0, jd.useContext)(Y), i = (0, jd.useRef)(null), [n, s] = (0, jd.useState)(!!t.block.model.get("stripe-allow_promotion_codes")), a = () => {
        let g = !!!t.block.model.get("stripe-allow_promotion_codes");
        s(g), t.block.saveModelChanges({
            "stripe-allow_promotion_codes": g
        })
    }, l = (f = []) => {
        t.block.saveModelChanges({
            "stripe-allowed_countries": f
        })
    }, c = f => f && Array.isArray(f) && f[0] ? f[0] : "", [d, p] = (0, jd.useState)(() => c(t.block.model.get("stripe-shipping_rates"))), h = f => !!f && /shr_[\w\d]+/g.test(f), u = f => {
        p(f), t.block.saveModelChanges({
            "stripe-shipping_rates": [f]
        })
    }, m = f => {
        o({
            preventClose: f
        })
    };
    return x(Q, {
        children: [x(b, {
            display: "flex",
            justifyContent: "space-between",
            alignItems: "center",
            marginTop: 29,
            marginBottom: 11,
            paddingLeft: "16px",
            paddingRight: "16px",
            children: [r(Bo, {
                textStyle: "regular",
                color: "black",
                children: "Stripe"
            }), r(Mu, {
                position: "relative",
                top: "2px",
                href: "https://help.readymag.com/hc/en-us/articles/360053970512#h_01F8T772CD3Q3ZVYY6ANA2WPV0"
            })]
        }), r(H, {
            leftSlot: "Promo code",
            rightSlot: r(Ve, {
                backgroundChecked: "blue",
                checked: n,
                onChange: a
            })
        }), r(PC, {
            initialValue: t.block.model.get("stripe-allowed_countries"),
            labelText: "Available countries",
            container: e,
            containerForSelected: i.current,
            options: $1,
            onChange: l,
            onToggleDropDown: m
        }), r(b, {
            width: "100%",
            paddingLeft: "2rm",
            paddingRight: "2rm",
            borderTop: "1px solid",
            borderBottom: "1px solid",
            borderColor: "transparent",
            color: "transparent",
            ref: i
        }), r(b, {
            marginBottom: "7px",
            color: "transparent",
            children: r(TC, {
                placeholder: "Shipping ID",
                value: d,
                validate: h,
                onSubmit: u
            })
        })]
    })
}
var qO = Kie;
nt();
nn();
ol();
um();
ni();
ko();
ae();
B();
var Jie = (0, Kn.forwardRef)(({
        style: e,
        panelPortalElement: t,
        currentFontFamily: o
    }, i) => {
        let {
            model: n,
            modelSet: s
        } = (0, Kn.useContext)(Y), a = (0, Kn.useMemo)(() => n.project.get("_id"), [n]), l = (0, Kn.useMemo)(() => n.user.get("_id"), [n]), c = (0, Kn.useMemo)(() => n.block.eCommerceManager ? .getConnectedProvider(), [n.block]), {
            navigate: d
        } = (0, Kn.useContext)(Jt), p = L => {
            let W = {};
            L.weight && (W["bar-font-weight"] = L.weight), L.style && (W["bar-font-style"] = L.style), Object.keys(W).length && n.block.saveModelChanges(W)
        }, [h, u] = (0, Kn.useState)(n.block.model.get("bar-background-color") ? ct(n.block.model.get("bar-background-color"), Zo(n.block.model.get("bar-background-color-opacity"))) : null), m = L => {
            let W = L.a * 100,
                z = (0, BC.omit)(L, "a"),
                V = yt(z);
            n.block.saveModelChangesDebounced({
                "bar-background-color": V,
                "bar-background-color-opacity": W
            })
        }, [f, g] = (0, Kn.useState)(!!n.block.model.get("bar-shadow")), y = L => {
            g(L), n.block.saveModelChanges({
                "bar-shadow": L
            })
        }, [S, w] = (0, Kn.useState)(n.block.model.get("bar-color") ? ct(n.block.model.get("bar-color"), Zo(n.block.model.get("bar-color-opacity"))) : null), v = L => {
            let W = L.a * 100,
                z = (0, BC.omit)(L, "a"),
                V = yt(z);
            n.block.saveModelChangesDebounced({
                "bar-color": V,
                "bar-color-opacity": W
            })
        }, [C, I] = (0, Kn.useState)(n.block.model.get("bar-font-size-factor") || 1), T = ({
            value: L
        }) => {
            I(L), n.block.saveModelChangesDebounced({
                "bar-font-size-factor": L
            })
        }, [P, M] = (0, Kn.useState)(n.block.model.get("bar-button-baseline") || 0), F = ({
            value: L
        }) => {
            M(L), n.block.saveModelChangesDebounced({
                "bar-button-baseline": L
            })
        }, [R, A] = (0, Kn.useState)(n.block.model.get("bar-auto-open")), D = L => {
            A(L), n.block.eCommerceManager.openSidebarOnAddItem = L, n.block.saveModelChanges({
                "bar-auto-open": L
            })
        }, O = L => s({
            preventClose: L
        });
        return r(Me, {
            ref: i,
            style: e,
            isShowed: !0,
            portalElement: t,
            maxHeight: "100vh - 66px",
            scrollable: !0,
            children: r(Ot.Consumer, {
                children: ({
                    tooltipContainer: L,
                    dropdownContainer: W
                }) => x(Q, {
                    children: [r(co, {
                        title: "Cart bar"
                    }), r(qe, {
                        "data-testidy": "cart-bar-background-color",
                        title: "Background",
                        container: L,
                        projectId: a,
                        userId: l,
                        color: h,
                        setColor: u,
                        onColorChange: m
                    }), r(H, {
                        leftSlot: "Shadow",
                        rightSlot: r(Ve, {
                            backgroundChecked: "blue",
                            checked: f,
                            onChange: y
                        })
                    }), r(tl, {
                        fontFamily: o,
                        onClick: () => d("FontsList")
                    }), r(Fa, {
                        fontFamily: o,
                        fontWeight: [n.block.model.get("bar-font-weight")],
                        fontStyle: [n.block.model.get("bar-font-style")],
                        onChangeStyle: p,
                        dropdownContainer: W,
                        onToggleSelectPanel: O
                    }), r(qe, {
                        "data-testidy": "cart-bar-text-color",
                        title: "Text color",
                        container: L,
                        projectId: a,
                        userId: l,
                        color: S,
                        setColor: w,
                        onColorChange: v
                    }), r(H, {
                        leftSlot: "Text scale",
                        rightSlot: r(fe, {
                            min: 1,
                            max: 1.3,
                            step: .05,
                            textAlign: "right",
                            autoWidth: !0,
                            value: C,
                            onChange: T
                        })
                    }), r(H, {
                        leftSlot: "Button baseline",
                        rightSlot: r(fe, {
                            textAlign: "right",
                            min: -25,
                            max: 25,
                            autoWidth: !0,
                            value: P,
                            onChange: F
                        })
                    }), r(H, {
                        leftSlot: "Auto-open",
                        rightSlot: r(Ve, {
                            backgroundChecked: "blue",
                            checked: R,
                            onChange: D
                        }),
                        showBorder: c === "stripe"
                    }), c === "stripe" && r(qO, {
                        dropdownContainer: W
                    })]
                })
            })
        })
    }),
    QO = Jie;
ht();
ol();
ni();
ae();
gn();
B();
var qie = ue("div")
`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
  opacity: 0;
  z-index: 4004;
`;

function Qie({
    panelPortalElement: e
}) {
    let {
        model: t
    } = (0, Hd.useContext)(Y), o = (0, Hd.useRef)(null), i = r(Ut, {
        leftSlot: r(K, {
            "data-testid": "text-typography-back",
            variant: "clean",
            onClick: () => o.current && o.current.goBack(),
            css: Z `
            &:hover svg {
              color: ${ce.black};
              opacity: 1;
            }
          `,
            children: r(_r, {
                color: "darkGray"
            })
        })
    }), [n, s] = (0, Hd.useState)(t.block.model.get("bar-font-family")), a = d => {
        s(d.css_name), t.block.saveModelChanges({
            "bar-font-family": d.css_name
        })
    }, [l] = (0, Hd.useState)(t.block.model.get("bar-color")), c = () => {
        t.preventClose || t.deselect()
    };
    return x(Q, {
        children: [r(Ie, {
            placement: "bottom",
            control: ({
                ref: d
            }) => r(ke, {
                ref: d,
                label: r(Bo, {
                    textStyle: "small",
                    fontFamily: "-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif",
                    children: "Settings"
                }),
                size: 31,
                withButton: !1,
                onClick: p => {
                    p.preventDefault(), !t.disabled && (t.selected ? t.deselect() : t.select())
                },
                children: r(aI, {
                    className: "settings-toggle",
                    width: 31,
                    height: 28,
                    color: l,
                    cursor: "pointer"
                })
            }),
            panel: ({
                ref: d,
                style: p
            }) => t.selected ? x(Pr, {
                ref: o,
                initialScreen: "Main",
                children: [r(lo, {
                    screen: "Main",
                    children: r(QO, {
                        ref: d,
                        style: p,
                        panelPortalElement: e,
                        currentFontFamily: n
                    })
                }), r(lo, {
                    screen: "FontsList",
                    children: r(ta, {
                        ref: d,
                        style: p,
                        headerSlot: i,
                        currentFontFamily: n,
                        panelPortalElement: e,
                        onFontSelect: a,
                        hideUpload: !0
                    })
                })]
            }) : null
        }), t.selected && ej.default.createPortal(r(qie, {
            onClick: c
        }), document.body)]
    })
}
var S_t = Qie;
export {
    jo as a, Bh as b, cd as c, rg as d, N1 as e, Xt as f, Zr as g, aN as h, oP as i, Es as j, dd as k, mg as l, Ah as m, $p as n, gg as o, mse as p, _P as q, SP as r, uw as s, Bse as t, vg as u, jN as v, Mse as w, Rse as x, bg as y, Nse as z, LP as A, kg as B, yw as C, Y as D, Ce as E, ae as F, UU as G, b2 as H, y2 as I, Jce as J, M2 as K, R2 as L, qce as M, Qce as N, ede as O, tde as P, Qw as Q, Zde as R, xB as S, _B as T, Q7 as U, rx as V, sx as W, ipe as X, ax as Y, lx as Z, SB as _, CB as $, kB as aa, IB as ba, PB as ca, TB as da, BB as ea, Xpe as fa, cM as ga, sue as ha, ao as ia, ux as ja, rV as ka, pM as la, sV as ma, Tue as na, Bue as oa, Fs as pa, Rh as qa, aw as ra, sr as sa, pd as ta, RV as ua, _M as va, Yh as wa, qg as xa, SM as ya, CM as za, dt as Aa, Jr as Ba, H as Ca, $e as Da, gne as Ea, Fp as Fa, ui as Ga, Ho as Ha, ts as Ia, cb as Ja, Tx as Ka, bG as La, ou as Ma, iu as Na, nu as Oa, db as Pa, os as Qa, ru as Ra, pR as Sa, uR as Ta, KR as Ua, qR as Va, zwe as Wa, QR as Xa, Ve as Ya, Hi as Za, pu as _a, Ib as $a, Sn as ab, yu as bb, Ra as cb, wu as db, Su as eb, Wb as fb, pD as gb, uD as hb, yD as ib, vD as jb, Ob as kb, y_ as lb, y9 as mb, v9 as nb, XLe as ob, KLe as pb, Lr as qb, H_ as rb, r8e as sb, Bu as tb, iy as ub, Mu as vb, ry as wb, V_ as xb, E3 as yb, fc as zb, xm as Ab, X_ as Bb, fy as Cb, q_ as Db, lS as Eb, n8 as Fb, v8 as Gb, w8 as Hb, xS as Ib, OKe as Jb, B8 as Kb, L8 as Lb, z8 as Mb, $8 as Nb, W8 as Ob, O8 as Pb, j8 as Qb, UJe as Rb, SS as Sb, ZJe as Tb, N8 as Ub, eqe as Vb, CS as Wb, Ste as Xb, Z8 as Yb, wc as Zb, Cz as _b, kz as $b, S6 as ac, C6 as bc, Act as cc, T6 as dc, rdt as ec, A6 as fc, Uoe as gc, j6 as hc, Voe as ic, me as jc, Ro as kc, Y6 as lc, KS as mc, Uht as nc, aW as oc, uW as pc, hW as qc, Ybt as rc, gr as sc, rv as tc, Ca as uc, pg as vc, dg as wc, zp as xc, ug as yc, mre as zc, fre as Ac, gre as Bc, uP as Cc, Are as Dc, Lre as Ec, hg as Fc, fP as Gc, zwt as Hc, S_t as Ic
};